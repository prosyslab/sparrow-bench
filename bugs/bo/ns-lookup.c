/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 30 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned char __u_char;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 133 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __pid_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 33 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_char u_char;
#line 98 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __pid_t pid_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.6/include/stddef.h"
typedef unsigned long size_t;
#line 195 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef short int16_t;
#line 201 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned short u_int16_t;
#line 202 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned int u_int32_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 315 "/usr/include/libio.h"
typedef struct _IO_FILE _IO_FILE;
#line 75 "my-named.h"
struct databuf {
   struct databuf *d_next ;
   u_int32_t d_ttl ;
   unsigned int d_flags : 7 ;
   unsigned int d_cred : 3 ;
   unsigned int d_clev : 6 ;
   int16_t d_zone ;
   int16_t d_class ;
   int16_t d_type ;
   int16_t d_mark ;
   int16_t d_size ;
   int16_t d_rcnt ;
   u_int32_t d_nstime ;
   u_char d_data[sizeof(char *)] ;
};
#line 114 "my-named.h"
struct zoneinfo {
   char *z_origin ;
   time_t z_time ;
   time_t z_lastupdate ;
   u_int32_t z_refresh ;
   u_int32_t z_retry ;
   u_int32_t z_expire ;
   u_int32_t z_minimum ;
   u_int32_t z_serial ;
   char *z_source ;
   time_t z_ftime ;
   struct in_addr z_xaddr ;
   struct in_addr z_addr[16] ;
   u_char z_addrcnt ;
   u_char z_type ;
   u_int16_t z_flags ;
   pid_t z_xferpid ;
   int z_class ;
};
#line 152 "my-named.h"
struct namebuf {
   char *n_dname ;
   struct databuf *n_data ;
};
#line 374 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint32_t ( __attribute__((__leaf__)) ntohl)(uint32_t __netlong )  __attribute__((__const__)) ;
#line 53 "/usr/include/arpa/inet.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) inet_ntoa)(struct in_addr __in ) ;
#line 190 "/usr/include/x86_64-linux-gnu/sys/syslog.h"
extern void ( /* format attribute */  syslog)(int __pri , char const   *__fmt  , ...) ;
#line 434 "/usr/include/libio.h"
extern int _IO_getc(_IO_FILE *__fp ) ;
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 622
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 468
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) calloc)(size_t __nmemb ,
                                                                               size_t __size )  __attribute__((__malloc__)) ;
#line 399 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 455
extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1,2), __leaf__)) bcopy)(void const   *__src ,
                                                                                               void *__dest ,
                                                                                               size_t __n ) ;
#line 69 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) __assert_fail)(char const   *__assertion ,
                                                                                                   char const   *__file ,
                                                                                                   unsigned int __line ,
                                                                                                   char const   *__function ) ;
#line 85 "ns-lookup-bad.c"
struct zoneinfo *zones  =    (struct zoneinfo *)((void *)0);
#line 87
struct in_addr data_inaddr(u_char const   *data ) ;
#line 88
struct namebuf *nlookup(u_char *dname ) ;
#line 89
struct databuf **create_databuf_list(int num ) ;
#line 101 "ns-lookup-bad.c"
static void nslookupComplain(char const   *sysloginfo , char const   *queryname ,
                             char const   *complaint , char const   *dname , struct databuf  const  *a_rr ,
                             struct databuf  const  *nsdp ) 
{ 
  char *a ;
  char *ns ;
  char buf[999] ;
  struct in_addr tmp ;
  char *tmp___0 ;
  int len ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  struct in_addr tmp___3 ;
  char *tmp___4 ;
  int len___0 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  size_t tmp___7 ;
  void *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;

  {
  {
#line 112
  printf((char const   */* __restrict  */)"NS \'%s\' %s\n", dname, complaint);
  }
#line 114
  if (sysloginfo) {
#line 114
    if (queryname) {
#line 118
      ns = (char *)((void *)0);
#line 118
      a = ns;
#line 136
      if ((unsigned long )a != (unsigned long )((void *)0)) {
#line 136
        goto _L;
      } else
#line 136
      if ((unsigned long )ns != (unsigned long )((void *)0)) {
        _L: /* CIL Label */ 
        {
#line 138
        printf((char const   */* __restrict  */)"Calling sprintf!\n");
#line 139
        tmp = data_inaddr((u_char const   *)(a_rr->d_data));
#line 139
        tmp___0 = inet_ntoa(tmp);
#line 139
        printf((char const   */* __restrict  */)"sprintf args: %s: query(%s) %s (%s:%s)",
               sysloginfo, queryname, complaint, dname, tmp___0);
#line 145
        tmp___1 = strlen(sysloginfo);
#line 145
        tmp___2 = strlen(queryname);
#line 145
        len = (int )(tmp___1 + tmp___2);
#line 146
        buf[len] = (char)0;
        }
      } else {
        {
#line 156
        printf((char const   */* __restrict  */)"Calling sprintf!\n");
#line 157
        tmp___3 = data_inaddr((u_char const   *)(a_rr->d_data));
#line 157
        tmp___4 = inet_ntoa(tmp___3);
#line 157
        printf((char const   */* __restrict  */)"sprintf args: %s: query(%s) %s (%s:%s)",
               sysloginfo, queryname, complaint, dname, tmp___4);
#line 163
        tmp___5 = strlen(sysloginfo);
#line 163
        tmp___6 = strlen(queryname);
#line 163
        len___0 = (int )(tmp___5 + tmp___6);
#line 164
        buf[len___0] = (char)0;
#line 169
        syslog(6, (char const   *)(buf));
#line 170
        tmp___7 = strlen((char const   *)(buf));
#line 170
        printf((char const   */* __restrict  */)"strlen(buf) = %d\n", tmp___7);
        }
      }
    }
  }
#line 173
  return;
}
}
#line 216 "ns-lookup-bad.c"
static struct in_addr nsa  ;
#line 253
int nslookup(struct databuf **nsp , char const   *syslogdname , char const   *sysloginfo ) ;
#line 253 "ns-lookup-bad.c"
static char *complaint  =    (char *)"Bogus (0.0.0.0) A RR";
#line 262
int nslookup(struct databuf **nsp , char const   *syslogdname , char const   *sysloginfo ) ;
#line 262 "ns-lookup-bad.c"
static char *complaint___0  =    (char *)"Bogus LOOPBACK A RR";
#line 271
int nslookup(struct databuf **nsp , char const   *syslogdname , char const   *sysloginfo ) ;
#line 271 "ns-lookup-bad.c"
static char *complaint___1  =    (char *)"Bogus BROADCAST A RR";
#line 207 "ns-lookup-bad.c"
int nslookup(struct databuf **nsp , char const   *syslogdname , char const   *sysloginfo ) 
{ 
  register struct namebuf *np ;
  register struct databuf *dp ;
  register struct databuf *nsdp ;
  u_char *dname ;
  int i ;
  int class ;
  int found_arr ;
  struct namebuf *tmp ;
  struct in_addr tmp___0 ;
  struct in_addr tmp___1 ;
  uint32_t tmp___2 ;
  struct in_addr tmp___3 ;
  uint32_t tmp___4 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;

  {
  {
#line 215
  found_arr = 0;
#line 218
  printf((char const   */* __restrict  */)"syslogdname = %s\n", syslogdname);
#line 219
  printf((char const   */* __restrict  */)"sysloginfo = %s\n", sysloginfo);
#line 223
  i = 0;
  }
  {
#line 223
  while (1) {
    while_continue: /* CIL Label */ ;
#line 223
    if (! (i < 2)) {
#line 223
      goto while_break;
    }
    {
#line 224
    printf((char const   */* __restrict  */)"i=%d\n", i);
#line 225
    nsdp = *(nsp + i);
#line 227
    class = (int )nsdp->d_class;
#line 229
    printf((char const   */* __restrict  */)"Class = %d\n", class);
#line 231
    printf((char const   */* __restrict  */)"C_IN = %d, class = %d\n", 1, class);
#line 232
    dname = nsdp->d_data;
#line 234
    tmp = nlookup(dname);
#line 234
    np = tmp;
#line 239
    dp = np->n_data;
    }
    {
#line 239
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 239
      if (! ((unsigned long )dp != (unsigned long )((void *)0))) {
#line 239
        goto while_break___0;
      }
      {
#line 240
      printf((char const   */* __restrict  */)"We\'re inside for loop!\n");
#line 246
      printf((char const   */* __restrict  */)"T_A = %d, dp->d_type = %d\n", 1, (int )dp->d_type);
      }
#line 248
      if ((int )dp->d_type == 5) {
#line 248
        if ((int )dp->d_class == class) {
#line 249
          goto finish;
        }
      }
#line 250
      if ((int )dp->d_type != 1) {
#line 251
        goto __Cont;
      } else
#line 250
      if ((int )dp->d_class != class) {
#line 251
        goto __Cont;
      }
      {
#line 252
      tmp___0 = data_inaddr((u_char const   *)(dp->d_data));
      }
#line 252
      if (tmp___0.s_addr == 0U) {
        {
#line 254
        printf((char const   */* __restrict  */)"Calling nslookupComplain!\n");
#line 255
        nslookupComplain(sysloginfo, syslogdname, (char const   *)complaint, (char const   *)dname,
                         (struct databuf  const  *)dp, (struct databuf  const  *)nsdp);
        }
#line 257
        goto __Cont;
      }
      {
#line 260
      tmp___1 = data_inaddr((u_char const   *)(dp->d_data));
#line 260
      tmp___2 = ntohl(tmp___1.s_addr);
      }
#line 260
      if (tmp___2 == 2130706433U) {
        {
#line 263
        nslookupComplain(sysloginfo, syslogdname, (char const   *)complaint___0, (char const   *)dname,
                         (struct databuf  const  *)dp, (struct databuf  const  *)nsdp);
        }
#line 265
        goto __Cont;
      }
      {
#line 269
      tmp___3 = data_inaddr((u_char const   *)(dp->d_data));
#line 269
      tmp___4 = ntohl(tmp___3.s_addr);
      }
#line 269
      if (tmp___4 == 4294967295U) {
        {
#line 272
        nslookupComplain(sysloginfo, syslogdname, (char const   *)complaint___1, (char const   *)dname,
                         (struct databuf  const  *)dp, (struct databuf  const  *)nsdp);
        }
#line 274
        goto __Cont;
      }
      {
#line 277
      found_arr ++;
#line 278
      nsa = data_inaddr((u_char const   *)(dp->d_data));
      }
      __Cont: /* CIL Label */ 
#line 239
      dp = dp->d_next;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 281
    nsp ++;
#line 223
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  finish: 
#line 284
  return (found_arr);
}
}
#line 291 "ns-lookup-bad.c"
struct namebuf *nlookup(u_char *dname ) 
{ 
  struct databuf **double_nb ;
  struct namebuf *nbuf ;
  void *tmp ;
  struct databuf **tmp___0 ;
  struct databuf **tmp___1 ;

  {
  {
#line 293
  tmp = calloc((size_t )1, sizeof(struct namebuf ));
#line 293
  nbuf = (struct namebuf *)tmp;
#line 295
  tmp___0 = create_databuf_list(1);
#line 295
  double_nb = tmp___0;
#line 296
  tmp___1 = double_nb;
#line 296
  double_nb ++;
#line 296
  nbuf->n_data = *tmp___1;
  }
#line 298
  return (nbuf);
}
}
#line 307 "ns-lookup-bad.c"
struct in_addr data_inaddr(u_char const   *data ) 
{ 
  struct in_addr ret ;
  u_int32_t tmp ;

  {
  {
#line 314
  bcopy((void const   *)((char *)data), (void *)((char *)(& tmp)), (size_t )4);
#line 316
  ret.s_addr = tmp;
  }
#line 318
  return (ret);
}
}
#line 327 "ns-lookup-bad.c"
struct databuf **create_databuf_list(int num ) 
{ 
  struct databuf **dbl ;
  struct databuf **temp ;
  int i ;
  FILE *f ;
  void *tmp ;
  void *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;

  {
  {
#line 333
  tmp = malloc((unsigned long )num * sizeof(struct databuf *));
#line 333
  dbl = (struct databuf **)tmp;
#line 334
  temp = dbl;
#line 336
  f = fopen((char const   */* __restrict  */)"address_file", (char const   */* __restrict  */)"r");
#line 339
  i = 0;
  }
  {
#line 339
  while (1) {
    while_continue: /* CIL Label */ ;
#line 339
    if (! (i < num)) {
#line 339
      goto while_break;
    }
    {
#line 340
    tmp___0 = calloc((size_t )1, sizeof(struct databuf ));
#line 340
    *dbl = (struct databuf *)tmp___0;
#line 342
    tmp___1 = _IO_getc(f);
#line 342
    (*dbl)->d_data[0] = (u_char )tmp___1;
#line 343
    tmp___2 = _IO_getc(f);
#line 343
    (*dbl)->d_data[1] = (u_char )tmp___2;
#line 344
    tmp___3 = _IO_getc(f);
#line 344
    (*dbl)->d_data[2] = (u_char )tmp___3;
#line 345
    tmp___4 = _IO_getc(f);
#line 345
    (*dbl)->d_data[3] = (u_char )tmp___4;
#line 346
    (*dbl)->d_class = (int16_t )1;
#line 347
    (*dbl)->d_type = (int16_t )1;
#line 348
    (*dbl)->d_next = (struct databuf *)((void *)0);
#line 353
    dbl ++;
#line 339
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 356
  fclose(f);
  }
#line 358
  return (temp);
}
}
#line 363 "ns-lookup-bad.c"
int main(int argc , char **argv ) 
{ 
  struct databuf **nsp ;
  char syslogdname[1000] ;
  char sysloginfo[1000] ;
  FILE *f ;
  struct databuf **tmp ;
  void *__cil_tmp8 ;
  void *__cil_tmp9 ;
  char *__cil_tmp10 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;

  {
#line 368
  if (! (argc == 2)) {
    {
#line 368
    __assert_fail("argc == 2", "ns-lookup-bad.c", 368U, "main");
    }
  }
  {
#line 369
  f = fopen((char const   */* __restrict  */)*(argv + 1), (char const   */* __restrict  */)"r");
  }
#line 370
  if (! ((unsigned long )f != (unsigned long )((void *)0))) {
    {
#line 370
    __assert_fail("f!=((void *)0)", "ns-lookup-bad.c", 370U, "main");
    }
  }
  {
#line 372
  fgets((char */* __restrict  */)(syslogdname), 1000, (FILE */* __restrict  */)f);
#line 373
  fgets((char */* __restrict  */)(sysloginfo), 1000, (FILE */* __restrict  */)f);
#line 375
  fclose(f);
#line 377
  tmp = create_databuf_list(2);
#line 377
  nsp = tmp;
#line 378
  nslookup(nsp, (char const   *)(syslogdname), (char const   *)(sysloginfo));
  }
#line 380
  return (0);
}
}
