/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 124 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __dev_t;
#line 125 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 126 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __gid_t;
#line 127 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __ino_t;
#line 129 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __mode_t;
#line 130 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __nlink_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 153 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blksize_t;
#line 158 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blkcnt_t;
#line 175 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __syscall_slong_t;
#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 120 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   __syscall_slong_t tv_nsec ;
};
#line 46 "/usr/include/x86_64-linux-gnu/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   __ino_t st_ino ;
   __nlink_t st_nlink ;
   __mode_t st_mode ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   int __pad0 ;
   __dev_t st_rdev ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __syscall_slong_t __glibc_reserved[3] ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 71 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
struct __anonstruct_FLVMetaData_t_28 {
   int hasKeyframes ;
   int hasVideo ;
   int hasAudio ;
   int hasMetadata ;
   int hasCuePoints ;
   int canSeekToEnd ;
   double audiocodecid ;
   double audiosamplerate ;
   double audiodatarate ;
   double audiosamplesize ;
   double audiodelay ;
   int stereo ;
   double videocodecid ;
   double framerate ;
   double videodatarate ;
   double height ;
   double width ;
   double datasize ;
   double audiosize ;
   double videosize ;
   double filesize ;
   double lasttimestamp ;
   double lastvideoframetimestamp ;
   double lastkeyframetimestamp ;
   double lastkeyframelocation ;
   int keyframes ;
   double *filepositions ;
   double *times ;
   double duration ;
   char metadatacreator[256] ;
   char creator[256] ;
   int onmetadatalength ;
   int metadatasize ;
   size_t onlastsecondlength ;
   size_t lastsecondsize ;
   int hasLastSecond ;
   int lastsecondTagCount ;
   size_t onlastkeyframelength ;
   size_t lastkeyframesize ;
   int hasLastKeyframe ;
};
#line 71 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
typedef struct __anonstruct_FLVMetaData_t_28 FLVMetaData_t;
#line 123 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
struct __anonstruct_FLVFileHeader_t_29 {
   unsigned char signature[3] ;
   unsigned char version ;
   unsigned char flags ;
   unsigned char headersize[4] ;
};
#line 123 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
typedef struct __anonstruct_FLVFileHeader_t_29 FLVFileHeader_t;
#line 130 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
struct __anonstruct_FLVTag_t_30 {
   unsigned char type ;
   unsigned char datasize[3] ;
   unsigned char timestamp[3] ;
   unsigned char timestamp_ex ;
   unsigned char streamid[3] ;
};
#line 130 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
typedef struct __anonstruct_FLVTag_t_30 FLVTag_t;
#line 138 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
struct __anonstruct_FLVAudioData_t_31 {
   unsigned char flags ;
};
#line 138 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
typedef struct __anonstruct_FLVAudioData_t_31 FLVAudioData_t;
#line 142 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
struct __anonstruct_FLVVideoData_t_32 {
   unsigned char flags ;
};
#line 142 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
typedef struct __anonstruct_FLVVideoData_t_32 FLVVideoData_t;
#line 1270 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
union __anonunion_d_33 {
   unsigned char dc[8] ;
   double dd ;
};
#line 57 "/usr/include/x86_64-linux-gnu/sys/mman.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) mmap)(void *__addr ,
                                                                             size_t __len ,
                                                                             int __prot ,
                                                                             int __flags ,
                                                                             int __fd ,
                                                                             __off_t __offset ) ;
#line 209 "/usr/include/x86_64-linux-gnu/sys/stat.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) stat)(char const   * __restrict  __file ,
                                                                                             struct stat * __restrict  __buf ) ;
#line 169 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 170
extern struct _IO_FILE *stderr ;
#line 237
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 715
extern size_t fwrite(void const   * __restrict  __ptr , size_t __size , size_t __n ,
                     FILE * __restrict  __s ) ;
#line 858
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) fileno)(FILE *__stream ) ;
#line 468 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) calloc)(size_t __nmemb ,
                                                                               size_t __size )  __attribute__((__malloc__)) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 66 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 132
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strncpy)(char * __restrict  __dest ,
                                                                                                  char const   * __restrict  __src ,
                                                                                                  size_t __n ) ;
#line 144
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strcmp)(char const   *__s1 ,
                                                                                               char const   *__s2 )  __attribute__((__pure__)) ;
#line 147
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strncmp)(char const   *__s1 ,
                                                                                                char const   *__s2 ,
                                                                                                size_t __n )  __attribute__((__pure__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 57 "/usr/include/getopt.h"
extern char *optarg ;
#line 76
extern int opterr ;
#line 80
extern int optopt ;
#line 150
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) getopt)(int ___argc ,
                                                                             char * const  *___argv ,
                                                                             char const   *__shortopts ) ;
#line 121 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
FLVMetaData_t flvmetadata  ;
#line 146
void initFLVMetaData(char const   *creator , int lastsecond , int lastkeyframe ) ;
#line 147
size_t writeFLVMetaData(FILE *fp ) ;
#line 148
size_t writeFLVLastSecond(FILE *fp , double timestamp ) ;
#line 149
size_t writeFLVLastKeyframe(FILE *fp ) ;
#line 151
void readFLVFirstPass(char *flv , size_t streampos , size_t filesize ) ;
#line 152
void readFLVSecondPass(char *flv , size_t streampos , size_t filesize ) ;
#line 153
void readFLVH263VideoPacket(unsigned char const   *h263 ) ;
#line 154
void readFLVScreenVideoPacket(unsigned char const   *sv ) ;
#line 155
void readFLVVP62VideoPacket(unsigned char const   *vp62 ) ;
#line 156
void readFLVVP62AlphaVideoPacket(unsigned char const   *vp62a ) ;
#line 158
size_t writeFLVScriptDataValueArray(FILE *fp , char const   *name , size_t len ) ;
#line 159
size_t writeFLVScriptDataECMAArray(FILE *fp , char const   *name , size_t len ) ;
#line 160
size_t writeFLVScriptDataVariableArray(FILE *fp , char const   *name ) ;
#line 161
size_t writeFLVScriptDataVariableArrayEnd(FILE *fp ) ;
#line 162
size_t writeFLVScriptDataValueString(FILE *fp , char const   *name , char const   *value ) ;
#line 163
size_t writeFLVScriptDataValueBool(FILE *fp , char const   *name , int value ) ;
#line 164
size_t writeFLVScriptDataValueDouble(FILE *fp , char const   *name , double value ) ;
#line 165
size_t writeFLVScriptDataObject(FILE *fp ) ;
#line 167
size_t writeFLVPreviousTagSize(FILE *fp , size_t datasize ) ;
#line 169
size_t writeFLVScriptDataString(FILE *fp , char const   *s ) ;
#line 170
size_t writeFLVScriptDataLongString(FILE *fp , char const   *s ) ;
#line 171
size_t writeFLVBool(FILE *fp , int value ) ;
#line 172
size_t writeFLVDouble(FILE *fp , double value ) ;
#line 174
void writeFLV(FILE *fp , char *flv , size_t streampos , size_t filesize ) ;
#line 175
void writeXMLMetadata(FILE *fp , char const   *infile , char const   *outfile ) ;
#line 176
void writeFLVHeader(FILE *fp ) ;
#line 178
void print_usage(void) ;
#line 180 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
int main(int argc , char **argv ) 
{ 
  FILE *fp_infile ;
  FILE *fp_outfile ;
  FILE *fp_xmloutfile ;
  FILE *devnull ;
  int c ;
  int lastsecond ;
  int lastkeyframe ;
  char *flv ;
  char *infile ;
  char *outfile ;
  char *xmloutfile ;
  char *creator ;
  unsigned int i ;
  size_t filesize ;
  size_t streampos ;
  size_t metadatasize ;
  struct stat sb ;
  FLVFileHeader_t *flvfileheader ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  void *tmp___4 ;
  int tmp___5 ;

  {
#line 181
  fp_infile = (FILE *)((void *)0);
#line 181
  fp_outfile = (FILE *)((void *)0);
#line 181
  fp_xmloutfile = (FILE *)((void *)0);
#line 185
  lastsecond = 0;
#line 185
  lastkeyframe = 0;
#line 188
  filesize = (size_t )0;
#line 192
  opterr = 0;
#line 194
  infile = (char *)((void *)0);
#line 195
  outfile = (char *)((void *)0);
#line 196
  xmloutfile = (char *)((void *)0);
#line 197
  creator = (char *)((void *)0);
  {
#line 199
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 199
    c = getopt(argc, (char * const  *)argv, "i:o:x:c:lkh");
    }
#line 199
    if (! (c != -1)) {
#line 199
      goto while_break;
    }
    {
#line 201
    if (c == 105) {
#line 201
      goto case_105;
    }
#line 234
    if (c == 111) {
#line 234
      goto case_111;
    }
#line 256
    if (c == 120) {
#line 256
      goto case_120;
    }
#line 267
    if (c == 99) {
#line 267
      goto case_99;
    }
#line 270
    if (c == 108) {
#line 270
      goto case_108;
    }
#line 273
    if (c == 107) {
#line 273
      goto case_107;
    }
#line 276
    if (c == 104) {
#line 276
      goto case_104;
    }
#line 280
    if (c == 58) {
#line 280
      goto case_58;
    }
#line 284
    if (c == 63) {
#line 284
      goto case_63;
    }
#line 288
    goto switch_default;
    case_105: /* CIL Label */ 
#line 202
    if ((unsigned long )infile == (unsigned long )((void *)0)) {
#line 203
      infile = optarg;
#line 205
      if ((unsigned long )outfile != (unsigned long )((void *)0)) {
        {
#line 206
        tmp = strcmp((char const   *)infile, (char const   *)outfile);
        }
#line 206
        if (! tmp) {
          {
#line 207
          fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Input file and output file must not be the same.\n");
#line 208
          exit(1);
          }
        }
      }
      {
#line 212
      tmp___0 = stat((char const   */* __restrict  */)infile, (struct stat */* __restrict  */)(& sb));
      }
#line 212
      if (tmp___0 == -1) {
        {
#line 213
        fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t stat on %s.\n",
                infile);
#line 214
        exit(1);
        }
      }
      {
#line 217
      filesize = (size_t )sb.st_size;
#line 220
      fp_infile = fopen((char const   */* __restrict  */)infile, (char const   */* __restrict  */)"rb");
      }
#line 227
      if ((unsigned long )fp_infile == (unsigned long )((void *)0)) {
        {
#line 228
        fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t open %s.\n",
                infile);
#line 229
        exit(1);
        }
      }
    }
#line 233
    goto switch_break;
    case_111: /* CIL Label */ 
#line 235
    if ((unsigned long )outfile == (unsigned long )((void *)0)) {
#line 236
      outfile = optarg;
#line 238
      if ((unsigned long )infile != (unsigned long )((void *)0)) {
        {
#line 239
        tmp___1 = strcmp((char const   *)infile, (char const   *)outfile);
        }
#line 239
        if (! tmp___1) {
          {
#line 240
          fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Input file and output file must not be the same.\n");
#line 241
          exit(1);
          }
        }
      }
      {
#line 245
      tmp___2 = strcmp((char const   *)outfile, "-");
      }
#line 245
      if (tmp___2) {
        {
#line 246
        fp_outfile = fopen((char const   */* __restrict  */)outfile, (char const   */* __restrict  */)"wb");
        }
#line 247
        if ((unsigned long )fp_outfile == (unsigned long )((void *)0)) {
          {
#line 248
          fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t open %s.\n",
                  outfile);
#line 249
          exit(1);
          }
        }
      } else {
#line 253
        fp_outfile = stdout;
      }
    }
#line 255
    goto switch_break;
    case_120: /* CIL Label */ 
#line 257
    if ((unsigned long )xmloutfile == (unsigned long )((void *)0)) {
      {
#line 258
      xmloutfile = optarg;
#line 260
      fp_xmloutfile = fopen((char const   */* __restrict  */)xmloutfile, (char const   */* __restrict  */)"wb");
      }
#line 261
      if ((unsigned long )fp_xmloutfile == (unsigned long )((void *)0)) {
        {
#line 262
        fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t open %s.\n",
                outfile);
#line 263
        exit(1);
        }
      }
    }
#line 266
    goto switch_break;
    case_99: /* CIL Label */ 
#line 268
    creator = optarg;
#line 269
    goto switch_break;
    case_108: /* CIL Label */ 
#line 271
    lastsecond = 1;
#line 272
    goto switch_break;
    case_107: /* CIL Label */ 
#line 274
    lastkeyframe = 1;
#line 275
    goto switch_break;
    case_104: /* CIL Label */ 
    {
#line 277
    print_usage();
#line 278
    exit(1);
    }
#line 279
    goto switch_break;
    case_58: /* CIL Label */ 
    {
#line 281
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"The option -%c expects a parameter. -h for help.\n",
            optopt);
#line 282
    exit(1);
    }
#line 283
    goto switch_break;
    case_63: /* CIL Label */ 
    {
#line 285
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Unknown option: -%c. -h for help.\n",
            optopt);
#line 286
    exit(1);
    }
#line 287
    goto switch_break;
    switch_default: /* CIL Label */ 
    {
#line 289
    print_usage();
#line 290
    exit(1);
    }
#line 291
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 295
  if ((unsigned long )infile == (unsigned long )((void *)0)) {
    {
#line 296
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Please provide an input file. -h for help.\n");
#line 297
    exit(1);
    }
  }
#line 300
  if ((unsigned long )outfile == (unsigned long )((void *)0)) {
#line 300
    if ((unsigned long )xmloutfile == (unsigned long )((void *)0)) {
      {
#line 301
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Please provide at least one output file. -h for help.\n");
#line 302
      exit(1);
      }
    }
  }
  {
#line 307
  tmp___3 = fileno(fp_infile);
#line 307
  tmp___4 = mmap((void *)0, filesize, 1, 2, tmp___3, (__off_t )0);
#line 307
  flv = (char *)tmp___4;
  }
#line 317
  if ((unsigned long )flv == (unsigned long )((void *)0)) {
    {
#line 318
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t load %s.\n",
            infile);
#line 319
    exit(1);
    }
  }
  {
#line 322
  tmp___5 = strncmp((char const   *)flv, "FLV", (size_t )3);
  }
#line 322
  if (tmp___5) {
    {
#line 323
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"The input file is not a FLV.\n");
#line 324
    exit(1);
    }
  }
  {
#line 328
  initFLVMetaData((char const   *)creator, lastsecond, lastkeyframe);
#line 330
  flvfileheader = (FLVFileHeader_t *)flv;
#line 333
  streampos = (size_t )((((((int )flvfileheader->headersize[0] << 24) + ((int )flvfileheader->headersize[1] << 16)) + ((int )flvfileheader->headersize[2] << 8)) + (int )flvfileheader->headersize[3]) + 4);
#line 336
  readFLVFirstPass(flv, streampos, filesize);
#line 339
  devnull = fopen((char const   */* __restrict  */)"/dev/null", (char const   */* __restrict  */)"wb");
  }
#line 344
  if ((unsigned long )devnull == (unsigned long )((void *)0)) {
    {
#line 345
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Couldn\'t open NULL device.\n");
#line 346
    exit(1);
    }
  }
  {
#line 350
  metadatasize = writeFLVMetaData(devnull);
#line 351
  flvmetadata.lastsecondsize = writeFLVLastSecond(devnull, 0.0);
#line 352
  flvmetadata.lastkeyframesize = writeFLVLastKeyframe(devnull);
#line 354
  fclose(devnull);
  }
#line 357
  if (flvmetadata.hasKeyframes == 1) {
    {
#line 358
    readFLVSecondPass(flv, streampos, filesize);
#line 361
    i = 0U;
    }
    {
#line 361
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 361
      if (! (i < (unsigned int )flvmetadata.keyframes)) {
#line 361
        goto while_break___0;
      }
#line 362
      *(flvmetadata.filepositions + i) += (double )((sizeof(FLVFileHeader_t ) + 4UL) + metadatasize);
#line 361
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 364
    flvmetadata.lastkeyframelocation = *(flvmetadata.filepositions + (flvmetadata.keyframes - 1));
  }
#line 368
  flvmetadata.filesize = (double )((sizeof(FLVFileHeader_t ) + 4UL) + metadatasize) + flvmetadata.datasize;
#line 369
  if (flvmetadata.hasLastSecond == 1) {
#line 370
    flvmetadata.filesize += (double )flvmetadata.lastsecondsize;
  }
#line 372
  if ((unsigned long )outfile != (unsigned long )((void *)0)) {
    {
#line 373
    writeFLV(fp_outfile, flv, streampos, filesize);
    }
  }
#line 375
  if ((unsigned long )xmloutfile != (unsigned long )((void *)0)) {
    {
#line 376
    writeXMLMetadata(fp_xmloutfile, (char const   *)infile, (char const   *)outfile);
    }
  }
#line 378
  return (0);
}
}
#line 381 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void writeFLV(FILE *fp , char *flv , size_t streampos , size_t filesize ) 
{ 
  int tagcount ;
  double currenttimestamp ;
  size_t datasize ;
  FLVTag_t *flvtag ;

  {
  {
#line 387
  writeFLVHeader(fp);
#line 388
  writeFLVMetaData(fp);
#line 390
  tagcount = 0;
  }
  {
#line 392
  while (1) {
    while_continue: /* CIL Label */ ;
#line 393
    if (streampos + sizeof(FLVTag_t ) > filesize) {
#line 394
      goto while_break;
    }
#line 396
    flvtag = (FLVTag_t *)(flv + streampos);
#line 399
    datasize = (sizeof(FLVTag_t ) + (unsigned long )((((int )flvtag->datasize[0] << 16) + ((int )flvtag->datasize[1] << 8)) + (int )flvtag->datasize[2])) + 4UL;
#line 401
    if (streampos + datasize > filesize) {
#line 402
      goto while_break;
    }
#line 404
    if ((int )flvtag->type == 9) {
#line 404
      goto _L;
    } else
#line 404
    if ((int )flvtag->type == 8) {
      _L: /* CIL Label */ 
      {
#line 405
      fwrite((void const   */* __restrict  */)(flv + streampos), datasize, (size_t )1,
             (FILE */* __restrict  */)fp);
      }
#line 407
      if ((int )flvtag->type == 9) {
#line 407
        if (flvmetadata.hasLastSecond == 1) {
#line 408
          tagcount ++;
#line 410
          if (tagcount == flvmetadata.lastsecondTagCount) {
            {
#line 411
            currenttimestamp = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
#line 412
            writeFLVLastSecond(fp, currenttimestamp);
            }
          }
        }
      }
    }
#line 417
    streampos += datasize;
  }
  while_break: /* CIL Label */ ;
  }
#line 420
  return;
}
}
#line 423 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void writeXMLMetadata(FILE *fp , char const   *infile , char const   *outfile ) 
{ 
  int i ;
  char *hasit ;

  {
  {
#line 427
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n");
#line 428
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<fileset>\n");
  }
#line 430
  if ((unsigned long )outfile != (unsigned long )((void *)0)) {
    {
#line 431
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<flv name=\"%s\">\n",
            outfile);
    }
  } else {
    {
#line 433
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<flv name=\"%s\">\n",
            infile);
    }
  }
#line 435
  if (flvmetadata.hasKeyframes > 0) {
#line 435
    hasit = (char *)"true";
  } else {
#line 435
    hasit = (char *)"false";
  }
  {
#line 436
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<hasKeyframes>%s</hasKeyframes>\n",
          hasit);
  }
#line 438
  if (flvmetadata.hasVideo > 0) {
#line 438
    hasit = (char *)"true";
  } else {
#line 438
    hasit = (char *)"false";
  }
  {
#line 439
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<hasVideo>%s</hasVideo>\n",
          hasit);
  }
#line 441
  if (flvmetadata.hasAudio > 0) {
#line 441
    hasit = (char *)"true";
  } else {
#line 441
    hasit = (char *)"false";
  }
  {
#line 442
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<hasAudio>%s</hasAudio>\n",
          hasit);
  }
#line 444
  if (flvmetadata.hasMetadata > 0) {
#line 444
    hasit = (char *)"true";
  } else {
#line 444
    hasit = (char *)"false";
  }
  {
#line 445
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<hasMetadata>%s</hasMetadata>\n",
          hasit);
  }
#line 447
  if (flvmetadata.hasCuePoints > 0) {
#line 447
    hasit = (char *)"true";
  } else {
#line 447
    hasit = (char *)"false";
  }
  {
#line 448
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<hasCuePoints>%s</hasCuePoints>\n",
          hasit);
  }
#line 450
  if (flvmetadata.canSeekToEnd > 0) {
#line 450
    hasit = (char *)"true";
  } else {
#line 450
    hasit = (char *)"false";
  }
  {
#line 451
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<canSeekToEnd>%s</canSeekToEnd>\n",
          hasit);
#line 453
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiocodecid>%i</audiocodecid>\n",
          (int )flvmetadata.audiocodecid);
#line 454
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiosamplerate>%i</audiosamplerate>\n",
          (int )flvmetadata.audiosamplerate);
#line 455
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiodatarate>%i</audiodatarate>\n",
          (int )flvmetadata.audiodatarate);
#line 456
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiosamplesize>%i</audiosamplesize>\n",
          (int )flvmetadata.audiosamplesize);
#line 457
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiodelay>%.2f</audiodelay>\n",
          flvmetadata.audiodelay);
  }
#line 458
  if (flvmetadata.stereo > 0) {
#line 458
    hasit = (char *)"true";
  } else {
#line 458
    hasit = (char *)"false";
  }
  {
#line 459
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<stereo>%s</stereo>\n",
          hasit);
#line 461
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<videocodecid>%i</videocodecid>\n",
          (int )flvmetadata.videocodecid);
#line 462
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<framerate>%.2f</framerate>\n",
          flvmetadata.framerate);
#line 463
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<videodatarate>%i</videodatarate>\n",
          (int )flvmetadata.videodatarate);
#line 464
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<height>%i</height>\n",
          (int )flvmetadata.height);
#line 465
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<width>%i</width>\n",
          (int )flvmetadata.width);
#line 467
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<datasize>%i</datasize>\n",
          (int )flvmetadata.datasize);
#line 468
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<audiosize>%i</audiosize>\n",
          (int )flvmetadata.audiosize);
#line 469
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<videosize>%i</videosize>\n",
          (int )flvmetadata.videosize);
#line 470
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<filesize>%i</filesize>\n",
          (int )flvmetadata.filesize);
#line 472
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<lasttimestamp>%.2f</lasttimestamp>\n",
          flvmetadata.lasttimestamp);
#line 473
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<lastvideoframetimestamp>%.2f</lastvideoframetimestamp>\n",
          flvmetadata.lastvideoframetimestamp);
#line 474
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<lastkeyframetimestamp>%.2f</lastkeyframetimestamp>\n",
          flvmetadata.lastkeyframetimestamp);
#line 475
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<lastkeyframelocation>%i</lastkeyframelocation>\n",
          (int )flvmetadata.lastkeyframelocation);
#line 477
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<keyframes>\n");
#line 478
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<times>\n");
#line 480
  i = 0;
  }
  {
#line 480
  while (1) {
    while_continue: /* CIL Label */ ;
#line 480
    if (! (i < flvmetadata.keyframes)) {
#line 480
      goto while_break;
    }
    {
#line 481
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<value id=\"%i\">%.2f</value>\n",
            i, *(flvmetadata.times + i));
#line 480
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 483
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"</times>\n");
#line 484
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<filepositions>\n");
#line 486
  i = 0;
  }
  {
#line 486
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 486
    if (! (i < flvmetadata.keyframes)) {
#line 486
      goto while_break___0;
    }
    {
#line 487
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<value id=\"%i\">%i</value>\n",
            i, (int )*(flvmetadata.filepositions + i));
#line 486
    i ++;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 489
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"</filepositions>\n");
#line 490
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"</keyframes>\n");
#line 491
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"<duration>%.2f</duration>\n",
          flvmetadata.duration);
#line 492
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"</flv>\n");
#line 493
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"</fileset>\n");
  }
#line 495
  return;
}
}
#line 498 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void writeFLVHeader(FILE *fp ) 
{ 
  char *t ;
  size_t size ;
  FLVFileHeader_t flvheader ;

  {
  {
#line 503
  t = (char *)(& flvheader);
#line 504
  memset((void *)t, 0, sizeof(FLVFileHeader_t ));
#line 506
  flvheader.signature[0] = (unsigned char )'F';
#line 507
  flvheader.signature[1] = (unsigned char )'L';
#line 508
  flvheader.signature[2] = (unsigned char )'V';
#line 510
  flvheader.version = (unsigned char)1;
  }
#line 512
  if (flvmetadata.hasAudio == 1) {
#line 513
    flvheader.flags = (unsigned char )((int )flvheader.flags | 4);
  }
#line 515
  if (flvmetadata.hasVideo == 1) {
#line 516
    flvheader.flags = (unsigned char )((int )flvheader.flags | 1);
  }
  {
#line 518
  size = sizeof(FLVFileHeader_t );
#line 519
  flvheader.headersize[0] = (unsigned char )((size >> 24) & 255UL);
#line 520
  flvheader.headersize[1] = (unsigned char )((size >> 16) & 255UL);
#line 521
  flvheader.headersize[2] = (unsigned char )((size >> 8) & 255UL);
#line 522
  flvheader.headersize[3] = (unsigned char )(size & 255UL);
#line 524
  fwrite((void const   */* __restrict  */)t, sizeof(FLVFileHeader_t ), (size_t )1,
         (FILE */* __restrict  */)fp);
#line 526
  writeFLVPreviousTagSize(fp, (size_t )0);
  }
#line 528
  return;
}
}
#line 531 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVSecondPass(char *flv , size_t streampos , size_t filesize ) 
{ 
  int i ;
  int tagcount ;
  int afterlastsecond ;
  double lastsecond ;
  double currenttimestamp ;
  size_t datasize ;
  size_t datapos ;
  FLVTag_t *flvtag ;
  FLVVideoData_t *flvvideo ;

  {
#line 538
  if (flvmetadata.keyframes == 0) {
#line 539
    return;
  }
#line 541
  i = 0;
#line 542
  datapos = (size_t )0;
#line 544
  tagcount = 0;
#line 545
  afterlastsecond = 0;
#line 546
  lastsecond = flvmetadata.lastvideoframetimestamp - 1.0;
  {
#line 548
  while (1) {
    while_continue: /* CIL Label */ ;
#line 549
    if (streampos + sizeof(FLVTag_t ) > filesize) {
#line 550
      goto while_break;
    }
#line 552
    flvtag = (FLVTag_t *)(flv + streampos);
#line 555
    datasize = (sizeof(FLVTag_t ) + (unsigned long )((((int )flvtag->datasize[0] << 16) + ((int )flvtag->datasize[1] << 8)) + (int )flvtag->datasize[2])) + 4UL;
#line 557
    if (streampos + datasize > filesize) {
#line 558
      goto while_break;
    }
#line 560
    if ((int )flvtag->type == 9) {
#line 561
      flvvideo = (FLVVideoData_t *)(flv + (streampos + sizeof(FLVTag_t )));
#line 564
      if ((((int )flvvideo->flags >> 4) & 1) == 1) {
#line 565
        *(flvmetadata.filepositions + i) = (double )datapos;
#line 566
        *(flvmetadata.times + i) = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
#line 568
        i ++;
      }
    }
#line 572
    streampos += datasize;
#line 574
    if ((int )flvtag->type == 9) {
#line 574
      goto _L;
    } else
#line 574
    if ((int )flvtag->type == 8) {
      _L: /* CIL Label */ 
#line 575
      datapos += datasize;
#line 577
      if ((int )flvtag->type == 9) {
#line 577
        if (flvmetadata.hasLastSecond == 1) {
#line 577
          if (afterlastsecond == 0) {
#line 577
            if (lastsecond > 1.0) {
#line 578
              tagcount ++;
#line 579
              currenttimestamp = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
#line 581
              if (currenttimestamp > lastsecond) {
#line 582
                datapos += flvmetadata.lastsecondsize;
#line 583
                flvmetadata.lastsecondTagCount = tagcount;
#line 584
                afterlastsecond = 1;
              }
            }
          }
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 590
  return;
}
}
#line 593 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVFirstPass(char *flv , size_t streampos , size_t filesize ) 
{ 
  size_t datasize ;
  size_t videosize ;
  size_t audiosize ;
  size_t videotags ;
  size_t audiotags ;
  FLVTag_t *flvtag ;
  FLVAudioData_t *flvaudio ;
  FLVVideoData_t *flvvideo ;
  void *tmp ;
  void *tmp___0 ;

  {
#line 594
  videosize = (size_t )0;
#line 594
  audiosize = (size_t )0;
#line 595
  videotags = (size_t )0;
#line 595
  audiotags = (size_t )0;
  {
#line 600
  while (1) {
    while_continue: /* CIL Label */ ;
#line 601
    if (streampos + sizeof(FLVTag_t ) > filesize) {
#line 602
      goto while_break;
    }
#line 604
    flvtag = (FLVTag_t *)(flv + streampos);
#line 607
    datasize = (sizeof(FLVTag_t ) + (unsigned long )((((int )flvtag->datasize[0] << 16) + ((int )flvtag->datasize[1] << 8)) + (int )flvtag->datasize[2])) + 4UL;
#line 609
    if (streampos + datasize > filesize) {
#line 610
      goto while_break;
    }
#line 612
    if ((int )flvtag->type == 8) {
#line 613
      flvmetadata.datasize += (double )datasize;
#line 615
      flvmetadata.audiosize += (double )(datasize - 4UL);
#line 617
      audiosize += (size_t )((((int )flvtag->datasize[0] << 16) + ((int )flvtag->datasize[1] << 8)) + (int )flvtag->datasize[2]);
#line 618
      audiotags ++;
#line 620
      if (flvmetadata.hasAudio == 0) {
#line 621
        flvaudio = (FLVAudioData_t *)(flv + (streampos + sizeof(FLVTag_t )));
#line 624
        flvmetadata.audiocodecid = (double )(((int )flvaudio->flags >> 4) & 15);
        {
#line 628
        if ((((int )flvaudio->flags >> 2) & 3) == 0) {
#line 628
          goto case_0;
        }
#line 631
        if ((((int )flvaudio->flags >> 2) & 3) == 1) {
#line 631
          goto case_1;
        }
#line 634
        if ((((int )flvaudio->flags >> 2) & 3) == 2) {
#line 634
          goto case_2;
        }
#line 637
        if ((((int )flvaudio->flags >> 2) & 3) == 3) {
#line 637
          goto case_3;
        }
#line 640
        goto switch_default;
        case_0: /* CIL Label */ 
#line 629
        flvmetadata.audiosamplerate = 5500.0;
#line 630
        goto switch_break;
        case_1: /* CIL Label */ 
#line 632
        flvmetadata.audiosamplerate = 11000.0;
#line 633
        goto switch_break;
        case_2: /* CIL Label */ 
#line 635
        flvmetadata.audiosamplerate = 22000.0;
#line 636
        goto switch_break;
        case_3: /* CIL Label */ 
#line 638
        flvmetadata.audiosamplerate = 44100.0;
#line 639
        goto switch_break;
        switch_default: /* CIL Label */ 
#line 641
        goto switch_break;
        switch_break: /* CIL Label */ ;
        }
        {
#line 646
        if ((((int )flvaudio->flags >> 1) & 1) == 0) {
#line 646
          goto case_0___0;
        }
#line 649
        if ((((int )flvaudio->flags >> 1) & 1) == 1) {
#line 649
          goto case_1___0;
        }
#line 652
        goto switch_default___0;
        case_0___0: /* CIL Label */ 
#line 647
        flvmetadata.audiosamplesize = 8.0;
#line 648
        goto switch_break___0;
        case_1___0: /* CIL Label */ 
#line 650
        flvmetadata.audiosamplesize = 16.0;
#line 651
        goto switch_break___0;
        switch_default___0: /* CIL Label */ 
#line 653
        goto switch_break___0;
        switch_break___0: /* CIL Label */ ;
        }
#line 657
        flvmetadata.stereo = (int )flvaudio->flags & 1;
#line 659
        flvmetadata.hasAudio = 1;
      }
    } else
#line 662
    if ((int )flvtag->type == 9) {
#line 663
      flvmetadata.datasize += (double )datasize;
#line 665
      flvmetadata.videosize += (double )(datasize - 4UL);
#line 667
      videosize += (size_t )((((int )flvtag->datasize[0] << 16) + ((int )flvtag->datasize[1] << 8)) + (int )flvtag->datasize[2]);
#line 668
      videotags ++;
#line 670
      flvvideo = (FLVVideoData_t *)(flv + (streampos + sizeof(FLVTag_t )));
#line 672
      if (flvmetadata.hasVideo == 0) {
#line 674
        flvmetadata.videocodecid = (double )((int )flvvideo->flags & 15);
#line 676
        flvmetadata.hasVideo = 1;
        {
#line 679
        if (((int )flvvideo->flags & 15) == 2) {
#line 679
          goto case_2___0;
        }
#line 682
        if (((int )flvvideo->flags & 15) == 3) {
#line 682
          goto case_3___0;
        }
#line 685
        if (((int )flvvideo->flags & 15) == 4) {
#line 685
          goto case_4;
        }
#line 688
        if (((int )flvvideo->flags & 15) == 5) {
#line 688
          goto case_5;
        }
#line 691
        if (((int )flvvideo->flags & 15) == 6) {
#line 691
          goto case_6;
        }
#line 694
        goto switch_default___1;
        case_2___0: /* CIL Label */ 
        {
#line 680
        readFLVH263VideoPacket((unsigned char const   *)((unsigned char *)(flv + ((streampos + sizeof(FLVTag_t )) + sizeof(FLVVideoData_t )))));
        }
#line 681
        goto switch_break___1;
        case_3___0: /* CIL Label */ 
        {
#line 683
        readFLVScreenVideoPacket((unsigned char const   *)((unsigned char *)(flv + ((streampos + sizeof(FLVTag_t )) + sizeof(FLVVideoData_t )))));
        }
#line 684
        goto switch_break___1;
        case_4: /* CIL Label */ 
        {
#line 686
        readFLVVP62VideoPacket((unsigned char const   *)((unsigned char *)(flv + ((streampos + sizeof(FLVTag_t )) + sizeof(FLVVideoData_t )))));
        }
#line 687
        goto switch_break___1;
        case_5: /* CIL Label */ 
        {
#line 689
        readFLVVP62AlphaVideoPacket((unsigned char const   *)((unsigned char *)(flv + ((streampos + sizeof(FLVTag_t )) + sizeof(FLVVideoData_t )))));
        }
#line 690
        goto switch_break___1;
        case_6: /* CIL Label */ 
        {
#line 692
        readFLVScreenVideoPacket((unsigned char const   *)((unsigned char *)(flv + ((streampos + sizeof(FLVTag_t )) + sizeof(FLVVideoData_t )))));
        }
#line 693
        goto switch_break___1;
        switch_default___1: /* CIL Label */ 
#line 695
        goto switch_break___1;
        switch_break___1: /* CIL Label */ ;
        }
      }
#line 700
      if ((((int )flvvideo->flags >> 4) & 1) == 1) {
#line 701
        flvmetadata.canSeekToEnd = 1;
#line 702
        (flvmetadata.keyframes) ++;
#line 703
        flvmetadata.lastkeyframetimestamp = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
      } else {
#line 706
        flvmetadata.canSeekToEnd = 0;
      }
#line 708
      flvmetadata.lastvideoframetimestamp = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
    }
#line 711
    flvmetadata.lasttimestamp = (double )(((((int )flvtag->timestamp_ex << 24) + ((int )flvtag->timestamp[0] << 16)) + ((int )flvtag->timestamp[1] << 8)) + (int )flvtag->timestamp[2]) / 1000.0;
#line 713
    streampos += datasize;
  }
  while_break: /* CIL Label */ ;
  }
#line 716
  flvmetadata.duration = flvmetadata.lasttimestamp;
#line 718
  if (flvmetadata.keyframes != 0) {
#line 719
    flvmetadata.hasKeyframes = 1;
  }
#line 721
  if (flvmetadata.hasKeyframes == 1) {
    {
#line 722
    tmp = calloc((size_t )flvmetadata.keyframes, sizeof(double ));
#line 722
    flvmetadata.filepositions = (double *)tmp;
#line 723
    tmp___0 = calloc((size_t )flvmetadata.keyframes, sizeof(double ));
#line 723
    flvmetadata.times = (double *)tmp___0;
    }
#line 725
    if ((unsigned long )flvmetadata.filepositions == (unsigned long )((void *)0)) {
      {
#line 726
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Not enough memory for the keyframe index.\n");
#line 727
      exit(1);
      }
    } else
#line 725
    if ((unsigned long )flvmetadata.times == (unsigned long )((void *)0)) {
      {
#line 726
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Not enough memory for the keyframe index.\n");
#line 727
      exit(1);
      }
    }
  }
#line 732
  if (videotags != 0UL) {
#line 733
    flvmetadata.framerate = (double )videotags / flvmetadata.duration;
  }
#line 736
  if (videosize != 0UL) {
#line 737
    flvmetadata.videodatarate = ((double )(videosize * 8UL) / 1024.0) / flvmetadata.duration;
  }
#line 740
  if (audiosize != 0UL) {
#line 741
    flvmetadata.audiodatarate = ((double )(audiosize * 8UL) / 1024.0) / flvmetadata.duration;
  }
#line 743
  return;
}
}
#line 746 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVH263VideoPacket(unsigned char const   *h263 ) 
{ 
  int startcode ;
  int picturesize ;

  {
#line 752
  startcode = (int )((((int const   )*(h263 + 0) << 16) + ((int const   )*(h263 + 1) << 8)) + (int const   )*(h263 + 2)) >> 7;
#line 753
  if (startcode != 1) {
#line 754
    return;
  }
#line 756
  picturesize = (int )((((int const   )*(h263 + 3) & 3) << 1) + (((int const   )*(h263 + 4) >> 7) & 1));
  {
#line 759
  if (picturesize == 0) {
#line 759
    goto case_0;
  }
#line 763
  if (picturesize == 1) {
#line 763
    goto case_1;
  }
#line 767
  if (picturesize == 2) {
#line 767
    goto case_2;
  }
#line 771
  if (picturesize == 3) {
#line 771
    goto case_3;
  }
#line 775
  if (picturesize == 4) {
#line 775
    goto case_4;
  }
#line 779
  if (picturesize == 5) {
#line 779
    goto case_5;
  }
#line 783
  if (picturesize == 6) {
#line 783
    goto case_6;
  }
#line 787
  goto switch_default;
  case_0: /* CIL Label */ 
#line 760
  flvmetadata.width = (double )((((int const   )*(h263 + 4) & 127) << 1) + (((int const   )*(h263 + 5) >> 7) & 1));
#line 761
  flvmetadata.height = (double )((((int const   )*(h263 + 5) & 127) << 1) + (((int const   )*(h263 + 6) >> 7) & 1));
#line 762
  goto switch_break;
  case_1: /* CIL Label */ 
#line 764
  flvmetadata.width = (double )(((((int const   )*(h263 + 4) & 127) << 9) + ((int const   )*(h263 + 5) << 1)) + (((int const   )*(h263 + 6) >> 7) & 1));
#line 765
  flvmetadata.height = (double )(((((int const   )*(h263 + 6) & 127) << 9) + ((int const   )*(h263 + 7) << 1)) + (((int const   )*(h263 + 8) >> 7) & 1));
#line 766
  goto switch_break;
  case_2: /* CIL Label */ 
#line 768
  flvmetadata.width = 352.0;
#line 769
  flvmetadata.height = 288.0;
#line 770
  goto switch_break;
  case_3: /* CIL Label */ 
#line 772
  flvmetadata.width = 176.0;
#line 773
  flvmetadata.height = 144.0;
#line 774
  goto switch_break;
  case_4: /* CIL Label */ 
#line 776
  flvmetadata.width = 128.0;
#line 777
  flvmetadata.height = 96.0;
#line 778
  goto switch_break;
  case_5: /* CIL Label */ 
#line 780
  flvmetadata.width = 320.0;
#line 781
  flvmetadata.height = 240.0;
#line 782
  goto switch_break;
  case_6: /* CIL Label */ 
#line 784
  flvmetadata.width = 160.0;
#line 785
  flvmetadata.height = 120.0;
#line 786
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 788
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 791
  return;
}
}
#line 794 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVScreenVideoPacket(unsigned char const   *sv ) 
{ 


  {
#line 797
  flvmetadata.width = (double )((((int const   )*(sv + 0) & 15) << 8) + (int const   )*(sv + 1));
#line 798
  flvmetadata.height = (double )((((int const   )*(sv + 2) & 15) << 8) + (int const   )*(sv + 3));
#line 800
  return;
}
}
#line 803 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVVP62VideoPacket(unsigned char const   *vp62 ) 
{ 


  {
#line 804
  flvmetadata.width = (double )((int const   )*(vp62 + 4) * 16 - ((int const   )*(vp62 + 0) >> 4));
#line 805
  flvmetadata.height = (double )((int const   )*(vp62 + 3) * 16 - ((int const   )*(vp62 + 0) & 15));
#line 807
  return;
}
}
#line 810 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void readFLVVP62AlphaVideoPacket(unsigned char const   *vp62a ) 
{ 


  {
#line 811
  flvmetadata.width = (double )((int const   )*(vp62a + 7) * 16 - ((int const   )*(vp62a + 0) >> 4));
#line 812
  flvmetadata.height = (double )((int const   )*(vp62a + 6) * 16 - ((int const   )*(vp62a + 0) & 15));
#line 814
  return;
}
}
#line 817 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void initFLVMetaData(char const   *creator , int lastsecond , int lastkeyframe ) 
{ 
  char *t ;

  {
  {
#line 820
  t = (char *)(& flvmetadata);
#line 821
  memset((void *)t, 0, sizeof(FLVMetaData_t ));
#line 823
  flvmetadata.hasMetadata = 1;
#line 824
  flvmetadata.hasLastSecond = lastsecond;
#line 825
  flvmetadata.hasLastKeyframe = lastkeyframe;
  }
#line 827
  if ((unsigned long )creator != (unsigned long )((void *)0)) {
    {
#line 828
    strncpy((char */* __restrict  */)(flvmetadata.creator), (char const   */* __restrict  */)creator,
            sizeof(flvmetadata.creator));
    }
  }
  {
#line 830
  strncpy((char */* __restrict  */)(flvmetadata.metadatacreator), (char const   */* __restrict  */)"Yet Another Metadata Injector for FLV - Version 1.4\000",
          sizeof(flvmetadata.metadatacreator));
  }
#line 832
  return;
}
}
#line 835 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVMetaData(FILE *fp ) 
{ 
  FLVTag_t flvtag ;
  int i ;
  size_t length ;
  size_t datasize ;
  char *t ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;
  size_t tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  size_t tmp___7 ;
  size_t tmp___8 ;
  size_t tmp___9 ;
  size_t tmp___10 ;
  size_t tmp___11 ;
  size_t tmp___12 ;
  size_t tmp___13 ;
  size_t tmp___14 ;
  size_t tmp___15 ;
  size_t tmp___16 ;
  size_t tmp___17 ;
  size_t tmp___18 ;
  size_t tmp___19 ;
  size_t tmp___20 ;
  size_t tmp___21 ;
  size_t tmp___22 ;
  size_t tmp___23 ;
  size_t tmp___24 ;
  size_t tmp___25 ;
  size_t tmp___26 ;
  size_t tmp___27 ;
  size_t tmp___28 ;
  size_t tmp___29 ;
  size_t tmp___30 ;
  size_t tmp___31 ;
  size_t tmp___32 ;
  size_t tmp___33 ;
  size_t tmp___34 ;
  size_t tmp___35 ;

  {
#line 838
  length = (size_t )0;
#line 838
  datasize = (size_t )0;
#line 841
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
#line 842
    return ((size_t )-1);
  }
  {
#line 847
  t = (char *)(& flvtag);
#line 848
  memset((void *)t, 0, sizeof(FLVTag_t ));
#line 851
  flvtag.type = (unsigned char)18;
#line 853
  flvtag.datasize[0] = (unsigned char )((flvmetadata.metadatasize >> 16) & 255);
#line 854
  flvtag.datasize[1] = (unsigned char )((flvmetadata.metadatasize >> 8) & 255);
#line 855
  flvtag.datasize[2] = (unsigned char )(flvmetadata.metadatasize & 255);
  }
  metadatapass: 
  {
#line 858
  datasize = (size_t )0;
#line 859
  tmp = fwrite((void const   */* __restrict  */)t, (size_t )1, sizeof(FLVTag_t ),
               (FILE */* __restrict  */)fp);
#line 859
  datasize += tmp;
#line 862
  tmp___0 = writeFLVScriptDataObject(fp);
#line 862
  datasize += tmp___0;
#line 865
  tmp___1 = writeFLVScriptDataECMAArray(fp, "onMetaData", (size_t )flvmetadata.onmetadatalength);
#line 865
  datasize += tmp___1;
#line 868
  tmp___3 = strlen((char const   *)(flvmetadata.creator));
  }
#line 868
  if (tmp___3 != 0UL) {
    {
#line 869
    tmp___2 = writeFLVScriptDataValueString(fp, "creator", (char const   *)(flvmetadata.creator));
#line 869
    datasize += tmp___2;
#line 870
    length ++;
    }
  }
  {
#line 874
  tmp___4 = writeFLVScriptDataValueString(fp, "metadatacreator", (char const   *)(flvmetadata.metadatacreator));
#line 874
  datasize += tmp___4;
#line 875
  length ++;
#line 878
  tmp___5 = writeFLVScriptDataValueBool(fp, "hasKeyframes", flvmetadata.hasKeyframes);
#line 878
  datasize += tmp___5;
#line 879
  length ++;
#line 882
  tmp___6 = writeFLVScriptDataValueBool(fp, "hasVideo", flvmetadata.hasVideo);
#line 882
  datasize += tmp___6;
#line 883
  length ++;
#line 886
  tmp___7 = writeFLVScriptDataValueBool(fp, "hasAudio", flvmetadata.hasAudio);
#line 886
  datasize += tmp___7;
#line 887
  length ++;
#line 890
  tmp___8 = writeFLVScriptDataValueBool(fp, "hasMetadata", flvmetadata.hasMetadata);
#line 890
  datasize += tmp___8;
#line 891
  length ++;
#line 894
  tmp___9 = writeFLVScriptDataValueBool(fp, "canSeekToEnd", flvmetadata.canSeekToEnd);
#line 894
  datasize += tmp___9;
#line 895
  length ++;
#line 898
  tmp___10 = writeFLVScriptDataValueDouble(fp, "duration", flvmetadata.duration);
#line 898
  datasize += tmp___10;
#line 899
  length ++;
#line 902
  tmp___11 = writeFLVScriptDataValueDouble(fp, "datasize", flvmetadata.datasize);
#line 902
  datasize += tmp___11;
#line 903
  length ++;
  }
#line 905
  if (flvmetadata.hasVideo == 1) {
    {
#line 907
    tmp___12 = writeFLVScriptDataValueDouble(fp, "videosize", flvmetadata.videosize);
#line 907
    datasize += tmp___12;
#line 908
    length ++;
#line 911
    tmp___13 = writeFLVScriptDataValueDouble(fp, "videocodecid", flvmetadata.videocodecid);
#line 911
    datasize += tmp___13;
#line 912
    length ++;
    }
#line 915
    if (flvmetadata.width != 0.0) {
      {
#line 916
      tmp___14 = writeFLVScriptDataValueDouble(fp, "width", flvmetadata.width);
#line 916
      datasize += tmp___14;
#line 917
      length ++;
      }
    }
#line 921
    if (flvmetadata.height != 0.0) {
      {
#line 922
      tmp___15 = writeFLVScriptDataValueDouble(fp, "height", flvmetadata.height);
#line 922
      datasize += tmp___15;
#line 923
      length ++;
      }
    }
    {
#line 927
    tmp___16 = writeFLVScriptDataValueDouble(fp, "framerate", flvmetadata.framerate);
#line 927
    datasize += tmp___16;
#line 928
    length ++;
#line 931
    tmp___17 = writeFLVScriptDataValueDouble(fp, "videodatarate", flvmetadata.videodatarate);
#line 931
    datasize += tmp___17;
#line 932
    length ++;
    }
  }
#line 935
  if (flvmetadata.hasAudio == 1) {
    {
#line 937
    tmp___18 = writeFLVScriptDataValueDouble(fp, "audiosize", flvmetadata.audiosize);
#line 937
    datasize += tmp___18;
#line 938
    length ++;
#line 941
    tmp___19 = writeFLVScriptDataValueDouble(fp, "audiocodecid", flvmetadata.audiocodecid);
#line 941
    datasize += tmp___19;
#line 942
    length ++;
#line 945
    tmp___20 = writeFLVScriptDataValueDouble(fp, "audiosamplerate", flvmetadata.audiosamplerate);
#line 945
    datasize += tmp___20;
#line 946
    length ++;
#line 949
    tmp___21 = writeFLVScriptDataValueDouble(fp, "audiosamplesize", flvmetadata.audiosamplesize);
#line 949
    datasize += tmp___21;
#line 950
    length ++;
#line 953
    tmp___22 = writeFLVScriptDataValueBool(fp, "stereo", flvmetadata.stereo);
#line 953
    datasize += tmp___22;
#line 954
    length ++;
#line 957
    tmp___23 = writeFLVScriptDataValueDouble(fp, "audiodatarate", flvmetadata.audiodatarate);
#line 957
    datasize += tmp___23;
#line 958
    length ++;
    }
  }
  {
#line 962
  tmp___24 = writeFLVScriptDataValueDouble(fp, "filesize", flvmetadata.filesize);
#line 962
  datasize += tmp___24;
#line 963
  length ++;
#line 966
  tmp___25 = writeFLVScriptDataValueDouble(fp, "lasttimestamp", flvmetadata.lasttimestamp);
#line 966
  datasize += tmp___25;
#line 967
  length ++;
  }
#line 969
  if (flvmetadata.hasKeyframes == 1) {
    {
#line 971
    tmp___26 = writeFLVScriptDataValueDouble(fp, "lastkeyframetimestamp", flvmetadata.lastkeyframetimestamp);
#line 971
    datasize += tmp___26;
#line 972
    length ++;
#line 975
    tmp___27 = writeFLVScriptDataValueDouble(fp, "lastkeyframelocation", flvmetadata.lastkeyframelocation);
#line 975
    datasize += tmp___27;
#line 976
    length ++;
#line 979
    tmp___28 = writeFLVScriptDataVariableArray(fp, "keyframes");
#line 979
    datasize += tmp___28;
#line 980
    length ++;
#line 983
    tmp___29 = writeFLVScriptDataValueArray(fp, "filepositions", (size_t )flvmetadata.keyframes);
#line 983
    datasize += tmp___29;
#line 985
    i = 0;
    }
    {
#line 985
    while (1) {
      while_continue: /* CIL Label */ ;
#line 985
      if (! (i < flvmetadata.keyframes)) {
#line 985
        goto while_break;
      }
      {
#line 986
      tmp___30 = writeFLVScriptDataValueDouble(fp, (char const   *)((void *)0), *(flvmetadata.filepositions + i));
#line 986
      datasize += tmp___30;
#line 985
      i ++;
      }
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 989
    tmp___31 = writeFLVScriptDataValueArray(fp, "times", (size_t )flvmetadata.keyframes);
#line 989
    datasize += tmp___31;
#line 991
    i = 0;
    }
    {
#line 991
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 991
      if (! (i < flvmetadata.keyframes)) {
#line 991
        goto while_break___0;
      }
      {
#line 992
      tmp___32 = writeFLVScriptDataValueDouble(fp, (char const   *)((void *)0), *(flvmetadata.times + i));
#line 992
      datasize += tmp___32;
#line 991
      i ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 995
    tmp___33 = writeFLVScriptDataVariableArrayEnd(fp);
#line 995
    datasize += tmp___33;
    }
  }
#line 998
  if (flvmetadata.onmetadatalength == 0) {
#line 999
    flvmetadata.onmetadatalength = (int )length;
#line 1000
    goto metadatapass;
  }
  {
#line 1003
  tmp___34 = writeFLVScriptDataVariableArrayEnd(fp);
#line 1003
  datasize += tmp___34;
#line 1005
  flvmetadata.metadatasize = (int )(datasize - sizeof(FLVTag_t ));
#line 1007
  tmp___35 = writeFLVPreviousTagSize(fp, datasize);
#line 1007
  datasize += tmp___35;
  }
#line 1009
  return (datasize);
}
}
#line 1012 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVLastSecond(FILE *fp , double timestamp ) 
{ 
  FLVTag_t flvtag ;
  int currenttimestamp ;
  size_t datasize ;
  char *t ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;

  {
  {
#line 1015
  datasize = (size_t )0;
#line 1021
  t = (char *)(& flvtag);
#line 1022
  memset((void *)t, 0, sizeof(FLVTag_t ));
#line 1025
  flvtag.type = (unsigned char)18;
#line 1028
  currenttimestamp = (int )(timestamp * 1000.0);
#line 1029
  flvtag.timestamp_ex = (unsigned char )((currenttimestamp >> 24) & 255);
#line 1030
  flvtag.timestamp[0] = (unsigned char )((currenttimestamp >> 16) & 255);
#line 1031
  flvtag.timestamp[1] = (unsigned char )((currenttimestamp >> 8) & 255);
#line 1032
  flvtag.timestamp[2] = (unsigned char )(currenttimestamp & 255);
#line 1034
  flvtag.datasize[0] = (unsigned char )((flvmetadata.onlastsecondlength >> 16) & 255UL);
#line 1035
  flvtag.datasize[1] = (unsigned char )((flvmetadata.onlastsecondlength >> 8) & 255UL);
#line 1036
  flvtag.datasize[2] = (unsigned char )(flvmetadata.onlastsecondlength & 255UL);
#line 1038
  datasize = (size_t )0;
#line 1039
  tmp = fwrite((void const   */* __restrict  */)t, (size_t )1, sizeof(FLVTag_t ),
               (FILE */* __restrict  */)fp);
#line 1039
  datasize += tmp;
#line 1042
  tmp___0 = writeFLVScriptDataObject(fp);
#line 1042
  datasize += tmp___0;
#line 1045
  tmp___1 = writeFLVScriptDataECMAArray(fp, "onLastSecond", (size_t )0);
#line 1045
  datasize += tmp___1;
#line 1047
  tmp___2 = writeFLVScriptDataVariableArrayEnd(fp);
#line 1047
  datasize += tmp___2;
#line 1049
  flvmetadata.onlastsecondlength = datasize - sizeof(FLVTag_t );
#line 1051
  tmp___3 = writeFLVPreviousTagSize(fp, datasize);
#line 1051
  datasize += tmp___3;
  }
#line 1053
  return (datasize);
}
}
#line 1056 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVLastKeyframe(FILE *fp ) 
{ 
  FLVTag_t flvtag ;
  size_t datasize ;
  char *t ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;

  {
  {
#line 1058
  datasize = (size_t )0;
#line 1064
  t = (char *)(& flvtag);
#line 1065
  memset((void *)t, 0, sizeof(FLVTag_t ));
#line 1068
  flvtag.type = (unsigned char)18;
#line 1070
  flvtag.datasize[0] = (unsigned char )((flvmetadata.onlastkeyframelength >> 16) & 255UL);
#line 1071
  flvtag.datasize[1] = (unsigned char )((flvmetadata.onlastkeyframelength >> 8) & 255UL);
#line 1072
  flvtag.datasize[2] = (unsigned char )(flvmetadata.onlastkeyframelength & 255UL);
#line 1074
  datasize = (size_t )0;
#line 1075
  tmp = fwrite((void const   */* __restrict  */)t, (size_t )1, sizeof(FLVTag_t ),
               (FILE */* __restrict  */)fp);
#line 1075
  datasize += tmp;
#line 1078
  tmp___0 = writeFLVScriptDataObject(fp);
#line 1078
  datasize += tmp___0;
#line 1081
  tmp___1 = writeFLVScriptDataECMAArray(fp, "onLastKeyframe", (size_t )0);
#line 1081
  datasize += tmp___1;
#line 1083
  tmp___2 = writeFLVScriptDataVariableArrayEnd(fp);
#line 1083
  datasize += tmp___2;
#line 1085
  flvmetadata.onlastkeyframelength = datasize - sizeof(FLVTag_t );
#line 1087
  tmp___3 = writeFLVPreviousTagSize(fp, datasize);
#line 1087
  datasize += tmp___3;
  }
#line 1089
  return (datasize);
}
}
#line 1092 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVPreviousTagSize(FILE *fp , size_t datasize ) 
{ 
  unsigned char length[4] ;

  {
  {
#line 1095
  length[0] = (unsigned char )((datasize >> 24) & 255UL);
#line 1096
  length[1] = (unsigned char )((datasize >> 16) & 255UL);
#line 1097
  length[2] = (unsigned char )((datasize >> 8) & 255UL);
#line 1098
  length[3] = (unsigned char )(datasize & 255UL);
#line 1100
  fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )4, (FILE */* __restrict  */)fp);
  }
#line 1102
  return ((size_t )4);
}
}
#line 1105 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataObject(FILE *fp ) 
{ 
  size_t datasize ;
  char type ;
  size_t tmp ;

  {
  {
#line 1106
  datasize = (size_t )0;
#line 1109
  type = (char)2;
#line 1110
  tmp = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
               (FILE */* __restrict  */)fp);
#line 1110
  datasize += tmp;
  }
#line 1112
  return (datasize);
}
}
#line 1115 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataECMAArray(FILE *fp , char const   *name , size_t len ) 
{ 
  size_t datasize ;
  unsigned char length[4] ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
  {
#line 1116
  datasize = (size_t )0;
#line 1120
  tmp = writeFLVScriptDataString(fp, name);
#line 1120
  datasize += tmp;
#line 1121
  type = (char)8;
#line 1122
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1122
  datasize += tmp___0;
#line 1124
  length[0] = (unsigned char )((len >> 24) & 255UL);
#line 1125
  length[1] = (unsigned char )((len >> 16) & 255UL);
#line 1126
  length[2] = (unsigned char )((len >> 8) & 255UL);
#line 1127
  length[3] = (unsigned char )(len & 255UL);
#line 1129
  tmp___1 = fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )4,
                   (FILE */* __restrict  */)fp);
#line 1129
  datasize += tmp___1;
  }
#line 1131
  return (datasize);
}
}
#line 1134 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataValueArray(FILE *fp , char const   *name , size_t len ) 
{ 
  size_t datasize ;
  unsigned char length[4] ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
  {
#line 1135
  datasize = (size_t )0;
#line 1139
  tmp = writeFLVScriptDataString(fp, name);
#line 1139
  datasize += tmp;
#line 1140
  type = (char)10;
#line 1141
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1141
  datasize += tmp___0;
#line 1143
  length[0] = (unsigned char )((len >> 24) & 255UL);
#line 1144
  length[1] = (unsigned char )((len >> 16) & 255UL);
#line 1145
  length[2] = (unsigned char )((len >> 8) & 255UL);
#line 1146
  length[3] = (unsigned char )(len & 255UL);
#line 1148
  tmp___1 = fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )4,
                   (FILE */* __restrict  */)fp);
#line 1148
  datasize += tmp___1;
  }
#line 1150
  return (datasize);
}
}
#line 1153 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataVariableArray(FILE *fp , char const   *name ) 
{ 
  size_t datasize ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;

  {
  {
#line 1154
  datasize = (size_t )0;
#line 1157
  tmp = writeFLVScriptDataString(fp, name);
#line 1157
  datasize += tmp;
#line 1158
  type = (char)3;
#line 1159
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1159
  datasize += tmp___0;
  }
#line 1161
  return (datasize);
}
}
#line 1164 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataVariableArrayEnd(FILE *fp ) 
{ 
  size_t datasize ;
  unsigned char length[3] ;
  size_t tmp ;

  {
  {
#line 1165
  datasize = (size_t )0;
#line 1168
  length[0] = (unsigned char)0;
#line 1169
  length[1] = (unsigned char)0;
#line 1170
  length[2] = (unsigned char)9;
#line 1172
  tmp = fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )3,
               (FILE */* __restrict  */)fp);
#line 1172
  datasize += tmp;
  }
#line 1174
  return (datasize);
}
}
#line 1177 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataValueString(FILE *fp , char const   *name , char const   *value ) 
{ 
  size_t datasize ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
#line 1178
  datasize = (size_t )0;
#line 1181
  if ((unsigned long )name != (unsigned long )((void *)0)) {
    {
#line 1182
    tmp = writeFLVScriptDataString(fp, name);
#line 1182
    datasize += tmp;
    }
  }
  {
#line 1184
  type = (char)2;
#line 1185
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1185
  datasize += tmp___0;
#line 1186
  tmp___1 = writeFLVScriptDataString(fp, value);
#line 1186
  datasize += tmp___1;
  }
#line 1188
  return (datasize);
}
}
#line 1191 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataValueBool(FILE *fp , char const   *name , int value ) 
{ 
  size_t datasize ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
#line 1192
  datasize = (size_t )0;
#line 1195
  if ((unsigned long )name != (unsigned long )((void *)0)) {
    {
#line 1196
    tmp = writeFLVScriptDataString(fp, name);
#line 1196
    datasize += tmp;
    }
  }
  {
#line 1198
  type = (char)1;
#line 1199
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1199
  datasize += tmp___0;
#line 1200
  tmp___1 = writeFLVBool(fp, value);
#line 1200
  datasize += tmp___1;
  }
#line 1202
  return (datasize);
}
}
#line 1205 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataValueDouble(FILE *fp , char const   *name , double value ) 
{ 
  size_t datasize ;
  char type ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
#line 1206
  datasize = (size_t )0;
#line 1209
  if ((unsigned long )name != (unsigned long )((void *)0)) {
    {
#line 1210
    tmp = writeFLVScriptDataString(fp, name);
#line 1210
    datasize += tmp;
    }
  }
  {
#line 1212
  type = (char)0;
#line 1213
  tmp___0 = fwrite((void const   */* __restrict  */)(& type), (size_t )1, (size_t )1,
                   (FILE */* __restrict  */)fp);
#line 1213
  datasize += tmp___0;
#line 1214
  tmp___1 = writeFLVDouble(fp, value);
#line 1214
  datasize += tmp___1;
  }
#line 1216
  return (datasize);
}
}
#line 1219 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataString(FILE *fp , char const   *s ) 
{ 
  size_t datasize ;
  size_t len ;
  unsigned char length[2] ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;

  {
  {
#line 1220
  datasize = (size_t )0;
#line 1223
  len = strlen(s);
  }
#line 1225
  if (len > 65535UL) {
    {
#line 1226
    tmp = writeFLVScriptDataLongString(fp, s);
#line 1226
    datasize += tmp;
    }
  } else {
    {
#line 1228
    length[0] = (unsigned char )((len >> 8) & 255UL);
#line 1229
    length[1] = (unsigned char )(len & 255UL);
#line 1231
    tmp___0 = fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )2,
                     (FILE */* __restrict  */)fp);
#line 1231
    datasize += tmp___0;
#line 1232
    tmp___1 = fwrite((void const   */* __restrict  */)s, (size_t )1, len, (FILE */* __restrict  */)fp);
#line 1232
    datasize += tmp___1;
    }
  }
#line 1235
  return (datasize);
}
}
#line 1238 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVScriptDataLongString(FILE *fp , char const   *s ) 
{ 
  size_t datasize ;
  size_t len ;
  unsigned char length[4] ;
  size_t tmp ;
  size_t tmp___0 ;

  {
  {
#line 1239
  datasize = (size_t )0;
#line 1242
  len = strlen(s);
  }
#line 1244
  if (len > 4294967295UL) {
#line 1245
    len = (size_t )4294967295U;
  }
  {
#line 1247
  length[0] = (unsigned char )((len >> 24) & 255UL);
#line 1248
  length[1] = (unsigned char )((len >> 16) & 255UL);
#line 1249
  length[2] = (unsigned char )((len >> 8) & 255UL);
#line 1250
  length[3] = (unsigned char )(len & 255UL);
#line 1252
  tmp = fwrite((void const   */* __restrict  */)(length), (size_t )1, (size_t )4,
               (FILE */* __restrict  */)fp);
#line 1252
  datasize += tmp;
#line 1253
  tmp___0 = fwrite((void const   */* __restrict  */)s, (size_t )1, len, (FILE */* __restrict  */)fp);
#line 1253
  datasize += tmp___0;
  }
#line 1255
  return (datasize);
}
}
#line 1258 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVBool(FILE *fp , int value ) 
{ 
  size_t datasize ;
  unsigned char b ;
  size_t tmp ;

  {
  {
#line 1259
  datasize = (size_t )0;
#line 1262
  b = (unsigned char )(value & 1);
#line 1264
  tmp = fwrite((void const   */* __restrict  */)(& b), (size_t )1, (size_t )1, (FILE */* __restrict  */)fp);
#line 1264
  datasize += tmp;
  }
#line 1266
  return (datasize);
}
}
#line 1269 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
size_t writeFLVDouble(FILE *fp , double value ) 
{ 
  union __anonunion_d_33 d ;
  unsigned char b[8] ;
  size_t datasize ;
  size_t tmp ;

  {
  {
#line 1275
  datasize = (size_t )0;
#line 1277
  d.dd = value;
#line 1279
  b[0] = d.dc[7];
#line 1280
  b[1] = d.dc[6];
#line 1281
  b[2] = d.dc[5];
#line 1282
  b[3] = d.dc[4];
#line 1283
  b[4] = d.dc[3];
#line 1284
  b[5] = d.dc[2];
#line 1285
  b[6] = d.dc[1];
#line 1286
  b[7] = d.dc[0];
#line 1288
  tmp = fwrite((void const   */* __restrict  */)(b), (size_t )1, (size_t )8, (FILE */* __restrict  */)fp);
#line 1288
  datasize += tmp;
  }
#line 1290
  return (datasize);
}
}
#line 1293 "/home/june/repo/benchmarks/collector/temp/yamdi-1.4/yamdi.c"
void print_usage(void) 
{ 


  {
  {
#line 1294
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"NAME\n");
#line 1295
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\tyamdi -- Yet Another Metadata Injector for FLV\n");
#line 1296
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\tVersion: 1.4\n");
#line 1297
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1299
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"SYNOPSIS\n");
#line 1300
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\tyamdi -i input file [-x xml file | -o output file [-x xml file]]\n");
#line 1301
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t      [-c creator] [-l] [-h]\n");
#line 1302
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1304
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"DESCRIPTION\n");
#line 1305
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\tyamdi is a metadata injector for FLV files.\n");
#line 1306
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1307
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\tOptions:\n");
#line 1308
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1309
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-i\tThe source FLV file.\n");
#line 1310
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1311
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-o\tThe resulting FLV file with the metatags. If the file\n");
#line 1312
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t\tname is \'-\' the output will be written to stdout.\n");
#line 1313
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1314
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-x\tAn XML file with the resulting metadata information. If the\n");
#line 1315
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t\toutput file is ommited, only metadata will be generated.\n");
#line 1316
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1317
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-c\tA string that will be written into the creator tag.\n");
#line 1318
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1319
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-l\tAdd the onLastSecond event.\n");
#line 1320
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1321
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t-h\tThis description.\n");
#line 1322
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
#line 1324
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"COPYRIGHT\n");
#line 1325
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\t(c) 2008 Ingo Oppermann\n");
#line 1326
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n");
  }
#line 1327
  return;
}
}
