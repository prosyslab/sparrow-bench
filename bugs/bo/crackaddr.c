/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.6/include/stddef.h"
typedef unsigned long size_t;
#line 95 "crackaddr-bad.c"
enum bool {
    false = 0,
    true = 1
} ;
#line 363 "/usr/include/stdio.h"
extern int printf(char const   * __restrict  __format  , ...) ;
#line 437
extern int scanf(char const   * __restrict  __format  , ...)  __asm__("__isoc99_scanf")  ;
#line 128 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 235
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strchr)(char const   *__s ,
                                                                                               int __c )  __attribute__((__pure__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 81 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) unsigned short const   **( __attribute__((__leaf__)) __ctype_b_loc)(void)  __attribute__((__const__)) ;
#line 89 "crackaddr-bad.c"
/* #pragma ccuredvararg("scanf",printf(1)) */
#line 98 "crackaddr-bad.c"
int ColonOkInAddr  ;
#line 99 "crackaddr-bad.c"
char *MustQuoteChars  ;
#line 153 "crackaddr-bad.c"
static char buf[31]  ;
#line 154 "crackaddr-bad.c"
static char test_buf[10]  ;
#line 130 "crackaddr-bad.c"
char *crackaddr(char *addr ) 
{ 
  register char *p ;
  register char c ;
  int cmtlev ;
  int realcmtlev ;
  int anglelev ;
  int realanglelev ;
  int copylev ;
  int bracklev ;
  enum bool qmode ;
  enum bool realqmode ;
  enum bool skipping ;
  enum bool putgmac ;
  enum bool quoteit ;
  enum bool gotangle ;
  enum bool gotcolon ;
  register char *bp ;
  char *obp ;
  char *buflim ;
  char *bufhead ;
  char *addrhead ;
  unsigned short const   **tmp ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  char *tmp___4 ;
  int tmp___5 ;
  register char *q ;
  char *tmp___6 ;
  char *tmp___7 ;
  char *tmp___8 ;
  unsigned short const   **tmp___9 ;
  char *tmp___10 ;
  char *tmp___11 ;
  char *tmp___12 ;
  char *tmp___13 ;
  char *tmp___14 ;
  char *tmp___15 ;
  char *tmp___16 ;
  char *tmp___17 ;
  char *tmp___18 ;
  unsigned short const   **tmp___19 ;
  char *tmp___20 ;
  char *tmp___21 ;
  register char *q___0 ;
  char *tmp___22 ;
  unsigned short const   **tmp___23 ;
  char *tmp___24 ;
  char *tmp___25 ;
  char *tmp___26 ;
  char *tmp___27 ;
  char *tmp___28 ;
  char *tmp___29 ;
  char *tmp___30 ;
  char *tmp___31 ;
  int tmp___32 ;
  char *tmp___33 ;
  char *tmp___34 ;
  char *tmp___35 ;
  char *tmp___36 ;
  char *tmp___37 ;
  char *tmp___38 ;
  int tmp___39 ;
  char *tmp___40 ;
  int tmp___41 ;
  char *tmp___42 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;

  {
  {
#line 144
  putgmac = (enum bool )0;
#line 145
  quoteit = (enum bool )0;
#line 146
  gotangle = (enum bool )0;
#line 147
  gotcolon = (enum bool )0;
#line 157
  strcpy((char */* __restrict  */)(test_buf), (char const   */* __restrict  */)"GOOD");
#line 159
  printf((char const   */* __restrict  */)"Inside crackaddr!\n");
  }
  {
#line 163
  while (1) {
    while_continue: /* CIL Label */ ;
#line 163
    if ((int )*addr != 0) {
#line 163
      if (((int )*addr & -128) == 0) {
        {
#line 163
        tmp = __ctype_b_loc();
        }
#line 163
        if (! ((int const   )*(*tmp + (int )*addr) & 8192)) {
#line 163
          goto while_break;
        }
      } else {
#line 163
        goto while_break;
      }
    } else {
#line 163
      goto while_break;
    }
#line 164
    addr ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 172
  bufhead = buf;
#line 172
  bp = bufhead;
#line 173
  obp = bp;
#line 174
  buflim = & buf[sizeof(buf) - 7UL];
#line 175
  addrhead = addr;
#line 175
  p = addrhead;
#line 176
  realcmtlev = 0;
#line 176
  cmtlev = realcmtlev;
#line 176
  realanglelev = cmtlev;
#line 176
  anglelev = realanglelev;
#line 176
  copylev = anglelev;
#line 177
  bracklev = 0;
#line 178
  realqmode = (enum bool )0;
#line 178
  qmode = realqmode;
#line 180
  printf((char const   */* __restrict  */)"qmode = %d\n", (unsigned int )qmode);
  }
  {
#line 182
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 182
    tmp___36 = p;
#line 182
    p ++;
#line 182
    c = *tmp___36;
#line 182
    if (! ((int )c != 0)) {
#line 182
      goto while_break___0;
    }
    {
#line 190
    printf((char const   */* __restrict  */)"c = %c\n", (int )c);
#line 192
    skipping = (enum bool )((unsigned long )bp >= (unsigned long )buflim);
    }
#line 194
    if (copylev > 0) {
#line 194
      if (! skipping) {
#line 197
        tmp___0 = bp;
#line 197
        bp ++;
#line 197
        *tmp___0 = c;
      }
    }
#line 200
    if ((int )c == 92) {
#line 203
      if (cmtlev <= 0) {
#line 203
        if (! qmode) {
#line 204
          quoteit = (enum bool )1;
        }
      }
#line 206
      tmp___1 = p;
#line 206
      p ++;
#line 206
      c = *tmp___1;
#line 206
      if ((int )c == 0) {
#line 209
        p --;
#line 210
        goto putg;
      }
#line 212
      if (copylev > 0) {
#line 212
        if (! skipping) {
#line 215
          tmp___2 = bp;
#line 215
          bp ++;
#line 215
          *tmp___2 = c;
        }
      }
#line 217
      goto putg;
    }
#line 221
    if ((int )c == 34) {
#line 221
      if (cmtlev <= 0) {
        {
#line 223
        printf((char const   */* __restrict  */)"quoted string...\n");
#line 224
        qmode = (enum bool )(! qmode);
        }
#line 225
        if (copylev > 0) {
#line 225
          if (! skipping) {
#line 226
            realqmode = (enum bool )(! realqmode);
          }
        }
#line 227
        goto cont;
      }
    }
#line 229
    if (qmode) {
#line 230
      goto putg;
    }
#line 233
    if ((int )c == 40) {
      {
#line 235
      printf((char const   */* __restrict  */)"left ( seen....\n");
#line 236
      cmtlev ++;
      }
#line 239
      if (! skipping) {
#line 241
        buflim --;
#line 242
        realcmtlev ++;
#line 243
        tmp___5 = copylev;
#line 243
        copylev ++;
#line 243
        if (tmp___5 <= 0) {
#line 245
          if ((unsigned long )bp != (unsigned long )bufhead) {
#line 248
            tmp___3 = bp;
#line 248
            bp ++;
#line 248
            *tmp___3 = (char )' ';
          }
#line 252
          tmp___4 = bp;
#line 252
          bp ++;
#line 252
          *tmp___4 = c;
        }
      }
    }
#line 256
    if (cmtlev > 0) {
#line 258
      if ((int )c == 41) {
#line 260
        cmtlev --;
#line 261
        copylev --;
#line 262
        if (! skipping) {
#line 264
          realcmtlev --;
#line 265
          buflim ++;
        }
      }
#line 268
      goto cont;
    } else
#line 270
    if ((int )c == 41) {
#line 273
      if (copylev > 0) {
#line 273
        if (! skipping) {
#line 274
          bp --;
        }
      }
    }
#line 278
    if ((int )c == 91) {
#line 279
      bracklev ++;
    } else
#line 280
    if ((int )c == 93) {
#line 281
      bracklev --;
    }
#line 284
    if ((int )c == 58) {
#line 284
      if (anglelev <= 0) {
#line 284
        if (bracklev <= 0) {
#line 284
          if (! gotcolon) {
#line 284
            if (! ColonOkInAddr) {
#line 296
              if ((int )*p == 58) {
#line 296
                goto _L;
              } else
#line 296
              if ((int )*p == 46) {
                _L: /* CIL Label */ 
#line 298
                if (cmtlev <= 0) {
#line 298
                  if (! qmode) {
#line 299
                    quoteit = (enum bool )1;
                  }
                }
#line 300
                if (copylev > 0) {
#line 300
                  if (! skipping) {
#line 303
                    tmp___6 = bp;
#line 303
                    bp ++;
#line 303
                    *tmp___6 = c;
#line 305
                    tmp___7 = bp;
#line 305
                    bp ++;
#line 305
                    *tmp___7 = *p;
                  }
                }
#line 307
                p ++;
#line 308
                goto putg;
              }
#line 311
              gotcolon = (enum bool )1;
#line 313
              bp = bufhead;
#line 314
              if (quoteit) {
#line 317
                tmp___8 = bp;
#line 317
                bp ++;
#line 317
                *tmp___8 = (char )'\"';
#line 320
                p --;
                {
#line 322
                while (1) {
                  while_continue___1: /* CIL Label */ ;
#line 322
                  p --;
#line 322
                  if (((int )*p & -128) == 0) {
                    {
#line 322
                    tmp___9 = __ctype_b_loc();
                    }
#line 322
                    if (! ((int const   )*(*tmp___9 + (int )*p) & 8192)) {
#line 322
                      goto while_break___1;
                    }
                  } else {
#line 322
                    goto while_break___1;
                  }
                }
                while_break___1: /* CIL Label */ ;
                }
#line 324
                p ++;
              }
#line 326
              q = addrhead;
              {
#line 326
              while (1) {
                while_continue___2: /* CIL Label */ ;
#line 326
                if (! ((unsigned long )q < (unsigned long )p)) {
#line 326
                  goto while_break___2;
                }
#line 328
                tmp___10 = q;
#line 328
                q ++;
#line 328
                c = *tmp___10;
#line 329
                if ((unsigned long )bp < (unsigned long )buflim) {
#line 331
                  if (quoteit) {
#line 331
                    if ((int )c == 34) {
#line 333
                      tmp___11 = bp;
#line 333
                      bp ++;
#line 333
                      *tmp___11 = (char )'\\';
                    }
                  }
#line 335
                  tmp___12 = bp;
#line 335
                  bp ++;
#line 335
                  *tmp___12 = c;
                }
              }
              while_break___2: /* CIL Label */ ;
              }
#line 339
              if (quoteit) {
#line 341
                if ((unsigned long )bp == (unsigned long )(bufhead + 1)) {
#line 342
                  bp --;
                } else {
#line 345
                  tmp___13 = bp;
#line 345
                  bp ++;
#line 345
                  *tmp___13 = (char )'\"';
                }
                {
#line 347
                while (1) {
                  while_continue___3: /* CIL Label */ ;
#line 347
                  tmp___15 = p;
#line 347
                  p ++;
#line 347
                  c = *tmp___15;
#line 347
                  if (! ((int )c != 58)) {
#line 347
                    goto while_break___3;
                  }
#line 349
                  if ((unsigned long )bp < (unsigned long )buflim) {
#line 351
                    tmp___14 = bp;
#line 351
                    bp ++;
#line 351
                    *tmp___14 = c;
                  }
                }
                while_break___3: /* CIL Label */ ;
                }
#line 355
                tmp___16 = bp;
#line 355
                bp ++;
#line 355
                *tmp___16 = c;
              }
              {
#line 359
              while (1) {
                while_continue___4: /* CIL Label */ ;
#line 359
                if (((int )*p & -128) == 0) {
                  {
#line 359
                  tmp___19 = __ctype_b_loc();
                  }
#line 359
                  if ((int const   )*(*tmp___19 + (int )*p) & 8192) {
#line 359
                    if (! ((unsigned long )bp < (unsigned long )buflim)) {
#line 359
                      goto while_break___4;
                    }
                  } else {
#line 359
                    goto while_break___4;
                  }
                } else {
#line 359
                  goto while_break___4;
                }
#line 362
                tmp___17 = bp;
#line 362
                bp ++;
#line 362
                tmp___18 = p;
#line 362
                p ++;
#line 362
                *tmp___17 = *tmp___18;
              }
              while_break___4: /* CIL Label */ ;
              }
#line 364
              copylev = 0;
#line 365
              quoteit = (enum bool )0;
#line 365
              putgmac = quoteit;
#line 366
              bufhead = bp;
#line 367
              addrhead = p;
#line 368
              goto cont;
            }
          }
        }
      }
    }
#line 371
    if ((int )c == 59) {
#line 371
      if (copylev <= 0) {
#line 371
        if (! ColonOkInAddr) {
#line 373
          if ((unsigned long )bp < (unsigned long )buflim) {
#line 375
            tmp___20 = bp;
#line 375
            bp ++;
#line 375
            *tmp___20 = c;
          }
        }
      }
    }
    {
#line 379
    tmp___21 = strchr((char const   *)MustQuoteChars, (int )c);
    }
#line 379
    if ((unsigned long )tmp___21 != (unsigned long )((void *)0)) {
#line 388
      if (cmtlev <= 0) {
#line 388
        if (! qmode) {
#line 389
          quoteit = (enum bool )1;
        }
      }
    }
#line 393
    if ((int )c == 60) {
#line 398
      if (gotangle) {
#line 399
        quoteit = (enum bool )1;
      }
#line 400
      gotangle = (enum bool )1;
#line 403
      anglelev = 1;
#line 404
      if (! skipping) {
#line 405
        realanglelev = 1;
      }
#line 407
      bp = bufhead;
#line 408
      if (quoteit) {
#line 411
        tmp___22 = bp;
#line 411
        bp ++;
#line 411
        *tmp___22 = (char )'\"';
#line 414
        p --;
        {
#line 415
        while (1) {
          while_continue___5: /* CIL Label */ ;
#line 415
          p --;
#line 415
          if (((int )*p & -128) == 0) {
            {
#line 415
            tmp___23 = __ctype_b_loc();
            }
#line 415
            if (! ((int const   )*(*tmp___23 + (int )*p) & 8192)) {
#line 415
              goto while_break___5;
            }
          } else {
#line 415
            goto while_break___5;
          }
        }
        while_break___5: /* CIL Label */ ;
        }
#line 417
        p ++;
      }
#line 419
      q___0 = addrhead;
      {
#line 419
      while (1) {
        while_continue___6: /* CIL Label */ ;
#line 419
        if (! ((unsigned long )q___0 < (unsigned long )p)) {
#line 419
          goto while_break___6;
        }
#line 421
        tmp___24 = q___0;
#line 421
        q___0 ++;
#line 421
        c = *tmp___24;
#line 422
        if ((unsigned long )bp < (unsigned long )buflim) {
#line 424
          if (quoteit) {
#line 424
            if ((int )c == 34) {
#line 426
              tmp___25 = bp;
#line 426
              bp ++;
#line 426
              *tmp___25 = (char )'\\';
            }
          }
#line 428
          tmp___26 = bp;
#line 428
          bp ++;
#line 428
          *tmp___26 = c;
        }
      }
      while_break___6: /* CIL Label */ ;
      }
#line 431
      if (quoteit) {
#line 433
        if ((unsigned long )bp == (unsigned long )(& buf[1])) {
#line 434
          bp --;
        } else {
#line 437
          tmp___27 = bp;
#line 437
          bp ++;
#line 437
          *tmp___27 = (char )'\"';
        }
        {
#line 438
        while (1) {
          while_continue___7: /* CIL Label */ ;
#line 438
          tmp___29 = p;
#line 438
          p ++;
#line 438
          c = *tmp___29;
#line 438
          if (! ((int )c != 60)) {
#line 438
            goto while_break___7;
          }
#line 440
          if ((unsigned long )bp < (unsigned long )buflim) {
#line 442
            tmp___28 = bp;
#line 442
            bp ++;
#line 442
            *tmp___28 = c;
          }
        }
        while_break___7: /* CIL Label */ ;
        }
#line 445
        tmp___30 = bp;
#line 445
        bp ++;
#line 445
        *tmp___30 = c;
      }
#line 447
      copylev = 0;
#line 448
      quoteit = (enum bool )0;
#line 448
      putgmac = quoteit;
#line 449
      goto cont;
    }
#line 452
    if ((int )c == 62) {
#line 454
      if (anglelev > 0) {
#line 456
        anglelev --;
#line 457
        if (! skipping) {
#line 459
          realanglelev --;
#line 460
          buflim ++;
        }
      } else
#line 463
      if (! skipping) {
#line 466
        if (copylev > 0) {
#line 467
          bp --;
        }
#line 468
        quoteit = (enum bool )1;
#line 469
        goto cont;
      }
#line 471
      tmp___32 = copylev;
#line 471
      copylev ++;
#line 471
      if (tmp___32 <= 0) {
#line 473
        tmp___31 = bp;
#line 473
        bp ++;
#line 473
        *tmp___31 = c;
      }
#line 474
      goto cont;
    }
    putg: 
#line 479
    if (copylev <= 0) {
#line 479
      if (! putgmac) {
#line 481
        if ((unsigned long )bp > (unsigned long )bufhead) {
#line 481
          if ((int )*(bp + -1) == 41) {
#line 483
            tmp___33 = bp;
#line 483
            bp ++;
#line 483
            *tmp___33 = (char )' ';
          }
        }
#line 485
        tmp___34 = bp;
#line 485
        bp ++;
#line 485
        *tmp___34 = (char)-127;
#line 487
        tmp___35 = bp;
#line 487
        bp ++;
#line 487
        *tmp___35 = (char )'g';
#line 488
        putgmac = (enum bool )1;
      }
    }
    {
#line 490
    printf((char const   */* __restrict  */)"Buf = %s\n", buf);
    }
    cont: ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 494
  if (realqmode) {
#line 496
    tmp___37 = bp;
#line 496
    bp ++;
#line 496
    *tmp___37 = (char )'\"';
  }
  {
#line 497
  while (1) {
    while_continue___8: /* CIL Label */ ;
#line 497
    tmp___39 = realcmtlev;
#line 497
    realcmtlev --;
#line 497
    if (! (tmp___39 > 0)) {
#line 497
      goto while_break___8;
    }
#line 499
    tmp___38 = bp;
#line 499
    bp ++;
#line 499
    *tmp___38 = (char )')';
  }
  while_break___8: /* CIL Label */ ;
  }
  {
#line 500
  while (1) {
    while_continue___9: /* CIL Label */ ;
#line 500
    tmp___41 = realanglelev;
#line 500
    realanglelev --;
#line 500
    if (! (tmp___41 > 0)) {
#line 500
      goto while_break___9;
    }
#line 502
    tmp___40 = bp;
#line 502
    bp ++;
#line 502
    *tmp___40 = (char )'>';
  }
  while_break___9: /* CIL Label */ ;
  }
  {
#line 504
  tmp___42 = bp;
#line 504
  bp ++;
#line 504
  *tmp___42 = (char )'\000';
#line 506
  printf((char const   */* __restrict  */)"test_buf should equal GOOD\n");
#line 507
  printf((char const   */* __restrict  */)"test_buf = %s\n", test_buf);
  }
#line 509
  return (buf);
}
}
#line 513 "crackaddr-bad.c"
int main(void) 
{ 
  char address[100] ;
  char *res_addr ;
  size_t tmp ;
  void *__cil_tmp4 ;
  char *__cil_tmp5 ;
  char *__cil_tmp6 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;
  char *__cil_tmp11 ;

  {
  {
#line 518
  printf((char const   */* __restrict  */)"Type 1 or 0 to allow or disallow colons in email address:\n");
#line 519
  scanf((char const   */* __restrict  */)"%d", & ColonOkInAddr);
#line 520
  MustQuoteChars = (char *)"@,;:\\()[].\'";
#line 522
  printf((char const   */* __restrict  */)"Enter email address:\n");
#line 523
  scanf((char const   */* __restrict  */)"%99s", address);
#line 525
  res_addr = crackaddr(address);
#line 526
  printf((char const   */* __restrict  */)"result = %s\n", res_addr);
#line 527
  tmp = strlen((char const   *)res_addr);
#line 527
  printf((char const   */* __restrict  */)"buf len = %d\n", tmp);
  }
#line 529
  return (0);
}
}
