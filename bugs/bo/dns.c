/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 30 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned char __u_char;
#line 31 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned short __u_short;
#line 32 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __u_int;
#line 33 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __u_long;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 33 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_char u_char;
#line 34 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_short u_short;
#line 35 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_int u_int;
#line 36 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_long u_long;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.6/include/stddef.h"
typedef unsigned long size_t;
#line 201 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned short u_int16_t;
#line 202 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned int u_int32_t;
#line 48 "/usr/include/arpa/nameser_compat.h"
struct __anonstruct_HEADER_38 {
   unsigned int id : 16 ;
   unsigned int rd : 1 ;
   unsigned int tc : 1 ;
   unsigned int aa : 1 ;
   unsigned int opcode : 4 ;
   unsigned int qr : 1 ;
   unsigned int rcode : 4 ;
   unsigned int cd : 1 ;
   unsigned int ad : 1 ;
   unsigned int unused : 1 ;
   unsigned int ra : 1 ;
   unsigned int qdcount : 16 ;
   unsigned int ancount : 16 ;
   unsigned int nscount : 16 ;
   unsigned int arcount : 16 ;
};
#line 48 "/usr/include/arpa/nameser_compat.h"
typedef struct __anonstruct_HEADER_38 HEADER;
#line 69 "txt-dns.h"
struct __anonstruct_DNS_QUERY_T_39 {
   char *dns_q_domain ;
   unsigned int dns_q_type ;
   unsigned int dns_q_class ;
};
#line 69 "txt-dns.h"
typedef struct __anonstruct_DNS_QUERY_T_39 DNS_QUERY_T;
#line 76 "txt-dns.h"
struct __anonstruct_MX_RECORD_T_40 {
   unsigned int mx_r_preference ;
   char mx_r_domain[1] ;
};
#line 76 "txt-dns.h"
typedef struct __anonstruct_MX_RECORD_T_40 MX_RECORD_T;
#line 82 "txt-dns.h"
struct __anonstruct_SRV_RECORDT_T_41 {
   unsigned int srv_r_priority ;
   unsigned int srv_r_weight ;
   unsigned int srv_r_port ;
   char srv_r_target[1] ;
};
#line 82 "txt-dns.h"
typedef struct __anonstruct_SRV_RECORDT_T_41 SRV_RECORDT_T;
#line 91
struct resource_record;
#line 91 "txt-dns.h"
typedef struct resource_record RESOURCE_RECORD_T;
#line 93 "txt-dns.h"
union __anonunion_rr_u_42 {
   void *rr_data ;
   MX_RECORD_T *rr_mx ;
   MX_RECORD_T *rr_afsdb ;
   SRV_RECORDT_T *rr_srv ;
   char *rr_txt ;
};
#line 93 "txt-dns.h"
struct resource_record {
   char *rr_domain ;
   unsigned int rr_type ;
   unsigned int rr_class ;
   unsigned int rr_ttl ;
   unsigned int rr_size ;
   union __anonunion_rr_u_42 rr_u ;
   RESOURCE_RECORD_T *rr_next ;
};
#line 117 "txt-dns.h"
struct __anonstruct_DNS_REPLY_T_43 {
   HEADER dns_r_h ;
   DNS_QUERY_T dns_r_q ;
   RESOURCE_RECORD_T *dns_r_head ;
};
#line 117 "txt-dns.h"
typedef struct __anonstruct_DNS_REPLY_T_43 DNS_REPLY_T;
#line 48 "/usr/include/stdint.h"
typedef unsigned char uint8_t;
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 149 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 117 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 209 "/usr/include/netinet/in.h"
union __anonunion___in6_u_50 {
   uint8_t __u6_addr8[16] ;
   uint16_t __u6_addr16[8] ;
   uint32_t __u6_addr32[4] ;
};
#line 209 "/usr/include/netinet/in.h"
struct in6_addr {
   union __anonunion___in6_u_50 __in6_u ;
};
#line 237 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 252 "/usr/include/netinet/in.h"
struct sockaddr_in6 {
   sa_family_t sin6_family ;
   in_port_t sin6_port ;
   uint32_t sin6_flowinfo ;
   struct in6_addr sin6_addr ;
   uint32_t sin6_scope_id ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 71 "/usr/include/resolv.h"
enum __anonenum_res_sendhookact_55 {
    res_goahead = 0,
    res_nextns = 1,
    res_modified = 2,
    res_done = 3,
    res_error = 4
} ;
#line 71 "/usr/include/resolv.h"
typedef enum __anonenum_res_sendhookact_55 res_sendhookact;
#line 104 "/usr/include/resolv.h"
struct __anonstruct_sort_list_56 {
   struct in_addr addr ;
   u_int32_t mask ;
};
#line 104 "/usr/include/resolv.h"
struct __anonstruct__ext_58 {
   u_int16_t nscount ;
   u_int16_t nsmap[3] ;
   int nssocks[3] ;
   u_int16_t nscount6 ;
   u_int16_t nsinit ;
   struct sockaddr_in6 *nsaddrs[3] ;
   unsigned int _initstamp[2] ;
};
#line 104 "/usr/include/resolv.h"
union __anonunion__u_57 {
   char pad[52] ;
   struct __anonstruct__ext_58 _ext ;
};
#line 104 "/usr/include/resolv.h"
struct __res_state {
   int retrans ;
   int retry ;
   u_long options ;
   int nscount ;
   struct sockaddr_in nsaddr_list[3] ;
   u_short id ;
   char *dnsrch[7] ;
   char defdname[256] ;
   u_long pfcode ;
   unsigned int ndots : 4 ;
   unsigned int nsort : 4 ;
   unsigned int ipv6_unavail : 1 ;
   unsigned int unused : 23 ;
   struct __anonstruct_sort_list_56 sort_list[10] ;
   res_sendhookact (*qhook)(struct sockaddr_in * const  *__ns , u_char const   **__query ,
                            int *__querylen , u_char *__ans , int __anssiz , int *__resplen ) ;
   res_sendhookact (*rhook)(struct sockaddr_in  const  *__ns , u_char const   *__query ,
                            int __querylen , u_char *__ans , int __anssiz , int *__resplen ) ;
   int res_h_errno ;
   int _vcsock ;
   u_int _flags ;
   union __anonunion__u_57 _u ;
};
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 531
extern int fgetc(FILE *__stream ) ;
#line 573
extern int fputc(int __c , FILE *__stream ) ;
#line 249 "/usr/include/resolv.h"
extern struct __res_state *__res_state(void)  __attribute__((__const__)) ;
#line 273
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_init)(void) ;
#line 280
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_search)(char const   * ,
                                                                                   int  ,
                                                                                   int  ,
                                                                                   u_char * ,
                                                                                   int  ) ;
#line 357
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __dn_expand)(u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  char * ,
                                                                                  int  ) ;
#line 483 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 132
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strncpy)(char * __restrict  __dest ,
                                                                                                  char const   * __restrict  __src ,
                                                                                                  size_t __n ) ;
#line 176
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strdup)(char const   *__s )  __attribute__((__malloc__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 106 "txt-dns-file-bad.c"
char *DNSFILE  =    (char *)"dns-file";
#line 107 "txt-dns-file-bad.c"
int DNS_REC_LEN  ;
#line 113
void *xalloc(size_t sz ) ;
#line 115
size_t strlcpy(char *dst , char const   *src , size_t siz ) ;
#line 116
int read_record_from_file(unsigned char *reply , int size ) ;
#line 130 "txt-dns-file-bad.c"
void dns_free_data(DNS_REPLY_T *r ) 
{ 
  RESOURCE_RECORD_T *rr ;
  RESOURCE_RECORD_T *tmp ;

  {
#line 136
  if ((unsigned long )r->dns_r_q.dns_q_domain != (unsigned long )((void *)0)) {
    {
#line 137
    free((void *)r->dns_r_q.dns_q_domain);
    }
  }
#line 138
  rr = r->dns_r_head;
  {
#line 138
  while (1) {
    while_continue: /* CIL Label */ ;
#line 138
    if (! ((unsigned long )rr != (unsigned long )((void *)0))) {
#line 138
      goto while_break;
    }
#line 140
    tmp = rr;
#line 142
    if ((unsigned long )rr->rr_domain != (unsigned long )((void *)0)) {
      {
#line 143
      free((void *)rr->rr_domain);
      }
    }
#line 144
    if ((unsigned long )rr->rr_u.rr_data != (unsigned long )((void *)0)) {
      {
#line 145
      free(rr->rr_u.rr_data);
      }
    }
    {
#line 146
    rr = rr->rr_next;
#line 147
    free((void *)tmp);
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 149
  free((void *)r);
  }
#line 150
  return;
}
}
#line 167 "txt-dns-file-bad.c"
static DNS_REPLY_T *parse_dns_reply(unsigned char *data , int len ) 
{ 
  unsigned char *p ;
  int status ;
  size_t l ;
  char host[64] ;
  DNS_REPLY_T *r ;
  RESOURCE_RECORD_T **rr ;
  void *tmp ;
  size_t tmp___0 ;
  char *tmp___1 ;
  u_char const   *t_cp ;
  u_char const   *t_cp___0 ;
  int type ;
  int class ;
  int ttl ;
  int size ;
  size_t tmp___2 ;
  u_char const   *t_cp___1 ;
  u_char const   *t_cp___2 ;
  u_char const   *t_cp___3 ;
  u_char const   *t_cp___4 ;
  void *tmp___3 ;
  char *tmp___4 ;
  char *tmp___5 ;
  size_t tmp___6 ;
  void *tmp___7 ;
  size_t tmp___8 ;
  void *tmp___9 ;
  void *tmp___10 ;
  void *tmp___11 ;
  void *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;
  char *__cil_tmp41 ;

  {
  {
#line 179
  printf((char const   */* __restrict  */)"parse_dns_reply called..\n");
#line 181
  tmp = xalloc(sizeof(*r));
#line 181
  r = (DNS_REPLY_T *)tmp;
#line 182
  memset((void *)r, 0, sizeof(*r));
  }
#line 183
  if ((unsigned long )r == (unsigned long )((void *)0)) {
#line 184
    return ((DNS_REPLY_T *)((void *)0));
  }
  {
#line 186
  p = data;
#line 189
  memcpy((void */* __restrict  */)((void *)(& r->dns_r_h)), (void const   */* __restrict  */)((void *)p),
         sizeof(HEADER ));
#line 190
  p += sizeof(HEADER );
#line 193
  strcpy((char */* __restrict  */)(host), (char const   */* __restrict  */)"LL.MIT.EDU");
#line 194
  tmp___0 = strlen((char const   *)(host));
#line 194
  status = (int )tmp___0;
  }
#line 196
  if (status < 0) {
    {
#line 198
    dns_free_data(r);
    }
#line 199
    return ((DNS_REPLY_T *)((void *)0));
  }
  {
#line 201
  tmp___1 = strdup((char const   *)(host));
#line 201
  r->dns_r_q.dns_q_domain = tmp___1;
  }
#line 202
  if ((unsigned long )r->dns_r_q.dns_q_domain == (unsigned long )((void *)0)) {
    {
#line 204
    dns_free_data(r);
    }
#line 205
    return ((DNS_REPLY_T *)((void *)0));
  }
#line 207
  p += status;
  {
#line 208
  while (1) {
    while_continue: /* CIL Label */ ;
#line 208
    t_cp = (u_char const   *)p;
#line 208
    r->dns_r_q.dns_q_type = (unsigned int )(((int )((u_int16_t )*(t_cp + 0)) << 8) | (int )((u_int16_t )*(t_cp + 1)));
#line 208
    p += 2;
#line 208
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 209
  printf((char const   */* __restrict  */)"Record type queried = %d\n", r->dns_r_q.dns_q_type);
  }
  {
#line 210
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 210
    t_cp___0 = (u_char const   *)p;
#line 210
    r->dns_r_q.dns_q_class = (unsigned int )(((int )((u_int16_t )*(t_cp___0 + 0)) << 8) | (int )((u_int16_t )*(t_cp___0 + 1)));
#line 210
    p += 2;
#line 210
    goto while_break___0;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 211
  rr = & r->dns_r_head;
  {
#line 212
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 212
    if (! ((unsigned long )p < (unsigned long )(data + len))) {
#line 212
      goto while_break___1;
    }
    {
#line 216
    strcpy((char */* __restrict  */)(host), (char const   */* __restrict  */)"BLAH.MIT.EDU");
#line 218
    tmp___2 = strlen((char const   *)(host));
#line 218
    status = (int )tmp___2;
#line 220
    printf((char const   */* __restrict  */)"status returned = %d\n", status);
    }
#line 221
    if (status < 0) {
      {
#line 223
      dns_free_data(r);
      }
#line 224
      return ((DNS_REPLY_T *)((void *)0));
    }
#line 226
    p += status;
    {
#line 227
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 227
      t_cp___1 = (u_char const   *)p;
#line 227
      type = ((int )((u_int16_t )*(t_cp___1 + 0)) << 8) | (int )((u_int16_t )*(t_cp___1 + 1));
#line 227
      p += 2;
#line 227
      goto while_break___2;
    }
    while_break___2: /* CIL Label */ ;
    }
    {
#line 228
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 228
      t_cp___2 = (u_char const   *)p;
#line 228
      class = ((int )((u_int16_t )*(t_cp___2 + 0)) << 8) | (int )((u_int16_t )*(t_cp___2 + 1));
#line 228
      p += 2;
#line 228
      goto while_break___3;
    }
    while_break___3: /* CIL Label */ ;
    }
    {
#line 229
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 229
      t_cp___3 = (u_char const   *)p;
#line 229
      ttl = (int )(((((u_int32_t )*(t_cp___3 + 0) << 24) | ((u_int32_t )*(t_cp___3 + 1) << 16)) | ((u_int32_t )*(t_cp___3 + 2) << 8)) | (u_int32_t )*(t_cp___3 + 3));
#line 229
      p += 4;
#line 229
      goto while_break___4;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
#line 230
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 230
      t_cp___4 = (u_char const   *)p;
#line 230
      size = ((int )((u_int16_t )*(t_cp___4 + 0)) << 8) | (int )((u_int16_t )*(t_cp___4 + 1));
#line 230
      p += 2;
#line 230
      goto while_break___5;
    }
    while_break___5: /* CIL Label */ ;
    }
    {
#line 231
    tmp___3 = xalloc(sizeof(RESOURCE_RECORD_T ));
#line 231
    *rr = (RESOURCE_RECORD_T *)tmp___3;
    }
#line 232
    if ((unsigned long )*rr == (unsigned long )((void *)0)) {
      {
#line 234
      dns_free_data(r);
      }
#line 235
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 237
    tmp___4 = strdup((char const   *)(host));
#line 237
    (*rr)->rr_domain = tmp___4;
    }
#line 238
    if ((unsigned long )(*rr)->rr_domain == (unsigned long )((void *)0)) {
      {
#line 240
      dns_free_data(r);
      }
#line 241
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 243
    (*rr)->rr_type = (unsigned int )type;
#line 244
    (*rr)->rr_class = (unsigned int )class;
#line 245
    (*rr)->rr_ttl = (unsigned int )ttl;
#line 246
    (*rr)->rr_size = (unsigned int )size;
#line 248
    printf((char const   */* __restrict  */)"query type = %d\n", type);
    }
    {
#line 254
    if (type == 12) {
#line 254
      goto case_12;
    }
#line 254
    if (type == 5) {
#line 254
      goto case_12;
    }
#line 254
    if (type == 2) {
#line 254
      goto case_12;
    }
#line 271
    if (type == 18) {
#line 271
      goto case_18;
    }
#line 271
    if (type == 15) {
#line 271
      goto case_18;
    }
#line 292
    if (type == 33) {
#line 292
      goto case_33;
    }
#line 315
    if (type == 16) {
#line 315
      goto case_16;
    }
#line 333
    goto switch_default;
    case_12: /* CIL Label */ 
    case_5: /* CIL Label */ 
    case_2: /* CIL Label */ 
    {
#line 255
    status = __dn_expand((u_char const   *)data, (u_char const   *)(data + len), (u_char const   *)p,
                         host, (int )sizeof(host));
    }
#line 257
    if (status < 0) {
      {
#line 259
      dns_free_data(r);
      }
#line 260
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 262
    tmp___5 = strdup((char const   *)(host));
#line 262
    (*rr)->rr_u.rr_txt = tmp___5;
    }
#line 263
    if ((unsigned long )(*rr)->rr_u.rr_txt == (unsigned long )((void *)0)) {
      {
#line 265
      dns_free_data(r);
      }
#line 266
      return ((DNS_REPLY_T *)((void *)0));
    }
#line 268
    goto switch_break;
    case_18: /* CIL Label */ 
    case_15: /* CIL Label */ 
    {
#line 272
    status = __dn_expand((u_char const   *)data, (u_char const   *)(data + len), (u_char const   *)(p + 2),
                         host, (int )sizeof(host));
    }
#line 274
    if (status < 0) {
      {
#line 276
      dns_free_data(r);
      }
#line 277
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 279
    tmp___6 = strlen((char const   *)(host));
#line 279
    l = tmp___6 + 1UL;
#line 280
    tmp___7 = xalloc(sizeof(MX_RECORD_T ) + l);
#line 280
    (*rr)->rr_u.rr_mx = (MX_RECORD_T *)tmp___7;
    }
#line 282
    if ((unsigned long )(*rr)->rr_u.rr_mx == (unsigned long )((void *)0)) {
      {
#line 284
      dns_free_data(r);
      }
#line 285
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 287
    ((*rr)->rr_u.rr_mx)->mx_r_preference = (unsigned int )(((int )*(p + 0) << 8) | (int )*(p + 1));
#line 288
    strlcpy(((*rr)->rr_u.rr_mx)->mx_r_domain, (char const   *)(host), l);
    }
#line 290
    goto switch_break;
    case_33: /* CIL Label */ 
    {
#line 293
    status = __dn_expand((u_char const   *)data, (u_char const   *)(data + len), (u_char const   *)(p + 6),
                         host, (int )sizeof(host));
    }
#line 295
    if (status < 0) {
      {
#line 297
      dns_free_data(r);
      }
#line 298
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 300
    tmp___8 = strlen((char const   *)(host));
#line 300
    l = tmp___8 + 1UL;
#line 301
    tmp___9 = xalloc(sizeof(SRV_RECORDT_T ) + l);
#line 301
    (*rr)->rr_u.rr_srv = (SRV_RECORDT_T *)tmp___9;
    }
#line 303
    if ((unsigned long )(*rr)->rr_u.rr_srv == (unsigned long )((void *)0)) {
      {
#line 305
      dns_free_data(r);
      }
#line 306
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 308
    ((*rr)->rr_u.rr_srv)->srv_r_priority = (unsigned int )(((int )*(p + 0) << 8) | (int )*(p + 1));
#line 309
    ((*rr)->rr_u.rr_srv)->srv_r_weight = (unsigned int )(((int )*(p + 2) << 8) | (int )*(p + 3));
#line 310
    ((*rr)->rr_u.rr_srv)->srv_r_port = (unsigned int )(((int )*(p + 4) << 8) | (int )*(p + 5));
#line 311
    strlcpy(((*rr)->rr_u.rr_srv)->srv_r_target, (char const   *)(host), l);
    }
#line 313
    goto switch_break;
    case_16: /* CIL Label */ 
    {
#line 317
    printf((char const   */* __restrict  */)"We are in the T_TXT switch block\n");
#line 318
    tmp___10 = xalloc((size_t )(size + 1));
#line 318
    (*rr)->rr_u.rr_txt = (char *)tmp___10;
    }
#line 319
    if ((unsigned long )(*rr)->rr_u.rr_txt == (unsigned long )((void *)0)) {
      {
#line 321
      dns_free_data(r);
      }
#line 322
      return ((DNS_REPLY_T *)((void *)0));
    }
    {
#line 325
    printf((char const   */* __restrict  */)"Copying TXT record!!!\n");
#line 326
    printf((char const   */* __restrict  */)"Copying %d bytes into a buffer of size %d!!!\n",
           (int )*p, size + 1);
#line 328
    strncpy((char */* __restrict  */)(*rr)->rr_u.rr_txt, (char const   */* __restrict  */)((char *)p + 1),
            (size_t )*p);
#line 330
    *((*rr)->rr_u.rr_txt + *p) = (char)0;
    }
#line 331
    goto switch_break;
    switch_default: /* CIL Label */ 
    {
#line 334
    tmp___11 = xalloc((size_t )size);
#line 334
    (*rr)->rr_u.rr_data = (void *)((unsigned char *)tmp___11);
    }
#line 335
    if (size != 0) {
#line 335
      if ((unsigned long )(*rr)->rr_u.rr_data == (unsigned long )((void *)0)) {
        {
#line 337
        dns_free_data(r);
        }
#line 338
        return ((DNS_REPLY_T *)((void *)0));
      }
    }
    {
#line 340
    memcpy((void */* __restrict  */)(*rr)->rr_u.rr_data, (void const   */* __restrict  */)((void *)p),
           (size_t )size);
    }
    switch_break: /* CIL Label */ ;
    }
#line 342
    p += size;
#line 343
    rr = & (*rr)->rr_next;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 345
  *rr = (RESOURCE_RECORD_T *)((void *)0);
#line 346
  return (r);
}
}
#line 366 "txt-dns-file-bad.c"
DNS_REPLY_T *dns_lookup_int(char const   *domain , int rr_class , int rr_type , time_t retrans ,
                            int retry ) 
{ 
  int len ;
  time_t save_retrans ;
  int save_retry ;
  DNS_REPLY_T *r ;
  unsigned char reply[1024] ;
  struct __res_state *tmp ;
  struct __res_state *tmp___0 ;
  struct __res_state *tmp___1 ;
  struct __res_state *tmp___2 ;
  struct __res_state *tmp___3 ;
  struct __res_state *tmp___4 ;
  void *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;

  {
#line 375
  save_retrans = (time_t )0;
#line 376
  save_retry = 0;
#line 377
  r = (DNS_REPLY_T *)((void *)0);
#line 380
  if (retrans > 0L) {
    {
#line 382
    tmp = __res_state();
#line 382
    save_retrans = (time_t )tmp->retrans;
#line 383
    tmp___0 = __res_state();
#line 383
    tmp___0->retrans = (int )retrans;
    }
  }
#line 385
  if (retry > 0) {
    {
#line 387
    tmp___1 = __res_state();
#line 387
    save_retry = tmp___1->retry;
#line 388
    tmp___2 = __res_state();
#line 388
    tmp___2->retry = retry;
    }
  }
#line 391
  if (rr_type == 16) {
    {
#line 392
    printf((char const   */* __restrict  */)"Reading from file = %s ...\n", DNSFILE);
#line 393
    len = read_record_from_file(reply, (int )sizeof(reply));
#line 394
    printf((char const   */* __restrict  */)"read_record_from_file returned len = %d\n",
           len);
    }
  } else {
    {
#line 397
    len = __res_search(domain, rr_class, rr_type, reply, (int )sizeof(reply));
    }
  }
#line 401
  if (len >= 0) {
    {
#line 402
    r = parse_dns_reply(reply, len);
    }
  }
#line 404
  if (retrans > 0L) {
    {
#line 405
    tmp___3 = __res_state();
#line 405
    tmp___3->retrans = (int )save_retrans;
    }
  }
#line 408
  if (retry > 0) {
    {
#line 409
    tmp___4 = __res_state();
#line 409
    tmp___4->retry = save_retry;
    }
  }
#line 411
  return (r);
}
}
#line 414 "txt-dns-file-bad.c"
int read_record_from_file(unsigned char *reply , int size ) 
{ 
  FILE *f ;
  int i ;
  unsigned char *temp ;
  unsigned char *tmp ;
  int tmp___0 ;
  char *__cil_tmp8 ;

  {
#line 420
  temp = reply;
#line 422
  if (DNS_REC_LEN > size) {
#line 423
    return (-1);
  } else {
    {
#line 425
    f = fopen((char const   */* __restrict  */)DNSFILE, (char const   */* __restrict  */)"r");
#line 429
    i = 0;
    }
    {
#line 429
    while (1) {
      while_continue: /* CIL Label */ ;
#line 429
      if (! (i < DNS_REC_LEN)) {
#line 429
        goto while_break;
      }
      {
#line 430
      tmp = temp;
#line 430
      temp ++;
#line 430
      tmp___0 = fgetc(f);
#line 430
      *tmp = (unsigned char )tmp___0;
#line 429
      i ++;
      }
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 432
    fclose(f);
    }
  }
#line 435
  return (i);
}
}
#line 439 "txt-dns-file-bad.c"
int create_dns_file(void) 
{ 
  FILE *f ;
  unsigned char buf[200] ;
  unsigned char *p ;
  char *temp ;
  int i ;
  int len ;
  size_t tmp ;
  unsigned char *tmp___0 ;
  char *tmp___1 ;
  size_t tmp___2 ;
  unsigned char *tmp___3 ;
  char *tmp___4 ;
  unsigned char *tmp___5 ;
  unsigned char *tmp___6 ;
  unsigned char *tmp___7 ;
  unsigned char *tmp___8 ;
  size_t tmp___9 ;
  unsigned char *tmp___10 ;
  char *tmp___11 ;
  unsigned char *tmp___12 ;
  unsigned char *tmp___13 ;
  unsigned char *tmp___14 ;
  unsigned char *tmp___15 ;
  unsigned char *tmp___16 ;
  unsigned char *tmp___17 ;
  unsigned char *tmp___18 ;
  unsigned char *tmp___19 ;
  unsigned char *tmp___20 ;
  unsigned char *tmp___21 ;
  unsigned char *tmp___22 ;
  size_t tmp___23 ;
  unsigned char *tmp___24 ;
  char *tmp___25 ;
  void *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;

  {
  {
#line 445
  len = 0;
#line 447
  p = buf;
#line 449
  temp = (char *)"HEADER JUNK:";
#line 450
  tmp = strlen((char const   *)temp);
#line 450
  len = (int )((size_t )len + tmp);
  }
  {
#line 452
  while (1) {
    while_continue: /* CIL Label */ ;
#line 452
    if (! ((int )*temp != 0)) {
#line 452
      goto while_break;
    }
#line 453
    tmp___0 = p;
#line 453
    p ++;
#line 453
    tmp___1 = temp;
#line 453
    temp ++;
#line 453
    *tmp___0 = (unsigned char )*tmp___1;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 455
  temp = (char *)"LL.MIT.EDU";
#line 456
  tmp___2 = strlen((char const   *)temp);
#line 456
  len = (int )((size_t )len + tmp___2);
  }
  {
#line 458
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 458
    if (! ((int )*temp != 0)) {
#line 458
      goto while_break___0;
    }
#line 459
    tmp___3 = p;
#line 459
    p ++;
#line 459
    tmp___4 = temp;
#line 459
    temp ++;
#line 459
    *tmp___3 = (unsigned char )*tmp___4;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 461
  tmp___5 = p;
#line 461
  p ++;
#line 461
  *tmp___5 = (unsigned char)0;
#line 462
  tmp___6 = p;
#line 462
  p ++;
#line 462
  *tmp___6 = (unsigned char)16;
#line 463
  tmp___7 = p;
#line 463
  p ++;
#line 463
  *tmp___7 = (unsigned char)0;
#line 464
  tmp___8 = p;
#line 464
  p ++;
#line 464
  *tmp___8 = (unsigned char)1;
#line 466
  len += 4;
#line 468
  temp = (char *)"BLAH.MIT.EDU";
#line 469
  tmp___9 = strlen((char const   *)temp);
#line 469
  len = (int )((size_t )len + tmp___9);
  }
  {
#line 471
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 471
    if (! ((int )*temp != 0)) {
#line 471
      goto while_break___1;
    }
#line 472
    tmp___10 = p;
#line 472
    p ++;
#line 472
    tmp___11 = temp;
#line 472
    temp ++;
#line 472
    *tmp___10 = (unsigned char )*tmp___11;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
#line 474
  tmp___12 = p;
#line 474
  p ++;
#line 474
  *tmp___12 = (unsigned char)0;
#line 475
  tmp___13 = p;
#line 475
  p ++;
#line 475
  *tmp___13 = (unsigned char)16;
#line 477
  tmp___14 = p;
#line 477
  p ++;
#line 477
  *tmp___14 = (unsigned char)0;
#line 478
  tmp___15 = p;
#line 478
  p ++;
#line 478
  *tmp___15 = (unsigned char)1;
#line 480
  tmp___16 = p;
#line 480
  p ++;
#line 480
  *tmp___16 = (unsigned char)0;
#line 481
  tmp___17 = p;
#line 481
  p ++;
#line 481
  *tmp___17 = (unsigned char)0;
#line 482
  tmp___18 = p;
#line 482
  p ++;
#line 482
  *tmp___18 = (unsigned char)0;
#line 483
  tmp___19 = p;
#line 483
  p ++;
#line 483
  *tmp___19 = (unsigned char)255;
#line 485
  tmp___20 = p;
#line 485
  p ++;
#line 485
  *tmp___20 = (unsigned char)0;
#line 486
  tmp___21 = p;
#line 486
  p ++;
#line 486
  *tmp___21 = (unsigned char)30;
#line 487
  tmp___22 = p;
#line 487
  p ++;
#line 487
  *tmp___22 = (unsigned char)255;
#line 489
  len += 11;
#line 491
  temp = (char *)"This is random junk in the TXT record that will overflow (*rr)->rr_u.rr_txt";
#line 492
  tmp___23 = strlen((char const   *)temp);
#line 492
  len = (int )((size_t )len + tmp___23);
  }
  {
#line 494
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 494
    if (! ((int )*temp != 0)) {
#line 494
      goto while_break___2;
    }
#line 495
    tmp___24 = p;
#line 495
    p ++;
#line 495
    tmp___25 = temp;
#line 495
    temp ++;
#line 495
    *tmp___24 = (unsigned char )*tmp___25;
  }
  while_break___2: /* CIL Label */ ;
  }
  {
#line 497
  f = fopen((char const   */* __restrict  */)DNSFILE, (char const   */* __restrict  */)"w");
#line 499
  p = buf;
#line 500
  i = 0;
  }
  {
#line 500
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 500
    if (! (i < len)) {
#line 500
      goto while_break___3;
    }
    {
#line 501
    fputc((int )*p, f);
#line 500
    i ++;
#line 500
    p ++;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  {
#line 503
  fclose(f);
  }
#line 505
  return (len);
}
}
#line 509 "txt-dns-file-bad.c"
int main(void) 
{ 
  char const   *domain ;
  int rr_class ;
  int rr_type ;
  time_t retrans ;
  int retry ;
  DNS_REPLY_T *dns_reply ;
  DNS_REPLY_T *tmp ;
  char *__cil_tmp8 ;

  {
  {
#line 511
  domain = "LL.MIT.EDU";
#line 512
  rr_class = 1;
#line 513
  rr_type = 16;
#line 514
  retrans = (time_t )10;
#line 515
  retry = 1;
#line 518
  DNS_REC_LEN = create_dns_file();
#line 520
  __res_init();
#line 522
  tmp = dns_lookup_int(domain, rr_class, rr_type, retrans, retry);
#line 522
  dns_reply = tmp;
  }
#line 527
  return (0);
}
}
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 69 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) __assert_fail)(char const   *__assertion ,
                                                                                                   char const   *__file ,
                                                                                                   unsigned int __line ,
                                                                                                   char const   *__function ) ;
#line 76 "my-util.c"
void *xalloc(size_t sz ) 
{ 
  void *p ;
  void *tmp ;
  char *__cil_tmp4 ;
  char *__cil_tmp5 ;
  char *__cil_tmp6 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;

  {
#line 80
  if (! (sz > 0UL)) {
    {
#line 80
    __assert_fail("sz>0", "my-util.c", 80U, "xalloc");
    }
  }
  {
#line 82
  tmp = malloc(sz);
#line 82
  p = tmp;
  }
#line 83
  if (! ((unsigned long )p != (unsigned long )((void *)0))) {
    {
#line 83
    __assert_fail("p!=((void *)0)", "my-util.c", 83U, "xalloc");
    }
  }
#line 85
  return (p);
}
}
#line 95 "my-util.c"
size_t strlcpy(char *dst , char const   *src , size_t siz ) 
{ 
  register char *d ;
  register char const   *s ;
  register size_t n ;
  char *tmp ;
  char tmp___0 ;
  char const   *tmp___1 ;
  char const   *tmp___2 ;

  {
#line 98
  d = dst;
#line 99
  s = src;
#line 100
  n = siz;
#line 103
  if (n != 0UL) {
#line 103
    n --;
#line 103
    if (n != 0UL) {
      {
#line 104
      while (1) {
        while_continue: /* CIL Label */ ;
#line 105
        tmp = d;
#line 105
        d ++;
#line 105
        tmp___1 = s;
#line 105
        s ++;
#line 105
        tmp___0 = (char )*tmp___1;
#line 105
        *tmp = tmp___0;
#line 105
        if ((int )tmp___0 == 0) {
#line 106
          goto while_break;
        }
#line 104
        n --;
#line 104
        if (! (n != 0UL)) {
#line 104
          goto while_break;
        }
      }
      while_break: /* CIL Label */ ;
      }
    }
  }
#line 111
  if (n == 0UL) {
#line 112
    if (siz != 0UL) {
#line 113
      *d = (char )'\000';
    }
    {
#line 114
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 114
      tmp___2 = s;
#line 114
      s ++;
#line 114
      if (! *tmp___2) {
#line 114
        goto while_break___0;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
  }
#line 118
  return ((size_t )((s - src) - 1L));
}
}
