/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 709
extern size_t fread(void * __restrict  __ptr , size_t __size , size_t __n , FILE * __restrict  __stream ) ;
#line 715
extern size_t fwrite(void const   * __restrict  __ptr , size_t __size , size_t __n ,
                     FILE * __restrict  __s ) ;
#line 749
extern int fseek(FILE *__stream , long __off , int __whence ) ;
#line 754
extern long ftell(FILE *__stream ) ;
#line 543 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 69 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) memcmp)(void const   *__s1 ,
                                                                                               void const   *__s2 ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 144
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strcmp)(char const   *__s1 ,
                                                                                               char const   *__s2 )  __attribute__((__pure__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 25 "/home/june/repo/benchmarks/collector/temp/cdi2iso-0.1/./src/cdi2iso.c"
int main(int argc , char **argv ) 
{ 
  int seek_ecc ;
  int sector_size ;
  int bw ;
  int seek_header ;
  long i ;
  long source_length ;
  char buf[2448] ;
  char destfilename[2354] ;
  FILE *fdest ;
  FILE *fsource ;
  char SYNC_HEADER[12] ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  long tmp___7 ;

  {
#line 27
  bw = 1;
#line 32
  SYNC_HEADER[0] = (char)0;
#line 32
  SYNC_HEADER[1] = (char)-1;
#line 32
  SYNC_HEADER[2] = (char)-1;
#line 32
  SYNC_HEADER[3] = (char)-1;
#line 32
  SYNC_HEADER[4] = (char)-1;
#line 32
  SYNC_HEADER[5] = (char)-1;
#line 32
  SYNC_HEADER[6] = (char)-1;
#line 32
  SYNC_HEADER[7] = (char)-1;
#line 32
  SYNC_HEADER[8] = (char)-1;
#line 32
  SYNC_HEADER[9] = (char)-1;
#line 32
  SYNC_HEADER[10] = (char)-1;
#line 32
  SYNC_HEADER[11] = (char)0;
#line 34
  if (argc < 2) {
    {
#line 37
    printf((char const   */* __restrict  */)"Error: bad syntax\n\nUsage is: cdi2iso image.cdi [image.iso]\n");
#line 38
    exit(1);
    }
  }
#line 41
  if (argc >= 3) {
    {
#line 43
    strcpy((char */* __restrict  */)(destfilename), (char const   */* __restrict  */)*(argv + 2));
    }
  } else {
    {
#line 47
    strcpy((char */* __restrict  */)(destfilename), (char const   */* __restrict  */)*(argv + 1));
#line 48
    tmp___1 = strlen((char const   *)*(argv + 1));
    }
#line 48
    if (tmp___1 < 5UL) {
      {
#line 49
      tmp = strlen((char const   *)*(argv + 1));
#line 49
      strcpy((char */* __restrict  */)(destfilename + tmp), (char const   */* __restrict  */)".iso");
      }
    } else {
      {
#line 48
      tmp___2 = strlen((char const   *)*(argv + 1));
#line 48
      tmp___3 = strcmp((char const   *)((destfilename + tmp___2) - 4), ".cdi");
      }
#line 48
      if (tmp___3) {
        {
#line 49
        tmp = strlen((char const   *)*(argv + 1));
#line 49
        strcpy((char */* __restrict  */)(destfilename + tmp), (char const   */* __restrict  */)".iso");
        }
      } else {
        {
#line 51
        tmp___0 = strlen((char const   *)*(argv + 1));
#line 51
        strcpy((char */* __restrict  */)((destfilename + tmp___0) - 4), (char const   */* __restrict  */)".iso");
        }
      }
    }
  }
  {
#line 54
  fsource = fopen((char const   */* __restrict  */)*(argv + 1), (char const   */* __restrict  */)"rb");
#line 55
  fdest = fopen((char const   */* __restrict  */)(destfilename), (char const   */* __restrict  */)"wb");
#line 57
  fread((void */* __restrict  */)(buf), sizeof(char ), (size_t )16, (FILE */* __restrict  */)fsource);
#line 59
  tmp___6 = memcmp((void const   *)(SYNC_HEADER), (void const   *)(buf), (size_t )12);
  }
#line 59
  if (tmp___6) {
#line 104
    seek_header = 0;
#line 105
    sector_size = 2048;
#line 106
    seek_ecc = 0;
  } else {
    {
#line 62
    seek_header = 16;
#line 64
    fseek(fsource, 0L, 2);
#line 65
    fseek(fsource, 2352L, 0);
#line 66
    fread((void */* __restrict  */)(buf), sizeof(char ), (size_t )16, (FILE */* __restrict  */)fsource);
#line 68
    tmp___5 = memcmp((void const   *)(SYNC_HEADER), (void const   *)(buf), (size_t )12);
    }
#line 68
    if (tmp___5) {
      {
#line 78
      fseek(fsource, 0L, 2);
#line 79
      fseek(fsource, 2368L, 0);
#line 80
      fread((void */* __restrict  */)(buf), sizeof(char ), (size_t )16, (FILE */* __restrict  */)fsource);
#line 82
      tmp___4 = memcmp((void const   *)(SYNC_HEADER), (void const   *)(buf), (size_t )12);
      }
#line 82
      if (tmp___4) {
#line 94
        seek_ecc = 384;
#line 95
        sector_size = 2448;
      } else {
#line 86
        seek_ecc = 304;
#line 87
        sector_size = 2368;
      }
    } else {
#line 72
      sector_size = 2352;
#line 73
      seek_ecc = 288;
    }
  }
  {
#line 109
  fseek(fsource, 0L, 2);
#line 110
  tmp___7 = ftell(fsource);
#line 110
  source_length = tmp___7 / (long )sector_size;
#line 111
  fseek(fsource, 0L, 0);
#line 113
  i = 0L;
  }
  {
#line 113
  while (1) {
    while_continue: /* CIL Label */ ;
#line 113
    if (! (i < source_length)) {
#line 113
      goto while_break;
    }
    {
#line 115
    fseek(fsource, (long )seek_header, 1);
#line 116
    fread((void */* __restrict  */)(buf), sizeof(char ), (size_t )2048, (FILE */* __restrict  */)fsource);
    }
#line 117
    if (bw > 150) {
#line 119
      if (source_length != i) {
        {
#line 119
        fwrite((void const   */* __restrict  */)(buf), sizeof(char ), (size_t )2048,
               (FILE */* __restrict  */)fdest);
        }
      } else {
        {
#line 121
        fwrite((void const   */* __restrict  */)(buf), sizeof(char ), (size_t )1559,
               (FILE */* __restrict  */)fdest);
        }
      }
    }
    {
#line 123
    fseek(fsource, (long )seek_ecc, 1);
#line 124
    bw ++;
#line 113
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 127
  fclose(fdest);
#line 128
  fclose(fsource);
#line 130
  exit(0);
  }
}
}
