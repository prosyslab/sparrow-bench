/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 30 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.h"
struct s_Params {
   char *szInputFile ;
   char *szOutFileStub ;
   double dRes ;
   int bScale ;
   int bIdent ;
   int bAverageLink ;
   int bWeight ;
};
#line 30 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.h"
typedef struct s_Params t_Params;
#line 47 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.h"
struct s_Node {
   int left ;
   int right ;
   double distance ;
};
#line 47 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.h"
typedef struct s_Node t_Node;
#line 30 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
struct t_Min {
   float minDist ;
   int indexOfMinNode ;
   int reCalc ;
};
#line 1 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
struct s_Params___0 {
   char *szMapFile ;
   char *szInputFile ;
   int nMin ;
   int bTrim ;
};
#line 1 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
typedef struct s_Params___0 t_Params___0;
#line 12 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
struct s_Data {
   char **aacSequences ;
   char **aszID ;
   int nSeq ;
   int nMaxLen ;
   int *anLen ;
};
#line 12 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
typedef struct s_Data t_Data;
#line 25 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
struct s_Map {
   int nSeq ;
   int **aanMap ;
   int *anN ;
   int *anSize ;
};
#line 25 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
typedef struct s_Map t_Map;
#line 169 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 170
extern struct _IO_FILE *stderr ;
#line 237
extern int fclose(FILE *__stream ) ;
#line 242
extern int fflush(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 364
extern  __attribute__((__nothrow__)) int sprintf(char * __restrict  __s , char const   * __restrict  __format 
                                                 , ...) ;
#line 622
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
#line 689
extern int fputs(char const   * __restrict  __s , FILE * __restrict  __stream ) ;
#line 164 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) double ( __attribute__((__nonnull__(1), __leaf__)) strtod)(char const   * __restrict  __nptr ,
                                                                                                char ** __restrict  __endptr ) ;
#line 183
extern  __attribute__((__nothrow__)) long ( __attribute__((__nonnull__(1), __leaf__)) strtol)(char const   * __restrict  __nptr ,
                                                                                              char ** __restrict  __endptr ,
                                                                                              int __base ) ;
#line 466
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 480
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__,
__leaf__)) realloc)(void *__ptr , size_t __size ) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 129 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 144
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strcmp)(char const   *__s1 ,
                                                                                               char const   *__s2 )  __attribute__((__pure__)) ;
#line 315
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strpbrk)(char const   *__s ,
                                                                                                  char const   *__accept )  __attribute__((__pure__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 184 "/usr/include/x86_64-linux-gnu/bits/mathcalls.h"
extern  __attribute__((__nothrow__)) double ( __attribute__((__leaf__)) floor)(double __x )  __attribute__((__const__)) ;
#line 64 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.h"
t_Node *AvCluster(int nE , float **aafDistMatrix ) ;
#line 66
t_Node *MaxCluster(int nE , float **aafDistMatrix ) ;
#line 68
t_Node *AvClusterW(int nE , float **aafDistMatrix , float *afW ) ;
#line 70
void getCommandLineParams(t_Params *ptParams , int argc , char **argv ) ;
#line 72
void readDistanceMatrix(char ***paszID , char *szDistFile , float ***paafDist , int *pnN ,
                        t_Params *ptParams , float **pafW ) ;
#line 74
int outputCluster(t_Params *ptParams , t_Node *tree , char **aszID , int nN ) ;
#line 76
void scaleDistances(float **aafDist , int nN ) ;
#line 78
double writeNodesPhylip(FILE *ofp , t_Node *tree , char **aszID , int nNode ) ;
#line 15 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
static char *usage[9]  = 
#line 15 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
  {      (char *)"FCluster\n",      (char *)"-in    string            distance input file name\n",      (char *)"-out   string            output file stub\n",      (char *)"Options:\n", 
        (char *)"-r                       resolution\n",      (char *)"-a                       average linkage\n",      (char *)"-w                       use weights\n",      (char *)"-i                       read identifiers\n", 
        (char *)"-s                       scale dist.\n"};
#line 25 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
static int nLines  =    9;
#line 37 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
int main(int argc , char **argv ) 
{ 
  float **aafDist ;
  int i ;
  int nN ;
  t_Node *atTree ;
  char **aszID ;
  float *afW ;
  t_Params tParams ;
  char *szTreeFile ;
  void *tmp ;
  FILE *ofp ;

  {
  {
#line 39
  aafDist = (float **)((void *)0);
#line 40
  i = 0;
#line 40
  nN = 0;
#line 41
  atTree = (t_Node *)((void *)0);
#line 42
  aszID = (char **)((void *)0);
#line 43
  afW = (float *)((void *)0);
#line 45
  tmp = malloc(256UL * sizeof(char ));
#line 45
  szTreeFile = (char *)tmp;
#line 46
  ofp = (FILE *)((void *)0);
#line 48
  getCommandLineParams(& tParams, argc, argv);
#line 50
  readDistanceMatrix(& aszID, tParams.szInputFile, & aafDist, & nN, & tParams, & afW);
  }
#line 52
  if (tParams.bScale) {
    {
#line 53
    scaleDistances(aafDist, nN);
    }
  } else {
    {
#line 56
    printf((char const   */* __restrict  */)"Not scaling dist\n");
    }
  }
  {
#line 58
  printf((char const   */* __restrict  */)"Read data n = %d\n", nN);
#line 58
  fflush(stdout);
  }
#line 60
  if (tParams.bAverageLink == 0) {
    {
#line 61
    atTree = MaxCluster(nN, aafDist);
    }
  } else
#line 64
  if (tParams.bWeight) {
    {
#line 65
    atTree = AvClusterW(nN, aafDist, afW);
    }
  } else {
    {
#line 68
    atTree = AvCluster(nN, aafDist);
    }
  }
  {
#line 71
  sprintf((char */* __restrict  */)szTreeFile, (char const   */* __restrict  */)"%s%s",
          tParams.szOutFileStub, ".tree");
#line 73
  ofp = fopen((char const   */* __restrict  */)szTreeFile, (char const   */* __restrict  */)"w");
  }
#line 75
  if (ofp) {
    {
#line 76
    writeNodesPhylip(ofp, atTree, aszID, nN - 2);
#line 77
    fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)";\n");
#line 78
    fclose(ofp);
    }
  } else {
    {
#line 81
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed to open %s for writing\n",
            szTreeFile);
#line 82
    fflush(stderr);
    }
  }
  {
#line 86
  outputCluster(& tParams, atTree, aszID, nN);
#line 89
  free((void *)atTree);
#line 90
  i = 0;
  }
  {
#line 90
  while (1) {
    while_continue: /* CIL Label */ ;
#line 90
    if (! (i < nN)) {
#line 90
      goto while_break;
    }
#line 91
    if (i > 0) {
      {
#line 92
      free((void *)*(aafDist + i));
      }
    }
    {
#line 94
    free((void *)*(aszID + i));
#line 90
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 96
  free((void *)aafDist);
#line 97
  free((void *)afW);
#line 98
  free((void *)aszID);
#line 99
  free((void *)szTreeFile);
#line 101
  exit(0);
  }
}
}
#line 104 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void writeUsage(FILE *ofp ) 
{ 
  int i ;
  char *line ;

  {
#line 106
  i = 0;
#line 109
  i = 0;
  {
#line 109
  while (1) {
    while_continue: /* CIL Label */ ;
#line 109
    if (! (i < nLines)) {
#line 109
      goto while_break;
    }
    {
#line 110
    line = usage[i];
#line 111
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)ofp);
#line 109
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 113
  return;
}
}
#line 115 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
char *extractParameter(int argc , char **argv , char *param , int when ) 
{ 
  int i ;
  int tmp ;

  {
#line 117
  i = 0;
  {
#line 119
  while (1) {
    while_continue: /* CIL Label */ ;
#line 119
    if (i < argc) {
      {
#line 119
      tmp = strcmp((char const   *)param, (char const   *)*(argv + i));
      }
#line 119
      if (! tmp) {
#line 119
        goto while_break;
      }
    } else {
#line 119
      goto while_break;
    }
#line 120
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 123
  if (i < argc - 1) {
#line 124
    return (*(argv + (i + 1)));
  }
#line 127
  if (i == argc - 1) {
#line 127
    if (when == 0) {
#line 128
      return ((char *)"");
    }
  }
#line 131
  if (when == 1) {
    {
#line 132
    fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Can\'t find asked option %s\n",
            param);
    }
  }
#line 135
  return ((char *)((void *)0));
}
}
#line 138 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void getCommandLineParams(t_Params *ptParams , int argc , char **argv ) 
{ 
  char *szTemp ;
  char *pcError ;
  char *tmp ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;

  {
  {
#line 140
  szTemp = (char *)((void *)0);
#line 141
  pcError = (char *)((void *)0);
#line 144
  ptParams->szInputFile = extractParameter(argc, argv, (char *)"-in", 1);
  }
#line 145
  if ((unsigned long )ptParams->szInputFile == (unsigned long )((void *)0)) {
#line 146
    goto error;
  }
  {
#line 149
  ptParams->szOutFileStub = extractParameter(argc, argv, (char *)"-out", 1);
  }
#line 150
  if ((unsigned long )ptParams->szOutFileStub == (unsigned long )((void *)0)) {
#line 151
    goto error;
  }
  {
#line 153
  tmp = extractParameter(argc, argv, (char *)"-s", 0);
  }
#line 153
  if (tmp) {
#line 154
    ptParams->bScale = 1;
  } else {
#line 157
    ptParams->bScale = 0;
  }
  {
#line 160
  tmp___0 = extractParameter(argc, argv, (char *)"-i", 0);
  }
#line 160
  if (tmp___0) {
#line 161
    ptParams->bIdent = 1;
  } else {
#line 164
    ptParams->bIdent = 0;
  }
  {
#line 167
  tmp___1 = extractParameter(argc, argv, (char *)"-w", 0);
  }
#line 167
  if (tmp___1) {
#line 168
    ptParams->bWeight = 1;
  } else {
#line 171
    ptParams->bWeight = 0;
  }
  {
#line 174
  tmp___2 = extractParameter(argc, argv, (char *)"-a", 0);
  }
#line 174
  if (tmp___2) {
#line 175
    ptParams->bAverageLink = 1;
  } else {
#line 178
    ptParams->bAverageLink = 0;
  }
  {
#line 181
  szTemp = extractParameter(argc, argv, (char *)"-r", 0);
  }
#line 182
  if ((unsigned long )szTemp != (unsigned long )((void *)0)) {
    {
#line 183
    ptParams->dRes = strtod((char const   */* __restrict  */)szTemp, (char **/* __restrict  */)(& pcError));
    }
#line 184
    if ((int )*pcError != 0) {
#line 185
      goto error;
    }
  } else {
#line 189
    ptParams->dRes = 0.01;
  }
#line 192
  return;
  error: 
  {
#line 195
  writeUsage(stdout);
#line 196
  exit(1);
  }
}
}
#line 200 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void UpdateMinCacheWithNewValue(struct t_Min *asMin , int i , int j , float **aafDistMatrix ) 
{ 


  {
#line 202
  if (*(*(aafDistMatrix + i) + j) < (asMin + i)->minDist) {
#line 204
    (asMin + i)->minDist = *(*(aafDistMatrix + i) + j);
#line 205
    (asMin + i)->indexOfMinNode = j;
  }
#line 207
  if (*(*(aafDistMatrix + i) + j) == (asMin + i)->minDist) {
#line 207
    if (j < (asMin + i)->indexOfMinNode) {
#line 211
      (asMin + i)->indexOfMinNode = j;
    } else {
#line 207
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 213
  if (j == (asMin + i)->indexOfMinNode) {
#line 218
    (asMin + i)->reCalc = 1;
  }
#line 220
  return;
}
}
#line 230
int UpdateMinCacheForRow(struct t_Min *asMin , int i , float **aafDistMatrix ) ;
#line 223 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
int UpdateMinCacheForMarkedRows(struct t_Min *asMin , float **aafDistMatrix , int nN ) 
{ 
  int i ;

  {
#line 226
  i = 1;
  {
#line 226
  while (1) {
    while_continue: /* CIL Label */ ;
#line 226
    if (! (i < nN)) {
#line 226
      goto while_break;
    }
#line 228
    if ((asMin + i)->reCalc == 1) {
      {
#line 230
      UpdateMinCacheForRow(asMin, i, aafDistMatrix);
      }
    }
#line 232
    (asMin + i)->reCalc = 0;
#line 226
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 234
  return (0);
}
}
#line 237 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
int UpdateMinCacheForRow(struct t_Min *asMin , int i , float **aafDistMatrix ) 
{ 
  float fdist ;
  float ftemp ;
  int nj ;
  int jj ;

  {
#line 240
  fdist = *(*(aafDistMatrix + i) + 0);
#line 242
  nj = 0;
#line 244
  jj = 1;
  {
#line 244
  while (1) {
    while_continue: /* CIL Label */ ;
#line 244
    if (! (jj < i)) {
#line 244
      goto while_break;
    }
#line 246
    ftemp = *(*(aafDistMatrix + i) + jj);
#line 247
    if (ftemp < fdist) {
#line 249
      fdist = ftemp;
#line 250
      nj = jj;
    }
#line 244
    jj ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 253
  (asMin + i)->minDist = fdist;
#line 254
  (asMin + i)->indexOfMinNode = nj;
#line 255
  return (0);
}
}
#line 258 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void InitMinCacheData(int nN , struct t_Min *asMin , float **aafDistMatrix ) 
{ 
  int i ;
  int j ;
  int nj ;
  float fTemp ;
  float fDist ;

  {
#line 263
  i = 1;
  {
#line 263
  while (1) {
    while_continue: /* CIL Label */ ;
#line 263
    if (! (i < nN)) {
#line 263
      goto while_break;
    }
#line 264
    fDist = *(*(aafDistMatrix + i) + 0);
#line 265
    nj = 0;
#line 266
    j = 0;
    {
#line 266
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 266
      if (! (j < i)) {
#line 266
        goto while_break___0;
      }
#line 267
      fTemp = *(*(aafDistMatrix + i) + j);
#line 269
      if (fTemp < fDist) {
#line 270
        fDist = fTemp;
#line 271
        nj = j;
      }
#line 266
      j ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 274
    (asMin + i)->minDist = fDist;
#line 275
    (asMin + i)->indexOfMinNode = nj;
#line 276
    (asMin + i)->reCalc = 0;
#line 263
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 278
  return;
}
}
#line 282 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
float getClosest(int nN , struct t_Min *asMin , int *nI , int *nJ ) 
{ 
  int i ;
  float fTemp ;
  float fDist ;

  {
#line 288
  fDist = (asMin + 1)->minDist;
#line 289
  *nI = 1;
#line 290
  *nJ = (asMin + 1)->indexOfMinNode;
#line 293
  i = 1;
  {
#line 293
  while (1) {
    while_continue: /* CIL Label */ ;
#line 293
    if (! (i < nN)) {
#line 293
      goto while_break;
    }
#line 294
    fTemp = (asMin + i)->minDist;
#line 296
    if (fTemp < fDist) {
#line 297
      fDist = fTemp;
#line 298
      *nI = i;
#line 299
      *nJ = (asMin + i)->indexOfMinNode;
    }
#line 293
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 302
  return (fDist);
}
}
#line 305 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
char *revstr(char *szID , char cD ) 
{ 
  int nLen ;
  size_t tmp ;
  int i ;

  {
  {
#line 307
  tmp = strlen((char const   *)szID);
#line 307
  nLen = (int )tmp;
#line 308
  i = nLen - 1;
  }
  {
#line 310
  while (1) {
    while_continue: /* CIL Label */ ;
#line 310
    if (i >= 0) {
#line 310
      if (! ((int )*(szID + i) != (int )cD)) {
#line 310
        goto while_break;
      }
    } else {
#line 310
      goto while_break;
    }
#line 311
    i --;
  }
  while_break: /* CIL Label */ ;
  }
#line 314
  if (i < 0) {
#line 315
    return ((char *)((void *)0));
  } else {
#line 318
    return (szID + i);
  }
}
}
#line 322 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
double getWeight(char *szID ) 
{ 
  char *szBreak ;
  char *tmp ;
  double dWeight ;
  char *pcError ;

  {
  {
#line 324
  tmp = revstr(szID, (char )'_');
#line 324
  szBreak = tmp;
#line 325
  dWeight = 0.0;
#line 326
  pcError = (char *)((void *)0);
  }
#line 329
  if ((unsigned long )szBreak != (unsigned long )((void *)0)) {
    {
#line 330
    dWeight = strtod((char const   */* __restrict  */)(szBreak + 1), (char **/* __restrict  */)(& pcError));
    }
#line 331
    if ((int )*pcError != 0) {
      {
#line 332
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Sequence weight format error %s %s\n",
              szID, szBreak + 1);
#line 333
      fflush(stderr);
      }
    }
  } else {
#line 337
    dWeight = 1.0;
  }
#line 340
  return (dWeight);
}
}
#line 343 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void readDistanceMatrix(char ***paszID , char *szDistFile , float ***paafDist , int *pnN ,
                        t_Params *ptParams , float **pafW ) 
{ 
  FILE *ifp ;
  char szLine[256] ;
  char *szTok ;
  char *pcError ;
  char *szBrk ;
  float **aafDist ;
  int i ;
  int j ;
  int nN ;
  char **aszID ;
  float *afW ;
  long tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  double tmp___4 ;
  void *tmp___5 ;
  double tmp___6 ;

  {
  {
#line 345
  ifp = (FILE *)((void *)0);
#line 347
  szTok = (char *)((void *)0);
#line 347
  pcError = (char *)((void *)0);
#line 347
  szBrk = (char *)((void *)0);
#line 348
  aafDist = (float **)((void *)0);
#line 349
  i = 0;
#line 349
  j = 0;
#line 349
  nN = 0;
#line 351
  afW = (float *)((void *)0);
#line 353
  ifp = fopen((char const   */* __restrict  */)szDistFile, (char const   */* __restrict  */)"r");
  }
#line 355
  if (ifp) {
    {
#line 356
    fgets((char */* __restrict  */)(szLine), 256, (FILE */* __restrict  */)ifp);
#line 358
    szBrk = strpbrk((char const   *)(szLine), "\n");
#line 360
    *szBrk = (char )'\000';
#line 362
    tmp = strtol((char const   */* __restrict  */)(szLine), (char **/* __restrict  */)(& pcError),
                 10);
#line 362
    nN = (int )tmp;
    }
#line 363
    if ((int )*pcError != 0) {
#line 364
      goto fileFormatError;
    }
    {
#line 366
    tmp___0 = malloc((unsigned long )nN * sizeof(float ));
#line 366
    afW = (float *)tmp___0;
    }
#line 367
    if (! afW) {
#line 368
      goto memoryError;
    }
#line 370
    i = 0;
    {
#line 370
    while (1) {
      while_continue: /* CIL Label */ ;
#line 370
      if (! (i < nN)) {
#line 370
        goto while_break;
      }
#line 371
      *(afW + i) = (float )1.0;
#line 370
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 374
    tmp___1 = malloc((unsigned long )nN * sizeof(float *));
#line 374
    aafDist = (float **)tmp___1;
    }
#line 375
    if (! aafDist) {
#line 376
      goto memoryError;
    }
    {
#line 378
    tmp___2 = malloc((unsigned long )nN * sizeof(char *));
#line 378
    aszID = (char **)tmp___2;
    }
#line 379
    if (! aszID) {
#line 380
      goto memoryError;
    }
#line 382
    i = 0;
    {
#line 382
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 382
      if (! (i < nN)) {
#line 382
        goto while_break___0;
      }
      {
#line 383
      tmp___3 = malloc(256UL * sizeof(char ));
#line 383
      *(aszID + i) = (char *)tmp___3;
      }
#line 384
      if (! *(aszID + i)) {
#line 385
        goto memoryError;
      }
#line 382
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 388
    if (ptParams->bIdent == 1) {
#line 388
      goto _L;
    } else
#line 388
    if (ptParams->bWeight == 1) {
      _L: /* CIL Label */ 
#line 389
      i = 0;
      {
#line 389
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 389
        if (! (i < nN)) {
#line 389
          goto while_break___1;
        }
        {
#line 390
        fgets((char */* __restrict  */)(szLine), 256, (FILE */* __restrict  */)ifp);
#line 391
        szBrk = strpbrk((char const   *)(szLine), "\n");
#line 392
        *szBrk = (char )'\000';
#line 394
        strcpy((char */* __restrict  */)*(aszID + i), (char const   */* __restrict  */)(szLine));
#line 389
        i ++;
        }
      }
      while_break___1: /* CIL Label */ ;
      }
    } else {
#line 398
      i = 0;
      {
#line 398
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 398
        if (! (i < nN)) {
#line 398
          goto while_break___2;
        }
        {
#line 399
        sprintf((char */* __restrict  */)*(aszID + i), (char const   */* __restrict  */)"%d",
                i);
#line 398
        i ++;
        }
      }
      while_break___2: /* CIL Label */ ;
      }
    }
#line 403
    if (ptParams->bWeight == 1) {
#line 404
      i = 0;
      {
#line 404
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 404
        if (! (i < nN)) {
#line 404
          goto while_break___3;
        }
        {
#line 405
        tmp___4 = getWeight(*(aszID + i));
#line 405
        *(afW + i) = (float )tmp___4;
        }
#line 407
        if (ptParams->bIdent != 1) {
          {
#line 408
          sprintf((char */* __restrict  */)*(aszID + i), (char const   */* __restrict  */)"%d",
                  i);
          }
        }
#line 404
        i ++;
      }
      while_break___3: /* CIL Label */ ;
      }
    }
#line 413
    i = 1;
    {
#line 413
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 413
      if (! (i < nN)) {
#line 413
        goto while_break___4;
      }
      {
#line 415
      tmp___5 = malloc((unsigned long )i * sizeof(float ));
#line 415
      *(aafDist + i) = (float *)tmp___5;
      }
#line 416
      if (! *(aafDist + i)) {
#line 417
        goto memoryError;
      }
#line 419
      j = 0;
      {
#line 419
      while (1) {
        while_continue___5: /* CIL Label */ ;
#line 419
        if (! (j < i)) {
#line 419
          goto while_break___5;
        }
        {
#line 420
        fgets((char */* __restrict  */)(szLine), 256, (FILE */* __restrict  */)ifp);
#line 422
        szBrk = strpbrk((char const   *)(szLine), "\n");
#line 423
        *szBrk = (char )'\000';
#line 425
        tmp___6 = strtod((char const   */* __restrict  */)(szLine), (char **/* __restrict  */)(& pcError));
#line 425
        *(*(aafDist + i) + j) = (float )tmp___6;
        }
#line 427
        if ((int )*pcError != 0) {
#line 428
          goto fileFormatError;
        }
#line 419
        j ++;
      }
      while_break___5: /* CIL Label */ ;
      }
#line 413
      i ++;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
#line 432
    fclose(ifp);
    }
  } else {
    {
#line 435
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed to open file %s in readDistanceMatrix",
            szDistFile);
#line 436
    fflush(stderr);
#line 437
    exit(1);
    }
  }
#line 440
  *pafW = afW;
#line 441
  *pnN = nN;
#line 442
  *paafDist = aafDist;
#line 443
  *paszID = aszID;
#line 444
  return;
  memoryError: 
  {
#line 447
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed allocating memory in readDistanceMatrix");
#line 448
  fflush(stderr);
#line 449
  exit(1);
  }
  fileFormatError: 
  {
#line 452
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Incorrectly formatted input file in readDistanceMatrix");
#line 453
  fflush(stderr);
#line 454
  exit(1);
  }
}
}
#line 457 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
t_Node *MaxCluster(int nE , float **aafDistMatrix ) 
{ 
  int j ;
  int n ;
  int *anCI ;
  t_Node *atResult ;
  struct t_Min *asMin ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  int is ;
  int js ;
  float tmp___2 ;

  {
  {
#line 465
  tmp = malloc((unsigned long )nE * sizeof(int ));
#line 465
  anCI = (int *)tmp;
  }
#line 466
  if (! anCI) {
#line 466
    return ((t_Node *)((void *)0));
  }
  {
#line 467
  tmp___0 = malloc((unsigned long )(nE - 1) * sizeof(t_Node ));
#line 467
  atResult = (t_Node *)tmp___0;
  }
#line 468
  if (! atResult) {
    {
#line 469
    free((void *)anCI);
    }
#line 470
    return ((t_Node *)((void *)0));
  }
  {
#line 474
  tmp___1 = malloc((unsigned long )nE * sizeof(struct t_Min ));
#line 474
  asMin = (struct t_Min *)tmp___1;
  }
#line 475
  if (! asMin) {
    {
#line 477
    free((void *)anCI);
#line 478
    free((void *)atResult);
    }
#line 479
    return ((t_Node *)((void *)0));
  }
#line 483
  j = 0;
  {
#line 483
  while (1) {
    while_continue: /* CIL Label */ ;
#line 483
    if (! (j < nE)) {
#line 483
      goto while_break;
    }
#line 483
    *(anCI + j) = j;
#line 483
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 485
  InitMinCacheData(nE, asMin, aafDistMatrix);
#line 487
  n = nE;
  }
  {
#line 487
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 487
    if (! (n > 1)) {
#line 487
      goto while_break___0;
    }
    {
#line 489
    is = 1;
#line 490
    js = 0;
#line 492
    tmp___2 = getClosest(n, asMin, & is, & js);
#line 492
    (atResult + (nE - n))->distance = (double )tmp___2;
#line 494
    j = 0;
    }
    {
#line 494
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 494
      if (! (j < js)) {
#line 494
        goto while_break___1;
      }
#line 496
      if (*(*(aafDistMatrix + is) + j) > *(*(aafDistMatrix + js) + j)) {
#line 496
        *(*(aafDistMatrix + js) + j) = *(*(aafDistMatrix + is) + j);
      } else {
#line 496
        *(*(aafDistMatrix + js) + j) = *(*(aafDistMatrix + js) + j);
      }
      {
#line 497
      UpdateMinCacheWithNewValue(asMin, js, j, aafDistMatrix);
#line 494
      j ++;
      }
    }
    while_break___1: /* CIL Label */ ;
    }
#line 499
    j = js + 1;
    {
#line 499
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 499
      if (! (j < is)) {
#line 499
        goto while_break___2;
      }
#line 501
      if (*(*(aafDistMatrix + is) + j) > *(*(aafDistMatrix + j) + js)) {
#line 501
        *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + is) + j);
      } else {
#line 501
        *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + j) + js);
      }
      {
#line 502
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 499
      j ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
#line 504
    j = is + 1;
    {
#line 504
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 504
      if (! (j < n)) {
#line 504
        goto while_break___3;
      }
#line 506
      if (*(*(aafDistMatrix + j) + is) > *(*(aafDistMatrix + j) + js)) {
#line 506
        *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + j) + is);
      } else {
#line 506
        *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + j) + js);
      }
      {
#line 507
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 504
      j ++;
      }
    }
    while_break___3: /* CIL Label */ ;
    }
#line 509
    j = 0;
    {
#line 509
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 509
      if (! (j < is)) {
#line 509
        goto while_break___4;
      }
      {
#line 511
      *(*(aafDistMatrix + is) + j) = *(*(aafDistMatrix + (n - 1)) + j);
#line 512
      UpdateMinCacheWithNewValue(asMin, is, j, aafDistMatrix);
#line 509
      j ++;
      }
    }
    while_break___4: /* CIL Label */ ;
    }
#line 514
    j = is + 1;
    {
#line 514
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 514
      if (! (j < n - 1)) {
#line 514
        goto while_break___5;
      }
      {
#line 516
      *(*(aafDistMatrix + j) + is) = *(*(aafDistMatrix + (n - 1)) + j);
#line 517
      UpdateMinCacheWithNewValue(asMin, j, is, aafDistMatrix);
#line 514
      j ++;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
    {
#line 520
    UpdateMinCacheForMarkedRows(asMin, aafDistMatrix, n);
#line 522
    (atResult + (nE - n))->left = *(anCI + is);
#line 523
    (atResult + (nE - n))->right = *(anCI + js);
#line 524
    *(anCI + js) = (n - nE) - 1;
#line 525
    *(anCI + is) = *(anCI + (n - 1));
    }
#line 526
    if (n % 100 == 0) {
      {
#line 527
      printf((char const   */* __restrict  */)"%d ", n);
#line 528
      fflush(stdout);
      }
    }
#line 487
    n --;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 531
  free((void *)anCI);
#line 532
  free((void *)asMin);
#line 533
  printf((char const   */* __restrict  */)"\n");
#line 533
  fflush(stdout);
  }
#line 534
  return (atResult);
}
}
#line 537 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
t_Node *AvCluster(int nE , float **aafDistMatrix ) 
{ 
  int j ;
  int n ;
  int *anCI ;
  int *anNumber ;
  t_Node *atResult ;
  struct t_Min *asMin ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  int nSum ;
  int is ;
  int js ;
  float tmp___3 ;

  {
  {
#line 546
  tmp = malloc((unsigned long )nE * sizeof(int ));
#line 546
  anCI = (int *)tmp;
  }
#line 547
  if (! anCI) {
#line 547
    return ((t_Node *)((void *)0));
  }
  {
#line 548
  tmp___0 = malloc((unsigned long )nE * sizeof(int ));
#line 548
  anNumber = (int *)tmp___0;
  }
#line 549
  if (! anNumber) {
    {
#line 551
    free((void *)anCI);
    }
#line 552
    return ((t_Node *)((void *)0));
  }
  {
#line 554
  tmp___1 = malloc((unsigned long )(nE - 1) * sizeof(t_Node ));
#line 554
  atResult = (t_Node *)tmp___1;
  }
#line 555
  if (! atResult) {
    {
#line 557
    free((void *)anCI);
#line 558
    free((void *)anNumber);
    }
#line 559
    return ((t_Node *)((void *)0));
  }
  {
#line 562
  tmp___2 = malloc((unsigned long )nE * sizeof(struct t_Min ));
#line 562
  asMin = (struct t_Min *)tmp___2;
  }
#line 563
  if (! asMin) {
    {
#line 565
    free((void *)anCI);
#line 566
    free((void *)anNumber);
#line 567
    free((void *)atResult);
    }
#line 568
    return ((t_Node *)((void *)0));
  }
#line 571
  j = 0;
  {
#line 571
  while (1) {
    while_continue: /* CIL Label */ ;
#line 571
    if (! (j < nE)) {
#line 571
      goto while_break;
    }
#line 573
    *(anNumber + j) = 1;
#line 574
    *(anCI + j) = j;
#line 571
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 578
  InitMinCacheData(nE, asMin, aafDistMatrix);
#line 580
  n = nE;
  }
  {
#line 580
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 580
    if (! (n > 1)) {
#line 580
      goto while_break___0;
    }
    {
#line 583
    is = 1;
#line 584
    js = 0;
#line 586
    tmp___3 = getClosest(n, asMin, & is, & js);
#line 586
    (atResult + (nE - n))->distance = (double )tmp___3;
#line 588
    (atResult + (nE - n))->left = *(anCI + is);
#line 589
    (atResult + (nE - n))->right = *(anCI + js);
#line 591
    nSum = *(anNumber + is) + *(anNumber + js);
#line 593
    j = 0;
    }
    {
#line 593
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 593
      if (! (j < js)) {
#line 593
        goto while_break___1;
      }
      {
#line 595
      *(*(aafDistMatrix + js) + j) = *(*(aafDistMatrix + is) + j) * (float )*(anNumber + is) + *(*(aafDistMatrix + js) + j) * (float )*(anNumber + js);
#line 597
      *(*(aafDistMatrix + js) + j) /= (float )nSum;
#line 598
      UpdateMinCacheWithNewValue(asMin, js, j, aafDistMatrix);
#line 593
      j ++;
      }
    }
    while_break___1: /* CIL Label */ ;
    }
#line 600
    j = js + 1;
    {
#line 600
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 600
      if (! (j < is)) {
#line 600
        goto while_break___2;
      }
      {
#line 602
      *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + is) + j) * (float )*(anNumber + is) + *(*(aafDistMatrix + j) + js) * (float )*(anNumber + js);
#line 604
      *(*(aafDistMatrix + j) + js) /= (float )nSum;
#line 605
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 600
      j ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
#line 607
    j = is + 1;
    {
#line 607
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 607
      if (! (j < n)) {
#line 607
        goto while_break___3;
      }
      {
#line 609
      *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + j) + is) * (float )*(anNumber + is) + *(*(aafDistMatrix + j) + js) * (float )*(anNumber + js);
#line 611
      *(*(aafDistMatrix + j) + js) /= (float )nSum;
#line 612
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 607
      j ++;
      }
    }
    while_break___3: /* CIL Label */ ;
    }
#line 614
    j = 0;
    {
#line 614
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 614
      if (! (j < is)) {
#line 614
        goto while_break___4;
      }
      {
#line 616
      *(*(aafDistMatrix + is) + j) = *(*(aafDistMatrix + (n - 1)) + j);
#line 617
      UpdateMinCacheWithNewValue(asMin, is, j, aafDistMatrix);
#line 614
      j ++;
      }
    }
    while_break___4: /* CIL Label */ ;
    }
#line 619
    j = is + 1;
    {
#line 619
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 619
      if (! (j < n - 1)) {
#line 619
        goto while_break___5;
      }
      {
#line 621
      *(*(aafDistMatrix + j) + is) = *(*(aafDistMatrix + (n - 1)) + j);
#line 622
      UpdateMinCacheWithNewValue(asMin, j, is, aafDistMatrix);
#line 619
      j ++;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
    {
#line 625
    UpdateMinCacheForMarkedRows(asMin, aafDistMatrix, n);
#line 627
    *(anNumber + js) = nSum;
#line 628
    *(anNumber + is) = *(anNumber + (n - 1));
#line 630
    *(anCI + js) = (n - nE) - 1;
#line 631
    *(anCI + is) = *(anCI + (n - 1));
#line 580
    n --;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 634
  free((void *)anCI);
#line 635
  free((void *)anNumber);
#line 636
  free((void *)asMin);
  }
#line 638
  return (atResult);
}
}
#line 641 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
t_Node *AvClusterW(int nE , float **aafDistMatrix , float *afW ) 
{ 
  int j ;
  int n ;
  int *anCI ;
  float *afNumber ;
  t_Node *atResult ;
  struct t_Min *asMin ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  float fSum ;
  int is ;
  int js ;
  float tmp___3 ;

  {
  {
#line 652
  tmp = malloc((unsigned long )nE * sizeof(int ));
#line 652
  anCI = (int *)tmp;
  }
#line 654
  if (! anCI) {
#line 654
    return ((t_Node *)((void *)0));
  }
  {
#line 656
  tmp___0 = malloc((unsigned long )nE * sizeof(float ));
#line 656
  afNumber = (float *)tmp___0;
  }
#line 658
  if (! afNumber) {
    {
#line 660
    free((void *)anCI);
    }
#line 661
    return ((t_Node *)((void *)0));
  }
  {
#line 664
  tmp___1 = malloc((unsigned long )(nE - 1) * sizeof(t_Node ));
#line 664
  atResult = (t_Node *)tmp___1;
  }
#line 666
  if (! atResult) {
    {
#line 668
    free((void *)anCI);
#line 669
    free((void *)afNumber);
    }
#line 670
    return ((t_Node *)((void *)0));
  }
  {
#line 674
  tmp___2 = malloc((unsigned long )nE * sizeof(struct t_Min ));
#line 674
  asMin = (struct t_Min *)tmp___2;
  }
#line 675
  if (! asMin) {
    {
#line 677
    free((void *)anCI);
#line 678
    free((void *)afNumber);
#line 679
    free((void *)atResult);
    }
#line 680
    return ((t_Node *)((void *)0));
  }
#line 683
  j = 0;
  {
#line 683
  while (1) {
    while_continue: /* CIL Label */ ;
#line 683
    if (! (j < nE)) {
#line 683
      goto while_break;
    }
#line 684
    *(afNumber + j) = *(afW + j);
#line 685
    *(anCI + j) = j;
#line 683
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 689
  InitMinCacheData(nE, asMin, aafDistMatrix);
#line 691
  n = nE;
  }
  {
#line 691
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 691
    if (! (n > 1)) {
#line 691
      goto while_break___0;
    }
    {
#line 694
    is = 1;
#line 695
    js = 0;
#line 697
    is = 1;
#line 698
    js = 0;
#line 699
    tmp___3 = getClosest(n, asMin, & is, & js);
#line 699
    (atResult + (nE - n))->distance = (double )tmp___3;
#line 700
    (atResult + (nE - n))->left = *(anCI + is);
#line 701
    (atResult + (nE - n))->right = *(anCI + js);
#line 703
    fSum = *(afNumber + is) + *(afNumber + js);
#line 705
    j = 0;
    }
    {
#line 705
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 705
      if (! (j < js)) {
#line 705
        goto while_break___1;
      }
      {
#line 707
      *(*(aafDistMatrix + js) + j) = *(*(aafDistMatrix + is) + j) * *(afNumber + is) + *(*(aafDistMatrix + js) + j) * *(afNumber + js);
#line 709
      *(*(aafDistMatrix + js) + j) /= fSum;
#line 710
      UpdateMinCacheWithNewValue(asMin, js, j, aafDistMatrix);
#line 705
      j ++;
      }
    }
    while_break___1: /* CIL Label */ ;
    }
#line 712
    j = js + 1;
    {
#line 712
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 712
      if (! (j < is)) {
#line 712
        goto while_break___2;
      }
      {
#line 714
      *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + is) + j) * *(afNumber + is) + *(*(aafDistMatrix + j) + js) * *(afNumber + js);
#line 716
      *(*(aafDistMatrix + j) + js) /= fSum;
#line 717
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 712
      j ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
#line 719
    j = is + 1;
    {
#line 719
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 719
      if (! (j < n)) {
#line 719
        goto while_break___3;
      }
      {
#line 721
      *(*(aafDistMatrix + j) + js) = *(*(aafDistMatrix + j) + is) * *(afNumber + is) + *(*(aafDistMatrix + j) + js) * *(afNumber + js);
#line 723
      *(*(aafDistMatrix + j) + js) /= fSum;
#line 724
      UpdateMinCacheWithNewValue(asMin, j, js, aafDistMatrix);
#line 719
      j ++;
      }
    }
    while_break___3: /* CIL Label */ ;
    }
#line 726
    j = 0;
    {
#line 726
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 726
      if (! (j < is)) {
#line 726
        goto while_break___4;
      }
      {
#line 728
      *(*(aafDistMatrix + is) + j) = *(*(aafDistMatrix + (n - 1)) + j);
#line 729
      UpdateMinCacheWithNewValue(asMin, is, j, aafDistMatrix);
#line 726
      j ++;
      }
    }
    while_break___4: /* CIL Label */ ;
    }
#line 731
    j = is + 1;
    {
#line 731
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 731
      if (! (j < n - 1)) {
#line 731
        goto while_break___5;
      }
      {
#line 733
      *(*(aafDistMatrix + j) + is) = *(*(aafDistMatrix + (n - 1)) + j);
#line 734
      UpdateMinCacheWithNewValue(asMin, j, is, aafDistMatrix);
#line 731
      j ++;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
    {
#line 737
    UpdateMinCacheForMarkedRows(asMin, aafDistMatrix, n);
#line 739
    *(afNumber + js) = fSum;
#line 740
    *(afNumber + is) = *(afNumber + (n - 1));
#line 742
    *(anCI + js) = (n - nE) - 1;
#line 743
    *(anCI + is) = *(anCI + (n - 1));
#line 691
    n --;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 746
  free((void *)anCI);
#line 747
  free((void *)afNumber);
#line 748
  free((void *)asMin);
  }
#line 750
  return (atResult);
}
}
#line 753 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
int outputCluster(t_Params *ptParams , t_Node *tree , char **aszID , int nN ) 
{ 
  int i ;
  int j ;
  int k ;
  int l ;
  int nNodes ;
  double dRes ;
  int nIter ;
  char ***aaszClusters ;
  int *anCounts ;
  void *tmp ;
  int *anSizes ;
  void *tmp___0 ;
  int *anIndex ;
  void *tmp___1 ;
  char *szOtuFile ;
  void *tmp___2 ;
  char *szListFile ;
  void *tmp___3 ;
  FILE *ofp ;
  FILE *lfp ;
  void *tmp___4 ;
  void *tmp___5 ;
  double tmp___6 ;
  double dPrint ;
  int left ;
  int right ;
  int put ;
  int destroy ;
  void *tmp___7 ;
  int tmp___8 ;

  {
  {
#line 755
  i = 0;
#line 755
  j = 0;
#line 755
  k = 0;
#line 755
  l = 0;
#line 756
  nNodes = nN - 1;
#line 757
  dRes = ptParams->dRes;
#line 758
  nIter = 0;
#line 759
  aaszClusters = (char ***)((void *)0);
#line 760
  tmp = malloc(sizeof(int ) * (unsigned long )nN);
#line 760
  anCounts = (int *)tmp;
#line 761
  tmp___0 = malloc(sizeof(int ) * (unsigned long )nN);
#line 761
  anSizes = (int *)tmp___0;
#line 762
  tmp___1 = malloc(sizeof(int ) * (unsigned long )nNodes);
#line 762
  anIndex = (int *)tmp___1;
#line 763
  tmp___2 = malloc(256UL * sizeof(char ));
#line 763
  szOtuFile = (char *)tmp___2;
#line 764
  tmp___3 = malloc(256UL * sizeof(char ));
#line 764
  szListFile = (char *)tmp___3;
#line 765
  ofp = (FILE *)((void *)0);
#line 765
  lfp = (FILE *)((void *)0);
#line 767
  sprintf((char */* __restrict  */)szOtuFile, (char const   */* __restrict  */)"%s%s",
          ptParams->szOutFileStub, ".otu");
#line 768
  sprintf((char */* __restrict  */)szListFile, (char const   */* __restrict  */)"%s%s",
          ptParams->szOutFileStub, ".list");
#line 770
  tmp___4 = malloc((unsigned long )nN * sizeof(char **));
#line 770
  aaszClusters = (char ***)tmp___4;
#line 772
  i = 0;
  }
  {
#line 772
  while (1) {
    while_continue: /* CIL Label */ ;
#line 772
    if (! (i < nN)) {
#line 772
      goto while_break;
    }
    {
#line 773
    *(anCounts + i) = 1;
#line 774
    *(anSizes + i) = 1024;
#line 775
    tmp___5 = malloc((unsigned long )*(anSizes + i) * sizeof(char *));
#line 775
    *(aaszClusters + i) = (char **)tmp___5;
#line 776
    j = 0;
    }
    {
#line 776
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 776
      if (! (j < *(anSizes + i))) {
#line 776
        goto while_break___0;
      }
#line 777
      *(*(aaszClusters + i) + j) = (char *)((void *)0);
#line 776
      j ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 779
    *(*(aaszClusters + i) + 0) = *(aszID + i);
#line 772
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 782
  ofp = fopen((char const   */* __restrict  */)szOtuFile, (char const   */* __restrict  */)"w");
#line 783
  lfp = fopen((char const   */* __restrict  */)szListFile, (char const   */* __restrict  */)"w");
#line 785
  tmp___6 = floor((tree + (nNodes - 1))->distance / ptParams->dRes + 1.0e-7);
#line 785
  nIter = (int )tmp___6;
#line 787
  j = 0;
#line 788
  i = 0;
  }
  {
#line 788
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 788
    if (! (i < nIter)) {
#line 788
      goto while_break___1;
    }
#line 789
    dPrint = (double )i * dRes;
    {
#line 791
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 791
      if (j < nNodes) {
#line 791
        if (! ((tree + j)->distance < dPrint)) {
#line 791
          goto while_break___2;
        }
      } else {
#line 791
        goto while_break___2;
      }
#line 792
      left = (tree + j)->left;
#line 792
      right = (tree + j)->right;
#line 793
      put = -1;
#line 793
      destroy = -1;
#line 795
      if (left < 0) {
#line 796
        left = *(anIndex + (- left - 1));
      }
#line 799
      if (right < 0) {
#line 800
        right = *(anIndex + (- right - 1));
      }
#line 803
      put = right;
#line 803
      destroy = left;
#line 804
      if (left < right) {
#line 805
        put = left;
#line 806
        destroy = right;
      }
#line 809
      *(anIndex + j) = put;
#line 812
      k = 0;
      {
#line 812
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 812
        if (! (k < *(anCounts + destroy))) {
#line 812
          goto while_break___3;
        }
#line 813
        if (*(anCounts + put) == *(anSizes + put)) {
          {
#line 814
          *(anSizes + put) *= 2;
#line 815
          tmp___7 = realloc((void *)*(aaszClusters + put), (unsigned long )*(anSizes + put) * sizeof(char *));
#line 815
          *(aaszClusters + put) = (char **)tmp___7;
          }
        }
#line 817
        tmp___8 = *(anCounts + put);
#line 817
        (*(anCounts + put)) ++;
#line 817
        *(*(aaszClusters + put) + tmp___8) = *(*(aaszClusters + destroy) + k);
#line 812
        k ++;
      }
      while_break___3: /* CIL Label */ ;
      }
      {
#line 819
      *(anCounts + destroy) = 0;
#line 820
      free((void *)*(aaszClusters + destroy));
#line 822
      j ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    {
#line 825
    fprintf((FILE */* __restrict  */)lfp, (char const   */* __restrict  */)"%f %d ",
            dPrint, nN - j);
#line 826
    fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%f %d ",
            dPrint, nN - j);
#line 827
    dPrint += 0.01;
#line 829
    k = 0;
    }
    {
#line 829
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 829
      if (! (k < nN)) {
#line 829
        goto while_break___4;
      }
#line 830
      if (*(anCounts + k) > 0) {
#line 831
        l = 0;
        {
#line 831
        while (1) {
          while_continue___5: /* CIL Label */ ;
#line 831
          if (! (l < *(anCounts + k) - 1)) {
#line 831
            goto while_break___5;
          }
          {
#line 832
          fprintf((FILE */* __restrict  */)lfp, (char const   */* __restrict  */)"%s,",
                  *(*(aaszClusters + k) + l));
#line 831
          l ++;
          }
        }
        while_break___5: /* CIL Label */ ;
        }
        {
#line 835
        fprintf((FILE */* __restrict  */)lfp, (char const   */* __restrict  */)"%s ",
                *(*(aaszClusters + k) + (*(anCounts + k) - 1)));
#line 837
        fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%d ",
                *(anCounts + k));
        }
      }
#line 829
      k ++;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
#line 841
    fprintf((FILE */* __restrict  */)lfp, (char const   */* __restrict  */)"\n");
#line 841
    fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"\n");
#line 842
    fflush(lfp);
#line 842
    fflush(ofp);
#line 788
    i ++;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  {
#line 845
  fclose(lfp);
#line 846
  fclose(ofp);
#line 848
  i = 0;
  }
  {
#line 848
  while (1) {
    while_continue___6: /* CIL Label */ ;
#line 848
    if (! (i < nN)) {
#line 848
      goto while_break___6;
    }
#line 849
    if (*(anCounts + i) > 0) {
      {
#line 850
      free((void *)*(aaszClusters + i));
      }
    }
#line 848
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  {
#line 853
  free((void *)aaszClusters);
#line 855
  free((void *)anCounts);
#line 856
  free((void *)anSizes);
#line 857
  free((void *)anIndex);
#line 858
  free((void *)szOtuFile);
#line 859
  free((void *)szListFile);
  }
#line 860
  return (0);
}
}
#line 864 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
double writeNodesPhylip(FILE *ofp , t_Node *tree , char **aszID , int nNode ) 
{ 
  int nLeft ;
  int nRight ;
  double dist ;
  double lastdist ;

  {
  {
#line 866
  nLeft = (tree + nNode)->left;
#line 866
  nRight = (tree + nNode)->right;
#line 867
  dist = (tree + nNode)->distance;
#line 868
  lastdist = 0.0;
#line 869
  fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"(");
  }
#line 871
  if (nLeft >= 0) {
    {
#line 872
    fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%s", *(aszID + nLeft));
    }
  } else {
    {
#line 875
    lastdist = writeNodesPhylip(ofp, tree, aszID, - nLeft - 1);
    }
  }
  {
#line 878
  fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)":%.3f,",
          dist - lastdist);
#line 880
  lastdist = 0.0;
  }
#line 881
  if (nRight >= 0) {
    {
#line 882
    fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%s", *(aszID + nRight));
    }
  } else {
    {
#line 885
    lastdist = writeNodesPhylip(ofp, tree, aszID, - nRight - 1);
    }
  }
  {
#line 888
  fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)":%.3f)",
          dist - lastdist);
  }
#line 890
  return (dist);
}
}
#line 893 "/home/june/collector/temp/ampliconnoise-1.29/FCluster/FCluster.c"
void scaleDistances(float **aafDist , int nN ) 
{ 
  int i ;
  int j ;
  float fMin ;
  float fMax ;

  {
#line 895
  i = 0;
#line 895
  j = 0;
#line 896
  fMin = *(*(aafDist + 1) + 0);
#line 896
  fMax = *(*(aafDist + 1) + 0);
#line 898
  i = 2;
  {
#line 898
  while (1) {
    while_continue: /* CIL Label */ ;
#line 898
    if (! (i < nN)) {
#line 898
      goto while_break;
    }
#line 899
    j = 0;
    {
#line 899
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 899
      if (! (j < i)) {
#line 899
        goto while_break___0;
      }
#line 900
      if (*(*(aafDist + i) + j) < fMin) {
#line 901
        fMin = *(*(aafDist + i) + j);
      }
#line 904
      if (*(*(aafDist + i) + j) > fMax) {
#line 905
        fMax = *(*(aafDist + i) + j);
      }
#line 899
      j ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 898
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 910
  i = 1;
  {
#line 910
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 910
    if (! (i < nN)) {
#line 910
      goto while_break___1;
    }
#line 911
    j = 0;
    {
#line 911
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 911
      if (! (j < i)) {
#line 911
        goto while_break___2;
      }
#line 912
      *(*(aafDist + i) + j) = (*(*(aafDist + i) + j) - fMin) / (fMax - fMin);
#line 911
      j ++;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 910
    i ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 915
  return;
}
}
#line 573 "/usr/include/stdio.h"
extern int fputc(int __c , FILE *__stream ) ;
#line 176 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strdup)(char const   *__s )  __attribute__((__malloc__)) ;
#line 263
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strrchr)(char const   *__s ,
                                                                                                int __c )  __attribute__((__pure__)) ;
#line 342
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strstr)(char const   *__haystack ,
                                                                                                 char const   *__needle )  __attribute__((__pure__)) ;
#line 55 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.h"
void allocMap(t_Map *ptMap , int nSeq ) ;
#line 57
void addEntry(t_Map *ptMap , int nI , int nJ ) ;
#line 59
void writeMap(FILE *ofp , t_Data *ptData , t_Map *ptMap ) ;
#line 61
void destroyMap(t_Map *ptMap ) ;
#line 63
char *szCreateMapFileName(char *szFastaFile ) ;
#line 7 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
static char *usage___0[3]  = {      (char *)"FastaUnique - dereplicates fasta file\n",      (char *)"-in     string            input file name\n",      (char *)"Options:\n"};
#line 11 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
static int nLines___0  =    3;
#line 13 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
static char szSequence[35]  = 
#line 13
  {      (char )'a',      (char )'c',      (char )'g',      (char )'t', 
        (char )'u',      (char )'r',      (char )'y',      (char )'n', 
        (char )'d',      (char )'b',      (char )'w',      (char )'s', 
        (char )'m',      (char )'k',      (char )'h',      (char )'v', 
        (char )'A',      (char )'C',      (char )'G',      (char )'T', 
        (char )'U',      (char )'R',      (char )'Y',      (char )'N', 
        (char )'D',      (char )'B',      (char )'W',      (char )'S', 
        (char )'M',      (char )'K',      (char )'H',      (char )'V', 
        (char )'-',      (char )'.',      (char )'\000'};
#line 17 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void readData(t_Data *ptData , t_Params___0 *ptParams ) 
{ 
  FILE *ifp ;
  char szLine[1024] ;
  int nPos ;
  int i ;
  int j ;
  int nSequences ;
  char *szBrk ;
  char *szRet ;
  char *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  char *tmp___5 ;

  {
  {
#line 19
  ifp = (FILE *)((void *)0);
#line 21
  nPos = 0;
#line 21
  i = 0;
#line 21
  j = 0;
#line 21
  nSequences = 0;
#line 26
  ptData->nSeq = 0;
#line 27
  ptData->nMaxLen = 0;
#line 29
  ifp = fopen((char const   */* __restrict  */)ptParams->szInputFile, (char const   */* __restrict  */)"r");
  }
#line 31
  if (ifp) {
    {
#line 32
    while (1) {
      while_continue: /* CIL Label */ ;
      {
#line 32
      tmp___0 = fgets((char */* __restrict  */)(szLine), 1024, (FILE */* __restrict  */)ifp);
      }
#line 32
      if (! tmp___0) {
#line 32
        goto while_break;
      }
#line 33
      if ((int )szLine[0] == 62) {
#line 34
        if (nPos > ptData->nMaxLen) {
#line 35
          ptData->nMaxLen = nPos;
        }
#line 38
        (ptData->nSeq) ++;
#line 39
        nPos = 0;
      } else {
#line 43
        if (! ptData->nSeq) {
          {
#line 45
          fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"File %s does not appear to be in FASTA format.\n",
                  ptParams->szInputFile);
#line 46
          exit(1);
          }
        }
#line 49
        i = 0;
        {
#line 50
        while (1) {
          while_continue___0: /* CIL Label */ ;
          {
#line 50
          tmp = strrchr((char const   *)(szSequence), (int )szLine[i]);
          }
#line 50
          if (! ((unsigned long )tmp != (unsigned long )((void *)0))) {
#line 50
            goto while_break___0;
          }
#line 51
          i ++;
#line 52
          nPos ++;
        }
        while_break___0: /* CIL Label */ ;
        }
      }
    }
    while_break: /* CIL Label */ ;
    }
#line 57
    if (nPos > ptData->nMaxLen) {
#line 58
      ptData->nMaxLen = nPos;
    }
    {
#line 61
    fclose(ifp);
    }
  } else {
    {
#line 64
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Can\'t open input file %s\n",
            ptParams->szInputFile);
#line 65
    exit(1);
    }
  }
  {
#line 68
  tmp___1 = malloc((unsigned long )ptData->nSeq * sizeof(char *));
#line 68
  ptData->aszID = (char **)tmp___1;
#line 69
  tmp___2 = malloc((unsigned long )ptData->nSeq * sizeof(char *));
#line 69
  ptData->aacSequences = (char **)tmp___2;
#line 70
  tmp___3 = malloc((unsigned long )ptData->nSeq * sizeof(int ));
#line 70
  ptData->anLen = (int *)tmp___3;
#line 72
  ifp = fopen((char const   */* __restrict  */)ptParams->szInputFile, (char const   */* __restrict  */)"r");
  }
#line 74
  if (ifp) {
    {
#line 75
    while (1) {
      while_continue___1: /* CIL Label */ ;
      {
#line 75
      szRet = fgets((char */* __restrict  */)(szLine), 1024, (FILE */* __restrict  */)ifp);
      }
#line 75
      if (! szRet) {
#line 75
        goto while_break___1;
      }
#line 76
      if ((int )szLine[0] == 62) {
#line 77
        if (nSequences > 0) {
#line 78
          *(ptData->anLen + (nSequences - 1)) = nPos;
        }
        {
#line 81
        tmp___4 = malloc((unsigned long )ptData->nMaxLen * sizeof(char ));
#line 81
        *(ptData->aacSequences + nSequences) = (char *)tmp___4;
#line 82
        szBrk = strpbrk((char const   *)(szLine), " \n");
#line 83
        *szBrk = (char )'\000';
#line 84
        *(ptData->aszID + nSequences) = strdup((char const   *)(szLine + 1));
#line 85
        nPos = 0;
#line 86
        nSequences ++;
        }
      }
#line 89
      i = 0;
      {
#line 90
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 90
        if ((int )szLine[i] != 0) {
          {
#line 90
          tmp___5 = strrchr((char const   *)(szSequence), (int )szLine[i]);
          }
#line 90
          if (! ((unsigned long )tmp___5 != (unsigned long )((void *)0))) {
#line 90
            goto while_break___2;
          }
        } else {
#line 90
          goto while_break___2;
        }
#line 91
        *(*(ptData->aacSequences + (nSequences - 1)) + nPos) = szLine[i];
#line 92
        nPos ++;
#line 92
        i ++;
      }
      while_break___2: /* CIL Label */ ;
      }
    }
    while_break___1: /* CIL Label */ ;
    }
    {
#line 96
    *(ptData->anLen + (nSequences - 1)) = nPos;
#line 98
    fclose(ifp);
    }
  } else {
    {
#line 101
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Can\'t open input file %s\n",
            ptParams->szInputFile);
#line 102
    exit(1);
    }
  }
#line 104
  return;
}
}
#line 106 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void writeSequence(FILE *ofp , t_Data *ptData , int nCopies , int nI ) 
{ 
  int nPos ;

  {
  {
#line 108
  nPos = 0;
#line 110
  fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)">%s_%d\n",
          *(ptData->aszID + nI), nCopies);
  }
  {
#line 112
  while (1) {
    while_continue: /* CIL Label */ ;
#line 112
    if (! (nPos < *(ptData->anLen + nI))) {
#line 112
      goto while_break;
    }
#line 113
    if (nPos == 80) {
      {
#line 114
      fputc('\n', ofp);
      }
    }
    {
#line 117
    fputc((int )*(*(ptData->aacSequences + nI) + nPos), ofp);
#line 119
    nPos ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 122
  fputc('\n', ofp);
  }
#line 123
  return;
}
}
#line 289 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void allocMap(t_Map *ptMap , int nSeq ) 
{ 
  int i ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 291
  i = 0;
#line 293
  ptMap->nSeq = nSeq;
#line 295
  tmp = malloc((unsigned long )nSeq * sizeof(int ));
#line 295
  ptMap->anN = (int *)tmp;
  }
#line 296
  if (! ptMap->anN) {
#line 297
    goto memoryError;
  }
  {
#line 299
  tmp___0 = malloc((unsigned long )nSeq * sizeof(int ));
#line 299
  ptMap->anSize = (int *)tmp___0;
  }
#line 300
  if (! ptMap->anSize) {
#line 301
    goto memoryError;
  }
  {
#line 303
  tmp___1 = malloc((unsigned long )nSeq * sizeof(int *));
#line 303
  ptMap->aanMap = (int **)tmp___1;
  }
#line 304
  if (! ptMap->aanMap) {
#line 305
    goto memoryError;
  }
#line 307
  i = 0;
  {
#line 307
  while (1) {
    while_continue: /* CIL Label */ ;
#line 307
    if (! (i < nSeq)) {
#line 307
      goto while_break;
    }
    {
#line 308
    *(ptMap->anN + i) = 0;
#line 309
    *(ptMap->anSize + i) = 128;
#line 310
    tmp___2 = malloc(128UL * sizeof(int ));
#line 310
    *(ptMap->aanMap + i) = (int *)tmp___2;
    }
#line 311
    if (! *(ptMap->aanMap + i)) {
#line 312
      goto memoryError;
    }
#line 307
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 315
  return;
  memoryError: 
  {
#line 317
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed allocating memory in allocMap\n");
#line 318
  fflush(stderr);
#line 319
  exit(1);
  }
}
}
#line 322 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void addEntry(t_Map *ptMap , int nI , int nJ ) 
{ 
  void *tmp ;

  {
#line 324
  (*(ptMap->anN + nI)) ++;
#line 325
  if (*(ptMap->anN + nI) > *(ptMap->anSize + nI)) {
    {
#line 326
    *(ptMap->anSize + nI) *= 2;
#line 328
    tmp = realloc((void *)*(ptMap->aanMap + nI), (unsigned long )*(ptMap->anSize + nI) * sizeof(int ));
#line 328
    *(ptMap->aanMap + nI) = (int *)tmp;
    }
#line 329
    if (! *(ptMap->aanMap + nI)) {
#line 330
      goto memoryError;
    }
  }
#line 333
  *(*(ptMap->aanMap + nI) + (*(ptMap->anN + nI) - 1)) = nJ;
#line 335
  return;
  memoryError: 
  {
#line 338
  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed allocating memory in allocMap\n");
#line 339
  fflush(stderr);
#line 340
  exit(1);
  }
}
}
#line 343 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void writeMap(FILE *ofp , t_Data *ptData , t_Map *ptMap ) 
{ 
  int i ;
  int j ;
  int nUnique ;

  {
#line 345
  i = 0;
#line 345
  j = 0;
#line 346
  nUnique = 0;
#line 348
  i = 0;
  {
#line 348
  while (1) {
    while_continue: /* CIL Label */ ;
#line 348
    if (! (i < ptMap->nSeq)) {
#line 348
      goto while_break;
    }
#line 349
    if (*(ptMap->anN + i) > 0) {
      {
#line 350
      fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%d,%d,%s,%d:",
              i, nUnique, *(ptData->aszID + i), *(ptMap->anN + i));
#line 351
      j = 0;
      }
      {
#line 351
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 351
        if (! (j < *(ptMap->anN + i))) {
#line 351
          goto while_break___0;
        }
        {
#line 352
        fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%d",
                *(*(ptMap->aanMap + i) + j));
        }
#line 353
        if (j < *(ptMap->anN + i) - 1) {
          {
#line 354
          fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)",");
          }
        } else {
          {
#line 357
          fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)":");
          }
        }
#line 351
        j ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 361
      j = 0;
      {
#line 361
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 361
        if (! (j < *(ptMap->anN + i))) {
#line 361
          goto while_break___1;
        }
        {
#line 362
        fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"%s",
                *(ptData->aszID + *(*(ptMap->aanMap + i) + j)));
        }
#line 363
        if (j < *(ptMap->anN + i) - 1) {
          {
#line 364
          fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)",");
          }
        }
#line 361
        j ++;
      }
      while_break___1: /* CIL Label */ ;
      }
      {
#line 368
      nUnique ++;
#line 369
      fprintf((FILE */* __restrict  */)ofp, (char const   */* __restrict  */)"\n");
      }
    }
#line 348
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 372
  return;
}
}
#line 374 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
void destroyMap(t_Map *ptMap ) 
{ 
  int i ;

  {
#line 376
  i = 0;
#line 378
  i = 0;
  {
#line 378
  while (1) {
    while_continue: /* CIL Label */ ;
#line 378
    if (! (i < ptMap->nSeq)) {
#line 378
      goto while_break;
    }
    {
#line 379
    free((void *)*(ptMap->aanMap + i));
#line 378
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 382
  free((void *)ptMap->aanMap);
#line 384
  free((void *)ptMap->anN);
#line 386
  free((void *)ptMap->anSize);
  }
#line 388
  return;
}
}
#line 390 "/home/june/collector/temp/ampliconnoise-1.29/FastaUnique/FastaUnique.c"
char *szCreateMapFileName(char *szFastaFile ) 
{ 
  char *szMapFile ;
  void *tmp ;
  char *szStub ;
  char *tmp___0 ;
  char *szTemp ;

  {
  {
#line 392
  tmp = malloc(1024UL * sizeof(char ));
#line 392
  szMapFile = (char *)tmp;
#line 393
  tmp___0 = strdup((char const   *)szFastaFile);
#line 393
  szStub = tmp___0;
#line 394
  szTemp = (char *)((void *)0);
#line 396
  szTemp = strstr((char const   *)szStub, ".fa");
  }
#line 398
  if ((unsigned long )szTemp != (unsigned long )((void *)0)) {
#line 399
    *szTemp = (char )'\000';
  }
  {
#line 402
  sprintf((char */* __restrict  */)szMapFile, (char const   */* __restrict  */)"%s%s",
          szStub, ".map");
#line 404
  free((void *)szStub);
  }
#line 405
  return (szMapFile);
}
}
