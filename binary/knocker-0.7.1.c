/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 61 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.h"
struct __anonstruct_knocker_led_t_26 {
   int num ;
   int caps ;
   int scroll ;
   int sequence ;
};
#line 61 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.h"
typedef struct __anonstruct_knocker_led_t_26 knocker_led_t;
#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 124 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __dev_t;
#line 125 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 126 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __gid_t;
#line 127 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __ino_t;
#line 129 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __mode_t;
#line 130 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __nlink_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 153 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blksize_t;
#line 158 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blkcnt_t;
#line 175 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __syscall_slong_t;
#line 120 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   __syscall_slong_t tv_nsec ;
};
#line 46 "/usr/include/x86_64-linux-gnu/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   __ino_t st_ino ;
   __nlink_t st_nlink ;
   __mode_t st_mode ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   int __pad0 ;
   __dev_t st_rdev ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __syscall_slong_t __glibc_reserved[3] ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 87 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.h"
struct __anonstruct_knocker_args_t_42 {
   char *hname ;
   char *hip ;
   char *lfname ;
   int hfamily ;
   unsigned int port ;
   unsigned int sport ;
   unsigned int eport ;
   int logfile ;
   int quiet ;
   int colors ;
   int fency ;
   int win32_frontend ;
};
#line 87 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.h"
typedef struct __anonstruct_knocker_args_t_42 knocker_args_t;
#line 27 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.h"
struct __anonstruct_knocker_user_t_43 {
   char *name ;
   char *dir ;
   int super ;
};
#line 27 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.h"
typedef struct __anonstruct_knocker_user_t_43 knocker_user_t;
#line 189 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __socklen_t;
#line 48 "/usr/include/stdint.h"
typedef unsigned char uint8_t;
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 33 "/usr/include/x86_64-linux-gnu/bits/socket.h"
typedef __socklen_t socklen_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 149 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 162 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr_storage {
   sa_family_t ss_family ;
   unsigned long __ss_align ;
   char __ss_padding[128UL - 2UL * sizeof(unsigned long )] ;
};
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 117 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 209 "/usr/include/netinet/in.h"
union __anonunion___in6_u_31 {
   uint8_t __u6_addr8[16] ;
   uint16_t __u6_addr16[8] ;
   uint32_t __u6_addr32[4] ;
};
#line 209 "/usr/include/netinet/in.h"
struct in6_addr {
   union __anonunion___in6_u_31 __in6_u ;
};
#line 237 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 252 "/usr/include/netinet/in.h"
struct sockaddr_in6 {
   sa_family_t sin6_family ;
   in_port_t sin6_port ;
   uint32_t sin6_flowinfo ;
   struct in6_addr sin6_addr ;
   uint32_t sin6_scope_id ;
};
#line 257 "/usr/include/netdb.h"
struct servent {
   char *s_name ;
   char **s_aliases ;
   int s_port ;
   char *s_proto ;
};
#line 567 "/usr/include/netdb.h"
struct addrinfo {
   int ai_flags ;
   int ai_family ;
   int ai_socktype ;
   int ai_protocol ;
   socklen_t ai_addrlen ;
   struct sockaddr *ai_addr ;
   char *ai_canonname ;
   struct addrinfo *ai_next ;
};
#line 113 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
struct __anonstruct_knocker_core_socket_t_38 {
   int fd ;
   int active ;
   int protocol ;
};
#line 113 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
typedef struct __anonstruct_knocker_core_socket_t_38 knocker_core_socket_t;
#line 123 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
struct __anonstruct_knocker_core_port_t_39 {
   unsigned int number ;
   char *service ;
   int status ;
   int protocol ;
};
#line 123 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
typedef struct __anonstruct_knocker_core_port_t_39 knocker_core_port_t;
#line 137 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
struct __anonstruct_knocker_core_host_t_40 {
   struct sockaddr_storage hostaddr ;
   socklen_t addrlen ;
   struct sockaddr_storage sockaddr_st ;
   char *name ;
   char *ip ;
};
#line 137 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
typedef struct __anonstruct_knocker_core_host_t_40 knocker_core_host_t;
#line 145 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
struct __anonstruct_knocker_core_portscan_data_t_41 {
   knocker_core_socket_t socket ;
   knocker_core_port_t port[65535] ;
   knocker_core_host_t host ;
};
#line 145 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
typedef struct __anonstruct_knocker_core_portscan_data_t_41 knocker_core_portscan_data_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 141 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __suseconds_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 55 "/usr/include/x86_64-linux-gnu/sys/time.h"
struct timezone {
   int tz_minuteswest ;
   int tz_dsttime ;
};
#line 61 "/usr/include/x86_64-linux-gnu/sys/time.h"
typedef struct timezone * __restrict  __timezone_ptr_t;
#line 68 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.h"
knocker_led_t knocker_led_status  ;
#line 70
void knocker_led_turn_on(int led ) ;
#line 71
void knocker_led_turn_off(int led ) ;
#line 72
void knocker_led_turn_on_all(void) ;
#line 73
void knocker_led_turn_off_all(void) ;
#line 74
void knocker_led_sequence(void) ;
#line 75
void knocker_led_reset(void) ;
#line 78 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.h"
int ledt  ;
#line 41 "/usr/include/x86_64-linux-gnu/sys/ioctl.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) ioctl)(int __fd ,
                                                                            unsigned long __request 
                                                                            , ...) ;
#line 54 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
static int initialized  =    0;
#line 61 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
static int knocker_led_init(knocker_led_t *knocker_leds ) 
{ 


  {
  {
#line 64
  ioctl(0, 19250UL, 255);
#line 66
  knocker_leds->num = 0;
#line 67
  knocker_leds->caps = 0;
#line 68
  knocker_leds->scroll = 0;
#line 70
  knocker_leds->sequence = 0;
#line 72
  initialized = 1;
  }
#line 74
  return (0);
}
}
#line 81 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
static void knocker_led_quit(knocker_led_t *knocker_leds ) 
{ 


  {
#line 84
  if (! initialized) {
#line 85
    return;
  }
#line 87
  knocker_leds->num = 0;
#line 88
  knocker_leds->caps = 0;
#line 89
  knocker_leds->scroll = 0;
#line 91
  knocker_leds->sequence = 0;
#line 93
  initialized = 0;
#line 95
  return;
}
}
#line 103 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_turn_on(int led ) 
{ 
  char state ;

  {
#line 108
  if (! initialized) {
    {
#line 109
    knocker_led_init(& knocker_led_status);
    }
  }
  {
#line 111
  ioctl(0, 19249UL, & state);
  }
#line 113
  if (led == 0) {
#line 115
    if (! knocker_led_status.num) {
      {
#line 117
      ioctl(0, 19250UL, 2);
#line 118
      knocker_led_status.num = 1;
      }
    }
  } else
#line 121
  if (led == 1) {
#line 123
    if (! knocker_led_status.caps) {
      {
#line 125
      ioctl(0, 19250UL, 4);
#line 126
      knocker_led_status.caps = 1;
      }
    }
  } else
#line 129
  if (led == 2) {
#line 131
    if (! knocker_led_status.scroll) {
      {
#line 133
      ioctl(0, 19250UL, 1);
#line 134
      knocker_led_status.scroll = 1;
      }
    }
  }
#line 138
  return;
}
}
#line 145 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_turn_off(int led ) 
{ 
  char state ;

  {
#line 150
  if (! initialized) {
#line 151
    return;
  }
  {
#line 153
  ioctl(0, 19249UL, & state);
  }
#line 155
  if (led == 0) {
#line 157
    if (knocker_led_status.num) {
      {
#line 159
      ioctl(0, 19250UL, (int )state & -3);
#line 161
      knocker_led_status.num = 0;
      }
    }
  } else
#line 164
  if (led == 1) {
#line 166
    if (knocker_led_status.caps) {
      {
#line 168
      ioctl(0, 19250UL, (int )state & -5);
#line 170
      knocker_led_status.caps = 0;
      }
    }
  } else
#line 173
  if (led == 2) {
#line 175
    if (knocker_led_status.scroll) {
      {
#line 177
      ioctl(0, 19250UL, (int )state & -2);
#line 179
      knocker_led_status.scroll = 0;
      }
    }
  }
#line 184
  return;
}
}
#line 192 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_turn_on_all(void) 
{ 


  {
#line 197
  if (! initialized) {
    {
#line 198
    knocker_led_init(& knocker_led_status);
    }
  }
  {
#line 200
  ioctl(0, 19250UL, 7);
#line 202
  knocker_led_status.num = 1;
#line 203
  knocker_led_status.caps = 1;
#line 204
  knocker_led_status.scroll = 1;
  }
#line 206
  return;
}
}
#line 213 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_turn_off_all(void) 
{ 
  char state ;

  {
#line 218
  if (! initialized) {
#line 219
    return;
  }
  {
#line 221
  ioctl(0, 19249UL, & state);
#line 222
  ioctl(0, 19250UL, (int )state & -8);
#line 224
  knocker_led_status.num = 0;
#line 225
  knocker_led_status.caps = 0;
#line 226
  knocker_led_status.scroll = 0;
  }
#line 228
  return;
}
}
#line 236 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_sequence(void) 
{ 


  {
#line 240
  if (ledt > 1) {
#line 241
    ledt = 0;
  }
#line 243
  if (ledt < 0) {
#line 244
    ledt = 0;
  }
#line 246
  ledt ++;
#line 248
  if (ledt != 1) {
#line 249
    return;
  }
#line 251
  if (knocker_led_status.sequence == 0) {
    {
#line 255
    knocker_led_turn_on(0);
#line 256
    knocker_led_status.sequence = 1;
    }
#line 257
    return;
  } else
#line 259
  if (knocker_led_status.sequence == 1) {
    {
#line 264
    knocker_led_turn_off(0);
#line 266
    knocker_led_turn_on(1);
#line 268
    knocker_led_status.sequence = 2;
    }
#line 269
    return;
  } else
#line 271
  if (knocker_led_status.sequence == 2) {
    {
#line 275
    knocker_led_turn_off(1);
#line 277
    knocker_led_turn_on(2);
#line 279
    knocker_led_status.sequence = 3;
    }
#line 280
    return;
  } else
#line 282
  if (knocker_led_status.sequence == 3) {
    {
#line 286
    knocker_led_turn_off(2);
#line 288
    knocker_led_turn_on(0);
#line 290
    knocker_led_status.sequence = 1;
    }
#line 291
    return;
  }
#line 294
  return;
}
}
#line 301 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_led.c"
void knocker_led_reset(void) 
{ 


  {
#line 306
  if (initialized) {
    {
#line 307
    knocker_led_quit(& knocker_led_status);
    }
  }
  {
#line 309
  ioctl(0, 19250UL, 255);
  }
#line 311
  return;
}
}
#line 147 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 466
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 480
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__,
__leaf__)) realloc)(void *__ptr , size_t __size ) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 564
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) getenv)(char const   *__name ) ;
#line 129 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 137
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcat)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 348
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(2), __leaf__)) strtok)(char * __restrict  __s ,
                                                                                               char const   * __restrict  __delim ) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 209 "/usr/include/x86_64-linux-gnu/sys/stat.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) stat)(char const   * __restrict  __file ,
                                                                                             struct stat * __restrict  __buf ) ;
#line 321
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) mkdir)(char const   *__path ,
                                                                                            __mode_t __mode ) ;
#line 675 "/usr/include/unistd.h"
extern  __attribute__((__nothrow__)) __uid_t ( __attribute__((__leaf__)) getuid)(void) ;
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 364
extern  __attribute__((__nothrow__)) int sprintf(char * __restrict  __s , char const   * __restrict  __format 
                                                 , ...) ;
#line 531
extern int fgetc(FILE *__stream ) ;
#line 168 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
char *knocker_core_last_hostip  ;
#line 169 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
char *knocker_core_last_hostname  ;
#line 170 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
char *knocker_core_last_service  ;
#line 103 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.h"
knocker_args_t knocker_args  ;
#line 33 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.h"
knocker_user_t knocker_user  ;
#line 35
int knocker_user_is_root(void) ;
#line 36
char *knocker_user_get_username(void) ;
#line 37
char *knocker_user_get_userhome(void) ;
#line 39
int knocker_user_init(knocker_user_t *user ) ;
#line 40
void knocker_user_free(knocker_user_t *user ) ;
#line 42
int knocker_user_read_lastscan(knocker_user_t *user , knocker_args_t *args ) ;
#line 43
int knocker_user_write_lastscan(knocker_user_t *user , knocker_args_t *args ) ;
#line 45
int knocker_user_read_lasthost(knocker_user_t *user , knocker_args_t *args ) ;
#line 44 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
static int _dir_exists(char const   *path ) ;
#line 45
static int _dir_create(char const   *path ) ;
#line 46
static int _file_exists(char const   *path ) ;
#line 47
static int _file_readline(FILE *fp , char *line , int maxlen ) ;
#line 54 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
int knocker_user_init(knocker_user_t *user ) 
{ 
  char *tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  size_t tmp___3 ;
  void *tmp___4 ;
  char *tmp___5 ;
  char *tmp___6 ;
  size_t tmp___7 ;
  size_t tmp___8 ;
  void *tmp___9 ;
  char *tmp___10 ;
  size_t tmp___11 ;
  size_t tmp___12 ;
  void *tmp___13 ;
  char *tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;

  {
  {
#line 60
  tmp___5 = knocker_user_get_username();
  }
#line 60
  if ((unsigned long )tmp___5 != (unsigned long )((void *)0)) {
#line 63
    if ((unsigned long )user->name != (unsigned long )((void *)0)) {
      {
#line 64
      tmp = knocker_user_get_username();
#line 64
      tmp___0 = strlen((char const   *)tmp);
#line 64
      tmp___1 = realloc((void *)user->name, tmp___0 + 1UL);
#line 64
      user->name = (char *)tmp___1;
      }
    } else {
      {
#line 66
      tmp___2 = knocker_user_get_username();
#line 66
      tmp___3 = strlen((char const   *)tmp___2);
#line 66
      tmp___4 = malloc(tmp___3 + 1UL);
#line 66
      user->name = (char *)tmp___4;
      }
    }
  }
  {
#line 69
  user->name = knocker_user_get_username();
  }
#line 71
  if ((unsigned long )user->dir != (unsigned long )((void *)0)) {
    {
#line 72
    tmp___6 = knocker_user_get_userhome();
#line 72
    tmp___7 = strlen((char const   *)tmp___6);
#line 72
    tmp___8 = strlen("knocker");
#line 72
    tmp___9 = realloc((void *)user->dir, (tmp___7 + tmp___8) + 3UL);
#line 72
    user->dir = (char *)tmp___9;
    }
  } else {
    {
#line 74
    tmp___10 = knocker_user_get_userhome();
#line 74
    tmp___11 = strlen((char const   *)tmp___10);
#line 74
    tmp___12 = strlen("knocker");
#line 74
    tmp___13 = malloc((tmp___11 + tmp___12) + 3UL);
#line 74
    user->dir = (char *)tmp___13;
    }
  }
  {
#line 76
  tmp___14 = knocker_user_get_userhome();
#line 76
  strcpy((char */* __restrict  */)user->dir, (char const   */* __restrict  */)tmp___14);
#line 77
  strcat((char */* __restrict  */)user->dir, (char const   */* __restrict  */)"/.");
#line 78
  strcat((char */* __restrict  */)user->dir, (char const   */* __restrict  */)"knocker");
#line 80
  tmp___15 = _dir_exists((char const   *)user->dir);
  }
#line 80
  if (! tmp___15) {
    {
#line 82
    _dir_create((char const   *)user->dir);
    }
  }
  {
#line 85
  tmp___16 = knocker_user_is_root();
  }
#line 85
  if (tmp___16) {
#line 86
    user->super = 1;
  } else {
#line 88
    user->super = 0;
  }
#line 94
  return (0);
}
}
#line 101 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
void knocker_user_free(knocker_user_t *user ) 
{ 


  {
#line 107
  if ((unsigned long )user->dir != (unsigned long )((void *)0)) {
    {
#line 108
    free((void *)user->dir);
    }
  }
#line 110
  user->super = 0;
#line 112
  return;
}
}
#line 119 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
int knocker_user_write_lastscan(knocker_user_t *user , knocker_args_t *args ) 
{ 
  char *lscanfile ;
  FILE *fp ;
  size_t tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;

  {
#line 124
  if ((unsigned long )args->hname == (unsigned long )((void *)0)) {
#line 125
    return (-1);
  }
#line 127
  if (args->port == 0U) {
#line 129
    if (args->sport == 0U) {
#line 129
      if (args->eport == 0U) {
#line 130
        return (-1);
      }
    }
  }
  {
#line 133
  tmp = strlen((char const   *)user->dir);
#line 133
  tmp___0 = strlen("lastscan");
#line 133
  tmp___1 = malloc((tmp + tmp___0) + 2UL);
#line 133
  lscanfile = (char *)tmp___1;
#line 134
  sprintf((char */* __restrict  */)lscanfile, (char const   */* __restrict  */)"%s/%s",
          user->dir, "lastscan");
#line 136
  fp = fopen((char const   */* __restrict  */)lscanfile, (char const   */* __restrict  */)"w");
  }
#line 136
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 139
    free((void *)lscanfile);
    }
#line 140
    return (-1);
  }
  {
#line 143
  free((void *)lscanfile);
#line 145
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%s", args->hname,
          "|");
#line 146
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->port,
          "|");
#line 147
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->sport,
          "|");
#line 148
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->eport,
          "|");
#line 150
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->logfile,
          "|");
  }
#line 152
  if (args->logfile) {
    {
#line 153
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%s",
            args->lfname, "|");
    }
  } else {
    {
#line 155
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"null%s",
            "|");
    }
  }
  {
#line 157
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->quiet,
          "|");
#line 158
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%d%s", args->colors,
          "|");
#line 160
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 162
  fclose(fp);
  }
#line 164
  return (0);
}
}
#line 170 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
int knocker_user_read_lastscan(knocker_user_t *user , knocker_args_t *args ) 
{ 
  char *lscanfile ;
  char line[255] ;
  char *buffer[255] ;
  int i ;
  FILE *fp ;
  size_t tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *tmp___5 ;
  size_t tmp___6 ;
  void *tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  size_t tmp___11 ;
  void *tmp___12 ;

  {
  {
#line 175
  i = 0;
#line 179
  tmp = strlen((char const   *)user->dir);
#line 179
  tmp___0 = strlen("lastscan");
#line 179
  tmp___1 = malloc((tmp + tmp___0) + 2UL);
#line 179
  lscanfile = (char *)tmp___1;
#line 180
  sprintf((char */* __restrict  */)lscanfile, (char const   */* __restrict  */)"%s/%s",
          user->dir, "lastscan");
#line 182
  _file_exists((char const   *)lscanfile);
#line 186
  fp = fopen((char const   */* __restrict  */)lscanfile, (char const   */* __restrict  */)"r");
  }
#line 186
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 189
    free((void *)lscanfile);
    }
#line 190
    return (-1);
  }
  {
#line 193
  free((void *)lscanfile);
#line 195
  tmp___2 = _file_readline(fp, line, 255);
  }
#line 195
  if (tmp___2 < 0) {
#line 198
    return (-1);
  }
  {
#line 202
  tmp___3 = i;
#line 202
  i ++;
#line 202
  buffer[tmp___3] = strtok((char */* __restrict  */)(line), (char const   */* __restrict  */)"|");
  }
  {
#line 203
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 203
    tmp___4 = i;
#line 203
    i ++;
#line 203
    tmp___5 = strtok((char */* __restrict  */)((void *)0), (char const   */* __restrict  */)"|");
#line 203
    buffer[tmp___4] = tmp___5;
    }
#line 203
    if (! tmp___5) {
#line 203
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 206
  tmp___6 = strlen((char const   *)buffer[0]);
#line 206
  tmp___7 = realloc((void *)args->hname, tmp___6 + 1UL);
#line 206
  args->hname = (char *)tmp___7;
#line 207
  strcpy((char */* __restrict  */)args->hname, (char const   */* __restrict  */)buffer[0]);
#line 209
  tmp___8 = atoi((char const   *)buffer[1]);
#line 209
  args->port = (unsigned int )tmp___8;
#line 210
  tmp___9 = atoi((char const   *)buffer[2]);
#line 210
  args->sport = (unsigned int )tmp___9;
#line 211
  tmp___10 = atoi((char const   *)buffer[3]);
#line 211
  args->eport = (unsigned int )tmp___10;
#line 212
  args->logfile = atoi((char const   *)buffer[4]);
  }
#line 214
  if (args->logfile) {
    {
#line 217
    tmp___11 = strlen((char const   *)buffer[5]);
#line 217
    tmp___12 = realloc((void *)args->lfname, tmp___11 + 1UL);
#line 217
    args->lfname = (char *)tmp___12;
#line 218
    strcpy((char */* __restrict  */)args->lfname, (char const   */* __restrict  */)buffer[5]);
    }
  }
  {
#line 221
  args->quiet = atoi((char const   *)buffer[6]);
#line 222
  args->colors = atoi((char const   *)buffer[7]);
#line 235
  fclose(fp);
  }
#line 237
  return (0);
}
}
#line 243 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
int knocker_user_read_lasthost(knocker_user_t *user , knocker_args_t *args ) 
{ 
  char *lscanfile ;
  char line[255] ;
  char *buffer[255] ;
  int i ;
  FILE *fp ;
  size_t tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  size_t tmp___4 ;
  void *tmp___5 ;

  {
  {
#line 248
  i = 0;
#line 252
  tmp = strlen((char const   *)user->dir);
#line 252
  tmp___0 = strlen("lastscan");
#line 252
  tmp___1 = malloc((tmp + tmp___0) + 2UL);
#line 252
  lscanfile = (char *)tmp___1;
#line 253
  sprintf((char */* __restrict  */)lscanfile, (char const   */* __restrict  */)"%s/%s",
          user->dir, "lastscan");
#line 255
  _file_exists((char const   *)lscanfile);
#line 259
  fp = fopen((char const   */* __restrict  */)lscanfile, (char const   */* __restrict  */)"r");
  }
#line 259
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 262
    free((void *)lscanfile);
    }
#line 263
    return (-1);
  }
  {
#line 266
  free((void *)lscanfile);
#line 268
  tmp___2 = _file_readline(fp, line, 255);
  }
#line 268
  if (tmp___2 < 0) {
#line 271
    return (-1);
  }
  {
#line 275
  tmp___3 = i;
#line 275
  i ++;
#line 275
  buffer[tmp___3] = strtok((char */* __restrict  */)(line), (char const   */* __restrict  */)"|");
#line 278
  tmp___4 = strlen((char const   *)buffer[0]);
#line 278
  tmp___5 = realloc((void *)args->hname, tmp___4 + 1UL);
#line 278
  args->hname = (char *)tmp___5;
#line 279
  strcpy((char */* __restrict  */)args->hname, (char const   */* __restrict  */)buffer[0]);
#line 281
  fclose(fp);
  }
#line 283
  return (0);
}
}
#line 290 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
int knocker_user_is_root(void) 
{ 
  __uid_t tmp ;

  {
  {
#line 295
  tmp = getuid();
  }
#line 295
  if (tmp == 0U) {
#line 297
    return (1);
  }
#line 301
  return (0);
}
}
#line 309 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
char *knocker_user_get_username(void) 
{ 
  char *tmp ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;

  {
  {
#line 315
  tmp___2 = getenv("USER");
  }
#line 315
  if ((unsigned long )tmp___2 != (unsigned long )((void *)0)) {
    {
#line 316
    tmp = getenv("USER");
    }
#line 316
    return (tmp);
  } else {
    {
#line 318
    tmp___1 = getenv("LOGNAME");
    }
#line 318
    if ((unsigned long )tmp___1 != (unsigned long )((void *)0)) {
      {
#line 319
      tmp___0 = getenv("LOGNAME");
      }
#line 319
      return (tmp___0);
    } else {
#line 322
      return ((char *)((void *)0));
    }
  }
}
}
#line 331 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
char *knocker_user_get_userhome(void) 
{ 
  char *tmp ;

  {
  {
#line 336
  tmp = getenv("HOME");
  }
#line 336
  return (tmp);
}
}
#line 344 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
static int _dir_create(char const   *path ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 351
  tmp = _dir_exists(path);
  }
#line 351
  if (tmp) {
#line 352
    return (0);
  }
  {
#line 355
  tmp___0 = mkdir(path, (__mode_t )448);
  }
#line 355
  if (tmp___0 != 0) {
#line 356
    return (-1);
  }
#line 360
  return (0);
}
}
#line 363 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
static int _dir_exists(char const   *path ) 
{ 
  struct stat dirstat ;
  int tmp ;

  {
  {
#line 370
  tmp = stat((char const   */* __restrict  */)path, (struct stat */* __restrict  */)(& dirstat));
  }
#line 370
  if (tmp != 0) {
#line 373
    return (0);
  }
#line 376
  if ((dirstat.st_mode & 61440U) == 16384U) {
#line 379
    return (1);
  }
#line 383
  return (0);
}
}
#line 386 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
static int _file_exists(char const   *path ) 
{ 
  struct stat filestat ;
  int tmp ;

  {
  {
#line 393
  tmp = stat((char const   */* __restrict  */)path, (struct stat */* __restrict  */)(& filestat));
  }
#line 393
  if (tmp != 0) {
#line 396
    return (0);
  }
#line 399
  if ((filestat.st_mode & 61440U) == 32768U) {
#line 402
    return (1);
  }
#line 405
  return (0);
}
}
#line 408 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_user.c"
static int _file_readline(FILE *fp , char *line , int maxlen ) 
{ 
  int i ;
  int c ;

  {
#line 410
  i = 0;
  {
#line 413
  while (1) {
    while_continue: /* CIL Label */ ;
#line 413
    if (! (i < maxlen)) {
#line 413
      goto while_break;
    }
    {
#line 415
    c = fgetc(fp);
    }
#line 417
    if (c == -1) {
#line 419
      *(line + i) = (char )'\000';
#line 420
      return (-1);
    }
#line 423
    if (c == 10) {
#line 424
      goto while_break;
    }
#line 426
    *(line + i) = (char )c;
#line 428
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 431
  *(line + i) = (char )'\000';
#line 433
  return (i);
}
}
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 144
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strcmp)(char const   *__s1 ,
                                                                                               char const   *__s2 )  __attribute__((__pure__)) ;
#line 113 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) socket)(int __domain ,
                                                                             int __type ,
                                                                             int __protocol ) ;
#line 137
extern int connect(int __fd , struct sockaddr  const  *__addr , socklen_t __len ) ;
#line 379 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint16_t ( __attribute__((__leaf__)) htons)(uint16_t __hostshort )  __attribute__((__const__)) ;
#line 297 "/usr/include/netdb.h"
extern struct servent *getservbyport(int __port , char const   *__proto ) ;
#line 662
extern int getaddrinfo(char const   * __restrict  __name , char const   * __restrict  __service ,
                       struct addrinfo  const  * __restrict  __req , struct addrinfo ** __restrict  __pai ) ;
#line 668
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) freeaddrinfo)(struct addrinfo *__ai ) ;
#line 677
extern int getnameinfo(struct sockaddr  const  * __restrict  __sa , socklen_t __salen ,
                       char * __restrict  __host , socklen_t __hostlen , char * __restrict  __serv ,
                       socklen_t __servlen , int __flags ) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 173 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
int knocker_core_init(void) ;
#line 174
void knocker_core_quit(void) ;
#line 177
int knocker_core_portscan_tcp_connnect(knocker_core_portscan_data_t *data , unsigned int port ) ;
#line 180
int knocker_core_init_portscan_data(knocker_core_portscan_data_t *data ) ;
#line 183
void knocker_core_free_portscan_data(knocker_core_portscan_data_t *data ) ;
#line 186
int knocker_core_validate_port_number(unsigned int port ) ;
#line 189
char *knocker_core_resolve_host(knocker_core_portscan_data_t *data , char const   *hostname ,
                                int family ) ;
#line 192
char *knocker_core_get_hostname(knocker_core_portscan_data_t *data ) ;
#line 195
char *knocker_core_get_hostip(knocker_core_portscan_data_t *data ) ;
#line 198
char *knocker_core_get_service(unsigned int port , int protocol ) ;
#line 32 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.h"
int knocker_core_services_db_init  ;
#line 34 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.h"
char *knocker_core_services_db[30000]  ;
#line 31 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_init_port_data(knocker_core_port_t *port ) ;
#line 32
static void knocker_core_free_port_data(knocker_core_port_t *port ) ;
#line 34
static int knocker_core_init_socket_data(knocker_core_socket_t *sock ) ;
#line 35
static void knocker_core_free_socket_data(knocker_core_socket_t *sock ) ;
#line 36
static int knocker_core_open_socket(knocker_core_socket_t *sock , int family , int protocol ) ;
#line 37
static void knocker_core_close_socket(knocker_core_socket_t *sock ) ;
#line 39
static int knocker_core_init_host_data(knocker_core_host_t *host ) ;
#line 40
static void knocker_core_free_host_data(knocker_core_host_t *host ) ;
#line 42
static int knocker_core_gethostbyname(knocker_core_host_t *hinfo , char const   *hostname ,
                                      int family ) ;
#line 43
static int knocker_core_getservbyport(char *service , unsigned int port , int protocol ) ;
#line 45
static char *knocker_core_get_host_name_string(knocker_core_host_t *hinfo ) ;
#line 46
static char *knocker_core_get_host_ip_string(knocker_core_host_t *hinfo ) ;
#line 47
static int knocker_core_set_host_name_string(knocker_core_host_t *hinfo , char const   *hostname ) ;
#line 48
static int knocker_core_set_host_ip_string(knocker_core_host_t *hinfo , char const   *hostip ) ;
#line 49
static void knocker_core_free_host_name_string(knocker_core_host_t *hinfo ) ;
#line 50
static void knocker_core_free_host_ip_string(knocker_core_host_t *hinfo ) ;
#line 58 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
int knocker_core_init(void) 
{ 


  {
#line 76
  knocker_core_last_hostip = (char *)((void *)0);
#line 77
  knocker_core_last_hostname = (char *)((void *)0);
#line 78
  knocker_core_last_service = (char *)((void *)0);
#line 80
  return (0);
}
}
#line 88 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
void knocker_core_quit(void) 
{ 


  {
#line 97
  if ((unsigned long )knocker_core_last_hostip != (unsigned long )((void *)0)) {
    {
#line 98
    free((void *)knocker_core_last_hostip);
    }
  }
#line 106
  if ((unsigned long )knocker_core_last_hostname != (unsigned long )((void *)0)) {
    {
#line 107
    free((void *)knocker_core_last_hostname);
    }
  }
#line 115
  if ((unsigned long )knocker_core_last_service != (unsigned long )((void *)0)) {
    {
#line 116
    free((void *)knocker_core_last_service);
    }
  }
#line 125
  return;
}
}
#line 132 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
int knocker_core_init_portscan_data(knocker_core_portscan_data_t *data ) 
{ 


  {
  {
#line 142
  knocker_core_init_socket_data(& data->socket);
#line 152
  knocker_core_init_port_data(data->port);
#line 162
  knocker_core_init_host_data(& data->host);
  }
#line 167
  return (0);
}
}
#line 174 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
void knocker_core_free_portscan_data(knocker_core_portscan_data_t *data ) 
{ 


  {
  {
#line 183
  knocker_core_free_socket_data(& data->socket);
#line 191
  knocker_core_free_port_data(data->port);
#line 199
  knocker_core_free_host_data(& data->host);
  }
#line 203
  return;
}
}
#line 210 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
char *knocker_core_get_hostname(knocker_core_portscan_data_t *data ) 
{ 
  char *tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  size_t tmp___3 ;
  void *tmp___4 ;
  char *tmp___5 ;
  char *tmp___6 ;

  {
#line 216
  if ((unsigned long )knocker_core_last_hostname == (unsigned long )((void *)0)) {
    {
#line 218
    tmp = knocker_core_get_host_name_string(& data->host);
#line 218
    tmp___0 = strlen((char const   *)tmp);
#line 218
    tmp___1 = malloc(1UL + tmp___0);
#line 218
    knocker_core_last_hostname = (char *)tmp___1;
    }
  } else {
    {
#line 222
    tmp___2 = knocker_core_get_host_name_string(& data->host);
#line 222
    tmp___3 = strlen((char const   *)tmp___2);
#line 222
    tmp___4 = realloc((void *)knocker_core_last_hostname, 1UL + tmp___3);
#line 222
    knocker_core_last_hostname = (char *)tmp___4;
    }
  }
  {
#line 234
  tmp___5 = knocker_core_get_host_name_string(& data->host);
#line 234
  tmp___6 = strcpy((char */* __restrict  */)knocker_core_last_hostname, (char const   */* __restrict  */)tmp___5);
  }
#line 234
  return (tmp___6);
}
}
#line 242 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
char *knocker_core_get_hostip(knocker_core_portscan_data_t *data ) 
{ 
  char *tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  size_t tmp___3 ;
  void *tmp___4 ;
  char *tmp___5 ;
  char *tmp___6 ;

  {
#line 248
  if ((unsigned long )knocker_core_last_hostip == (unsigned long )((void *)0)) {
    {
#line 250
    tmp = knocker_core_get_host_ip_string(& data->host);
#line 250
    tmp___0 = strlen((char const   *)tmp);
#line 250
    tmp___1 = malloc(1UL + tmp___0);
#line 250
    knocker_core_last_hostip = (char *)tmp___1;
    }
  } else {
    {
#line 254
    tmp___2 = knocker_core_get_host_ip_string(& data->host);
#line 254
    tmp___3 = strlen((char const   *)tmp___2);
#line 254
    tmp___4 = realloc((void *)knocker_core_last_hostip, 1UL + tmp___3);
#line 254
    knocker_core_last_hostip = (char *)tmp___4;
    }
  }
  {
#line 263
  tmp___5 = knocker_core_get_host_ip_string(& data->host);
#line 263
  tmp___6 = strcpy((char */* __restrict  */)knocker_core_last_hostip, (char const   */* __restrict  */)tmp___5);
  }
#line 263
  return (tmp___6);
}
}
#line 271 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
char *knocker_core_get_service(unsigned int port , int protocol ) 
{ 
  int slenght ;
  char tmpstr[200] ;
  size_t tmp ;
  void *tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  char *tmp___5 ;

  {
#line 283
  if (protocol != 2) {
#line 288
    if (protocol != 1) {
#line 293
      return ((char *)((void *)0));
    }
  }
  {
#line 303
  slenght = knocker_core_getservbyport(tmpstr, port, protocol);
  }
#line 310
  if (slenght == -1) {
#line 312
    if ((unsigned long )knocker_core_last_service == (unsigned long )((void *)0)) {
      {
#line 314
      tmp = strlen("unknown");
#line 314
      tmp___0 = malloc(tmp + 1UL);
#line 314
      knocker_core_last_service = (char *)tmp___0;
#line 315
      strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)"unknown");
      }
    } else {
      {
#line 319
      tmp___1 = strlen("unknown");
#line 319
      tmp___2 = realloc((void *)knocker_core_last_service, tmp___1 + 1UL);
#line 319
      knocker_core_last_service = (char *)tmp___2;
#line 320
      strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)"unknown");
      }
    }
#line 322
    return ((char *)((void *)0));
  }
#line 325
  if ((unsigned long )knocker_core_last_service == (unsigned long )((void *)0)) {
    {
#line 327
    tmp___3 = malloc((size_t )(slenght + 1));
#line 327
    knocker_core_last_service = (char *)tmp___3;
    }
  } else {
    {
#line 331
    tmp___4 = realloc((void *)knocker_core_last_service, (size_t )(slenght + 1));
#line 331
    knocker_core_last_service = (char *)tmp___4;
    }
  }
  {
#line 335
  tmp___5 = strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)(tmpstr));
  }
#line 335
  return (tmp___5);
}
}
#line 343 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
int knocker_core_validate_port_number(unsigned int port ) 
{ 


  {
#line 345
  if (port < 1U) {
#line 346
    return (0);
  }
#line 348
  if (port > 65535U) {
#line 349
    return (0);
  }
#line 351
  return (1);
}
}
#line 360 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
int knocker_core_portscan_tcp_connnect(knocker_core_portscan_data_t *data , unsigned int port ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 367
  tmp = knocker_core_open_socket(& data->socket, (int )data->host.hostaddr.ss_family,
                                 2);
  }
#line 367
  if (tmp == -1) {
#line 372
    return (-1);
  }
  {
#line 375
  memcpy((void */* __restrict  */)(& data->host.sockaddr_st), (void const   */* __restrict  */)(& data->host.hostaddr),
         (size_t )data->host.addrlen);
  }
  {
#line 377
  if ((int )data->host.hostaddr.ss_family == 10) {
#line 377
    goto case_10;
  }
#line 380
  goto switch_default;
  case_10: /* CIL Label */ 
  {
#line 378
  ((struct sockaddr_in6 *)(& data->host.sockaddr_st))->sin6_port = htons((uint16_t )port);
  }
  switch_default: /* CIL Label */ 
  {
#line 381
  ((struct sockaddr_in *)(& data->host.sockaddr_st))->sin_port = htons((uint16_t )port);
  }
  switch_break: /* CIL Label */ ;
  }
  {
#line 384
  tmp___0 = connect(data->socket.fd, (struct sockaddr  const  *)((struct sockaddr *)(& data->host.sockaddr_st)),
                    data->host.addrlen);
  }
#line 384
  if (! tmp___0) {
    {
#line 387
    knocker_core_close_socket(& data->socket);
    }
#line 391
    return (2);
  }
  {
#line 398
  knocker_core_close_socket(& data->socket);
  }
#line 400
  return (1);
}
}
#line 408 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
char *knocker_core_resolve_host(knocker_core_portscan_data_t *data , char const   *hostname ,
                                int family ) 
{ 
  int tmp ;

  {
  {
#line 410
  tmp = knocker_core_gethostbyname(& data->host, hostname, family);
  }
#line 410
  if (tmp == -1) {
#line 411
    return ((char *)((void *)0));
  } else {
#line 413
    return (data->host.ip);
  }
}
}
#line 421 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_init_host_data(knocker_core_host_t *host ) 
{ 


  {
  {
#line 423
  knocker_core_set_host_name_string(host, (char const   *)((void *)0));
#line 424
  knocker_core_set_host_ip_string(host, (char const   *)((void *)0));
  }
#line 426
  return (0);
}
}
#line 435 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_free_host_data(knocker_core_host_t *host ) 
{ 


  {
  {
#line 437
  knocker_core_free_host_name_string(host);
#line 438
  knocker_core_free_host_ip_string(host);
  }
#line 439
  return;
}
}
#line 447 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_init_port_data(knocker_core_port_t *port ) 
{ 
  int i ;

  {
#line 451
  i = 0;
  {
#line 451
  while (1) {
    while_continue: /* CIL Label */ ;
#line 451
    if (! (i < 65535)) {
#line 451
      goto while_break;
    }
#line 453
    (port + i)->number = 0U;
#line 454
    (port + i)->status = 0;
#line 455
    (port + i)->protocol = 0;
#line 456
    (port + i)->service = (char *)((void *)0);
#line 451
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 459
  return (0);
}
}
#line 466 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_free_port_data(knocker_core_port_t *port ) 
{ 
  int i ;

  {
#line 470
  i = 0;
  {
#line 470
  while (1) {
    while_continue: /* CIL Label */ ;
#line 470
    if (! (i < 65535)) {
#line 470
      goto while_break;
    }
#line 472
    (port + i)->number = 0U;
#line 473
    (port + i)->status = 0;
#line 474
    (port + i)->protocol = 0;
#line 476
    if ((unsigned long )(port + i)->service != (unsigned long )((void *)0)) {
      {
#line 478
      free((void *)(port + i)->service);
      }
    }
#line 470
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 481
  return;
}
}
#line 488 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_init_socket_data(knocker_core_socket_t *sock ) 
{ 


  {
#line 490
  if (sock->active == 1) {
    {
#line 491
    knocker_core_close_socket(sock);
    }
  }
#line 493
  sock->protocol = 0;
#line 494
  sock->active = 0;
#line 496
  return (0);
}
}
#line 504 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_free_socket_data(knocker_core_socket_t *sock ) 
{ 


  {
  {
#line 506
  knocker_core_init_socket_data(sock);
  }
#line 507
  return;
}
}
#line 513 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_open_socket(knocker_core_socket_t *sock , int family , int protocol ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
#line 518
  if (protocol == 2) {
    {
#line 520
    tmp = socket(family, 1, 0);
#line 520
    sock->fd = tmp;
    }
#line 520
    if (tmp == -1) {
#line 526
      return (-1);
    }
  } else
#line 529
  if (protocol == 1) {
    {
#line 531
    tmp___0 = socket(family, 2, 0);
#line 531
    sock->fd = tmp___0;
    }
#line 531
    if (tmp___0 == -1) {
#line 537
      return (-1);
    }
  } else {
#line 541
    return (-1);
  }
#line 543
  sock->protocol = protocol;
#line 544
  sock->active = 1;
#line 550
  return (0);
}
}
#line 557 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_close_socket(knocker_core_socket_t *sock ) 
{ 


  {
#line 563
  if (sock->active == 0) {
#line 564
    return;
  }
  {
#line 569
  close(sock->fd);
#line 572
  sock->active = 0;
#line 573
  sock->protocol = 0;
  }
#line 579
  return;
}
}
#line 586 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_gethostbyname(knocker_core_host_t *hinfo , char const   *hostname ,
                                      int family ) 
{ 
  struct addrinfo hints ;
  struct addrinfo *res ;
  struct addrinfo *ai ;
  char hostip[46] ;
  int err ;
  int fd ;

  {
  {
#line 592
  memset((void *)(& hints), 0, sizeof(hints));
#line 593
  hints.ai_family = family;
#line 594
  hints.ai_flags = 32;
#line 596
  err = getaddrinfo((char const   */* __restrict  */)hostname, (char const   */* __restrict  */)((void *)0),
                    (struct addrinfo  const  */* __restrict  */)(& hints), (struct addrinfo **/* __restrict  */)(& res));
  }
#line 596
  if (err) {
#line 600
    return (-1);
  }
#line 603
  ai = res;
  {
#line 603
  while (1) {
    while_continue: /* CIL Label */ ;
#line 603
    if (! ai) {
#line 603
      goto while_break;
    }
#line 604
    if (ai->ai_family != 2) {
#line 604
      if (ai->ai_family != 10) {
#line 605
        goto __Cont;
      }
    }
    {
#line 607
    fd = socket(ai->ai_family, ai->ai_socktype, ai->ai_protocol);
    }
#line 608
    if (fd < 0) {
#line 609
      goto __Cont;
    }
    {
#line 611
    close(fd);
#line 612
    hinfo->addrlen = ai->ai_addrlen;
#line 613
    memcpy((void */* __restrict  */)(& hinfo->hostaddr), (void const   */* __restrict  */)ai->ai_addr,
           (size_t )ai->ai_addrlen);
    }
#line 614
    goto while_break;
    __Cont: /* CIL Label */ 
#line 603
    ai = ai->ai_next;
  }
  while_break: /* CIL Label */ ;
  }
#line 617
  if (res) {
    {
#line 618
    freeaddrinfo(res);
    }
  }
#line 620
  if ((unsigned long )ai == (unsigned long )((void *)0)) {
#line 621
    return (-1);
  }
  {
#line 623
  knocker_core_set_host_name_string(hinfo, hostname);
#line 624
  getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& hinfo->hostaddr)),
              hinfo->addrlen, (char */* __restrict  */)(hostip), (socklen_t )sizeof(hostip),
              (char */* __restrict  */)((void *)0), (socklen_t )0, 1);
#line 626
  knocker_core_set_host_ip_string(hinfo, (char const   *)(hostip));
  }
#line 628
  return (0);
}
}
#line 635 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_getservbyport(char *service , unsigned int port , int protocol ) 
{ 
  struct servent *service_st ;
  uint16_t tmp ;
  uint16_t tmp___0 ;
  size_t tmp___1 ;

  {
#line 639
  if (protocol == 2) {
    {
#line 641
    tmp = htons((uint16_t )port);
#line 641
    service_st = getservbyport((int )tmp, "tcp");
    }
  } else
#line 643
  if (protocol == 1) {
    {
#line 645
    tmp___0 = htons((uint16_t )port);
#line 645
    service_st = getservbyport((int )tmp___0, "udp");
    }
  } else {
#line 648
    return (-1);
  }
#line 651
  if (! service_st) {
#line 654
    service = (char *)((void *)0);
#line 655
    return (-1);
  } else {
    {
#line 659
    strcpy((char */* __restrict  */)service, (char const   */* __restrict  */)service_st->s_name);
    }
  }
  {
#line 662
  tmp___1 = strlen((char const   *)service_st->s_name);
  }
#line 662
  return ((int )tmp___1);
}
}
#line 672 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_set_host_name_string(knocker_core_host_t *hinfo , char const   *hostname ) 
{ 
  size_t tmp ;
  void *tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  int tmp___3 ;

  {
#line 674
  if ((unsigned long )hostname == (unsigned long )((void *)0)) {
#line 676
    hinfo->name = (char *)((void *)0);
#line 677
    return (0);
  }
#line 684
  if ((unsigned long )hinfo->name == (unsigned long )((void *)0)) {
    {
#line 686
    tmp = strlen(hostname);
#line 686
    tmp___0 = malloc(tmp + 1UL);
#line 686
    hinfo->name = (char *)tmp___0;
#line 687
    strcpy((char */* __restrict  */)hinfo->name, (char const   */* __restrict  */)hostname);
    }
  } else {
    {
#line 695
    tmp___3 = strcmp((char const   *)hinfo->name, hostname);
    }
#line 695
    if (tmp___3) {
      {
#line 697
      tmp___1 = strlen(hostname);
#line 697
      tmp___2 = realloc((void *)hinfo->name, tmp___1 + 1UL);
#line 697
      hinfo->name = (char *)tmp___2;
#line 698
      strcpy((char */* __restrict  */)hinfo->name, (char const   */* __restrict  */)hostname);
      }
    }
  }
#line 703
  return (0);
}
}
#line 711 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static int knocker_core_set_host_ip_string(knocker_core_host_t *hinfo , char const   *hostip ) 
{ 
  size_t tmp ;
  void *tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  int tmp___3 ;

  {
#line 713
  if ((unsigned long )hostip == (unsigned long )((void *)0)) {
#line 715
    hinfo->ip = (char *)((void *)0);
#line 716
    return (0);
  }
#line 723
  if ((unsigned long )hinfo->ip == (unsigned long )((void *)0)) {
    {
#line 725
    tmp = strlen(hostip);
#line 725
    tmp___0 = malloc(tmp + 1UL);
#line 725
    hinfo->ip = (char *)tmp___0;
#line 726
    strcpy((char */* __restrict  */)hinfo->ip, (char const   */* __restrict  */)hostip);
    }
  } else {
    {
#line 734
    tmp___3 = strcmp((char const   *)hinfo->ip, hostip);
    }
#line 734
    if (tmp___3) {
      {
#line 736
      tmp___1 = strlen(hostip);
#line 736
      tmp___2 = realloc((void *)hinfo->ip, tmp___1 + 1UL);
#line 736
      hinfo->ip = (char *)tmp___2;
#line 737
      strcpy((char */* __restrict  */)hinfo->ip, (char const   */* __restrict  */)hostip);
      }
    }
  }
#line 742
  return (0);
}
}
#line 749 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static char *knocker_core_get_host_name_string(knocker_core_host_t *hinfo ) 
{ 


  {
#line 751
  return (hinfo->name);
}
}
#line 758 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static char *knocker_core_get_host_ip_string(knocker_core_host_t *hinfo ) 
{ 


  {
#line 760
  return (hinfo->ip);
}
}
#line 768 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_free_host_name_string(knocker_core_host_t *hinfo ) 
{ 


  {
#line 770
  if ((unsigned long )hinfo->name != (unsigned long )((void *)0)) {
    {
#line 772
    free((void *)hinfo->name);
#line 773
    knocker_core_set_host_name_string(hinfo, (char const   *)((void *)0));
    }
  }
#line 775
  return;
}
}
#line 781 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.c"
static void knocker_core_free_host_ip_string(knocker_core_host_t *hinfo ) 
{ 


  {
#line 783
  if ((unsigned long )hinfo->ip != (unsigned long )((void *)0)) {
    {
#line 785
    free((void *)hinfo->ip);
#line 786
    knocker_core_set_host_ip_string(hinfo, (char const   *)((void *)0));
    }
  }
#line 789
  return;
}
}
#line 717 "/usr/include/stdlib.h"
extern int system(char const   *__command ) ;
#line 169 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 242
extern int fflush(FILE *__stream ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 61 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.h"
void knocker_term_clear(void) ;
#line 63
void knocker_term_set_color(int fg , int bg , int attrib ) ;
#line 64
void knocker_term_set_default_color(void) ;
#line 65
void knocker_term_reset(void) ;
#line 67
void knocker_term_fflush(FILE *fd ) ;
#line 69
void knocker_term_printf(char const   *buffer ) ;
#line 70
void knocker_term_fprintf(FILE *fd , char const   *buffer ) ;
#line 72
void knocker_term_color_printf(char const   *buffer , int color , int attrib ) ;
#line 73
void knocker_term_color_fprintf(FILE *fd , char const   *buffer , int color , int attrib ) ;
#line 75
void knocker_term_color_intprintf(int const   i , int color , int attrib ) ;
#line 76
void knocker_term_color_intfprintf(FILE *fd , int const   i , int color , int attrib ) ;
#line 39 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_clear(void) 
{ 


  {
#line 41
  if (knocker_args.quiet == 0) {
    {
#line 46
    system("clear");
    }
  }
#line 49
  return;
}
}
#line 55 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_set_default_color(void) 
{ 


  {
#line 57
  if (! knocker_args.quiet) {
#line 59
    if (knocker_args.colors == 1) {
      {
#line 65
      knocker_term_set_color(7, -2002, 0);
      }
    }
  }
#line 71
  return;
}
}
#line 78 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_reset(void) 
{ 


  {
  {
#line 80
  knocker_term_set_default_color();
  }
#line 92
  return;
}
}
#line 99 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_set_color(int fg , int bg , int attrib ) 
{ 
  char cmd_str[13] ;

  {
#line 101
  if (knocker_args.quiet == 0) {
#line 105
    if (knocker_args.colors == 1) {
#line 107
      if (bg == -2002) {
#line 107
        if (fg != -2002) {
          {
#line 113
          sprintf((char */* __restrict  */)(cmd_str), (char const   */* __restrict  */)"%c[%d;%dm",
                  27, attrib, fg + 30);
          }
        } else {
#line 107
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 116
      if (bg != -2002) {
#line 116
        if (fg == -2002) {
          {
#line 122
          sprintf((char */* __restrict  */)(cmd_str), (char const   */* __restrict  */)"%c[%d;%dm",
                  27, attrib, bg + 40);
          }
        } else {
#line 116
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 125
      if (bg == -2002) {
#line 125
        if (fg == -2002) {
          {
#line 129
          sprintf((char */* __restrict  */)(cmd_str), (char const   */* __restrict  */)"%c[%dm",
                  27, attrib);
          }
        } else {
          {
#line 138
          sprintf((char */* __restrict  */)(cmd_str), (char const   */* __restrict  */)"%c[%d;%d;%dm",
                  27, attrib, fg + 30, bg + 40);
          }
        }
      } else {
        {
#line 138
        sprintf((char */* __restrict  */)(cmd_str), (char const   */* __restrict  */)"%c[%d;%d;%dm",
                27, attrib, fg + 30, bg + 40);
        }
      }
      {
#line 141
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"%s",
              cmd_str);
      }
    }
  }
#line 146
  return;
}
}
#line 153 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_fflush(FILE *fd ) 
{ 


  {
#line 155
  if (knocker_args.quiet == 0) {
    {
#line 157
    fflush(fd);
    }
  }
#line 159
  return;
}
}
#line 165 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_printf(char const   *buffer ) 
{ 


  {
#line 167
  if (knocker_args.quiet == 0) {
    {
#line 169
    printf((char const   */* __restrict  */)"%s", buffer);
    }
  }
#line 173
  return;
}
}
#line 181 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_fprintf(FILE *fd , char const   *buffer ) 
{ 


  {
#line 183
  if (knocker_args.quiet == 0) {
    {
#line 185
    fprintf((FILE */* __restrict  */)fd, (char const   */* __restrict  */)"%s", buffer);
    }
  }
#line 188
  return;
}
}
#line 195 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_color_printf(char const   *buffer , int color , int attrib ) 
{ 


  {
#line 197
  if (knocker_args.quiet == 0) {
    {
#line 199
    knocker_term_set_color(color, -2002, attrib);
#line 203
    printf((char const   */* __restrict  */)"%s", buffer);
#line 205
    knocker_term_set_default_color();
    }
  }
#line 208
  return;
}
}
#line 215 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_color_fprintf(FILE *fd , char const   *buffer , int color , int attrib ) 
{ 


  {
#line 217
  if (knocker_args.quiet == 0) {
    {
#line 219
    knocker_term_set_color(color, -2002, attrib);
#line 223
    fprintf((FILE */* __restrict  */)fd, (char const   */* __restrict  */)"%s", buffer);
#line 225
    knocker_term_set_default_color();
    }
  }
#line 228
  return;
}
}
#line 235 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_color_intprintf(int const   i , int color , int attrib ) 
{ 


  {
#line 237
  if (knocker_args.quiet == 0) {
    {
#line 239
    knocker_term_set_color(color, -2002, attrib);
#line 243
    printf((char const   */* __restrict  */)"%d", i);
#line 245
    knocker_term_set_default_color();
    }
  }
#line 248
  return;
}
}
#line 255 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_term.c"
void knocker_term_color_intfprintf(FILE *fd , int const   i , int color , int attrib ) 
{ 


  {
#line 257
  if (knocker_args.quiet == 0) {
    {
#line 259
    knocker_term_set_color(color, -2002, attrib);
#line 263
    fprintf((FILE */* __restrict  */)fd, (char const   */* __restrict  */)"%d", i);
#line 265
    knocker_term_set_default_color();
    }
  }
#line 268
  return;
}
}
#line 170 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 519 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atexit)(void (*__func)(void) ) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 36 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.h"
FILE *knocker_log_fp  ;
#line 38
int knocker_log_open(char const   *filename ) ;
#line 39
void knocker_log_host_info(char *hostname_str , char *hostip_str ) ;
#line 40
void knocker_log_resolve_error(char *hostname_str ) ;
#line 41
void knocker_log_ports_info(int sp , int ep ) ;
#line 42
void knocker_log_open_port(int port , char *service_str ) ;
#line 43
void knocker_log_results(char *hostname_str , char *hostip_str , int tot_ps , int open_ps ,
                         char *secs ) ;
#line 45
void knocker_log_close(void) ;
#line 38 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.h"
int knocker_output_open(void) ;
#line 39
void knocker_output_host_info(char const   *hostname_str , char const   *hostip_str ) ;
#line 40
void knocker_output_resolve_error(char *hostname_str ) ;
#line 41
void knocker_output_ports_info(int sp , int ep ) ;
#line 42
void knocker_output_open_port(int port , char *service_str ) ;
#line 43
void knocker_output_results(char *hostname_str , char *hostname_ip , int tot_ps ,
                            int open_ps , char *secs ) ;
#line 108 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.h"
int knocker_args_init(knocker_args_t *args , int logfile , int quiet , int colors ) ;
#line 113
void knocker_args_free(knocker_args_t *args ) ;
#line 119
int knocker_args_parse(knocker_args_t *args , int argc , char **argv ) ;
#line 49 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
int KNOCKER_USER_COLOR  ;
#line 50 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
int KNOCKER_COLOR_1  ;
#line 51 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
int KNOCKER_COLOR_2  ;
#line 52 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
int KNOCKER_COLOR_1_ATTR  ;
#line 53 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
int KNOCKER_COLOR_2_ATTR  ;
#line 56
int knocker_conf_parse(void) ;
#line 57
int knocker_conf_write_default(void) ;
#line 33 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.h"
void knocker_time_start_timer(void) ;
#line 34
double knocker_time_get_ticks(void) ;
#line 36 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.h"
int init_knocker_core_services_db(void) ;
#line 37
void free_knocker_core_services_db(void) ;
#line 39
char *knocker_core_services_db_get_service(unsigned int port , int protocol ) ;
#line 45 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
int total_open_ports  =    0;
#line 46 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
int total_scanned_ports  =    0;
#line 48 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
double elapsed_time  ;
#line 50 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
knocker_core_portscan_data_t pscan_data  ;
#line 56 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
static void init(int argc , char **argv ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 58
  knocker_core_init();
#line 60
  tmp = init_knocker_core_services_db();
  }
#line 60
  if (tmp < 0) {
    {
#line 62
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: Error allocating services strings memory. Fatal.\n",
            "knocker");
#line 63
    exit(1);
    }
  }
  {
#line 66
  knocker_user_init(& knocker_user);
#line 68
  knocker_args_init(& knocker_args, 0, 0, 1);
#line 70
  tmp___0 = knocker_conf_parse();
  }
#line 70
  if (tmp___0 < 0) {
    {
#line 72
    knocker_conf_write_default();
    }
  }
  {
#line 74
  knocker_args_parse(& knocker_args, argc, argv);
#line 76
  knocker_core_init_portscan_data(& pscan_data);
  }
#line 78
  if (knocker_args.fency) {
    {
#line 79
    knocker_term_clear();
    }
  }
  {
#line 81
  knocker_output_open();
#line 83
  knocker_term_fprintf(stdout, "\n");
#line 86
  tmp___1 = knocker_log_open((char const   *)knocker_args.lfname);
  }
#line 86
  if (tmp___1 < 0) {
    {
#line 88
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: error, couldn\'t open the log file (%s)\n",
            "knocker", "knocker_scan.log");
#line 89
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"(You might not have write permission on the current directory.)\n");
#line 90
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Knocker portscan aborted.\n");
#line 92
    knocker_args_free(& knocker_args);
#line 93
    knocker_core_free_portscan_data(& pscan_data);
#line 94
    knocker_core_quit();
#line 95
    exit(1);
    }
  }
#line 97
  return;
}
}
#line 103 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
static void quit(void) 
{ 


  {
  {
#line 105
  knocker_log_close();
#line 107
  knocker_args_free(& knocker_args);
#line 109
  knocker_user_free(& knocker_user);
#line 111
  knocker_core_free_portscan_data(& pscan_data);
#line 113
  free_knocker_core_services_db();
#line 124
  knocker_term_reset();
#line 126
  knocker_core_quit();
  }
#line 127
  return;
}
}
#line 133 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
static void resolve(void) 
{ 
  char *tmp ;

  {
  {
#line 135
  tmp = knocker_core_resolve_host(& pscan_data, (char const   *)knocker_args.hname,
                                  knocker_args.hfamily);
  }
#line 135
  if ((unsigned long )tmp == (unsigned long )((void *)0)) {
    {
#line 137
    knocker_output_resolve_error(knocker_args.hname);
#line 138
    knocker_log_resolve_error(knocker_args.hname);
#line 139
    quit();
#line 140
    exit(1);
    }
  }
  {
#line 143
  knocker_core_get_hostname(& pscan_data);
#line 144
  knocker_core_get_hostip(& pscan_data);
#line 146
  knocker_output_host_info((char const   *)knocker_core_last_hostname, (char const   *)knocker_core_last_hostip);
#line 147
  knocker_log_host_info(knocker_core_last_hostname, knocker_core_last_hostip);
  }
#line 148
  return;
}
}
#line 157 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
static void portscan(void) 
{ 
  int tmp ;
  int port ;
  char *tmp___0 ;
  int tmp___1 ;
  int port___0 ;
  char *tmp___2 ;
  int tmp___3 ;
  int port___1 ;
  char *tmp___4 ;
  int tmp___5 ;
  int port___2 ;
  char *tmp___6 ;
  int tmp___7 ;

  {
  {
#line 160
  knocker_term_fflush(stdout);
  }
#line 163
  if (knocker_args.port != 0U) {
    {
#line 166
    knocker_output_ports_info((int )knocker_args.port, (int )knocker_args.port);
#line 167
    knocker_log_ports_info((int )knocker_args.port, (int )knocker_args.port);
#line 169
    knocker_user_write_lastscan(& knocker_user, & knocker_args);
#line 171
    knocker_time_start_timer();
#line 173
    tmp = knocker_core_portscan_tcp_connnect(& pscan_data, knocker_args.port);
    }
#line 173
    if (tmp == 2) {
      {
#line 179
      knocker_core_get_service(knocker_args.port, 2);
#line 181
      knocker_output_open_port((int )knocker_args.port, knocker_core_last_service);
#line 182
      knocker_log_open_port((int )knocker_args.port, knocker_core_last_service);
      }
    }
    {
#line 185
    elapsed_time = knocker_time_get_ticks();
#line 187
    total_scanned_ports = 1;
    }
#line 188
    return;
  } else
#line 191
  if (knocker_args.sport == 0U) {
#line 191
    if (knocker_args.eport == 0U) {
      {
#line 195
      knocker_args.sport = 1U;
#line 196
      knocker_args.eport = 1024U;
#line 198
      knocker_output_ports_info((int )knocker_args.sport, (int )knocker_args.eport);
#line 199
      knocker_log_ports_info((int )knocker_args.sport, (int )knocker_args.eport);
#line 201
      knocker_user_write_lastscan(& knocker_user, & knocker_args);
#line 203
      knocker_time_start_timer();
#line 205
      port = (int )knocker_args.sport;
      }
      {
#line 205
      while (1) {
        while_continue: /* CIL Label */ ;
#line 205
        if (! ((unsigned int )port <= knocker_args.eport)) {
#line 205
          goto while_break;
        }
        {
#line 207
        tmp___1 = knocker_core_portscan_tcp_connnect(& pscan_data, (unsigned int )port);
        }
#line 207
        if (tmp___1 == 2) {
          {
#line 209
          total_open_ports ++;
#line 215
          tmp___0 = knocker_core_get_service((unsigned int )port, 2);
          }
#line 215
          if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
            {
#line 217
            knocker_core_services_db_get_service((unsigned int )port, 2);
            }
          }
          {
#line 221
          knocker_term_fflush(stdout);
#line 223
          knocker_output_open_port(port, knocker_core_last_service);
#line 224
          knocker_log_open_port(port, knocker_core_last_service);
          }
        }
#line 205
        port ++;
      }
      while_break: /* CIL Label */ ;
      }
      {
#line 229
      elapsed_time = knocker_time_get_ticks();
#line 231
      total_scanned_ports = port;
      }
#line 232
      return;
    }
  }
  {
#line 235
  knocker_output_ports_info((int )knocker_args.sport, (int )knocker_args.eport);
#line 236
  knocker_log_ports_info((int )knocker_args.sport, (int )knocker_args.eport);
  }
#line 238
  if (knocker_args.sport == knocker_args.eport) {
#line 238
    if (knocker_args.sport != 0U) {
#line 238
      if (knocker_args.eport != 0U) {
        {
#line 240
        port___0 = (int )knocker_args.sport;
#line 242
        knocker_user_write_lastscan(& knocker_user, & knocker_args);
#line 244
        knocker_time_start_timer();
#line 246
        tmp___3 = knocker_core_portscan_tcp_connnect(& pscan_data, (unsigned int )port___0);
        }
#line 246
        if (tmp___3 == 2) {
          {
#line 252
          tmp___2 = knocker_core_get_service((unsigned int )port___0, 2);
          }
#line 252
          if ((unsigned long )tmp___2 == (unsigned long )((void *)0)) {
            {
#line 254
            knocker_core_services_db_get_service((unsigned int )port___0, 2);
            }
          }
          {
#line 258
          knocker_output_open_port(port___0, knocker_core_last_service);
#line 259
          knocker_log_open_port(port___0, knocker_core_last_service);
          }
        }
        {
#line 262
        elapsed_time = knocker_time_get_ticks();
#line 264
        total_scanned_ports = 1;
        }
#line 265
        return;
      } else {
#line 238
        goto _L___0;
      }
    } else {
#line 238
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 268
  if (knocker_args.sport > knocker_args.eport) {
    {
#line 270
    port___1 = 0;
#line 272
    knocker_user_write_lastscan(& knocker_user, & knocker_args);
#line 274
    knocker_time_start_timer();
#line 276
    port___1 = (int )knocker_args.sport;
    }
    {
#line 276
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 276
      if (! ((unsigned int )port___1 >= knocker_args.eport)) {
#line 276
        goto while_break___0;
      }
      {
#line 278
      tmp___5 = knocker_core_portscan_tcp_connnect(& pscan_data, (unsigned int )port___1);
      }
#line 278
      if (tmp___5 == 2) {
        {
#line 280
        total_open_ports ++;
#line 285
        tmp___4 = knocker_core_get_service((unsigned int )port___1, 2);
        }
#line 285
        if ((unsigned long )tmp___4 == (unsigned long )((void *)0)) {
          {
#line 287
          knocker_core_services_db_get_service((unsigned int )port___1, 2);
          }
        }
        {
#line 291
        knocker_output_open_port(port___1, knocker_core_last_service);
#line 292
        knocker_log_open_port(port___1, knocker_core_last_service);
        }
      }
#line 276
      port___1 --;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 296
    elapsed_time = knocker_time_get_ticks();
#line 298
    total_scanned_ports = (int )(knocker_args.sport - (unsigned int )port___1);
    }
#line 299
    return;
  } else {
    {
#line 306
    knocker_user_write_lastscan(& knocker_user, & knocker_args);
#line 308
    knocker_time_start_timer();
#line 310
    port___2 = (int )knocker_args.sport;
    }
    {
#line 310
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 310
      if (! ((unsigned int )port___2 <= knocker_args.eport)) {
#line 310
        goto while_break___1;
      }
      {
#line 318
      tmp___7 = knocker_core_portscan_tcp_connnect(& pscan_data, (unsigned int )port___2);
      }
#line 318
      if (tmp___7 == 2) {
        {
#line 320
        total_open_ports ++;
#line 325
        tmp___6 = knocker_core_get_service((unsigned int )port___2, 2);
        }
#line 325
        if ((unsigned long )tmp___6 == (unsigned long )((void *)0)) {
          {
#line 327
          knocker_core_services_db_get_service((unsigned int )port___2, 2);
          }
        }
        {
#line 331
        knocker_output_open_port(port___2, knocker_core_last_service);
#line 332
        knocker_log_open_port(port___2, knocker_core_last_service);
        }
      }
#line 310
      port___2 ++;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
#line 336
    elapsed_time = knocker_time_get_ticks();
#line 338
    total_scanned_ports = (int )((unsigned int )port___2 - knocker_args.sport);
    }
#line 339
    return;
  }
#line 341
  return;
}
}
#line 351 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
static void results(void) 
{ 
  char timestr[80] ;

  {
  {
#line 355
  elapsed_time /= (double )1000;
#line 356
  sprintf((char */* __restrict  */)(timestr), (char const   */* __restrict  */)"%.2f",
          elapsed_time);
#line 358
  knocker_output_results(knocker_core_last_hostname, knocker_core_last_hostip, total_scanned_ports,
                         total_open_ports, timestr);
#line 359
  knocker_log_results(knocker_core_last_hostname, knocker_core_last_hostip, total_scanned_ports,
                      total_open_ports, timestr);
  }
#line 360
  return;
}
}
#line 367 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_main.c"
int main(int argc , char **argv ) 
{ 


  {
  {
#line 369
  init(argc, argv);
#line 371
  atexit(& quit);
#line 373
  resolve();
#line 375
  portscan();
#line 377
  results();
  }
#line 379
  return (0);
}
}
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 264
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) ctime)(time_t const   *__timer ) ;
#line 34 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
char const   knocker_header[12][90]  = 
#line 34 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
  { {        (char const   )'+',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'-',        (char const   )'-', 
            (char const   )'-',        (char const   )'-',        (char const   )'+',        (char const   )'\n', 
            (char const   )'\000'}, 
   {        (char const   )'|',        (char const   )'-',        (char const   )'-',        (char const   )'=', 
            (char const   )'|',        (char const   )'\000'}, 
   {        (char const   )' ',        (char const   )'k',        (char const   )' ',        (char const   )'n', 
            (char const   )' ',        (char const   )'o',        (char const   )' ',        (char const   )'c', 
            (char const   )' ',        (char const   )'k',        (char const   )' ',        (char const   )'e', 
            (char const   )' ',        (char const   )'r',        (char const   )' ',        (char const   )'\000'}, 
   {        (char const   )'-',        (char const   )'-',        (char const   )'\000'}, 
   {        (char const   )' ',        (char const   )'t',        (char const   )' ',        (char const   )'h', 
            (char const   )' ',        (char const   )'e',        (char const   )' ',        (char const   )'\000'}, 
   {        (char const   )'-',        (char const   )'-',        (char const   )'\000'}, 
   {        (char const   )' ',        (char const   )'n',        (char const   )' ',        (char const   )'e', 
            (char const   )' ',        (char const   )'t',        (char const   )' ',        (char const   )'\000'}, 
   {        (char const   )'-',        (char const   )'-',        (char const   )'\000'}, 
   {        (char const   )' ',        (char const   )'p',        (char const   )' ',        (char const   )'o', 
            (char const   )' ',        (char const   )'r',        (char const   )' ',        (char const   )'t', 
            (char const   )' ',        (char const   )'s',        (char const   )' ',        (char const   )'c', 
            (char const   )' ',        (char const   )'a',        (char const   )' ',        (char const   )'n', 
            (char const   )' ',        (char const   )'n',        (char const   )' ',        (char const   )'e', 
            (char const   )' ',        (char const   )'r',        (char const   )' ',        (char const   )'\000'}, 
   {        (char const   )'|',        (char const   )'=',        (char const   )'-',        (char const   )'=', 
            (char const   )'[',        (char const   )' ',        (char const   )'\000'}, 
   {        (char const   )'0',        (char const   )'.',        (char const   )'7',        (char const   )'.', 
            (char const   )'1',        (char const   )'\000'}, 
   {        (char const   )' ',        (char const   )']',        (char const   )'=',        (char const   )'-', 
            (char const   )'|',        (char const   )'\n',        (char const   )'\000'}};
#line 41 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
char *knocker_time  ;
#line 47 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
int knocker_output_open(void) 
{ 
  time_t timenow ;

  {
#line 51
  if (! knocker_args.fency) {
#line 52
    return (0);
  }
  {
#line 56
  time(& timenow);
#line 57
  knocker_time = ctime((time_t const   *)(& timenow));
#line 59
  knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 62
  knocker_term_color_fprintf(stdout, knocker_header[0], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 63
  knocker_term_color_fprintf(stdout, knocker_header[1], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 64
  knocker_term_color_fprintf(stdout, knocker_header[2], KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 65
  knocker_term_color_fprintf(stdout, knocker_header[3], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 66
  knocker_term_color_fprintf(stdout, knocker_header[4], KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 67
  knocker_term_color_fprintf(stdout, knocker_header[5], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 68
  knocker_term_color_fprintf(stdout, knocker_header[6], KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 69
  knocker_term_color_fprintf(stdout, knocker_header[7], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 70
  knocker_term_color_fprintf(stdout, knocker_header[8], KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 71
  knocker_term_color_fprintf(stdout, knocker_header[9], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 72
  knocker_term_color_fprintf(stdout, knocker_header[10], KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 73
  knocker_term_color_fprintf(stdout, knocker_header[11], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 74
  knocker_term_color_fprintf(stdout, knocker_header[0], KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
  }
#line 77
  if ((unsigned long )knocker_user.name != (unsigned long )((void *)0)) {
    {
#line 79
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 80
    knocker_term_color_fprintf(stdout, " - ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 81
    knocker_term_color_fprintf(stdout, "started by user ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 82
    knocker_term_color_fprintf(stdout, (char const   *)knocker_user.name, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 83
    knocker_term_color_fprintf(stdout, " on ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 84
    knocker_term_color_fprintf(stdout, (char const   *)knocker_time, KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
    }
  } else {
    {
#line 88
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 89
    knocker_term_color_fprintf(stdout, " - ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 90
    knocker_term_color_fprintf(stdout, "started on ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 91
    knocker_term_color_fprintf(stdout, (char const   *)knocker_time, KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
    }
  }
  {
#line 94
  fflush(stdout);
  }
#line 96
  return (0);
}
}
#line 105 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
void knocker_output_host_info(char const   *hostname_str , char const   *hostip_str ) 
{ 


  {
#line 107
  if (knocker_args.fency) {
    {
#line 109
    knocker_term_color_fprintf(stdout, " - ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 110
    knocker_term_color_fprintf(stdout, "hostname to scan: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 111
    knocker_term_color_fprintf(stdout, hostname_str, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 112
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 114
    knocker_term_color_fprintf(stdout, " - ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 115
    knocker_term_color_fprintf(stdout, "resolved host ip: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 116
    knocker_term_color_fprintf(stdout, hostip_str, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 117
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  } else {
    {
#line 121
    knocker_term_color_fprintf(stdout, "Host: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 122
    knocker_term_color_fprintf(stdout, hostname_str, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 123
    knocker_term_color_fprintf(stdout, " resolved: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 124
    knocker_term_color_fprintf(stdout, hostip_str, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 125
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  }
  {
#line 127
  fflush(stdout);
  }
#line 128
  return;
}
}
#line 135 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
void knocker_output_resolve_error(char *hostname_str ) 
{ 


  {
#line 137
  if (knocker_args.fency) {
    {
#line 139
    knocker_term_color_fprintf(stdout, " - ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 140
    knocker_term_color_fprintf(stdout, "failed to resolve given hostname/IP: ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 141
    knocker_term_color_fprintf(stdout, (char const   *)hostname_str, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 142
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 143
    knocker_term_color_fprintf(stdout, " - Aborting\n\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  } else {
    {
#line 147
    knocker_term_color_fprintf(stdout, "Failed to resolve hostname/IP: ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 148
    knocker_term_color_fprintf(stdout, (char const   *)hostname_str, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 149
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  }
  {
#line 151
  fflush(stdout);
  }
#line 152
  return;
}
}
#line 158 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
void knocker_output_ports_info(int sp , int ep ) 
{ 


  {
#line 160
  if (! knocker_args.fency) {
    {
#line 162
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
    }
#line 163
    return;
  }
  {
#line 165
  knocker_term_color_fprintf(stdout, " - - scan from port: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 166
  knocker_term_color_intfprintf(stdout, (int const   )sp, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 167
  knocker_term_color_fprintf(stdout, "\n - - - scan to port: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 168
  knocker_term_color_intfprintf(stdout, (int const   )ep, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 169
  knocker_term_color_fprintf(stdout, "\n - - - -  scan type: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 170
  knocker_term_color_fprintf(stdout, "tcp connect", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 171
  knocker_term_color_fprintf(stdout, "\n\n+=- - - - - - - - - - - - - - - - - - - - - - - - - - - - - ",
                             KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 173
  knocker_term_color_fprintf(stdout, " s c a n n i n g ", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 174
  knocker_term_color_fprintf(stdout, " -\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 175
  knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 177
  fflush(stdout);
  }
#line 178
  return;
}
}
#line 184 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
void knocker_output_open_port(int port , char *service_str ) 
{ 


  {
#line 186
  if (knocker_args.fency) {
    {
#line 188
    knocker_term_color_fprintf(stdout, " -=[ ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 189
    knocker_term_color_intfprintf(stdout, (int const   )port, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 190
    knocker_term_color_fprintf(stdout, "/", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 191
    knocker_term_color_fprintf(stdout, "tcp", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 192
    knocker_term_color_fprintf(stdout, ", ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 193
    knocker_term_color_fprintf(stdout, (char const   *)service_str, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 194
    knocker_term_color_fprintf(stdout, " ]=-", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 195
    knocker_term_color_fprintf(stdout, " * ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 196
    knocker_term_color_fprintf(stdout, "OPEN", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 197
    knocker_term_color_fprintf(stdout, " *\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  } else {
    {
#line 201
    knocker_term_color_intfprintf(stdout, (int const   )port, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 202
    knocker_term_color_fprintf(stdout, "/", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 203
    knocker_term_color_fprintf(stdout, "tcp", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 204
    knocker_term_color_fprintf(stdout, ", ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 205
    knocker_term_color_fprintf(stdout, (char const   *)service_str, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 206
    knocker_term_color_fprintf(stdout, ", ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 207
    knocker_term_color_fprintf(stdout, "open", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 208
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  }
  {
#line 210
  fflush(stdout);
  }
#line 211
  return;
}
}
#line 217 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_output.c"
void knocker_output_results(char *hostname_str , char *hostname_ip , int tot_ps ,
                            int open_ps , char *secs ) 
{ 


  {
#line 219
  if (knocker_args.fency) {
    {
#line 221
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 222
    knocker_term_color_fprintf(stdout, "+=- - - - - - - - - - - - - - - - - - - - - - - - - - - - ",
                               KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 224
    knocker_term_color_fprintf(stdout, " c o m p l e t e d ", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 225
    knocker_term_color_fprintf(stdout, " -\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 226
    knocker_term_color_fprintf(stdout, " - scanned host name: ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 227
    knocker_term_color_fprintf(stdout, (char const   *)hostname_str, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 228
    knocker_term_color_fprintf(stdout, " IP: ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 229
    knocker_term_color_fprintf(stdout, (char const   *)hostname_ip, KNOCKER_COLOR_2,
                               KNOCKER_COLOR_2_ATTR);
#line 231
    knocker_term_color_fprintf(stdout, "\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 232
    knocker_term_color_fprintf(stdout, " - found ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 233
    knocker_term_color_intfprintf(stdout, (int const   )open_ps, KNOCKER_COLOR_2,
                                  KNOCKER_COLOR_2_ATTR);
#line 234
    knocker_term_color_fprintf(stdout, " open ports in a total of ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 235
    knocker_term_color_intfprintf(stdout, (int const   )tot_ps, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 236
    knocker_term_color_fprintf(stdout, " ports scanned.\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 237
    knocker_term_color_fprintf(stdout, " - port scan completed in ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 238
    knocker_term_color_fprintf(stdout, (char const   *)secs, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 239
    knocker_term_color_fprintf(stdout, " seconds.\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  } else {
    {
#line 243
    knocker_term_color_fprintf(stdout, "\n", KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 244
    knocker_term_color_fprintf(stdout, "Found ", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 245
    knocker_term_color_intfprintf(stdout, (int const   )open_ps, KNOCKER_COLOR_2,
                                  KNOCKER_COLOR_2_ATTR);
#line 246
    knocker_term_color_fprintf(stdout, " open ports in a total of ", KNOCKER_COLOR_1,
                               KNOCKER_COLOR_1_ATTR);
#line 247
    knocker_term_color_intfprintf(stdout, (int const   )tot_ps, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 248
    knocker_term_color_fprintf(stdout, " ports scanned (", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
#line 249
    knocker_term_color_fprintf(stdout, (char const   *)secs, KNOCKER_COLOR_2, KNOCKER_COLOR_2_ATTR);
#line 250
    knocker_term_color_fprintf(stdout, " secs).\n\n", KNOCKER_COLOR_1, KNOCKER_COLOR_1_ATTR);
    }
  }
  {
#line 253
  fflush(stdout);
  }
#line 254
  return;
}
}
#line 35 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.h"
void knocker_time_delay(unsigned long ms ) ;
#line 71 "/usr/include/x86_64-linux-gnu/sys/time.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) gettimeofday)(struct timeval * __restrict  __tv ,
                                                                                                   __timezone_ptr_t __tz ) ;
#line 40 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.c"
static struct timeval timer_start  ;
#line 44 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.c"
void knocker_time_start_timer(void) 
{ 


  {
  {
#line 50
  gettimeofday((struct timeval */* __restrict  */)(& timer_start), (__timezone_ptr_t )((void *)0));
  }
#line 52
  return;
}
}
#line 54 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.c"
double knocker_time_get_ticks(void) 
{ 
  double ticks ;
  struct timeval timer_now ;

  {
  {
#line 65
  gettimeofday((struct timeval */* __restrict  */)(& timer_now), (__timezone_ptr_t )((void *)0));
#line 66
  ticks = (double )((timer_now.tv_sec - timer_start.tv_sec) * 1000L + (timer_now.tv_usec - timer_start.tv_usec) / 1000L);
  }
#line 68
  return (ticks);
}
}
#line 72 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_time.c"
void knocker_time_delay(unsigned long ms ) 
{ 


  {
#line 133
  return;
}
}
#line 44 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.h"
void knocker_log_cancelled(void) ;
#line 30 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
char const   knocker_log_header[241]  = 
#line 30 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
  {      (char const   )'+',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'+',      (char const   )'\n', 
        (char const   )'|',      (char const   )'-',      (char const   )'-',      (char const   )'=', 
        (char const   )'|',      (char const   )' ',      (char const   )'k',      (char const   )' ', 
        (char const   )'n',      (char const   )' ',      (char const   )'o',      (char const   )' ', 
        (char const   )'c',      (char const   )' ',      (char const   )'k',      (char const   )' ', 
        (char const   )'e',      (char const   )' ',      (char const   )'r',      (char const   )' ', 
        (char const   )'-',      (char const   )'-',      (char const   )' ',      (char const   )'t', 
        (char const   )' ',      (char const   )'h',      (char const   )' ',      (char const   )'e', 
        (char const   )' ',      (char const   )'-',      (char const   )'-',      (char const   )' ', 
        (char const   )'n',      (char const   )' ',      (char const   )'e',      (char const   )' ', 
        (char const   )'t',      (char const   )' ',      (char const   )'-',      (char const   )'-', 
        (char const   )' ',      (char const   )'p',      (char const   )' ',      (char const   )'o', 
        (char const   )' ',      (char const   )'r',      (char const   )' ',      (char const   )'t', 
        (char const   )' ',      (char const   )'s',      (char const   )' ',      (char const   )'c', 
        (char const   )' ',      (char const   )'a',      (char const   )' ',      (char const   )'n', 
        (char const   )' ',      (char const   )'n',      (char const   )' ',      (char const   )'e', 
        (char const   )' ',      (char const   )'r',      (char const   )' ',      (char const   )'|', 
        (char const   )'=',      (char const   )'-',      (char const   )'=',      (char const   )'[', 
        (char const   )'l',      (char const   )'o',      (char const   )'g',      (char const   )'f', 
        (char const   )'i',      (char const   )'l',      (char const   )'e',      (char const   )']', 
        (char const   )'=',      (char const   )'-',      (char const   )'|',      (char const   )'\n', 
        (char const   )'+',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'-',      (char const   )'-', 
        (char const   )'-',      (char const   )'-',      (char const   )'+',      (char const   )'\n', 
        (char const   )'\000'};
#line 39 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
int knocker_log_open(char const   *filename ) 
{ 
  time_t timenow ;

  {
#line 44
  if (knocker_args.logfile == 0) {
#line 45
    return (0);
  }
#line 47
  if ((unsigned long )filename == (unsigned long )((void *)0)) {
    {
#line 48
    knocker_log_fp = fopen((char const   */* __restrict  */)"knocker_scan.log", (char const   */* __restrict  */)"a");
    }
  } else {
    {
#line 50
    knocker_log_fp = fopen((char const   */* __restrict  */)filename, (char const   */* __restrict  */)"a");
    }
  }
#line 52
  if ((unsigned long )knocker_log_fp == (unsigned long )((void *)0)) {
#line 53
    return (-1);
  }
  {
#line 55
  time(& timenow);
#line 56
  knocker_time = ctime((time_t const   *)(& timenow));
#line 58
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"%s",
          knocker_log_header);
  }
#line 61
  if ((unsigned long )knocker_user.name != (unsigned long )((void *)0)) {
    {
#line 62
    fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - %s started by user %s on %s\n",
            "knocker", knocker_user.name, knocker_time);
    }
  } else {
    {
#line 64
    fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - %s started on %s\n",
            "knocker", knocker_time);
    }
  }
  {
#line 68
  fflush(knocker_log_fp);
  }
#line 70
  return (0);
}
}
#line 77 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_host_info(char *hostname_str , char *hostip_str ) 
{ 


  {
#line 80
  if (knocker_args.logfile == 0) {
#line 81
    return;
  }
  {
#line 83
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - hostname to scan: %s\n",
          hostname_str);
#line 84
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - resolved host ip: %s\n",
          hostip_str);
#line 86
  fflush(knocker_log_fp);
  }
#line 87
  return;
}
}
#line 94 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_resolve_error(char *hostname_str ) 
{ 


  {
#line 97
  if (knocker_args.logfile == 0) {
#line 98
    return;
  }
  {
#line 100
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - ERROR: failed to resolve hostname: %s\n",
          hostname_str);
#line 101
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - Aborting.\n");
#line 102
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"\n\n");
#line 104
  fclose(knocker_log_fp);
  }
#line 105
  return;
}
}
#line 111 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_ports_info(int sp , int ep ) 
{ 


  {
#line 114
  if (knocker_args.logfile == 0) {
#line 115
    return;
  }
  {
#line 117
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - - scan from port: %d\n",
          sp);
#line 118
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - - - scan to port: %d\n",
          ep);
#line 119
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - - - -  scan type: tcp connect\n");
#line 120
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"+=- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  s c a n n i n g  -\n");
#line 121
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"\n");
#line 123
  fflush(knocker_log_fp);
  }
#line 124
  return;
}
}
#line 130 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_open_port(int port , char *service_str ) 
{ 


  {
#line 133
  if (knocker_args.logfile == 0) {
#line 134
    return;
  }
  {
#line 136
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" -=[ %d/tcp, %s ]=- * OPEN *\n",
          port, service_str);
#line 137
  fflush(knocker_log_fp);
  }
#line 138
  return;
}
}
#line 144 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_results(char *hostname_str , char *hostip_str , int tot_ps , int open_ps ,
                         char *secs ) 
{ 


  {
#line 147
  if (knocker_args.logfile == 0) {
#line 148
    return;
  }
  {
#line 150
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"\n");
#line 151
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"+=- - - - - - - - - - - - - - - - - - - - - - - - - - - -  c o m p l e t e d  -\n\n");
#line 152
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - scanned host name: %s ",
          hostname_str);
#line 153
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"IP: %s\n\n",
          hostip_str);
#line 154
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - found %d open ports in a totoal of %d ports scanned.\n\n",
          open_ps, tot_ps);
#line 155
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)" - port scan completed in %s seconds.\n\n",
          secs);
#line 157
  fflush(knocker_log_fp);
  }
#line 158
  return;
}
}
#line 164 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_cancelled(void) 
{ 


  {
#line 167
  if (knocker_args.logfile == 0) {
#line 168
    return;
  }
  {
#line 170
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"- * port scan cancelled by user * -\n");
#line 171
  fflush(knocker_log_fp);
  }
#line 172
  return;
}
}
#line 178 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_log.c"
void knocker_log_close(void) 
{ 


  {
#line 181
  if (knocker_args.logfile == 0) {
#line 182
    return;
  }
#line 187
  if ((unsigned long )knocker_log_fp == (unsigned long )((void *)0)) {
#line 188
    return;
  }
  {
#line 190
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"- -- - - - = http://knocker.sourceforge.net - bugs to - <g.gabriele79@genie.it>\n");
#line 191
  fprintf((FILE */* __restrict  */)knocker_log_fp, (char const   */* __restrict  */)"\n\n\n\n");
#line 192
  fclose(knocker_log_fp);
  }
#line 194
  return;
}
}
#line 162 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
static char const   knocker_core_release_date[12]  = 
#line 162 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
  {      (char const   )'2',      (char const   )'4',      (char const   )' ',      (char const   )'M', 
        (char const   )'a',      (char const   )'y',      (char const   )' ',      (char const   )'2', 
        (char const   )'0',      (char const   )'0',      (char const   )'2',      (char const   )'\000'};
#line 165 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_core.h"
static char const   knocker_core_author_email[24]  = 
#line 165
  {      (char const   )'<',      (char const   )'g',      (char const   )'.',      (char const   )'g', 
        (char const   )'a',      (char const   )'b',      (char const   )'r',      (char const   )'i', 
        (char const   )'e',      (char const   )'l',      (char const   )'e',      (char const   )'7', 
        (char const   )'9',      (char const   )'@',      (char const   )'g',      (char const   )'e', 
        (char const   )'n',      (char const   )'i',      (char const   )'e',      (char const   )'.', 
        (char const   )'i',      (char const   )'t',      (char const   )'>',      (char const   )'\000'};
#line 55 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.h"
void knocker_conf_configure(void) ;
#line 33 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
static void knocker_args_validate(knocker_args_t *args , int argc , char **argv ) ;
#line 35 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
static int _have_last_host  =    0;
#line 42 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
static void print_version_info(void) 
{ 


  {
  {
#line 47
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"%s %s (%s)\n",
          "knocker", "0.7.1", knocker_core_release_date);
  }
#line 49
  return;
}
}
#line 56 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
static void print_help_info(void) 
{ 


  {
  {
#line 61
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"%s, the net portscanner. Version %s (%s)\n",
          "knocker", "0.7.1", knocker_core_release_date);
#line 64
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 65
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Usage: %s %s <HOST> [OPTIONS]\n",
          "knocker", "--host");
#line 66
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 67
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Example: %s %s 192.168.0.1 %s 1 %s 1024\n",
          "knocker", "-H", "-SP", "-EP");
#line 68
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 69
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Required options:\n");
#line 70
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s              host name or numeric Internet address\n",
          "-H", "--host");
#line 71
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"        or\n");
#line 72
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s              get the last scanned host name\n",
          "--last-host");
#line 73
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 74
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Common options (if SP is specified you must also give EP):\n");
#line 75
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s              single port number (for one port scans only)\n",
          "-P", "--port");
#line 77
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s, %s        port number to begin the scan from\n",
          "-SP", "--start-port");
#line 78
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s, %s          port number to end the scan at\n",
          "-EP", "--end-port");
#line 79
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 80
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s              performs again the last port scan\n",
          "--last-scan");
#line 81
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 82
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Extra options:\n");
#line 83
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s              only IPv4 host addressing\n",
          "-4", "--ipv4");
#line 84
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s              only IPv6 host addressing\n",
          "-6", "--ipv6");
#line 85
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s             quiet mode (no console output, logs to file)\n",
          "-q", "--quiet");
#line 86
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s, %s <logfile> log scan results to the specified file\n",
          "-lf", "--logfile");
#line 87
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s, %s          disable fancy output\n",
          "-nf", "--no-fency");
#line 88
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s, %s         disable colored output\n",
          "-nc", "--no-colors");
#line 89
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 90
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s              let you configure %s\n",
          "--configure", "knocker");
#line 91
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 92
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Info options:\n");
#line 93
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s              display this help and exit\n",
          "-h", "--help");
#line 94
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"      %s,  %s           output version information and exit\n",
          "-v", "--version");
#line 95
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 96
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"SEE THE MAN PAGE FOR MORE DESCRIPTIONS, AND EXAMPLES\n");
#line 97
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Report bugs to %s.\n",
          knocker_core_author_email);
  }
#line 98
  return;
}
}
#line 105 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
int knocker_args_init(knocker_args_t *args , int logfile , int quiet , int colors ) 
{ 


  {
#line 107
  args->hname = (char *)((void *)0);
#line 108
  args->hip = (char *)((void *)0);
#line 109
  args->lfname = (char *)((void *)0);
#line 110
  args->hfamily = 0;
#line 111
  args->port = 0U;
#line 112
  args->sport = 0U;
#line 113
  args->eport = 0U;
#line 114
  args->logfile = logfile;
#line 115
  args->quiet = quiet;
#line 116
  args->colors = colors;
#line 117
  args->fency = 1;
#line 119
  return (0);
}
}
#line 127 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
void knocker_args_free(knocker_args_t *args ) 
{ 


  {
#line 129
  if ((unsigned long )args->hname != (unsigned long )((void *)0)) {
    {
#line 130
    free((void *)args->hname);
    }
  }
#line 132
  if ((unsigned long )args->lfname != (unsigned long )((void *)0)) {
    {
#line 133
    free((void *)args->lfname);
    }
  }
#line 135
  if ((unsigned long )args->hip != (unsigned long )((void *)0)) {
    {
#line 136
    free((void *)args->hip);
    }
  }
#line 137
  return;
}
}
#line 155 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
int knocker_args_parse(knocker_args_t *args , int argc , char **argv ) 
{ 
  int i ;
  int tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  void *tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;
  int tmp___37 ;
  int tmp___38 ;
  int tmp___39 ;

  {
#line 159
  if ((unsigned long )*(argv + 1) == (unsigned long )((void *)0)) {
    {
#line 161
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: no arguments given\n",
            "knocker");
#line 162
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
            "knocker", "--help");
#line 163
    exit(1);
    }
  }
#line 166
  i = 1;
  {
#line 166
  while (1) {
    while_continue: /* CIL Label */ ;
#line 166
    if (! (i <= argc - 1)) {
#line 166
      goto while_break;
    }
    {
#line 168
    tmp___38 = strcmp((char const   *)*(argv + i), "-v");
    }
#line 168
    if (tmp___38) {
      {
#line 168
      tmp___39 = strcmp((char const   *)*(argv + i), "--version");
      }
#line 168
      if (tmp___39) {
        {
#line 173
        tmp___36 = strcmp((char const   *)*(argv + i), "-h");
        }
#line 173
        if (tmp___36) {
          {
#line 173
          tmp___37 = strcmp((char const   *)*(argv + i), "--help");
          }
#line 173
          if (tmp___37) {
            {
#line 178
            tmp___35 = strcmp((char const   *)*(argv + i), "--configure");
            }
#line 178
            if (tmp___35) {
              {
#line 183
              tmp___34 = strcmp((char const   *)*(argv + i), "--last-scan");
              }
#line 183
              if (tmp___34) {
                {
#line 195
                tmp___32 = strcmp((char const   *)*(argv + i), "-4");
                }
#line 195
                if (tmp___32) {
                  {
#line 195
                  tmp___33 = strcmp((char const   *)*(argv + i), "--ipv4");
                  }
#line 195
                  if (tmp___33) {
                    {
#line 200
                    tmp___30 = strcmp((char const   *)*(argv + i), "-6");
                    }
#line 200
                    if (tmp___30) {
                      {
#line 200
                      tmp___31 = strcmp((char const   *)*(argv + i), "--ipv6");
                      }
#line 200
                      if (tmp___31) {
                        {
#line 205
                        tmp___28 = strcmp((char const   *)*(argv + i), "-nf");
                        }
#line 205
                        if (tmp___28) {
                          {
#line 205
                          tmp___29 = strcmp((char const   *)*(argv + i), "--no-fency");
                          }
#line 205
                          if (tmp___29) {
                            {
#line 210
                            tmp___26 = strcmp((char const   *)*(argv + i), "-nc");
                            }
#line 210
                            if (tmp___26) {
                              {
#line 210
                              tmp___27 = strcmp((char const   *)*(argv + i), "--no-colors");
                              }
#line 210
                              if (tmp___27) {
                                {
#line 215
                                tmp___24 = strcmp((char const   *)*(argv + i), "-lf");
                                }
#line 215
                                if (tmp___24) {
                                  {
#line 215
                                  tmp___25 = strcmp((char const   *)*(argv + i), "--logfile");
                                  }
#line 215
                                  if (tmp___25) {
                                    {
#line 232
                                    tmp___22 = strcmp((char const   *)*(argv + i),
                                                      "-q");
                                    }
#line 232
                                    if (tmp___22) {
                                      {
#line 232
                                      tmp___23 = strcmp((char const   *)*(argv + i),
                                                        "--quiet");
                                      }
#line 232
                                      if (tmp___23) {
                                        {
#line 239
                                        tmp___21 = strcmp((char const   *)*(argv + i),
                                                          "--last-host");
                                        }
#line 239
                                        if (tmp___21) {
                                          {
#line 251
                                          tmp___19 = strcmp((char const   *)*(argv + i),
                                                            "-H");
                                          }
#line 251
                                          if (tmp___19) {
                                            {
#line 251
                                            tmp___20 = strcmp((char const   *)*(argv + i),
                                                              "--host");
                                            }
#line 251
                                            if (tmp___20) {
                                              {
#line 268
                                              tmp___17 = strcmp((char const   *)*(argv + i),
                                                                "-P");
                                              }
#line 268
                                              if (tmp___17) {
                                                {
#line 268
                                                tmp___18 = strcmp((char const   *)*(argv + i),
                                                                  "--port");
                                                }
#line 268
                                                if (tmp___18) {
                                                  {
#line 288
                                                  tmp___15 = strcmp((char const   *)*(argv + i),
                                                                    "-SP");
                                                  }
#line 288
                                                  if (tmp___15) {
                                                    {
#line 288
                                                    tmp___16 = strcmp((char const   *)*(argv + i),
                                                                      "--start-port");
                                                    }
#line 288
                                                    if (tmp___16) {
                                                      {
#line 307
                                                      tmp___13 = strcmp((char const   *)*(argv + i),
                                                                        "-EP");
                                                      }
#line 307
                                                      if (tmp___13) {
                                                        {
#line 307
                                                        tmp___14 = strcmp((char const   *)*(argv + i),
                                                                          "--end-port");
                                                        }
#line 307
                                                        if (tmp___14) {
                                                          {
#line 326
                                                          tmp___11 = strcmp((char const   *)*(argv + i),
                                                                            "--win32-frontend");
                                                          }
#line 326
                                                          if (tmp___11) {
                                                            {
#line 326
                                                            tmp___12 = strcmp((char const   *)*(argv + i),
                                                                              "--win32-frontend");
                                                            }
#line 326
                                                            if (tmp___12) {
                                                              {
#line 333
                                                              fprintf((FILE */* __restrict  */)stderr,
                                                                      (char const   */* __restrict  */)"%s: invalid argument given: \'%s\'\n",
                                                                      "knocker", *(argv + i));
#line 334
                                                              fprintf((FILE */* __restrict  */)stderr,
                                                                      (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                                                      "knocker", "--help");
#line 335
                                                              knocker_args_free(args);
#line 336
                                                              exit(1);
                                                              }
                                                            } else {
#line 329
                                                              args->win32_frontend = 1;
                                                            }
                                                          } else {
#line 329
                                                            args->win32_frontend = 1;
                                                          }
                                                        } else {
                                                          _L: /* CIL Label */ 
#line 309
                                                          i ++;
#line 309
                                                          if (i == argc) {
                                                            {
#line 311
                                                            fprintf((FILE */* __restrict  */)stderr,
                                                                    (char const   */* __restrict  */)"%s: error, no port number, where to scan to, given\n",
                                                                    "knocker");
#line 312
                                                            fprintf((FILE */* __restrict  */)stderr,
                                                                    (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                                                    "knocker", "--help");
#line 313
                                                            knocker_args_free(args);
#line 314
                                                            exit(1);
                                                            }
                                                          }
                                                          {
#line 317
                                                          tmp___9 = atoi((char const   *)*(argv + i));
#line 317
                                                          args->eport = (unsigned int )tmp___9;
#line 319
                                                          tmp___10 = knocker_core_validate_port_number(args->eport);
                                                          }
#line 319
                                                          if (! tmp___10) {
                                                            {
#line 321
                                                            fprintf((FILE */* __restrict  */)stderr,
                                                                    (char const   */* __restrict  */)"%s: error, invalid end port number `%d\' given\n",
                                                                    "knocker", args->eport);
#line 322
                                                            knocker_args_free(args);
#line 323
                                                            exit(1);
                                                            }
                                                          }
                                                        }
                                                      } else {
#line 307
                                                        goto _L;
                                                      }
                                                    } else {
                                                      _L___0: /* CIL Label */ 
#line 290
                                                      i ++;
#line 290
                                                      if (i == argc) {
                                                        {
#line 292
                                                        fprintf((FILE */* __restrict  */)stderr,
                                                                (char const   */* __restrict  */)"%s: error, no port number, where to start the scan from, given\n",
                                                                "knocker");
#line 293
                                                        fprintf((FILE */* __restrict  */)stderr,
                                                                (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                                                "knocker", "--help");
#line 294
                                                        knocker_args_free(args);
#line 295
                                                        exit(1);
                                                        }
                                                      }
                                                      {
#line 298
                                                      tmp___7 = atoi((char const   *)*(argv + i));
#line 298
                                                      args->sport = (unsigned int )tmp___7;
#line 300
                                                      tmp___8 = knocker_core_validate_port_number(args->sport);
                                                      }
#line 300
                                                      if (! tmp___8) {
                                                        {
#line 302
                                                        fprintf((FILE */* __restrict  */)stderr,
                                                                (char const   */* __restrict  */)"%s: error, invalid start port number `%d\' given\n",
                                                                "knocker", args->sport);
#line 303
                                                        knocker_args_free(args);
#line 304
                                                        exit(1);
                                                        }
                                                      }
                                                    }
                                                  } else {
#line 288
                                                    goto _L___0;
                                                  }
                                                } else {
                                                  _L___1: /* CIL Label */ 
#line 270
                                                  i ++;
#line 270
                                                  if (i == argc) {
                                                    {
#line 272
                                                    fprintf((FILE */* __restrict  */)stderr,
                                                            (char const   */* __restrict  */)"%s: error, no port number given\n",
                                                            "knocker");
#line 273
                                                    fprintf((FILE */* __restrict  */)stderr,
                                                            (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                                            "knocker", "--help");
#line 274
                                                    knocker_args_free(args);
#line 275
                                                    exit(1);
                                                    }
                                                  }
                                                  {
#line 278
                                                  tmp___5 = atoi((char const   *)*(argv + i));
#line 278
                                                  args->port = (unsigned int )tmp___5;
#line 280
                                                  tmp___6 = knocker_core_validate_port_number(args->port);
                                                  }
#line 280
                                                  if (! tmp___6) {
                                                    {
#line 282
                                                    fprintf((FILE */* __restrict  */)stderr,
                                                            (char const   */* __restrict  */)"%s: error, invalid port number `%d\' given\n",
                                                            "knocker", args->port);
#line 283
                                                    knocker_args_free(args);
#line 284
                                                    exit(1);
                                                    }
                                                  }
                                                }
                                              } else {
#line 268
                                                goto _L___1;
                                              }
                                            } else
                                            _L___2: /* CIL Label */ 
#line 253
                                            if (! _have_last_host) {
#line 255
                                              i ++;
#line 255
                                              if (i == argc) {
                                                {
#line 257
                                                fprintf((FILE */* __restrict  */)stderr,
                                                        (char const   */* __restrict  */)"%s: error, no host to scan given\n",
                                                        "knocker");
#line 258
                                                fprintf((FILE */* __restrict  */)stderr,
                                                        (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                                        "knocker", "--help");
#line 259
                                                knocker_args_free(args);
#line 260
                                                exit(1);
                                                }
                                              }
                                              {
#line 263
                                              tmp___3 = strlen((char const   *)*(argv + i));
#line 263
                                              tmp___4 = realloc((void *)args->hname,
                                                                tmp___3 + 1UL);
#line 263
                                              args->hname = (char *)tmp___4;
#line 264
                                              strcpy((char */* __restrict  */)args->hname,
                                                     (char const   */* __restrict  */)*(argv + i));
                                              }
                                            }
                                          } else {
#line 251
                                            goto _L___2;
                                          }
                                        } else {
                                          {
#line 242
                                          tmp___2 = knocker_user_read_lasthost(& knocker_user,
                                                                               args);
                                          }
#line 242
                                          if (tmp___2 < 0) {
                                            {
#line 244
                                            fprintf((FILE */* __restrict  */)stderr,
                                                    (char const   */* __restrict  */)"%s: couldn\'t find any \'lasthost\' record.\n",
                                                    "knocker");
#line 245
                                            fprintf((FILE */* __restrict  */)stderr,
                                                    (char const   */* __restrict  */)"This could be because you haven\'t performed a port scan yet.\n");
#line 246
                                            knocker_args_free(args);
#line 247
                                            exit(1);
                                            }
                                          }
#line 249
                                          _have_last_host = 1;
                                        }
                                      } else {
#line 235
                                        args->quiet = 1;
#line 236
                                        args->colors = 0;
#line 237
                                        args->logfile = 1;
                                      }
                                    } else {
#line 235
                                      args->quiet = 1;
#line 236
                                      args->colors = 0;
#line 237
                                      args->logfile = 1;
                                    }
                                  } else {
                                    _L___3: /* CIL Label */ 
#line 217
                                    i ++;
#line 217
                                    if (i == argc) {
                                      {
#line 219
                                      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: error, no logfile given\n",
                                              "knocker");
#line 220
                                      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
                                              "knocker", "--help");
#line 221
                                      knocker_args_free(args);
#line 222
                                      exit(1);
                                      }
                                    }
                                    {
#line 226
                                    tmp___0 = strlen((char const   *)*(argv + i));
#line 226
                                    tmp___1 = realloc((void *)args->lfname, tmp___0 + 1UL);
#line 226
                                    args->lfname = (char *)tmp___1;
#line 227
                                    strcpy((char */* __restrict  */)args->lfname,
                                           (char const   */* __restrict  */)*(argv + i));
#line 230
                                    args->logfile = 1;
                                    }
                                  }
                                } else {
#line 215
                                  goto _L___3;
                                }
                              } else {
#line 213
                                args->colors = 0;
                              }
                            } else {
#line 213
                              args->colors = 0;
                            }
                          } else {
#line 208
                            args->fency = 0;
                          }
                        } else {
#line 208
                          args->fency = 0;
                        }
                      } else {
#line 203
                        args->hfamily = 10;
                      }
                    } else {
#line 203
                      args->hfamily = 10;
                    }
                  } else {
#line 198
                    args->hfamily = 2;
                  }
                } else {
#line 198
                  args->hfamily = 2;
                }
              } else {
                {
#line 186
                tmp = knocker_user_read_lastscan(& knocker_user, args);
                }
#line 186
                if (tmp < 0) {
                  {
#line 188
                  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: couldn\'t find any last port scan record.\n",
                          "knocker");
#line 189
                  fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"This could be because you haven\'t performed a port scan yet.\n");
#line 190
                  knocker_args_free(args);
#line 191
                  exit(1);
                  }
                }
#line 193
                return (0);
              }
            } else {
              {
#line 180
              knocker_conf_configure();
#line 181
              exit(0);
              }
            }
          } else {
            {
#line 175
            print_help_info();
#line 176
            exit(0);
            }
          }
        } else {
          {
#line 175
          print_help_info();
#line 176
          exit(0);
          }
        }
      } else {
        {
#line 170
        print_version_info();
#line 171
        exit(0);
        }
      }
    } else {
      {
#line 170
      print_version_info();
#line 171
      exit(0);
      }
    }
#line 166
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 341
  knocker_args_validate(args, argc, argv);
  }
#line 343
  return (0);
}
}
#line 351 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_args.c"
static void knocker_args_validate(knocker_args_t *args , int argc , char **argv ) 
{ 
  int we_havegot_host ;
  int we_havegot_sp ;
  int we_havegot_ep ;
  int i ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 353
  we_havegot_host = 0;
#line 354
  we_havegot_sp = 0;
#line 355
  we_havegot_ep = 0;
#line 358
  i = 1;
  {
#line 358
  while (1) {
    while_continue: /* CIL Label */ ;
#line 358
    if (! (i <= argc - 1)) {
#line 358
      goto while_break;
    }
    {
#line 360
    tmp = strcmp((char const   *)*(argv + i), "-H");
    }
#line 360
    if (tmp) {
      {
#line 360
      tmp___0 = strcmp((char const   *)*(argv + i), "--host");
      }
#line 360
      if (tmp___0) {
        {
#line 360
        tmp___1 = strcmp((char const   *)*(argv + i), "--last-host");
        }
#line 360
        if (! tmp___1) {
#line 362
          we_havegot_host = 1;
#line 364
          _have_last_host = 0;
        }
      } else {
#line 362
        we_havegot_host = 1;
#line 364
        _have_last_host = 0;
      }
    } else {
#line 362
      we_havegot_host = 1;
#line 364
      _have_last_host = 0;
    }
    {
#line 366
    tmp___2 = strcmp((char const   *)*(argv + i), "-SP");
    }
#line 366
    if (tmp___2) {
      {
#line 366
      tmp___3 = strcmp((char const   *)*(argv + i), "--start-port");
      }
#line 366
      if (! tmp___3) {
#line 367
        we_havegot_sp = 1;
      }
    } else {
#line 367
      we_havegot_sp = 1;
    }
    {
#line 368
    tmp___4 = strcmp((char const   *)*(argv + i), "-EP");
    }
#line 368
    if (tmp___4) {
      {
#line 368
      tmp___5 = strcmp((char const   *)*(argv + i), "--end-port");
      }
#line 368
      if (! tmp___5) {
#line 369
        we_havegot_ep = 1;
      }
    } else {
#line 369
      we_havegot_ep = 1;
    }
#line 358
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 372
  if (! we_havegot_host) {
    {
#line 374
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: error, no host to scan given\n",
            "knocker");
#line 375
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"You must provide a host to scan with \'the %s <host>\' or \'%s <host>\' option.\n",
            "--host", "-H");
#line 376
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
            "knocker", "--help");
#line 377
    knocker_args_free(args);
#line 378
    exit(1);
    }
  }
#line 381
  if (we_havegot_sp) {
#line 381
    if (! we_havegot_ep) {
      {
#line 383
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: error, start port number given but no end port number. \n",
              "knocker");
#line 384
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"You must provide both a port number where to start the scan from and end\n");
#line 385
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"the scan to: %s <PORT> %s <PORT>\n",
              "--start-port", "--end-port");
#line 386
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
              "knocker", "--help");
#line 387
      knocker_args_free(args);
#line 388
      exit(1);
      }
    }
  }
#line 391
  if (! we_havegot_sp) {
#line 391
    if (we_havegot_ep) {
      {
#line 393
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: error, end port number given but no start port number. \n",
              "knocker");
#line 394
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"You must provide both a port number where to start the scan from and end\n");
#line 395
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"the scan to: %s <PORT> %s <PORT>\n",
              "--start-port", "--end-port");
#line 396
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Try `%s %s\' for more information.\n",
              "knocker", "--help");
#line 397
      knocker_args_free(args);
#line 398
      exit(1);
      }
    }
  }
#line 402
  return;
}
}
#line 168 "/usr/include/stdio.h"
extern struct _IO_FILE *stdin ;
#line 425
extern int fscanf(FILE * __restrict  __stream , char const   * __restrict  __format 
                  , ...)  __asm__("__isoc99_fscanf")  ;
#line 828
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) feof)(FILE *__stream ) ;
#line 236 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strchr)(char const   *__s ,
                                                                                               int __c )  __attribute__((__pure__)) ;
#line 342
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strstr)(char const   *__haystack ,
                                                                                                 char const   *__needle )  __attribute__((__pure__)) ;
#line 39 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _isblank(int c ) 
{ 


  {
#line 41
  if (c == 9) {
#line 42
    return (0);
  }
#line 44
  if (c == 32) {
#line 45
    return (0);
  }
#line 47
  return (1);
}
}
#line 55 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _isno(char *answer ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 57
  tmp___2 = strcmp((char const   *)answer, "N");
  }
#line 57
  if (tmp___2) {
    {
#line 60
    tmp___1 = strcmp((char const   *)answer, "NO");
    }
#line 60
    if (tmp___1) {
      {
#line 63
      tmp___0 = strcmp((char const   *)answer, "n");
      }
#line 63
      if (tmp___0) {
        {
#line 66
        tmp = strcmp((char const   *)answer, "no");
        }
#line 66
        if (! tmp) {
#line 67
          return (1);
        }
      } else {
#line 64
        return (1);
      }
    } else {
#line 61
      return (1);
    }
  } else {
#line 58
    return (1);
  }
#line 69
  return (0);
}
}
#line 76 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _isyes(char *answer ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 80
  tmp___2 = strcmp((char const   *)answer, "Y");
  }
#line 80
  if (tmp___2) {
    {
#line 85
    tmp___1 = strcmp((char const   *)answer, "YES");
    }
#line 85
    if (tmp___1) {
      {
#line 90
      tmp___0 = strcmp((char const   *)answer, "y");
      }
#line 90
      if (tmp___0) {
        {
#line 95
        tmp = strcmp((char const   *)answer, "yes");
        }
#line 95
        if (tmp) {
#line 101
          return (0);
        } else {
#line 98
          return (1);
        }
      } else {
#line 93
        return (1);
      }
    } else {
#line 88
      return (1);
    }
  } else {
#line 83
    return (1);
  }
#line 103
  return (0);
}
}
#line 111 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static char *_get_answer(char *answer ) 
{ 
  char *tmp ;
  void *tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  size_t tmp___3 ;
  void *tmp___4 ;

  {
  {
#line 113
  tmp___0 = malloc((size_t )255);
#line 113
  tmp = (char *)tmp___0;
#line 125
  fscanf((FILE */* __restrict  */)stdin, (char const   */* __restrict  */)"%s", tmp);
  }
#line 127
  if ((unsigned long )answer == (unsigned long )((void *)0)) {
    {
#line 128
    tmp___1 = strlen((char const   *)tmp);
#line 128
    tmp___2 = malloc(tmp___1 + 1UL);
#line 128
    answer = (char *)tmp___2;
    }
  } else {
    {
#line 130
    tmp___3 = strlen((char const   *)tmp);
#line 130
    tmp___4 = realloc((void *)answer, tmp___3 + 1UL);
#line 130
    answer = (char *)tmp___4;
    }
  }
  {
#line 132
  strcpy((char */* __restrict  */)answer, (char const   */* __restrict  */)tmp);
#line 133
  free((void *)tmp);
  }
#line 135
  return (answer);
}
}
#line 142 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _iscommented(char *line , char comment ) 
{ 
  int first_char ;
  int i ;
  int tmp ;
  size_t tmp___0 ;

  {
#line 144
  first_char = 0;
#line 145
  i = 0;
#line 147
  if ((int )*(line + 0) == (int )comment) {
#line 148
    return (1);
  }
  {
#line 150
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 150
    tmp___0 = strlen((char const   *)line);
    }
#line 150
    if (! ((size_t )i < tmp___0)) {
#line 150
      goto while_break;
    }
#line 152
    if ((int )*(line + i) == 0) {
#line 153
      return (0);
    }
    {
#line 155
    tmp = _isblank((int )*(line + i));
    }
#line 155
    if (tmp) {
#line 155
      if (! first_char) {
#line 156
        i ++;
      }
    }
#line 158
    if ((int )*(line + i) != (int )comment) {
#line 158
      if (! first_char) {
#line 159
        return (0);
      }
    }
#line 161
    if ((int )*(line + i) == (int )comment) {
#line 161
      if (! first_char) {
#line 162
        return (1);
      } else {
#line 161
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 164
    if ((int )*(line + i) != (int )comment) {
#line 164
      if (! first_char) {
#line 165
        return (0);
      }
    }
#line 167
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 170
  return (0);
}
}
#line 177 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _isvalid(char *line , char token ) 
{ 
  char *tmp ;

  {
  {
#line 180
  tmp = strchr((char const   *)line, (int )token);
  }
#line 180
  if ((unsigned long )tmp == (unsigned long )((void *)0)) {
#line 181
    return (0);
  }
#line 183
  return (1);
}
}
#line 190 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _fgetline(FILE *fp , char *line , int maxlen ) 
{ 
  int i ;
  int c ;

  {
#line 192
  i = 0;
  {
#line 195
  while (1) {
    while_continue: /* CIL Label */ ;
#line 195
    if (! (i < maxlen)) {
#line 195
      goto while_break;
    }
    {
#line 197
    c = fgetc(fp);
    }
#line 199
    if (c == -1) {
#line 201
      *(line + i) = (char )'\000';
#line 202
      return (-1);
    }
#line 205
    if (c == 10) {
#line 206
      goto while_break;
    }
#line 208
    *(line + i) = (char )c;
#line 210
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 213
  *(line + i) = (char )'\000';
#line 215
  return (i);
}
}
#line 222 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
static int _getoptval(char *line , char *opt , char *value ) 
{ 
  char *tmpp ;
  size_t tmp ;
  void *tmp___0 ;
  char *p ;
  size_t tmp___1 ;
  void *tmp___2 ;
  char *tmpp_orig ;
  char *p_orig ;
  size_t tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  void *tmp___6 ;

  {
  {
#line 224
  tmp = strlen((char const   *)line);
#line 224
  tmp___0 = malloc(tmp);
#line 224
  tmpp = (char *)tmp___0;
#line 225
  tmp___1 = strlen((char const   *)line);
#line 225
  tmp___2 = malloc(tmp___1);
#line 225
  p = (char *)tmp___2;
#line 226
  tmpp_orig = tmpp;
#line 227
  p_orig = p;
#line 230
  tmpp = strstr((char const   *)line, (char const   *)opt);
  }
#line 232
  if ((unsigned long )tmpp == (unsigned long )((void *)0)) {
#line 233
    return (0);
  }
  {
#line 235
  tmp___3 = strlen((char const   *)opt);
#line 235
  tmpp += tmp___3;
#line 237
  tmp___4 = _isblank((int )*tmpp);
  }
#line 237
  if (tmp___4) {
#line 237
    if ((int )*tmpp != 61) {
      {
#line 239
      free((void *)tmpp_orig);
      }
#line 240
      return (0);
    }
  } else {
    {
#line 239
    free((void *)tmpp_orig);
    }
#line 240
    return (0);
  }
  {
#line 244
  p = strchr((char const   *)line, '=');
#line 246
  p ++;
#line 248
  tmp___5 = strlen((char const   *)p);
#line 248
  tmp___6 = realloc((void *)value, tmp___5 + 1UL);
#line 248
  value = (char *)tmp___6;
#line 250
  strcpy((char */* __restrict  */)value, (char const   */* __restrict  */)p);
#line 252
  free((void *)p_orig);
  }
#line 254
  return (1);
}
}
#line 262 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
int _get_color_by_opt(char *opt_value ) 
{ 
  int color ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
  {
#line 266
  tmp___6 = strcmp((char const   *)opt_value, "black");
  }
#line 266
  if (tmp___6) {
    {
#line 268
    tmp___5 = strcmp((char const   *)opt_value, "red");
    }
#line 268
    if (tmp___5) {
      {
#line 270
      tmp___4 = strcmp((char const   *)opt_value, "green");
      }
#line 270
      if (tmp___4) {
        {
#line 272
        tmp___3 = strcmp((char const   *)opt_value, "yellow");
        }
#line 272
        if (tmp___3) {
          {
#line 274
          tmp___2 = strcmp((char const   *)opt_value, "blue");
          }
#line 274
          if (tmp___2) {
            {
#line 276
            tmp___1 = strcmp((char const   *)opt_value, "magenta");
            }
#line 276
            if (tmp___1) {
              {
#line 278
              tmp___0 = strcmp((char const   *)opt_value, "cyan");
              }
#line 278
              if (tmp___0) {
                {
#line 280
                tmp = strcmp((char const   *)opt_value, "white");
                }
#line 280
                if (tmp) {
#line 283
                  color = -1;
                } else {
#line 281
                  color = 7;
                }
              } else {
#line 279
                color = 6;
              }
            } else {
#line 277
              color = 5;
            }
          } else {
#line 275
            color = 4;
          }
        } else {
#line 273
          color = 3;
        }
      } else {
#line 271
        color = 2;
      }
    } else {
#line 269
      color = 1;
    }
  } else {
#line 267
    color = 0;
  }
#line 285
  return (color);
}
}
#line 292 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
int _get_color_attrib_by_opt(char *opt_value ) 
{ 
  int attrib ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 296
  tmp___3 = strcmp((char const   *)opt_value, "normal");
  }
#line 296
  if (tmp___3) {
    {
#line 298
    tmp___2 = strcmp((char const   *)opt_value, "bright");
    }
#line 298
    if (tmp___2) {
      {
#line 300
      tmp___1 = strcmp((char const   *)opt_value, "underline");
      }
#line 300
      if (tmp___1) {
        {
#line 302
        tmp___0 = strcmp((char const   *)opt_value, "blink");
        }
#line 302
        if (tmp___0) {
          {
#line 304
          tmp = strcmp((char const   *)opt_value, "reverse");
          }
#line 304
          if (tmp) {
#line 307
            attrib = -1;
          } else {
#line 305
            attrib = 5;
          }
        } else {
#line 303
          attrib = 4;
        }
      } else {
#line 301
        attrib = 3;
      }
    } else {
#line 299
      attrib = 1;
    }
  } else {
#line 297
    attrib = 0;
  }
#line 309
  return (attrib);
}
}
#line 312 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
void _set_color_conf(char *opt_value , int n , int attr ) 
{ 


  {
#line 314
  if (n == 1) {
#line 314
    if (! attr) {
      {
#line 317
      KNOCKER_COLOR_1 = _get_color_by_opt(opt_value);
      }
#line 319
      if (KNOCKER_COLOR_1 == -1) {
#line 320
        KNOCKER_COLOR_1 = 2;
      }
    } else {
#line 314
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 322
  if (n == 1) {
#line 322
    if (attr) {
      {
#line 325
      KNOCKER_COLOR_1_ATTR = _get_color_attrib_by_opt(opt_value);
      }
#line 327
      if (KNOCKER_COLOR_1_ATTR == -1) {
#line 328
        KNOCKER_COLOR_1_ATTR = 0;
      }
    } else {
#line 322
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 331
  if (n == 2) {
#line 331
    if (! attr) {
      {
#line 334
      KNOCKER_COLOR_2 = _get_color_by_opt(opt_value);
      }
#line 336
      if (KNOCKER_COLOR_2 == -1) {
#line 337
        KNOCKER_COLOR_2 = 7;
      }
    } else {
#line 331
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 340
  if (n == 2) {
#line 340
    if (attr) {
      {
#line 343
      KNOCKER_COLOR_2_ATTR = _get_color_attrib_by_opt(opt_value);
      }
#line 345
      if (KNOCKER_COLOR_2_ATTR == -1) {
#line 346
        KNOCKER_COLOR_2_ATTR = 1;
      }
    }
  }
#line 349
  return;
}
}
#line 355 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
void knocker_conf_set_default(void) 
{ 


  {
#line 357
  KNOCKER_COLOR_1 = 2;
#line 358
  KNOCKER_COLOR_1_ATTR = 0;
#line 359
  KNOCKER_COLOR_2 = 7;
#line 360
  KNOCKER_COLOR_2_ATTR = 1;
#line 361
  return;
}
}
#line 368 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
int knocker_conf_parse(void) 
{ 
  FILE *fp ;
  char *conf_file ;
  char *linebuff ;
  char *opt_value ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;

  {
  {
#line 372
  conf_file = (char *)((void *)0);
#line 373
  linebuff = (char *)((void *)0);
#line 374
  opt_value = (char *)((void *)0);
#line 376
  tmp = strlen((char const   *)knocker_user.dir);
#line 376
  tmp___0 = strlen("/");
#line 376
  tmp___1 = strlen("knocker.conf");
#line 376
  tmp___2 = malloc(((tmp + tmp___0) + tmp___1) + 1UL);
#line 376
  conf_file = (char *)tmp___2;
#line 378
  strcpy((char */* __restrict  */)conf_file, (char const   */* __restrict  */)knocker_user.dir);
#line 379
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"/");
#line 380
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"knocker.conf");
#line 382
  fp = fopen((char const   */* __restrict  */)conf_file, (char const   */* __restrict  */)"r");
  }
#line 382
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 385
    free((void *)conf_file);
#line 386
    knocker_conf_set_default();
    }
#line 387
    return (-1);
  }
  {
#line 390
  tmp___3 = malloc((size_t )255);
#line 390
  linebuff = (char *)tmp___3;
#line 391
  tmp___4 = malloc((size_t )255);
#line 391
  opt_value = (char *)tmp___4;
  }
  {
#line 393
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 393
    tmp___15 = feof(fp);
    }
#line 393
    if (tmp___15) {
#line 393
      goto while_break;
    }
    {
#line 395
    tmp___5 = _fgetline(fp, linebuff, 255);
    }
#line 395
    if (tmp___5 == -1) {
#line 397
      goto while_break;
    }
    {
#line 400
    tmp___14 = _iscommented(linebuff, (char )'#');
    }
#line 400
    if (! tmp___14) {
      {
#line 402
      tmp___13 = _isvalid(linebuff, (char )'=');
      }
#line 402
      if (tmp___13) {
        {
#line 404
        tmp___12 = _getoptval(linebuff, (char *)"USE_COLORS", opt_value);
        }
#line 404
        if (tmp___12) {
          {
#line 406
          tmp___7 = _isno(opt_value);
          }
#line 406
          if (tmp___7) {
#line 407
            knocker_args.colors = 0;
          } else {
            {
#line 408
            tmp___6 = _isyes(opt_value);
            }
#line 408
            if (tmp___6) {
#line 409
              knocker_args.colors = 1;
            } else {
#line 411
              knocker_args.colors = 1;
            }
          }
        } else {
          {
#line 413
          tmp___11 = _getoptval(linebuff, (char *)"COLOR_1", opt_value);
          }
#line 413
          if (tmp___11) {
            {
#line 415
            _set_color_conf(opt_value, 1, 0);
            }
          } else {
            {
#line 417
            tmp___10 = _getoptval(linebuff, (char *)"COLOR_2", opt_value);
            }
#line 417
            if (tmp___10) {
              {
#line 419
              _set_color_conf(opt_value, 2, 0);
              }
            } else {
              {
#line 421
              tmp___9 = _getoptval(linebuff, (char *)"COLOR_1_ATTR", opt_value);
              }
#line 421
              if (tmp___9) {
                {
#line 423
                _set_color_conf(opt_value, 1, 1);
                }
              } else {
                {
#line 425
                tmp___8 = _getoptval(linebuff, (char *)"COLOR_2_ATTR", opt_value);
                }
#line 425
                if (tmp___8) {
                  {
#line 427
                  _set_color_conf(opt_value, 2, 1);
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 434
  fclose(fp);
#line 435
  free((void *)conf_file);
#line 436
  free((void *)linebuff);
#line 437
  free((void *)opt_value);
  }
#line 439
  return (0);
}
}
#line 447 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
int knocker_conf_write_default(void) 
{ 
  FILE *fp ;
  char *conf_file ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 451
  conf_file = (char *)((void *)0);
#line 453
  tmp = strlen((char const   *)knocker_user.dir);
#line 453
  tmp___0 = strlen("/");
#line 453
  tmp___1 = strlen("knocker.conf");
#line 453
  tmp___2 = malloc(((tmp + tmp___0) + tmp___1) + 1UL);
#line 453
  conf_file = (char *)tmp___2;
#line 455
  strcpy((char */* __restrict  */)conf_file, (char const   */* __restrict  */)knocker_user.dir);
#line 456
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"/");
#line 457
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"knocker.conf");
#line 459
  fp = fopen((char const   */* __restrict  */)conf_file, (char const   */* __restrict  */)"w");
  }
#line 459
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 462
    knocker_conf_set_default();
#line 463
    free((void *)conf_file);
    }
#line 464
    return (-1);
  }
  {
#line 467
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Config file for %s. Copyright (C) 2001-2002 %s\n",
          '#', "knocker", "Gabriele Giorgetti");
#line 468
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c %s %s\n",
          '#', "<g.gabriele79@genie.it>", "http://knocker.sourceforge.net");
#line 469
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 470
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Edit as you need.\n",
          '#');
#line 471
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 472
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c TO USE COLORS OR NOT TO USE COLORS ?\n",
          '#');
#line 473
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 474
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c If you say no here, colors won\'t be used, otherwise yes\n",
          '#');
#line 475
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 476
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cyes\n",
          "USE_COLORS", '=');
#line 477
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 478
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c COLORS AND COLORS ATTRIBUTES:\n",
          '#');
#line 479
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 480
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c These are for the %s colored output, you can choose what colors\n",
          '#', "knocker");
#line 481
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c are to be used.\n",
          '#');
#line 482
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 483
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid values for COLOR are:\n",
          '#');
#line 484
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c black, red, green, yellow, blue, magenta, cyan, white.\n",
          '#');
#line 485
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 486
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid ATTRIBS are:\n",
          '#');
#line 487
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c normal, bright, underline, blink, reverse\n",
          '#');
#line 488
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 489
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cgreen\n",
          "COLOR_1", '=');
#line 490
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cnormal\n",
          "COLOR_1_ATTR", '=');
#line 491
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 492
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cwhite\n",
          "COLOR_2", '=');
#line 493
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cbright\n",
          "COLOR_2_ATTR", '=');
#line 494
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 496
  free((void *)conf_file);
#line 497
  fclose(fp);
  }
#line 499
  return (0);
}
}
#line 506 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
int knocker_conf_write(int use_colors , char *color1 , char *color2 , char *color1_attr ,
                       char *color2_attr ) 
{ 
  FILE *fp ;
  char *conf_file ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 510
  conf_file = (char *)((void *)0);
#line 512
  tmp = strlen((char const   *)knocker_user.dir);
#line 512
  tmp___0 = strlen("/");
#line 512
  tmp___1 = strlen("knocker.conf");
#line 512
  tmp___2 = malloc(((tmp + tmp___0) + tmp___1) + 1UL);
#line 512
  conf_file = (char *)tmp___2;
#line 514
  strcpy((char */* __restrict  */)conf_file, (char const   */* __restrict  */)knocker_user.dir);
#line 515
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"/");
#line 516
  strcat((char */* __restrict  */)conf_file, (char const   */* __restrict  */)"knocker.conf");
#line 518
  fp = fopen((char const   */* __restrict  */)conf_file, (char const   */* __restrict  */)"w");
  }
#line 518
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
    {
#line 523
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"\n%s: error, couldn\'t write configuration file: %s\n",
            "knocker", conf_file);
#line 524
    free((void *)conf_file);
    }
#line 525
    return (-1);
  }
  {
#line 528
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\nWriting configuration file... ");
#line 530
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Config file for %s. Copyright (C) 2001-2002 %s\n",
          '#', "knocker", "Gabriele Giorgetti");
#line 531
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c %s %s\n",
          '#', "<g.gabriele79@genie.it>", "http://knocker.sourceforge.net");
#line 532
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 533
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Edit as you need.\n",
          '#');
#line 534
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 535
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c TO USE COLORS OR NOT TO USE COLORS ?\n",
          '#');
#line 536
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
#line 537
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c If you say no here, colors won\'t be used, otherwise yes\n",
          '#');
#line 538
  fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n", '#');
  }
#line 540
  if (use_colors) {
    {
#line 541
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cyes\n",
            "USE_COLORS", '=');
    }
  } else {
    {
#line 543
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cno\n",
            "USE_COLORS", '=');
    }
  }
#line 546
  if ((unsigned long )color1 != (unsigned long )((void *)0)) {
#line 546
    if ((unsigned long )color2 != (unsigned long )((void *)0)) {
#line 546
      if ((unsigned long )color1_attr != (unsigned long )((void *)0)) {
#line 546
        if ((unsigned long )color2_attr != (unsigned long )((void *)0)) {
          {
#line 549
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 550
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c COLORS AND COLORS ATTRIBUTES:\n",
                  '#');
#line 551
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
                  '#');
#line 552
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c These are for the %s colored output, you can choose what colors\n",
                  '#', "knocker");
#line 553
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c are to be used.\n",
                  '#');
#line 554
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
                  '#');
#line 555
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid values for COLOR are:\n",
                  '#');
#line 556
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c black, red, green, yellow, blue, magenta, cyan, white.\n",
                  '#');
#line 557
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
                  '#');
#line 558
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid ATTRIBS are:\n",
                  '#');
#line 559
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c normal, bright, underline, blink, reverse\n",
                  '#');
#line 560
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
                  '#');
#line 561
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%c%s\n",
                  "COLOR_1", '=', color1);
#line 562
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%c%s\n",
                  "COLOR_1_ATTR", '=', color1_attr);
#line 563
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 564
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%c%s\n",
                  "COLOR_2", '=', color2);
#line 565
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%c%s\n",
                  "COLOR_2_ATTR", '=', color2_attr);
#line 566
          fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
          }
        } else {
#line 546
          goto _L___1;
        }
      } else {
#line 546
        goto _L___1;
      }
    } else {
#line 546
      goto _L___1;
    }
  } else {
    _L___1: /* CIL Label */ 
    {
#line 573
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 574
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c COLORS AND COLORS ATTRIBUTES:\n",
            '#');
#line 575
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
            '#');
#line 576
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c These are for the %s colored output, you can choose what colors\n",
            '#', "knocker");
#line 577
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c are to be used.\n",
            '#');
#line 578
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
            '#');
#line 579
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid values for COLOR are:\n",
            '#');
#line 580
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c black, red, green, yellow, blue, magenta, cyan, white.\n",
            '#');
#line 581
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
            '#');
#line 582
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c Valid ATTRIBS are:\n",
            '#');
#line 583
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c normal, bright, underline, blink, reverse\n",
            '#');
#line 584
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%c\n",
            '#');
#line 585
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cgreen\n",
            "COLOR_1", '=');
#line 586
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cnormal\n",
            "COLOR_1_ATTR", '=');
#line 587
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
#line 588
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cwhite\n",
            "COLOR_2", '=');
#line 589
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s%cbright\n",
            "COLOR_2_ATTR", '=');
#line 590
    fprintf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"\n");
    }
  }
  {
#line 593
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"done.\n");
#line 594
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Configuration written to: %s\n",
          conf_file);
#line 595
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"You can also edit this file manually.\n");
#line 596
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 598
  free((void *)conf_file);
#line 599
  fclose(fp);
  }
#line 601
  return (0);
}
}
#line 609 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_conf.c"
void knocker_conf_configure(void) 
{ 
  char *buff ;
  int use_colors ;
  char *color1 ;
  char *color2 ;
  char *color1_attr ;
  char *color2_attr ;
  int tmp ;
  int tmp___0 ;
  char *tmp___1 ;
  size_t tmp___2 ;
  void *tmp___3 ;
  char *tmp___4 ;
  size_t tmp___5 ;
  void *tmp___6 ;
  char *tmp___7 ;
  size_t tmp___8 ;
  void *tmp___9 ;
  char *tmp___10 ;
  size_t tmp___11 ;
  void *tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;

  {
  {
#line 611
  buff = (char *)((void *)0);
#line 613
  use_colors = 1;
#line 615
  color1 = (char *)((void *)0);
#line 616
  color2 = (char *)((void *)0);
#line 617
  color1_attr = (char *)((void *)0);
#line 618
  color2_attr = (char *)((void *)0);
#line 620
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 621
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Welcome to the %s configuration !\n",
          "knocker");
#line 622
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 623
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"%s is able to output text using colors,\n",
          "knocker");
#line 624
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"do you want me te enable colors ?\n");
#line 625
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[Y/n]: ");
  }
  {
#line 627
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 630
    buff = _get_answer(buff);
#line 632
    tmp___0 = _isyes(buff);
    }
#line 632
    if (tmp___0) {
#line 634
      use_colors = 1;
#line 635
      goto while_break;
    } else {
      {
#line 637
      tmp = _isno(buff);
      }
#line 637
      if (tmp) {
        {
#line 639
        use_colors = 0;
#line 640
        knocker_conf_write(use_colors, color1, color2, color1_attr, color2_attr);
        }
#line 641
        return;
      } else {
        {
#line 644
        fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[Y/n]: ");
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 648
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 649
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"It is also possible to change the default colors settings,\n");
#line 650
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"do you want to change the default colors ?\n");
#line 651
  fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[y/N]: ");
  }
  {
#line 653
  while (1) {
    while_continue___0: /* CIL Label */ ;
    {
#line 656
    buff = _get_answer(buff);
#line 658
    tmp___14 = _isyes(buff);
    }
#line 658
    if (tmp___14) {
      {
#line 661
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 662
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Normal text:\n");
#line 663
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Choose the color you want to use for normal text:\n");
#line 664
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[black/red/green/yellow/blue/magenta/cyan/white]: ");
#line 666
      tmp___1 = _get_answer(buff);
#line 666
      tmp___2 = strlen((char const   *)(tmp___1 + 1));
#line 666
      tmp___3 = malloc(tmp___2);
#line 666
      color1 = (char *)tmp___3;
#line 667
      strcpy((char */* __restrict  */)color1, (char const   */* __restrict  */)buff);
#line 669
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 670
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Choose the color attribute you want to use for normal text:\n");
#line 671
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[normal/bright/underline/blink/reverse]: ");
#line 673
      tmp___4 = _get_answer(buff);
#line 673
      tmp___5 = strlen((char const   *)(tmp___4 + 1));
#line 673
      tmp___6 = malloc(tmp___5);
#line 673
      color1_attr = (char *)tmp___6;
#line 674
      strcpy((char */* __restrict  */)color1_attr, (char const   */* __restrict  */)buff);
#line 677
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 678
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Highlighted text:\n");
#line 679
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Choose the color you want to use for highlighted  text:\n");
#line 680
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[black/red/green/yellow/blue/magenta/cyan/white]: ");
#line 682
      tmp___7 = _get_answer(buff);
#line 682
      tmp___8 = strlen((char const   *)(tmp___7 + 1));
#line 682
      tmp___9 = malloc(tmp___8);
#line 682
      color2 = (char *)tmp___9;
#line 683
      strcpy((char */* __restrict  */)color2, (char const   */* __restrict  */)buff);
#line 685
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"\n");
#line 686
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"Choose the color attribute you want to use for normal text:\n");
#line 687
      fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[normal/bright/underline/blink/reverse]: ");
#line 689
      tmp___10 = _get_answer(buff);
#line 689
      tmp___11 = strlen((char const   *)(tmp___10 + 1));
#line 689
      tmp___12 = malloc(tmp___11);
#line 689
      color2_attr = (char *)tmp___12;
#line 690
      strcpy((char */* __restrict  */)color2_attr, (char const   */* __restrict  */)buff);
#line 692
      knocker_conf_write(use_colors, color1, color2, color1_attr, color2_attr);
#line 694
      free((void *)color1);
#line 695
      free((void *)color2);
#line 696
      free((void *)color1_attr);
#line 697
      free((void *)color2_attr);
      }
#line 698
      return;
    } else {
      {
#line 700
      tmp___13 = _isno(buff);
      }
#line 700
      if (tmp___13) {
#line 702
        use_colors = 0;
#line 703
        goto while_break___0;
      } else {
        {
#line 706
        fprintf((FILE */* __restrict  */)stdout, (char const   */* __restrict  */)"[Y/n]: ");
        }
      }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 711
  return;
}
}
#line 34 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.c"
int init_knocker_core_services_db(void) 
{ 
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  void *tmp___8 ;
  void *tmp___9 ;
  void *tmp___10 ;
  void *tmp___11 ;
  void *tmp___12 ;
  void *tmp___13 ;
  void *tmp___14 ;
  void *tmp___15 ;
  void *tmp___16 ;
  void *tmp___17 ;
  void *tmp___18 ;
  void *tmp___19 ;
  void *tmp___20 ;
  void *tmp___21 ;
  void *tmp___22 ;
  void *tmp___23 ;
  void *tmp___24 ;
  void *tmp___25 ;
  void *tmp___26 ;
  void *tmp___27 ;
  void *tmp___28 ;
  void *tmp___29 ;
  void *tmp___30 ;
  void *tmp___31 ;
  void *tmp___32 ;
  void *tmp___33 ;
  void *tmp___34 ;
  void *tmp___35 ;
  void *tmp___36 ;
  void *tmp___37 ;
  void *tmp___38 ;
  void *tmp___39 ;
  void *tmp___40 ;
  void *tmp___41 ;
  void *tmp___42 ;
  void *tmp___43 ;
  void *tmp___44 ;
  void *tmp___45 ;
  void *tmp___46 ;
  void *tmp___47 ;
  void *tmp___48 ;
  void *tmp___49 ;
  void *tmp___50 ;
  void *tmp___51 ;
  void *tmp___52 ;
  void *tmp___53 ;
  void *tmp___54 ;
  void *tmp___55 ;
  void *tmp___56 ;
  void *tmp___57 ;
  void *tmp___58 ;
  void *tmp___59 ;
  void *tmp___60 ;
  void *tmp___61 ;
  void *tmp___62 ;
  void *tmp___63 ;
  void *tmp___64 ;
  void *tmp___65 ;
  void *tmp___66 ;
  void *tmp___67 ;
  void *tmp___68 ;
  void *tmp___69 ;
  void *tmp___70 ;
  void *tmp___71 ;
  void *tmp___72 ;
  void *tmp___73 ;
  void *tmp___74 ;
  void *tmp___75 ;
  void *tmp___76 ;
  void *tmp___77 ;
  void *tmp___78 ;
  void *tmp___79 ;
  void *tmp___80 ;
  void *tmp___81 ;
  void *tmp___82 ;
  void *tmp___83 ;
  void *tmp___84 ;
  void *tmp___85 ;
  void *tmp___86 ;
  void *tmp___87 ;
  void *tmp___88 ;
  void *tmp___89 ;
  void *tmp___90 ;
  void *tmp___91 ;
  void *tmp___92 ;
  void *tmp___93 ;
  void *tmp___94 ;
  void *tmp___95 ;
  void *tmp___96 ;
  void *tmp___97 ;
  void *tmp___98 ;
  void *tmp___99 ;
  void *tmp___100 ;
  void *tmp___101 ;
  void *tmp___102 ;
  void *tmp___103 ;
  void *tmp___104 ;
  void *tmp___105 ;
  void *tmp___106 ;
  void *tmp___107 ;
  void *tmp___108 ;
  void *tmp___109 ;
  void *tmp___110 ;
  void *tmp___111 ;
  void *tmp___112 ;
  void *tmp___113 ;
  void *tmp___114 ;
  void *tmp___115 ;
  void *tmp___116 ;
  void *tmp___117 ;
  void *tmp___118 ;
  void *tmp___119 ;
  void *tmp___120 ;
  void *tmp___121 ;
  void *tmp___122 ;
  void *tmp___123 ;
  void *tmp___124 ;
  void *tmp___125 ;
  void *tmp___126 ;
  void *tmp___127 ;
  void *tmp___128 ;
  void *tmp___129 ;
  void *tmp___130 ;
  void *tmp___131 ;
  void *tmp___132 ;
  void *tmp___133 ;
  void *tmp___134 ;
  void *tmp___135 ;
  void *tmp___136 ;
  void *tmp___137 ;
  void *tmp___138 ;
  void *tmp___139 ;
  void *tmp___140 ;
  void *tmp___141 ;
  void *tmp___142 ;
  void *tmp___143 ;
  void *tmp___144 ;
  void *tmp___145 ;
  void *tmp___146 ;
  void *tmp___147 ;
  void *tmp___148 ;
  void *tmp___149 ;

  {
#line 42
  if (knocker_core_services_db_init) {
#line 43
    return (0);
  }
  {
#line 45
  knocker_core_services_db_init = 0;
#line 55
  tmp = malloc((size_t )7);
#line 55
  knocker_core_services_db[1] = (char *)tmp;
#line 56
  strcpy((char */* __restrict  */)knocker_core_services_db[1], (char const   */* __restrict  */)"tcpmux");
  }
#line 58
  if ((unsigned long )knocker_core_services_db[1] == (unsigned long )((void *)0)) {
#line 59
    return (-1);
  }
  {
#line 61
  tmp___0 = malloc((size_t )5);
#line 61
  knocker_core_services_db[7] = (char *)tmp___0;
#line 62
  strcpy((char */* __restrict  */)knocker_core_services_db[7], (char const   */* __restrict  */)"echo");
  }
#line 64
  if ((unsigned long )knocker_core_services_db[7] == (unsigned long )((void *)0)) {
#line 65
    return (-1);
  }
  {
#line 67
  tmp___1 = malloc((size_t )8);
#line 67
  knocker_core_services_db[9] = (char *)tmp___1;
#line 68
  strcpy((char */* __restrict  */)knocker_core_services_db[9], (char const   */* __restrict  */)"discard");
  }
#line 70
  if ((unsigned long )knocker_core_services_db[9] == (unsigned long )((void *)0)) {
#line 71
    return (-1);
  }
  {
#line 73
  tmp___2 = malloc((size_t )7);
#line 73
  knocker_core_services_db[11] = (char *)tmp___2;
#line 74
  strcpy((char */* __restrict  */)knocker_core_services_db[11], (char const   */* __restrict  */)"systat");
  }
#line 76
  if ((unsigned long )knocker_core_services_db[11] == (unsigned long )((void *)0)) {
#line 77
    return (-1);
  }
  {
#line 79
  tmp___3 = malloc((size_t )8);
#line 79
  knocker_core_services_db[13] = (char *)tmp___3;
#line 80
  strcpy((char */* __restrict  */)knocker_core_services_db[13], (char const   */* __restrict  */)"daytime");
  }
#line 82
  if ((unsigned long )knocker_core_services_db[13] == (unsigned long )((void *)0)) {
#line 83
    return (-1);
  }
  {
#line 85
  tmp___4 = malloc((size_t )8);
#line 85
  knocker_core_services_db[15] = (char *)tmp___4;
#line 86
  strcpy((char */* __restrict  */)knocker_core_services_db[15], (char const   */* __restrict  */)"netstat");
  }
#line 88
  if ((unsigned long )knocker_core_services_db[15] == (unsigned long )((void *)0)) {
#line 89
    return (-1);
  }
  {
#line 91
  tmp___5 = malloc((size_t )5);
#line 91
  knocker_core_services_db[17] = (char *)tmp___5;
#line 92
  strcpy((char */* __restrict  */)knocker_core_services_db[17], (char const   */* __restrict  */)"qotd");
  }
#line 94
  if ((unsigned long )knocker_core_services_db[17] == (unsigned long )((void *)0)) {
#line 95
    return (-1);
  }
  {
#line 97
  tmp___6 = malloc((size_t )4);
#line 97
  knocker_core_services_db[18] = (char *)tmp___6;
#line 98
  strcpy((char */* __restrict  */)knocker_core_services_db[18], (char const   */* __restrict  */)"msp");
  }
#line 100
  if ((unsigned long )knocker_core_services_db[18] == (unsigned long )((void *)0)) {
#line 101
    return (-1);
  }
  {
#line 103
  tmp___7 = malloc((size_t )8);
#line 103
  knocker_core_services_db[19] = (char *)tmp___7;
#line 104
  strcpy((char */* __restrict  */)knocker_core_services_db[19], (char const   */* __restrict  */)"chargen");
  }
#line 106
  if ((unsigned long )knocker_core_services_db[19] == (unsigned long )((void *)0)) {
#line 107
    return (-1);
  }
  {
#line 109
  tmp___8 = malloc((size_t )9);
#line 109
  knocker_core_services_db[20] = (char *)tmp___8;
#line 110
  strcpy((char */* __restrict  */)knocker_core_services_db[20], (char const   */* __restrict  */)"ftp-data");
  }
#line 112
  if ((unsigned long )knocker_core_services_db[20] == (unsigned long )((void *)0)) {
#line 113
    return (-1);
  }
  {
#line 115
  tmp___9 = malloc((size_t )4);
#line 115
  knocker_core_services_db[21] = (char *)tmp___9;
#line 116
  strcpy((char */* __restrict  */)knocker_core_services_db[21], (char const   */* __restrict  */)"ftp");
  }
#line 118
  if ((unsigned long )knocker_core_services_db[21] == (unsigned long )((void *)0)) {
#line 119
    return (-1);
  }
  {
#line 121
  tmp___10 = malloc((size_t )4);
#line 121
  knocker_core_services_db[22] = (char *)tmp___10;
#line 122
  strcpy((char */* __restrict  */)knocker_core_services_db[22], (char const   */* __restrict  */)"ssh");
  }
#line 124
  if ((unsigned long )knocker_core_services_db[22] == (unsigned long )((void *)0)) {
#line 125
    return (-1);
  }
  {
#line 127
  tmp___11 = malloc((size_t )7);
#line 127
  knocker_core_services_db[23] = (char *)tmp___11;
#line 128
  strcpy((char */* __restrict  */)knocker_core_services_db[23], (char const   */* __restrict  */)"telnet");
  }
#line 130
  if ((unsigned long )knocker_core_services_db[23] == (unsigned long )((void *)0)) {
#line 131
    return (-1);
  }
  {
#line 133
  tmp___12 = malloc((size_t )5);
#line 133
  knocker_core_services_db[25] = (char *)tmp___12;
#line 134
  strcpy((char */* __restrict  */)knocker_core_services_db[25], (char const   */* __restrict  */)"smtp");
  }
#line 136
  if ((unsigned long )knocker_core_services_db[25] == (unsigned long )((void *)0)) {
#line 137
    return (-1);
  }
  {
#line 139
  tmp___13 = malloc((size_t )5);
#line 139
  knocker_core_services_db[37] = (char *)tmp___13;
#line 140
  strcpy((char */* __restrict  */)knocker_core_services_db[37], (char const   */* __restrict  */)"time");
  }
#line 142
  if ((unsigned long )knocker_core_services_db[37] == (unsigned long )((void *)0)) {
#line 143
    return (-1);
  }
  {
#line 145
  tmp___14 = malloc((size_t )4);
#line 145
  knocker_core_services_db[39] = (char *)tmp___14;
#line 146
  strcpy((char */* __restrict  */)knocker_core_services_db[39], (char const   */* __restrict  */)"rlp");
  }
#line 148
  if ((unsigned long )knocker_core_services_db[39] == (unsigned long )((void *)0)) {
#line 149
    return (-1);
  }
  {
#line 151
  tmp___15 = malloc((size_t )11);
#line 151
  knocker_core_services_db[42] = (char *)tmp___15;
#line 152
  strcpy((char */* __restrict  */)knocker_core_services_db[42], (char const   */* __restrict  */)"nameserver");
  }
#line 154
  if ((unsigned long )knocker_core_services_db[42] == (unsigned long )((void *)0)) {
#line 155
    return (-1);
  }
  {
#line 157
  tmp___16 = malloc((size_t )6);
#line 157
  knocker_core_services_db[43] = (char *)tmp___16;
#line 158
  strcpy((char */* __restrict  */)knocker_core_services_db[43], (char const   */* __restrict  */)"whois");
  }
#line 160
  if ((unsigned long )knocker_core_services_db[43] == (unsigned long )((void *)0)) {
#line 161
    return (-1);
  }
  {
#line 163
  tmp___17 = malloc((size_t )11);
#line 163
  knocker_core_services_db[50] = (char *)tmp___17;
#line 164
  strcpy((char */* __restrict  */)knocker_core_services_db[50], (char const   */* __restrict  */)"re-mail-ck");
  }
#line 166
  if ((unsigned long )knocker_core_services_db[50] == (unsigned long )((void *)0)) {
#line 167
    return (-1);
  }
  {
#line 169
  tmp___18 = malloc((size_t )7);
#line 169
  knocker_core_services_db[53] = (char *)tmp___18;
#line 170
  strcpy((char */* __restrict  */)knocker_core_services_db[53], (char const   */* __restrict  */)"domain");
  }
#line 172
  if ((unsigned long )knocker_core_services_db[53] == (unsigned long )((void *)0)) {
#line 173
    return (-1);
  }
  {
#line 175
  tmp___19 = malloc((size_t )4);
#line 175
  knocker_core_services_db[57] = (char *)tmp___19;
#line 176
  strcpy((char */* __restrict  */)knocker_core_services_db[57], (char const   */* __restrict  */)"mtp");
  }
#line 178
  if ((unsigned long )knocker_core_services_db[57] == (unsigned long )((void *)0)) {
#line 179
    return (-1);
  }
  {
#line 181
  tmp___20 = malloc((size_t )7);
#line 181
  knocker_core_services_db[67] = (char *)tmp___20;
#line 182
  strcpy((char */* __restrict  */)knocker_core_services_db[67], (char const   */* __restrict  */)"bootps");
  }
#line 184
  if ((unsigned long )knocker_core_services_db[67] == (unsigned long )((void *)0)) {
#line 185
    return (-1);
  }
  {
#line 187
  tmp___21 = malloc((size_t )7);
#line 187
  knocker_core_services_db[68] = (char *)tmp___21;
#line 188
  strcpy((char */* __restrict  */)knocker_core_services_db[68], (char const   */* __restrict  */)"bootpc");
  }
#line 190
  if ((unsigned long )knocker_core_services_db[68] == (unsigned long )((void *)0)) {
#line 191
    return (-1);
  }
  {
#line 193
  tmp___22 = malloc((size_t )5);
#line 193
  knocker_core_services_db[69] = (char *)tmp___22;
#line 194
  strcpy((char */* __restrict  */)knocker_core_services_db[69], (char const   */* __restrict  */)"tftp");
  }
#line 196
  if ((unsigned long )knocker_core_services_db[69] == (unsigned long )((void *)0)) {
#line 197
    return (-1);
  }
  {
#line 199
  tmp___23 = malloc((size_t )7);
#line 199
  knocker_core_services_db[70] = (char *)tmp___23;
#line 200
  strcpy((char */* __restrict  */)knocker_core_services_db[70], (char const   */* __restrict  */)"gopher");
  }
#line 202
  if ((unsigned long )knocker_core_services_db[70] == (unsigned long )((void *)0)) {
#line 203
    return (-1);
  }
  {
#line 205
  tmp___24 = malloc((size_t )4);
#line 205
  knocker_core_services_db[77] = (char *)tmp___24;
#line 206
  strcpy((char */* __restrict  */)knocker_core_services_db[77], (char const   */* __restrict  */)"rje");
  }
#line 208
  if ((unsigned long )knocker_core_services_db[77] == (unsigned long )((void *)0)) {
#line 209
    return (-1);
  }
  {
#line 211
  tmp___25 = malloc((size_t )7);
#line 211
  knocker_core_services_db[79] = (char *)tmp___25;
#line 212
  strcpy((char */* __restrict  */)knocker_core_services_db[79], (char const   */* __restrict  */)"finger");
  }
#line 214
  if ((unsigned long )knocker_core_services_db[79] == (unsigned long )((void *)0)) {
#line 215
    return (-1);
  }
  {
#line 217
  tmp___26 = malloc((size_t )4);
#line 217
  knocker_core_services_db[80] = (char *)tmp___26;
#line 218
  strcpy((char */* __restrict  */)knocker_core_services_db[80], (char const   */* __restrict  */)"www");
  }
#line 220
  if ((unsigned long )knocker_core_services_db[80] == (unsigned long )((void *)0)) {
#line 221
    return (-1);
  }
  {
#line 223
  tmp___27 = malloc((size_t )5);
#line 223
  knocker_core_services_db[87] = (char *)tmp___27;
#line 224
  strcpy((char */* __restrict  */)knocker_core_services_db[87], (char const   */* __restrict  */)"link");
  }
#line 226
  if ((unsigned long )knocker_core_services_db[87] == (unsigned long )((void *)0)) {
#line 227
    return (-1);
  }
  {
#line 229
  tmp___28 = malloc((size_t )9);
#line 229
  knocker_core_services_db[88] = (char *)tmp___28;
#line 230
  strcpy((char */* __restrict  */)knocker_core_services_db[88], (char const   */* __restrict  */)"kerberos");
  }
#line 232
  if ((unsigned long )knocker_core_services_db[88] == (unsigned long )((void *)0)) {
#line 233
    return (-1);
  }
  {
#line 235
  tmp___29 = malloc((size_t )7);
#line 235
  knocker_core_services_db[95] = (char *)tmp___29;
#line 236
  strcpy((char */* __restrict  */)knocker_core_services_db[95], (char const   */* __restrict  */)"supdup");
  }
#line 238
  if ((unsigned long )knocker_core_services_db[95] == (unsigned long )((void *)0)) {
#line 239
    return (-1);
  }
  {
#line 241
  tmp___30 = malloc((size_t )10);
#line 241
  knocker_core_services_db[98] = (char *)tmp___30;
#line 242
  strcpy((char */* __restrict  */)knocker_core_services_db[98], (char const   */* __restrict  */)"linuxconf");
  }
#line 244
  if ((unsigned long )knocker_core_services_db[98] == (unsigned long )((void *)0)) {
#line 245
    return (-1);
  }
  {
#line 247
  tmp___31 = malloc((size_t )10);
#line 247
  knocker_core_services_db[101] = (char *)tmp___31;
#line 248
  strcpy((char */* __restrict  */)knocker_core_services_db[101], (char const   */* __restrict  */)"hostnames");
  }
#line 250
  if ((unsigned long )knocker_core_services_db[101] == (unsigned long )((void *)0)) {
#line 251
    return (-1);
  }
  {
#line 253
  tmp___32 = malloc((size_t )9);
#line 253
  knocker_core_services_db[102] = (char *)tmp___32;
#line 254
  strcpy((char */* __restrict  */)knocker_core_services_db[102], (char const   */* __restrict  */)"iso-tsap");
  }
#line 256
  if ((unsigned long )knocker_core_services_db[102] == (unsigned long )((void *)0)) {
#line 257
    return (-1);
  }
  {
#line 259
  tmp___33 = malloc((size_t )9);
#line 259
  knocker_core_services_db[105] = (char *)tmp___33;
#line 260
  strcpy((char */* __restrict  */)knocker_core_services_db[105], (char const   */* __restrict  */)"csnet-ns");
  }
#line 262
  if ((unsigned long )knocker_core_services_db[105] == (unsigned long )((void *)0)) {
#line 263
    return (-1);
  }
  {
#line 265
  tmp___34 = malloc((size_t )8);
#line 265
  knocker_core_services_db[107] = (char *)tmp___34;
#line 266
  strcpy((char */* __restrict  */)knocker_core_services_db[107], (char const   */* __restrict  */)"rtelnet");
  }
#line 268
  if ((unsigned long )knocker_core_services_db[107] == (unsigned long )((void *)0)) {
#line 269
    return (-1);
  }
  {
#line 271
  tmp___35 = malloc((size_t )5);
#line 271
  knocker_core_services_db[109] = (char *)tmp___35;
#line 272
  strcpy((char */* __restrict  */)knocker_core_services_db[109], (char const   */* __restrict  */)"pop2");
  }
#line 274
  if ((unsigned long )knocker_core_services_db[109] == (unsigned long )((void *)0)) {
#line 275
    return (-1);
  }
  {
#line 277
  tmp___36 = malloc((size_t )5);
#line 277
  knocker_core_services_db[110] = (char *)tmp___36;
#line 278
  strcpy((char */* __restrict  */)knocker_core_services_db[110], (char const   */* __restrict  */)"pop3");
  }
#line 280
  if ((unsigned long )knocker_core_services_db[110] == (unsigned long )((void *)0)) {
#line 281
    return (-1);
  }
  {
#line 283
  tmp___37 = malloc((size_t )7);
#line 283
  knocker_core_services_db[111] = (char *)tmp___37;
#line 284
  strcpy((char */* __restrict  */)knocker_core_services_db[111], (char const   */* __restrict  */)"sunrpc");
  }
#line 286
  if ((unsigned long )knocker_core_services_db[111] == (unsigned long )((void *)0)) {
#line 287
    return (-1);
  }
  {
#line 289
  tmp___38 = malloc((size_t )5);
#line 289
  knocker_core_services_db[113] = (char *)tmp___38;
#line 290
  strcpy((char */* __restrict  */)knocker_core_services_db[113], (char const   */* __restrict  */)"auth");
  }
#line 292
  if ((unsigned long )knocker_core_services_db[113] == (unsigned long )((void *)0)) {
#line 293
    return (-1);
  }
  {
#line 295
  tmp___39 = malloc((size_t )5);
#line 295
  knocker_core_services_db[115] = (char *)tmp___39;
#line 296
  strcpy((char */* __restrict  */)knocker_core_services_db[115], (char const   */* __restrict  */)"sftp");
  }
#line 298
  if ((unsigned long )knocker_core_services_db[115] == (unsigned long )((void *)0)) {
#line 299
    return (-1);
  }
  {
#line 301
  tmp___40 = malloc((size_t )10);
#line 301
  knocker_core_services_db[117] = (char *)tmp___40;
#line 302
  strcpy((char */* __restrict  */)knocker_core_services_db[117], (char const   */* __restrict  */)"uucp-path");
  }
#line 304
  if ((unsigned long )knocker_core_services_db[117] == (unsigned long )((void *)0)) {
#line 305
    return (-1);
  }
  {
#line 307
  tmp___41 = malloc((size_t )5);
#line 307
  knocker_core_services_db[119] = (char *)tmp___41;
#line 308
  strcpy((char */* __restrict  */)knocker_core_services_db[119], (char const   */* __restrict  */)"nntp");
  }
#line 310
  if ((unsigned long )knocker_core_services_db[119] == (unsigned long )((void *)0)) {
#line 311
    return (-1);
  }
  {
#line 313
  tmp___42 = malloc((size_t )4);
#line 313
  knocker_core_services_db[123] = (char *)tmp___42;
#line 314
  strcpy((char */* __restrict  */)knocker_core_services_db[123], (char const   */* __restrict  */)"ntp");
  }
#line 316
  if ((unsigned long )knocker_core_services_db[123] == (unsigned long )((void *)0)) {
#line 317
    return (-1);
  }
  {
#line 319
  tmp___43 = malloc((size_t )7);
#line 319
  knocker_core_services_db[129] = (char *)tmp___43;
#line 320
  strcpy((char */* __restrict  */)knocker_core_services_db[129], (char const   */* __restrict  */)"pwdgen");
  }
#line 322
  if ((unsigned long )knocker_core_services_db[129] == (unsigned long )((void *)0)) {
#line 323
    return (-1);
  }
  {
#line 325
  tmp___44 = malloc((size_t )11);
#line 325
  knocker_core_services_db[137] = (char *)tmp___44;
#line 326
  strcpy((char */* __restrict  */)knocker_core_services_db[137], (char const   */* __restrict  */)"netbios-ns");
  }
#line 328
  if ((unsigned long )knocker_core_services_db[137] == (unsigned long )((void *)0)) {
#line 329
    return (-1);
  }
  {
#line 331
  tmp___45 = malloc((size_t )12);
#line 331
  knocker_core_services_db[138] = (char *)tmp___45;
#line 332
  strcpy((char */* __restrict  */)knocker_core_services_db[138], (char const   */* __restrict  */)"netbios-dgm");
  }
#line 334
  if ((unsigned long )knocker_core_services_db[138] == (unsigned long )((void *)0)) {
#line 335
    return (-1);
  }
  {
#line 337
  tmp___46 = malloc((size_t )12);
#line 337
  knocker_core_services_db[139] = (char *)tmp___46;
#line 338
  strcpy((char */* __restrict  */)knocker_core_services_db[139], (char const   */* __restrict  */)"netbios-ssn");
  }
#line 340
  if ((unsigned long )knocker_core_services_db[139] == (unsigned long )((void *)0)) {
#line 341
    return (-1);
  }
  {
#line 343
  tmp___47 = malloc((size_t )6);
#line 343
  knocker_core_services_db[143] = (char *)tmp___47;
#line 344
  strcpy((char */* __restrict  */)knocker_core_services_db[143], (char const   */* __restrict  */)"imap2");
  }
#line 346
  if ((unsigned long )knocker_core_services_db[143] == (unsigned long )((void *)0)) {
#line 347
    return (-1);
  }
  {
#line 349
  tmp___48 = malloc((size_t )5);
#line 349
  knocker_core_services_db[161] = (char *)tmp___48;
#line 350
  strcpy((char */* __restrict  */)knocker_core_services_db[161], (char const   */* __restrict  */)"snmp");
  }
#line 352
  if ((unsigned long )knocker_core_services_db[161] == (unsigned long )((void *)0)) {
#line 353
    return (-1);
  }
  {
#line 355
  tmp___49 = malloc((size_t )10);
#line 355
  knocker_core_services_db[162] = (char *)tmp___49;
#line 356
  strcpy((char */* __restrict  */)knocker_core_services_db[162], (char const   */* __restrict  */)"snmp-trap");
  }
#line 358
  if ((unsigned long )knocker_core_services_db[162] == (unsigned long )((void *)0)) {
#line 359
    return (-1);
  }
  {
#line 361
  tmp___50 = malloc((size_t )9);
#line 361
  knocker_core_services_db[163] = (char *)tmp___50;
#line 362
  strcpy((char */* __restrict  */)knocker_core_services_db[163], (char const   */* __restrict  */)"cmip-man");
  }
#line 364
  if ((unsigned long )knocker_core_services_db[163] == (unsigned long )((void *)0)) {
#line 365
    return (-1);
  }
  {
#line 367
  tmp___51 = malloc((size_t )11);
#line 367
  knocker_core_services_db[164] = (char *)tmp___51;
#line 368
  strcpy((char */* __restrict  */)knocker_core_services_db[164], (char const   */* __restrict  */)"cmip-agent");
  }
#line 370
  if ((unsigned long )knocker_core_services_db[164] == (unsigned long )((void *)0)) {
#line 371
    return (-1);
  }
  {
#line 373
  tmp___52 = malloc((size_t )6);
#line 373
  knocker_core_services_db[174] = (char *)tmp___52;
#line 374
  strcpy((char */* __restrict  */)knocker_core_services_db[174], (char const   */* __restrict  */)"mailq");
  }
#line 376
  if ((unsigned long )knocker_core_services_db[174] == (unsigned long )((void *)0)) {
#line 377
    return (-1);
  }
  {
#line 379
  tmp___53 = malloc((size_t )6);
#line 379
  knocker_core_services_db[177] = (char *)tmp___53;
#line 380
  strcpy((char */* __restrict  */)knocker_core_services_db[177], (char const   */* __restrict  */)"xdmcp");
  }
#line 382
  if ((unsigned long )knocker_core_services_db[177] == (unsigned long )((void *)0)) {
#line 383
    return (-1);
  }
  {
#line 385
  tmp___54 = malloc((size_t )9);
#line 385
  knocker_core_services_db[178] = (char *)tmp___54;
#line 386
  strcpy((char */* __restrict  */)knocker_core_services_db[178], (char const   */* __restrict  */)"nextstep");
  }
#line 388
  if ((unsigned long )knocker_core_services_db[178] == (unsigned long )((void *)0)) {
#line 389
    return (-1);
  }
  {
#line 391
  tmp___55 = malloc((size_t )4);
#line 391
  knocker_core_services_db[179] = (char *)tmp___55;
#line 392
  strcpy((char */* __restrict  */)knocker_core_services_db[179], (char const   */* __restrict  */)"bgp");
  }
#line 394
  if ((unsigned long )knocker_core_services_db[179] == (unsigned long )((void *)0)) {
#line 395
    return (-1);
  }
  {
#line 397
  tmp___56 = malloc((size_t )9);
#line 397
  knocker_core_services_db[191] = (char *)tmp___56;
#line 398
  strcpy((char */* __restrict  */)knocker_core_services_db[191], (char const   */* __restrict  */)"prospero");
  }
#line 400
  if ((unsigned long )knocker_core_services_db[191] == (unsigned long )((void *)0)) {
#line 401
    return (-1);
  }
  {
#line 403
  tmp___57 = malloc((size_t )4);
#line 403
  knocker_core_services_db[194] = (char *)tmp___57;
#line 404
  strcpy((char */* __restrict  */)knocker_core_services_db[194], (char const   */* __restrict  */)"irc");
  }
#line 406
  if ((unsigned long )knocker_core_services_db[194] == (unsigned long )((void *)0)) {
#line 407
    return (-1);
  }
  {
#line 409
  tmp___58 = malloc((size_t )5);
#line 409
  knocker_core_services_db[199] = (char *)tmp___58;
#line 410
  strcpy((char */* __restrict  */)knocker_core_services_db[199], (char const   */* __restrict  */)"smux");
  }
#line 412
  if ((unsigned long )knocker_core_services_db[199] == (unsigned long )((void *)0)) {
#line 413
    return (-1);
  }
  {
#line 415
  tmp___59 = malloc((size_t )8);
#line 415
  knocker_core_services_db[201] = (char *)tmp___59;
#line 416
  strcpy((char */* __restrict  */)knocker_core_services_db[201], (char const   */* __restrict  */)"at-rtmp");
  }
#line 418
  if ((unsigned long )knocker_core_services_db[201] == (unsigned long )((void *)0)) {
#line 419
    return (-1);
  }
  {
#line 421
  tmp___60 = malloc((size_t )7);
#line 421
  knocker_core_services_db[202] = (char *)tmp___60;
#line 422
  strcpy((char */* __restrict  */)knocker_core_services_db[202], (char const   */* __restrict  */)"at-nbp");
  }
#line 424
  if ((unsigned long )knocker_core_services_db[202] == (unsigned long )((void *)0)) {
#line 425
    return (-1);
  }
  {
#line 427
  tmp___61 = malloc((size_t )8);
#line 427
  knocker_core_services_db[204] = (char *)tmp___61;
#line 428
  strcpy((char */* __restrict  */)knocker_core_services_db[204], (char const   */* __restrict  */)"at-echo");
  }
#line 430
  if ((unsigned long )knocker_core_services_db[204] == (unsigned long )((void *)0)) {
#line 431
    return (-1);
  }
  {
#line 433
  tmp___62 = malloc((size_t )7);
#line 433
  knocker_core_services_db[206] = (char *)tmp___62;
#line 434
  strcpy((char */* __restrict  */)knocker_core_services_db[206], (char const   */* __restrict  */)"at-zis");
  }
#line 436
  if ((unsigned long )knocker_core_services_db[206] == (unsigned long )((void *)0)) {
#line 437
    return (-1);
  }
  {
#line 439
  tmp___63 = malloc((size_t )5);
#line 439
  knocker_core_services_db[209] = (char *)tmp___63;
#line 440
  strcpy((char */* __restrict  */)knocker_core_services_db[209], (char const   */* __restrict  */)"qmtp");
  }
#line 442
  if ((unsigned long )knocker_core_services_db[209] == (unsigned long )((void *)0)) {
#line 443
    return (-1);
  }
  {
#line 445
  tmp___64 = malloc((size_t )6);
#line 445
  knocker_core_services_db[210] = (char *)tmp___64;
#line 446
  strcpy((char */* __restrict  */)knocker_core_services_db[210], (char const   */* __restrict  */)"z3950");
  }
#line 448
  if ((unsigned long )knocker_core_services_db[210] == (unsigned long )((void *)0)) {
#line 449
    return (-1);
  }
  {
#line 451
  tmp___65 = malloc((size_t )4);
#line 451
  knocker_core_services_db[213] = (char *)tmp___65;
#line 452
  strcpy((char */* __restrict  */)knocker_core_services_db[213], (char const   */* __restrict  */)"ipx");
  }
#line 454
  if ((unsigned long )knocker_core_services_db[213] == (unsigned long )((void *)0)) {
#line 455
    return (-1);
  }
  {
#line 457
  tmp___66 = malloc((size_t )6);
#line 457
  knocker_core_services_db[220] = (char *)tmp___66;
#line 458
  strcpy((char */* __restrict  */)knocker_core_services_db[220], (char const   */* __restrict  */)"imap3");
  }
#line 460
  if ((unsigned long )knocker_core_services_db[220] == (unsigned long )((void *)0)) {
#line 461
    return (-1);
  }
  {
#line 463
  tmp___67 = malloc((size_t )12);
#line 463
  knocker_core_services_db[369] = (char *)tmp___67;
#line 464
  strcpy((char */* __restrict  */)knocker_core_services_db[369], (char const   */* __restrict  */)"rpc2portmap");
  }
#line 466
  if ((unsigned long )knocker_core_services_db[369] == (unsigned long )((void *)0)) {
#line 467
    return (-1);
  }
  {
#line 469
  tmp___68 = malloc((size_t )10);
#line 469
  knocker_core_services_db[370] = (char *)tmp___68;
#line 470
  strcpy((char */* __restrict  */)knocker_core_services_db[370], (char const   */* __restrict  */)"codaauth2");
  }
#line 472
  if ((unsigned long )knocker_core_services_db[370] == (unsigned long )((void *)0)) {
#line 473
    return (-1);
  }
  {
#line 475
  tmp___69 = malloc((size_t )10);
#line 475
  knocker_core_services_db[372] = (char *)tmp___69;
#line 476
  strcpy((char */* __restrict  */)knocker_core_services_db[372], (char const   */* __restrict  */)"ulistserv");
  }
#line 478
  if ((unsigned long )knocker_core_services_db[372] == (unsigned long )((void *)0)) {
#line 479
    return (-1);
  }
  {
#line 481
  tmp___70 = malloc((size_t )5);
#line 481
  knocker_core_services_db[389] = (char *)tmp___70;
#line 482
  strcpy((char */* __restrict  */)knocker_core_services_db[389], (char const   */* __restrict  */)"ldap");
  }
#line 484
  if ((unsigned long )knocker_core_services_db[389] == (unsigned long )((void *)0)) {
#line 485
    return (-1);
  }
  {
#line 487
  tmp___71 = malloc((size_t )6);
#line 487
  knocker_core_services_db[443] = (char *)tmp___71;
#line 488
  strcpy((char */* __restrict  */)knocker_core_services_db[443], (char const   */* __restrict  */)"https");
  }
#line 490
  if ((unsigned long )knocker_core_services_db[443] == (unsigned long )((void *)0)) {
#line 491
    return (-1);
  }
  {
#line 493
  tmp___72 = malloc((size_t )5);
#line 493
  knocker_core_services_db[444] = (char *)tmp___72;
#line 494
  strcpy((char */* __restrict  */)knocker_core_services_db[444], (char const   */* __restrict  */)"snpp");
  }
#line 496
  if ((unsigned long )knocker_core_services_db[444] == (unsigned long )((void *)0)) {
#line 497
    return (-1);
  }
  {
#line 499
  tmp___73 = malloc((size_t )5);
#line 499
  knocker_core_services_db[487] = (char *)tmp___73;
#line 500
  strcpy((char */* __restrict  */)knocker_core_services_db[487], (char const   */* __restrict  */)"saft");
  }
#line 502
  if ((unsigned long )knocker_core_services_db[487] == (unsigned long )((void *)0)) {
#line 503
    return (-1);
  }
  {
#line 505
  tmp___74 = malloc((size_t )11);
#line 505
  knocker_core_services_db[610] = (char *)tmp___74;
#line 506
  strcpy((char */* __restrict  */)knocker_core_services_db[610], (char const   */* __restrict  */)"npmp-local");
  }
#line 508
  if ((unsigned long )knocker_core_services_db[610] == (unsigned long )((void *)0)) {
#line 509
    return (-1);
  }
  {
#line 511
  tmp___75 = malloc((size_t )9);
#line 511
  knocker_core_services_db[611] = (char *)tmp___75;
#line 512
  strcpy((char */* __restrict  */)knocker_core_services_db[611], (char const   */* __restrict  */)"npmp-gui");
  }
#line 514
  if ((unsigned long )knocker_core_services_db[611] == (unsigned long )((void *)0)) {
#line 515
    return (-1);
  }
  {
#line 517
  tmp___76 = malloc((size_t )9);
#line 517
  knocker_core_services_db[612] = (char *)tmp___76;
#line 518
  strcpy((char */* __restrict  */)knocker_core_services_db[612], (char const   */* __restrict  */)"hmmp-ind");
  }
#line 520
  if ((unsigned long )knocker_core_services_db[612] == (unsigned long )((void *)0)) {
#line 521
    return (-1);
  }
  {
#line 523
  tmp___77 = malloc((size_t )4);
#line 523
  knocker_core_services_db[631] = (char *)tmp___77;
#line 524
  strcpy((char */* __restrict  */)knocker_core_services_db[631], (char const   */* __restrict  */)"ipp");
  }
#line 526
  if ((unsigned long )knocker_core_services_db[631] == (unsigned long )((void *)0)) {
#line 527
    return (-1);
  }
  {
#line 529
  tmp___78 = malloc((size_t )5);
#line 529
  knocker_core_services_db[512] = (char *)tmp___78;
#line 530
  strcpy((char */* __restrict  */)knocker_core_services_db[512], (char const   */* __restrict  */)"exec");
  }
#line 532
  if ((unsigned long )knocker_core_services_db[512] == (unsigned long )((void *)0)) {
#line 533
    return (-1);
  }
  {
#line 535
  tmp___79 = malloc((size_t )6);
#line 535
  knocker_core_services_db[513] = (char *)tmp___79;
#line 536
  strcpy((char */* __restrict  */)knocker_core_services_db[513], (char const   */* __restrict  */)"login");
  }
#line 538
  if ((unsigned long )knocker_core_services_db[513] == (unsigned long )((void *)0)) {
#line 539
    return (-1);
  }
  {
#line 541
  tmp___80 = malloc((size_t )6);
#line 541
  knocker_core_services_db[514] = (char *)tmp___80;
#line 542
  strcpy((char */* __restrict  */)knocker_core_services_db[514], (char const   */* __restrict  */)"shell");
  }
#line 544
  if ((unsigned long )knocker_core_services_db[514] == (unsigned long )((void *)0)) {
#line 545
    return (-1);
  }
  {
#line 547
  tmp___81 = malloc((size_t )8);
#line 547
  knocker_core_services_db[515] = (char *)tmp___81;
#line 548
  strcpy((char */* __restrict  */)knocker_core_services_db[515], (char const   */* __restrict  */)"printer");
  }
#line 550
  if ((unsigned long )knocker_core_services_db[515] == (unsigned long )((void *)0)) {
#line 551
    return (-1);
  }
  {
#line 553
  tmp___82 = malloc((size_t )5);
#line 553
  knocker_core_services_db[517] = (char *)tmp___82;
#line 554
  strcpy((char */* __restrict  */)knocker_core_services_db[517], (char const   */* __restrict  */)"talk");
  }
#line 556
  if ((unsigned long )knocker_core_services_db[517] == (unsigned long )((void *)0)) {
#line 557
    return (-1);
  }
  {
#line 559
  tmp___83 = malloc((size_t )6);
#line 559
  knocker_core_services_db[518] = (char *)tmp___83;
#line 560
  strcpy((char */* __restrict  */)knocker_core_services_db[518], (char const   */* __restrict  */)"ntalk");
  }
#line 562
  if ((unsigned long )knocker_core_services_db[518] == (unsigned long )((void *)0)) {
#line 563
    return (-1);
  }
  {
#line 565
  tmp___84 = malloc((size_t )6);
#line 565
  knocker_core_services_db[520] = (char *)tmp___84;
#line 566
  strcpy((char */* __restrict  */)knocker_core_services_db[520], (char const   */* __restrict  */)"route");
  }
#line 568
  if ((unsigned long )knocker_core_services_db[520] == (unsigned long )((void *)0)) {
#line 569
    return (-1);
  }
  {
#line 571
  tmp___85 = malloc((size_t )6);
#line 571
  knocker_core_services_db[525] = (char *)tmp___85;
#line 572
  strcpy((char */* __restrict  */)knocker_core_services_db[525], (char const   */* __restrict  */)"timed");
  }
#line 574
  if ((unsigned long )knocker_core_services_db[525] == (unsigned long )((void *)0)) {
#line 575
    return (-1);
  }
  {
#line 577
  tmp___86 = malloc((size_t )6);
#line 577
  knocker_core_services_db[526] = (char *)tmp___86;
#line 578
  strcpy((char */* __restrict  */)knocker_core_services_db[526], (char const   */* __restrict  */)"tempo");
  }
#line 580
  if ((unsigned long )knocker_core_services_db[526] == (unsigned long )((void *)0)) {
#line 581
    return (-1);
  }
  {
#line 583
  tmp___87 = malloc((size_t )8);
#line 583
  knocker_core_services_db[530] = (char *)tmp___87;
#line 584
  strcpy((char */* __restrict  */)knocker_core_services_db[530], (char const   */* __restrict  */)"courier");
  }
#line 586
  if ((unsigned long )knocker_core_services_db[530] == (unsigned long )((void *)0)) {
#line 587
    return (-1);
  }
  {
#line 589
  tmp___88 = malloc((size_t )11);
#line 589
  knocker_core_services_db[531] = (char *)tmp___88;
#line 590
  strcpy((char */* __restrict  */)knocker_core_services_db[531], (char const   */* __restrict  */)"conference");
  }
#line 592
  if ((unsigned long )knocker_core_services_db[531] == (unsigned long )((void *)0)) {
#line 593
    return (-1);
  }
  {
#line 595
  tmp___89 = malloc((size_t )8);
#line 595
  knocker_core_services_db[532] = (char *)tmp___89;
#line 596
  strcpy((char */* __restrict  */)knocker_core_services_db[532], (char const   */* __restrict  */)"netnews");
  }
#line 598
  if ((unsigned long )knocker_core_services_db[532] == (unsigned long )((void *)0)) {
#line 599
    return (-1);
  }
  {
#line 601
  tmp___90 = malloc((size_t )8);
#line 601
  knocker_core_services_db[533] = (char *)tmp___90;
#line 602
  strcpy((char */* __restrict  */)knocker_core_services_db[533], (char const   */* __restrict  */)"netwall");
  }
#line 604
  if ((unsigned long )knocker_core_services_db[533] == (unsigned long )((void *)0)) {
#line 605
    return (-1);
  }
  {
#line 607
  tmp___91 = malloc((size_t )7);
#line 607
  knocker_core_services_db[538] = (char *)tmp___91;
#line 608
  strcpy((char */* __restrict  */)knocker_core_services_db[538], (char const   */* __restrict  */)"gdomap");
  }
#line 610
  if ((unsigned long )knocker_core_services_db[538] == (unsigned long )((void *)0)) {
#line 611
    return (-1);
  }
  {
#line 613
  tmp___92 = malloc((size_t )5);
#line 613
  knocker_core_services_db[540] = (char *)tmp___92;
#line 614
  strcpy((char */* __restrict  */)knocker_core_services_db[540], (char const   */* __restrict  */)"uucp");
  }
#line 616
  if ((unsigned long )knocker_core_services_db[540] == (unsigned long )((void *)0)) {
#line 617
    return (-1);
  }
  {
#line 619
  tmp___93 = malloc((size_t )11);
#line 619
  knocker_core_services_db[548] = (char *)tmp___93;
#line 620
  strcpy((char */* __restrict  */)knocker_core_services_db[548], (char const   */* __restrict  */)"afpovertcp");
  }
#line 622
  if ((unsigned long )knocker_core_services_db[548] == (unsigned long )((void *)0)) {
#line 623
    return (-1);
  }
  {
#line 625
  tmp___94 = malloc((size_t )9);
#line 625
  knocker_core_services_db[556] = (char *)tmp___94;
#line 626
  strcpy((char */* __restrict  */)knocker_core_services_db[556], (char const   */* __restrict  */)"remotefs");
  }
#line 628
  if ((unsigned long )knocker_core_services_db[556] == (unsigned long )((void *)0)) {
#line 629
    return (-1);
  }
  {
#line 631
  tmp___95 = malloc((size_t )7);
#line 631
  knocker_core_services_db[543] = (char *)tmp___95;
#line 632
  strcpy((char */* __restrict  */)knocker_core_services_db[543], (char const   */* __restrict  */)"klogin");
  }
#line 634
  if ((unsigned long )knocker_core_services_db[543] == (unsigned long )((void *)0)) {
#line 635
    return (-1);
  }
  {
#line 637
  tmp___96 = malloc((size_t )7);
#line 637
  knocker_core_services_db[544] = (char *)tmp___96;
#line 638
  strcpy((char */* __restrict  */)knocker_core_services_db[544], (char const   */* __restrict  */)"kshell");
  }
#line 640
  if ((unsigned long )knocker_core_services_db[544] == (unsigned long )((void *)0)) {
#line 641
    return (-1);
  }
  {
#line 643
  tmp___97 = malloc((size_t )6);
#line 643
  knocker_core_services_db[563] = (char *)tmp___97;
#line 644
  strcpy((char */* __restrict  */)knocker_core_services_db[563], (char const   */* __restrict  */)"nntps");
  }
#line 646
  if ((unsigned long )knocker_core_services_db[563] == (unsigned long )((void *)0)) {
#line 647
    return (-1);
  }
  {
#line 649
  tmp___98 = malloc((size_t )6);
#line 649
  knocker_core_services_db[636] = (char *)tmp___98;
#line 650
  strcpy((char */* __restrict  */)knocker_core_services_db[636], (char const   */* __restrict  */)"ldaps");
  }
#line 652
  if ((unsigned long )knocker_core_services_db[636] == (unsigned long )((void *)0)) {
#line 653
    return (-1);
  }
  {
#line 655
  tmp___99 = malloc((size_t )5);
#line 655
  knocker_core_services_db[655] = (char *)tmp___99;
#line 656
  strcpy((char */* __restrict  */)knocker_core_services_db[655], (char const   */* __restrict  */)"tinc");
  }
#line 658
  if ((unsigned long )knocker_core_services_db[655] == (unsigned long )((void *)0)) {
#line 659
    return (-1);
  }
  {
#line 661
  tmp___100 = malloc((size_t )13);
#line 661
  knocker_core_services_db[749] = (char *)tmp___100;
#line 662
  strcpy((char */* __restrict  */)knocker_core_services_db[749], (char const   */* __restrict  */)"kerberos-adm");
  }
#line 664
  if ((unsigned long )knocker_core_services_db[749] == (unsigned long )((void *)0)) {
#line 665
    return (-1);
  }
  {
#line 667
  tmp___101 = malloc((size_t )8);
#line 667
  knocker_core_services_db[765] = (char *)tmp___101;
#line 668
  strcpy((char */* __restrict  */)knocker_core_services_db[765], (char const   */* __restrict  */)"webster");
  }
#line 670
  if ((unsigned long )knocker_core_services_db[765] == (unsigned long )((void *)0)) {
#line 671
    return (-1);
  }
  {
#line 673
  tmp___102 = malloc((size_t )6);
#line 673
  knocker_core_services_db[873] = (char *)tmp___102;
#line 674
  strcpy((char */* __restrict  */)knocker_core_services_db[873], (char const   */* __restrict  */)"rsync");
  }
#line 676
  if ((unsigned long )knocker_core_services_db[873] == (unsigned long )((void *)0)) {
#line 677
    return (-1);
  }
  {
#line 679
  tmp___103 = malloc((size_t )10);
#line 679
  knocker_core_services_db[989] = (char *)tmp___103;
#line 680
  strcpy((char */* __restrict  */)knocker_core_services_db[989], (char const   */* __restrict  */)"ftps-data");
  }
#line 682
  if ((unsigned long )knocker_core_services_db[989] == (unsigned long )((void *)0)) {
#line 683
    return (-1);
  }
  {
#line 685
  tmp___104 = malloc((size_t )5);
#line 685
  knocker_core_services_db[990] = (char *)tmp___104;
#line 686
  strcpy((char */* __restrict  */)knocker_core_services_db[990], (char const   */* __restrict  */)"ftps");
  }
#line 688
  if ((unsigned long )knocker_core_services_db[990] == (unsigned long )((void *)0)) {
#line 689
    return (-1);
  }
  {
#line 691
  tmp___105 = malloc((size_t )8);
#line 691
  knocker_core_services_db[992] = (char *)tmp___105;
#line 692
  strcpy((char */* __restrict  */)knocker_core_services_db[992], (char const   */* __restrict  */)"telnets");
  }
#line 694
  if ((unsigned long )knocker_core_services_db[992] == (unsigned long )((void *)0)) {
#line 695
    return (-1);
  }
  {
#line 697
  tmp___106 = malloc((size_t )6);
#line 697
  knocker_core_services_db[993] = (char *)tmp___106;
#line 698
  strcpy((char */* __restrict  */)knocker_core_services_db[993], (char const   */* __restrict  */)"imaps");
  }
#line 700
  if ((unsigned long )knocker_core_services_db[993] == (unsigned long )((void *)0)) {
#line 701
    return (-1);
  }
  {
#line 703
  tmp___107 = malloc((size_t )5);
#line 703
  knocker_core_services_db[994] = (char *)tmp___107;
#line 704
  strcpy((char */* __restrict  */)knocker_core_services_db[994], (char const   */* __restrict  */)"ircs");
  }
#line 706
  if ((unsigned long )knocker_core_services_db[994] == (unsigned long )((void *)0)) {
#line 707
    return (-1);
  }
  {
#line 709
  tmp___108 = malloc((size_t )6);
#line 709
  knocker_core_services_db[995] = (char *)tmp___108;
#line 710
  strcpy((char */* __restrict  */)knocker_core_services_db[995], (char const   */* __restrict  */)"pop3s");
  }
#line 712
  if ((unsigned long )knocker_core_services_db[995] == (unsigned long )((void *)0)) {
#line 713
    return (-1);
  }
  {
#line 715
  tmp___109 = malloc((size_t )6);
#line 715
  knocker_core_services_db[1080] = (char *)tmp___109;
#line 716
  strcpy((char */* __restrict  */)knocker_core_services_db[1080], (char const   */* __restrict  */)"socks");
  }
#line 718
  if ((unsigned long )knocker_core_services_db[1080] == (unsigned long )((void *)0)) {
#line 719
    return (-1);
  }
  {
#line 721
  tmp___110 = malloc((size_t )10);
#line 721
  knocker_core_services_db[1352] = (char *)tmp___110;
#line 722
  strcpy((char */* __restrict  */)knocker_core_services_db[1352], (char const   */* __restrict  */)"lotusnote");
  }
#line 724
  if ((unsigned long )knocker_core_services_db[1352] == (unsigned long )((void *)0)) {
#line 725
    return (-1);
  }
  {
#line 727
  tmp___111 = malloc((size_t )11);
#line 727
  knocker_core_services_db[1524] = (char *)tmp___111;
#line 728
  strcpy((char */* __restrict  */)knocker_core_services_db[1524], (char const   */* __restrict  */)"ingreslock");
  }
#line 730
  if ((unsigned long )knocker_core_services_db[1524] == (unsigned long )((void *)0)) {
#line 731
    return (-1);
  }
  {
#line 733
  tmp___112 = malloc((size_t )12);
#line 733
  knocker_core_services_db[1525] = (char *)tmp___112;
#line 734
  strcpy((char */* __restrict  */)knocker_core_services_db[1525], (char const   */* __restrict  */)"prospero-np");
  }
#line 736
  if ((unsigned long )knocker_core_services_db[1525] == (unsigned long )((void *)0)) {
#line 737
    return (-1);
  }
  {
#line 739
  tmp___113 = malloc((size_t )12);
#line 739
  knocker_core_services_db[1645] = (char *)tmp___113;
#line 740
  strcpy((char */* __restrict  */)knocker_core_services_db[1645], (char const   */* __restrict  */)"datametrics");
  }
#line 742
  if ((unsigned long )knocker_core_services_db[1645] == (unsigned long )((void *)0)) {
#line 743
    return (-1);
  }
  {
#line 745
  tmp___114 = malloc((size_t )12);
#line 745
  knocker_core_services_db[1646] = (char *)tmp___114;
#line 746
  strcpy((char */* __restrict  */)knocker_core_services_db[1646], (char const   */* __restrict  */)"sa-msg-port");
  }
#line 748
  if ((unsigned long )knocker_core_services_db[1646] == (unsigned long )((void *)0)) {
#line 749
    return (-1);
  }
  {
#line 751
  tmp___115 = malloc((size_t )7);
#line 751
  knocker_core_services_db[1812] = (char *)tmp___115;
#line 752
  strcpy((char */* __restrict  */)knocker_core_services_db[1812], (char const   */* __restrict  */)"radius");
  }
#line 754
  if ((unsigned long )knocker_core_services_db[1812] == (unsigned long )((void *)0)) {
#line 755
    return (-1);
  }
  {
#line 757
  tmp___116 = malloc((size_t )12);
#line 757
  knocker_core_services_db[1813] = (char *)tmp___116;
#line 758
  strcpy((char */* __restrict  */)knocker_core_services_db[1813], (char const   */* __restrict  */)"radius-acct");
  }
#line 760
  if ((unsigned long )knocker_core_services_db[1813] == (unsigned long )((void *)0)) {
#line 761
    return (-1);
  }
  {
#line 763
  tmp___117 = malloc((size_t )11);
#line 763
  knocker_core_services_db[2101] = (char *)tmp___117;
#line 764
  strcpy((char */* __restrict  */)knocker_core_services_db[2101], (char const   */* __restrict  */)"rtcm-sc104");
  }
#line 766
  if ((unsigned long )knocker_core_services_db[2101] == (unsigned long )((void *)0)) {
#line 767
    return (-1);
  }
  {
#line 769
  tmp___118 = malloc((size_t )11);
#line 769
  knocker_core_services_db[2401] = (char *)tmp___118;
#line 770
  strcpy((char */* __restrict  */)knocker_core_services_db[2401], (char const   */* __restrict  */)"cvspserver");
  }
#line 772
  if ((unsigned long )knocker_core_services_db[2401] == (unsigned long )((void *)0)) {
#line 773
    return (-1);
  }
  {
#line 775
  tmp___119 = malloc((size_t )6);
#line 775
  knocker_core_services_db[2430] = (char *)tmp___119;
#line 776
  strcpy((char */* __restrict  */)knocker_core_services_db[2430], (char const   */* __restrict  */)"venus");
  }
#line 778
  if ((unsigned long )knocker_core_services_db[2430] == (unsigned long )((void *)0)) {
#line 779
    return (-1);
  }
  {
#line 781
  tmp___120 = malloc((size_t )9);
#line 781
  knocker_core_services_db[2431] = (char *)tmp___120;
#line 782
  strcpy((char */* __restrict  */)knocker_core_services_db[2431], (char const   */* __restrict  */)"venus-se");
  }
#line 784
  if ((unsigned long )knocker_core_services_db[2431] == (unsigned long )((void *)0)) {
#line 785
    return (-1);
  }
  {
#line 787
  tmp___121 = malloc((size_t )8);
#line 787
  knocker_core_services_db[2432] = (char *)tmp___121;
#line 788
  strcpy((char */* __restrict  */)knocker_core_services_db[2432], (char const   */* __restrict  */)"codasrv");
  }
#line 790
  if ((unsigned long )knocker_core_services_db[2432] == (unsigned long )((void *)0)) {
#line 791
    return (-1);
  }
  {
#line 793
  tmp___122 = malloc((size_t )11);
#line 793
  knocker_core_services_db[2433] = (char *)tmp___122;
#line 794
  strcpy((char */* __restrict  */)knocker_core_services_db[2433], (char const   */* __restrict  */)"codasrv-se");
  }
#line 796
  if ((unsigned long )knocker_core_services_db[2433] == (unsigned long )((void *)0)) {
#line 797
    return (-1);
  }
  {
#line 799
  tmp___123 = malloc((size_t )4);
#line 799
  knocker_core_services_db[2583] = (char *)tmp___123;
#line 800
  strcpy((char */* __restrict  */)knocker_core_services_db[2583], (char const   */* __restrict  */)"mon");
  }
#line 802
  if ((unsigned long )knocker_core_services_db[2583] == (unsigned long )((void *)0)) {
#line 803
    return (-1);
  }
  {
#line 805
  tmp___124 = malloc((size_t )5);
#line 805
  knocker_core_services_db[2628] = (char *)tmp___124;
#line 806
  strcpy((char */* __restrict  */)knocker_core_services_db[2628], (char const   */* __restrict  */)"dict");
  }
#line 808
  if ((unsigned long )knocker_core_services_db[2628] == (unsigned long )((void *)0)) {
#line 809
    return (-1);
  }
  {
#line 811
  tmp___125 = malloc((size_t )7);
#line 811
  knocker_core_services_db[3050] = (char *)tmp___125;
#line 812
  strcpy((char */* __restrict  */)knocker_core_services_db[3050], (char const   */* __restrict  */)"gds_db");
  }
#line 814
  if ((unsigned long )knocker_core_services_db[3050] == (unsigned long )((void *)0)) {
#line 815
    return (-1);
  }
  {
#line 817
  tmp___126 = malloc((size_t )6);
#line 817
  knocker_core_services_db[3130] = (char *)tmp___126;
#line 818
  strcpy((char */* __restrict  */)knocker_core_services_db[3130], (char const   */* __restrict  */)"icpv2");
  }
#line 820
  if ((unsigned long )knocker_core_services_db[3130] == (unsigned long )((void *)0)) {
#line 821
    return (-1);
  }
  {
#line 823
  tmp___127 = malloc((size_t )6);
#line 823
  knocker_core_services_db[3306] = (char *)tmp___127;
#line 824
  strcpy((char */* __restrict  */)knocker_core_services_db[3306], (char const   */* __restrict  */)"mysql");
  }
#line 826
  if ((unsigned long )knocker_core_services_db[3306] == (unsigned long )((void *)0)) {
#line 827
    return (-1);
  }
  {
#line 829
  tmp___128 = malloc((size_t )4);
#line 829
  knocker_core_services_db[5002] = (char *)tmp___128;
#line 830
  strcpy((char */* __restrict  */)knocker_core_services_db[5002], (char const   */* __restrict  */)"rfe");
  }
#line 832
  if ((unsigned long )knocker_core_services_db[5002] == (unsigned long )((void *)0)) {
#line 833
    return (-1);
  }
  {
#line 835
  tmp___129 = malloc((size_t )9);
#line 835
  knocker_core_services_db[5308] = (char *)tmp___129;
#line 836
  strcpy((char */* __restrict  */)knocker_core_services_db[5308], (char const   */* __restrict  */)"cfengine");
  }
#line 838
  if ((unsigned long )knocker_core_services_db[5308] == (unsigned long )((void *)0)) {
#line 839
    return (-1);
  }
  {
#line 841
  tmp___130 = malloc((size_t )4);
#line 841
  knocker_core_services_db[6000] = (char *)tmp___130;
#line 842
  strcpy((char */* __restrict  */)knocker_core_services_db[6000], (char const   */* __restrict  */)"x11");
  }
#line 844
  if ((unsigned long )knocker_core_services_db[6000] == (unsigned long )((void *)0)) {
#line 845
    return (-1);
  }
  {
#line 847
  tmp___131 = malloc((size_t )6);
#line 847
  knocker_core_services_db[6001] = (char *)tmp___131;
#line 848
  strcpy((char */* __restrict  */)knocker_core_services_db[6001], (char const   */* __restrict  */)"x11-1");
  }
#line 850
  if ((unsigned long )knocker_core_services_db[6001] == (unsigned long )((void *)0)) {
#line 851
    return (-1);
  }
  {
#line 853
  tmp___132 = malloc((size_t )6);
#line 853
  knocker_core_services_db[6002] = (char *)tmp___132;
#line 854
  strcpy((char */* __restrict  */)knocker_core_services_db[6002], (char const   */* __restrict  */)"x11-2");
  }
#line 856
  if ((unsigned long )knocker_core_services_db[6002] == (unsigned long )((void *)0)) {
#line 857
    return (-1);
  }
  {
#line 859
  tmp___133 = malloc((size_t )6);
#line 859
  knocker_core_services_db[6003] = (char *)tmp___133;
#line 860
  strcpy((char */* __restrict  */)knocker_core_services_db[6003], (char const   */* __restrict  */)"x11-3");
  }
#line 862
  if ((unsigned long )knocker_core_services_db[6003] == (unsigned long )((void *)0)) {
#line 863
    return (-1);
  }
  {
#line 865
  tmp___134 = malloc((size_t )6);
#line 865
  knocker_core_services_db[6004] = (char *)tmp___134;
#line 866
  strcpy((char */* __restrict  */)knocker_core_services_db[6004], (char const   */* __restrict  */)"x11-4");
  }
#line 868
  if ((unsigned long )knocker_core_services_db[6004] == (unsigned long )((void *)0)) {
#line 869
    return (-1);
  }
  {
#line 871
  tmp___135 = malloc((size_t )6);
#line 871
  knocker_core_services_db[6005] = (char *)tmp___135;
#line 872
  strcpy((char */* __restrict  */)knocker_core_services_db[6005], (char const   */* __restrict  */)"x11-5");
  }
#line 874
  if ((unsigned long )knocker_core_services_db[6005] == (unsigned long )((void *)0)) {
#line 875
    return (-1);
  }
  {
#line 877
  tmp___136 = malloc((size_t )6);
#line 877
  knocker_core_services_db[6006] = (char *)tmp___136;
#line 878
  strcpy((char */* __restrict  */)knocker_core_services_db[6006], (char const   */* __restrict  */)"x11-6");
  }
#line 880
  if ((unsigned long )knocker_core_services_db[6006] == (unsigned long )((void *)0)) {
#line 881
    return (-1);
  }
  {
#line 883
  tmp___137 = malloc((size_t )6);
#line 883
  knocker_core_services_db[6007] = (char *)tmp___137;
#line 884
  strcpy((char */* __restrict  */)knocker_core_services_db[6007], (char const   */* __restrict  */)"x11-7");
  }
#line 886
  if ((unsigned long )knocker_core_services_db[6007] == (unsigned long )((void *)0)) {
#line 887
    return (-1);
  }
  {
#line 889
  tmp___138 = malloc((size_t )16);
#line 889
  knocker_core_services_db[7000] = (char *)tmp___138;
#line 890
  strcpy((char */* __restrict  */)knocker_core_services_db[7000], (char const   */* __restrict  */)"afs3-fileserver");
  }
#line 892
  if ((unsigned long )knocker_core_services_db[7000] == (unsigned long )((void *)0)) {
#line 893
    return (-1);
  }
  {
#line 895
  tmp___139 = malloc((size_t )14);
#line 895
  knocker_core_services_db[7001] = (char *)tmp___139;
#line 896
  strcpy((char */* __restrict  */)knocker_core_services_db[7001], (char const   */* __restrict  */)"afs3-callback");
  }
#line 898
  if ((unsigned long )knocker_core_services_db[7001] == (unsigned long )((void *)0)) {
#line 899
    return (-1);
  }
  {
#line 901
  tmp___140 = malloc((size_t )14);
#line 901
  knocker_core_services_db[7002] = (char *)tmp___140;
#line 902
  strcpy((char */* __restrict  */)knocker_core_services_db[7002], (char const   */* __restrict  */)"afs3-prserver");
  }
#line 904
  if ((unsigned long )knocker_core_services_db[7002] == (unsigned long )((void *)0)) {
#line 905
    return (-1);
  }
  {
#line 907
  tmp___141 = malloc((size_t )14);
#line 907
  knocker_core_services_db[7003] = (char *)tmp___141;
#line 908
  strcpy((char */* __restrict  */)knocker_core_services_db[7003], (char const   */* __restrict  */)"afs3-vlserver");
  }
#line 910
  if ((unsigned long )knocker_core_services_db[7003] == (unsigned long )((void *)0)) {
#line 911
    return (-1);
  }
  {
#line 913
  tmp___142 = malloc((size_t )14);
#line 913
  knocker_core_services_db[7004] = (char *)tmp___142;
#line 914
  strcpy((char */* __restrict  */)knocker_core_services_db[7004], (char const   */* __restrict  */)"afs3-kaserver");
  }
#line 916
  if ((unsigned long )knocker_core_services_db[7004] == (unsigned long )((void *)0)) {
#line 917
    return (-1);
  }
  {
#line 919
  tmp___143 = malloc((size_t )12);
#line 919
  knocker_core_services_db[7005] = (char *)tmp___143;
#line 920
  strcpy((char */* __restrict  */)knocker_core_services_db[7005], (char const   */* __restrict  */)"afs3-volser");
  }
#line 922
  if ((unsigned long )knocker_core_services_db[7005] == (unsigned long )((void *)0)) {
#line 923
    return (-1);
  }
  {
#line 925
  tmp___144 = malloc((size_t )12);
#line 925
  knocker_core_services_db[7006] = (char *)tmp___144;
#line 926
  strcpy((char */* __restrict  */)knocker_core_services_db[7006], (char const   */* __restrict  */)"afs3-errors");
  }
#line 928
  if ((unsigned long )knocker_core_services_db[7006] == (unsigned long )((void *)0)) {
#line 929
    return (-1);
  }
  {
#line 931
  tmp___145 = malloc((size_t )9);
#line 931
  knocker_core_services_db[7007] = (char *)tmp___145;
#line 932
  strcpy((char */* __restrict  */)knocker_core_services_db[7007], (char const   */* __restrict  */)"afs3-bos");
  }
#line 934
  if ((unsigned long )knocker_core_services_db[7007] == (unsigned long )((void *)0)) {
#line 935
    return (-1);
  }
  {
#line 937
  tmp___146 = malloc((size_t )12);
#line 937
  knocker_core_services_db[7008] = (char *)tmp___146;
#line 938
  strcpy((char */* __restrict  */)knocker_core_services_db[7008], (char const   */* __restrict  */)"afs3-update");
  }
#line 940
  if ((unsigned long )knocker_core_services_db[7008] == (unsigned long )((void *)0)) {
#line 941
    return (-1);
  }
  {
#line 943
  tmp___147 = malloc((size_t )12);
#line 943
  knocker_core_services_db[7009] = (char *)tmp___147;
#line 944
  strcpy((char */* __restrict  */)knocker_core_services_db[7009], (char const   */* __restrict  */)"afs3-rmtsys");
  }
#line 946
  if ((unsigned long )knocker_core_services_db[7009] == (unsigned long )((void *)0)) {
#line 947
    return (-1);
  }
  {
#line 949
  tmp___148 = malloc((size_t )13);
#line 949
  knocker_core_services_db[7100] = (char *)tmp___148;
#line 950
  strcpy((char */* __restrict  */)knocker_core_services_db[7100], (char const   */* __restrict  */)"font-service");
  }
#line 952
  if ((unsigned long )knocker_core_services_db[7100] == (unsigned long )((void *)0)) {
#line 953
    return (-1);
  }
  {
#line 955
  tmp___149 = malloc((size_t )5);
#line 955
  knocker_core_services_db[22273] = (char *)tmp___149;
#line 956
  strcpy((char */* __restrict  */)knocker_core_services_db[22273], (char const   */* __restrict  */)"wnn6");
  }
#line 958
  if ((unsigned long )knocker_core_services_db[22273] == (unsigned long )((void *)0)) {
#line 959
    return (-1);
  }
#line 961
  knocker_core_services_db_init = 1;
#line 977
  return (0);
}
}
#line 981 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.c"
void free_knocker_core_services_db(void) 
{ 
  int i ;

  {
#line 986
  if (! knocker_core_services_db_init) {
#line 987
    return;
  }
#line 989
  i = 0;
  {
#line 989
  while (1) {
    while_continue: /* CIL Label */ ;
#line 989
    if (! (i < 30000)) {
#line 989
      goto while_break;
    }
#line 991
    if ((unsigned long )knocker_core_services_db[i] != (unsigned long )((void *)0)) {
      {
#line 992
      free((void *)knocker_core_services_db[i]);
      }
    }
#line 989
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 995
  knocker_core_services_db_init = 0;
#line 996
  return;
}
}
#line 1004 "/home/wheatley/newnew/temp/knocker-0.7.1/src/knocker_services.c"
char *knocker_core_services_db_get_service(unsigned int port , int protocol ) 
{ 
  int slenght ;
  size_t tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  size_t tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  char *tmp___6 ;

  {
#line 1008
  if (! knocker_core_services_db_init) {
#line 1011
    return ((char *)((void *)0));
  }
#line 1014
  if (protocol != 2) {
#line 1017
    if (protocol != 1) {
#line 1019
      return ((char *)((void *)0));
    }
  }
#line 1025
  if ((unsigned long )knocker_core_services_db[port] != (unsigned long )((void *)0)) {
    {
#line 1026
    tmp = strlen((char const   *)knocker_core_services_db[port]);
#line 1026
    slenght = (int )tmp;
    }
  } else {
#line 1028
    slenght = -1;
  }
#line 1030
  if (slenght == -1) {
#line 1032
    if ((unsigned long )knocker_core_last_service == (unsigned long )((void *)0)) {
      {
#line 1034
      tmp___0 = strlen("unknown");
#line 1034
      tmp___1 = malloc(tmp___0 + 1UL);
#line 1034
      knocker_core_last_service = (char *)tmp___1;
#line 1035
      strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)"unknown");
      }
    } else {
      {
#line 1039
      tmp___2 = strlen("unknown");
#line 1039
      tmp___3 = realloc((void *)knocker_core_last_service, tmp___2 + 1UL);
#line 1039
      knocker_core_last_service = (char *)tmp___3;
#line 1040
      strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)"unknown");
      }
    }
#line 1042
    return ((char *)((void *)0));
  }
#line 1046
  if ((unsigned long )knocker_core_last_service == (unsigned long )((void *)0)) {
    {
#line 1048
    tmp___4 = malloc((size_t )(slenght + 1));
#line 1048
    knocker_core_last_service = (char *)tmp___4;
    }
  } else {
    {
#line 1052
    tmp___5 = realloc((void *)knocker_core_last_service, (size_t )(slenght + 1));
#line 1052
    knocker_core_last_service = (char *)tmp___5;
    }
  }
  {
#line 1056
  tmp___6 = strcpy((char */* __restrict  */)knocker_core_last_service, (char const   */* __restrict  */)knocker_core_services_db[port]);
  }
#line 1056
  return (tmp___6);
}
}
