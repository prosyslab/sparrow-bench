/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 368 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned char Byte;
#line 370 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned int uInt;
#line 371 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned long uLong;
#line 377 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef Byte Bytef;
#line 386 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef void *voidpf;
#line 83 "/usr/include/zlib.h"
struct internal_state;
#line 83
struct internal_state;
#line 85 "/usr/include/zlib.h"
struct z_stream_s {
   Bytef *next_in ;
   uInt avail_in ;
   uLong total_in ;
   Bytef *next_out ;
   uInt avail_out ;
   uLong total_out ;
   char *msg ;
   struct internal_state *state ;
   voidpf (*zalloc)(voidpf opaque , uInt items , uInt size ) ;
   void (*zfree)(voidpf opaque , voidpf address ) ;
   voidpf opaque ;
   int data_type ;
   uLong adler ;
   uLong reserved ;
};
#line 85 "/usr/include/zlib.h"
typedef struct z_stream_s z_stream;
#line 106 "/usr/include/zlib.h"
typedef z_stream *z_streamp;
#line 1742 "/usr/include/zlib.h"
struct internal_state {
   int dummy ;
};
#line 79 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
struct __anonstruct_box_28 {
   int r0 ;
   int r1 ;
   int g0 ;
   int g1 ;
   int b0 ;
   int b1 ;
   int vol ;
};
#line 79 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
typedef struct __anonstruct_box_28 box;
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 433
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) sscanf)(char const   * __restrict  __s ,
                                                                             char const   * __restrict  __format 
                                                                             , ...)  __asm__("__isoc99_sscanf")  ;
#line 709
extern size_t fread(void * __restrict  __ptr , size_t __size , size_t __n , FILE * __restrict  __stream ) ;
#line 715
extern size_t fwrite(void const   * __restrict  __ptr , size_t __size , size_t __n ,
                     FILE * __restrict  __s ) ;
#line 749
extern int fseek(FILE *__stream , long __off , int __whence ) ;
#line 828
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) feof)(FILE *__stream ) ;
#line 147 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 466
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 775
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) abs)(int __x )  __attribute__((__const__)) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 69
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) memcmp)(void const   *__s1 ,
                                                                                               void const   *__s2 ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 137
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcat)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 263
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strrchr)(char const   *__s ,
                                                                                                int __c )  __attribute__((__pure__)) ;
#line 392 "/usr/include/zlib.h"
extern int inflate(z_streamp strm , int flush ) ;
#line 508
extern int inflateEnd(z_streamp strm ) ;
#line 892
extern int inflateReset(z_streamp strm ) ;
#line 1635
extern int inflateInit_(z_streamp strm , char const   *version , int stream_size ) ;
#line 56 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char png_sign[8]  = 
#line 56 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
  {      (unsigned char)137,      (unsigned char)80,      (unsigned char)78,      (unsigned char)71, 
        (unsigned char)13,      (unsigned char)10,      (unsigned char)26,      (unsigned char)10};
#line 57 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mask4[2]  = {      240,      15};
#line 58 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int shift4[2]  = {      4,      0};
#line 59 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mask2[4]  = {      192,      48,      12,      3};
#line 60 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int shift2[4]  = {      6,      4,      2,      0};
#line 61 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mask1[8]  = 
#line 61
  {      128,      64,      32,      16, 
        8,      4,      2,      1};
#line 62 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int shift1[8]  = 
#line 62
  {      7,      6,      5,      4, 
        3,      2,      1,      0};
#line 63 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned int keep_original  =    1U;
#line 64 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char pal[256][3]  ;
#line 65 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char trns[256]  ;
#line 66 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned int palsize  ;
#line 66 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned int trnssize  ;
#line 67 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned short trns1  ;
#line 67 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned short trns2  ;
#line 67 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned short trns3  ;
#line 68 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int trns_idx  ;
#line 69 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned int accum  ;
#line 70 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char bits  ;
#line 70 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char codesize  ;
#line 71 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char buf[288]  ;
#line 72 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char bigcube[128][128][128]  ;
#line 73 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int wt[274625]  ;
#line 74 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mr[274625]  ;
#line 75 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mg[274625]  ;
#line 76 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int mb[274625]  ;
#line 77 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
double m2[274625]  ;
#line 78 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned char tag[274625]  ;
#line 80 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int tlevel  ;
#line 80 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int bcolor  ;
#line 80 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int back_r  ;
#line 80 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int back_g  ;
#line 80 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int back_b  ;
#line 82 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int read32(unsigned int *val , FILE *f1 ) 
{ 
  unsigned char a ;
  unsigned char b ;
  unsigned char c ;
  unsigned char d ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;

  {
  {
#line 85
  tmp = fread((void */* __restrict  */)(& a), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
  }
#line 85
  if (tmp == 1UL) {
    {
#line 85
    tmp___0 = fread((void */* __restrict  */)(& b), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 85
    if (tmp___0 == 1UL) {
      {
#line 85
      tmp___1 = fread((void */* __restrict  */)(& c), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
      }
#line 85
      if (tmp___1 == 1UL) {
        {
#line 85
        tmp___2 = fread((void */* __restrict  */)(& d), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
        }
#line 85
        if (tmp___2 == 1UL) {
#line 87
          *val = ((((unsigned int )a << 24) + ((unsigned int )b << 16)) + ((unsigned int )c << 8)) + (unsigned int )d;
#line 88
          return (0);
        }
      }
    }
  }
#line 90
  return (1);
}
}
#line 93 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int read16(unsigned short *val , FILE *f1 ) 
{ 
  unsigned char a ;
  unsigned char b ;
  size_t tmp ;
  size_t tmp___0 ;

  {
  {
#line 96
  tmp = fread((void */* __restrict  */)(& a), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
  }
#line 96
  if (tmp == 1UL) {
    {
#line 96
    tmp___0 = fread((void */* __restrict  */)(& b), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 96
    if (tmp___0 == 1UL) {
#line 98
      *val = (unsigned short )(((int )((unsigned short )a) << 8) + (int )((unsigned short )b));
#line 99
      return (0);
    }
  }
#line 101
  return (1);
}
}
#line 104 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
unsigned short readshort(unsigned char *p ) 
{ 


  {
#line 106
  return ((unsigned short )(((int )((unsigned short )*p) << 8) + (int )((unsigned short )*(p + 1))));
}
}
#line 109 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void read_sub_row(unsigned char *row , unsigned int rowbytes , unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 113
  i = bpp;
  {
#line 113
  while (1) {
    while_continue: /* CIL Label */ ;
#line 113
    if (! (i < rowbytes)) {
#line 113
      goto while_break;
    }
#line 114
    *(row + i) = (unsigned char )((int )*(row + i) + (int )*(row + (i - bpp)));
#line 113
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 115
  return;
}
}
#line 117 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void read_up_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                 unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 121
  if (prev_row) {
#line 122
    i = 0U;
    {
#line 122
    while (1) {
      while_continue: /* CIL Label */ ;
#line 122
      if (! (i < rowbytes)) {
#line 122
        goto while_break;
      }
#line 123
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(prev_row + i));
#line 122
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 124
  return;
}
}
#line 126 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void read_average_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                      unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 130
  if (prev_row) {
#line 132
    i = 0U;
    {
#line 132
    while (1) {
      while_continue: /* CIL Label */ ;
#line 132
      if (! (i < bpp)) {
#line 132
        goto while_break;
      }
#line 133
      *(row + i) = (unsigned char )((int )*(row + i) + ((int )*(prev_row + i) >> 1));
#line 132
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 134
    i = bpp;
    {
#line 134
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 134
      if (! (i < rowbytes)) {
#line 134
        goto while_break___0;
      }
#line 135
      *(row + i) = (unsigned char )((int )*(row + i) + (((int )*(prev_row + i) + (int )*(row + (i - bpp))) >> 1));
#line 134
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else {
#line 139
    i = bpp;
    {
#line 139
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 139
      if (! (i < rowbytes)) {
#line 139
        goto while_break___1;
      }
#line 140
      *(row + i) = (unsigned char )((int )*(row + i) + ((int )*(row + (i - bpp)) >> 1));
#line 139
      i ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 142
  return;
}
}
#line 144 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void read_paeth_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                    unsigned int bpp ) 
{ 
  unsigned int i ;
  int a ;
  int b ;
  int c ;
  int pa ;
  int pb ;
  int pc ;
  int p ;
  int tmp ;
  int tmp___0 ;

  {
#line 149
  if (prev_row) {
#line 151
    i = 0U;
    {
#line 151
    while (1) {
      while_continue: /* CIL Label */ ;
#line 151
      if (! (i < bpp)) {
#line 151
        goto while_break;
      }
#line 152
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(prev_row + i));
#line 151
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 153
    i = bpp;
    {
#line 153
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 153
      if (! (i < rowbytes)) {
#line 153
        goto while_break___0;
      }
      {
#line 155
      a = (int )*(row + (i - bpp));
#line 156
      b = (int )*(prev_row + i);
#line 157
      c = (int )*(prev_row + (i - bpp));
#line 158
      p = b - c;
#line 159
      pc = a - c;
#line 160
      pa = abs(p);
#line 161
      pb = abs(pc);
#line 162
      pc = abs(p + pc);
      }
#line 163
      if (pa <= pb) {
#line 163
        if (pa <= pc) {
#line 163
          tmp___0 = a;
        } else {
#line 163
          goto _L;
        }
      } else {
        _L: /* CIL Label */ 
#line 163
        if (pb <= pc) {
#line 163
          tmp = b;
        } else {
#line 163
          tmp = c;
        }
#line 163
        tmp___0 = tmp;
      }
#line 163
      *(row + i) = (unsigned char )((int )*(row + i) + tmp___0);
#line 153
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else {
#line 168
    i = bpp;
    {
#line 168
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 168
      if (! (i < rowbytes)) {
#line 168
        goto while_break___1;
      }
#line 169
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(row + (i - bpp)));
#line 168
      i ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 171
  return;
}
}
#line 173 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void unpack(z_stream zstream , unsigned char *dst , unsigned int dst_size , unsigned char *src ,
            unsigned int src_size , unsigned int h , unsigned int rowbytes , unsigned char bpp ) 
{ 
  unsigned int j ;
  unsigned char *row ;
  unsigned char *prev_row ;
  unsigned char *tmp ;

  {
  {
#line 176
  row = dst;
#line 177
  prev_row = (unsigned char *)((void *)0);
#line 179
  zstream.next_out = dst;
#line 180
  zstream.avail_out = dst_size;
#line 181
  zstream.next_in = src;
#line 182
  zstream.avail_in = src_size;
#line 183
  inflate(& zstream, 4);
#line 184
  inflateReset(& zstream);
#line 186
  j = 0U;
  }
  {
#line 186
  while (1) {
    while_continue: /* CIL Label */ ;
#line 186
    if (! (j < h)) {
#line 186
      goto while_break;
    }
#line 188
    tmp = row;
#line 188
    row ++;
    {
#line 190
    if ((int )*tmp == 0) {
#line 190
      goto case_0;
    }
#line 191
    if ((int )*tmp == 1) {
#line 191
      goto case_1;
    }
#line 192
    if ((int )*tmp == 2) {
#line 192
      goto case_2;
    }
#line 193
    if ((int )*tmp == 3) {
#line 193
      goto case_3;
    }
#line 194
    if ((int )*tmp == 4) {
#line 194
      goto case_4;
    }
#line 188
    goto switch_break;
    case_0: /* CIL Label */ 
#line 190
    goto switch_break;
    case_1: /* CIL Label */ 
    {
#line 191
    read_sub_row(row, rowbytes, (unsigned int )bpp);
    }
#line 191
    goto switch_break;
    case_2: /* CIL Label */ 
    {
#line 192
    read_up_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 192
    goto switch_break;
    case_3: /* CIL Label */ 
    {
#line 193
    read_average_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 193
    goto switch_break;
    case_4: /* CIL Label */ 
    {
#line 194
    read_paeth_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 194
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 196
    prev_row = row;
#line 197
    row += rowbytes;
#line 186
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 199
  return;
}
}
#line 201 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void compose0(unsigned char *dst1 , unsigned int dstbytes1 , unsigned char *dst2 ,
              unsigned int dstbytes2 , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int g ;
  unsigned int a ;
  unsigned char *sp ;
  unsigned char *dp1 ;
  unsigned int *dp2 ;
  unsigned short tmp ;
  unsigned char *tmp___0 ;
  unsigned int *tmp___1 ;
  unsigned char *tmp___2 ;
  unsigned int *tmp___3 ;
  unsigned char *tmp___4 ;
  unsigned int *tmp___5 ;
  unsigned char *tmp___6 ;
  unsigned int *tmp___7 ;
  unsigned char *tmp___8 ;
  unsigned int *tmp___9 ;
  unsigned short tmp___10 ;

  {
#line 208
  j = 0U;
  {
#line 208
  while (1) {
    while_continue: /* CIL Label */ ;
#line 208
    if (! (j < h)) {
#line 208
      goto while_break;
    }
#line 210
    sp = src + 1;
#line 211
    dp1 = dst1;
#line 212
    dp2 = (unsigned int *)dst2;
#line 214
    if (bop == 0U) {
      {
#line 218
      if ((int )depth == 16) {
#line 218
        goto case_16;
      }
#line 219
      if ((int )depth == 8) {
#line 219
        goto case_8;
      }
#line 220
      if ((int )depth == 4) {
#line 220
        goto case_4;
      }
#line 221
      if ((int )depth == 2) {
#line 221
        goto case_2;
      }
#line 222
      if ((int )depth == 1) {
#line 222
        goto case_1;
      }
#line 216
      goto switch_break;
      case_16: /* CIL Label */ 
#line 218
      i = 0U;
      {
#line 218
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 218
        if (! (i < w)) {
#line 218
          goto while_break___0;
        }
#line 218
        a = 255U;
#line 218
        if (trnssize) {
          {
#line 218
          tmp = readshort(sp);
          }
#line 218
          if ((int )tmp == (int )trns1) {
#line 218
            a = 0U;
          }
        }
#line 218
        tmp___0 = dp1;
#line 218
        dp1 ++;
#line 218
        *tmp___0 = *sp;
#line 218
        tmp___1 = dp2;
#line 218
        dp2 ++;
#line 218
        *tmp___1 = (((a << 24) + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
#line 218
        sp += 2;
#line 218
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 218
      goto switch_break;
      case_8: /* CIL Label */ 
#line 219
      i = 0U;
      {
#line 219
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 219
        if (! (i < w)) {
#line 219
          goto while_break___1;
        }
#line 219
        a = 255U;
#line 219
        if (trnssize) {
#line 219
          if ((int )*sp == (int )trns1) {
#line 219
            a = 0U;
          }
        }
#line 219
        tmp___2 = dp1;
#line 219
        dp1 ++;
#line 219
        *tmp___2 = *sp;
#line 219
        tmp___3 = dp2;
#line 219
        dp2 ++;
#line 219
        *tmp___3 = (((a << 24) + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
#line 219
        sp ++;
#line 219
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
#line 219
      goto switch_break;
      case_4: /* CIL Label */ 
#line 220
      i = 0U;
      {
#line 220
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 220
        if (! (i < w)) {
#line 220
          goto while_break___2;
        }
#line 220
        g = (unsigned int )(((int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U]);
#line 220
        a = 255U;
#line 220
        if (trnssize) {
#line 220
          if (g == (unsigned int )trns1) {
#line 220
            a = 0U;
          }
        }
#line 220
        tmp___4 = dp1;
#line 220
        dp1 ++;
#line 220
        *tmp___4 = (unsigned char )(g * 17U);
#line 220
        tmp___5 = dp2;
#line 220
        dp2 ++;
#line 220
        *tmp___5 = (a << 24) + g * 1118481U;
#line 220
        i ++;
      }
      while_break___2: /* CIL Label */ ;
      }
#line 220
      goto switch_break;
      case_2: /* CIL Label */ 
#line 221
      i = 0U;
      {
#line 221
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 221
        if (! (i < w)) {
#line 221
          goto while_break___3;
        }
#line 221
        g = (unsigned int )(((int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U]);
#line 221
        a = 255U;
#line 221
        if (trnssize) {
#line 221
          if (g == (unsigned int )trns1) {
#line 221
            a = 0U;
          }
        }
#line 221
        tmp___6 = dp1;
#line 221
        dp1 ++;
#line 221
        *tmp___6 = (unsigned char )(g * 85U);
#line 221
        tmp___7 = dp2;
#line 221
        dp2 ++;
#line 221
        *tmp___7 = (a << 24) + g * 5592405U;
#line 221
        i ++;
      }
      while_break___3: /* CIL Label */ ;
      }
#line 221
      goto switch_break;
      case_1: /* CIL Label */ 
#line 222
      i = 0U;
      {
#line 222
      while (1) {
        while_continue___4: /* CIL Label */ ;
#line 222
        if (! (i < w)) {
#line 222
          goto while_break___4;
        }
#line 222
        g = (unsigned int )(((int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U]);
#line 222
        a = 255U;
#line 222
        if (trnssize) {
#line 222
          if (g == (unsigned int )trns1) {
#line 222
            a = 0U;
          }
        }
#line 222
        tmp___8 = dp1;
#line 222
        dp1 ++;
#line 222
        *tmp___8 = (unsigned char )(g * 255U);
#line 222
        tmp___9 = dp2;
#line 222
        dp2 ++;
#line 222
        *tmp___9 = (a << 24) + g * 16777215U;
#line 222
        i ++;
      }
      while_break___4: /* CIL Label */ ;
      }
#line 222
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    } else {
      {
#line 229
      if ((int )depth == 16) {
#line 229
        goto case_16___0;
      }
#line 230
      if ((int )depth == 8) {
#line 230
        goto case_8___0;
      }
#line 231
      if ((int )depth == 4) {
#line 231
        goto case_4___0;
      }
#line 232
      if ((int )depth == 2) {
#line 232
        goto case_2___0;
      }
#line 233
      if ((int )depth == 1) {
#line 233
        goto case_1___0;
      }
#line 227
      goto switch_break___0;
      case_16___0: /* CIL Label */ 
#line 229
      i = 0U;
      {
#line 229
      while (1) {
        while_continue___5: /* CIL Label */ ;
#line 229
        if (! (i < w)) {
#line 229
          goto while_break___5;
        }
        {
#line 229
        tmp___10 = readshort(sp);
        }
#line 229
        if ((int )tmp___10 != (int )trns1) {
#line 229
          *dp1 = *sp;
#line 229
          *dp2 = ((4278190080U + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
        }
#line 229
        sp += 2;
#line 229
        i ++;
#line 229
        dp1 ++;
#line 229
        dp2 ++;
      }
      while_break___5: /* CIL Label */ ;
      }
#line 229
      goto switch_break___0;
      case_8___0: /* CIL Label */ 
#line 230
      i = 0U;
      {
#line 230
      while (1) {
        while_continue___6: /* CIL Label */ ;
#line 230
        if (! (i < w)) {
#line 230
          goto while_break___6;
        }
#line 230
        if ((int )*sp != (int )trns1) {
#line 230
          *dp1 = *sp;
#line 230
          *dp2 = ((4278190080U + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
        }
#line 230
        sp ++;
#line 230
        i ++;
#line 230
        dp1 ++;
#line 230
        dp2 ++;
      }
      while_break___6: /* CIL Label */ ;
      }
#line 230
      goto switch_break___0;
      case_4___0: /* CIL Label */ 
#line 231
      i = 0U;
      {
#line 231
      while (1) {
        while_continue___7: /* CIL Label */ ;
#line 231
        if (! (i < w)) {
#line 231
          goto while_break___7;
        }
#line 231
        g = (unsigned int )(((int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U]);
#line 231
        if (g != (unsigned int )trns1) {
#line 231
          *dp1 = (unsigned char )(g * 17U);
#line 231
          *dp2 = 4278190080U + g * 1118481U;
        }
#line 231
        i ++;
#line 231
        dp1 ++;
#line 231
        dp2 ++;
      }
      while_break___7: /* CIL Label */ ;
      }
#line 231
      goto switch_break___0;
      case_2___0: /* CIL Label */ 
#line 232
      i = 0U;
      {
#line 232
      while (1) {
        while_continue___8: /* CIL Label */ ;
#line 232
        if (! (i < w)) {
#line 232
          goto while_break___8;
        }
#line 232
        g = (unsigned int )(((int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U]);
#line 232
        if (g != (unsigned int )trns1) {
#line 232
          *dp1 = (unsigned char )(g * 85U);
#line 232
          *dp2 = 4278190080U + g * 5592405U;
        }
#line 232
        i ++;
#line 232
        dp1 ++;
#line 232
        dp2 ++;
      }
      while_break___8: /* CIL Label */ ;
      }
#line 232
      goto switch_break___0;
      case_1___0: /* CIL Label */ 
#line 233
      i = 0U;
      {
#line 233
      while (1) {
        while_continue___9: /* CIL Label */ ;
#line 233
        if (! (i < w)) {
#line 233
          goto while_break___9;
        }
#line 233
        g = (unsigned int )(((int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U]);
#line 233
        if (g != (unsigned int )trns1) {
#line 233
          *dp1 = (unsigned char )(g * 255U);
#line 233
          *dp2 = 4278190080U + g * 16777215U;
        }
#line 233
        i ++;
#line 233
        dp1 ++;
#line 233
        dp2 ++;
      }
      while_break___9: /* CIL Label */ ;
      }
#line 233
      goto switch_break___0;
      switch_break___0: /* CIL Label */ ;
      }
    }
#line 237
    src += srcbytes;
#line 238
    dst1 += dstbytes1;
#line 239
    dst2 += dstbytes2;
#line 208
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 241
  return;
}
}
#line 243 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void compose2(unsigned char *dst , unsigned int dstbytes , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned char *sp ;
  unsigned int *dp ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned int *tmp___2 ;
  unsigned short tmp___3 ;
  unsigned short tmp___4 ;
  unsigned short tmp___5 ;
  unsigned int *tmp___6 ;
  unsigned short tmp___7 ;
  unsigned short tmp___8 ;
  unsigned short tmp___9 ;

  {
#line 250
  j = 0U;
  {
#line 250
  while (1) {
    while_continue: /* CIL Label */ ;
#line 250
    if (! (j < h)) {
#line 250
      goto while_break;
    }
#line 252
    sp = src + 1;
#line 253
    dp = (unsigned int *)dst;
#line 255
    if (bop == 0U) {
#line 257
      if ((int )depth == 8) {
#line 259
        i = 0U;
        {
#line 259
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 259
          if (! (i < w)) {
#line 259
            goto while_break___0;
          }
#line 261
          tmp = sp;
#line 261
          sp ++;
#line 261
          r = (unsigned int )*tmp;
#line 262
          tmp___0 = sp;
#line 262
          sp ++;
#line 262
          g = (unsigned int )*tmp___0;
#line 263
          tmp___1 = sp;
#line 263
          sp ++;
#line 263
          b = (unsigned int )*tmp___1;
#line 264
          a = 255U;
#line 265
          if (trnssize) {
#line 265
            if (r == (unsigned int )trns1) {
#line 265
              if (g == (unsigned int )trns2) {
#line 265
                if (b == (unsigned int )trns3) {
#line 266
                  a = 0U;
                }
              }
            }
          }
#line 267
          tmp___2 = dp;
#line 267
          dp ++;
#line 267
          *tmp___2 = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 259
          i ++;
        }
        while_break___0: /* CIL Label */ ;
        }
      } else {
#line 272
        i = 0U;
        {
#line 272
        while (1) {
          while_continue___1: /* CIL Label */ ;
#line 272
          if (! (i < w)) {
#line 272
            goto while_break___1;
          }
#line 274
          r = (unsigned int )*sp;
#line 275
          g = (unsigned int )*(sp + 2);
#line 276
          b = (unsigned int )*(sp + 4);
#line 277
          a = 255U;
#line 278
          if (trnssize) {
            {
#line 278
            tmp___3 = readshort(sp);
            }
#line 278
            if ((int )tmp___3 == (int )trns1) {
              {
#line 278
              tmp___4 = readshort(sp + 2);
              }
#line 278
              if ((int )tmp___4 == (int )trns2) {
                {
#line 278
                tmp___5 = readshort(sp + 4);
                }
#line 278
                if ((int )tmp___5 == (int )trns3) {
#line 279
                  a = 0U;
                }
              }
            }
          }
#line 280
          tmp___6 = dp;
#line 280
          dp ++;
#line 280
          *tmp___6 = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 272
          i ++;
#line 272
          sp += 6;
        }
        while_break___1: /* CIL Label */ ;
        }
      }
    } else
#line 286
    if ((int )depth == 8) {
#line 288
      i = 0U;
      {
#line 288
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 288
        if (! (i < w)) {
#line 288
          goto while_break___2;
        }
#line 289
        if ((int )*sp != (int )trns1) {
#line 290
          *dp = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        } else
#line 289
        if ((int )*(sp + 1) != (int )trns2) {
#line 290
          *dp = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        } else
#line 289
        if ((int )*(sp + 2) != (int )trns3) {
#line 290
          *dp = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        }
#line 288
        i ++;
#line 288
        sp += 3;
#line 288
        dp ++;
      }
      while_break___2: /* CIL Label */ ;
      }
    } else {
#line 294
      i = 0U;
      {
#line 294
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 294
        if (! (i < w)) {
#line 294
          goto while_break___3;
        }
        {
#line 295
        tmp___7 = readshort(sp);
        }
#line 295
        if ((int )tmp___7 != (int )trns1) {
#line 296
          *dp = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
        } else {
          {
#line 295
          tmp___8 = readshort(sp + 2);
          }
#line 295
          if ((int )tmp___8 != (int )trns2) {
#line 296
            *dp = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
          } else {
            {
#line 295
            tmp___9 = readshort(sp + 4);
            }
#line 295
            if ((int )tmp___9 != (int )trns3) {
#line 296
              *dp = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
            }
          }
        }
#line 294
        i ++;
#line 294
        sp += 6;
#line 294
        dp ++;
      }
      while_break___3: /* CIL Label */ ;
      }
    }
#line 299
    src += srcbytes;
#line 300
    dst += dstbytes;
#line 250
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 302
  return;
}
}
#line 304 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void compose3(unsigned char *dst1 , unsigned int dstbytes1 , unsigned char *dst2 ,
              unsigned int dstbytes2 , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned int r2 ;
  unsigned int g2 ;
  unsigned int b2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char col ;
  unsigned char *sp ;
  unsigned char *dp1 ;
  unsigned int *dp2 ;
  unsigned char *tmp ;
  unsigned int *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned int *tmp___2 ;
  unsigned char *tmp___3 ;
  unsigned int *tmp___4 ;

  {
#line 315
  j = 0U;
  {
#line 315
  while (1) {
    while_continue: /* CIL Label */ ;
#line 315
    if (! (j < h)) {
#line 315
      goto while_break;
    }
#line 317
    sp = src + 1;
#line 318
    dp1 = dst1;
#line 319
    dp2 = (unsigned int *)dst2;
#line 321
    i = 0U;
    {
#line 321
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 321
      if (! (i < w)) {
#line 321
        goto while_break___0;
      }
      {
#line 325
      if ((int )depth == 1) {
#line 325
        goto case_1;
      }
#line 326
      if ((int )depth == 2) {
#line 326
        goto case_2;
      }
#line 327
      if ((int )depth == 4) {
#line 327
        goto case_4;
      }
#line 328
      goto switch_default;
      case_1: /* CIL Label */ 
#line 325
      col = (unsigned char )(((int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U]);
#line 325
      goto switch_break;
      case_2: /* CIL Label */ 
#line 326
      col = (unsigned char )(((int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U]);
#line 326
      goto switch_break;
      case_4: /* CIL Label */ 
#line 327
      col = (unsigned char )(((int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U]);
#line 327
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 328
      col = *(sp + i);
      switch_break: /* CIL Label */ ;
      }
#line 331
      r = (unsigned int )pal[col][0];
#line 332
      g = (unsigned int )pal[col][1];
#line 333
      b = (unsigned int )pal[col][2];
#line 334
      a = (unsigned int )trns[col];
#line 336
      if (bop == 0U) {
#line 338
        tmp = dp1;
#line 338
        dp1 ++;
#line 338
        *tmp = col;
#line 339
        tmp___0 = dp2;
#line 339
        dp2 ++;
#line 339
        *tmp___0 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else
#line 343
      if (a == 255U) {
#line 345
        tmp___1 = dp1;
#line 345
        dp1 ++;
#line 345
        *tmp___1 = col;
#line 346
        tmp___2 = dp2;
#line 346
        dp2 ++;
#line 346
        *tmp___2 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else
#line 349
      if (a != 0U) {
#line 351
        a2 = *dp2 >> 24;
#line 351
        if (a2 != 0U) {
#line 353
          keep_original = 0U;
#line 354
          u = (int )(a * 255U);
#line 355
          v = (int )((255U - a) * a2);
#line 356
          al = (int )(65025U - (255U - a) * (255U - a2));
#line 357
          r2 = *dp2 & 255U;
#line 358
          g2 = (*dp2 >> 8) & 255U;
#line 359
          b2 = (*dp2 >> 16) & 255U;
#line 360
          r = (r * (unsigned int )u + r2 * (unsigned int )v) / (unsigned int )al;
#line 361
          g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 362
          b = (b * (unsigned int )u + b2 * (unsigned int )v) / (unsigned int )al;
#line 363
          a = (unsigned int )(al / 255);
        }
#line 365
        tmp___3 = dp1;
#line 365
        dp1 ++;
#line 365
        *tmp___3 = col;
#line 366
        tmp___4 = dp2;
#line 366
        dp2 ++;
#line 366
        *tmp___4 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else {
#line 370
        dp1 ++;
#line 371
        dp2 ++;
      }
#line 321
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 375
    src += srcbytes;
#line 376
    dst1 += dstbytes1;
#line 377
    dst2 += dstbytes2;
#line 315
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 379
  return;
}
}
#line 381 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void compose4(unsigned char *dst , unsigned int dstbytes , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int step ;
  unsigned int g ;
  unsigned int a ;
  unsigned int g2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char *sp ;
  unsigned int *dp ;
  unsigned int *tmp ;
  unsigned int *tmp___0 ;
  unsigned int *tmp___1 ;

  {
#line 389
  step = (unsigned int )(((int )depth + 7) / 8);
#line 391
  j = 0U;
  {
#line 391
  while (1) {
    while_continue: /* CIL Label */ ;
#line 391
    if (! (j < h)) {
#line 391
      goto while_break;
    }
#line 393
    sp = src + 1;
#line 394
    dp = (unsigned int *)dst;
#line 396
    if (bop == 0U) {
#line 398
      i = 0U;
      {
#line 398
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 398
        if (! (i < w)) {
#line 398
          goto while_break___0;
        }
#line 400
        g = (unsigned int )*sp;
#line 400
        sp += step;
#line 401
        a = (unsigned int )*sp;
#line 401
        sp += step;
#line 402
        tmp = dp;
#line 402
        dp ++;
#line 402
        *tmp = (((a << 24) + (g << 16)) + (g << 8)) + g;
#line 398
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
#line 407
      i = 0U;
      {
#line 407
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 407
        if (! (i < w)) {
#line 407
          goto while_break___1;
        }
#line 409
        g = (unsigned int )*sp;
#line 409
        sp += step;
#line 410
        a = (unsigned int )*sp;
#line 410
        sp += step;
#line 411
        if (a == 255U) {
#line 412
          tmp___0 = dp;
#line 412
          dp ++;
#line 412
          *tmp___0 = (((a << 24) + (g << 16)) + (g << 8)) + g;
        } else
#line 414
        if (a != 0U) {
#line 416
          a2 = *dp >> 24;
#line 416
          if (a2 != 0U) {
#line 418
            u = (int )(a * 255U);
#line 419
            v = (int )((255U - a) * a2);
#line 420
            al = (int )(65025U - (255U - a) * (255U - a2));
#line 421
            g2 = *dp & 255U;
#line 422
            g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 423
            a = (unsigned int )(al / 255);
          }
#line 425
          tmp___1 = dp;
#line 425
          dp ++;
#line 425
          *tmp___1 = (((a << 24) + (g << 16)) + (g << 8)) + g;
        } else {
#line 428
          dp ++;
        }
#line 407
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 431
    src += srcbytes;
#line 432
    dst += dstbytes;
#line 391
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 434
  return;
}
}
#line 436 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void compose6(unsigned char *dst , unsigned int dstbytes , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int step ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned int r2 ;
  unsigned int g2 ;
  unsigned int b2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char *sp ;
  unsigned int *dp ;
  unsigned int *tmp ;
  unsigned int *tmp___0 ;
  unsigned int *tmp___1 ;

  {
#line 445
  step = (unsigned int )(((int )depth + 7) / 8);
#line 447
  j = 0U;
  {
#line 447
  while (1) {
    while_continue: /* CIL Label */ ;
#line 447
    if (! (j < h)) {
#line 447
      goto while_break;
    }
#line 449
    sp = src + 1;
#line 450
    dp = (unsigned int *)dst;
#line 452
    if (bop == 0U) {
#line 454
      i = 0U;
      {
#line 454
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 454
        if (! (i < w)) {
#line 454
          goto while_break___0;
        }
#line 456
        r = (unsigned int )*sp;
#line 456
        sp += step;
#line 457
        g = (unsigned int )*sp;
#line 457
        sp += step;
#line 458
        b = (unsigned int )*sp;
#line 458
        sp += step;
#line 459
        a = (unsigned int )*sp;
#line 459
        sp += step;
#line 460
        tmp = dp;
#line 460
        dp ++;
#line 460
        *tmp = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 454
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
#line 465
      i = 0U;
      {
#line 465
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 465
        if (! (i < w)) {
#line 465
          goto while_break___1;
        }
#line 467
        r = (unsigned int )*sp;
#line 467
        sp += step;
#line 468
        g = (unsigned int )*sp;
#line 468
        sp += step;
#line 469
        b = (unsigned int )*sp;
#line 469
        sp += step;
#line 470
        a = (unsigned int )*sp;
#line 470
        sp += step;
#line 471
        if (a == 255U) {
#line 472
          tmp___0 = dp;
#line 472
          dp ++;
#line 472
          *tmp___0 = (((a << 24) + (b << 16)) + (g << 8)) + r;
        } else
#line 474
        if (a != 0U) {
#line 476
          a2 = *dp >> 24;
#line 476
          if (a2 != 0U) {
#line 478
            u = (int )(a * 255U);
#line 479
            v = (int )((255U - a) * a2);
#line 480
            al = (int )(65025U - (255U - a) * (255U - a2));
#line 481
            r2 = *dp & 255U;
#line 482
            g2 = (*dp >> 8) & 255U;
#line 483
            b2 = (*dp >> 16) & 255U;
#line 484
            r = (r * (unsigned int )u + r2 * (unsigned int )v) / (unsigned int )al;
#line 485
            g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 486
            b = (b * (unsigned int )u + b2 * (unsigned int )v) / (unsigned int )al;
#line 487
            a = (unsigned int )(al / 255);
          }
#line 489
          tmp___1 = dp;
#line 489
          dp ++;
#line 489
          *tmp___1 = (((a << 24) + (b << 16)) + (g << 8)) + r;
        } else {
#line 492
          dp ++;
        }
#line 465
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 495
    src += srcbytes;
#line 496
    dst += dstbytes;
#line 447
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 498
  return;
}
}
#line 500 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int LoadAPNG(char *szIn , int *pWidth , int *pHeight , int *pColType , int *pFrames ,
             int *pLoops , unsigned char **ppOut1 , unsigned char **ppOut2 , unsigned short **ppDelays ) 
{ 
  unsigned char sig[8] ;
  unsigned int i ;
  unsigned int j ;
  unsigned int len ;
  unsigned int chunk ;
  unsigned int seq ;
  unsigned int crc ;
  unsigned int w ;
  unsigned int h ;
  unsigned int w0 ;
  unsigned int h0 ;
  unsigned int x0 ;
  unsigned int y0 ;
  unsigned char depth ;
  unsigned char coltype ;
  unsigned char compr ;
  unsigned char filter ;
  unsigned char interl ;
  unsigned char pixeldepth ;
  unsigned char bpp ;
  unsigned int rowbytes ;
  unsigned int frames ;
  unsigned int loops ;
  unsigned int fctl ;
  unsigned int frames_decoded ;
  unsigned int outrow1 ;
  unsigned int outrow2 ;
  unsigned int outimg1 ;
  unsigned int outimg2 ;
  unsigned short d1 ;
  unsigned short d2 ;
  unsigned char c ;
  unsigned char dop ;
  unsigned char bop ;
  int imagesize ;
  int zbuf_size ;
  int zsize ;
  z_stream zstream ;
  unsigned char *pOut1 ;
  unsigned char *pOut2 ;
  unsigned char *pTemp ;
  unsigned char *pData ;
  unsigned char *pImg1 ;
  unsigned char *pImg2 ;
  unsigned char *pDst1 ;
  unsigned char *pDst2 ;
  unsigned short *pDelays ;
  FILE *f1 ;
  int res ;
  size_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  size_t tmp___7 ;
  size_t tmp___8 ;
  size_t tmp___9 ;
  int tmp___10 ;
  void *tmp___11 ;
  void *tmp___12 ;
  void *tmp___13 ;
  void *tmp___14 ;
  void *tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  unsigned int col ;
  size_t tmp___18 ;
  int tmp___19 ;
  size_t tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  void *tmp___25 ;
  void *tmp___26 ;
  void *tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  size_t tmp___35 ;
  size_t tmp___36 ;
  int tmp___37 ;
  size_t tmp___38 ;
  int tmp___39 ;
  int tmp___40 ;
  size_t tmp___41 ;
  int tmp___42 ;
  int tmp___43 ;
  int tmp___44 ;

  {
  {
#line 524
  res = 1;
#line 526
  f1 = fopen((char const   */* __restrict  */)szIn, (char const   */* __restrict  */)"rb");
  }
#line 526
  if ((unsigned long )f1 == (unsigned long )((FILE *)0)) {
    {
#line 528
    printf((char const   */* __restrict  */)"Error: can\'t open \'%s\'\n", szIn);
    }
#line 529
    return (res);
  }
  {
#line 532
  printf((char const   */* __restrict  */)"Reading \'%s\'...\n", szIn);
#line 534
  frames = 1U;
#line 535
  loops = 0U;
#line 536
  fctl = 0U;
#line 537
  frames_decoded = 0U;
#line 538
  zsize = 0;
#line 539
  x0 = 0U;
#line 540
  y0 = 0U;
#line 541
  bop = (unsigned char)0;
#line 542
  palsize = 0U;
#line 543
  trnssize = 0U;
#line 544
  trns_idx = -1;
#line 546
  memset((void *)(trns), 255, (size_t )256);
#line 548
  zstream.zalloc = (voidpf (*)(voidpf opaque , uInt items , uInt size ))0;
#line 549
  zstream.zfree = (void (*)(voidpf opaque , voidpf address ))0;
#line 550
  zstream.opaque = (voidpf )0;
#line 551
  inflateInit_(& zstream, "1.2.8", (int )sizeof(z_stream ));
  }
  {
#line 553
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 555
    tmp = fread((void */* __restrict  */)(sig), (size_t )1, (size_t )8, (FILE */* __restrict  */)f1);
    }
#line 555
    if (tmp != 8UL) {
      {
#line 557
      printf((char const   */* __restrict  */)"Error: can\'t read the sig\n");
      }
#line 558
      goto while_break;
    }
    {
#line 560
    tmp___0 = memcmp((void const   *)(sig), (void const   *)(png_sign), (size_t )8);
    }
#line 560
    if (tmp___0 != 0) {
      {
#line 562
      printf((char const   */* __restrict  */)"Error: wrong PNG sig\n");
      }
#line 563
      goto while_break;
    }
    {
#line 566
    tmp___1 = read32(& len, f1);
    }
#line 566
    if (tmp___1) {
#line 566
      goto while_break;
    }
    {
#line 567
    tmp___2 = read32(& chunk, f1);
    }
#line 567
    if (tmp___2) {
#line 567
      goto while_break;
    }
#line 569
    if (len != 13U) {
      {
#line 571
      printf((char const   */* __restrict  */)"Error: missing IHDR\n");
      }
#line 572
      goto while_break;
    } else
#line 569
    if (chunk != 1229472850U) {
      {
#line 571
      printf((char const   */* __restrict  */)"Error: missing IHDR\n");
      }
#line 572
      goto while_break;
    }
    {
#line 575
    tmp___3 = read32(& w, f1);
    }
#line 575
    if (tmp___3) {
#line 575
      goto while_break;
    }
    {
#line 576
    tmp___4 = read32(& h, f1);
    }
#line 576
    if (tmp___4) {
#line 576
      goto while_break;
    }
    {
#line 577
    w0 = w;
#line 578
    h0 = h;
#line 579
    tmp___5 = fread((void */* __restrict  */)(& depth), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 579
    if (tmp___5 != 1UL) {
#line 579
      goto while_break;
    }
    {
#line 580
    tmp___6 = fread((void */* __restrict  */)(& coltype), (size_t )1, (size_t )1,
                    (FILE */* __restrict  */)f1);
    }
#line 580
    if (tmp___6 != 1UL) {
#line 580
      goto while_break;
    }
    {
#line 581
    tmp___7 = fread((void */* __restrict  */)(& compr), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 581
    if (tmp___7 != 1UL) {
#line 581
      goto while_break;
    }
    {
#line 582
    tmp___8 = fread((void */* __restrict  */)(& filter), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 582
    if (tmp___8 != 1UL) {
#line 582
      goto while_break;
    }
    {
#line 583
    tmp___9 = fread((void */* __restrict  */)(& interl), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 583
    if (tmp___9 != 1UL) {
#line 583
      goto while_break;
    }
    {
#line 584
    tmp___10 = read32(& crc, f1);
    }
#line 584
    if (tmp___10) {
#line 584
      goto while_break;
    }
#line 586
    pixeldepth = depth;
#line 587
    if ((int )coltype == 2) {
#line 588
      pixeldepth = (unsigned char )((int )depth * 3);
    } else
#line 590
    if ((int )coltype == 4) {
#line 591
      pixeldepth = (unsigned char )((int )depth * 2);
    } else
#line 593
    if ((int )coltype == 6) {
#line 594
      pixeldepth = (unsigned char )((int )depth * 4);
    }
#line 596
    bpp = (unsigned char )(((int )pixeldepth + 7) >> 3);
#line 597
    if ((int )pixeldepth >= 8) {
#line 597
      rowbytes = w * ((unsigned int )pixeldepth >> 3);
    } else {
#line 597
      rowbytes = (w * (unsigned int )pixeldepth + 7U) >> 3;
    }
    {
#line 599
    imagesize = (int )((rowbytes + 1U) * h);
#line 600
    zbuf_size = ((imagesize + ((imagesize + 7) >> 3)) + ((imagesize + 63) >> 6)) + 11;
#line 610
    outrow1 = w;
#line 611
    outrow2 = w * 4U;
#line 612
    outimg1 = h * outrow1;
#line 613
    outimg2 = h * outrow2;
#line 615
    tmp___11 = malloc((size_t )(((frames + 1U) * outimg1) * 4U));
#line 615
    pOut1 = (unsigned char *)tmp___11;
#line 616
    tmp___12 = malloc((size_t )((frames + 1U) * outimg2));
#line 616
    pOut2 = (unsigned char *)tmp___12;
#line 617
    tmp___13 = malloc((size_t )((frames + 1U) * 2U));
#line 617
    pDelays = (unsigned short *)tmp___13;
#line 618
    tmp___14 = malloc((size_t )imagesize);
#line 618
    pTemp = (unsigned char *)tmp___14;
#line 619
    tmp___15 = malloc((size_t )zbuf_size);
#line 619
    pData = (unsigned char *)tmp___15;
    }
#line 620
    if (! pOut1) {
      {
#line 622
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 623
      goto while_break;
    } else
#line 620
    if (! pOut2) {
      {
#line 622
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 623
      goto while_break;
    } else
#line 620
    if (! pDelays) {
      {
#line 622
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 623
      goto while_break;
    } else
#line 620
    if (! pTemp) {
      {
#line 622
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 623
      goto while_break;
    } else
#line 620
    if (! pData) {
      {
#line 622
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 623
      goto while_break;
    }
    {
#line 625
    pImg1 = pOut1;
#line 626
    pImg2 = pOut2;
#line 627
    memset((void *)pOut1, 0, (size_t )outimg1);
#line 628
    memset((void *)pOut2, 0, (size_t )outimg2);
#line 629
    *(pDelays + 0) = (unsigned short)10;
    }
    {
#line 631
    while (1) {
      while_continue___0: /* CIL Label */ ;
      {
#line 631
      tmp___44 = feof(f1);
      }
#line 631
      if (tmp___44) {
#line 631
        goto while_break___0;
      }
      {
#line 633
      tmp___16 = read32(& len, f1);
      }
#line 633
      if (tmp___16) {
#line 633
        goto while_break___0;
      }
      {
#line 634
      tmp___17 = read32(& chunk, f1);
      }
#line 634
      if (tmp___17) {
#line 634
        goto while_break___0;
      }
#line 636
      if (chunk == 1347179589U) {
#line 639
        i = 0U;
        {
#line 639
        while (1) {
          while_continue___1: /* CIL Label */ ;
#line 639
          if (! (i < len)) {
#line 639
            goto while_break___1;
          }
          {
#line 641
          tmp___18 = fread((void */* __restrict  */)(& c), (size_t )1, (size_t )1,
                           (FILE */* __restrict  */)f1);
          }
#line 641
          if (tmp___18 != 1UL) {
#line 641
            goto while_break___1;
          }
#line 642
          col = i / 3U;
#line 643
          if (col < 256U) {
#line 645
            pal[col][i % 3U] = c;
#line 646
            palsize = col + 1U;
          }
#line 639
          i ++;
        }
        while_break___1: /* CIL Label */ ;
        }
        {
#line 649
        tmp___19 = read32(& crc, f1);
        }
#line 649
        if (tmp___19) {
#line 649
          goto while_break___0;
        }
      } else
#line 652
      if (chunk == 1951551059U) {
#line 654
        i = 0U;
        {
#line 654
        while (1) {
          while_continue___2: /* CIL Label */ ;
#line 654
          if (! (i < len)) {
#line 654
            goto while_break___2;
          }
          {
#line 656
          tmp___20 = fread((void */* __restrict  */)(& c), (size_t )1, (size_t )1,
                           (FILE */* __restrict  */)f1);
          }
#line 656
          if (tmp___20 != 1UL) {
#line 656
            goto while_break___2;
          }
#line 657
          if (i < 256U) {
#line 659
            trns[i] = c;
#line 660
            trnssize = i + 1U;
#line 661
            if ((int )c == 0) {
#line 661
              if ((int )coltype == 3) {
#line 661
                if (trns_idx == -1) {
#line 662
                  trns_idx = (int )i;
                }
              }
            }
          }
#line 654
          i ++;
        }
        while_break___2: /* CIL Label */ ;
        }
#line 665
        if ((int )coltype == 0) {
#line 667
          if (trnssize == 2U) {
            {
#line 669
            trns1 = readshort(& trns[0]);
            }
            {
#line 672
            if ((int )depth == 16) {
#line 672
              goto case_16;
            }
#line 673
            if ((int )depth == 4) {
#line 673
              goto case_4;
            }
#line 674
            if ((int )depth == 2) {
#line 674
              goto case_2;
            }
#line 675
            if ((int )depth == 1) {
#line 675
              goto case_1;
            }
#line 670
            goto switch_break;
            case_16: /* CIL Label */ 
#line 672
            trns[1] = trns[0];
#line 672
            trns[0] = (unsigned char)0;
#line 672
            goto switch_break;
            case_4: /* CIL Label */ 
#line 673
            trns[1] = (unsigned char )((int )trns[1] * 17);
#line 673
            goto switch_break;
            case_2: /* CIL Label */ 
#line 674
            trns[1] = (unsigned char )((int )trns[1] * 85);
#line 674
            goto switch_break;
            case_1: /* CIL Label */ 
#line 675
            trns[1] = (unsigned char )((int )trns[1] * 255);
#line 675
            goto switch_break;
            switch_break: /* CIL Label */ ;
            }
#line 677
            trns_idx = (int )trns[1];
          } else {
#line 680
            trnssize = 0U;
          }
        } else
#line 683
        if ((int )coltype == 2) {
#line 685
          if (trnssize == 6U) {
            {
#line 687
            trns1 = readshort(& trns[0]);
#line 688
            trns2 = readshort(& trns[2]);
#line 689
            trns3 = readshort(& trns[4]);
            }
#line 690
            if ((int )depth == 16) {
#line 692
              trns[1] = trns[0];
#line 692
              trns[0] = (unsigned char)0;
#line 693
              trns[3] = trns[2];
#line 693
              trns[2] = (unsigned char)0;
#line 694
              trns[5] = trns[4];
#line 694
              trns[4] = (unsigned char)0;
            }
          } else {
#line 698
            trnssize = 0U;
          }
        }
        {
#line 700
        tmp___21 = read32(& crc, f1);
        }
#line 700
        if (tmp___21) {
#line 700
          goto while_break___0;
        }
      } else
#line 703
      if (chunk == 1633899596U) {
        {
#line 705
        tmp___22 = read32(& frames, f1);
        }
#line 705
        if (tmp___22) {
#line 705
          goto while_break___0;
        }
        {
#line 706
        tmp___23 = read32(& loops, f1);
        }
#line 706
        if (tmp___23) {
#line 706
          goto while_break___0;
        }
        {
#line 707
        tmp___24 = read32(& crc, f1);
        }
#line 707
        if (tmp___24) {
#line 707
          goto while_break___0;
        }
        {
#line 708
        free((void *)pOut1);
#line 709
        free((void *)pOut2);
#line 710
        free((void *)pDelays);
#line 711
        tmp___25 = malloc((size_t )(((frames + 1U) * outimg1) * 4U));
#line 711
        pOut1 = (unsigned char *)tmp___25;
#line 712
        tmp___26 = malloc((size_t )((frames + 1U) * outimg2));
#line 712
        pOut2 = (unsigned char *)tmp___26;
#line 713
        tmp___27 = malloc((size_t )((frames + 1U) * 2U));
#line 713
        pDelays = (unsigned short *)tmp___27;
#line 714
        pImg1 = pOut1;
#line 715
        pImg2 = pOut2;
#line 716
        memset((void *)pOut1, 0, (size_t )outimg1);
#line 717
        memset((void *)pOut2, 0, (size_t )outimg2);
        }
      } else
#line 720
      if (chunk == 1717785676U) {
#line 722
        if (zsize > 0) {
#line 724
          if ((int )dop == 2) {
#line 726
            if ((int )coltype == 0) {
              {
#line 727
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            } else
#line 726
            if ((int )coltype == 3) {
              {
#line 727
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            }
            {
#line 729
            memcpy((void */* __restrict  */)(pImg2 + outimg2), (void const   */* __restrict  */)pImg2,
                   (size_t )outimg2);
            }
          }
          {
#line 732
          pDst1 = (pImg1 + y0 * outrow1) + x0;
#line 733
          pDst2 = (pImg2 + y0 * outrow2) + x0 * 4U;
#line 734
          unpack(zstream, pTemp, (unsigned int )imagesize, pData, (unsigned int )zsize,
                 h0, rowbytes, bpp);
          }
          {
#line 737
          if ((int )coltype == 0) {
#line 737
            goto case_0;
          }
#line 738
          if ((int )coltype == 2) {
#line 738
            goto case_2___0;
          }
#line 739
          if ((int )coltype == 3) {
#line 739
            goto case_3;
          }
#line 740
          if ((int )coltype == 4) {
#line 740
            goto case_4___0;
          }
#line 741
          if ((int )coltype == 6) {
#line 741
            goto case_6;
          }
#line 735
          goto switch_break___0;
          case_0: /* CIL Label */ 
          {
#line 737
          compose0(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 737
          goto switch_break___0;
          case_2___0: /* CIL Label */ 
          {
#line 738
          compose2(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 738
          goto switch_break___0;
          case_3: /* CIL Label */ 
          {
#line 739
          compose3(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 739
          goto switch_break___0;
          case_4___0: /* CIL Label */ 
          {
#line 740
          compose4(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 740
          goto switch_break___0;
          case_6: /* CIL Label */ 
          {
#line 741
          compose6(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 741
          goto switch_break___0;
          switch_break___0: /* CIL Label */ ;
          }
#line 743
          zsize = 0;
#line 745
          if ((int )dop != 2) {
#line 747
            if ((int )coltype == 0) {
              {
#line 748
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            } else
#line 747
            if ((int )coltype == 3) {
              {
#line 748
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            }
            {
#line 750
            memcpy((void */* __restrict  */)(pImg2 + outimg2), (void const   */* __restrict  */)pImg2,
                   (size_t )outimg2);
            }
#line 752
            if ((int )dop == 1) {
#line 754
              if ((int )coltype == 0) {
#line 754
                goto _L;
              } else
#line 754
              if ((int )coltype == 3) {
                _L: /* CIL Label */ 
#line 756
                if (trns_idx >= 0) {
#line 758
                  pDst1 += outimg1;
#line 759
                  j = 0U;
                  {
#line 759
                  while (1) {
                    while_continue___3: /* CIL Label */ ;
#line 759
                    if (! (j < h0)) {
#line 759
                      goto while_break___3;
                    }
                    {
#line 761
                    memset((void *)pDst1, trns_idx, (size_t )w0);
#line 762
                    pDst1 += outrow1;
#line 759
                    j ++;
                    }
                  }
                  while_break___3: /* CIL Label */ ;
                  }
                } else {
#line 766
                  keep_original = 0U;
                }
              }
#line 769
              pDst2 += outimg2;
#line 770
              j = 0U;
              {
#line 770
              while (1) {
                while_continue___4: /* CIL Label */ ;
#line 770
                if (! (j < h0)) {
#line 770
                  goto while_break___4;
                }
                {
#line 772
                memset((void *)pDst2, 0, (size_t )(w0 * 4U));
#line 773
                pDst2 += outrow2;
#line 770
                j ++;
                }
              }
              while_break___4: /* CIL Label */ ;
              }
            }
          }
#line 777
          if (fctl > 0U) {
#line 779
            pImg1 += outimg1;
#line 780
            pImg2 += outimg2;
#line 781
            frames_decoded ++;
          }
        }
        {
#line 785
        tmp___28 = read32(& seq, f1);
        }
#line 785
        if (tmp___28) {
#line 785
          goto while_break___0;
        }
        {
#line 786
        tmp___29 = read32(& w0, f1);
        }
#line 786
        if (tmp___29) {
#line 786
          goto while_break___0;
        }
        {
#line 787
        tmp___30 = read32(& h0, f1);
        }
#line 787
        if (tmp___30) {
#line 787
          goto while_break___0;
        }
        {
#line 788
        tmp___31 = read32(& x0, f1);
        }
#line 788
        if (tmp___31) {
#line 788
          goto while_break___0;
        }
        {
#line 789
        tmp___32 = read32(& y0, f1);
        }
#line 789
        if (tmp___32) {
#line 789
          goto while_break___0;
        }
        {
#line 790
        tmp___33 = read16(& d1, f1);
        }
#line 790
        if (tmp___33) {
#line 790
          goto while_break___0;
        }
        {
#line 791
        tmp___34 = read16(& d2, f1);
        }
#line 791
        if (tmp___34) {
#line 791
          goto while_break___0;
        }
        {
#line 792
        tmp___35 = fread((void */* __restrict  */)(& dop), (size_t )1, (size_t )1,
                         (FILE */* __restrict  */)f1);
        }
#line 792
        if (tmp___35 != 1UL) {
#line 792
          goto while_break___0;
        }
        {
#line 793
        tmp___36 = fread((void */* __restrict  */)(& bop), (size_t )1, (size_t )1,
                         (FILE */* __restrict  */)f1);
        }
#line 793
        if (tmp___36 != 1UL) {
#line 793
          goto while_break___0;
        }
        {
#line 794
        tmp___37 = read32(& crc, f1);
        }
#line 794
        if (tmp___37) {
#line 794
          goto while_break___0;
        }
#line 796
        if ((int )d2 == 0) {
#line 797
          *(pDelays + fctl) = d1;
        } else
#line 796
        if ((int )d2 == 100) {
#line 797
          *(pDelays + fctl) = d1;
        } else
#line 799
        if ((int )d2 == 10) {
#line 800
          *(pDelays + fctl) = (unsigned short )((int )d1 * 10);
        } else
#line 802
        if ((int )d2 == 1000) {
#line 803
          *(pDelays + fctl) = (unsigned short )((int )d1 / 10);
        } else {
#line 805
          *(pDelays + fctl) = (unsigned short )(((int )d1 * 100) / (int )d2);
        }
#line 807
        if (fctl == 0U) {
#line 809
          bop = (unsigned char)0;
#line 810
          if ((int )dop == 2) {
#line 811
            dop = (unsigned char)1;
          }
        }
#line 814
        if ((int )coltype <= 3) {
#line 814
          if (trnssize == 0U) {
#line 815
            bop = (unsigned char)0;
          }
        }
#line 817
        if ((int )pixeldepth >= 8) {
#line 817
          rowbytes = w0 * ((unsigned int )pixeldepth >> 3);
        } else {
#line 817
          rowbytes = (w0 * (unsigned int )pixeldepth + 7U) >> 3;
        }
#line 818
        fctl ++;
      } else
#line 821
      if (chunk == 1229209940U) {
        {
#line 823
        tmp___38 = fread((void */* __restrict  */)(pData + zsize), (size_t )1, (size_t )len,
                         (FILE */* __restrict  */)f1);
        }
#line 823
        if (tmp___38 != (size_t )len) {
#line 823
          goto while_break___0;
        }
        {
#line 824
        zsize = (int )((unsigned int )zsize + len);
#line 825
        tmp___39 = read32(& crc, f1);
        }
#line 825
        if (tmp___39) {
#line 825
          goto while_break___0;
        }
      } else
#line 828
      if (chunk == 1717846356U) {
        {
#line 830
        tmp___40 = read32(& seq, f1);
        }
#line 830
        if (tmp___40) {
#line 830
          goto while_break___0;
        }
        {
#line 831
        len -= 4U;
#line 832
        tmp___41 = fread((void */* __restrict  */)(pData + zsize), (size_t )1, (size_t )len,
                         (FILE */* __restrict  */)f1);
        }
#line 832
        if (tmp___41 != (size_t )len) {
#line 832
          goto while_break___0;
        }
        {
#line 833
        zsize = (int )((unsigned int )zsize + len);
#line 834
        tmp___42 = read32(& crc, f1);
        }
#line 834
        if (tmp___42) {
#line 834
          goto while_break___0;
        }
      } else
#line 837
      if (chunk == 1229278788U) {
        {
#line 839
        pDst1 = (pImg1 + y0 * outrow1) + x0;
#line 840
        pDst2 = (pImg2 + y0 * outrow2) + x0 * 4U;
#line 841
        unpack(zstream, pTemp, (unsigned int )imagesize, pData, (unsigned int )zsize,
               h0, rowbytes, bpp);
        }
        {
#line 844
        if ((int )coltype == 0) {
#line 844
          goto case_0___0;
        }
#line 845
        if ((int )coltype == 2) {
#line 845
          goto case_2___1;
        }
#line 846
        if ((int )coltype == 3) {
#line 846
          goto case_3___0;
        }
#line 847
        if ((int )coltype == 4) {
#line 847
          goto case_4___1;
        }
#line 848
        if ((int )coltype == 6) {
#line 848
          goto case_6___0;
        }
#line 842
        goto switch_break___1;
        case_0___0: /* CIL Label */ 
        {
#line 844
        compose0(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 844
        goto switch_break___1;
        case_2___1: /* CIL Label */ 
        {
#line 845
        compose2(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 845
        goto switch_break___1;
        case_3___0: /* CIL Label */ 
        {
#line 846
        compose3(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 846
        goto switch_break___1;
        case_4___1: /* CIL Label */ 
        {
#line 847
        compose4(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 847
        goto switch_break___1;
        case_6___0: /* CIL Label */ 
        {
#line 848
        compose6(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 848
        goto switch_break___1;
        switch_break___1: /* CIL Label */ ;
        }
#line 850
        frames_decoded ++;
#line 852
        if (frames_decoded == frames) {
#line 853
          res = 0;
        }
#line 855
        goto while_break___0;
      } else {
#line 859
        c = (unsigned char )(chunk >> 24);
#line 860
        if ((int )c < 65) {
#line 860
          goto while_break___0;
        } else
#line 860
        if ((int )c > 122) {
#line 860
          goto while_break___0;
        } else
#line 860
        if ((int )c > 90) {
#line 860
          if ((int )c < 97) {
#line 860
            goto while_break___0;
          }
        }
#line 861
        c = (unsigned char )((chunk >> 16) & 255U);
#line 862
        if ((int )c < 65) {
#line 862
          goto while_break___0;
        } else
#line 862
        if ((int )c > 122) {
#line 862
          goto while_break___0;
        } else
#line 862
        if ((int )c > 90) {
#line 862
          if ((int )c < 97) {
#line 862
            goto while_break___0;
          }
        }
#line 863
        c = (unsigned char )((chunk >> 8) & 255U);
#line 864
        if ((int )c < 65) {
#line 864
          goto while_break___0;
        } else
#line 864
        if ((int )c > 122) {
#line 864
          goto while_break___0;
        } else
#line 864
        if ((int )c > 90) {
#line 864
          if ((int )c < 97) {
#line 864
            goto while_break___0;
          }
        }
#line 865
        c = (unsigned char )(chunk & 255U);
#line 866
        if ((int )c < 65) {
#line 866
          goto while_break___0;
        } else
#line 866
        if ((int )c > 122) {
#line 866
          goto while_break___0;
        } else
#line 866
        if ((int )c > 90) {
#line 866
          if ((int )c < 97) {
#line 866
            goto while_break___0;
          }
        }
        {
#line 868
        fseek(f1, (long )len, 1);
#line 869
        tmp___43 = read32(& crc, f1);
        }
#line 869
        if (tmp___43) {
#line 869
          goto while_break___0;
        }
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 873
    *pWidth = (int )w;
#line 874
    *pHeight = (int )h;
#line 875
    *pColType = (int )coltype;
#line 876
    *pFrames = (int )frames;
#line 877
    *pLoops = (int )loops;
#line 878
    *ppOut1 = pOut1;
#line 879
    *ppOut2 = pOut2;
#line 880
    *ppDelays = pDelays;
#line 882
    free((void *)pData);
#line 883
    free((void *)pTemp);
    }
#line 553
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 887
  inflateEnd(& zstream);
#line 888
  fclose(f1);
  }
#line 889
  return (res);
}
}
#line 892 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void WuHistogram(int size , unsigned char *pOut1 , unsigned char *pOut2 ) 
{ 
  int i ;
  int j ;
  int r ;
  int g ;
  int b ;
  int inr ;
  int ing ;
  int inb ;
  unsigned char *ps ;
  unsigned int *pd ;
  int table[256] ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned int *tmp___2 ;
  unsigned int *tmp___3 ;
  unsigned char *tmp___4 ;

  {
#line 899
  i = 0;
  {
#line 899
  while (1) {
    while_continue: /* CIL Label */ ;
#line 899
    if (! (i < 256)) {
#line 899
      goto while_break;
    }
#line 900
    table[i] = i * i;
#line 899
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 902
  memset((void *)(wt), 0, 274625UL * sizeof(int ));
#line 903
  memset((void *)(mr), 0, 274625UL * sizeof(int ));
#line 904
  memset((void *)(mg), 0, 274625UL * sizeof(int ));
#line 905
  memset((void *)(mb), 0, 274625UL * sizeof(int ));
#line 906
  memset((void *)(m2), 0, 274625UL * sizeof(double ));
#line 908
  ps = pOut2;
#line 909
  pd = (unsigned int *)pOut1;
#line 911
  i = 0;
  }
  {
#line 911
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 911
    if (! (i < size)) {
#line 911
      goto while_break___0;
    }
#line 913
    tmp = ps;
#line 913
    ps ++;
#line 913
    r = (int )*tmp;
#line 914
    tmp___0 = ps;
#line 914
    ps ++;
#line 914
    g = (int )*tmp___0;
#line 915
    tmp___1 = ps;
#line 915
    ps ++;
#line 915
    b = (int )*tmp___1;
#line 916
    tmp___4 = ps;
#line 916
    ps ++;
#line 916
    if ((int )*tmp___4 >= tlevel) {
#line 918
      inr = (r >> 2) + 1;
#line 919
      ing = (g >> 2) + 1;
#line 920
      inb = (b >> 2) + 1;
#line 921
      tmp___2 = pd;
#line 921
      pd ++;
#line 921
      j = (((((inr << 12) + (inr << 7)) + inr) + (ing << 6)) + ing) + inb;
#line 921
      *tmp___2 = (unsigned int )j;
#line 922
      (wt[j]) ++;
#line 923
      mr[j] += r;
#line 924
      mg[j] += g;
#line 925
      mb[j] += b;
#line 926
      m2[j] += (double )((table[r] + table[g]) + table[b]);
    } else {
#line 929
      tmp___3 = pd;
#line 929
      pd ++;
#line 929
      *tmp___3 = 0U;
    }
#line 911
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 931
  return;
}
}
#line 933 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void WuMoments(void) 
{ 
  unsigned int ind1 ;
  unsigned int ind2 ;
  unsigned char i ;
  unsigned char r ;
  unsigned char g ;
  unsigned char b ;
  int line ;
  int line_r ;
  int line_g ;
  int line_b ;
  double line2 ;
  int area[65] ;
  int area_r[65] ;
  int area_g[65] ;
  int area_b[65] ;
  double area2[65] ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 942
  r = (unsigned char)1;
  {
#line 942
  while (1) {
    while_continue: /* CIL Label */ ;
#line 942
    if (! ((int )r <= 64)) {
#line 942
      goto while_break;
    }
#line 944
    i = (unsigned char)0;
    {
#line 944
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 944
      if (! ((int )i <= 64)) {
#line 944
        goto while_break___0;
      }
#line 946
      tmp___1 = 0;
#line 946
      area_b[i] = tmp___1;
#line 946
      tmp___0 = tmp___1;
#line 946
      area_g[i] = tmp___0;
#line 946
      tmp = tmp___0;
#line 946
      area_r[i] = tmp;
#line 946
      area[i] = tmp;
#line 947
      area2[i] = 0.0;
#line 944
      i = (unsigned char )((int )i + 1);
    }
    while_break___0: /* CIL Label */ ;
    }
#line 950
    g = (unsigned char)1;
    {
#line 950
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 950
      if (! ((int )g <= 64)) {
#line 950
        goto while_break___1;
      }
#line 952
      line_b = 0;
#line 952
      line_g = line_b;
#line 952
      line_r = line_g;
#line 952
      line = line_r;
#line 953
      line2 = 0.0;
#line 955
      b = (unsigned char)1;
      {
#line 955
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 955
        if (! ((int )b <= 64)) {
#line 955
          goto while_break___2;
        }
#line 957
        ind1 = (unsigned int )(((((((int )r << 12) + ((int )r << 7)) + (int )r) + ((int )g << 6)) + (int )g) + (int )b);
#line 958
        line += wt[ind1];
#line 959
        line_r += mr[ind1];
#line 960
        line_g += mg[ind1];
#line 961
        line_b += mb[ind1];
#line 962
        line2 += m2[ind1];
#line 963
        area[b] += line;
#line 964
        area_r[b] += line_r;
#line 965
        area_g[b] += line_g;
#line 966
        area_b[b] += line_b;
#line 967
        area2[b] += line2;
#line 968
        ind2 = ind1 - 4225U;
#line 969
        wt[ind1] = wt[ind2] + area[b];
#line 970
        mr[ind1] = mr[ind2] + area_r[b];
#line 971
        mg[ind1] = mg[ind2] + area_g[b];
#line 972
        mb[ind1] = mb[ind2] + area_b[b];
#line 973
        m2[ind1] = m2[ind2] + area2[b];
#line 955
        b = (unsigned char )((int )b + 1);
      }
      while_break___2: /* CIL Label */ ;
      }
#line 950
      g = (unsigned char )((int )g + 1);
    }
    while_break___1: /* CIL Label */ ;
    }
#line 942
    r = (unsigned char )((int )r + 1);
  }
  while_break: /* CIL Label */ ;
  }
#line 977
  return;
}
}
#line 979 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int WuCubeStat(box *cube , int *m ) 
{ 


  {
#line 981
  return (((((((*(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + cube->b1)) - *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + cube->b0))) - *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b1))) + *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b0))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b1))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b0))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b1))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b0)));
}
}
#line 991 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int WuBottomStat(box *cube , unsigned char dir , int *m ) 
{ 


  {
  {
#line 995
  if ((int )dir == 2) {
#line 995
    goto case_2;
  }
#line 1001
  if ((int )dir == 1) {
#line 1001
    goto case_1;
  }
#line 1007
  if ((int )dir == 0) {
#line 1007
    goto case_0;
  }
#line 993
  goto switch_break;
  case_2: /* CIL Label */ 
#line 996
  return (((- *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b1)) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b0))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b1))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b0)));
#line 1000
  goto switch_break;
  case_1: /* CIL Label */ 
#line 1002
  return (((- *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b1)) + *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b0))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b1))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b0)));
#line 1006
  goto switch_break;
  case_0: /* CIL Label */ 
#line 1008
  return (((- *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + cube->b0)) + *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b0))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b0))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b0)));
#line 1012
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1014
  return (0);
}
}
#line 1017 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int WuTopStat(box *cube , unsigned char dir , int pos , int *m ) 
{ 


  {
  {
#line 1021
  if ((int )dir == 2) {
#line 1021
    goto case_2;
  }
#line 1027
  if ((int )dir == 1) {
#line 1027
    goto case_1;
  }
#line 1033
  if ((int )dir == 0) {
#line 1033
    goto case_0;
  }
#line 1019
  goto switch_break;
  case_2: /* CIL Label */ 
#line 1022
  return (((*(m + ((((((pos << 12) + (pos << 7)) + pos) + (cube->g1 << 6)) + cube->g1) + cube->b1)) - *(m + ((((((pos << 12) + (pos << 7)) + pos) + (cube->g1 << 6)) + cube->g1) + cube->b0))) - *(m + ((((((pos << 12) + (pos << 7)) + pos) + (cube->g0 << 6)) + cube->g0) + cube->b1))) + *(m + ((((((pos << 12) + (pos << 7)) + pos) + (cube->g0 << 6)) + cube->g0) + cube->b0)));
#line 1026
  goto switch_break;
  case_1: /* CIL Label */ 
#line 1028
  return (((*(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (pos << 6)) + pos) + cube->b1)) - *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (pos << 6)) + pos) + cube->b0))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (pos << 6)) + pos) + cube->b1))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (pos << 6)) + pos) + cube->b0)));
#line 1032
  goto switch_break;
  case_0: /* CIL Label */ 
#line 1034
  return (((*(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + pos)) - *(m + ((((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + pos))) - *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + pos))) + *(m + ((((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + pos)));
#line 1038
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1040
  return (0);
}
}
#line 1043 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
double WuVariance(box *cube ) 
{ 
  double dr ;
  double dg ;
  double db ;
  double dt ;
  double xx ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 1047
  tmp = WuCubeStat(cube, mr);
#line 1047
  dr = (double )tmp;
#line 1048
  tmp___0 = WuCubeStat(cube, mg);
#line 1048
  dg = (double )tmp___0;
#line 1049
  tmp___1 = WuCubeStat(cube, mb);
#line 1049
  db = (double )tmp___1;
#line 1050
  tmp___2 = WuCubeStat(cube, wt);
#line 1050
  dt = (double )tmp___2;
#line 1051
  xx = ((((((m2[(((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + cube->b1] - m2[(((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g1 << 6)) + cube->g1) + cube->b0]) - m2[(((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b1]) + m2[(((((cube->r1 << 12) + (cube->r1 << 7)) + cube->r1) + (cube->g0 << 6)) + cube->g0) + cube->b0]) - m2[(((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b1]) + m2[(((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g1 << 6)) + cube->g1) + cube->b0]) + m2[(((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b1]) - m2[(((((cube->r0 << 12) + (cube->r0 << 7)) + cube->r0) + (cube->g0 << 6)) + cube->g0) + cube->b0];
  }
#line 1060
  return (xx - ((dr * dr + dg * dg) + db * db) / dt);
}
}
#line 1063 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
double WuMaximize(box *cube , unsigned char dir , int first , int last , int *cut ,
                  int whole_r , int whole_g , int whole_b , int whole_w ) 
{ 
  int half_r ;
  int half_g ;
  int half_b ;
  int half_w ;
  int base_r ;
  int base_g ;
  int base_b ;
  int base_w ;
  int i ;
  double temp ;
  double res ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 1070
  base_r = WuBottomStat(cube, dir, mr);
#line 1071
  base_g = WuBottomStat(cube, dir, mg);
#line 1072
  base_b = WuBottomStat(cube, dir, mb);
#line 1073
  base_w = WuBottomStat(cube, dir, wt);
#line 1074
  res = 0.0;
#line 1075
  *cut = -1;
#line 1077
  i = first;
  }
  {
#line 1077
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1077
    if (! (i < last)) {
#line 1077
      goto while_break;
    }
    {
#line 1079
    tmp = WuTopStat(cube, dir, i, mr);
#line 1079
    half_r = base_r + tmp;
#line 1080
    tmp___0 = WuTopStat(cube, dir, i, mg);
#line 1080
    half_g = base_g + tmp___0;
#line 1081
    tmp___1 = WuTopStat(cube, dir, i, mb);
#line 1081
    half_b = base_b + tmp___1;
#line 1082
    tmp___2 = WuTopStat(cube, dir, i, wt);
#line 1082
    half_w = base_w + tmp___2;
    }
#line 1084
    if (half_w == 0) {
#line 1085
      goto __Cont;
    } else {
#line 1087
      temp = (((double )half_r * (double )half_r + (double )half_g * (double )half_g) + (double )half_b * (double )half_b) / (double )half_w;
    }
#line 1089
    half_r = whole_r - half_r;
#line 1090
    half_g = whole_g - half_g;
#line 1091
    half_b = whole_b - half_b;
#line 1092
    half_w = whole_w - half_w;
#line 1094
    if (half_w == 0) {
#line 1095
      goto __Cont;
    } else {
#line 1097
      temp += (((double )half_r * (double )half_r + (double )half_g * (double )half_g) + (double )half_b * (double )half_b) / (double )half_w;
    }
#line 1099
    if (temp > res) {
#line 1099
      res = temp;
#line 1099
      *cut = i;
    }
    __Cont: /* CIL Label */ 
#line 1077
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1102
  return (res);
}
}
#line 1105 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int WuCut(box *set1 , box *set2 ) 
{ 
  unsigned char dir ;
  double maxr ;
  double maxg ;
  double maxb ;
  int cutr ;
  int cutg ;
  int cutb ;
  int whole_r ;
  int whole_g ;
  int whole_b ;
  int whole_w ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 1112
  whole_r = WuCubeStat(set1, mr);
#line 1113
  whole_g = WuCubeStat(set1, mg);
#line 1114
  whole_b = WuCubeStat(set1, mb);
#line 1115
  whole_w = WuCubeStat(set1, wt);
#line 1117
  maxr = WuMaximize(set1, (unsigned char)2, set1->r0 + 1, set1->r1, & cutr, whole_r,
                    whole_g, whole_b, whole_w);
#line 1118
  maxg = WuMaximize(set1, (unsigned char)1, set1->g0 + 1, set1->g1, & cutg, whole_r,
                    whole_g, whole_b, whole_w);
#line 1119
  maxb = WuMaximize(set1, (unsigned char)0, set1->b0 + 1, set1->b1, & cutb, whole_r,
                    whole_g, whole_b, whole_w);
  }
#line 1121
  if (maxr >= maxg) {
#line 1121
    if (maxr >= maxb) {
#line 1123
      dir = (unsigned char)2;
#line 1124
      if (cutr < 0) {
#line 1125
        return (0);
      }
    } else {
#line 1121
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 1128
  if (maxg >= maxr) {
#line 1128
    if (maxg >= maxb) {
#line 1129
      dir = (unsigned char)1;
    } else {
#line 1131
      dir = (unsigned char)0;
    }
  } else {
#line 1131
    dir = (unsigned char)0;
  }
#line 1133
  set2->r1 = set1->r1;
#line 1134
  set2->g1 = set1->g1;
#line 1135
  set2->b1 = set1->b1;
  {
#line 1139
  if ((int )dir == 2) {
#line 1139
    goto case_2;
  }
#line 1144
  if ((int )dir == 1) {
#line 1144
    goto case_1;
  }
#line 1149
  if ((int )dir == 0) {
#line 1149
    goto case_0;
  }
#line 1137
  goto switch_break;
  case_2: /* CIL Label */ 
#line 1140
  tmp = cutr;
#line 1140
  set1->r1 = tmp;
#line 1140
  set2->r0 = tmp;
#line 1141
  set2->g0 = set1->g0;
#line 1142
  set2->b0 = set1->b0;
#line 1143
  goto switch_break;
  case_1: /* CIL Label */ 
#line 1145
  tmp___0 = cutg;
#line 1145
  set1->g1 = tmp___0;
#line 1145
  set2->g0 = tmp___0;
#line 1146
  set2->r0 = set1->r0;
#line 1147
  set2->b0 = set1->b0;
#line 1148
  goto switch_break;
  case_0: /* CIL Label */ 
#line 1150
  tmp___1 = cutb;
#line 1150
  set1->b1 = tmp___1;
#line 1150
  set2->b0 = tmp___1;
#line 1151
  set2->r0 = set1->r0;
#line 1152
  set2->g0 = set1->g0;
#line 1153
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1156
  set1->vol = ((set1->r1 - set1->r0) * (set1->g1 - set1->g0)) * (set1->b1 - set1->b0);
#line 1157
  set2->vol = ((set2->r1 - set2->r0) * (set2->g1 - set2->g0)) * (set2->b1 - set2->b0);
#line 1159
  return (1);
}
}
#line 1162 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
void ConvertTo8bit(int coltype , int size , unsigned char *pOut1 , unsigned char *pOut2 ) 
{ 
  int i ;
  int j ;
  int k ;
  int n ;
  int trans ;
  int colors8 ;
  int colors7 ;
  int weight ;
  unsigned int c ;
  unsigned char r ;
  unsigned char g ;
  unsigned char b ;
  unsigned char a ;
  unsigned char *ps ;
  unsigned char *pd ;
  unsigned int *pt ;
  unsigned int bit[256] ;
  box cube[256] ;
  double temp ;
  double vv[256] ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned char *tmp___2 ;
  unsigned char *tmp___3 ;
  unsigned char *tmp___4 ;
  unsigned char *tmp___5 ;
  unsigned char *tmp___6 ;
  unsigned char *tmp___7 ;
  unsigned char *tmp___8 ;
  unsigned char *tmp___9 ;
  unsigned char *tmp___10 ;
  unsigned char *tmp___11 ;
  unsigned char *tmp___12 ;
  unsigned char *tmp___13 ;
  unsigned char *tmp___14 ;
  double tmp___15 ;
  double tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  unsigned char tmp___21 ;
  unsigned char tmp___22 ;
  unsigned char *tmp___23 ;
  unsigned int *tmp___24 ;
  unsigned int gray[256] ;
  unsigned char *tmp___25 ;
  unsigned char *tmp___26 ;
  unsigned char *tmp___27 ;

  {
#line 1175
  if (coltype == 2) {
#line 1175
    goto _L;
  } else
#line 1175
  if (coltype == 4) {
#line 1175
    goto _L;
  } else
#line 1175
  if (coltype == 6) {
#line 1175
    goto _L;
  } else
#line 1175
  if (keep_original == 0U) {
    _L: /* CIL Label */ 
    {
#line 1177
    memset((void *)(pal), 0, (size_t )768);
#line 1179
    i = 0;
    }
    {
#line 1179
    while (1) {
      while_continue: /* CIL Label */ ;
#line 1179
      if (! (i < 256)) {
#line 1179
        goto while_break;
      }
#line 1180
      bit[i] = (unsigned int )(((((((((i >> 7) & 1) + ((i >> 6) & 1)) + ((i >> 5) & 1)) + ((i >> 4) & 1)) + ((i >> 3) & 1)) + ((i >> 2) & 1)) + ((i >> 1) & 1)) + (i & 1));
#line 1179
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 1182
    memset((void *)(bigcube), 0, (size_t )2097152);
#line 1183
    trans = 0;
#line 1184
    ps = pOut2;
    }
#line 1186
    if (bcolor == -1) {
#line 1188
      i = 0;
      {
#line 1188
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 1188
        if (! (i < size)) {
#line 1188
          goto while_break___0;
        }
#line 1190
        tmp = ps;
#line 1190
        ps ++;
#line 1190
        r = *tmp;
#line 1191
        tmp___0 = ps;
#line 1191
        ps ++;
#line 1191
        g = *tmp___0;
#line 1192
        tmp___1 = ps;
#line 1192
        ps ++;
#line 1192
        b = *tmp___1;
#line 1193
        tmp___2 = ps;
#line 1193
        ps ++;
#line 1193
        if ((int )*tmp___2 >= tlevel) {
#line 1194
          bigcube[(int )r >> 1][(int )g >> 1][(int )b >> 1] = (unsigned char )((int )bigcube[(int )r >> 1][(int )g >> 1][(int )b >> 1] | (1 << (((((int )r & 1) << 2) + (((int )g & 1) << 1)) + ((int )b & 1))));
        } else {
#line 1196
          trans = 1;
        }
#line 1188
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 1198
      if (coltype == 2) {
#line 1198
        if (trnssize > 0U) {
#line 1200
          pal[0][0] = (unsigned char )trns1;
#line 1201
          pal[0][1] = (unsigned char )trns2;
#line 1202
          pal[0][2] = (unsigned char )trns3;
        }
      }
    } else {
#line 1207
      i = 0;
      {
#line 1207
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 1207
        if (! (i < size)) {
#line 1207
          goto while_break___1;
        }
#line 1209
        r = *(ps + 0);
#line 1210
        g = *(ps + 1);
#line 1211
        b = *(ps + 2);
#line 1212
        a = *(ps + 3);
#line 1213
        if ((int )a > 0) {
#line 1215
          if ((int )a < 255) {
#line 1217
            r = (unsigned char )(((int )r * (int )a + back_r * (255 - (int )a)) / 255);
#line 1217
            *(ps + 0) = r;
#line 1218
            g = (unsigned char )(((int )g * (int )a + back_g * (255 - (int )a)) / 255);
#line 1218
            *(ps + 1) = g;
#line 1219
            b = (unsigned char )(((int )b * (int )a + back_b * (255 - (int )a)) / 255);
#line 1219
            *(ps + 2) = b;
#line 1220
            *(ps + 3) = (unsigned char)255;
          }
#line 1222
          bigcube[(int )r >> 1][(int )g >> 1][(int )b >> 1] = (unsigned char )((int )bigcube[(int )r >> 1][(int )g >> 1][(int )b >> 1] | (1 << (((((int )r & 1) << 2) + (((int )g & 1) << 1)) + ((int )b & 1))));
        } else {
#line 1225
          trans = 1;
        }
#line 1207
        i ++;
#line 1207
        ps += 4;
      }
      while_break___1: /* CIL Label */ ;
      }
#line 1227
      pal[0][0] = (unsigned char )back_r;
#line 1228
      pal[0][1] = (unsigned char )back_g;
#line 1229
      pal[0][2] = (unsigned char )back_b;
    }
#line 1232
    colors7 = trans;
#line 1232
    colors8 = colors7;
#line 1234
    i = 0;
    {
#line 1234
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 1234
      if (! (i < 128)) {
#line 1234
        goto while_break___2;
      }
#line 1235
      j = 0;
      {
#line 1235
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 1235
        if (! (j < 128)) {
#line 1235
          goto while_break___3;
        }
#line 1236
        k = 0;
        {
#line 1236
        while (1) {
          while_continue___4: /* CIL Label */ ;
#line 1236
          if (! (k < 128)) {
#line 1236
            goto while_break___4;
          }
#line 1237
          a = bigcube[i][j][k];
#line 1237
          if ((int )a != 0) {
#line 1239
            colors8 = (int )((unsigned int )colors8 + bit[a]);
#line 1240
            colors7 ++;
          }
#line 1236
          k ++;
        }
        while_break___4: /* CIL Label */ ;
        }
#line 1235
        j ++;
      }
      while_break___3: /* CIL Label */ ;
      }
#line 1234
      i ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    {
#line 1242
    printf((char const   */* __restrict  */)"%d colors.\n", colors8);
    }
#line 1244
    if (colors8 <= 256) {
#line 1246
      if (colors8 < 256) {
#line 1247
        trans = 1;
      }
#line 1249
      palsize = (unsigned int )trans;
#line 1250
      trns_idx = -1;
#line 1251
      if (trans) {
#line 1252
        trns_idx = 0;
      }
#line 1254
      i = 0;
      {
#line 1254
      while (1) {
        while_continue___5: /* CIL Label */ ;
#line 1254
        if (! (i < 128)) {
#line 1254
          goto while_break___5;
        }
#line 1255
        j = 0;
        {
#line 1255
        while (1) {
          while_continue___6: /* CIL Label */ ;
#line 1255
          if (! (j < 128)) {
#line 1255
            goto while_break___6;
          }
#line 1256
          k = 0;
          {
#line 1256
          while (1) {
            while_continue___7: /* CIL Label */ ;
#line 1256
            if (! (k < 128)) {
#line 1256
              goto while_break___7;
            }
#line 1257
            a = bigcube[i][j][k];
#line 1257
            if ((int )a != 0) {
#line 1259
              n = 0;
              {
#line 1259
              while (1) {
                while_continue___8: /* CIL Label */ ;
#line 1259
                if (! (n < 8)) {
#line 1259
                  goto while_break___8;
                }
#line 1260
                if ((int )a & 1) {
#line 1262
                  pal[palsize][0] = (unsigned char )((i << 1) + ((n >> 2) & 1));
#line 1263
                  pal[palsize][1] = (unsigned char )((j << 1) + ((n >> 1) & 1));
#line 1264
                  pal[palsize][2] = (unsigned char )((k << 1) + (n & 1));
#line 1265
                  palsize ++;
                }
#line 1259
                n ++;
#line 1259
                a = (unsigned char )((int )a >> 1);
              }
              while_break___8: /* CIL Label */ ;
              }
            }
#line 1256
            k ++;
          }
          while_break___7: /* CIL Label */ ;
          }
#line 1255
          j ++;
        }
        while_break___6: /* CIL Label */ ;
        }
#line 1254
        i ++;
      }
      while_break___5: /* CIL Label */ ;
      }
#line 1269
      ps = pOut2;
#line 1270
      pd = pOut1;
#line 1272
      i = 0;
      {
#line 1272
      while (1) {
        while_continue___9: /* CIL Label */ ;
#line 1272
        if (! (i < size)) {
#line 1272
          goto while_break___9;
        }
#line 1274
        tmp___3 = ps;
#line 1274
        ps ++;
#line 1274
        r = *tmp___3;
#line 1275
        tmp___4 = ps;
#line 1275
        ps ++;
#line 1275
        g = *tmp___4;
#line 1276
        tmp___5 = ps;
#line 1276
        ps ++;
#line 1276
        b = *tmp___5;
#line 1277
        tmp___8 = ps;
#line 1277
        ps ++;
#line 1277
        if ((int )*tmp___8 >= tlevel) {
#line 1279
          c = (unsigned int )trans;
          {
#line 1279
          while (1) {
            while_continue___10: /* CIL Label */ ;
#line 1279
            if (! (c < palsize)) {
#line 1279
              goto while_break___10;
            }
#line 1280
            if ((int )r == (int )pal[c][0]) {
#line 1280
              if ((int )g == (int )pal[c][1]) {
#line 1280
                if ((int )b == (int )pal[c][2]) {
#line 1281
                  goto while_break___10;
                }
              }
            }
#line 1279
            c ++;
          }
          while_break___10: /* CIL Label */ ;
          }
#line 1282
          tmp___6 = pd;
#line 1282
          pd ++;
#line 1282
          *tmp___6 = (unsigned char )c;
        } else {
#line 1285
          tmp___7 = pd;
#line 1285
          pd ++;
#line 1285
          *tmp___7 = (unsigned char)0;
        }
#line 1272
        i ++;
      }
      while_break___9: /* CIL Label */ ;
      }
    } else
#line 1289
    if (colors7 <= 256) {
#line 1291
      if (colors7 < 256) {
#line 1292
        trans = 1;
      }
#line 1294
      palsize = (unsigned int )trans;
#line 1295
      trns_idx = -1;
#line 1296
      if (trans) {
#line 1297
        trns_idx = 0;
      }
#line 1299
      i = 0;
      {
#line 1299
      while (1) {
        while_continue___11: /* CIL Label */ ;
#line 1299
        if (! (i < 128)) {
#line 1299
          goto while_break___11;
        }
#line 1300
        j = 0;
        {
#line 1300
        while (1) {
          while_continue___12: /* CIL Label */ ;
#line 1300
          if (! (j < 128)) {
#line 1300
            goto while_break___12;
          }
#line 1301
          k = 0;
          {
#line 1301
          while (1) {
            while_continue___13: /* CIL Label */ ;
#line 1301
            if (! (k < 128)) {
#line 1301
              goto while_break___13;
            }
#line 1302
            if ((int )bigcube[i][j][k] != 0) {
#line 1304
              pal[palsize][0] = (unsigned char )(i << 1);
#line 1305
              pal[palsize][1] = (unsigned char )(j << 1);
#line 1306
              pal[palsize][2] = (unsigned char )(k << 1);
#line 1307
              palsize ++;
            }
#line 1301
            k ++;
          }
          while_break___13: /* CIL Label */ ;
          }
#line 1300
          j ++;
        }
        while_break___12: /* CIL Label */ ;
        }
#line 1299
        i ++;
      }
      while_break___11: /* CIL Label */ ;
      }
#line 1310
      ps = pOut2;
#line 1311
      pd = pOut1;
#line 1313
      i = 0;
      {
#line 1313
      while (1) {
        while_continue___14: /* CIL Label */ ;
#line 1313
        if (! (i < size)) {
#line 1313
          goto while_break___14;
        }
#line 1315
        tmp___9 = ps;
#line 1315
        ps ++;
#line 1315
        r = *tmp___9;
#line 1316
        tmp___10 = ps;
#line 1316
        ps ++;
#line 1316
        g = *tmp___10;
#line 1317
        tmp___11 = ps;
#line 1317
        ps ++;
#line 1317
        b = *tmp___11;
#line 1318
        tmp___14 = ps;
#line 1318
        ps ++;
#line 1318
        if ((int )*tmp___14 >= tlevel) {
#line 1320
          r = (unsigned char )((int )r & 254);
#line 1321
          g = (unsigned char )((int )g & 254);
#line 1322
          b = (unsigned char )((int )b & 254);
#line 1323
          c = (unsigned int )trans;
          {
#line 1323
          while (1) {
            while_continue___15: /* CIL Label */ ;
#line 1323
            if (! (c < palsize)) {
#line 1323
              goto while_break___15;
            }
#line 1324
            if ((int )r == (int )pal[c][0]) {
#line 1324
              if ((int )g == (int )pal[c][1]) {
#line 1324
                if ((int )b == (int )pal[c][2]) {
#line 1325
                  goto while_break___15;
                }
              }
            }
#line 1323
            c ++;
          }
          while_break___15: /* CIL Label */ ;
          }
#line 1326
          tmp___12 = pd;
#line 1326
          pd ++;
#line 1326
          *tmp___12 = (unsigned char )c;
        } else {
#line 1329
          tmp___13 = pd;
#line 1329
          pd ++;
#line 1329
          *tmp___13 = (unsigned char)0;
        }
#line 1313
        i ++;
      }
      while_break___14: /* CIL Label */ ;
      }
    } else {
      {
#line 1334
      printf((char const   */* __restrict  */)"Wu quantization...\n");
#line 1336
      WuHistogram(size, pOut1, pOut2);
#line 1337
      WuMoments();
#line 1339
      trns_idx = 0;
#line 1340
      n = 1;
#line 1341
      cube[1].b0 = 0;
#line 1341
      cube[1].g0 = cube[1].b0;
#line 1341
      cube[1].r0 = cube[1].g0;
#line 1342
      cube[1].b1 = 64;
#line 1342
      cube[1].g1 = cube[1].b1;
#line 1342
      cube[1].r1 = cube[1].g1;
#line 1344
      i = 2;
      }
      {
#line 1344
      while (1) {
        while_continue___16: /* CIL Label */ ;
#line 1344
        if (! (i < 256)) {
#line 1344
          goto while_break___16;
        }
        {
#line 1346
        tmp___17 = WuCut(& cube[n], & cube[i]);
        }
#line 1346
        if (tmp___17) {
#line 1348
          if (cube[n].vol > 1) {
            {
#line 1348
            tmp___15 = WuVariance(& cube[n]);
#line 1348
            vv[n] = tmp___15;
            }
          } else {
#line 1348
            vv[n] = 0.0;
          }
#line 1349
          if (cube[i].vol > 1) {
            {
#line 1349
            tmp___16 = WuVariance(& cube[i]);
#line 1349
            vv[i] = tmp___16;
            }
          } else {
#line 1349
            vv[i] = 0.0;
          }
        } else {
#line 1353
          vv[n] = 0.0;
#line 1354
          i --;
        }
#line 1356
        palsize = (unsigned int )(i + 1);
#line 1357
        n = 1;
#line 1357
        temp = vv[1];
#line 1358
        k = 2;
        {
#line 1358
        while (1) {
          while_continue___17: /* CIL Label */ ;
#line 1358
          if (! (k <= i)) {
#line 1358
            goto while_break___17;
          }
#line 1359
          if (vv[k] > temp) {
#line 1361
            temp = vv[k];
#line 1361
            n = k;
          }
#line 1358
          k ++;
        }
        while_break___17: /* CIL Label */ ;
        }
#line 1363
        if (temp <= 0.0) {
#line 1364
          goto while_break___16;
        }
#line 1344
        i ++;
      }
      while_break___16: /* CIL Label */ ;
      }
      {
#line 1367
      memset((void *)(tag), 0, (size_t )274625);
#line 1369
      c = 1U;
      }
      {
#line 1369
      while (1) {
        while_continue___18: /* CIL Label */ ;
#line 1369
        if (! (c < palsize)) {
#line 1369
          goto while_break___18;
        }
#line 1371
        i = cube[c].r0 + 1;
        {
#line 1371
        while (1) {
          while_continue___19: /* CIL Label */ ;
#line 1371
          if (! (i <= cube[c].r1)) {
#line 1371
            goto while_break___19;
          }
#line 1372
          j = cube[c].g0 + 1;
          {
#line 1372
          while (1) {
            while_continue___20: /* CIL Label */ ;
#line 1372
            if (! (j <= cube[c].g1)) {
#line 1372
              goto while_break___20;
            }
#line 1373
            k = cube[c].b0 + 1;
            {
#line 1373
            while (1) {
              while_continue___21: /* CIL Label */ ;
#line 1373
              if (! (k <= cube[c].b1)) {
#line 1373
                goto while_break___21;
              }
#line 1374
              tag[(((((i << 12) + (i << 7)) + i) + (j << 6)) + j) + k] = (unsigned char )c;
#line 1373
              k ++;
            }
            while_break___21: /* CIL Label */ ;
            }
#line 1372
            j ++;
          }
          while_break___20: /* CIL Label */ ;
          }
#line 1371
          i ++;
        }
        while_break___19: /* CIL Label */ ;
        }
        {
#line 1376
        weight = WuCubeStat(& cube[c], wt);
        }
#line 1378
        if (weight) {
          {
#line 1380
          tmp___18 = WuCubeStat(& cube[c], mr);
#line 1380
          pal[c][0] = (unsigned char )(tmp___18 / weight);
#line 1381
          tmp___19 = WuCubeStat(& cube[c], mg);
#line 1381
          pal[c][1] = (unsigned char )(tmp___19 / weight);
#line 1382
          tmp___20 = WuCubeStat(& cube[c], mb);
#line 1382
          pal[c][2] = (unsigned char )(tmp___20 / weight);
          }
        } else {
#line 1386
          tmp___22 = (unsigned char)0;
#line 1386
          pal[c][2] = tmp___22;
#line 1386
          tmp___21 = tmp___22;
#line 1386
          pal[c][1] = tmp___21;
#line 1386
          pal[c][0] = tmp___21;
        }
#line 1369
        c ++;
      }
      while_break___18: /* CIL Label */ ;
      }
#line 1390
      pt = (unsigned int *)pOut1;
#line 1391
      pd = pOut1;
#line 1392
      i = 0;
      {
#line 1392
      while (1) {
        while_continue___22: /* CIL Label */ ;
#line 1392
        if (! (i < size)) {
#line 1392
          goto while_break___22;
        }
#line 1393
        tmp___23 = pd;
#line 1393
        pd ++;
#line 1393
        tmp___24 = pt;
#line 1393
        pt ++;
#line 1393
        *tmp___23 = tag[*tmp___24];
#line 1392
        i ++;
      }
      while_break___22: /* CIL Label */ ;
      }
    }
  } else
#line 1397
  if (coltype == 3) {
#line 1399
    if (bcolor == -1) {
#line 1401
      if (trns_idx == -1) {
#line 1402
        c = 0U;
        {
#line 1402
        while (1) {
          while_continue___23: /* CIL Label */ ;
#line 1402
          if (! (c < palsize)) {
#line 1402
            goto while_break___23;
          }
#line 1403
          if ((int )trns[c] < tlevel) {
#line 1405
            trns_idx = (int )c;
#line 1406
            goto while_break___23;
          }
#line 1402
          c ++;
        }
        while_break___23: /* CIL Label */ ;
        }
      }
#line 1409
      if (trns_idx >= 0) {
#line 1411
        ps = pOut1;
#line 1412
        i = 0;
        {
#line 1412
        while (1) {
          while_continue___24: /* CIL Label */ ;
#line 1412
          if (! (i < size)) {
#line 1412
            goto while_break___24;
          }
#line 1414
          if ((int )trns[*ps] < tlevel) {
#line 1415
            *ps = (unsigned char )trns_idx;
          }
#line 1412
          i ++;
#line 1412
          ps ++;
        }
        while_break___24: /* CIL Label */ ;
        }
      }
    } else {
#line 1421
      c = 0U;
      {
#line 1421
      while (1) {
        while_continue___25: /* CIL Label */ ;
#line 1421
        if (! (c < palsize)) {
#line 1421
          goto while_break___25;
        }
#line 1423
        if ((int )trns[c] == 0) {
#line 1425
          pal[c][0] = (unsigned char )back_r;
#line 1426
          pal[c][1] = (unsigned char )back_g;
#line 1427
          pal[c][2] = (unsigned char )back_b;
        } else
#line 1430
        if ((int )trns[c] < 255) {
#line 1432
          pal[c][0] = (unsigned char )(((int )pal[c][0] * (int )trns[c] + back_r * (255 - (int )trns[c])) / 255);
#line 1433
          pal[c][1] = (unsigned char )(((int )pal[c][1] * (int )trns[c] + back_g * (255 - (int )trns[c])) / 255);
#line 1434
          pal[c][2] = (unsigned char )(((int )pal[c][2] * (int )trns[c] + back_b * (255 - (int )trns[c])) / 255);
        }
#line 1421
        c ++;
      }
      while_break___25: /* CIL Label */ ;
      }
    }
  } else
#line 1440
  if (coltype == 0) {
    {
#line 1444
    memset((void *)(gray), 0, (size_t )1024);
#line 1445
    palsize = 0U;
#line 1446
    ps = pOut1;
    }
#line 1448
    if (trns_idx == -1) {
#line 1449
      i = 0;
      {
#line 1449
      while (1) {
        while_continue___26: /* CIL Label */ ;
#line 1449
        if (! (i < size)) {
#line 1449
          goto while_break___26;
        }
#line 1450
        tmp___25 = ps;
#line 1450
        ps ++;
#line 1450
        gray[*tmp___25] = 1U;
#line 1449
        i ++;
      }
      while_break___26: /* CIL Label */ ;
      }
    } else {
#line 1452
      i = 0;
      {
#line 1452
      while (1) {
        while_continue___27: /* CIL Label */ ;
#line 1452
        if (! (i < size)) {
#line 1452
          goto while_break___27;
        }
#line 1453
        if ((int )*ps != trns_idx) {
#line 1454
          gray[*ps] = 1U;
        }
#line 1452
        i ++;
#line 1452
        ps ++;
      }
      while_break___27: /* CIL Label */ ;
      }
    }
#line 1456
    if (trns_idx == -1) {
#line 1457
      i = 0;
      {
#line 1457
      while (1) {
        while_continue___28: /* CIL Label */ ;
#line 1457
        if (! (i < 256)) {
#line 1457
          goto while_break___28;
        }
#line 1458
        if (gray[i] == 0U) {
#line 1460
          trns_idx = i;
#line 1461
          goto while_break___28;
        }
#line 1457
        i ++;
      }
      while_break___28: /* CIL Label */ ;
      }
    }
#line 1464
    if (trns_idx >= 0) {
#line 1466
      if (bcolor != -1) {
#line 1468
        pal[0][0] = (unsigned char )back_r;
#line 1469
        pal[0][1] = (unsigned char )back_g;
#line 1470
        pal[0][2] = (unsigned char )back_b;
      } else
#line 1473
      if (trnssize > 0U) {
#line 1475
        pal[0][0] = (unsigned char )trns1;
#line 1476
        pal[0][1] = (unsigned char )trns1;
#line 1477
        pal[0][2] = (unsigned char )trns1;
      }
#line 1479
      palsize ++;
    }
#line 1482
    i = 0;
    {
#line 1482
    while (1) {
      while_continue___29: /* CIL Label */ ;
#line 1482
      if (! (i < 256)) {
#line 1482
        goto while_break___29;
      }
#line 1483
      if (gray[i] != 0U) {
#line 1485
        pal[palsize][0] = (unsigned char )i;
#line 1486
        pal[palsize][1] = (unsigned char )i;
#line 1487
        pal[palsize][2] = (unsigned char )i;
#line 1488
        palsize ++;
      }
#line 1482
      i ++;
    }
    while_break___29: /* CIL Label */ ;
    }
#line 1491
    ps = pOut1;
#line 1493
    if (trns_idx == -1) {
#line 1495
      i = 0;
      {
#line 1495
      while (1) {
        while_continue___30: /* CIL Label */ ;
#line 1495
        if (! (i < size)) {
#line 1495
          goto while_break___30;
        }
#line 1497
        c = 0U;
        {
#line 1497
        while (1) {
          while_continue___31: /* CIL Label */ ;
#line 1497
          if (! (c < palsize)) {
#line 1497
            goto while_break___31;
          }
#line 1498
          if ((int )*ps == (int )pal[c][0]) {
#line 1499
            goto while_break___31;
          }
#line 1497
          c ++;
        }
        while_break___31: /* CIL Label */ ;
        }
#line 1500
        tmp___26 = ps;
#line 1500
        ps ++;
#line 1500
        *tmp___26 = (unsigned char )c;
#line 1495
        i ++;
      }
      while_break___30: /* CIL Label */ ;
      }
    } else {
#line 1505
      i = 0;
      {
#line 1505
      while (1) {
        while_continue___32: /* CIL Label */ ;
#line 1505
        if (! (i < size)) {
#line 1505
          goto while_break___32;
        }
#line 1507
        if ((int )*ps == trns_idx) {
#line 1508
          c = 0U;
        } else {
#line 1510
          c = 1U;
          {
#line 1510
          while (1) {
            while_continue___33: /* CIL Label */ ;
#line 1510
            if (! (c < palsize)) {
#line 1510
              goto while_break___33;
            }
#line 1511
            if ((int )*ps == (int )pal[c][0]) {
#line 1512
              goto while_break___33;
            }
#line 1510
            c ++;
          }
          while_break___33: /* CIL Label */ ;
          }
        }
#line 1513
        tmp___27 = ps;
#line 1513
        ps ++;
#line 1513
        *tmp___27 = (unsigned char )c;
#line 1505
        i ++;
      }
      while_break___32: /* CIL Label */ ;
      }
#line 1515
      trns_idx = 0;
    }
  }
#line 1518
  return;
}
}
#line 1520 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int outcode(unsigned int code , FILE *f1 ) 
{ 
  size_t tmp ;

  {
#line 1522
  accum += code << (int )bits;
#line 1523
  bits = (unsigned char )((int )bits + (int )codesize);
  {
#line 1524
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1524
    if (! ((int )bits >= 8)) {
#line 1524
      goto while_break;
    }
#line 1526
    buf[0] = (unsigned char )((int )buf[0] + 1);
#line 1526
    buf[buf[0]] = (unsigned char )(accum & 255U);
#line 1527
    accum >>= 8;
#line 1528
    bits = (unsigned char )((int )bits - 8);
#line 1529
    if ((int )buf[0] == 255) {
      {
#line 1531
      tmp = fwrite((void const   */* __restrict  */)(buf), (size_t )1, (size_t )256,
                   (FILE */* __restrict  */)f1);
      }
#line 1531
      if (tmp != 256UL) {
#line 1531
        return (1);
      }
#line 1532
      buf[0] = (unsigned char)0;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1535
  return (0);
}
}
#line 1538 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int EncodeLZW(unsigned char *data , int datasize , FILE *f1 , unsigned char mincodesize ) 
{ 
  int hash[65536] ;
  int dict[65536] ;
  int i ;
  int clearcode ;
  int nextcode ;
  int cw ;
  int addr ;
  int w ;
  unsigned char c ;
  size_t tmp ;
  int tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned char *tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  size_t tmp___8 ;

  {
#line 1546
  if ((int )mincodesize == 1) {
#line 1546
    mincodesize = (unsigned char )((int )mincodesize + 1);
  }
  {
#line 1547
  tmp = fwrite((void const   */* __restrict  */)(& mincodesize), (size_t )1, (size_t )1,
               (FILE */* __restrict  */)f1);
  }
#line 1547
  if (tmp != 1UL) {
#line 1547
    return (1);
  }
  {
#line 1548
  memset((void *)(& hash), 0, sizeof(hash));
#line 1549
  clearcode = 1 << (int )mincodesize;
#line 1550
  codesize = (unsigned char )((int )mincodesize + 1);
#line 1551
  nextcode = clearcode + 2;
#line 1552
  accum = 0U;
#line 1553
  bits = (unsigned char)0;
#line 1554
  buf[0] = (unsigned char)0;
#line 1555
  tmp___0 = outcode((unsigned int )clearcode, f1);
  }
#line 1555
  if (tmp___0) {
#line 1555
    return (1);
  }
#line 1557
  tmp___1 = data;
#line 1557
  data ++;
#line 1557
  w = (int )*tmp___1;
#line 1558
  i = 1;
  {
#line 1558
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1558
    if (! (i < datasize)) {
#line 1558
      goto while_break;
    }
#line 1560
    tmp___2 = data;
#line 1560
    data ++;
#line 1560
    c = *tmp___2;
#line 1561
    cw = ((int )c << 16) + w;
#line 1562
    addr = (w << 4) | (int )c;
    {
#line 1564
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1564
      if (hash[addr] != 0) {
#line 1564
        if (! (dict[addr] != cw)) {
#line 1564
          goto while_break___0;
        }
      } else {
#line 1564
        goto while_break___0;
      }
#line 1566
      addr ++;
#line 1567
      addr &= 65535;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 1570
    if (hash[addr] == 0) {
#line 1572
      tmp___3 = nextcode;
#line 1572
      nextcode ++;
#line 1572
      hash[addr] = tmp___3;
#line 1573
      dict[addr] = cw;
#line 1574
      if (nextcode - 2 == 1 << (int )codesize) {
#line 1575
        codesize = (unsigned char )((int )codesize + 1);
      }
      {
#line 1576
      tmp___4 = outcode((unsigned int )w, f1);
      }
#line 1576
      if (tmp___4) {
#line 1576
        return (1);
      }
#line 1577
      w = (int )c;
#line 1578
      if (nextcode == 4094) {
        {
#line 1580
        tmp___5 = outcode((unsigned int )clearcode, f1);
        }
#line 1580
        if (tmp___5) {
#line 1580
          return (1);
        }
        {
#line 1581
        memset((void *)(& hash), 0, sizeof(hash));
#line 1582
        codesize = (unsigned char )((int )mincodesize + 1);
#line 1583
        nextcode = clearcode + 2;
        }
      }
    } else {
#line 1587
      w = hash[addr];
    }
#line 1558
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1589
  tmp___6 = outcode((unsigned int )w, f1);
  }
#line 1589
  if (tmp___6) {
#line 1589
    return (1);
  }
  {
#line 1590
  tmp___7 = outcode((unsigned int )(clearcode + 1), f1);
  }
#line 1590
  if (tmp___7) {
#line 1590
    return (1);
  }
#line 1592
  if (bits) {
#line 1593
    buf[0] = (unsigned char )((int )buf[0] + 1);
#line 1593
    buf[buf[0]] = (unsigned char )(accum & 255U);
  }
  {
#line 1595
  buf[(int )buf[0] + 1] = (unsigned char)0;
#line 1596
  tmp___8 = fwrite((void const   */* __restrict  */)(buf), (size_t )1, (size_t )((int )buf[0] + 2),
                   (FILE */* __restrict  */)f1);
  }
#line 1596
  if (tmp___8 - 2UL != (size_t )buf[0]) {
#line 1596
    return (1);
  }
#line 1597
  return (0);
}
}
#line 1600 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int SaveAGIF(char *szOut , unsigned char *pimg , unsigned short *pdelays , int w ,
             int h , int frames , int loops ) 
{ 
  unsigned char gif_head[13] ;
  int tmp ;
  unsigned char netscape[19] ;
  unsigned char gce[8] ;
  int tmp___0 ;
  unsigned char img_head[10] ;
  unsigned char bits___0 ;
  unsigned char end ;
  unsigned char trns_bit ;
  int tmp___1 ;
  unsigned char *ptemp ;
  unsigned char *pa ;
  unsigned char *pb ;
  unsigned char *pc ;
  int i ;
  int j ;
  int n ;
  int disp0 ;
  int x0 ;
  int y0 ;
  int w0 ;
  int h0 ;
  int x1 ;
  int y1 ;
  int w1 ;
  int h1 ;
  int x_min ;
  int y_min ;
  int x_max ;
  int y_max ;
  int imagesize ;
  int res ;
  FILE *f1 ;
  void *tmp___2 ;
  size_t tmp___3 ;
  size_t tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  size_t tmp___7 ;
  int tmp___8 ;
  unsigned char *tmp___9 ;
  unsigned char *tmp___10 ;
  size_t tmp___11 ;

  {
#line 1602
  if (trns_idx >= 0) {
#line 1602
    tmp = trns_idx;
  } else {
#line 1602
    tmp = 0;
  }
#line 1602
  gif_head[0] = (unsigned char )'G';
#line 1602
  gif_head[1] = (unsigned char )'I';
#line 1602
  gif_head[2] = (unsigned char )'F';
#line 1602
  gif_head[3] = (unsigned char )'8';
#line 1602
  gif_head[4] = (unsigned char )'9';
#line 1602
  gif_head[5] = (unsigned char )'a';
#line 1602
  gif_head[6] = (unsigned char )(w & 255);
#line 1602
  gif_head[7] = (unsigned char )((w >> 8) & 255);
#line 1602
  gif_head[8] = (unsigned char )(h & 255);
#line 1602
  gif_head[9] = (unsigned char )((h >> 8) & 255);
#line 1602
  gif_head[10] = (unsigned char)0;
#line 1602
  gif_head[11] = (unsigned char )tmp;
#line 1602
  gif_head[12] = (unsigned char)0;
#line 1603
  netscape[0] = (unsigned char)33;
#line 1603
  netscape[1] = (unsigned char)255;
#line 1603
  netscape[2] = (unsigned char)11;
#line 1603
  netscape[3] = (unsigned char )'N';
#line 1603
  netscape[4] = (unsigned char )'E';
#line 1603
  netscape[5] = (unsigned char )'T';
#line 1603
  netscape[6] = (unsigned char )'S';
#line 1603
  netscape[7] = (unsigned char )'C';
#line 1603
  netscape[8] = (unsigned char )'A';
#line 1603
  netscape[9] = (unsigned char )'P';
#line 1603
  netscape[10] = (unsigned char )'E';
#line 1603
  netscape[11] = (unsigned char )'2';
#line 1603
  netscape[12] = (unsigned char )'.';
#line 1603
  netscape[13] = (unsigned char )'0';
#line 1603
  netscape[14] = (unsigned char)3;
#line 1603
  netscape[15] = (unsigned char)1;
#line 1603
  netscape[16] = (unsigned char )(loops & 255);
#line 1603
  netscape[17] = (unsigned char )((loops >> 8) & 255);
#line 1603
  netscape[18] = (unsigned char)0;
#line 1604
  if (trns_idx >= 0) {
#line 1604
    tmp___0 = trns_idx;
  } else {
#line 1604
    tmp___0 = 0;
  }
#line 1604
  gce[0] = (unsigned char)33;
#line 1604
  gce[1] = (unsigned char)249;
#line 1604
  gce[2] = (unsigned char)4;
#line 1604
  gce[3] = (unsigned char)4;
#line 1604
  gce[4] = (unsigned char)10;
#line 1604
  gce[5] = (unsigned char)0;
#line 1604
  gce[6] = (unsigned char )tmp___0;
#line 1604
  gce[7] = (unsigned char)0;
#line 1605
  img_head[0] = (unsigned char)44;
#line 1605
  img_head[1] = (unsigned char)0;
#line 1605
  img_head[2] = (unsigned char)0;
#line 1605
  img_head[3] = (unsigned char)0;
#line 1605
  img_head[4] = (unsigned char)0;
#line 1605
  img_head[5] = (unsigned char )(w & 255);
#line 1605
  img_head[6] = (unsigned char )((w >> 8) & 255);
#line 1605
  img_head[7] = (unsigned char )(h & 255);
#line 1605
  img_head[8] = (unsigned char )((h >> 8) & 255);
#line 1605
  img_head[9] = (unsigned char)0;
#line 1606
  bits___0 = (unsigned char)7;
#line 1607
  end = (unsigned char)59;
#line 1608
  if (trns_idx >= 0) {
#line 1608
    tmp___1 = 1;
  } else {
#line 1608
    tmp___1 = 0;
  }
  {
#line 1608
  trns_bit = (unsigned char )tmp___1;
#line 1615
  imagesize = w * h;
#line 1616
  res = 1;
#line 1619
  f1 = fopen((char const   */* __restrict  */)szOut, (char const   */* __restrict  */)"wb");
  }
#line 1619
  if ((unsigned long )f1 == (unsigned long )((FILE *)0)) {
    {
#line 1621
    printf((char const   */* __restrict  */)"Error: can\'t open \'%s\'\n", szOut);
    }
#line 1622
    return (res);
  }
  {
#line 1625
  tmp___2 = malloc((size_t )imagesize);
#line 1625
  ptemp = (unsigned char *)tmp___2;
  }
#line 1625
  if ((unsigned long )ptemp == (unsigned long )((unsigned char *)0)) {
    {
#line 1627
    printf((char const   */* __restrict  */)"Error: not enough memory\n");
    }
#line 1628
    return (res);
  }
  {
#line 1631
  printf((char const   */* __restrict  */)"Writing \'%s\'...\n", szOut);
  }
  {
#line 1633
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1635
    if (palsize <= 2U) {
#line 1635
      bits___0 = (unsigned char)0;
    } else
#line 1636
    if (palsize <= 4U) {
#line 1636
      bits___0 = (unsigned char)1;
    } else
#line 1637
    if (palsize <= 8U) {
#line 1637
      bits___0 = (unsigned char)2;
    } else
#line 1638
    if (palsize <= 16U) {
#line 1638
      bits___0 = (unsigned char)3;
    } else
#line 1639
    if (palsize <= 32U) {
#line 1639
      bits___0 = (unsigned char)4;
    } else
#line 1640
    if (palsize <= 64U) {
#line 1640
      bits___0 = (unsigned char)5;
    } else
#line 1641
    if (palsize <= 128U) {
#line 1641
      bits___0 = (unsigned char)6;
    }
    {
#line 1643
    gif_head[10] = (unsigned char )(128 + 17 * (int )bits___0);
#line 1644
    bits___0 = (unsigned char )((int )bits___0 + 1);
#line 1645
    palsize = (unsigned int )(1 << (int )bits___0);
#line 1647
    tmp___3 = fwrite((void const   */* __restrict  */)(gif_head), (size_t )1, (size_t )13,
                     (FILE */* __restrict  */)f1);
    }
#line 1647
    if (tmp___3 != 13UL) {
#line 1647
      goto while_break;
    }
    {
#line 1648
    tmp___4 = fwrite((void const   */* __restrict  */)(pal), (size_t )3, (size_t )palsize,
                     (FILE */* __restrict  */)f1);
    }
#line 1648
    if (tmp___4 != (size_t )palsize) {
#line 1648
      goto while_break;
    }
    {
#line 1649
    tmp___5 = fwrite((void const   */* __restrict  */)(netscape), (size_t )1, (size_t )19,
                     (FILE */* __restrict  */)f1);
    }
#line 1649
    if (tmp___5 != 19UL) {
#line 1649
      goto while_break;
    }
#line 1651
    x1 = 0;
#line 1651
    x0 = x1;
#line 1652
    y1 = 0;
#line 1652
    y0 = y1;
#line 1653
    w1 = w;
#line 1653
    w0 = w1;
#line 1654
    h1 = h;
#line 1654
    h0 = h1;
#line 1656
    n = 0;
    {
#line 1656
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1656
      if (! (n < frames)) {
#line 1656
        goto while_break___0;
      }
#line 1658
      disp0 = 1;
#line 1660
      if (n < frames - 1) {
#line 1662
        y_min = w + h;
#line 1662
        x_min = y_min;
#line 1663
        y_max = 0;
#line 1663
        x_max = y_max;
#line 1664
        pa = pimg + imagesize * n;
#line 1665
        pb = pa + imagesize;
#line 1667
        j = 0;
        {
#line 1667
        while (1) {
          while_continue___1: /* CIL Label */ ;
#line 1667
          if (! (j < h)) {
#line 1667
            goto while_break___1;
          }
#line 1668
          i = 0;
          {
#line 1668
          while (1) {
            while_continue___2: /* CIL Label */ ;
#line 1668
            if (! (i < w)) {
#line 1668
              goto while_break___2;
            }
#line 1670
            if ((int )*pa != (int )*pb) {
#line 1672
              if (i < x_min) {
#line 1672
                x_min = i;
              }
#line 1673
              if (i > x_max) {
#line 1673
                x_max = i;
              }
#line 1674
              if (j < y_min) {
#line 1674
                y_min = j;
              }
#line 1675
              if (j > y_max) {
#line 1675
                y_max = j;
              }
#line 1676
              if (trns_idx >= 0) {
#line 1678
                if ((int )*pb == trns_idx) {
#line 1678
                  if ((int )*pa != trns_idx) {
#line 1680
                    disp0 = 2;
#line 1681
                    if (i < x0) {
#line 1681
                      w0 += x0 - i;
#line 1681
                      x0 = i;
                    }
#line 1682
                    if (i >= x0 + w0) {
#line 1682
                      w0 = (i - x0) + 1;
                    }
#line 1683
                    if (j < y0) {
#line 1683
                      h0 += y0 - j;
#line 1683
                      y0 = j;
                    }
#line 1684
                    if (j >= y0 + h0) {
#line 1684
                      h0 = (j - y0) + 1;
                    }
                  }
                }
              }
            }
#line 1688
            pa ++;
#line 1689
            pb ++;
#line 1668
            i ++;
          }
          while_break___2: /* CIL Label */ ;
          }
#line 1667
          j ++;
        }
        while_break___1: /* CIL Label */ ;
        }
#line 1692
        if (x_min <= x_max) {
#line 1694
          x1 = x_min;
#line 1695
          y1 = y_min;
#line 1696
          w1 = (x_max - x_min) + 1;
#line 1697
          h1 = (y_max - y_min) + 1;
        } else {
#line 1701
          y1 = 0;
#line 1701
          x1 = y1;
#line 1702
          h1 = 1;
#line 1702
          w1 = h1;
        }
      }
#line 1706
      pc = ptemp;
#line 1707
      pb = ((pimg + imagesize * n) + y0 * w) + x0;
#line 1709
      if (trns_idx >= 0) {
#line 1709
        if (n > 0) {
#line 1711
          pa = pb - imagesize;
#line 1712
          j = 0;
          {
#line 1712
          while (1) {
            while_continue___3: /* CIL Label */ ;
#line 1712
            if (! (j < h0)) {
#line 1712
              goto while_break___3;
            }
#line 1713
            i = 0;
            {
#line 1713
            while (1) {
              while_continue___4: /* CIL Label */ ;
#line 1713
              if (! (i < w0)) {
#line 1713
                goto while_break___4;
              }
#line 1714
              if ((int )*(pa + i) != (int )*(pb + i)) {
#line 1714
                *(pc + i) = *(pb + i);
              } else {
#line 1714
                *(pc + i) = (unsigned char )trns_idx;
              }
#line 1713
              i ++;
            }
            while_break___4: /* CIL Label */ ;
            }
#line 1712
            j ++;
#line 1712
            pa += w;
#line 1712
            pb += w;
#line 1712
            pc += w0;
          }
          while_break___3: /* CIL Label */ ;
          }
        } else {
#line 1709
          goto _L;
        }
      } else {
        _L: /* CIL Label */ 
#line 1718
        j = 0;
        {
#line 1718
        while (1) {
          while_continue___5: /* CIL Label */ ;
#line 1718
          if (! (j < h0)) {
#line 1718
            goto while_break___5;
          }
          {
#line 1719
          memcpy((void */* __restrict  */)pc, (void const   */* __restrict  */)pb,
                 (size_t )w0);
#line 1718
          j ++;
#line 1718
          pb += w;
#line 1718
          pc += w0;
          }
        }
        while_break___5: /* CIL Label */ ;
        }
      }
      {
#line 1722
      gce[3] = (unsigned char )((disp0 << 2) + (int )trns_bit);
#line 1723
      gce[4] = (unsigned char )((int )*(pdelays + n) & 255);
#line 1724
      gce[5] = (unsigned char )((int )*(pdelays + n) >> 8);
#line 1725
      img_head[1] = (unsigned char )(x0 & 255);
#line 1726
      img_head[2] = (unsigned char )((x0 >> 8) & 255);
#line 1727
      img_head[3] = (unsigned char )(y0 & 255);
#line 1728
      img_head[4] = (unsigned char )((y0 >> 8) & 255);
#line 1729
      img_head[5] = (unsigned char )(w0 & 255);
#line 1730
      img_head[6] = (unsigned char )((w0 >> 8) & 255);
#line 1731
      img_head[7] = (unsigned char )(h0 & 255);
#line 1732
      img_head[8] = (unsigned char )((h0 >> 8) & 255);
#line 1734
      tmp___6 = fwrite((void const   */* __restrict  */)(gce), (size_t )1, (size_t )8,
                       (FILE */* __restrict  */)f1);
      }
#line 1734
      if (tmp___6 != 8UL) {
#line 1734
        goto while_break___0;
      }
      {
#line 1735
      tmp___7 = fwrite((void const   */* __restrict  */)(img_head), (size_t )1, (size_t )10,
                       (FILE */* __restrict  */)f1);
      }
#line 1735
      if (tmp___7 != 10UL) {
#line 1735
        goto while_break___0;
      }
      {
#line 1736
      tmp___8 = EncodeLZW(ptemp, w0 * h0, f1, bits___0);
      }
#line 1736
      if (tmp___8) {
#line 1736
        goto while_break___0;
      }
#line 1738
      if (disp0 == 2) {
#line 1740
        pb = ((pimg + imagesize * n) + y0 * w) + x0;
#line 1741
        j = 0;
        {
#line 1741
        while (1) {
          while_continue___6: /* CIL Label */ ;
#line 1741
          if (! (j < h0)) {
#line 1741
            goto while_break___6;
          }
          {
#line 1742
          memset((void *)pb, trns_idx, (size_t )w0);
#line 1741
          j ++;
#line 1741
          pb += w;
          }
        }
        while_break___6: /* CIL Label */ ;
        }
#line 1744
        y_min = w + h;
#line 1744
        x_min = y_min;
#line 1745
        y_max = 0;
#line 1745
        x_max = y_max;
#line 1746
        pa = pimg + imagesize * n;
#line 1747
        pb = pa + imagesize;
#line 1749
        j = 0;
        {
#line 1749
        while (1) {
          while_continue___7: /* CIL Label */ ;
#line 1749
          if (! (j < h)) {
#line 1749
            goto while_break___7;
          }
#line 1750
          i = 0;
          {
#line 1750
          while (1) {
            while_continue___8: /* CIL Label */ ;
#line 1750
            if (! (i < w)) {
#line 1750
              goto while_break___8;
            }
#line 1752
            tmp___9 = pa;
#line 1752
            pa ++;
#line 1752
            tmp___10 = pb;
#line 1752
            pb ++;
#line 1752
            if ((int )*tmp___9 != (int )*tmp___10) {
#line 1754
              if (i < x_min) {
#line 1754
                x_min = i;
              }
#line 1755
              if (i > x_max) {
#line 1755
                x_max = i;
              }
#line 1756
              if (j < y_min) {
#line 1756
                y_min = j;
              }
#line 1757
              if (j > y_max) {
#line 1757
                y_max = j;
              }
            }
#line 1750
            i ++;
          }
          while_break___8: /* CIL Label */ ;
          }
#line 1749
          j ++;
        }
        while_break___7: /* CIL Label */ ;
        }
#line 1761
        if (x_min <= x_max) {
#line 1763
          x1 = x_min;
#line 1764
          y1 = y_min;
#line 1765
          w1 = (x_max - x_min) + 1;
#line 1766
          h1 = (y_max - y_min) + 1;
        } else {
#line 1770
          y1 = 0;
#line 1770
          x1 = y1;
#line 1771
          h1 = 1;
#line 1771
          w1 = h1;
        }
      }
#line 1775
      x0 = x1;
#line 1776
      y0 = y1;
#line 1777
      w0 = w1;
#line 1778
      h0 = h1;
#line 1656
      n ++;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 1781
    tmp___11 = fwrite((void const   */* __restrict  */)(& end), (size_t )1, (size_t )1,
                      (FILE */* __restrict  */)f1);
    }
#line 1781
    if (tmp___11 != 1UL) {
#line 1781
      goto while_break;
    }
#line 1782
    res = 0;
#line 1633
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1786
  free((void *)ptemp);
#line 1787
  fclose(f1);
  }
#line 1788
  return (res);
}
}
#line 1791 "/home/june/collector/temp/apng2gif-1.5/apng2gif.c"
int main(int argc , char **argv ) 
{ 
  char *szIn ;
  char szOut[256] ;
  char *szOpt ;
  char *szExt ;
  unsigned char *pOut1 ;
  unsigned char *pOut2 ;
  unsigned short *pDelays ;
  int i ;
  int w ;
  int h ;
  int coltype ;
  int frames ;
  int loops ;
  int tmp ;
  char const   *tmp___0 ;
  int tmp___1 ;

  {
  {
#line 1797
  pOut1 = (unsigned char *)((void *)0);
#line 1798
  pOut2 = (unsigned char *)((void *)0);
#line 1799
  pDelays = (unsigned short *)((void *)0);
#line 1802
  printf((char const   */* __restrict  */)"\napng2gif 1.5\n\n");
  }
#line 1804
  if (argc <= 1) {
    {
#line 1806
    printf((char const   */* __restrict  */)"Usage : apng2gif anim.png [anim.gif] [/t tlevel] [/b bcolor]\n\ntlevel: transparency threshold level (format: /t 128)\nbcolor: background blend color (format: /b #808080 or /b 128 128 128)\nWhen /b is used, /t is ignored. Default is /t 128, no bcolor.\n");
    }
#line 1810
    return (1);
  }
#line 1813
  szIn = *(argv + 1);
#line 1814
  szOut[0] = (char)0;
#line 1816
  tlevel = 128;
#line 1817
  bcolor = -1;
#line 1818
  back_b = 0;
#line 1818
  back_g = back_b;
#line 1818
  back_r = back_g;
#line 1820
  i = 2;
  {
#line 1820
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1820
    if (! (i < argc)) {
#line 1820
      goto while_break;
    }
#line 1822
    szOpt = *(argv + i);
#line 1824
    if ((int )*(szOpt + 0) == 47) {
#line 1824
      goto _L___1;
    } else
#line 1824
    if ((int )*(szOpt + 0) == 45) {
      _L___1: /* CIL Label */ 
#line 1826
      if ((int )*(szOpt + 1) == 116) {
#line 1826
        goto _L___0;
      } else
#line 1826
      if ((int )*(szOpt + 1) == 84) {
        _L___0: /* CIL Label */ 
#line 1828
        if (i < argc - 1) {
#line 1830
          i ++;
#line 1830
          szOpt = *(argv + i);
#line 1831
          if ((int )*(szOpt + 0) == 47) {
#line 1832
            i --;
          } else
#line 1831
          if ((int )*(szOpt + 0) == 45) {
#line 1832
            i --;
          } else {
            {
#line 1835
            tlevel = atoi((char const   *)szOpt);
            }
#line 1836
            if (tlevel < 1) {
#line 1837
              tlevel = 128;
            } else
#line 1836
            if (tlevel > 255) {
#line 1837
              tlevel = 128;
            }
          }
        }
      } else
#line 1842
      if ((int )*(szOpt + 1) == 98) {
#line 1842
        goto _L;
      } else
#line 1842
      if ((int )*(szOpt + 1) == 66) {
        _L: /* CIL Label */ 
#line 1844
        bcolor = 8421504;
#line 1845
        back_b = 128;
#line 1845
        back_g = back_b;
#line 1845
        back_r = back_g;
#line 1846
        if (i < argc - 1) {
#line 1848
          i ++;
#line 1848
          szOpt = *(argv + i);
#line 1849
          if ((int )*(szOpt + 0) == 47) {
#line 1850
            i --;
          } else
#line 1849
          if ((int )*(szOpt + 0) == 45) {
#line 1850
            i --;
          } else
#line 1852
          if ((int )*(szOpt + 0) == 35) {
            {
#line 1854
            sscanf((char const   */* __restrict  */)(szOpt + 1), (char const   */* __restrict  */)"%x",
                   (unsigned int *)(& bcolor));
#line 1855
            back_r = (bcolor >> 16) & 255;
#line 1856
            back_g = (bcolor >> 8) & 255;
#line 1857
            back_b = bcolor & 255;
            }
          } else
#line 1860
          if (i < argc - 2) {
            {
#line 1862
            back_r = atoi((char const   *)*(argv + i));
#line 1863
            i ++;
#line 1863
            back_g = atoi((char const   *)*(argv + i));
#line 1864
            i ++;
#line 1864
            back_b = atoi((char const   *)*(argv + i));
            }
#line 1865
            if (back_r < 0) {
#line 1865
              back_r = 0;
            }
#line 1866
            if (back_r > 255) {
#line 1866
              back_r = 255;
            }
#line 1867
            if (back_g < 0) {
#line 1867
              back_g = 0;
            }
#line 1868
            if (back_g > 255) {
#line 1868
              back_g = 255;
            }
#line 1869
            if (back_b < 0) {
#line 1869
              back_b = 0;
            }
#line 1870
            if (back_b > 255) {
#line 1870
              back_b = 255;
            }
#line 1871
            bcolor = ((back_r << 16) + (back_g << 8)) + back_b;
          }
        }
      }
    } else
#line 1877
    if ((int )szOut[0] == 0) {
      {
#line 1878
      strcpy((char */* __restrict  */)(szOut), (char const   */* __restrict  */)szOpt);
      }
    }
#line 1820
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1881
  if (bcolor != -1) {
#line 1882
    tlevel = 1;
  }
#line 1884
  if ((int )szOut[0] == 0) {
    {
#line 1886
    strcpy((char */* __restrict  */)(szOut), (char const   */* __restrict  */)szIn);
#line 1887
    szExt = strrchr((char const   *)(szOut), '.');
    }
#line 1887
    if ((unsigned long )szExt != (unsigned long )((void *)0)) {
#line 1887
      *szExt = (char)0;
    }
    {
#line 1888
    strcat((char */* __restrict  */)(szOut), (char const   */* __restrict  */)".gif");
    }
  }
  {
#line 1891
  tmp = LoadAPNG(szIn, & w, & h, & coltype, & frames, & loops, & pOut1, & pOut2, & pDelays);
  }
#line 1891
  if (tmp != 0) {
    {
#line 1893
    printf((char const   */* __restrict  */)"Error: can\'t load \'%s\'\n", szIn);
    }
#line 1894
    return (1);
  }
#line 1896
  if (frames == 1) {
#line 1896
    tmp___0 = "";
  } else {
#line 1896
    tmp___0 = "s";
  }
  {
#line 1896
  printf((char const   */* __restrict  */)"%d frame%s.\n", frames, tmp___0);
#line 1898
  ConvertTo8bit(coltype, (w * h) * frames, pOut1, pOut2);
#line 1900
  tmp___1 = SaveAGIF(szOut, pOut1, pDelays, w, h, frames, loops);
  }
#line 1900
  if (tmp___1 != 0) {
    {
#line 1902
    printf((char const   */* __restrict  */)"Error: can\'t save \'%s\'\n", szOut);
    }
#line 1903
    return (1);
  }
#line 1906
  if (pOut1) {
    {
#line 1907
    free((void *)pOut1);
    }
  }
#line 1908
  if (pOut2) {
    {
#line 1909
    free((void *)pOut2);
    }
  }
#line 1910
  if (pDelays) {
    {
#line 1911
    free((void *)pDelays);
    }
  }
  {
#line 1913
  printf((char const   */* __restrict  */)"all done\n");
  }
#line 1915
  return (0);
}
}
