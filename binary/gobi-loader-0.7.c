/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 124 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __dev_t;
#line 125 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 126 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __gid_t;
#line 127 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __ino_t;
#line 129 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __mode_t;
#line 130 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __nlink_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 153 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blksize_t;
#line 158 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blkcnt_t;
#line 172 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 175 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __syscall_slong_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 102 "/usr/include/stdio.h"
typedef __ssize_t ssize_t;
#line 120 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   __syscall_slong_t tv_nsec ;
};
#line 46 "/usr/include/x86_64-linux-gnu/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   __ino_t st_ino ;
   __nlink_t st_nlink ;
   __mode_t st_mode ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   int __pad0 ;
   __dev_t st_rdev ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __syscall_slong_t __glibc_reserved[3] ;
};
#line 23 "/usr/include/x86_64-linux-gnu/bits/termios.h"
typedef unsigned char cc_t;
#line 24 "/usr/include/x86_64-linux-gnu/bits/termios.h"
typedef unsigned int speed_t;
#line 25 "/usr/include/x86_64-linux-gnu/bits/termios.h"
typedef unsigned int tcflag_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/termios.h"
struct termios {
   tcflag_t c_iflag ;
   tcflag_t c_oflag ;
   tcflag_t c_cflag ;
   tcflag_t c_lflag ;
   cc_t c_line ;
   cc_t c_cc[32] ;
   speed_t c_ispeed ;
   speed_t c_ospeed ;
};
#line 170 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 846
extern void perror(char const   *__s ) ;
#line 144 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strcmp)(char const   *__s1 ,
                                                                                               char const   *__s2 )  __attribute__((__pure__)) ;
#line 214 "/usr/include/x86_64-linux-gnu/sys/stat.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) fstat)(int __fd ,
                                                                                            struct stat *__buf ) ;
#line 146 "/usr/include/fcntl.h"
extern int ( __attribute__((__nonnull__(1))) open)(char const   *__file , int __oflag 
                                                   , ...) ;
#line 66 "/usr/include/termios.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) tcgetattr)(int __fd ,
                                                                                struct termios *__termios_p ) ;
#line 70
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) tcsetattr)(int __fd ,
                                                                                int __optional_actions ,
                                                                                struct termios  const  *__termios_p ) ;
#line 76
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) cfmakeraw)(struct termios *__termios_p ) ;
#line 360 "/usr/include/unistd.h"
extern ssize_t read(int __fd , void *__buf , size_t __nbytes ) ;
#line 366
extern ssize_t write(int __fd , void const   *__buf , size_t __n ) ;
#line 497
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) chdir)(char const   *__path ) ;
#line 38 "/usr/include/malloc.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 32 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic1[38]  = 
#line 32 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
  {      (char)1,      (char)81,      (char)67,      (char)79, 
        (char)77,      (char)32,      (char)104,      (char)105, 
        (char)103,      (char)104,      (char)32,      (char)115, 
        (char)112,      (char)101,      (char)101,      (char)100, 
        (char)32,      (char)112,      (char)114,      (char)111, 
        (char)116,      (char)111,      (char)99,      (char)111, 
        (char)108,      (char)32,      (char)104,      (char)115, 
        (char)116,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)4,      (char)4,      (char)48, 
        (char)-1,      (char)-1};
#line 40 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic2[15]  = 
#line 40
  {      (char)37,      (char)5,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)1,      (char)0, 
        (char)0,      (char)0,      (char)4,      (char)0, 
        (char)0,      (char)-1,      (char)-1};
#line 43 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic3[13]  = 
#line 43
  {      (char)39,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)-1, 
        (char)-1};
#line 46 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic4[15]  = 
#line 46
  {      (char)37,      (char)6,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)1,      (char)0, 
        (char)0,      (char)0,      (char)4,      (char)0, 
        (char)0,      (char)-1,      (char)-1};
#line 49 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic5[13]  = 
#line 49
  {      (char)39,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)-1, 
        (char)-1};
#line 52 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic6[15]  = 
#line 52
  {      (char)37,      (char)13,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)1,      (char)0, 
        (char)0,      (char)0,      (char)4,      (char)0, 
        (char)0,      (char)-1,      (char)-1};
#line 55 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic7[13]  = 
#line 55
  {      (char)39,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)0, 
        (char)0,      (char)0,      (char)0,      (char)-1, 
        (char)-1};
#line 58 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
char magic8[3]  = {      (char)41,      (char)-1,      (char)-1};
#line 67 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
unsigned short const   crc_ccitt_table[256]  = 
#line 67
  {      (unsigned short const   )0,      (unsigned short const   )4489,      (unsigned short const   )8978,      (unsigned short const   )12955, 
        (unsigned short const   )17956,      (unsigned short const   )22445,      (unsigned short const   )25910,      (unsigned short const   )29887, 
        (unsigned short const   )35912,      (unsigned short const   )40385,      (unsigned short const   )44890,      (unsigned short const   )48851, 
        (unsigned short const   )51820,      (unsigned short const   )56293,      (unsigned short const   )59774,      (unsigned short const   )63735, 
        (unsigned short const   )4225,      (unsigned short const   )264,      (unsigned short const   )13203,      (unsigned short const   )8730, 
        (unsigned short const   )22181,      (unsigned short const   )18220,      (unsigned short const   )30135,      (unsigned short const   )25662, 
        (unsigned short const   )40137,      (unsigned short const   )36160,      (unsigned short const   )49115,      (unsigned short const   )44626, 
        (unsigned short const   )56045,      (unsigned short const   )52068,      (unsigned short const   )63999,      (unsigned short const   )59510, 
        (unsigned short const   )8450,      (unsigned short const   )12427,      (unsigned short const   )528,      (unsigned short const   )5017, 
        (unsigned short const   )26406,      (unsigned short const   )30383,      (unsigned short const   )17460,      (unsigned short const   )21949, 
        (unsigned short const   )44362,      (unsigned short const   )48323,      (unsigned short const   )36440,      (unsigned short const   )40913, 
        (unsigned short const   )60270,      (unsigned short const   )64231,      (unsigned short const   )51324,      (unsigned short const   )55797, 
        (unsigned short const   )12675,      (unsigned short const   )8202,      (unsigned short const   )4753,      (unsigned short const   )792, 
        (unsigned short const   )30631,      (unsigned short const   )26158,      (unsigned short const   )21685,      (unsigned short const   )17724, 
        (unsigned short const   )48587,      (unsigned short const   )44098,      (unsigned short const   )40665,      (unsigned short const   )36688, 
        (unsigned short const   )64495,      (unsigned short const   )60006,      (unsigned short const   )55549,      (unsigned short const   )51572, 
        (unsigned short const   )16900,      (unsigned short const   )21389,      (unsigned short const   )24854,      (unsigned short const   )28831, 
        (unsigned short const   )1056,      (unsigned short const   )5545,      (unsigned short const   )10034,      (unsigned short const   )14011, 
        (unsigned short const   )52812,      (unsigned short const   )57285,      (unsigned short const   )60766,      (unsigned short const   )64727, 
        (unsigned short const   )34920,      (unsigned short const   )39393,      (unsigned short const   )43898,      (unsigned short const   )47859, 
        (unsigned short const   )21125,      (unsigned short const   )17164,      (unsigned short const   )29079,      (unsigned short const   )24606, 
        (unsigned short const   )5281,      (unsigned short const   )1320,      (unsigned short const   )14259,      (unsigned short const   )9786, 
        (unsigned short const   )57037,      (unsigned short const   )53060,      (unsigned short const   )64991,      (unsigned short const   )60502, 
        (unsigned short const   )39145,      (unsigned short const   )35168,      (unsigned short const   )48123,      (unsigned short const   )43634, 
        (unsigned short const   )25350,      (unsigned short const   )29327,      (unsigned short const   )16404,      (unsigned short const   )20893, 
        (unsigned short const   )9506,      (unsigned short const   )13483,      (unsigned short const   )1584,      (unsigned short const   )6073, 
        (unsigned short const   )61262,      (unsigned short const   )65223,      (unsigned short const   )52316,      (unsigned short const   )56789, 
        (unsigned short const   )43370,      (unsigned short const   )47331,      (unsigned short const   )35448,      (unsigned short const   )39921, 
        (unsigned short const   )29575,      (unsigned short const   )25102,      (unsigned short const   )20629,      (unsigned short const   )16668, 
        (unsigned short const   )13731,      (unsigned short const   )9258,      (unsigned short const   )5809,      (unsigned short const   )1848, 
        (unsigned short const   )65487,      (unsigned short const   )60998,      (unsigned short const   )56541,      (unsigned short const   )52564, 
        (unsigned short const   )47595,      (unsigned short const   )43106,      (unsigned short const   )39673,      (unsigned short const   )35696, 
        (unsigned short const   )33800,      (unsigned short const   )38273,      (unsigned short const   )42778,      (unsigned short const   )46739, 
        (unsigned short const   )49708,      (unsigned short const   )54181,      (unsigned short const   )57662,      (unsigned short const   )61623, 
        (unsigned short const   )2112,      (unsigned short const   )6601,      (unsigned short const   )11090,      (unsigned short const   )15067, 
        (unsigned short const   )20068,      (unsigned short const   )24557,      (unsigned short const   )28022,      (unsigned short const   )31999, 
        (unsigned short const   )38025,      (unsigned short const   )34048,      (unsigned short const   )47003,      (unsigned short const   )42514, 
        (unsigned short const   )53933,      (unsigned short const   )49956,      (unsigned short const   )61887,      (unsigned short const   )57398, 
        (unsigned short const   )6337,      (unsigned short const   )2376,      (unsigned short const   )15315,      (unsigned short const   )10842, 
        (unsigned short const   )24293,      (unsigned short const   )20332,      (unsigned short const   )32247,      (unsigned short const   )27774, 
        (unsigned short const   )42250,      (unsigned short const   )46211,      (unsigned short const   )34328,      (unsigned short const   )38801, 
        (unsigned short const   )58158,      (unsigned short const   )62119,      (unsigned short const   )49212,      (unsigned short const   )53685, 
        (unsigned short const   )10562,      (unsigned short const   )14539,      (unsigned short const   )2640,      (unsigned short const   )7129, 
        (unsigned short const   )28518,      (unsigned short const   )32495,      (unsigned short const   )19572,      (unsigned short const   )24061, 
        (unsigned short const   )46475,      (unsigned short const   )41986,      (unsigned short const   )38553,      (unsigned short const   )34576, 
        (unsigned short const   )62383,      (unsigned short const   )57894,      (unsigned short const   )53437,      (unsigned short const   )49460, 
        (unsigned short const   )14787,      (unsigned short const   )10314,      (unsigned short const   )6865,      (unsigned short const   )2904, 
        (unsigned short const   )32743,      (unsigned short const   )28270,      (unsigned short const   )23797,      (unsigned short const   )19836, 
        (unsigned short const   )50700,      (unsigned short const   )55173,      (unsigned short const   )58654,      (unsigned short const   )62615, 
        (unsigned short const   )32808,      (unsigned short const   )37281,      (unsigned short const   )41786,      (unsigned short const   )45747, 
        (unsigned short const   )19012,      (unsigned short const   )23501,      (unsigned short const   )26966,      (unsigned short const   )30943, 
        (unsigned short const   )3168,      (unsigned short const   )7657,      (unsigned short const   )12146,      (unsigned short const   )16123, 
        (unsigned short const   )54925,      (unsigned short const   )50948,      (unsigned short const   )62879,      (unsigned short const   )58390, 
        (unsigned short const   )37033,      (unsigned short const   )33056,      (unsigned short const   )46011,      (unsigned short const   )41522, 
        (unsigned short const   )23237,      (unsigned short const   )19276,      (unsigned short const   )31191,      (unsigned short const   )26718, 
        (unsigned short const   )7393,      (unsigned short const   )3432,      (unsigned short const   )16371,      (unsigned short const   )11898, 
        (unsigned short const   )59150,      (unsigned short const   )63111,      (unsigned short const   )50204,      (unsigned short const   )54677, 
        (unsigned short const   )41258,      (unsigned short const   )45219,      (unsigned short const   )33336,      (unsigned short const   )37809, 
        (unsigned short const   )27462,      (unsigned short const   )31439,      (unsigned short const   )18516,      (unsigned short const   )23005, 
        (unsigned short const   )11618,      (unsigned short const   )15595,      (unsigned short const   )3696,      (unsigned short const   )8185, 
        (unsigned short const   )63375,      (unsigned short const   )58886,      (unsigned short const   )54429,      (unsigned short const   )50452, 
        (unsigned short const   )45483,      (unsigned short const   )40994,      (unsigned short const   )37561,      (unsigned short const   )33584, 
        (unsigned short const   )31687,      (unsigned short const   )27214,      (unsigned short const   )22741,      (unsigned short const   )18780, 
        (unsigned short const   )15843,      (unsigned short const   )11370,      (unsigned short const   )7921,      (unsigned short const   )3960};
#line 102 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
unsigned short crc_ccitt_byte(unsigned short crc , char const   c ) 
{ 


  {
#line 104
  return ((unsigned short )(((int )crc >> 8) ^ (int )crc_ccitt_table[((int )crc ^ (int )c) & 255]));
}
}
#line 113 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
unsigned short crc_ccitt(short crc , char const   *buffer , size_t len ) 
{ 
  char const   *tmp ;
  unsigned short tmp___0 ;
  size_t tmp___1 ;

  {
  {
#line 115
  while (1) {
    while_continue: /* CIL Label */ ;
#line 115
    tmp___1 = len;
#line 115
    len --;
#line 115
    if (! tmp___1) {
#line 115
      goto while_break;
    }
    {
#line 116
    tmp = buffer;
#line 116
    buffer ++;
#line 116
    tmp___0 = crc_ccitt_byte((unsigned short )crc, *tmp);
#line 116
    crc = (short )tmp___0;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 117
  return ((unsigned short )crc);
}
}
#line 120 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
void usage(char **argv ) 
{ 


  {
  {
#line 121
  printf((char const   */* __restrict  */)"usage: %s [-2000] serial_device firmware_dir\n",
         *(argv + 0));
  }
#line 122
  return;
}
}
#line 124 "/home/june/repo/benchmarks/collector/temp/gobi-loader-0.7/gobi_loader.c"
int main(int argc , char **argv ) 
{ 
  int serialfd ;
  int fwfd ;
  int len ;
  int err ;
  int gobi2000 ;
  struct termios terminal_data ;
  struct stat file_data ;
  char *fwdata ;
  void *tmp ;
  int tmp___0 ;
  unsigned short tmp___1 ;
  unsigned short tmp___2 ;
  unsigned short tmp___3 ;
  ssize_t tmp___4 ;
  unsigned short tmp___5 ;
  unsigned short tmp___6 ;
  ssize_t tmp___7 ;
  unsigned short tmp___8 ;
  unsigned short tmp___9 ;
  ssize_t tmp___10 ;
  unsigned short tmp___11 ;

  {
  {
#line 129
  gobi2000 = 0;
#line 132
  tmp = malloc((size_t )1048576);
#line 132
  fwdata = (char *)tmp;
  }
#line 134
  if (argc < 3) {
    {
#line 135
    usage(argv);
    }
#line 136
    return (-1);
  } else
#line 134
  if (argc > 4) {
    {
#line 135
    usage(argv);
    }
#line 136
    return (-1);
  }
#line 139
  if (! fwdata) {
    {
#line 140
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Failed to allocate memory for firmware\n");
    }
#line 141
    return (-1);
  }
#line 144
  if (argc == 4) {
    {
#line 145
    tmp___0 = strcmp((char const   *)*(argv + 1), "-2000");
    }
#line 145
    if (tmp___0) {
      {
#line 150
      usage(argv);
      }
    } else {
#line 146
      gobi2000 = 1;
#line 147
      magic1[33] = (char )((int )magic1[33] + 1);
#line 148
      magic1[34] = (char )((int )magic1[34] + 1);
    }
  }
  {
#line 154
  serialfd = open((char const   *)*(argv + (argc - 2)), 2);
  }
#line 156
  if (serialfd == -1) {
    {
#line 157
    perror("Failed to open serial device: ");
#line 158
    usage(argv);
    }
#line 159
    return (-1);
  }
  {
#line 162
  err = chdir((char const   *)*(argv + (argc - 1)));
  }
#line 163
  if (err) {
    {
#line 164
    perror("Failed to change directory: ");
#line 165
    usage(argv);
    }
#line 166
    return (-1);
  }
  {
#line 169
  fwfd = open("amss.mbn", 0);
  }
#line 171
  if (fwfd == -1) {
    {
#line 172
    perror("Failed to open firmware: ");
#line 173
    usage(argv);
    }
#line 174
    return (-1);
  }
  {
#line 177
  fstat(fwfd, & file_data);
#line 178
  *((int *)(& magic2[2])) = (int )(file_data.st_size - 8L);
#line 179
  *((int *)(& magic3[7])) = (int )(file_data.st_size - 8L);
#line 180
  tmp___1 = crc_ccitt((short)-1, (char const   *)(magic1), sizeof(magic1) - 2UL);
#line 180
  *((short *)(& magic1[sizeof(magic1) - 2UL])) = (short )(~ ((int )tmp___1));
#line 182
  tmp___2 = crc_ccitt((short)-1, (char const   *)(magic2), sizeof(magic2) - 2UL);
#line 182
  *((short *)(& magic2[sizeof(magic2) - 2UL])) = (short )(~ ((int )tmp___2));
#line 184
  tmp___3 = crc_ccitt((short)-1, (char const   *)(magic3), sizeof(magic3) - 2UL);
#line 184
  *((short *)(& magic3[sizeof(magic3) - 2UL])) = (short )(~ ((int )tmp___3));
#line 187
  tcgetattr(serialfd, & terminal_data);
#line 188
  cfmakeraw(& terminal_data);
#line 189
  tcsetattr(serialfd, 0, (struct termios  const  *)(& terminal_data));
#line 191
  write(serialfd, (void const   *)"~", (size_t )1);
#line 192
  write(serialfd, (void const   *)(magic1), sizeof(magic1));
#line 193
  write(serialfd, (void const   *)"~", (size_t )1);
#line 195
  write(serialfd, (void const   *)"~", (size_t )1);
#line 196
  write(serialfd, (void const   *)(magic2), sizeof(magic2));
#line 197
  write(serialfd, (void const   *)"~", (size_t )1);
#line 199
  write(serialfd, (void const   *)(magic3), sizeof(magic3));
  }
  {
#line 201
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 202
    tmp___4 = read(fwfd, (void *)fwdata, (size_t )1048576);
#line 202
    len = (int )tmp___4;
    }
#line 203
    if (len == 1048576) {
      {
#line 204
      write(serialfd, (void const   *)fwdata, (size_t )1048576);
      }
    } else {
      {
#line 206
      write(serialfd, (void const   *)fwdata, (size_t )(len - 8));
      }
#line 207
      goto while_break;
    }
    {
#line 209
    write(serialfd, (void const   *)fwdata, (size_t )0);
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 212
  fwfd = open("apps.mbn", 0);
  }
#line 214
  if (fwfd == -1) {
    {
#line 215
    perror("Failed to open secondary firmware: ");
#line 216
    usage(argv);
    }
#line 217
    return (-1);
  }
  {
#line 220
  fstat(fwfd, & file_data);
#line 221
  *((int *)(& magic4[2])) = (int )file_data.st_size;
#line 222
  *((int *)(& magic5[7])) = (int )file_data.st_size;
#line 224
  tmp___5 = crc_ccitt((short)-1, (char const   *)(magic4), sizeof(magic4) - 2UL);
#line 224
  *((short *)(& magic4[sizeof(magic4) - 2UL])) = (short )(~ ((int )tmp___5));
#line 226
  tmp___6 = crc_ccitt((short)-1, (char const   *)(magic5), sizeof(magic5) - 2UL);
#line 226
  *((short *)(& magic5[sizeof(magic5) - 2UL])) = (short )(~ ((int )tmp___6));
#line 229
  write(serialfd, (void const   *)"~", (size_t )1);
#line 230
  write(serialfd, (void const   *)(magic4), sizeof(magic4));
#line 231
  write(serialfd, (void const   *)"~", (size_t )1);
#line 233
  write(serialfd, (void const   *)(magic5), sizeof(magic5));
  }
  {
#line 235
  while (1) {
    while_continue___0: /* CIL Label */ ;
    {
#line 236
    tmp___7 = read(fwfd, (void *)fwdata, (size_t )1048576);
#line 236
    len = (int )tmp___7;
    }
#line 237
    if (len == 1048576) {
      {
#line 238
      write(serialfd, (void const   *)fwdata, (size_t )1048576);
      }
    } else {
      {
#line 240
      write(serialfd, (void const   *)fwdata, (size_t )len);
      }
#line 241
      goto while_break___0;
    }
    {
#line 243
    write(serialfd, (void const   *)fwdata, (size_t )0);
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 246
  if (gobi2000) {
    {
#line 247
    fwfd = open("UQCN.mbn", 0);
    }
#line 249
    if (fwfd == -1) {
      {
#line 250
      fwfd = open("uqcn.mbn", 0);
      }
    }
#line 252
    if (fwfd == -1) {
      {
#line 253
      perror("Failed to open tertiary firmware: ");
#line 254
      usage(argv);
      }
#line 255
      return (-1);
    }
    {
#line 258
    fstat(fwfd, & file_data);
#line 259
    *((int *)(& magic6[2])) = (int )file_data.st_size;
#line 260
    *((int *)(& magic7[7])) = (int )file_data.st_size;
#line 262
    tmp___8 = crc_ccitt((short)-1, (char const   *)(magic6), sizeof(magic6) - 2UL);
#line 262
    *((short *)(& magic6[sizeof(magic6) - 2UL])) = (short )(~ ((int )tmp___8));
#line 264
    tmp___9 = crc_ccitt((short)-1, (char const   *)(magic7), sizeof(magic7) - 2UL);
#line 264
    *((short *)(& magic7[sizeof(magic7) - 2UL])) = (short )(~ ((int )tmp___9));
#line 267
    write(serialfd, (void const   *)"~", (size_t )1);
#line 268
    write(serialfd, (void const   *)(magic6), sizeof(magic6));
#line 269
    write(serialfd, (void const   *)"~", (size_t )1);
#line 271
    write(serialfd, (void const   *)(magic7), sizeof(magic7));
    }
    {
#line 273
    while (1) {
      while_continue___1: /* CIL Label */ ;
      {
#line 274
      tmp___10 = read(fwfd, (void *)fwdata, (size_t )1048576);
#line 274
      len = (int )tmp___10;
      }
#line 275
      if (len == 1048576) {
        {
#line 276
        write(serialfd, (void const   *)fwdata, (size_t )1048576);
        }
      } else {
        {
#line 278
        write(serialfd, (void const   *)fwdata, (size_t )len);
        }
#line 279
        goto while_break___1;
      }
      {
#line 281
      write(serialfd, (void const   *)fwdata, (size_t )0);
      }
    }
    while_break___1: /* CIL Label */ ;
    }
  }
  {
#line 285
  tmp___11 = crc_ccitt((short)-1, (char const   *)(magic8), sizeof(magic8) - 2UL);
#line 285
  *((short *)(& magic8[sizeof(magic8) - 2UL])) = (short )(~ ((int )tmp___11));
#line 288
  write(serialfd, (void const   *)"~", (size_t )1);
#line 289
  write(serialfd, (void const   *)(magic8), sizeof(magic8));
#line 290
  write(serialfd, (void const   *)"~", (size_t )1);
  }
#line 292
  return (0);
}
}
