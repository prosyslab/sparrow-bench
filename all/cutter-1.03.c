/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned char __u_char;
#line 31 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned short __u_short;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 141 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __suseconds_t;
#line 172 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 183 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef char *__caddr_t;
#line 189 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __socklen_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 102 "/usr/include/stdio.h"
typedef __ssize_t ssize_t;
#line 274 "/usr/include/unistd.h"
typedef __socklen_t socklen_t;
#line 33 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_char u_char;
#line 34 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_short u_short;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 54 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef long __fd_mask;
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
struct __anonstruct_fd_set_17 {
   __fd_mask __fds_bits[1024 / (8 * (int )sizeof(__fd_mask ))] ;
};
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef struct __anonstruct_fd_set_17 fd_set;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 149 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 117 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 237 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 20 "/usr/include/asm-generic/int-ll64.h"
typedef unsigned char __u8;
#line 23 "/usr/include/asm-generic/int-ll64.h"
typedef unsigned short __u16;
#line 26 "/usr/include/asm-generic/int-ll64.h"
typedef unsigned int __u32;
#line 28 "/usr/include/linux/types.h"
typedef __u16 __be16;
#line 30 "/usr/include/linux/types.h"
typedef __u32 __be32;
#line 34 "/usr/include/linux/types.h"
typedef __u16 __sum16;
#line 85 "/usr/include/linux/ip.h"
struct iphdr {
   __u8 ihl : 4 ;
   __u8 version : 4 ;
   __u8 tos ;
   __be16 tot_len ;
   __be16 id ;
   __be16 frag_off ;
   __u8 ttl ;
   __u8 protocol ;
   __sum16 check ;
   __be32 saddr ;
   __be32 daddr ;
};
#line 24 "/usr/include/linux/tcp.h"
struct tcphdr {
   __be16 source ;
   __be16 dest ;
   __be32 seq ;
   __be32 ack_seq ;
   __u16 res1 : 4 ;
   __u16 doff : 4 ;
   __u16 fin : 1 ;
   __u16 syn : 1 ;
   __u16 rst : 1 ;
   __u16 psh : 1 ;
   __u16 ack : 1 ;
   __u16 urg : 1 ;
   __u16 ece : 1 ;
   __u16 cwr : 1 ;
   __be16 window ;
   __sum16 check ;
   __be16 urg_ptr ;
};
#line 22 "/usr/include/netpacket/packet.h"
struct sockaddr_ll {
   unsigned short sll_family ;
   unsigned short sll_protocol ;
   int sll_ifindex ;
   unsigned short sll_hatype ;
   unsigned char sll_pkttype ;
   unsigned char sll_halen ;
   unsigned char sll_addr[8] ;
};
#line 111 "/usr/include/net/if.h"
struct ifmap {
   unsigned long mem_start ;
   unsigned long mem_end ;
   unsigned short base_addr ;
   unsigned char irq ;
   unsigned char dma ;
   unsigned char port ;
};
#line 126 "/usr/include/net/if.h"
union __anonunion_ifr_ifrn_42 {
   char ifrn_name[16] ;
};
#line 126 "/usr/include/net/if.h"
union __anonunion_ifr_ifru_43 {
   struct sockaddr ifru_addr ;
   struct sockaddr ifru_dstaddr ;
   struct sockaddr ifru_broadaddr ;
   struct sockaddr ifru_netmask ;
   struct sockaddr ifru_hwaddr ;
   short ifru_flags ;
   int ifru_ivalue ;
   int ifru_mtu ;
   struct ifmap ifru_map ;
   char ifru_slave[16] ;
   char ifru_newname[16] ;
   __caddr_t ifru_data ;
};
#line 126 "/usr/include/net/if.h"
struct ifreq {
   union __anonunion_ifr_ifrn_42 ifr_ifrn ;
   union __anonunion_ifr_ifru_43 ifr_ifru ;
};
#line 176 "/usr/include/net/if.h"
union __anonunion_ifc_ifcu_44 {
   __caddr_t ifcu_buf ;
   struct ifreq *ifcu_req ;
};
#line 176 "/usr/include/net/if.h"
struct ifconf {
   int ifc_len ;
   union __anonunion_ifc_ifcu_44 ifc_ifcu ;
};
#line 73 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
typedef unsigned char uchar;
#line 77 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
struct rpack {
   struct iphdr ip ;
   struct tcphdr tcp ;
   char space[8192] ;
};
#line 83 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
struct tpack {
   struct iphdr ip ;
   struct tcphdr tcp ;
};
#line 88 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
struct pseudo_header {
   unsigned int source_address ;
   unsigned int dest_address ;
   unsigned char placeholder ;
   unsigned char protocol ;
   unsigned short tcp_length ;
   struct tcphdr tcp ;
};
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 69
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) memcmp)(void const   *__s1 ,
                                                                                               void const   *__s2 ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 132
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strncpy)(char * __restrict  __dest ,
                                                                                                  char const   * __restrict  __src ,
                                                                                                  size_t __n ) ;
#line 342
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strstr)(char const   *__haystack ,
                                                                                                 char const   *__needle )  __attribute__((__pure__)) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 455
extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1,2), __leaf__)) bcopy)(void const   *__src ,
                                                                                               void *__dest ,
                                                                                               size_t __n ) ;
#line 170 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 237
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 433
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) sscanf)(char const   * __restrict  __s ,
                                                                             char const   * __restrict  __format 
                                                                             , ...)  __asm__("__isoc99_sscanf")  ;
#line 622
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
#line 846
extern void perror(char const   *__s ) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 147 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 106 "/usr/include/x86_64-linux-gnu/sys/select.h"
extern int select(int __nfds , fd_set * __restrict  __readfds , fd_set * __restrict  __writefds ,
                  fd_set * __restrict  __exceptfds , struct timeval * __restrict  __timeout ) ;
#line 543 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 113 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) socket)(int __domain ,
                                                                             int __type ,
                                                                             int __protocol ) ;
#line 123
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) bind)(int __fd ,
                                                                           struct sockaddr  const  *__addr ,
                                                                           socklen_t __len ) ;
#line 163
extern ssize_t sendto(int __fd , void const   *__buf , size_t __n , int __flags ,
                      struct sockaddr  const  *__addr , socklen_t __addr_len ) ;
#line 174
extern ssize_t recvfrom(int __fd , void * __restrict  __buf , size_t __n , int __flags ,
                        struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 379 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint16_t ( __attribute__((__leaf__)) htons)(uint16_t __hostshort )  __attribute__((__const__)) ;
#line 34 "/usr/include/arpa/inet.h"
extern  __attribute__((__nothrow__)) in_addr_t ( __attribute__((__leaf__)) inet_addr)(char const   *__cp ) ;
#line 41 "/usr/include/x86_64-linux-gnu/sys/ioctl.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) ioctl)(int __fd ,
                                                                            unsigned long __request 
                                                                            , ...) ;
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 97 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
struct ifreq ifreq[32]  ;
#line 98 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
struct ifconf ifconf  ;
#line 106 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int getnexthop(in_addr_t ip , char *intf , in_addr_t *gateway ) 
{ 
  FILE *id ;
  FILE *tmp ;
  char buff[500] ;
  char iface[32] ;
  in_addr_t dest_ip ;
  in_addr_t gateway_ip ;
  in_addr_t mask ;
  int flags ;
  int refcnt ;
  int use ;
  int metric ;
  int mtu ;
  int window ;
  int irtt ;
  int tmp___0 ;
  char *tmp___1 ;

  {
  {
#line 108
  tmp = fopen((char const   */* __restrict  */)"/proc/net/route", (char const   */* __restrict  */)"r");
#line 108
  id = tmp;
  }
#line 114
  if ((unsigned long )id == (unsigned long )((void *)0)) {
#line 114
    return (0);
  }
  {
#line 116
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 116
    tmp___1 = fgets((char */* __restrict  */)(buff), (int )sizeof(buff), (FILE */* __restrict  */)id);
    }
#line 116
    if (! ((unsigned long )tmp___1 != (unsigned long )((void *)0))) {
#line 116
      goto while_break;
    }
    {
#line 118
    memset((void *)(iface), 0, sizeof(iface));
#line 119
    irtt = -1;
#line 119
    window = irtt;
#line 119
    mtu = window;
#line 119
    mask = (in_addr_t )mtu;
#line 119
    metric = (int )mask;
#line 119
    use = metric;
#line 119
    refcnt = use;
#line 119
    flags = refcnt;
#line 119
    gateway_ip = (in_addr_t )flags;
#line 119
    dest_ip = gateway_ip;
#line 122
    tmp___0 = sscanf((char const   */* __restrict  */)(buff), (char const   */* __restrict  */)"%s %8lx %8lx %4x %d %d %d %8lx %d %d %d",
                     iface, & dest_ip, & gateway_ip, & flags, & refcnt, & use, & metric,
                     & mask, & mtu, & window, & irtt);
    }
#line 122
    if (tmp___0 == 11) {
#line 126
      dest_ip = dest_ip;
#line 127
      gateway_ip = gateway_ip;
#line 128
      mask = mask;
#line 129
      if ((int )iface[0] != 42) {
#line 129
        if (flags & 1) {
#line 129
          if ((flags & 512) == 0) {
#line 129
            if ((ip & mask) == dest_ip) {
              {
#line 135
              strcpy((char */* __restrict  */)intf, (char const   */* __restrict  */)(iface));
#line 136
              *gateway = gateway_ip;
#line 137
              fclose(id);
              }
#line 138
              return (1);
            }
          }
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 142
  fclose(id);
  }
#line 143
  return (0);
}
}
#line 150 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int getmac(in_addr_t ip , uchar *mac ) 
{ 
  FILE *id ;
  FILE *tmp ;
  in_addr_t ipn ;
  int mac0 ;
  int mac1 ;
  int mac2 ;
  int mac3 ;
  int mac4 ;
  int mac5 ;
  int hwtype ;
  int flags ;
  char dev[32] ;
  char mask[32] ;
  char arpip[32] ;
  char buff[200] ;
  int tmp___0 ;
  char *tmp___1 ;

  {
  {
#line 152
  tmp = fopen((char const   */* __restrict  */)"/proc/net/arp", (char const   */* __restrict  */)"r");
#line 152
  id = tmp;
  }
#line 159
  if ((unsigned long )id == (unsigned long )((void *)0)) {
#line 159
    return (0);
  }
  {
#line 160
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 160
    tmp___1 = fgets((char */* __restrict  */)(buff), (int )sizeof(buff), (FILE */* __restrict  */)id);
    }
#line 160
    if (! ((unsigned long )tmp___1 != (unsigned long )((void *)0))) {
#line 160
      goto while_break;
    }
    {
#line 161
    tmp___0 = sscanf((char const   */* __restrict  */)(buff), (char const   */* __restrict  */)"%s 0x%x 0x%x %x:%x:%x:%x:%x:%x %s %s",
                     arpip, & hwtype, & flags, & mac0, & mac1, & mac2, & mac3, & mac4,
                     & mac5, mask, dev);
    }
#line 161
    if (tmp___0 == 11) {
      {
#line 167
      ipn = inet_addr((char const   *)(arpip));
      }
#line 168
      if (ipn == ip) {
        {
#line 169
        *(mac + 0) = (uchar )mac0;
#line 169
        *(mac + 1) = (uchar )mac1;
#line 169
        *(mac + 2) = (uchar )mac2;
#line 170
        *(mac + 3) = (uchar )mac3;
#line 170
        *(mac + 4) = (uchar )mac4;
#line 170
        *(mac + 5) = (uchar )mac5;
#line 171
        fclose(id);
        }
#line 172
        return (1);
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 176
  fclose(id);
  }
#line 177
  return (0);
}
}
#line 180 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
unsigned short in_cksum(unsigned short *ptr , int nbytes ) 
{ 
  register long sum ;
  u_short oddbyte ;
  register u_short answer ;
  unsigned short *tmp ;

  {
#line 186
  sum = 0L;
  {
#line 187
  while (1) {
    while_continue: /* CIL Label */ ;
#line 187
    if (! (nbytes > 1)) {
#line 187
      goto while_break;
    }
#line 188
    tmp = ptr;
#line 188
    ptr ++;
#line 188
    sum += (long )*tmp;
#line 189
    nbytes -= 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 192
  if (nbytes == 1) {
#line 193
    oddbyte = (u_short )0;
#line 194
    *((u_char *)(& oddbyte)) = *((u_char *)ptr);
#line 195
    sum += (long )oddbyte;
  }
#line 198
  sum = (sum >> 16) + (sum & 65535L);
#line 199
  sum += sum >> 16;
#line 200
  answer = (u_short )(~ sum);
#line 201
  return (answer);
}
}
#line 204 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int getifconfig(void) 
{ 
  int rtn ;
  int raw_sock ;
  uint16_t tmp ;

  {
  {
#line 209
  tmp = htons((uint16_t )2048);
#line 209
  raw_sock = socket(17, 2, (int )tmp);
  }
#line 209
  if (raw_sock == -1) {
    {
#line 210
    perror("open packet socket");
    }
#line 211
    return (0);
  }
  {
#line 213
  memset((void *)(ifreq), 0, sizeof(ifreq));
#line 214
  ifconf.ifc_len = (int )sizeof(ifreq);
#line 215
  ifconf.ifc_ifcu.ifcu_req = ifreq;
#line 217
  rtn = ioctl(raw_sock, 35090UL, & ifconf);
#line 219
  close(raw_sock);
  }
#line 220
  return (1);
}
}
#line 223 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int localip(in_addr_t ip ) 
{ 
  int i ;
  struct sockaddr_in *sa ;

  {
#line 228
  i = 0;
  {
#line 228
  while (1) {
    while_continue: /* CIL Label */ ;
#line 228
    if (! ((unsigned long )i < (unsigned long )ifconf.ifc_len / sizeof(struct ifreq ))) {
#line 228
      goto while_break;
    }
#line 229
    sa = (struct sockaddr_in *)(& ifreq[i].ifr_ifru.ifru_addr);
#line 230
    if (sa->sin_addr.s_addr == ip) {
#line 231
      return (1);
    }
#line 228
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 233
  return (0);
}
}
#line 236 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int send_rst(char *from_ip_str , u_short fromport , char *to_ip_str , u_short toport ) 
{ 
  int i_result ;
  int raw_sock ;
  in_addr_t gateway_ip ;
  struct sockaddr_ll myaddr ;
  struct sockaddr_ll hisaddr ;
  struct tpack tpack ;
  struct rpack rpack ;
  struct pseudo_header pheader ;
  struct ifreq ifr ;
  int ifindex ;
  unsigned char mac[6] ;
  char interf[80] ;
  int from_ip ;
  in_addr_t tmp ;
  int to_ip ;
  in_addr_t tmp___0 ;
  time_t tstart ;
  uint16_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  in_addr_t tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  ssize_t tmp___8 ;
  struct sockaddr_ll gotaddr ;
  unsigned int addrlen ;
  fd_set readfds ;
  struct timeval tv ;
  int __d0 ;
  int __d1 ;
  int tmp___9 ;
  ssize_t tmp___10 ;
  ssize_t tmp___11 ;
  time_t tmp___12 ;

  {
  {
#line 253
  tmp = inet_addr((char const   *)from_ip_str);
#line 253
  from_ip = (int )tmp;
#line 254
  tmp___0 = inet_addr((char const   *)to_ip_str);
#line 254
  to_ip = (int )tmp___0;
#line 257
  printf((char const   */* __restrict  */)"\tsending RST from %s:%d to %s:%d\n", from_ip_str,
         (int )fromport, to_ip_str, (int )toport);
#line 259
  memset((void *)(& tpack), 0, sizeof(tpack));
#line 262
  tpack.tcp.source = htons(fromport);
#line 263
  tpack.tcp.dest = htons(toport);
#line 264
  tpack.tcp.seq = (__be32 )0;
#line 265
  tpack.tcp.ack_seq = (__be32 )0;
#line 266
  tpack.tcp.doff = (__u16 )5;
#line 267
  tpack.tcp.res1 = (__u16 )0;
#line 268
  tpack.tcp.urg = (__u16 )0;
#line 269
  tpack.tcp.ack = (__u16 )0;
#line 270
  tpack.tcp.psh = (__u16 )0;
#line 271
  tpack.tcp.rst = (__u16 )0;
#line 272
  tpack.tcp.syn = (__u16 )0;
#line 273
  tpack.tcp.fin = (__u16 )1;
#line 274
  tpack.tcp.window = (__be16 )0;
#line 275
  tpack.tcp.check = (__sum16 )0;
#line 276
  tpack.tcp.urg_ptr = (__be16 )0;
#line 279
  tpack.ip.version = (__u8 )4;
#line 280
  tpack.ip.ihl = (__u8 )5;
#line 281
  tpack.ip.tos = (__u8 )16;
#line 282
  tpack.ip.tot_len = htons((uint16_t )(sizeof(struct iphdr ) + sizeof(struct tcphdr )));
#line 283
  tpack.ip.id = (__be16 )0;
#line 284
  tpack.ip.frag_off = htons((uint16_t )16384);
#line 285
  tpack.ip.ttl = (__u8 )255;
#line 286
  tpack.ip.protocol = (__u8 )6;
#line 287
  tpack.ip.check = (__sum16 )0;
#line 288
  tpack.ip.saddr = (__be32 )from_ip;
#line 289
  tpack.ip.daddr = (__be32 )to_ip;
#line 292
  tpack.ip.check = in_cksum((unsigned short *)(& tpack.ip), (int )sizeof(struct iphdr ));
#line 295
  pheader.source_address = tpack.ip.saddr;
#line 296
  pheader.dest_address = tpack.ip.daddr;
#line 297
  pheader.placeholder = (unsigned char)0;
#line 298
  pheader.protocol = (unsigned char)6;
#line 299
  pheader.tcp_length = htons((uint16_t )sizeof(struct tcphdr ));
#line 300
  bcopy((void const   *)((char *)(& tpack.tcp)), (void *)((char *)(& pheader.tcp)),
        sizeof(struct tcphdr ));
#line 301
  tpack.tcp.check = in_cksum((unsigned short *)(& pheader), (int )(sizeof(struct tcphdr ) + 12UL));
#line 307
  tmp___1 = htons((uint16_t )2048);
#line 307
  raw_sock = socket(17, 2, (int )tmp___1);
  }
#line 307
  if (raw_sock == -1) {
    {
#line 308
    perror("open packet socket");
    }
#line 309
    return (0);
  }
  {
#line 312
  tmp___2 = getnexthop((in_addr_t )to_ip, interf, & gateway_ip);
  }
#line 312
  if (! tmp___2) {
    {
#line 313
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Cant find next hop gateway in routing table\n");
#line 314
    close(raw_sock);
    }
#line 315
    return (0);
  }
  {
#line 323
  memset((void *)(& ifr), 0, sizeof(ifr));
#line 324
  strncpy((char */* __restrict  */)(ifr.ifr_ifrn.ifrn_name), (char const   */* __restrict  */)(interf),
          sizeof(ifr.ifr_ifrn.ifrn_name));
#line 325
  tmp___3 = ioctl(raw_sock, 35123UL, & ifr);
  }
#line 325
  if (tmp___3 == -1) {
    {
#line 326
    perror("ioctl - get ifindex");
#line 327
    close(raw_sock);
    }
#line 328
    return (0);
  }
#line 330
  ifindex = ifr.ifr_ifru.ifru_ivalue;
#line 332
  if (gateway_ip == 0U) {
#line 332
    tmp___5 = (in_addr_t )to_ip;
  } else {
#line 332
    tmp___5 = gateway_ip;
  }
  {
#line 332
  tmp___6 = getmac(tmp___5, mac);
  }
#line 332
  if (! tmp___6) {
    {
#line 333
    memset((void *)(& ifr), 0, sizeof(ifr));
#line 334
    strncpy((char */* __restrict  */)(ifr.ifr_ifrn.ifrn_name), (char const   */* __restrict  */)(interf),
            sizeof(ifr.ifr_ifrn.ifrn_name));
#line 335
    tmp___4 = ioctl(raw_sock, 35111UL, & ifr);
    }
#line 335
    if (tmp___4 == -1) {
      {
#line 336
      perror("ioctl - get hwaddr");
#line 337
      close(raw_sock);
      }
#line 338
      return (0);
    }
    {
#line 340
    memcpy((void */* __restrict  */)(mac), (void const   */* __restrict  */)(ifr.ifr_ifru.ifru_hwaddr.sa_data),
           (size_t )6);
    }
  }
  {
#line 348
  memset((void *)(& myaddr), 0, sizeof(myaddr));
#line 349
  myaddr.sll_family = (unsigned short)17;
#line 350
  myaddr.sll_ifindex = ifindex;
#line 351
  tmp___7 = bind(raw_sock, (struct sockaddr  const  *)((struct sockaddr *)(& myaddr)),
                 (socklen_t )sizeof(myaddr));
  }
#line 351
  if (tmp___7 != 0) {
    {
#line 352
    perror("bind");
#line 353
    close(raw_sock);
    }
#line 354
    return (0);
  }
  {
#line 357
  memset((void *)(& hisaddr), 0, sizeof(hisaddr));
#line 358
  hisaddr.sll_family = (unsigned short)17;
#line 359
  hisaddr.sll_protocol = htons((uint16_t )2048);
#line 360
  hisaddr.sll_ifindex = ifindex;
#line 361
  hisaddr.sll_halen = (unsigned char)6;
#line 362
  memcpy((void */* __restrict  */)(hisaddr.sll_addr), (void const   */* __restrict  */)(mac),
         (size_t )6);
#line 366
  tmp___8 = sendto(raw_sock, (void const   *)(& tpack), sizeof(struct tcphdr ) + sizeof(struct iphdr ),
                   0, (struct sockaddr  const  *)((void *)(& hisaddr)), (socklen_t )sizeof(hisaddr));
#line 366
  i_result = (int )tmp___8;
  }
#line 367
  if ((unsigned long )i_result != sizeof(struct tcphdr ) + sizeof(struct iphdr )) {
    {
#line 368
    perror("sendto - fin packet");
#line 369
    close(raw_sock);
    }
#line 370
    return (0);
  }
  {
#line 376
  tstart = time((time_t *)0);
  }
  {
#line 378
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 378
    tmp___12 = time((time_t *)0);
    }
#line 378
    if (! (tmp___12 < tstart + 15L)) {
#line 378
      goto while_break;
    }
#line 380
    addrlen = (unsigned int )sizeof(gotaddr);
    {
#line 384
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 384
      __asm__  volatile   ("cld; rep; "
                           "stosq": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                           "1" (& readfds.__fds_bits[0]): "memory");
#line 384
      goto while_break___0;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 385
    readfds.__fds_bits[raw_sock / (8 * (int )sizeof(__fd_mask ))] |= 1L << raw_sock % (8 * (int )sizeof(__fd_mask ));
#line 387
    tv.tv_sec = (__time_t )1;
#line 388
    tv.tv_usec = (__suseconds_t )0;
#line 390
    tmp___9 = select(raw_sock + 1, (fd_set */* __restrict  */)(& readfds), (fd_set */* __restrict  */)((void *)0),
                     (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& tv));
    }
#line 390
    if (tmp___9 == 0) {
#line 391
      goto __Cont;
    }
    {
#line 393
    memcpy((void */* __restrict  */)(& gotaddr), (void const   */* __restrict  */)(& hisaddr),
           (size_t )addrlen);
#line 394
    memset((void *)(& rpack), 0, sizeof(rpack));
#line 395
    tmp___10 = recvfrom(raw_sock, (void */* __restrict  */)(& rpack), sizeof(rpack),
                        0, (struct sockaddr */* __restrict  */)((void *)(& gotaddr)),
                        (socklen_t */* __restrict  */)(& addrlen));
#line 395
    i_result = (int )tmp___10;
    }
#line 396
    if (i_result < 16) {
      {
#line 397
      perror("recvfrom - waiting for SYN");
#line 398
      close(raw_sock);
      }
#line 399
      return (0);
    }
#line 401
    if ((int )rpack.ip.version == 4) {
#line 401
      if ((int )rpack.ip.ihl == 5) {
#line 401
        if ((int )rpack.ip.protocol == 6) {
#line 401
          if (rpack.ip.saddr == tpack.ip.daddr) {
#line 401
            if (rpack.ip.daddr == tpack.ip.saddr) {
#line 401
              if ((int )rpack.tcp.source == (int )tpack.tcp.dest) {
#line 401
                if ((int )rpack.tcp.dest == (int )tpack.tcp.source) {
#line 401
                  if ((int )rpack.tcp.ack == 1) {
                    {
#line 411
                    tpack.tcp.seq = rpack.tcp.ack_seq;
#line 412
                    tpack.tcp.ack_seq = (__be32 )0;
#line 413
                    tpack.tcp.fin = (__u16 )0;
#line 414
                    tpack.tcp.rst = (__u16 )1;
#line 415
                    tpack.tcp.check = (__sum16 )0;
#line 417
                    pheader.source_address = tpack.ip.saddr;
#line 418
                    pheader.dest_address = tpack.ip.daddr;
#line 419
                    pheader.placeholder = (unsigned char)0;
#line 420
                    pheader.protocol = (unsigned char)6;
#line 421
                    pheader.tcp_length = htons((uint16_t )sizeof(struct tcphdr ));
#line 422
                    bcopy((void const   *)((char *)(& tpack.tcp)), (void *)((char *)(& pheader.tcp)),
                          sizeof(struct tcphdr ));
#line 423
                    tpack.tcp.check = in_cksum((unsigned short *)(& pheader), (int )(sizeof(struct tcphdr ) + 12UL));
#line 425
                    tmp___11 = sendto(raw_sock, (void const   *)(& tpack), sizeof(struct tcphdr ) + sizeof(struct iphdr ),
                                      0, (struct sockaddr  const  *)((void *)(& hisaddr)),
                                      (socklen_t )sizeof(hisaddr));
#line 425
                    i_result = (int )tmp___11;
                    }
#line 426
                    if ((unsigned long )i_result != sizeof(struct tcphdr ) + sizeof(struct iphdr )) {
                      {
#line 427
                      perror("sendto - reset packet");
#line 428
                      close(raw_sock);
                      }
#line 429
                      return (0);
                    }
                    {
#line 431
                    close(raw_sock);
                    }
#line 432
                    return (1);
                  }
                }
              }
            }
          }
        }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 435
  printf((char const   */* __restrict  */)"\t\tACK not seen so RST not sent (sorry!)\n");
#line 436
  close(raw_sock);
  }
#line 438
  return (0);
}
}
#line 441 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int match(in_addr_t match_ip , int match_port , in_addr_t found_ip , int found_port ) 
{ 


  {
#line 443
  if (match_ip == 0U) {
#line 443
    goto _L;
  } else
#line 443
  if (match_ip == found_ip) {
    _L: /* CIL Label */ 
#line 443
    if (match_port == 0) {
#line 447
      return (1);
    } else
#line 443
    if (match_port == found_port) {
#line 447
      return (1);
    } else {
#line 449
      return (0);
    }
  } else {
#line 449
    return (0);
  }
}
}
#line 452 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int get_str_field(char **p , char *key , char *out , int outlen ) 
{ 
  char *found ;
  char *tmp ;
  int i ;
  size_t tmp___0 ;

  {
  {
#line 454
  tmp = strstr((char const   *)*p, (char const   *)key);
#line 454
  found = tmp;
#line 457
  memset((void *)out, 0, (size_t )outlen);
  }
#line 458
  if ((unsigned long )found == (unsigned long )((void *)0)) {
#line 458
    return (0);
  }
  {
#line 459
  tmp___0 = strlen((char const   *)key);
#line 459
  found += tmp___0;
#line 460
  i = 0;
  }
  {
#line 460
  while (1) {
    while_continue: /* CIL Label */ ;
#line 460
    if (i < outlen - 1) {
#line 460
      if (*(found + i)) {
#line 460
        if (! ((int )*(found + i) != 32)) {
#line 460
          goto while_break;
        }
      } else {
#line 460
        goto while_break;
      }
    } else {
#line 460
      goto while_break;
    }
#line 461
    *(out + i) = *(found + i);
#line 460
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 463
  *(out + i) = (char )'\000';
#line 464
  found += i;
#line 465
  *p = found;
#line 466
  return (1);
}
}
#line 469 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int get_int_field(char **p , char *key , int *out ) 
{ 
  char buff[80] ;
  int rtn ;
  int tmp ;

  {
  {
#line 472
  tmp = get_str_field(p, key, buff, (int )sizeof(buff));
#line 472
  rtn = tmp;
#line 473
  *out = atoi((char const   *)(buff));
  }
#line 474
  return (rtn);
}
}
#line 477 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int scan_conntrack(in_addr_t ip1 , int port1 , in_addr_t ip2 , int port2 ) 
{ 
  FILE *id ;
  FILE *tmp ;
  char src1[32] ;
  char dst1[32] ;
  char src2[32] ;
  char dst2[32] ;
  int sport1 ;
  int dport1 ;
  int sport2 ;
  int dport2 ;
  in_addr_t src1n ;
  in_addr_t src2n ;
  in_addr_t dst1n ;
  in_addr_t dst2n ;
  char buff[1024] ;
  char *p ;
  int found ;
  int ok ;
  int tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  char *tmp___34 ;

  {
  {
#line 479
  tmp = fopen((char const   */* __restrict  */)"/proc/net/ip_conntrack", (char const   */* __restrict  */)"r");
#line 479
  id = tmp;
#line 484
  found = 0;
#line 485
  ok = 1;
  }
#line 487
  if ((unsigned long )id == (unsigned long )((void *)0)) {
    {
#line 488
    perror("openning /proc/net/ip_conntrack");
    }
#line 489
    return (0);
  }
  {
#line 492
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 492
    tmp___34 = fgets((char */* __restrict  */)(buff), (int )sizeof(buff), (FILE */* __restrict  */)id);
    }
#line 492
    if (! ((unsigned long )tmp___34 != (unsigned long )((void *)0))) {
#line 492
      goto while_break;
    }
    {
#line 493
    tmp___0 = memcmp((void const   *)(buff), (void const   *)"tcp ", (size_t )4);
    }
#line 493
    if (tmp___0 != 0) {
#line 494
      goto while_continue;
    } else {
      {
#line 493
      tmp___1 = strstr((char const   *)(buff), " ESTABLISHED ");
      }
#line 493
      if ((unsigned long )tmp___1 == (unsigned long )((void *)0)) {
#line 494
        goto while_continue;
      }
    }
    {
#line 496
    p = buff;
#line 498
    tmp___2 = get_str_field(& p, (char *)" src=", src1, (int )sizeof(src1));
    }
#line 498
    if (tmp___2) {
      {
#line 498
      tmp___3 = get_str_field(& p, (char *)" dst=", dst1, (int )sizeof(dst1));
      }
#line 498
      if (tmp___3) {
        {
#line 498
        tmp___4 = get_int_field(& p, (char *)" sport=", & sport1);
        }
#line 498
        if (tmp___4) {
          {
#line 498
          tmp___5 = get_int_field(& p, (char *)" dport=", & dport1);
          }
#line 498
          if (tmp___5) {
            {
#line 498
            tmp___6 = get_str_field(& p, (char *)" src=", src2, (int )sizeof(src2));
            }
#line 498
            if (tmp___6) {
              {
#line 498
              tmp___7 = get_str_field(& p, (char *)" dst=", dst2, (int )sizeof(dst2));
              }
#line 498
              if (tmp___7) {
                {
#line 498
                tmp___8 = get_int_field(& p, (char *)" sport=", & sport2);
                }
#line 498
                if (tmp___8) {
                  {
#line 498
                  tmp___9 = get_int_field(& p, (char *)" dport=", & dport2);
                  }
#line 498
                  if (! tmp___9) {
#line 507
                    goto while_continue;
                  }
                } else {
#line 507
                  goto while_continue;
                }
              } else {
#line 507
                goto while_continue;
              }
            } else {
#line 507
              goto while_continue;
            }
          } else {
#line 507
            goto while_continue;
          }
        } else {
#line 507
          goto while_continue;
        }
      } else {
#line 507
        goto while_continue;
      }
    } else {
#line 507
      goto while_continue;
    }
    {
#line 509
    src1n = inet_addr((char const   *)(src1));
#line 510
    src2n = inet_addr((char const   *)(src2));
#line 511
    dst1n = inet_addr((char const   *)(dst1));
#line 512
    dst2n = inet_addr((char const   *)(dst2));
#line 514
    tmp___26 = match(ip1, port1, src2n, sport2);
    }
#line 514
    if (tmp___26) {
      {
#line 514
      tmp___27 = match(ip2, port2, dst2n, dport2);
      }
#line 514
      if (tmp___27) {
#line 514
        goto _L___2;
      } else {
#line 514
        goto _L___5;
      }
    } else {
      _L___5: /* CIL Label */ 
      {
#line 514
      tmp___28 = match(ip1, port1, dst2n, dport2);
      }
#line 514
      if (tmp___28) {
        {
#line 514
        tmp___29 = match(ip2, port2, src2n, sport2);
        }
#line 514
        if (tmp___29) {
#line 514
          goto _L___2;
        } else {
#line 514
          goto _L___4;
        }
      } else {
        _L___4: /* CIL Label */ 
        {
#line 514
        tmp___30 = match(ip1, port1, src1n, sport1);
        }
#line 514
        if (tmp___30) {
          {
#line 514
          tmp___31 = match(ip2, port2, dst1n, dport1);
          }
#line 514
          if (tmp___31) {
#line 514
            goto _L___2;
          } else {
#line 514
            goto _L___3;
          }
        } else {
          _L___3: /* CIL Label */ 
          {
#line 514
          tmp___32 = match(ip1, port1, dst1n, dport1);
          }
#line 514
          if (tmp___32) {
            {
#line 514
            tmp___33 = match(ip2, port2, src1n, sport1);
            }
#line 514
            if (tmp___33) {
              _L___2: /* CIL Label */ 
              {
#line 524
              tmp___22 = localip(src1n);
              }
#line 524
              if (tmp___22) {
                _L___1: /* CIL Label */ 
                {
#line 533
                tmp___18 = localip(src1n);
                }
#line 533
                if (! tmp___18) {
                  {
#line 533
                  tmp___19 = localip(dst1n);
                  }
#line 533
                  if (tmp___19) {
                    {
#line 533
                    tmp___20 = localip(src2n);
                    }
#line 533
                    if (! tmp___20) {
                      {
#line 533
                      tmp___21 = localip(dst2n);
                      }
#line 533
                      if (! tmp___21) {
                        {
#line 534
                        found ++;
#line 535
                        printf((char const   */* __restrict  */)"For connection %s:%d -> %s:%d\n",
                               dst2, dport2, src2, sport2);
#line 536
                        tmp___14 = send_rst(dst1, (u_short )dport1, src1, (u_short )sport1);
                        }
#line 536
                        if (tmp___14) {
#line 536
                          if (ok) {
#line 536
                            tmp___15 = 1;
                          } else {
#line 536
                            tmp___15 = 0;
                          }
                        } else {
#line 536
                          tmp___15 = 0;
                        }
                        {
#line 536
                        ok = tmp___15;
#line 537
                        tmp___16 = send_rst(dst2, (u_short )dport2, src2, (u_short )sport2);
                        }
#line 537
                        if (tmp___16) {
#line 537
                          if (ok) {
#line 537
                            tmp___17 = 1;
                          } else {
#line 537
                            tmp___17 = 0;
                          }
                        } else {
#line 537
                          tmp___17 = 0;
                        }
#line 537
                        ok = tmp___17;
                      }
                    }
                  }
                }
              } else {
                {
#line 524
                tmp___23 = localip(dst1n);
                }
#line 524
                if (tmp___23) {
#line 524
                  goto _L___1;
                } else {
                  {
#line 524
                  tmp___24 = localip(src2n);
                  }
#line 524
                  if (tmp___24) {
#line 524
                    goto _L___1;
                  } else {
                    {
#line 524
                    tmp___25 = localip(dst2n);
                    }
#line 524
                    if (tmp___25) {
                      {
#line 525
                      found ++;
#line 526
                      printf((char const   */* __restrict  */)"For connection %s:%d -> %s:%d\n",
                             src1, sport1, dst1, dport1);
#line 527
                      tmp___10 = send_rst(dst1, (u_short )dport1, src1, (u_short )sport1);
                      }
#line 527
                      if (tmp___10) {
#line 527
                        if (ok) {
#line 527
                          tmp___11 = 1;
                        } else {
#line 527
                          tmp___11 = 0;
                        }
                      } else {
#line 527
                        tmp___11 = 0;
                      }
                      {
#line 527
                      ok = tmp___11;
#line 528
                      tmp___12 = send_rst(dst2, (u_short )dport2, src2, (u_short )sport2);
                      }
#line 528
                      if (tmp___12) {
#line 528
                        if (ok) {
#line 528
                          tmp___13 = 1;
                        } else {
#line 528
                          tmp___13 = 0;
                        }
                      } else {
#line 528
                        tmp___13 = 0;
                      }
#line 528
                      ok = tmp___13;
                    } else {
#line 524
                      goto _L___1;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 542
  if (found == 0) {
    {
#line 543
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"No matching connections found\n");
    }
#line 544
    return (0);
  }
#line 547
  return (ok);
}
}
#line 550 "/home/june/repo/benchmarks/collector/temp/cutter-1.03/cutter.c"
int main(int argc , char **argv ) 
{ 
  in_addr_t ip1 ;
  in_addr_t tmp ;
  in_addr_t tmp___0 ;
  int port1 ;
  int tmp___1 ;
  int tmp___2 ;
  in_addr_t ip2 ;
  in_addr_t tmp___3 ;
  in_addr_t tmp___4 ;
  int port2 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;

  {
#line 552
  if (argc > 1) {
    {
#line 552
    tmp = inet_addr((char const   *)*(argv + 1));
#line 552
    tmp___0 = tmp;
    }
  } else {
#line 552
    tmp___0 = (in_addr_t )0;
  }
#line 552
  ip1 = tmp___0;
#line 553
  if (argc > 2) {
    {
#line 553
    tmp___1 = atoi((char const   *)*(argv + 2));
#line 553
    tmp___2 = tmp___1;
    }
  } else {
#line 553
    tmp___2 = 0;
  }
#line 553
  port1 = tmp___2;
#line 554
  if (argc > 3) {
    {
#line 554
    tmp___3 = inet_addr((char const   *)*(argv + 3));
#line 554
    tmp___4 = tmp___3;
    }
  } else {
#line 554
    tmp___4 = (in_addr_t )0;
  }
#line 554
  ip2 = tmp___4;
#line 555
  if (argc > 4) {
    {
#line 555
    tmp___5 = atoi((char const   *)*(argv + 4));
#line 555
    tmp___6 = tmp___5;
    }
  } else {
#line 555
    tmp___6 = 0;
  }
#line 555
  port2 = tmp___6;
#line 557
  if (argc < 2) {
    {
#line 558
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"usage: cutter ip [ port [ ip [ port ] ] ]\n");
#line 559
    exit(1);
    }
  }
#line 562
  if (ip1 == 4294967295U) {
    {
#line 563
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Invalid IP address\n");
#line 564
    exit(1);
    }
  } else
#line 562
  if (ip2 == 4294967295U) {
    {
#line 563
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Invalid IP address\n");
#line 564
    exit(1);
    }
  }
  {
#line 567
  getifconfig();
#line 568
  tmp___7 = scan_conntrack(ip1, port1, ip2, port2);
  }
#line 568
  if (tmp___7) {
#line 569
    return (0);
  } else {
#line 571
    return (1);
  }
}
}
