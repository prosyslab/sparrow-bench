/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 125 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 141 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __suseconds_t;
#line 172 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 189 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __socklen_t;
#line 109 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __ssize_t ssize_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 54 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef long __fd_mask;
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
struct __anonstruct_fd_set_3 {
   __fd_mask __fds_bits[1024 / (8 * (int )sizeof(__fd_mask ))] ;
};
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef struct __anonstruct_fd_set_3 fd_set;
#line 33 "/usr/include/x86_64-linux-gnu/bits/socket.h"
typedef __socklen_t socklen_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 149 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 117 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 237 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 100 "/usr/include/netdb.h"
struct hostent {
   char *h_name ;
   char **h_aliases ;
   int h_addrtype ;
   int h_length ;
   char **h_addr_list ;
};
#line 257 "/usr/include/netdb.h"
struct servent {
   char *s_name ;
   char **s_aliases ;
   int s_port ;
   char *s_proto ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 106 "/usr/include/x86_64-linux-gnu/sys/select.h"
extern int select(int __nfds , fd_set * __restrict  __readfds , fd_set * __restrict  __writefds ,
                  fd_set * __restrict  __exceptfds , struct timeval * __restrict  __timeout ) ;
#line 113 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) socket)(int __domain ,
                                                                             int __type ,
                                                                             int __protocol ) ;
#line 123
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) bind)(int __fd ,
                                                                           struct sockaddr  const  *__addr ,
                                                                           socklen_t __len ) ;
#line 163
extern ssize_t sendto(int __fd , void const   *__buf , size_t __n , int __flags ,
                      struct sockaddr  const  *__addr , socklen_t __addr_len ) ;
#line 174
extern ssize_t recvfrom(int __fd , void * __restrict  __buf , size_t __n , int __flags ,
                        struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 226
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setsockopt)(int __fd ,
                                                                                 int __level ,
                                                                                 int __optname ,
                                                                                 void const   *__optval ,
                                                                                 socklen_t __optlen ) ;
#line 374 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint32_t ( __attribute__((__leaf__)) ntohl)(uint32_t __netlong )  __attribute__((__const__)) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 675
extern  __attribute__((__nothrow__)) __uid_t ( __attribute__((__leaf__)) getuid)(void) ;
#line 678
extern  __attribute__((__nothrow__)) __uid_t ( __attribute__((__leaf__)) geteuid)(void) ;
#line 700
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setuid)(__uid_t __uid ) ;
#line 57 "/usr/include/getopt.h"
extern char *optarg ;
#line 150
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) getopt)(int ___argc ,
                                                                             char * const  *___argv ,
                                                                             char const   *__shortopts ) ;
#line 144 "/usr/include/netdb.h"
extern struct hostent *gethostbyname(char const   *__name ) ;
#line 290
extern struct servent *getservbyname(char const   *__name , char const   *__proto ) ;
#line 170 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 364
extern  __attribute__((__nothrow__)) int sprintf(char * __restrict  __s , char const   * __restrict  __format 
                                                 , ...) ;
#line 433
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) sscanf)(char const   * __restrict  __s ,
                                                                             char const   * __restrict  __format 
                                                                             , ...)  __asm__("__isoc99_sscanf")  ;
#line 695
extern int puts(char const   *__s ) ;
#line 846
extern void perror(char const   *__s ) ;
#line 147 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 455
extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1,2), __leaf__)) bcopy)(void const   *__src ,
                                                                                               void *__dest ,
                                                                                               size_t __n ) ;
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 5 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcp_options.h"
char *dhcp_options[256]  = 
#line 5 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcp_options.h"
  {      (char *)"",      (char *)"Subnet mask",      (char *)"",      (char *)"Router", 
        (char *)"",      (char *)"",      (char *)"DNS server",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"Domainname", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"Request IP address",      (char *)"IP address leasetime", 
        (char *)"",      (char *)"DHCP message type",      (char *)"Server identifier",      (char *)"", 
        (char *)"Message",      (char *)"",      (char *)"T1",      (char *)"T2", 
        (char *)"",      (char *)"Client-identifier",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"", 
        (char *)"",      (char *)"",      (char *)"",      (char *)"End"};
#line 264 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcp_options.h"
char *dhcp_message_types[9]  = 
#line 264
  {      (char *)"",      (char *)"DHCPDISCOVER",      (char *)"DHCPOFFER",      (char *)"DHCPREQUEST", 
        (char *)"DHCPDECLINE",      (char *)"DHCPACK",      (char *)"DHCPNAK",      (char *)"DHCPRELEASE", 
        (char *)"DHCPINFORM"};
#line 47 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int offset  =    0;
#line 48 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void addpacket(char *pktbuf , char *msgbuf , int size ) 
{ 


  {
  {
#line 49
  memcpy((void */* __restrict  */)(pktbuf + offset), (void const   */* __restrict  */)msgbuf,
         (size_t )size);
#line 50
  offset += size;
  }
#line 51
  return;
}
}
#line 53
void dhcp_setup(char *serveripaddress ) ;
#line 54
int dhcp_read(void) ;
#line 55
void dhcp_close(void) ;
#line 56
void dhcp_dump(unsigned char *buffer , int size ) ;
#line 57
void dhcp_inform(char *ipaddr , char *gwaddr , char *hardware ) ;
#line 58
void dhcp_request(char *ipaddr , char *gwaddr , char *hardware ) ;
#line 59
void dhcp_release(char *ipaddr , char *gwaddr , char *hardware ) ;
#line 60
void dhcp_packet(int type , char *ipaddr , char *opt50 , char *gwaddr , char *hardware ) ;
#line 62 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int dhcp_socket  ;
#line 63 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
struct sockaddr_in dhcp_to  ;
#line 65 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int _serveripaddress  ;
#line 67 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int inform  ;
#line 67 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int request  ;
#line 67 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int verbose  ;
#line 67 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int VERBOSE  ;
#line 67 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int quiet  ;
#line 68 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
char *ci  ;
#line 68 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
char *gi  ;
#line 68 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
char *server  ;
#line 68 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
char *hw  ;
#line 69 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
unsigned char serveridentifier[4]  ;
#line 70 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int maxwait  =    3;
#line 72 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void doargs(int argc , char **argv ) 
{ 
  int ch ;

  {
#line 75
  quiet = 0;
#line 75
  VERBOSE = quiet;
#line 75
  verbose = VERBOSE;
#line 75
  request = verbose;
#line 75
  inform = request;
#line 76
  server = (char *)"0.0.0.0";
#line 76
  gi = server;
#line 76
  ci = gi;
#line 77
  hw = (char *)"00:00:00:00:00:00";
#line 79
  if (argc == 1) {
    {
#line 80
    printf((char const   */* __restrict  */)"dhcping -c ciaddr -g giaddr -h chaddr -r -s server -t maxwait -i -v -q\n");
#line 81
    exit(1);
    }
  }
  {
#line 84
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 84
    ch = getopt(argc, (char * const  *)argv, "c:g:h:iqrs:t:vV");
    }
#line 84
    if (! (ch > 0)) {
#line 84
      goto while_break;
    }
    {
#line 86
    if (ch == 99) {
#line 86
      goto case_99;
    }
#line 87
    if (ch == 103) {
#line 87
      goto case_103;
    }
#line 88
    if (ch == 104) {
#line 88
      goto case_104;
    }
#line 89
    if (ch == 105) {
#line 89
      goto case_105;
    }
#line 90
    if (ch == 113) {
#line 90
      goto case_113;
    }
#line 91
    if (ch == 114) {
#line 91
      goto case_114;
    }
#line 92
    if (ch == 115) {
#line 92
      goto case_115;
    }
#line 93
    if (ch == 116) {
#line 93
      goto case_116;
    }
#line 94
    if (ch == 118) {
#line 94
      goto case_118;
    }
#line 95
    if (ch == 86) {
#line 95
      goto case_86;
    }
#line 85
    goto switch_break;
    case_99: /* CIL Label */ 
#line 86
    ci = optarg;
#line 86
    goto switch_break;
    case_103: /* CIL Label */ 
#line 87
    gi = optarg;
#line 87
    goto switch_break;
    case_104: /* CIL Label */ 
#line 88
    hw = optarg;
#line 88
    goto switch_break;
    case_105: /* CIL Label */ 
#line 89
    inform = 1;
#line 89
    goto switch_break;
    case_113: /* CIL Label */ 
#line 90
    quiet = 1;
#line 90
    goto switch_break;
    case_114: /* CIL Label */ 
#line 91
    request = 1;
#line 91
    goto switch_break;
    case_115: /* CIL Label */ 
#line 92
    server = optarg;
#line 92
    goto switch_break;
    case_116: /* CIL Label */ 
    {
#line 93
    maxwait = atoi((char const   *)optarg);
    }
#line 93
    goto switch_break;
    case_118: /* CIL Label */ 
#line 94
    verbose = 1;
#line 94
    goto switch_break;
    case_86: /* CIL Label */ 
#line 95
    VERBOSE = 1;
#line 95
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 99
  if (request) {
#line 99
    if (inform) {
      {
#line 100
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"Error: -r and -i are mutally exclusive.\n");
#line 101
      exit(1);
      }
    }
  }
#line 105
  if (! inform) {
#line 105
    request = 1;
  }
#line 106
  return;
}
}
#line 108 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int main(int argc , char **argv ) 
{ 
  fd_set read___0 ;
  struct timeval timeout ;
  int foundpacket ;
  int returnvalue ;
  __uid_t tmp ;
  __uid_t tmp___0 ;
  int tmp___1 ;
  int __d0 ;
  int __d1 ;
  int tmp___2 ;

  {
  {
#line 111
  foundpacket = 0;
#line 112
  returnvalue = 0;
#line 114
  tmp = geteuid();
  }
#line 114
  if (tmp != 0U) {
    {
#line 115
    printf((char const   */* __restrict  */)"This program should only be ran by root or be installed as setuid root.\n");
#line 116
    exit(1);
    }
  }
  {
#line 119
  doargs(argc, argv);
  }
#line 121
  if (VERBOSE) {
    {
#line 121
    puts("setup");
    }
  }
  {
#line 122
  dhcp_setup(server);
#line 124
  tmp___0 = getuid();
#line 124
  tmp___1 = setuid(tmp___0);
  }
#line 124
  if (tmp___1 != 0) {
    {
#line 125
    perror("setuid");
#line 126
    printf((char const   */* __restrict  */)"Can\'t drop privileges back to normal user, program aborted.\n");
#line 127
    exit(1);
    }
  }
#line 130
  if (inform) {
#line 131
    if (VERBOSE) {
      {
#line 131
      puts("inform");
      }
    }
    {
#line 132
    dhcp_inform(ci, gi, hw);
    }
  }
#line 134
  if (request) {
#line 135
    if (VERBOSE) {
      {
#line 135
      puts("request");
      }
    }
    {
#line 136
    dhcp_request(ci, gi, hw);
    }
  }
  {
#line 139
  while (1) {
    while_continue: /* CIL Label */ ;
#line 139
    if (! (! foundpacket)) {
#line 139
      goto while_break;
    }
    {
#line 140
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 140
      __asm__  volatile   ("cld; rep; "
                           "stosq": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                           "1" (& read___0.__fds_bits[0]): "memory");
#line 140
      goto while_break___0;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 141
    read___0.__fds_bits[dhcp_socket / (8 * (int )sizeof(__fd_mask ))] |= 1L << dhcp_socket % (8 * (int )sizeof(__fd_mask ));
#line 142
    timeout.tv_sec = (__time_t )maxwait;
#line 143
    timeout.tv_usec = (__suseconds_t )0;
#line 144
    tmp___2 = select(dhcp_socket + 1, (fd_set */* __restrict  */)(& read___0), (fd_set */* __restrict  */)((void *)0),
                     (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& timeout));
    }
#line 144
    if (tmp___2 < 0) {
      {
#line 145
      perror("select");
#line 146
      exit(0);
      }
    }
#line 148
    if ((read___0.__fds_bits[dhcp_socket / (8 * (int )sizeof(__fd_mask ))] & (1L << dhcp_socket % (8 * (int )sizeof(__fd_mask )))) != 0L) {
#line 149
      if (VERBOSE) {
        {
#line 149
        puts("read");
        }
      }
      {
#line 151
      foundpacket = dhcp_read();
      }
#line 151
      if (foundpacket != 0) {
#line 152
        if (request) {
#line 153
          if (VERBOSE) {
            {
#line 153
            puts("release");
            }
          }
          {
#line 154
          dhcp_release(ci, gi, hw);
          }
        }
      }
    } else {
#line 158
      if (! quiet) {
        {
#line 159
        fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"no answer\n");
        }
      }
#line 160
      returnvalue = 1;
#line 161
      foundpacket = 1;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 164
  if (VERBOSE) {
    {
#line 164
    puts("close");
    }
  }
  {
#line 165
  dhcp_close();
  }
#line 166
  return (returnvalue);
}
}
#line 170 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_setup(char *serveripaddress ) 
{ 
  struct servent *servent ;
  struct servent *clientent ;
  struct hostent *hostent ;
  int flag ;
  struct sockaddr_in name ;
  uint32_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 179
  servent = getservbyname("bootps", (char const   *)0);
  }
#line 179
  if ((unsigned long )servent == (unsigned long )((void *)0)) {
    {
#line 180
    perror("getservbyname: bootps");
#line 181
    exit(1);
    }
  }
  {
#line 183
  hostent = gethostbyname((char const   *)serveripaddress);
  }
#line 183
  if ((unsigned long )hostent == (unsigned long )((void *)0)) {
    {
#line 184
    perror("gethostbyname");
#line 185
    exit(1);
    }
  }
  {
#line 188
  dhcp_to.sin_family = (sa_family_t )2;
#line 189
  bcopy((void const   *)*(hostent->h_addr_list + 0), (void *)(& dhcp_to.sin_addr.s_addr),
        (size_t )hostent->h_length);
#line 190
  tmp = ntohl(dhcp_to.sin_addr.s_addr);
#line 190
  _serveripaddress = (int )tmp;
#line 192
  dhcp_to.sin_port = (in_port_t )servent->s_port;
#line 194
  dhcp_socket = socket(2, 2, 17);
  }
#line 194
  if (dhcp_socket == -1) {
    {
#line 195
    perror("dhcp_socket/socket");
#line 196
    exit(1);
    }
  }
  {
#line 199
  flag = 1;
#line 200
  tmp___0 = setsockopt(dhcp_socket, 1, 2, (void const   *)((char *)(& flag)), (socklen_t )sizeof(flag));
  }
#line 200
  if (tmp___0 < 0) {
    {
#line 201
    perror("dhcp_socket/setsockopt: SO_REUSEADDR");
#line 202
    exit(1);
    }
  }
  {
#line 205
  tmp___1 = setsockopt(dhcp_socket, 1, 6, (void const   *)((char *)(& flag)), (socklen_t )sizeof(flag));
  }
#line 205
  if (tmp___1 < 0) {
    {
#line 206
    perror("dhcp_socket/setsockopt: SO_BROADCAST");
#line 207
    exit(1);
    }
  }
  {
#line 210
  clientent = getservbyname("bootpc", (char const   *)0);
  }
#line 210
  if ((unsigned long )clientent == (unsigned long )((void *)0)) {
    {
#line 211
    perror("getservbyname: bootpc");
#line 212
    exit(1);
    }
  }
  {
#line 214
  name.sin_family = (sa_family_t )2;
#line 215
  name.sin_port = (in_port_t )clientent->s_port;
#line 216
  name.sin_addr.s_addr = (in_addr_t )0;
#line 218
  memset((void *)(name.sin_zero), 0, sizeof(name.sin_zero));
#line 220
  tmp___2 = bind(dhcp_socket, (struct sockaddr  const  *)((struct sockaddr *)(& name)),
                 (socklen_t )sizeof(name));
  }
#line 220
  if (tmp___2 < 0) {
    {
#line 221
    perror("bind");
#line 222
    exit(1);
    }
  }
#line 224
  return;
}
}
#line 226 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_request(char *ipaddr , char *gwaddr , char *hardware ) 
{ 


  {
  {
#line 227
  dhcp_packet(3, ipaddr, ipaddr, gwaddr, hardware);
  }
#line 228
  return;
}
}
#line 229 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_release(char *ipaddr , char *gwaddr , char *hardware ) 
{ 


  {
  {
#line 230
  dhcp_packet(7, ipaddr, (char *)((void *)0), gwaddr, hardware);
  }
#line 231
  return;
}
}
#line 232 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_inform(char *ipaddr , char *gwaddr , char *hardware ) 
{ 


  {
  {
#line 233
  dhcp_packet(8, ipaddr, (char *)((void *)0), gwaddr, hardware);
  }
#line 234
  return;
}
}
#line 238
void dhcp_packet(int type , char *ipaddr , char *opt50 , char *gwaddr , char *hardware ) ;
#line 238 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
static time_t l  =    (time_t )0;
#line 237 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_packet(int type , char *ipaddr , char *opt50 , char *gwaddr , char *hardware ) 
{ 
  unsigned char msgbuf[65536] ;
  unsigned char pktbuf[65536] ;
  int ip[4] ;
  int gw[4] ;
  int hw___0[16] ;
  int ip50[4] ;
  int hwcount ;
  time_t tmp ;

  {
  {
#line 244
  sscanf((char const   */* __restrict  */)ipaddr, (char const   */* __restrict  */)"%d.%d.%d.%d",
         & ip[0], & ip[1], & ip[2], & ip[3]);
#line 245
  sscanf((char const   */* __restrict  */)gwaddr, (char const   */* __restrict  */)"%d.%d.%d.%d",
         & gw[0], & gw[1], & gw[2], & gw[3]);
  }
#line 246
  if (opt50) {
    {
#line 247
    sscanf((char const   */* __restrict  */)opt50, (char const   */* __restrict  */)"%d.%d.%d.%d",
           & ip50[0], & ip50[1], & ip50[2], & ip50[3]);
    }
  }
  {
#line 248
  memset((void *)(& hw___0), 0, sizeof(hw___0));
#line 249
  hwcount = sscanf((char const   */* __restrict  */)hardware, (char const   */* __restrict  */)"%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x",
                   & hw___0[0], & hw___0[1], & hw___0[2], & hw___0[3], & hw___0[4],
                   & hw___0[5], & hw___0[6], & hw___0[7], & hw___0[8], & hw___0[9],
                   & hw___0[10], & hw___0[11], & hw___0[12], & hw___0[13], & hw___0[14],
                   & hw___0[15]);
#line 255
  memset((void *)(msgbuf), 0, sizeof(msgbuf));
#line 256
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"\001\001%c%c",
          hwcount, 0);
#line 257
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 260
  tmp = time((time_t *)((void *)0));
  }
#line 260
  if (l > tmp) {
#line 261
    l ++;
  } else {
    {
#line 263
    l = time((time_t *)((void *)0));
    }
  }
  {
#line 264
  memcpy((void */* __restrict  */)(msgbuf), (void const   */* __restrict  */)(& l),
         (size_t )4);
#line 265
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 268
  memset((void *)(msgbuf), 0, (size_t )4);
#line 269
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 275
  memset((void *)(msgbuf), 0, (size_t )4);
#line 276
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c",
          ip[0], ip[1], ip[2], ip[3]);
#line 277
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 280
  memset((void *)(msgbuf), 0, (size_t )4);
#line 281
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 284
  memset((void *)(msgbuf), 0, (size_t )4);
#line 285
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 288
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c",
          gw[0], gw[1], gw[2], gw[3]);
#line 289
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 292
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c",
          hw___0[0], hw___0[1], hw___0[2], hw___0[3], hw___0[4], hw___0[5], hw___0[6],
          hw___0[7], hw___0[8], hw___0[9], hw___0[10], hw___0[11], hw___0[12], hw___0[13],
          hw___0[14], hw___0[15]);
#line 295
  addpacket((char *)(pktbuf), (char *)(msgbuf), 16);
#line 298
  memset((void *)(msgbuf), 0, (size_t )64);
#line 299
  addpacket((char *)(pktbuf), (char *)(msgbuf), 64);
#line 302
  memset((void *)(msgbuf), 0, (size_t )128);
#line 303
  addpacket((char *)(pktbuf), (char *)(msgbuf), 128);
#line 308
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c",
          99, 130, 83, 99);
#line 309
  addpacket((char *)(pktbuf), (char *)(msgbuf), 4);
#line 312
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c",
          53, 1, type);
#line 313
  addpacket((char *)(pktbuf), (char *)(msgbuf), 3);
  }
#line 316
  if (type != 8) {
#line 318
    if (opt50) {
      {
#line 319
      sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c%c%c",
              50, 4, ip50[0], ip50[1], ip50[2], ip50[3]);
#line 320
      addpacket((char *)(pktbuf), (char *)(msgbuf), 6);
      }
    }
#line 324
    if (serveridentifier[0]) {
      {
#line 325
      sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c%c%c%c",
              54, 4, (int )serveridentifier[0], (int )serveridentifier[1], (int )serveridentifier[2],
              (int )serveridentifier[3]);
#line 328
      addpacket((char *)(pktbuf), (char *)(msgbuf), 6);
      }
    }
  }
#line 338
  if (type == 8) {
    {
#line 339
    sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c%c%c",
            55, 1, 1);
#line 340
    addpacket((char *)(pktbuf), (char *)(msgbuf), 3);
    }
  }
  {
#line 344
  sprintf((char */* __restrict  */)(msgbuf), (char const   */* __restrict  */)"%c",
          255);
#line 345
  addpacket((char *)(pktbuf), (char *)(msgbuf), 1);
#line 348
  dhcp_dump(pktbuf, offset);
#line 350
  sendto(dhcp_socket, (void const   *)(pktbuf), (size_t )offset, 0, (struct sockaddr  const  *)((struct sockaddr *)(& dhcp_to)),
         (socklen_t )sizeof(dhcp_to));
#line 352
  offset = 0;
  }
#line 353
  return;
}
}
#line 356 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
int dhcp_read(void) 
{ 
  unsigned char msgbuf[65536] ;
  struct sockaddr_in fromsock ;
  socklen_t fromlen ;
  int addr ;
  int i ;
  ssize_t tmp ;
  uint32_t tmp___0 ;

  {
  {
#line 359
  fromlen = (socklen_t )sizeof(fromsock);
#line 363
  tmp = recvfrom(dhcp_socket, (void */* __restrict  */)(msgbuf), (size_t )65536, 0,
                 (struct sockaddr */* __restrict  */)((struct sockaddr *)(& fromsock)),
                 (socklen_t */* __restrict  */)(& fromlen));
#line 363
  i = (int )tmp;
#line 364
  tmp___0 = ntohl(fromsock.sin_addr.s_addr);
#line 364
  addr = (int )tmp___0;
  }
#line 366
  if (! quiet) {
    {
#line 367
    printf((char const   */* __restrict  */)"Got answer from: %d.%d.%d.%d\n", (addr >> 24) & 255,
           (addr >> 16) & 255, (addr >> 8) & 255, addr & 255);
    }
  }
#line 373
  if (_serveripaddress != addr) {
#line 374
    if (! quiet) {
      {
#line 375
      fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"received from %d.%d.%d.%d, expected from %d.%d.%d.%d\n",
              (addr >> 24) & 255, (addr >> 16) & 255, (addr >> 8) & 255, addr & 255,
              (_serveripaddress >> 24) & 255, (_serveripaddress >> 16) & 255, (_serveripaddress >> 8) & 255,
              _serveripaddress & 255);
      }
    }
#line 381
    return (0);
  }
  {
#line 386
  dhcp_dump(msgbuf, i);
  }
#line 387
  return (1);
}
}
#line 392 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_dump(unsigned char *buffer , int size ) 
{ 
  int j ;

  {
#line 395
  if (VERBOSE) {
    {
#line 396
    printf((char const   */* __restrict  */)"packet %d bytes\n", size);
    }
  }
#line 398
  if (! VERBOSE) {
#line 399
    return;
  }
#line 405
  j = 0;
  {
#line 406
  while (1) {
    while_continue: /* CIL Label */ ;
#line 406
    if (! (j < size)) {
#line 406
      goto while_break;
    }
    {
#line 407
    printf((char const   */* __restrict  */)"%02x ", (int )*(buffer + j));
    }
#line 408
    if (j % 16 == 15) {
      {
#line 408
      printf((char const   */* __restrict  */)"\n");
      }
    }
#line 409
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 411
  printf((char const   */* __restrict  */)"\n");
#line 413
  printf((char const   */* __restrict  */)"op: %d\n", (int )*(buffer + 0));
#line 414
  printf((char const   */* __restrict  */)"htype: %d\n", (int )*(buffer + 1));
#line 415
  printf((char const   */* __restrict  */)"hlen: %d\n", (int )*(buffer + 2));
#line 416
  printf((char const   */* __restrict  */)"hops: %d\n", (int )*(buffer + 3));
#line 418
  printf((char const   */* __restrict  */)"xid: %02x%02x%02x%02x\n", (int )*(buffer + 4),
         (int )*(buffer + 5), (int )*(buffer + 6), (int )*(buffer + 7));
#line 420
  printf((char const   */* __restrict  */)"secs: %d\n", 255 * (int )*(buffer + 8) + (int )*(buffer + 9));
#line 421
  printf((char const   */* __restrict  */)"flags: %x\n", 255 * (int )*(buffer + 10) + (int )*(buffer + 11));
#line 423
  printf((char const   */* __restrict  */)"ciaddr: %d.%d.%d.%d\n", (int )*(buffer + 12),
         (int )*(buffer + 13), (int )*(buffer + 14), (int )*(buffer + 15));
#line 425
  printf((char const   */* __restrict  */)"yiaddr: %d.%d.%d.%d\n", (int )*(buffer + 16),
         (int )*(buffer + 17), (int )*(buffer + 18), (int )*(buffer + 19));
#line 427
  printf((char const   */* __restrict  */)"siaddr: %d.%d.%d.%d\n", (int )*(buffer + 20),
         (int )*(buffer + 21), (int )*(buffer + 22), (int )*(buffer + 23));
#line 429
  printf((char const   */* __restrict  */)"giaddr: %d.%d.%d.%d\n", (int )*(buffer + 24),
         (int )*(buffer + 25), (int )*(buffer + 26), (int )*(buffer + 27));
#line 431
  printf((char const   */* __restrict  */)"chaddr: %02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x\n",
         (int )*(buffer + 28), (int )*(buffer + 29), (int )*(buffer + 30), (int )*(buffer + 31),
         (int )*(buffer + 32), (int )*(buffer + 33), (int )*(buffer + 34), (int )*(buffer + 35),
         (int )*(buffer + 36), (int )*(buffer + 37), (int )*(buffer + 38), (int )*(buffer + 39),
         (int )*(buffer + 40), (int )*(buffer + 41), (int )*(buffer + 42), (int )*(buffer + 43));
#line 436
  printf((char const   */* __restrict  */)"sname : %s.\n", buffer + 44);
#line 437
  printf((char const   */* __restrict  */)"fname : %s.\n", buffer + 108);
#line 439
  j = 236;
#line 440
  j += 4;
  }
  {
#line 441
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 441
    if (j < size) {
#line 441
      if (! ((int )*(buffer + j) != 255)) {
#line 441
        goto while_break___0;
      }
    } else {
#line 441
      goto while_break___0;
    }
    {
#line 442
    printf((char const   */* __restrict  */)"option %d %s\n", (int )*(buffer + j),
           dhcp_options[*(buffer + j)]);
    }
    {
#line 445
    if ((int )*(buffer + j) == 1) {
#line 445
      goto case_1;
    }
#line 449
    if ((int )*(buffer + j) == 3) {
#line 449
      goto case_3;
    }
#line 453
    if ((int )*(buffer + j) == 50) {
#line 453
      goto case_50;
    }
#line 457
    if ((int )*(buffer + j) == 53) {
#line 457
      goto case_53;
    }
#line 461
    if ((int )*(buffer + j) == 54) {
#line 461
      goto case_54;
    }
#line 467
    if ((int )*(buffer + j) == 61) {
#line 467
      goto case_61;
    }
#line 444
    goto switch_break;
    case_1: /* CIL Label */ 
    {
#line 446
    printf((char const   */* __restrict  */)"\tSubnet mask: %d.%d.%d.%d\n", (int )*(buffer + (j + 2)),
           (int )*(buffer + (j + 3)), (int )*(buffer + (j + 4)), (int )*(buffer + (j + 5)));
    }
#line 448
    goto switch_break;
    case_3: /* CIL Label */ 
    {
#line 450
    printf((char const   */* __restrict  */)"\tRouter: %d.%d.%d.%d\n", (int )*(buffer + (j + 2)),
           (int )*(buffer + (j + 3)), (int )*(buffer + (j + 4)), (int )*(buffer + (j + 5)));
    }
#line 452
    goto switch_break;
    case_50: /* CIL Label */ 
    {
#line 454
    printf((char const   */* __restrict  */)"\tRequested IP address: %d.%d.%d.%d\n",
           (int )*(buffer + (j + 2)), (int )*(buffer + (j + 3)), (int )*(buffer + (j + 4)),
           (int )*(buffer + (j + 5)));
    }
#line 456
    goto switch_break;
    case_53: /* CIL Label */ 
    {
#line 458
    printf((char const   */* __restrict  */)"\tDHCP message type: %d (%s)\n", (int )*(buffer + (j + 2)),
           dhcp_message_types[*(buffer + (j + 2))]);
    }
#line 460
    goto switch_break;
    case_54: /* CIL Label */ 
    {
#line 462
    memcpy((void */* __restrict  */)(serveridentifier), (void const   */* __restrict  */)((buffer + j) + 2),
           (size_t )4);
#line 463
    printf((char const   */* __restrict  */)"\tServer identifier: %d.%d.%d.%d\n",
           (int )serveridentifier[0], (int )serveridentifier[1], (int )serveridentifier[2],
           (int )serveridentifier[3]);
    }
#line 466
    goto switch_break;
    case_61: /* CIL Label */ 
    {
#line 468
    printf((char const   */* __restrict  */)"\tClient identifier: %02x%02x%02x%02x%02x%02x\n",
           (int )*(buffer + (j + 2)), (int )*(buffer + (j + 3)), (int )*(buffer + (j + 4)),
           (int )*(buffer + (j + 5)), (int )*(buffer + (j + 6)), (int )*(buffer + (j + 7)));
    }
#line 471
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 481
    j += (int )*(buffer + (j + 1)) + 2;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 483
  return;
}
}
#line 486 "/home/june/repo/benchmarks/collector/temp/dhcping-1.2/dhcping.c"
void dhcp_close(void) 
{ 


  {
  {
#line 487
  close(dhcp_socket);
  }
#line 488
  return;
}
}
