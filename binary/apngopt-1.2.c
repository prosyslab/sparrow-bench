/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 368 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned char Byte;
#line 370 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned int uInt;
#line 371 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef unsigned long uLong;
#line 377 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef Byte Bytef;
#line 386 "/usr/include/x86_64-linux-gnu/zconf.h"
typedef void *voidpf;
#line 83 "/usr/include/zlib.h"
struct internal_state;
#line 83
struct internal_state;
#line 85 "/usr/include/zlib.h"
struct z_stream_s {
   Bytef *next_in ;
   uInt avail_in ;
   uLong total_in ;
   Bytef *next_out ;
   uInt avail_out ;
   uLong total_out ;
   char *msg ;
   struct internal_state *state ;
   voidpf (*zalloc)(voidpf opaque , uInt items , uInt size ) ;
   void (*zfree)(voidpf opaque , voidpf address ) ;
   voidpf opaque ;
   int data_type ;
   uLong adler ;
   uLong reserved ;
};
#line 85 "/usr/include/zlib.h"
typedef struct z_stream_s z_stream;
#line 106 "/usr/include/zlib.h"
typedef z_stream *z_streamp;
#line 1742 "/usr/include/zlib.h"
struct internal_state {
   int dummy ;
};
#line 71 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct __anonstruct_OP_12 {
   z_stream zstream ;
   unsigned char *zbuf ;
   int x ;
   int y ;
   int w ;
   int h ;
   int valid ;
};
#line 71 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
typedef struct __anonstruct_OP_12 OP;
#line 72 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct __anonstruct_COLORS_13 {
   unsigned int num ;
   unsigned char r ;
   unsigned char g ;
   unsigned char b ;
   unsigned char a ;
};
#line 72 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
typedef struct __anonstruct_COLORS_13 COLORS;
#line 73 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct __anonstruct_rgb_14 {
   unsigned char r ;
   unsigned char g ;
   unsigned char b ;
};
#line 73 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
typedef struct __anonstruct_rgb_14 rgb;
#line 2091 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct IHDR {
   unsigned int mWidth ;
   unsigned int mHeight ;
   unsigned char mDepth ;
   unsigned char mColorType ;
   unsigned char mCompression ;
   unsigned char mFilterMethod ;
   unsigned char mInterlaceMethod ;
};
#line 2102 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct acTL {
   unsigned int mFrameCount ;
   unsigned int mLoopCount ;
};
#line 2108 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
struct fcTL {
   unsigned int mSeq ;
   unsigned int mWidth ;
   unsigned int mHeight ;
   unsigned int mXOffset ;
   unsigned int mYOffset ;
   unsigned short mDelayNum ;
   unsigned short mDelayDen ;
   unsigned char mDisposeOp ;
   unsigned char mBlendOp ;
};
/* compiler builtin: 
   int __builtin_bswap32(int  ) ;  */
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 709
extern size_t fread(void * __restrict  __ptr , size_t __size , size_t __n , FILE * __restrict  __stream ) ;
#line 715
extern size_t fwrite(void const   * __restrict  __ptr , size_t __size , size_t __n ,
                     FILE * __restrict  __s ) ;
#line 749
extern int fseek(FILE *__stream , long __off , int __whence ) ;
#line 828
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) feof)(FILE *__stream ) ;
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 765
extern void ( __attribute__((__nonnull__(1,4))) qsort)(void *__base , size_t __nmemb ,
                                                       size_t __size , int (*__compar)(void const   * ,
                                                                                       void const   * ) ) ;
#line 775
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) abs)(int __x )  __attribute__((__const__)) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 69
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) memcmp)(void const   *__s1 ,
                                                                                               void const   *__s2 ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 132
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strncpy)(char * __restrict  __dest ,
                                                                                                  char const   * __restrict  __src ,
                                                                                                  size_t __n ) ;
#line 137
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcat)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 263
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strrchr)(char const   *__s ,
                                                                                                int __c )  __attribute__((__pure__)) ;
#line 246 "/usr/include/zlib.h"
extern int deflate(z_streamp strm , int flush ) ;
#line 353
extern int deflateEnd(z_streamp strm ) ;
#line 392
extern int inflate(z_streamp strm , int flush ) ;
#line 508
extern int inflateEnd(z_streamp strm ) ;
#line 649
extern int deflateReset(z_streamp strm ) ;
#line 892
extern int inflateReset(z_streamp strm ) ;
#line 1600
extern uLong crc32(uLong crc , Bytef const   *buf , uInt len ) ;
#line 1635
extern int inflateInit_(z_streamp strm , char const   *version , int stream_size ) ;
#line 1637
extern int deflateInit2_(z_streamp strm , int level , int method , int windowBits ,
                         int memLevel , int strategy , char const   *version , int stream_size ) ;
#line 44 "/usr/include/x86_64-linux-gnu/bits/byteswap.h"
__inline static unsigned int __bswap_32(unsigned int __bsx ) 
{ 
  int tmp ;

  {
  {
#line 47
  tmp = __builtin_bswap32((int )__bsx);
  }
#line 47
  return ((unsigned int )tmp);
}
}
#line 75 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
OP op[12]  ;
#line 76 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
COLORS col[256]  ;
#line 78 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int next_seq_num  =    0U;
#line 79 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char *row_buf  ;
#line 80 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char *sub_row  ;
#line 81 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char *up_row  ;
#line 82 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char *avg_row  ;
#line 83 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char *paeth_row  ;
#line 84 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char png_sign[8]  = 
#line 84
  {      (unsigned char)137,      (unsigned char)80,      (unsigned char)78,      (unsigned char)71, 
        (unsigned char)13,      (unsigned char)10,      (unsigned char)26,      (unsigned char)10};
#line 85 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int mask4[2]  = {      240U,      15U};
#line 86 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int shift4[2]  = {      4U,      0U};
#line 87 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int mask2[4]  = {      192U,      48U,      12U,      3U};
#line 88 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int shift2[4]  = {      6U,      4U,      2U,      0U};
#line 89 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int mask1[8]  = 
#line 89
  {      128U,      64U,      32U,      16U, 
        8U,      4U,      2U,      1U};
#line 90 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int shift1[8]  = 
#line 90
  {      7U,      6U,      5U,      4U, 
        3U,      2U,      1U,      0U};
#line 91 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char pl[256][3]  ;
#line 92 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned char tr[256]  ;
#line 93 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int ps  ;
#line 93 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int ts  ;
#line 94 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned short trns1  ;
#line 94 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned short trns2  ;
#line 94 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned short trns3  ;
#line 95 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int trns_idx  ;
#line 96 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int keep_original  =    1;
#line 97 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int keep_palette  =    0;
#line 98 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int keep_coltype  =    0;
#line 100 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int cmp_colors(void const   *arg1 , void const   *arg2 ) 
{ 


  {
#line 102
  if ((int )((COLORS *)arg1)->a != (int )((COLORS *)arg2)->a) {
#line 103
    return ((int )((COLORS *)arg1)->a - (int )((COLORS *)arg2)->a);
  }
#line 105
  if (((COLORS *)arg1)->num != ((COLORS *)arg2)->num) {
#line 106
    return ((int )((COLORS *)arg2)->num - (int )((COLORS *)arg1)->num);
  }
#line 108
  if ((int )((COLORS *)arg1)->r != (int )((COLORS *)arg2)->r) {
#line 109
    return ((int )((COLORS *)arg1)->r - (int )((COLORS *)arg2)->r);
  }
#line 111
  if ((int )((COLORS *)arg1)->g != (int )((COLORS *)arg2)->g) {
#line 112
    return ((int )((COLORS *)arg1)->g - (int )((COLORS *)arg2)->g);
  }
#line 114
  return ((int )((COLORS *)arg1)->b - (int )((COLORS *)arg2)->b);
}
}
#line 117 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int read32(unsigned int *val , FILE *f1 ) 
{ 
  unsigned int res ;
  size_t tmp ;

  {
  {
#line 120
  tmp = fread((void */* __restrict  */)(& res), (size_t )1, (size_t )4, (FILE */* __restrict  */)f1);
  }
#line 120
  if (tmp != 4UL) {
#line 120
    return (1);
  }
  {
#line 121
  *val = __bswap_32(res);
  }
#line 122
  return (0);
}
}
#line 125 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int read16(unsigned short *val , FILE *f1 ) 
{ 
  unsigned short res ;
  size_t tmp ;
  unsigned short __v ;
  unsigned short __x ;

  {
  {
#line 128
  tmp = fread((void */* __restrict  */)(& res), (size_t )1, (size_t )2, (FILE */* __restrict  */)f1);
  }
#line 128
  if (tmp != 2UL) {
#line 128
    return (1);
  }
#line 129
  __x = res;
#line 129
  __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 129
  *val = __v;
#line 130
  return (0);
}
}
#line 133 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned short readshort(unsigned char *p ) 
{ 


  {
#line 135
  return ((unsigned short )(((int )((unsigned short )*p) << 8) + (int )((unsigned short )*(p + 1))));
}
}
#line 138 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void read_sub_row(unsigned char *row , unsigned int rowbytes , unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 142
  i = bpp;
  {
#line 142
  while (1) {
    while_continue: /* CIL Label */ ;
#line 142
    if (! (i < rowbytes)) {
#line 142
      goto while_break;
    }
#line 143
    *(row + i) = (unsigned char )((int )*(row + i) + (int )*(row + (i - bpp)));
#line 142
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 144
  return;
}
}
#line 146 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void read_up_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                 unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 150
  if (prev_row) {
#line 151
    i = 0U;
    {
#line 151
    while (1) {
      while_continue: /* CIL Label */ ;
#line 151
      if (! (i < rowbytes)) {
#line 151
        goto while_break;
      }
#line 152
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(prev_row + i));
#line 151
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 153
  return;
}
}
#line 155 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void read_average_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                      unsigned int bpp ) 
{ 
  unsigned int i ;

  {
#line 159
  if (prev_row) {
#line 161
    i = 0U;
    {
#line 161
    while (1) {
      while_continue: /* CIL Label */ ;
#line 161
      if (! (i < bpp)) {
#line 161
        goto while_break;
      }
#line 162
      *(row + i) = (unsigned char )((int )*(row + i) + ((int )*(prev_row + i) >> 1));
#line 161
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 163
    i = bpp;
    {
#line 163
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 163
      if (! (i < rowbytes)) {
#line 163
        goto while_break___0;
      }
#line 164
      *(row + i) = (unsigned char )((int )*(row + i) + (((int )*(prev_row + i) + (int )*(row + (i - bpp))) >> 1));
#line 163
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else {
#line 168
    i = bpp;
    {
#line 168
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 168
      if (! (i < rowbytes)) {
#line 168
        goto while_break___1;
      }
#line 169
      *(row + i) = (unsigned char )((int )*(row + i) + ((int )*(row + (i - bpp)) >> 1));
#line 168
      i ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 171
  return;
}
}
#line 173 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void read_paeth_row(unsigned char *row , unsigned char *prev_row , unsigned int rowbytes ,
                    unsigned int bpp ) 
{ 
  unsigned int i ;
  int a ;
  int b ;
  int c ;
  int pa ;
  int pb ;
  int pc ;
  int p ;
  int tmp ;
  int tmp___0 ;

  {
#line 178
  if (prev_row) {
#line 180
    i = 0U;
    {
#line 180
    while (1) {
      while_continue: /* CIL Label */ ;
#line 180
      if (! (i < bpp)) {
#line 180
        goto while_break;
      }
#line 181
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(prev_row + i));
#line 180
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 182
    i = bpp;
    {
#line 182
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 182
      if (! (i < rowbytes)) {
#line 182
        goto while_break___0;
      }
      {
#line 184
      a = (int )*(row + (i - bpp));
#line 185
      b = (int )*(prev_row + i);
#line 186
      c = (int )*(prev_row + (i - bpp));
#line 187
      p = b - c;
#line 188
      pc = a - c;
#line 189
      pa = abs(p);
#line 190
      pb = abs(pc);
#line 191
      pc = abs(p + pc);
      }
#line 192
      if (pa <= pb) {
#line 192
        if (pa <= pc) {
#line 192
          tmp___0 = a;
        } else {
#line 192
          goto _L;
        }
      } else {
        _L: /* CIL Label */ 
#line 192
        if (pb <= pc) {
#line 192
          tmp = b;
        } else {
#line 192
          tmp = c;
        }
#line 192
        tmp___0 = tmp;
      }
#line 192
      *(row + i) = (unsigned char )((int )*(row + i) + tmp___0);
#line 182
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else {
#line 197
    i = bpp;
    {
#line 197
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 197
      if (! (i < rowbytes)) {
#line 197
        goto while_break___1;
      }
#line 198
      *(row + i) = (unsigned char )((int )*(row + i) + (int )*(row + (i - bpp)));
#line 197
      i ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 200
  return;
}
}
#line 202 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void unpack(z_stream zstream , unsigned char *dst , unsigned int dst_size , unsigned char *src ,
            unsigned int src_size , unsigned int h , unsigned int rowbytes , unsigned char bpp ) 
{ 
  unsigned int j ;
  unsigned char *row ;
  unsigned char *prev_row ;
  unsigned char *tmp ;

  {
  {
#line 205
  row = dst;
#line 206
  prev_row = (unsigned char *)((void *)0);
#line 208
  zstream.next_out = dst;
#line 209
  zstream.avail_out = dst_size;
#line 210
  zstream.next_in = src;
#line 211
  zstream.avail_in = src_size;
#line 212
  inflate(& zstream, 4);
#line 213
  inflateReset(& zstream);
#line 215
  j = 0U;
  }
  {
#line 215
  while (1) {
    while_continue: /* CIL Label */ ;
#line 215
    if (! (j < h)) {
#line 215
      goto while_break;
    }
#line 217
    tmp = row;
#line 217
    row ++;
    {
#line 219
    if ((int )*tmp == 0) {
#line 219
      goto case_0;
    }
#line 220
    if ((int )*tmp == 1) {
#line 220
      goto case_1;
    }
#line 221
    if ((int )*tmp == 2) {
#line 221
      goto case_2;
    }
#line 222
    if ((int )*tmp == 3) {
#line 222
      goto case_3;
    }
#line 223
    if ((int )*tmp == 4) {
#line 223
      goto case_4;
    }
#line 217
    goto switch_break;
    case_0: /* CIL Label */ 
#line 219
    goto switch_break;
    case_1: /* CIL Label */ 
    {
#line 220
    read_sub_row(row, rowbytes, (unsigned int )bpp);
    }
#line 220
    goto switch_break;
    case_2: /* CIL Label */ 
    {
#line 221
    read_up_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 221
    goto switch_break;
    case_3: /* CIL Label */ 
    {
#line 222
    read_average_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 222
    goto switch_break;
    case_4: /* CIL Label */ 
    {
#line 223
    read_paeth_row(row, prev_row, rowbytes, (unsigned int )bpp);
    }
#line 223
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 225
    prev_row = row;
#line 226
    row += rowbytes;
#line 215
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 228
  return;
}
}
#line 230 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void compose0(unsigned char *dst1 , unsigned int dstbytes1 , unsigned char *dst2 ,
              unsigned int dstbytes2 , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int g ;
  unsigned int a ;
  unsigned char *sp ;
  unsigned char *dp1 ;
  unsigned int *dp2 ;
  unsigned short tmp ;
  unsigned char *tmp___0 ;
  unsigned int *tmp___1 ;
  unsigned char *tmp___2 ;
  unsigned int *tmp___3 ;
  unsigned char *tmp___4 ;
  unsigned int *tmp___5 ;
  unsigned char *tmp___6 ;
  unsigned int *tmp___7 ;
  unsigned char *tmp___8 ;
  unsigned int *tmp___9 ;
  unsigned short tmp___10 ;

  {
#line 237
  j = 0U;
  {
#line 237
  while (1) {
    while_continue: /* CIL Label */ ;
#line 237
    if (! (j < h)) {
#line 237
      goto while_break;
    }
#line 239
    sp = src + 1;
#line 240
    dp1 = dst1;
#line 241
    dp2 = (unsigned int *)dst2;
#line 243
    if (bop == 0U) {
      {
#line 247
      if ((int )depth == 16) {
#line 247
        goto case_16;
      }
#line 248
      if ((int )depth == 8) {
#line 248
        goto case_8;
      }
#line 249
      if ((int )depth == 4) {
#line 249
        goto case_4;
      }
#line 250
      if ((int )depth == 2) {
#line 250
        goto case_2;
      }
#line 251
      if ((int )depth == 1) {
#line 251
        goto case_1;
      }
#line 245
      goto switch_break;
      case_16: /* CIL Label */ 
#line 247
      i = 0U;
      {
#line 247
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 247
        if (! (i < w)) {
#line 247
          goto while_break___0;
        }
#line 247
        a = 255U;
#line 247
        if (ts) {
          {
#line 247
          tmp = readshort(sp);
          }
#line 247
          if ((int )tmp == (int )trns1) {
#line 247
            a = 0U;
          }
        }
#line 247
        tmp___0 = dp1;
#line 247
        dp1 ++;
#line 247
        *tmp___0 = *sp;
#line 247
        tmp___1 = dp2;
#line 247
        dp2 ++;
#line 247
        *tmp___1 = (((a << 24) + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
#line 247
        sp += 2;
#line 247
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 247
      goto switch_break;
      case_8: /* CIL Label */ 
#line 248
      i = 0U;
      {
#line 248
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 248
        if (! (i < w)) {
#line 248
          goto while_break___1;
        }
#line 248
        a = 255U;
#line 248
        if (ts) {
#line 248
          if ((int )*sp == (int )trns1) {
#line 248
            a = 0U;
          }
        }
#line 248
        tmp___2 = dp1;
#line 248
        dp1 ++;
#line 248
        *tmp___2 = *sp;
#line 248
        tmp___3 = dp2;
#line 248
        dp2 ++;
#line 248
        *tmp___3 = (((a << 24) + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
#line 248
        sp ++;
#line 248
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
#line 248
      goto switch_break;
      case_4: /* CIL Label */ 
#line 249
      i = 0U;
      {
#line 249
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 249
        if (! (i < w)) {
#line 249
          goto while_break___2;
        }
#line 249
        g = ((unsigned int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U];
#line 249
        a = 255U;
#line 249
        if (ts) {
#line 249
          if (g == (unsigned int )trns1) {
#line 249
            a = 0U;
          }
        }
#line 249
        tmp___4 = dp1;
#line 249
        dp1 ++;
#line 249
        *tmp___4 = (unsigned char )(g * 17U);
#line 249
        tmp___5 = dp2;
#line 249
        dp2 ++;
#line 249
        *tmp___5 = (a << 24) + g * 1118481U;
#line 249
        i ++;
      }
      while_break___2: /* CIL Label */ ;
      }
#line 249
      goto switch_break;
      case_2: /* CIL Label */ 
#line 250
      i = 0U;
      {
#line 250
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 250
        if (! (i < w)) {
#line 250
          goto while_break___3;
        }
#line 250
        g = ((unsigned int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U];
#line 250
        a = 255U;
#line 250
        if (ts) {
#line 250
          if (g == (unsigned int )trns1) {
#line 250
            a = 0U;
          }
        }
#line 250
        tmp___6 = dp1;
#line 250
        dp1 ++;
#line 250
        *tmp___6 = (unsigned char )(g * 85U);
#line 250
        tmp___7 = dp2;
#line 250
        dp2 ++;
#line 250
        *tmp___7 = (a << 24) + g * 5592405U;
#line 250
        i ++;
      }
      while_break___3: /* CIL Label */ ;
      }
#line 250
      goto switch_break;
      case_1: /* CIL Label */ 
#line 251
      i = 0U;
      {
#line 251
      while (1) {
        while_continue___4: /* CIL Label */ ;
#line 251
        if (! (i < w)) {
#line 251
          goto while_break___4;
        }
#line 251
        g = ((unsigned int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U];
#line 251
        a = 255U;
#line 251
        if (ts) {
#line 251
          if (g == (unsigned int )trns1) {
#line 251
            a = 0U;
          }
        }
#line 251
        tmp___8 = dp1;
#line 251
        dp1 ++;
#line 251
        *tmp___8 = (unsigned char )(g * 255U);
#line 251
        tmp___9 = dp2;
#line 251
        dp2 ++;
#line 251
        *tmp___9 = (a << 24) + g * 16777215U;
#line 251
        i ++;
      }
      while_break___4: /* CIL Label */ ;
      }
#line 251
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    } else {
      {
#line 258
      if ((int )depth == 16) {
#line 258
        goto case_16___0;
      }
#line 259
      if ((int )depth == 8) {
#line 259
        goto case_8___0;
      }
#line 260
      if ((int )depth == 4) {
#line 260
        goto case_4___0;
      }
#line 261
      if ((int )depth == 2) {
#line 261
        goto case_2___0;
      }
#line 262
      if ((int )depth == 1) {
#line 262
        goto case_1___0;
      }
#line 256
      goto switch_break___0;
      case_16___0: /* CIL Label */ 
#line 258
      i = 0U;
      {
#line 258
      while (1) {
        while_continue___5: /* CIL Label */ ;
#line 258
        if (! (i < w)) {
#line 258
          goto while_break___5;
        }
        {
#line 258
        tmp___10 = readshort(sp);
        }
#line 258
        if ((int )tmp___10 != (int )trns1) {
#line 258
          *dp1 = *sp;
#line 258
          *dp2 = ((4278190080U + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
        }
#line 258
        sp += 2;
#line 258
        i ++;
#line 258
        dp1 ++;
#line 258
        dp2 ++;
      }
      while_break___5: /* CIL Label */ ;
      }
#line 258
      goto switch_break___0;
      case_8___0: /* CIL Label */ 
#line 259
      i = 0U;
      {
#line 259
      while (1) {
        while_continue___6: /* CIL Label */ ;
#line 259
        if (! (i < w)) {
#line 259
          goto while_break___6;
        }
#line 259
        if ((int )*sp != (int )trns1) {
#line 259
          *dp1 = *sp;
#line 259
          *dp2 = ((4278190080U + (unsigned int )((int )*sp << 16)) + (unsigned int )((int )*sp << 8)) + (unsigned int )*sp;
        }
#line 259
        sp ++;
#line 259
        i ++;
#line 259
        dp1 ++;
#line 259
        dp2 ++;
      }
      while_break___6: /* CIL Label */ ;
      }
#line 259
      goto switch_break___0;
      case_4___0: /* CIL Label */ 
#line 260
      i = 0U;
      {
#line 260
      while (1) {
        while_continue___7: /* CIL Label */ ;
#line 260
        if (! (i < w)) {
#line 260
          goto while_break___7;
        }
#line 260
        g = ((unsigned int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U];
#line 260
        if (g != (unsigned int )trns1) {
#line 260
          *dp1 = (unsigned char )(g * 17U);
#line 260
          *dp2 = 4278190080U + g * 1118481U;
        }
#line 260
        i ++;
#line 260
        dp1 ++;
#line 260
        dp2 ++;
      }
      while_break___7: /* CIL Label */ ;
      }
#line 260
      goto switch_break___0;
      case_2___0: /* CIL Label */ 
#line 261
      i = 0U;
      {
#line 261
      while (1) {
        while_continue___8: /* CIL Label */ ;
#line 261
        if (! (i < w)) {
#line 261
          goto while_break___8;
        }
#line 261
        g = ((unsigned int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U];
#line 261
        if (g != (unsigned int )trns1) {
#line 261
          *dp1 = (unsigned char )(g * 85U);
#line 261
          *dp2 = 4278190080U + g * 5592405U;
        }
#line 261
        i ++;
#line 261
        dp1 ++;
#line 261
        dp2 ++;
      }
      while_break___8: /* CIL Label */ ;
      }
#line 261
      goto switch_break___0;
      case_1___0: /* CIL Label */ 
#line 262
      i = 0U;
      {
#line 262
      while (1) {
        while_continue___9: /* CIL Label */ ;
#line 262
        if (! (i < w)) {
#line 262
          goto while_break___9;
        }
#line 262
        g = ((unsigned int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U];
#line 262
        if (g != (unsigned int )trns1) {
#line 262
          *dp1 = (unsigned char )(g * 255U);
#line 262
          *dp2 = 4278190080U + g * 16777215U;
        }
#line 262
        i ++;
#line 262
        dp1 ++;
#line 262
        dp2 ++;
      }
      while_break___9: /* CIL Label */ ;
      }
#line 262
      goto switch_break___0;
      switch_break___0: /* CIL Label */ ;
      }
    }
#line 266
    src += srcbytes;
#line 267
    dst1 += dstbytes1;
#line 268
    dst2 += dstbytes2;
#line 237
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 270
  return;
}
}
#line 272 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void compose2(unsigned char *dst1 , unsigned int dstbytes1 , unsigned char *dst2 ,
              unsigned int dstbytes2 , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned char *sp ;
  unsigned char *dp1 ;
  unsigned int *dp2 ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned char *tmp___2 ;
  unsigned char *tmp___3 ;
  unsigned char *tmp___4 ;
  unsigned int *tmp___5 ;
  unsigned short tmp___6 ;
  unsigned short tmp___7 ;
  unsigned short tmp___8 ;
  unsigned char *tmp___9 ;
  unsigned char *tmp___10 ;
  unsigned char *tmp___11 ;
  unsigned int *tmp___12 ;
  unsigned short tmp___13 ;
  unsigned short tmp___14 ;
  unsigned short tmp___15 ;

  {
#line 280
  j = 0U;
  {
#line 280
  while (1) {
    while_continue: /* CIL Label */ ;
#line 280
    if (! (j < h)) {
#line 280
      goto while_break;
    }
#line 282
    sp = src + 1;
#line 283
    dp1 = dst1;
#line 284
    dp2 = (unsigned int *)dst2;
#line 286
    if (bop == 0U) {
#line 288
      if ((int )depth == 8) {
#line 290
        i = 0U;
        {
#line 290
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 290
          if (! (i < w)) {
#line 290
            goto while_break___0;
          }
#line 292
          tmp = sp;
#line 292
          sp ++;
#line 292
          r = (unsigned int )*tmp;
#line 293
          tmp___0 = sp;
#line 293
          sp ++;
#line 293
          g = (unsigned int )*tmp___0;
#line 294
          tmp___1 = sp;
#line 294
          sp ++;
#line 294
          b = (unsigned int )*tmp___1;
#line 295
          a = 255U;
#line 296
          if (ts) {
#line 296
            if (r == (unsigned int )trns1) {
#line 296
              if (g == (unsigned int )trns2) {
#line 296
                if (b == (unsigned int )trns3) {
#line 297
                  a = 0U;
                }
              }
            }
          }
#line 298
          tmp___2 = dp1;
#line 298
          dp1 ++;
#line 298
          *tmp___2 = (unsigned char )r;
#line 298
          tmp___3 = dp1;
#line 298
          dp1 ++;
#line 298
          *tmp___3 = (unsigned char )g;
#line 298
          tmp___4 = dp1;
#line 298
          dp1 ++;
#line 298
          *tmp___4 = (unsigned char )b;
#line 299
          tmp___5 = dp2;
#line 299
          dp2 ++;
#line 299
          *tmp___5 = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 290
          i ++;
        }
        while_break___0: /* CIL Label */ ;
        }
      } else {
#line 304
        i = 0U;
        {
#line 304
        while (1) {
          while_continue___1: /* CIL Label */ ;
#line 304
          if (! (i < w)) {
#line 304
            goto while_break___1;
          }
#line 306
          r = (unsigned int )*sp;
#line 307
          g = (unsigned int )*(sp + 2);
#line 308
          b = (unsigned int )*(sp + 4);
#line 309
          a = 255U;
#line 310
          if (ts) {
            {
#line 310
            tmp___6 = readshort(sp);
            }
#line 310
            if ((int )tmp___6 == (int )trns1) {
              {
#line 310
              tmp___7 = readshort(sp + 2);
              }
#line 310
              if ((int )tmp___7 == (int )trns2) {
                {
#line 310
                tmp___8 = readshort(sp + 4);
                }
#line 310
                if ((int )tmp___8 == (int )trns3) {
#line 311
                  a = 0U;
                }
              }
            }
          }
#line 312
          tmp___9 = dp1;
#line 312
          dp1 ++;
#line 312
          *tmp___9 = (unsigned char )r;
#line 312
          tmp___10 = dp1;
#line 312
          dp1 ++;
#line 312
          *tmp___10 = (unsigned char )g;
#line 312
          tmp___11 = dp1;
#line 312
          dp1 ++;
#line 312
          *tmp___11 = (unsigned char )b;
#line 313
          tmp___12 = dp2;
#line 313
          dp2 ++;
#line 313
          *tmp___12 = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 304
          i ++;
#line 304
          sp += 6;
        }
        while_break___1: /* CIL Label */ ;
        }
      }
    } else
#line 319
    if ((int )depth == 8) {
#line 321
      i = 0U;
      {
#line 321
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 321
        if (! (i < w)) {
#line 321
          goto while_break___2;
        }
#line 322
        if ((int )*sp != (int )trns1) {
#line 324
          *dp1 = *sp;
#line 324
          *(dp1 + 1) = *(sp + 1);
#line 324
          *(dp1 + 2) = *(sp + 2);
#line 325
          *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        } else
#line 322
        if ((int )*(sp + 1) != (int )trns2) {
#line 324
          *dp1 = *sp;
#line 324
          *(dp1 + 1) = *(sp + 1);
#line 324
          *(dp1 + 2) = *(sp + 2);
#line 325
          *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        } else
#line 322
        if ((int )*(sp + 2) != (int )trns3) {
#line 324
          *dp1 = *sp;
#line 324
          *(dp1 + 1) = *(sp + 1);
#line 324
          *(dp1 + 2) = *(sp + 2);
#line 325
          *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 2) << 16)) + (unsigned int )((int )*(sp + 1) << 8)) + (unsigned int )*sp;
        }
#line 321
        i ++;
#line 321
        sp += 3;
#line 321
        dp1 += 3;
#line 321
        dp2 ++;
      }
      while_break___2: /* CIL Label */ ;
      }
    } else {
#line 330
      i = 0U;
      {
#line 330
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 330
        if (! (i < w)) {
#line 330
          goto while_break___3;
        }
        {
#line 331
        tmp___13 = readshort(sp);
        }
#line 331
        if ((int )tmp___13 != (int )trns1) {
#line 333
          *dp1 = *sp;
#line 333
          *(dp1 + 1) = *(sp + 2);
#line 333
          *(dp1 + 2) = *(sp + 4);
#line 334
          *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
        } else {
          {
#line 331
          tmp___14 = readshort(sp + 2);
          }
#line 331
          if ((int )tmp___14 != (int )trns2) {
#line 333
            *dp1 = *sp;
#line 333
            *(dp1 + 1) = *(sp + 2);
#line 333
            *(dp1 + 2) = *(sp + 4);
#line 334
            *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
          } else {
            {
#line 331
            tmp___15 = readshort(sp + 4);
            }
#line 331
            if ((int )tmp___15 != (int )trns3) {
#line 333
              *dp1 = *sp;
#line 333
              *(dp1 + 1) = *(sp + 2);
#line 333
              *(dp1 + 2) = *(sp + 4);
#line 334
              *dp2 = ((4278190080U + (unsigned int )((int )*(sp + 4) << 16)) + (unsigned int )((int )*(sp + 2) << 8)) + (unsigned int )*sp;
            }
          }
        }
#line 330
        i ++;
#line 330
        sp += 6;
#line 330
        dp1 += 3;
#line 330
        dp2 ++;
      }
      while_break___3: /* CIL Label */ ;
      }
    }
#line 338
    src += srcbytes;
#line 339
    dst1 += dstbytes1;
#line 340
    dst2 += dstbytes2;
#line 280
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 342
  return;
}
}
#line 344 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void compose3(unsigned char *dst1 , unsigned int dstbytes1 , unsigned char *dst2 ,
              unsigned int dstbytes2 , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned int r2 ;
  unsigned int g2 ;
  unsigned int b2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char col___0 ;
  unsigned char *sp ;
  unsigned char *dp1 ;
  unsigned int *dp2 ;
  unsigned char *tmp ;
  unsigned int *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned int *tmp___2 ;
  unsigned char *tmp___3 ;
  unsigned int *tmp___4 ;

  {
#line 355
  j = 0U;
  {
#line 355
  while (1) {
    while_continue: /* CIL Label */ ;
#line 355
    if (! (j < h)) {
#line 355
      goto while_break;
    }
#line 357
    sp = src + 1;
#line 358
    dp1 = dst1;
#line 359
    dp2 = (unsigned int *)dst2;
#line 361
    i = 0U;
    {
#line 361
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 361
      if (! (i < w)) {
#line 361
        goto while_break___0;
      }
      {
#line 365
      if ((int )depth == 1) {
#line 365
        goto case_1;
      }
#line 366
      if ((int )depth == 2) {
#line 366
        goto case_2;
      }
#line 367
      if ((int )depth == 4) {
#line 367
        goto case_4;
      }
#line 368
      goto switch_default;
      case_1: /* CIL Label */ 
#line 365
      col___0 = (unsigned char )(((unsigned int )*(sp + (i >> 3)) & mask1[i & 7U]) >> shift1[i & 7U]);
#line 365
      goto switch_break;
      case_2: /* CIL Label */ 
#line 366
      col___0 = (unsigned char )(((unsigned int )*(sp + (i >> 2)) & mask2[i & 3U]) >> shift2[i & 3U]);
#line 366
      goto switch_break;
      case_4: /* CIL Label */ 
#line 367
      col___0 = (unsigned char )(((unsigned int )*(sp + (i >> 1)) & mask4[i & 1U]) >> shift4[i & 1U]);
#line 367
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 368
      col___0 = *(sp + i);
      switch_break: /* CIL Label */ ;
      }
#line 371
      r = (unsigned int )pl[col___0][0];
#line 372
      g = (unsigned int )pl[col___0][1];
#line 373
      b = (unsigned int )pl[col___0][2];
#line 374
      a = (unsigned int )tr[col___0];
#line 376
      if (bop == 0U) {
#line 378
        tmp = dp1;
#line 378
        dp1 ++;
#line 378
        *tmp = col___0;
#line 379
        tmp___0 = dp2;
#line 379
        dp2 ++;
#line 379
        *tmp___0 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else
#line 383
      if (a == 255U) {
#line 385
        tmp___1 = dp1;
#line 385
        dp1 ++;
#line 385
        *tmp___1 = col___0;
#line 386
        tmp___2 = dp2;
#line 386
        dp2 ++;
#line 386
        *tmp___2 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else
#line 389
      if (a != 0U) {
#line 391
        a2 = *dp2 >> 24;
#line 391
        if (a2 != 0U) {
#line 393
          keep_original = 0;
#line 394
          u = (int )(a * 255U);
#line 395
          v = (int )((255U - a) * a2);
#line 396
          al = (int )(65025U - (255U - a) * (255U - a2));
#line 397
          r2 = *dp2 & 255U;
#line 398
          g2 = (*dp2 >> 8) & 255U;
#line 399
          b2 = (*dp2 >> 16) & 255U;
#line 400
          r = (r * (unsigned int )u + r2 * (unsigned int )v) / (unsigned int )al;
#line 401
          g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 402
          b = (b * (unsigned int )u + b2 * (unsigned int )v) / (unsigned int )al;
#line 403
          a = (unsigned int )(al / 255);
        }
#line 405
        tmp___3 = dp1;
#line 405
        dp1 ++;
#line 405
        *tmp___3 = col___0;
#line 406
        tmp___4 = dp2;
#line 406
        dp2 ++;
#line 406
        *tmp___4 = (((a << 24) + (b << 16)) + (g << 8)) + r;
      } else {
#line 410
        dp1 ++;
#line 411
        dp2 ++;
      }
#line 361
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 415
    src += srcbytes;
#line 416
    dst1 += dstbytes1;
#line 417
    dst2 += dstbytes2;
#line 355
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 419
  return;
}
}
#line 421 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void compose4(unsigned char *dst , unsigned int dstbytes , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int step ;
  unsigned int g ;
  unsigned int a ;
  unsigned int g2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char *sp ;
  unsigned char *dp ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned char *tmp___2 ;
  unsigned char *tmp___3 ;
  unsigned char *tmp___4 ;

  {
#line 429
  step = (unsigned int )(((int )depth + 7) / 8);
#line 431
  j = 0U;
  {
#line 431
  while (1) {
    while_continue: /* CIL Label */ ;
#line 431
    if (! (j < h)) {
#line 431
      goto while_break;
    }
#line 433
    sp = src + 1;
#line 434
    dp = dst;
#line 436
    if (bop == 0U) {
#line 438
      i = 0U;
      {
#line 438
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 438
        if (! (i < w)) {
#line 438
          goto while_break___0;
        }
#line 440
        g = (unsigned int )*sp;
#line 440
        sp += step;
#line 441
        a = (unsigned int )*sp;
#line 441
        sp += step;
#line 442
        tmp = dp;
#line 442
        dp ++;
#line 442
        *tmp = (unsigned char )g;
#line 443
        tmp___0 = dp;
#line 443
        dp ++;
#line 443
        *tmp___0 = (unsigned char )a;
#line 438
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
#line 448
      i = 0U;
      {
#line 448
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 448
        if (! (i < w)) {
#line 448
          goto while_break___1;
        }
#line 450
        g = (unsigned int )*sp;
#line 450
        sp += step;
#line 451
        a = (unsigned int )*sp;
#line 451
        sp += step;
#line 452
        if (a == 255U) {
#line 454
          tmp___1 = dp;
#line 454
          dp ++;
#line 454
          *tmp___1 = (unsigned char )g;
#line 455
          tmp___2 = dp;
#line 455
          dp ++;
#line 455
          *tmp___2 = (unsigned char )a;
        } else
#line 458
        if (a != 0U) {
#line 460
          a2 = (unsigned int )*(dp + 1);
#line 460
          if (a2 != 0U) {
#line 462
            u = (int )(a * 255U);
#line 463
            v = (int )((255U - a) * a2);
#line 464
            al = (int )(65025U - (255U - a) * (255U - a2));
#line 465
            g2 = (unsigned int )((int )*dp & 255);
#line 466
            g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 467
            a = (unsigned int )(al / 255);
          }
#line 469
          tmp___3 = dp;
#line 469
          dp ++;
#line 469
          *tmp___3 = (unsigned char )g;
#line 470
          tmp___4 = dp;
#line 470
          dp ++;
#line 470
          *tmp___4 = (unsigned char )a;
        } else {
#line 473
          dp += 2;
        }
#line 448
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 476
    src += srcbytes;
#line 477
    dst += dstbytes;
#line 431
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 479
  return;
}
}
#line 481 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void compose6(unsigned char *dst , unsigned int dstbytes , unsigned char *src , unsigned int srcbytes ,
              unsigned int w , unsigned int h , unsigned int bop , unsigned char depth ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int step ;
  unsigned int r ;
  unsigned int g ;
  unsigned int b ;
  unsigned int a ;
  unsigned int r2 ;
  unsigned int g2 ;
  unsigned int b2 ;
  unsigned int a2 ;
  int u ;
  int v ;
  int al ;
  unsigned char *sp ;
  unsigned int *dp ;
  unsigned int *tmp ;
  unsigned int *tmp___0 ;
  unsigned int *tmp___1 ;

  {
#line 490
  step = (unsigned int )(((int )depth + 7) / 8);
#line 492
  j = 0U;
  {
#line 492
  while (1) {
    while_continue: /* CIL Label */ ;
#line 492
    if (! (j < h)) {
#line 492
      goto while_break;
    }
#line 494
    sp = src + 1;
#line 495
    dp = (unsigned int *)dst;
#line 497
    if (bop == 0U) {
#line 499
      i = 0U;
      {
#line 499
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 499
        if (! (i < w)) {
#line 499
          goto while_break___0;
        }
#line 501
        r = (unsigned int )*sp;
#line 501
        sp += step;
#line 502
        g = (unsigned int )*sp;
#line 502
        sp += step;
#line 503
        b = (unsigned int )*sp;
#line 503
        sp += step;
#line 504
        a = (unsigned int )*sp;
#line 504
        sp += step;
#line 505
        tmp = dp;
#line 505
        dp ++;
#line 505
        *tmp = (((a << 24) + (b << 16)) + (g << 8)) + r;
#line 499
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
#line 510
      i = 0U;
      {
#line 510
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 510
        if (! (i < w)) {
#line 510
          goto while_break___1;
        }
#line 512
        r = (unsigned int )*sp;
#line 512
        sp += step;
#line 513
        g = (unsigned int )*sp;
#line 513
        sp += step;
#line 514
        b = (unsigned int )*sp;
#line 514
        sp += step;
#line 515
        a = (unsigned int )*sp;
#line 515
        sp += step;
#line 516
        if (a == 255U) {
#line 517
          tmp___0 = dp;
#line 517
          dp ++;
#line 517
          *tmp___0 = (((a << 24) + (b << 16)) + (g << 8)) + r;
        } else
#line 519
        if (a != 0U) {
#line 521
          a2 = *dp >> 24;
#line 521
          if (a2 != 0U) {
#line 523
            u = (int )(a * 255U);
#line 524
            v = (int )((255U - a) * a2);
#line 525
            al = (int )(65025U - (255U - a) * (255U - a2));
#line 526
            r2 = *dp & 255U;
#line 527
            g2 = (*dp >> 8) & 255U;
#line 528
            b2 = (*dp >> 16) & 255U;
#line 529
            r = (r * (unsigned int )u + r2 * (unsigned int )v) / (unsigned int )al;
#line 530
            g = (g * (unsigned int )u + g2 * (unsigned int )v) / (unsigned int )al;
#line 531
            b = (b * (unsigned int )u + b2 * (unsigned int )v) / (unsigned int )al;
#line 532
            a = (unsigned int )(al / 255);
          }
#line 534
          tmp___1 = dp;
#line 534
          dp ++;
#line 534
          *tmp___1 = (((a << 24) + (b << 16)) + (g << 8)) + r;
        } else {
#line 537
          dp ++;
        }
#line 510
        i ++;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 540
    src += srcbytes;
#line 541
    dst += dstbytes;
#line 492
    j ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 543
  return;
}
}
#line 545 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int LoadAPNG(char *szIn , unsigned int *pWidth , unsigned int *pHeight , unsigned char *pColType ,
             unsigned int *pFirst , unsigned int *pFrames , unsigned int *pLoops ,
             unsigned char **ppOut1 , unsigned char **ppOut2 , unsigned short **ppDelayNum ,
             unsigned short **ppDelayDen ) 
{ 
  unsigned char sig[8] ;
  unsigned int i ;
  unsigned int j ;
  unsigned int w ;
  unsigned int h ;
  unsigned int len ;
  unsigned int chunk ;
  unsigned int seq ;
  unsigned int crc ;
  unsigned int w0 ;
  unsigned int h0 ;
  unsigned int x0 ;
  unsigned int y0 ;
  unsigned int frames ;
  unsigned int loops ;
  unsigned int first_visible ;
  unsigned int cur_frame ;
  unsigned int rowbytes ;
  unsigned int channels ;
  unsigned int outrow1 ;
  unsigned int outrow2 ;
  unsigned int outimg1 ;
  unsigned int outimg2 ;
  unsigned int imagesize ;
  unsigned int zbuf_size ;
  unsigned int zsize ;
  unsigned char depth ;
  unsigned char coltype ;
  unsigned char compr ;
  unsigned char filter ;
  unsigned char interl ;
  unsigned char pixeldepth ;
  unsigned char bpp ;
  unsigned short d1 ;
  unsigned short d2 ;
  unsigned char c ;
  unsigned char dop ;
  unsigned char bop ;
  z_stream zstream ;
  unsigned char *pOut1 ;
  unsigned char *pOut2 ;
  unsigned char *pTemp ;
  unsigned char *pData ;
  unsigned char *pImg1 ;
  unsigned char *pImg2 ;
  unsigned char *pDst1 ;
  unsigned char *pDst2 ;
  unsigned short *pDelayNum ;
  unsigned short *pDelayDen ;
  FILE *f1 ;
  int res ;
  size_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  size_t tmp___7 ;
  size_t tmp___8 ;
  size_t tmp___9 ;
  int tmp___10 ;
  void *tmp___11 ;
  void *tmp___12 ;
  void *tmp___13 ;
  void *tmp___14 ;
  void *tmp___15 ;
  void *tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  unsigned int col___0 ;
  size_t tmp___19 ;
  int tmp___20 ;
  size_t tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  void *tmp___26 ;
  void *tmp___27 ;
  void *tmp___28 ;
  void *tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;
  size_t tmp___37 ;
  size_t tmp___38 ;
  int tmp___39 ;
  size_t tmp___40 ;
  int tmp___41 ;
  int tmp___42 ;
  size_t tmp___43 ;
  int tmp___44 ;
  int tmp___45 ;
  int tmp___46 ;

  {
  {
#line 571
  res = 1;
#line 573
  f1 = fopen((char const   */* __restrict  */)szIn, (char const   */* __restrict  */)"rb");
  }
#line 573
  if ((unsigned long )f1 == (unsigned long )((FILE *)0)) {
    {
#line 575
    printf((char const   */* __restrict  */)"Error: can\'t open \'%s\'\n", szIn);
    }
#line 576
    return (res);
  }
  {
#line 579
  printf((char const   */* __restrict  */)"Reading \'%s\'...\n", szIn);
#line 581
  frames = 0U;
#line 582
  loops = 0U;
#line 583
  first_visible = 0U;
#line 584
  cur_frame = 0U;
#line 585
  zsize = 0U;
#line 586
  x0 = 0U;
#line 587
  y0 = 0U;
#line 588
  bop = (unsigned char)0;
#line 589
  ps = 0;
#line 590
  ts = 0;
#line 591
  trns_idx = -1;
#line 593
  memset((void *)(tr), 255, (size_t )256);
#line 595
  zstream.zalloc = (voidpf (*)(voidpf opaque , uInt items , uInt size ))0;
#line 596
  zstream.zfree = (void (*)(voidpf opaque , voidpf address ))0;
#line 597
  zstream.opaque = (voidpf )0;
#line 598
  inflateInit_(& zstream, "1.2.8", (int )sizeof(z_stream ));
  }
  {
#line 600
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 602
    tmp = fread((void */* __restrict  */)(sig), (size_t )1, (size_t )8, (FILE */* __restrict  */)f1);
    }
#line 602
    if (tmp != 8UL) {
      {
#line 604
      printf((char const   */* __restrict  */)"Error: can\'t read the sig\n");
      }
#line 605
      goto while_break;
    }
    {
#line 607
    tmp___0 = memcmp((void const   *)(sig), (void const   *)(png_sign), (size_t )8);
    }
#line 607
    if (tmp___0 != 0) {
      {
#line 609
      printf((char const   */* __restrict  */)"Error: wrong PNG sig\n");
      }
#line 610
      goto while_break;
    }
    {
#line 613
    tmp___1 = read32(& len, f1);
    }
#line 613
    if (tmp___1) {
#line 613
      goto while_break;
    }
    {
#line 614
    tmp___2 = read32(& chunk, f1);
    }
#line 614
    if (tmp___2) {
#line 614
      goto while_break;
    }
#line 616
    if (len != 13U) {
      {
#line 618
      printf((char const   */* __restrict  */)"Error: missing IHDR\n");
      }
#line 619
      goto while_break;
    } else
#line 616
    if (chunk != 1229472850U) {
      {
#line 618
      printf((char const   */* __restrict  */)"Error: missing IHDR\n");
      }
#line 619
      goto while_break;
    }
    {
#line 622
    tmp___3 = read32(& w, f1);
    }
#line 622
    if (tmp___3) {
#line 622
      goto while_break;
    }
    {
#line 623
    tmp___4 = read32(& h, f1);
    }
#line 623
    if (tmp___4) {
#line 623
      goto while_break;
    }
    {
#line 624
    w0 = w;
#line 625
    h0 = h;
#line 626
    tmp___5 = fread((void */* __restrict  */)(& depth), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 626
    if (tmp___5 != 1UL) {
#line 626
      goto while_break;
    }
    {
#line 627
    tmp___6 = fread((void */* __restrict  */)(& coltype), (size_t )1, (size_t )1,
                    (FILE */* __restrict  */)f1);
    }
#line 627
    if (tmp___6 != 1UL) {
#line 627
      goto while_break;
    }
    {
#line 628
    tmp___7 = fread((void */* __restrict  */)(& compr), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 628
    if (tmp___7 != 1UL) {
#line 628
      goto while_break;
    }
    {
#line 629
    tmp___8 = fread((void */* __restrict  */)(& filter), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 629
    if (tmp___8 != 1UL) {
#line 629
      goto while_break;
    }
    {
#line 630
    tmp___9 = fread((void */* __restrict  */)(& interl), (size_t )1, (size_t )1, (FILE */* __restrict  */)f1);
    }
#line 630
    if (tmp___9 != 1UL) {
#line 630
      goto while_break;
    }
    {
#line 631
    tmp___10 = read32(& crc, f1);
    }
#line 631
    if (tmp___10) {
#line 631
      goto while_break;
    }
#line 633
    channels = 1U;
#line 634
    if ((int )coltype == 2) {
#line 635
      channels = 3U;
    } else
#line 637
    if ((int )coltype == 4) {
#line 638
      channels = 2U;
    } else
#line 640
    if ((int )coltype == 6) {
#line 641
      channels = 4U;
    }
#line 643
    pixeldepth = (unsigned char )((unsigned int )depth * channels);
#line 644
    bpp = (unsigned char )(((int )pixeldepth + 7) >> 3);
#line 645
    if ((int )pixeldepth >= 8) {
#line 645
      rowbytes = w * ((unsigned int )pixeldepth >> 3);
    } else {
#line 645
      rowbytes = (w * (unsigned int )pixeldepth + 7U) >> 3;
    }
    {
#line 647
    imagesize = (rowbytes + 1U) * h;
#line 648
    zbuf_size = ((imagesize + ((imagesize + 7U) >> 3)) + ((imagesize + 63U) >> 6)) + 11U;
#line 658
    outrow1 = w * channels;
#line 659
    outrow2 = w * 4U;
#line 660
    outimg1 = h * outrow1;
#line 661
    outimg2 = h * outrow2;
#line 663
    tmp___11 = malloc((size_t )((frames + 1U) * outimg1));
#line 663
    pOut1 = (unsigned char *)tmp___11;
#line 664
    tmp___12 = malloc((size_t )((frames + 1U) * outimg2));
#line 664
    pOut2 = (unsigned char *)tmp___12;
#line 665
    tmp___13 = malloc((size_t )((frames + 1U) * 2U));
#line 665
    pDelayNum = (unsigned short *)tmp___13;
#line 666
    tmp___14 = malloc((size_t )((frames + 1U) * 2U));
#line 666
    pDelayDen = (unsigned short *)tmp___14;
#line 667
    tmp___15 = malloc((size_t )imagesize);
#line 667
    pTemp = (unsigned char *)tmp___15;
#line 668
    tmp___16 = malloc((size_t )zbuf_size);
#line 668
    pData = (unsigned char *)tmp___16;
    }
#line 669
    if (! pOut1) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    } else
#line 669
    if (! pOut2) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    } else
#line 669
    if (! pDelayNum) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    } else
#line 669
    if (! pDelayDen) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    } else
#line 669
    if (! pTemp) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    } else
#line 669
    if (! pData) {
      {
#line 671
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 672
      goto while_break;
    }
    {
#line 675
    pImg1 = pOut1;
#line 676
    pImg2 = pOut2;
#line 677
    memset((void *)pOut1, 0, (size_t )outimg1);
#line 678
    memset((void *)pOut2, 0, (size_t )outimg2);
#line 679
    *(pDelayNum + 0) = (unsigned short)0;
#line 680
    *(pDelayDen + 0) = (unsigned short)0;
    }
    {
#line 682
    while (1) {
      while_continue___0: /* CIL Label */ ;
      {
#line 682
      tmp___46 = feof(f1);
      }
#line 682
      if (tmp___46) {
#line 682
        goto while_break___0;
      }
      {
#line 684
      tmp___17 = read32(& len, f1);
      }
#line 684
      if (tmp___17) {
#line 684
        goto while_break___0;
      }
      {
#line 685
      tmp___18 = read32(& chunk, f1);
      }
#line 685
      if (tmp___18) {
#line 685
        goto while_break___0;
      }
#line 687
      if (chunk == 1347179589U) {
#line 690
        i = 0U;
        {
#line 690
        while (1) {
          while_continue___1: /* CIL Label */ ;
#line 690
          if (! (i < len)) {
#line 690
            goto while_break___1;
          }
          {
#line 692
          tmp___19 = fread((void */* __restrict  */)(& c), (size_t )1, (size_t )1,
                           (FILE */* __restrict  */)f1);
          }
#line 692
          if (tmp___19 != 1UL) {
#line 692
            goto while_break___1;
          }
#line 693
          col___0 = i / 3U;
#line 694
          if (col___0 < 256U) {
#line 696
            pl[col___0][i % 3U] = c;
#line 697
            ps = (int )(col___0 + 1U);
          }
#line 690
          i ++;
        }
        while_break___1: /* CIL Label */ ;
        }
        {
#line 700
        tmp___20 = read32(& crc, f1);
        }
#line 700
        if (tmp___20) {
#line 700
          goto while_break___0;
        }
      } else
#line 703
      if (chunk == 1951551059U) {
#line 705
        i = 0U;
        {
#line 705
        while (1) {
          while_continue___2: /* CIL Label */ ;
#line 705
          if (! (i < len)) {
#line 705
            goto while_break___2;
          }
          {
#line 707
          tmp___21 = fread((void */* __restrict  */)(& c), (size_t )1, (size_t )1,
                           (FILE */* __restrict  */)f1);
          }
#line 707
          if (tmp___21 != 1UL) {
#line 707
            goto while_break___2;
          }
#line 708
          if (i < 256U) {
#line 710
            tr[i] = c;
#line 711
            ts = (int )(i + 1U);
#line 712
            if ((int )c == 0) {
#line 712
              if ((int )coltype == 3) {
#line 712
                if (trns_idx == -1) {
#line 713
                  trns_idx = (int )i;
                }
              }
            }
          }
#line 705
          i ++;
        }
        while_break___2: /* CIL Label */ ;
        }
#line 716
        if ((int )coltype == 0) {
#line 718
          if (ts == 2) {
            {
#line 720
            trns1 = readshort(& tr[0]);
            }
            {
#line 723
            if ((int )depth == 16) {
#line 723
              goto case_16;
            }
#line 724
            if ((int )depth == 4) {
#line 724
              goto case_4;
            }
#line 725
            if ((int )depth == 2) {
#line 725
              goto case_2;
            }
#line 726
            if ((int )depth == 1) {
#line 726
              goto case_1;
            }
#line 721
            goto switch_break;
            case_16: /* CIL Label */ 
#line 723
            tr[1] = tr[0];
#line 723
            tr[0] = (unsigned char)0;
#line 723
            goto switch_break;
            case_4: /* CIL Label */ 
#line 724
            tr[1] = (unsigned char )((int )tr[1] * 17);
#line 724
            goto switch_break;
            case_2: /* CIL Label */ 
#line 725
            tr[1] = (unsigned char )((int )tr[1] * 85);
#line 725
            goto switch_break;
            case_1: /* CIL Label */ 
#line 726
            tr[1] = (unsigned char )((int )tr[1] * 255);
#line 726
            goto switch_break;
            switch_break: /* CIL Label */ ;
            }
#line 728
            trns_idx = (int )tr[1];
          } else {
#line 731
            ts = 0;
          }
        } else
#line 734
        if ((int )coltype == 2) {
#line 736
          if (ts == 6) {
            {
#line 738
            trns1 = readshort(& tr[0]);
#line 739
            trns2 = readshort(& tr[2]);
#line 740
            trns3 = readshort(& tr[4]);
            }
#line 741
            if ((int )depth == 16) {
#line 743
              tr[1] = tr[0];
#line 743
              tr[0] = (unsigned char)0;
#line 744
              tr[3] = tr[2];
#line 744
              tr[2] = (unsigned char)0;
#line 745
              tr[5] = tr[4];
#line 745
              tr[4] = (unsigned char)0;
            }
          } else {
#line 749
            ts = 0;
          }
        }
        {
#line 751
        tmp___22 = read32(& crc, f1);
        }
#line 751
        if (tmp___22) {
#line 751
          goto while_break___0;
        }
      } else
#line 754
      if (chunk == 1633899596U) {
        {
#line 756
        tmp___23 = read32(& frames, f1);
        }
#line 756
        if (tmp___23) {
#line 756
          goto while_break___0;
        }
        {
#line 757
        tmp___24 = read32(& loops, f1);
        }
#line 757
        if (tmp___24) {
#line 757
          goto while_break___0;
        }
        {
#line 758
        tmp___25 = read32(& crc, f1);
        }
#line 758
        if (tmp___25) {
#line 758
          goto while_break___0;
        }
        {
#line 759
        free((void *)pOut1);
#line 760
        free((void *)pOut2);
#line 761
        free((void *)pDelayNum);
#line 762
        free((void *)pDelayDen);
#line 763
        tmp___26 = malloc((size_t )((frames + 1U) * outimg1));
#line 763
        pOut1 = (unsigned char *)tmp___26;
#line 764
        tmp___27 = malloc((size_t )((frames + 1U) * outimg2));
#line 764
        pOut2 = (unsigned char *)tmp___27;
#line 765
        tmp___28 = malloc((size_t )((frames + 1U) * 2U));
#line 765
        pDelayNum = (unsigned short *)tmp___28;
#line 766
        tmp___29 = malloc((size_t )((frames + 1U) * 2U));
#line 766
        pDelayDen = (unsigned short *)tmp___29;
#line 767
        pImg1 = pOut1;
#line 768
        pImg2 = pOut2;
#line 769
        memset((void *)pOut1, 0, (size_t )outimg1);
#line 770
        memset((void *)pOut2, 0, (size_t )outimg2);
        }
      } else
#line 773
      if (chunk == 1717785676U) {
#line 775
        if (zsize == 0U) {
#line 776
          first_visible = 1U;
        } else {
#line 779
          if ((int )dop == 2) {
#line 781
            if ((int )coltype != 6) {
              {
#line 782
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            }
#line 783
            if ((int )coltype != 4) {
              {
#line 784
              memcpy((void */* __restrict  */)(pImg2 + outimg2), (void const   */* __restrict  */)pImg2,
                     (size_t )outimg2);
              }
            }
          }
          {
#line 787
          pDst1 = (pImg1 + y0 * outrow1) + x0 * channels;
#line 788
          pDst2 = (pImg2 + y0 * outrow2) + x0 * 4U;
#line 789
          unpack(zstream, pTemp, imagesize, pData, zsize, h0, rowbytes, bpp);
          }
          {
#line 792
          if ((int )coltype == 0) {
#line 792
            goto case_0;
          }
#line 793
          if ((int )coltype == 2) {
#line 793
            goto case_2___0;
          }
#line 794
          if ((int )coltype == 3) {
#line 794
            goto case_3;
          }
#line 795
          if ((int )coltype == 4) {
#line 795
            goto case_4___0;
          }
#line 796
          if ((int )coltype == 6) {
#line 796
            goto case_6;
          }
#line 790
          goto switch_break___0;
          case_0: /* CIL Label */ 
          {
#line 792
          compose0(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 792
          goto switch_break___0;
          case_2___0: /* CIL Label */ 
          {
#line 793
          compose2(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 793
          goto switch_break___0;
          case_3: /* CIL Label */ 
          {
#line 794
          compose3(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 794
          goto switch_break___0;
          case_4___0: /* CIL Label */ 
          {
#line 795
          compose4(pDst1, outrow1, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 795
          goto switch_break___0;
          case_6: /* CIL Label */ 
          {
#line 796
          compose6(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                   depth);
          }
#line 796
          goto switch_break___0;
          switch_break___0: /* CIL Label */ ;
          }
#line 798
          zsize = 0U;
#line 800
          if ((int )dop != 2) {
#line 802
            if ((int )coltype != 6) {
              {
#line 803
              memcpy((void */* __restrict  */)(pImg1 + outimg1), (void const   */* __restrict  */)pImg1,
                     (size_t )outimg1);
              }
            }
#line 804
            if ((int )coltype != 4) {
              {
#line 805
              memcpy((void */* __restrict  */)(pImg2 + outimg2), (void const   */* __restrict  */)pImg2,
                     (size_t )outimg2);
              }
            }
#line 807
            if ((int )dop == 1) {
#line 809
              pDst1 += outimg1;
#line 810
              pDst2 += outimg2;
#line 812
              j = 0U;
              {
#line 812
              while (1) {
                while_continue___3: /* CIL Label */ ;
#line 812
                if (! (j < h0)) {
#line 812
                  goto while_break___3;
                }
                {
#line 816
                if ((int )coltype == 0) {
#line 816
                  goto case_0___0;
                }
#line 817
                if ((int )coltype == 2) {
#line 817
                  goto case_2___1;
                }
#line 818
                if ((int )coltype == 3) {
#line 818
                  goto case_3___0;
                }
#line 819
                if ((int )coltype == 4) {
#line 819
                  goto case_4___1;
                }
#line 820
                if ((int )coltype == 6) {
#line 820
                  goto case_6___0;
                }
#line 814
                goto switch_break___1;
                case_0___0: /* CIL Label */ 
                {
#line 816
                memset((void *)pDst2, 0, (size_t )(w0 * 4U));
                }
#line 816
                if (ts) {
                  {
#line 816
                  memset((void *)pDst1, trns_idx, (size_t )w0);
                  }
                } else {
#line 816
                  keep_original = 0;
                }
#line 816
                goto switch_break___1;
                case_2___1: /* CIL Label */ 
                {
#line 817
                memset((void *)pDst2, 0, (size_t )(w0 * 4U));
                }
#line 817
                if (ts) {
#line 817
                  i = 0U;
                  {
#line 817
                  while (1) {
                    while_continue___4: /* CIL Label */ ;
#line 817
                    if (! (i < w0)) {
#line 817
                      goto while_break___4;
                    }
#line 817
                    *(pDst1 + i * 3U) = tr[1];
#line 817
                    *(pDst1 + (i * 3U + 1U)) = tr[3];
#line 817
                    *(pDst1 + (i * 3U + 2U)) = tr[5];
#line 817
                    i ++;
                  }
                  while_break___4: /* CIL Label */ ;
                  }
                } else {
#line 817
                  keep_original = 0;
                }
#line 817
                goto switch_break___1;
                case_3___0: /* CIL Label */ 
                {
#line 818
                memset((void *)pDst2, 0, (size_t )(w0 * 4U));
                }
#line 818
                if (trns_idx >= 0) {
                  {
#line 818
                  memset((void *)pDst1, trns_idx, (size_t )w0);
                  }
                } else {
#line 818
                  keep_original = 0;
                }
#line 818
                goto switch_break___1;
                case_4___1: /* CIL Label */ 
                {
#line 819
                memset((void *)pDst1, 0, (size_t )(w0 * 2U));
                }
#line 819
                goto switch_break___1;
                case_6___0: /* CIL Label */ 
                {
#line 820
                memset((void *)pDst2, 0, (size_t )(w0 * 4U));
                }
#line 820
                goto switch_break___1;
                switch_break___1: /* CIL Label */ ;
                }
#line 822
                pDst1 += outrow1;
#line 823
                pDst2 += outrow2;
#line 812
                j ++;
              }
              while_break___3: /* CIL Label */ ;
              }
            }
          }
        }
        {
#line 829
        pImg1 += outimg1;
#line 830
        pImg2 += outimg2;
#line 832
        tmp___30 = read32(& seq, f1);
        }
#line 832
        if (tmp___30) {
#line 832
          goto while_break___0;
        }
        {
#line 833
        tmp___31 = read32(& w0, f1);
        }
#line 833
        if (tmp___31) {
#line 833
          goto while_break___0;
        }
        {
#line 834
        tmp___32 = read32(& h0, f1);
        }
#line 834
        if (tmp___32) {
#line 834
          goto while_break___0;
        }
        {
#line 835
        tmp___33 = read32(& x0, f1);
        }
#line 835
        if (tmp___33) {
#line 835
          goto while_break___0;
        }
        {
#line 836
        tmp___34 = read32(& y0, f1);
        }
#line 836
        if (tmp___34) {
#line 836
          goto while_break___0;
        }
        {
#line 837
        tmp___35 = read16(& d1, f1);
        }
#line 837
        if (tmp___35) {
#line 837
          goto while_break___0;
        }
        {
#line 838
        tmp___36 = read16(& d2, f1);
        }
#line 838
        if (tmp___36) {
#line 838
          goto while_break___0;
        }
        {
#line 839
        tmp___37 = fread((void */* __restrict  */)(& dop), (size_t )1, (size_t )1,
                         (FILE */* __restrict  */)f1);
        }
#line 839
        if (tmp___37 != 1UL) {
#line 839
          goto while_break___0;
        }
        {
#line 840
        tmp___38 = fread((void */* __restrict  */)(& bop), (size_t )1, (size_t )1,
                         (FILE */* __restrict  */)f1);
        }
#line 840
        if (tmp___38 != 1UL) {
#line 840
          goto while_break___0;
        }
        {
#line 841
        tmp___39 = read32(& crc, f1);
        }
#line 841
        if (tmp___39) {
#line 841
          goto while_break___0;
        }
#line 843
        if (cur_frame == 0U) {
#line 845
          bop = (unsigned char)0;
#line 846
          if ((int )dop == 2) {
#line 847
            dop = (unsigned char)1;
          }
        }
#line 850
        if ((int )coltype <= 3) {
#line 850
          if (ts == 0) {
#line 851
            bop = (unsigned char)0;
          }
        }
#line 853
        if ((int )pixeldepth >= 8) {
#line 853
          rowbytes = w0 * ((unsigned int )pixeldepth >> 3);
        } else {
#line 853
          rowbytes = (w0 * (unsigned int )pixeldepth + 7U) >> 3;
        }
#line 855
        cur_frame ++;
#line 856
        *(pDelayNum + cur_frame) = d1;
#line 857
        *(pDelayDen + cur_frame) = d2;
      } else
#line 860
      if (chunk == 1229209940U) {
        {
#line 862
        tmp___40 = fread((void */* __restrict  */)(pData + zsize), (size_t )1, (size_t )len,
                         (FILE */* __restrict  */)f1);
        }
#line 862
        if (tmp___40 != (size_t )len) {
#line 862
          goto while_break___0;
        }
        {
#line 863
        zsize += len;
#line 864
        tmp___41 = read32(& crc, f1);
        }
#line 864
        if (tmp___41) {
#line 864
          goto while_break___0;
        }
      } else
#line 867
      if (chunk == 1717846356U) {
        {
#line 869
        tmp___42 = read32(& seq, f1);
        }
#line 869
        if (tmp___42) {
#line 869
          goto while_break___0;
        }
        {
#line 870
        len -= 4U;
#line 871
        tmp___43 = fread((void */* __restrict  */)(pData + zsize), (size_t )1, (size_t )len,
                         (FILE */* __restrict  */)f1);
        }
#line 871
        if (tmp___43 != (size_t )len) {
#line 871
          goto while_break___0;
        }
        {
#line 872
        zsize += len;
#line 873
        tmp___44 = read32(& crc, f1);
        }
#line 873
        if (tmp___44) {
#line 873
          goto while_break___0;
        }
      } else
#line 876
      if (chunk == 1229278788U) {
        {
#line 878
        pDst1 = (pImg1 + y0 * outrow1) + x0 * channels;
#line 879
        pDst2 = (pImg2 + y0 * outrow2) + x0 * 4U;
#line 880
        unpack(zstream, pTemp, imagesize, pData, zsize, h0, rowbytes, bpp);
        }
        {
#line 883
        if ((int )coltype == 0) {
#line 883
          goto case_0___1;
        }
#line 884
        if ((int )coltype == 2) {
#line 884
          goto case_2___2;
        }
#line 885
        if ((int )coltype == 3) {
#line 885
          goto case_3___1;
        }
#line 886
        if ((int )coltype == 4) {
#line 886
          goto case_4___2;
        }
#line 887
        if ((int )coltype == 6) {
#line 887
          goto case_6___1;
        }
#line 881
        goto switch_break___2;
        case_0___1: /* CIL Label */ 
        {
#line 883
        compose0(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 883
        goto switch_break___2;
        case_2___2: /* CIL Label */ 
        {
#line 884
        compose2(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 884
        goto switch_break___2;
        case_3___1: /* CIL Label */ 
        {
#line 885
        compose3(pDst1, outrow1, pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 885
        goto switch_break___2;
        case_4___2: /* CIL Label */ 
        {
#line 886
        compose4(pDst1, outrow1, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 886
        goto switch_break___2;
        case_6___1: /* CIL Label */ 
        {
#line 887
        compose6(pDst2, outrow2, pTemp, rowbytes + 1U, w0, h0, (unsigned int )bop,
                 depth);
        }
#line 887
        goto switch_break___2;
        switch_break___2: /* CIL Label */ ;
        }
#line 890
        if (cur_frame == frames) {
#line 891
          res = 0;
        }
#line 893
        goto while_break___0;
      } else {
#line 897
        c = (unsigned char )(chunk >> 24);
#line 898
        if ((int )c < 65) {
#line 898
          goto while_break___0;
        } else
#line 898
        if ((int )c > 122) {
#line 898
          goto while_break___0;
        } else
#line 898
        if ((int )c > 90) {
#line 898
          if ((int )c < 97) {
#line 898
            goto while_break___0;
          }
        }
#line 899
        c = (unsigned char )((chunk >> 16) & 255U);
#line 900
        if ((int )c < 65) {
#line 900
          goto while_break___0;
        } else
#line 900
        if ((int )c > 122) {
#line 900
          goto while_break___0;
        } else
#line 900
        if ((int )c > 90) {
#line 900
          if ((int )c < 97) {
#line 900
            goto while_break___0;
          }
        }
#line 901
        c = (unsigned char )((chunk >> 8) & 255U);
#line 902
        if ((int )c < 65) {
#line 902
          goto while_break___0;
        } else
#line 902
        if ((int )c > 122) {
#line 902
          goto while_break___0;
        } else
#line 902
        if ((int )c > 90) {
#line 902
          if ((int )c < 97) {
#line 902
            goto while_break___0;
          }
        }
#line 903
        c = (unsigned char )(chunk & 255U);
#line 904
        if ((int )c < 65) {
#line 904
          goto while_break___0;
        } else
#line 904
        if ((int )c > 122) {
#line 904
          goto while_break___0;
        } else
#line 904
        if ((int )c > 90) {
#line 904
          if ((int )c < 97) {
#line 904
            goto while_break___0;
          }
        }
        {
#line 906
        fseek(f1, (long )len, 1);
#line 907
        tmp___45 = read32(& crc, f1);
        }
#line 907
        if (tmp___45) {
#line 907
          goto while_break___0;
        }
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 911
    *pWidth = w;
#line 912
    *pHeight = h;
#line 913
    *pColType = coltype;
#line 914
    *pFirst = first_visible;
#line 915
    *pFrames = frames;
#line 916
    *pLoops = loops;
#line 917
    *ppOut1 = pOut1;
#line 918
    *ppOut2 = pOut2;
#line 919
    *ppDelayNum = pDelayNum;
#line 920
    *ppDelayDen = pDelayDen;
#line 922
    free((void *)pData);
#line 923
    free((void *)pTemp);
    }
#line 600
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 927
  inflateEnd(& zstream);
#line 928
  fclose(f1);
  }
#line 929
  return (res);
}
}
#line 932 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void write_chunk(FILE *f , char const   *name , unsigned char *data , unsigned int length ) 
{ 
  unsigned int crc ;
  uLong tmp ;
  unsigned int len ;
  unsigned int tmp___0 ;
  uLong tmp___1 ;
  unsigned int seq ;
  unsigned int tmp___2 ;
  unsigned int tmp___3 ;
  uLong tmp___4 ;
  int tmp___5 ;
  uLong tmp___6 ;

  {
  {
#line 934
  tmp = crc32((uLong )0, (Bytef const   *)0, (uInt )0);
#line 934
  crc = (unsigned int )tmp;
#line 935
  tmp___0 = __bswap_32(length);
#line 935
  len = tmp___0;
#line 937
  fwrite((void const   */* __restrict  */)(& len), (size_t )1, (size_t )4, (FILE */* __restrict  */)f);
#line 938
  fwrite((void const   */* __restrict  */)name, (size_t )1, (size_t )4, (FILE */* __restrict  */)f);
#line 939
  tmp___1 = crc32((uLong )crc, (Bytef const   *)name, (uInt )4);
#line 939
  crc = (unsigned int )tmp___1;
#line 941
  tmp___5 = memcmp((void const   *)name, (void const   *)"fdAT", (size_t )4);
  }
#line 941
  if (tmp___5 == 0) {
    {
#line 943
    tmp___2 = next_seq_num;
#line 943
    next_seq_num ++;
#line 943
    tmp___3 = __bswap_32(tmp___2);
#line 943
    seq = tmp___3;
#line 944
    fwrite((void const   */* __restrict  */)(& seq), (size_t )1, (size_t )4, (FILE */* __restrict  */)f);
#line 945
    tmp___4 = crc32((uLong )crc, (Bytef const   *)(& seq), (uInt )4);
#line 945
    crc = (unsigned int )tmp___4;
#line 946
    length -= 4U;
    }
  }
#line 949
  if ((unsigned long )data != (unsigned long )((void *)0)) {
#line 949
    if (length > 0U) {
      {
#line 951
      fwrite((void const   */* __restrict  */)data, (size_t )1, (size_t )length, (FILE */* __restrict  */)f);
#line 952
      tmp___6 = crc32((uLong )crc, (Bytef const   *)data, length);
#line 952
      crc = (unsigned int )tmp___6;
      }
    }
  }
  {
#line 955
  crc = __bswap_32(crc);
#line 956
  fwrite((void const   */* __restrict  */)(& crc), (size_t )1, (size_t )4, (FILE */* __restrict  */)f);
  }
#line 957
  return;
}
}
#line 959 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void write_IDATs(FILE *f , int frame , unsigned char *data , unsigned int length ,
                 unsigned int idat_size ) 
{ 
  unsigned int z_cmf ;
  unsigned int z_cinfo ;
  unsigned int half_z_window_size ;
  unsigned int ds ;

  {
#line 961
  z_cmf = (unsigned int )*(data + 0);
#line 962
  if ((z_cmf & 15U) == 8U) {
#line 962
    if ((z_cmf & 240U) <= 112U) {
#line 964
      if (length >= 2U) {
#line 966
        z_cinfo = z_cmf >> 4;
#line 967
        half_z_window_size = (unsigned int )(1 << (z_cinfo + 7U));
        {
#line 968
        while (1) {
          while_continue: /* CIL Label */ ;
#line 968
          if (idat_size <= half_z_window_size) {
#line 968
            if (! (half_z_window_size >= 256U)) {
#line 968
              goto while_break;
            }
          } else {
#line 968
            goto while_break;
          }
#line 970
          z_cinfo --;
#line 971
          half_z_window_size >>= 1;
        }
        while_break: /* CIL Label */ ;
        }
#line 973
        z_cmf = (z_cmf & 15U) | (z_cinfo << 4);
#line 974
        if ((int )*(data + 0) != (int )((unsigned char )z_cmf)) {
#line 976
          *(data + 0) = (unsigned char )z_cmf;
#line 977
          *(data + 1) = (unsigned char )((int )*(data + 1) & 224);
#line 978
          *(data + 1) = (unsigned char )((int )*(data + 1) + (int )((unsigned char )(31U - ((z_cmf << 8) + (unsigned int )*(data + 1)) % 31U)));
        }
      }
    }
  }
  {
#line 983
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 983
    if (! (length > 0U)) {
#line 983
      goto while_break___0;
    }
#line 985
    ds = length;
#line 986
    if (ds > 32768U) {
#line 987
      ds = 32768U;
    }
#line 989
    if (frame == 0) {
      {
#line 990
      write_chunk(f, "IDAT", data, ds);
      }
    } else {
      {
#line 992
      write_chunk(f, "fdAT", data, ds + 4U);
      }
    }
#line 994
    data += ds;
#line 995
    length -= ds;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 997
  return;
}
}
#line 999 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
unsigned int get_rect(unsigned int w , unsigned int h , unsigned char *pimg1 , unsigned char *pimg2 ,
                      unsigned char *ptemp , unsigned int *px , unsigned int *py ,
                      unsigned int *pw , unsigned int *ph , unsigned int bpp , unsigned int has_tcolor ,
                      unsigned int tcolor ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int x_min ;
  unsigned int y_min ;
  unsigned int x_max ;
  unsigned int y_max ;
  unsigned int diffnum ;
  unsigned int over_is_possible ;
  unsigned char *pa ;
  unsigned char *pb ;
  unsigned char *pc ;
  unsigned char c ;
  unsigned char *tmp ;
  unsigned char *tmp___0 ;
  unsigned char *tmp___1 ;
  unsigned short *pa___0 ;
  unsigned short *pb___0 ;
  unsigned short *pc___0 ;
  unsigned int c1 ;
  unsigned short *tmp___2 ;
  unsigned int c2 ;
  unsigned short *tmp___3 ;
  unsigned short *tmp___4 ;
  unsigned char *pa___1 ;
  unsigned char *pb___1 ;
  unsigned char *pc___1 ;
  unsigned int c1___0 ;
  unsigned int c2___0 ;
  unsigned int *pa___2 ;
  unsigned int *pb___2 ;
  unsigned int *pc___2 ;
  unsigned int c1___1 ;
  unsigned int *tmp___5 ;
  unsigned int c2___1 ;
  unsigned int *tmp___6 ;
  unsigned int *tmp___7 ;
  unsigned int tmp___8 ;
  unsigned int tmp___9 ;

  {
#line 1002
  x_min = w - 1U;
#line 1003
  y_min = h - 1U;
#line 1004
  x_max = 0U;
#line 1005
  y_max = 0U;
#line 1006
  diffnum = 0U;
#line 1007
  over_is_possible = 1U;
#line 1009
  if (! has_tcolor) {
#line 1010
    over_is_possible = 0U;
  }
#line 1012
  if (bpp == 1U) {
#line 1014
    pa = pimg1;
#line 1015
    pb = pimg2;
#line 1016
    pc = ptemp;
#line 1018
    j = 0U;
    {
#line 1018
    while (1) {
      while_continue: /* CIL Label */ ;
#line 1018
      if (! (j < h)) {
#line 1018
        goto while_break;
      }
#line 1019
      i = 0U;
      {
#line 1019
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 1019
        if (! (i < w)) {
#line 1019
          goto while_break___0;
        }
#line 1021
        tmp = pb;
#line 1021
        pb ++;
#line 1021
        c = *tmp;
#line 1022
        tmp___0 = pa;
#line 1022
        pa ++;
#line 1022
        if ((int )*tmp___0 != (int )c) {
#line 1024
          diffnum ++;
#line 1025
          if (has_tcolor) {
#line 1025
            if ((unsigned int )c == tcolor) {
#line 1025
              over_is_possible = 0U;
            }
          }
#line 1026
          if (i < x_min) {
#line 1026
            x_min = i;
          }
#line 1027
          if (i > x_max) {
#line 1027
            x_max = i;
          }
#line 1028
          if (j < y_min) {
#line 1028
            y_min = j;
          }
#line 1029
          if (j > y_max) {
#line 1029
            y_max = j;
          }
        } else {
#line 1032
          c = (unsigned char )tcolor;
        }
#line 1034
        tmp___1 = pc;
#line 1034
        pc ++;
#line 1034
        *tmp___1 = c;
#line 1019
        i ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 1018
      j ++;
    }
    while_break: /* CIL Label */ ;
    }
  } else
#line 1038
  if (bpp == 2U) {
#line 1040
    pa___0 = (unsigned short *)pimg1;
#line 1041
    pb___0 = (unsigned short *)pimg2;
#line 1042
    pc___0 = (unsigned short *)ptemp;
#line 1044
    j = 0U;
    {
#line 1044
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 1044
      if (! (j < h)) {
#line 1044
        goto while_break___1;
      }
#line 1045
      i = 0U;
      {
#line 1045
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 1045
        if (! (i < w)) {
#line 1045
          goto while_break___2;
        }
#line 1047
        tmp___2 = pa___0;
#line 1047
        pa___0 ++;
#line 1047
        c1 = (unsigned int )*tmp___2;
#line 1048
        tmp___3 = pb___0;
#line 1048
        pb___0 ++;
#line 1048
        c2 = (unsigned int )*tmp___3;
#line 1049
        if (c1 != c2) {
#line 1049
          if (c1 >> 8) {
#line 1049
            goto _L;
          } else
#line 1049
          if (c2 >> 8) {
            _L: /* CIL Label */ 
#line 1051
            diffnum ++;
#line 1052
            if (c2 >> 8 != 255U) {
#line 1052
              over_is_possible = 0U;
            }
#line 1053
            if (i < x_min) {
#line 1053
              x_min = i;
            }
#line 1054
            if (i > x_max) {
#line 1054
              x_max = i;
            }
#line 1055
            if (j < y_min) {
#line 1055
              y_min = j;
            }
#line 1056
            if (j > y_max) {
#line 1056
              y_max = j;
            }
          } else {
#line 1059
            c2 = 0U;
          }
        } else {
#line 1059
          c2 = 0U;
        }
#line 1061
        tmp___4 = pc___0;
#line 1061
        pc___0 ++;
#line 1061
        *tmp___4 = (unsigned short )c2;
#line 1045
        i ++;
      }
      while_break___2: /* CIL Label */ ;
      }
#line 1044
      j ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  } else
#line 1065
  if (bpp == 3U) {
#line 1067
    pa___1 = pimg1;
#line 1068
    pb___1 = pimg2;
#line 1069
    pc___1 = ptemp;
#line 1071
    j = 0U;
    {
#line 1071
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 1071
      if (! (j < h)) {
#line 1071
        goto while_break___3;
      }
#line 1072
      i = 0U;
      {
#line 1072
      while (1) {
        while_continue___4: /* CIL Label */ ;
#line 1072
        if (! (i < w)) {
#line 1072
          goto while_break___4;
        }
#line 1074
        c1___0 = (unsigned int )(((((int )*(pa___1 + 2) << 8) + (int )*(pa___1 + 1)) << 8) + (int )*(pa___1 + 0));
#line 1075
        c2___0 = (unsigned int )(((((int )*(pb___1 + 2) << 8) + (int )*(pb___1 + 1)) << 8) + (int )*(pb___1 + 0));
#line 1076
        if (c1___0 != c2___0) {
#line 1078
          diffnum ++;
#line 1079
          if (has_tcolor) {
#line 1079
            if (c2___0 == tcolor) {
#line 1079
              over_is_possible = 0U;
            }
          }
#line 1080
          if (i < x_min) {
#line 1080
            x_min = i;
          }
#line 1081
          if (i > x_max) {
#line 1081
            x_max = i;
          }
#line 1082
          if (j < y_min) {
#line 1082
            y_min = j;
          }
#line 1083
          if (j > y_max) {
#line 1083
            y_max = j;
          }
        } else {
#line 1086
          c2___0 = tcolor;
        }
        {
#line 1088
        memcpy((void */* __restrict  */)pc___1, (void const   */* __restrict  */)(& c2___0),
               (size_t )3);
#line 1089
        pa___1 += 3;
#line 1090
        pb___1 += 3;
#line 1091
        pc___1 += 3;
#line 1072
        i ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
#line 1071
      j ++;
    }
    while_break___3: /* CIL Label */ ;
    }
  } else
#line 1095
  if (bpp == 4U) {
#line 1097
    pa___2 = (unsigned int *)pimg1;
#line 1098
    pb___2 = (unsigned int *)pimg2;
#line 1099
    pc___2 = (unsigned int *)ptemp;
#line 1101
    j = 0U;
    {
#line 1101
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 1101
      if (! (j < h)) {
#line 1101
        goto while_break___5;
      }
#line 1102
      i = 0U;
      {
#line 1102
      while (1) {
        while_continue___6: /* CIL Label */ ;
#line 1102
        if (! (i < w)) {
#line 1102
          goto while_break___6;
        }
#line 1104
        tmp___5 = pa___2;
#line 1104
        pa___2 ++;
#line 1104
        c1___1 = *tmp___5;
#line 1105
        tmp___6 = pb___2;
#line 1105
        pb___2 ++;
#line 1105
        c2___1 = *tmp___6;
#line 1106
        if (c1___1 != c2___1) {
#line 1106
          if (c1___1 >> 24) {
#line 1106
            goto _L___0;
          } else
#line 1106
          if (c2___1 >> 24) {
            _L___0: /* CIL Label */ 
#line 1108
            diffnum ++;
#line 1109
            if (c2___1 >> 24 != 255U) {
#line 1109
              over_is_possible = 0U;
            }
#line 1110
            if (i < x_min) {
#line 1110
              x_min = i;
            }
#line 1111
            if (i > x_max) {
#line 1111
              x_max = i;
            }
#line 1112
            if (j < y_min) {
#line 1112
              y_min = j;
            }
#line 1113
            if (j > y_max) {
#line 1113
              y_max = j;
            }
          } else {
#line 1116
            c2___1 = 0U;
          }
        } else {
#line 1116
          c2___1 = 0U;
        }
#line 1118
        tmp___7 = pc___2;
#line 1118
        pc___2 ++;
#line 1118
        *tmp___7 = c2___1;
#line 1102
        i ++;
      }
      while_break___6: /* CIL Label */ ;
      }
#line 1101
      j ++;
    }
    while_break___5: /* CIL Label */ ;
    }
  }
#line 1122
  if (diffnum == 0U) {
#line 1124
    tmp___8 = 0U;
#line 1124
    *py = tmp___8;
#line 1124
    *px = tmp___8;
#line 1125
    tmp___9 = 1U;
#line 1125
    *ph = tmp___9;
#line 1125
    *pw = tmp___9;
  } else {
#line 1129
    *px = x_min;
#line 1130
    *py = y_min;
#line 1131
    *pw = (x_max - x_min) + 1U;
#line 1132
    *ph = (y_max - y_min) + 1U;
  }
#line 1135
  return (over_is_possible);
}
}
#line 1138 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
void deflate_rect(unsigned char *pdata , int x , int y , int w , int h , int bpp ,
                  int stride , int zbuf_size , int n ) 
{ 
  int i ;
  int j ;
  int v ;
  int a ;
  int b ;
  int c ;
  int pa ;
  int pb ;
  int pc ;
  int p ;
  int rowbytes ;
  unsigned char *prev ;
  unsigned char *row ;
  unsigned char *out ;
  unsigned int sum ;
  unsigned char *best_row ;
  unsigned int mins ;
  unsigned char tmp ;
  int tmp___0 ;
  unsigned char tmp___1 ;
  int tmp___2 ;
  unsigned char tmp___3 ;
  int tmp___4 ;
  unsigned char tmp___5 ;
  int tmp___6 ;
  unsigned char tmp___7 ;
  int tmp___8 ;
  unsigned char tmp___9 ;
  int tmp___10 ;
  unsigned char tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  unsigned char tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;

  {
#line 1142
  rowbytes = w * bpp;
#line 1143
  prev = (unsigned char *)((void *)0);
#line 1144
  row = (pdata + y * stride) + x * bpp;
#line 1147
  op[n * 2].valid = 1;
#line 1148
  op[n * 2].zstream.next_out = op[n * 2].zbuf;
#line 1149
  op[n * 2].zstream.avail_out = (uInt )zbuf_size;
#line 1151
  op[n * 2 + 1].valid = 1;
#line 1152
  op[n * 2 + 1].zstream.next_out = op[n * 2 + 1].zbuf;
#line 1153
  op[n * 2 + 1].zstream.avail_out = (uInt )zbuf_size;
#line 1155
  j = 0;
  {
#line 1155
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1155
    if (! (j < h)) {
#line 1155
      goto while_break;
    }
#line 1157
    sum = 0U;
#line 1158
    best_row = row_buf;
#line 1159
    mins = 4294967295U >> 1;
#line 1161
    out = row_buf + 1;
#line 1162
    i = 0;
    {
#line 1162
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1162
      if (! (i < rowbytes)) {
#line 1162
        goto while_break___0;
      }
#line 1164
      tmp = *(row + i);
#line 1164
      *(out + i) = tmp;
#line 1164
      v = (int )tmp;
#line 1165
      if (v < 128) {
#line 1165
        tmp___0 = v;
      } else {
#line 1165
        tmp___0 = 256 - v;
      }
#line 1165
      sum += (unsigned int )tmp___0;
#line 1162
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 1167
    mins = sum;
#line 1169
    sum = 0U;
#line 1170
    out = sub_row + 1;
#line 1171
    i = 0;
    {
#line 1171
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 1171
      if (! (i < bpp)) {
#line 1171
        goto while_break___1;
      }
#line 1173
      tmp___1 = *(row + i);
#line 1173
      *(out + i) = tmp___1;
#line 1173
      v = (int )tmp___1;
#line 1174
      if (v < 128) {
#line 1174
        tmp___2 = v;
      } else {
#line 1174
        tmp___2 = 256 - v;
      }
#line 1174
      sum += (unsigned int )tmp___2;
#line 1171
      i ++;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 1176
    i = bpp;
    {
#line 1176
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 1176
      if (! (i < rowbytes)) {
#line 1176
        goto while_break___2;
      }
#line 1178
      tmp___3 = (unsigned char )((int )*(row + i) - (int )*(row + (i - bpp)));
#line 1178
      *(out + i) = tmp___3;
#line 1178
      v = (int )tmp___3;
#line 1179
      if (v < 128) {
#line 1179
        tmp___4 = v;
      } else {
#line 1179
        tmp___4 = 256 - v;
      }
#line 1179
      sum += (unsigned int )tmp___4;
#line 1180
      if (sum > mins) {
#line 1180
        goto while_break___2;
      }
#line 1176
      i ++;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 1182
    if (sum < mins) {
#line 1184
      mins = sum;
#line 1185
      best_row = sub_row;
    }
#line 1188
    if (prev) {
#line 1190
      sum = 0U;
#line 1191
      out = up_row + 1;
#line 1192
      i = 0;
      {
#line 1192
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 1192
        if (! (i < rowbytes)) {
#line 1192
          goto while_break___3;
        }
#line 1194
        tmp___5 = (unsigned char )((int )*(row + i) - (int )*(prev + i));
#line 1194
        *(out + i) = tmp___5;
#line 1194
        v = (int )tmp___5;
#line 1195
        if (v < 128) {
#line 1195
          tmp___6 = v;
        } else {
#line 1195
          tmp___6 = 256 - v;
        }
#line 1195
        sum += (unsigned int )tmp___6;
#line 1196
        if (sum > mins) {
#line 1196
          goto while_break___3;
        }
#line 1192
        i ++;
      }
      while_break___3: /* CIL Label */ ;
      }
#line 1198
      if (sum < mins) {
#line 1200
        mins = sum;
#line 1201
        best_row = up_row;
      }
#line 1204
      sum = 0U;
#line 1205
      out = avg_row + 1;
#line 1206
      i = 0;
      {
#line 1206
      while (1) {
        while_continue___4: /* CIL Label */ ;
#line 1206
        if (! (i < bpp)) {
#line 1206
          goto while_break___4;
        }
#line 1208
        tmp___7 = (unsigned char )((int )*(row + i) - (int )*(prev + i) / 2);
#line 1208
        *(out + i) = tmp___7;
#line 1208
        v = (int )tmp___7;
#line 1209
        if (v < 128) {
#line 1209
          tmp___8 = v;
        } else {
#line 1209
          tmp___8 = 256 - v;
        }
#line 1209
        sum += (unsigned int )tmp___8;
#line 1206
        i ++;
      }
      while_break___4: /* CIL Label */ ;
      }
#line 1211
      i = bpp;
      {
#line 1211
      while (1) {
        while_continue___5: /* CIL Label */ ;
#line 1211
        if (! (i < rowbytes)) {
#line 1211
          goto while_break___5;
        }
#line 1213
        tmp___9 = (unsigned char )((int )*(row + i) - ((int )*(prev + i) + (int )*(row + (i - bpp))) / 2);
#line 1213
        *(out + i) = tmp___9;
#line 1213
        v = (int )tmp___9;
#line 1214
        if (v < 128) {
#line 1214
          tmp___10 = v;
        } else {
#line 1214
          tmp___10 = 256 - v;
        }
#line 1214
        sum += (unsigned int )tmp___10;
#line 1215
        if (sum > mins) {
#line 1215
          goto while_break___5;
        }
#line 1211
        i ++;
      }
      while_break___5: /* CIL Label */ ;
      }
#line 1217
      if (sum < mins) {
#line 1219
        mins = sum;
#line 1220
        best_row = avg_row;
      }
#line 1223
      sum = 0U;
#line 1224
      out = paeth_row + 1;
#line 1225
      i = 0;
      {
#line 1225
      while (1) {
        while_continue___6: /* CIL Label */ ;
#line 1225
        if (! (i < bpp)) {
#line 1225
          goto while_break___6;
        }
#line 1227
        tmp___11 = (unsigned char )((int )*(row + i) - (int )*(prev + i));
#line 1227
        *(out + i) = tmp___11;
#line 1227
        v = (int )tmp___11;
#line 1228
        if (v < 128) {
#line 1228
          tmp___12 = v;
        } else {
#line 1228
          tmp___12 = 256 - v;
        }
#line 1228
        sum += (unsigned int )tmp___12;
#line 1225
        i ++;
      }
      while_break___6: /* CIL Label */ ;
      }
#line 1230
      i = bpp;
      {
#line 1230
      while (1) {
        while_continue___7: /* CIL Label */ ;
#line 1230
        if (! (i < rowbytes)) {
#line 1230
          goto while_break___7;
        }
        {
#line 1232
        a = (int )*(row + (i - bpp));
#line 1233
        b = (int )*(prev + i);
#line 1234
        c = (int )*(prev + (i - bpp));
#line 1235
        p = b - c;
#line 1236
        pc = a - c;
#line 1237
        pa = abs(p);
#line 1238
        pb = abs(pc);
#line 1239
        pc = abs(p + pc);
        }
#line 1240
        if (pa <= pb) {
#line 1240
          if (pa <= pc) {
#line 1240
            p = a;
          } else {
#line 1240
            goto _L;
          }
        } else {
          _L: /* CIL Label */ 
#line 1240
          if (pb <= pc) {
#line 1240
            tmp___13 = b;
          } else {
#line 1240
            tmp___13 = c;
          }
#line 1240
          p = tmp___13;
        }
#line 1241
        tmp___14 = (unsigned char )((int )*(row + i) - p);
#line 1241
        *(out + i) = tmp___14;
#line 1241
        v = (int )tmp___14;
#line 1242
        if (v < 128) {
#line 1242
          tmp___15 = v;
        } else {
#line 1242
          tmp___15 = 256 - v;
        }
#line 1242
        sum += (unsigned int )tmp___15;
#line 1243
        if (sum > mins) {
#line 1243
          goto while_break___7;
        }
#line 1230
        i ++;
      }
      while_break___7: /* CIL Label */ ;
      }
#line 1245
      if (sum < mins) {
#line 1247
        best_row = paeth_row;
      }
    }
    {
#line 1251
    op[n * 2].zstream.next_in = row_buf;
#line 1252
    op[n * 2].zstream.avail_in = (uInt )(rowbytes + 1);
#line 1253
    deflate(& op[n * 2].zstream, 0);
#line 1255
    op[n * 2 + 1].zstream.next_in = best_row;
#line 1256
    op[n * 2 + 1].zstream.avail_in = (uInt )(rowbytes + 1);
#line 1257
    deflate(& op[n * 2 + 1].zstream, 0);
#line 1259
    prev = row;
#line 1260
    row += stride;
#line 1155
    j ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1263
  deflate(& op[n * 2].zstream, 4);
#line 1264
  deflate(& op[n * 2 + 1].zstream, 4);
#line 1266
  tmp___16 = x;
#line 1266
  op[n * 2 + 1].x = tmp___16;
#line 1266
  op[n * 2].x = tmp___16;
#line 1267
  tmp___17 = y;
#line 1267
  op[n * 2 + 1].y = tmp___17;
#line 1267
  op[n * 2].y = tmp___17;
#line 1268
  tmp___18 = w;
#line 1268
  op[n * 2 + 1].w = tmp___18;
#line 1268
  op[n * 2].w = tmp___18;
#line 1269
  tmp___19 = h;
#line 1269
  op[n * 2 + 1].h = tmp___19;
#line 1269
  op[n * 2].h = tmp___19;
  }
#line 1270
  return;
}
}
#line 1272 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int SaveAPNG(char *szOut , unsigned char *pdata , unsigned short *dnum , unsigned short *dden ,
             unsigned int width , unsigned int height , unsigned int first , unsigned int frames ,
             unsigned int loops , unsigned char coltype ) 
{ 
  unsigned int i ;
  unsigned int j ;
  unsigned int k ;
  unsigned int x0 ;
  unsigned int y0 ;
  unsigned int w0 ;
  unsigned int h0 ;
  unsigned int x1 ;
  unsigned int y1 ;
  unsigned int w1 ;
  unsigned int h1 ;
  unsigned int try_over ;
  unsigned int bpp ;
  unsigned int rowbytes ;
  unsigned int imagesize ;
  unsigned int imgstride ;
  unsigned int idat_size ;
  unsigned int zbuf_size ;
  unsigned int zsize ;
  unsigned int has_tcolor ;
  unsigned int tcolor ;
  unsigned int colors ;
  unsigned char dop ;
  unsigned char bop ;
  unsigned char r ;
  unsigned char g ;
  unsigned char b ;
  unsigned char a ;
  int c ;
  rgb palette[256] ;
  unsigned char trns[256] ;
  unsigned int palsize ;
  unsigned int trnssize ;
  unsigned char cube[4096] ;
  unsigned char gray[256] ;
  unsigned char *zbuf ;
  unsigned char *sp ;
  unsigned char *dp ;
  FILE *f ;
  unsigned char *tmpframe ;
  unsigned char *prev_frame ;
  unsigned char *cur_frame ;
  unsigned char *next_frame ;
  unsigned char tmp ;
  unsigned char tmp___0 ;
  unsigned char tmp___1 ;
  unsigned char tmp___2 ;
  unsigned char tmp___3 ;
  int tmp___4 ;
  int transparent ;
  int simple_trans ;
  int grayscale ;
  unsigned char *tmp___5 ;
  unsigned char *tmp___6 ;
  unsigned char *tmp___7 ;
  unsigned char *tmp___8 ;
  int found ;
  unsigned char *tmp___9 ;
  unsigned char *tmp___10 ;
  unsigned char *tmp___11 ;
  unsigned char *tmp___12 ;
  unsigned char *tmp___13 ;
  unsigned char *tmp___14 ;
  unsigned int tmp___15 ;
  unsigned char *tmp___16 ;
  unsigned char *tmp___17 ;
  unsigned char *tmp___18 ;
  unsigned char *tmp___19 ;
  unsigned char *tmp___20 ;
  unsigned char *tmp___21 ;
  unsigned char *tmp___22 ;
  unsigned char *tmp___23 ;
  unsigned char *tmp___24 ;
  unsigned char *tmp___25 ;
  unsigned char *tmp___26 ;
  unsigned char *tmp___27 ;
  unsigned char *tmp___28 ;
  unsigned char *tmp___29 ;
  unsigned char *tmp___30 ;
  unsigned char *tmp___31 ;
  unsigned char *tmp___32 ;
  unsigned char *tmp___33 ;
  unsigned char *tmp___34 ;
  unsigned char *tmp___35 ;
  unsigned char *tmp___36 ;
  unsigned char *tmp___37 ;
  unsigned char *tmp___38 ;
  unsigned char *tmp___39 ;
  unsigned char *tmp___40 ;
  unsigned char *tmp___41 ;
  unsigned char *tmp___42 ;
  int grayscale___0 ;
  unsigned char *tmp___43 ;
  unsigned char *tmp___44 ;
  unsigned char *tmp___45 ;
  int found___0 ;
  unsigned char *tmp___46 ;
  unsigned char *tmp___47 ;
  unsigned char *tmp___48 ;
  unsigned char *tmp___49 ;
  unsigned char *tmp___50 ;
  unsigned char *tmp___51 ;
  unsigned int tmp___52 ;
  unsigned char *tmp___53 ;
  unsigned char *tmp___54 ;
  unsigned char *tmp___55 ;
  unsigned char *tmp___56 ;
  int simple_trans___0 ;
  unsigned char *tmp___57 ;
  unsigned char *tmp___58 ;
  int found___1 ;
  unsigned char *tmp___59 ;
  unsigned char *tmp___60 ;
  unsigned char *tmp___61 ;
  unsigned char *tmp___62 ;
  unsigned int tmp___63 ;
  unsigned char *tmp___64 ;
  unsigned char *tmp___65 ;
  unsigned char *tmp___66 ;
  int simple_trans___1 ;
  int grayscale___1 ;
  unsigned char *tmp___67 ;
  unsigned char *tmp___68 ;
  unsigned char *tmp___69 ;
  void *tmp___70 ;
  void *tmp___71 ;
  void *tmp___72 ;
  void *tmp___73 ;
  void *tmp___74 ;
  void *tmp___75 ;
  void *tmp___76 ;
  void *tmp___77 ;
  struct IHDR ihdr ;
  unsigned int tmp___78 ;
  unsigned int tmp___79 ;
  struct acTL actl ;
  unsigned int tmp___80 ;
  unsigned int tmp___81 ;
  struct fcTL fctl ;
  unsigned int op_min ;
  int op_best ;
  unsigned int tmp___82 ;
  unsigned short __v ;
  unsigned short __x ;
  unsigned short __v___0 ;
  unsigned short __x___0 ;
  unsigned int tmp___83 ;
  unsigned short __v___1 ;
  unsigned short __x___1 ;
  unsigned short __v___2 ;
  unsigned short __x___2 ;

  {
  {
#line 1296
  memset((void *)(& cube), 0, sizeof(cube));
#line 1297
  memset((void *)(& gray), 0, sizeof(gray));
#line 1299
  i = 0U;
  }
  {
#line 1299
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1299
    if (! (i < 256U)) {
#line 1299
      goto while_break;
    }
#line 1301
    col[i].num = 0U;
#line 1302
    tmp___0 = (unsigned char )i;
#line 1302
    col[i].b = tmp___0;
#line 1302
    tmp = tmp___0;
#line 1302
    col[i].g = tmp;
#line 1302
    col[i].r = tmp;
#line 1303
    tmp___1 = (unsigned char)255;
#line 1303
    trns[i] = tmp___1;
#line 1303
    col[i].a = tmp___1;
#line 1299
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1306
  imgstride = width * height;
#line 1307
  if ((int )coltype == 2) {
#line 1308
    imgstride = (width * height) * 3U;
  } else
#line 1310
  if ((int )coltype == 4) {
#line 1311
    imgstride = (width * height) * 2U;
  } else
#line 1313
  if ((int )coltype == 6) {
#line 1314
    imgstride = (width * height) * 4U;
  }
#line 1317
  if ((int )coltype == 6) {
#line 1319
    i = first;
    {
#line 1319
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1319
      if (! (i <= frames)) {
#line 1319
        goto while_break___0;
      }
#line 1321
      sp = pdata + imgstride * i;
#line 1322
      j = 0U;
      {
#line 1322
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 1322
        if (! (j < width * height)) {
#line 1322
          goto while_break___1;
        }
#line 1323
        if ((int )*(sp + 3) == 0) {
#line 1324
          tmp___3 = (unsigned char)0;
#line 1324
          *(sp + 2) = tmp___3;
#line 1324
          tmp___2 = tmp___3;
#line 1324
          *(sp + 1) = tmp___2;
#line 1324
          *(sp + 0) = tmp___2;
        }
#line 1322
        j ++;
#line 1322
        sp += 4;
      }
      while_break___1: /* CIL Label */ ;
      }
#line 1319
      i ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else
#line 1328
  if ((int )coltype == 4) {
#line 1330
    i = first;
    {
#line 1330
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 1330
      if (! (i <= frames)) {
#line 1330
        goto while_break___2;
      }
#line 1332
      sp = pdata + imgstride * i;
#line 1333
      j = 0U;
      {
#line 1333
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 1333
        if (! (j < width * height)) {
#line 1333
          goto while_break___3;
        }
#line 1334
        if ((int )*(sp + 1) == 0) {
#line 1335
          *(sp + 0) = (unsigned char)0;
        }
#line 1333
        j ++;
#line 1333
        sp += 2;
      }
      while_break___3: /* CIL Label */ ;
      }
#line 1330
      i ++;
    }
    while_break___2: /* CIL Label */ ;
    }
  }
#line 1341
  sp = pdata + imgstride;
#line 1342
  i = 1U;
  {
#line 1342
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 1342
    if (! (i < frames)) {
#line 1342
      goto while_break___4;
    }
    {
#line 1344
    while (1) {
      while_continue___5: /* CIL Label */ ;
      {
#line 1344
      tmp___4 = memcmp((void const   *)sp, (void const   *)(sp + imgstride), (size_t )imgstride);
      }
#line 1344
      if (! (tmp___4 == 0)) {
#line 1344
        goto while_break___5;
      }
#line 1346
      if ((int )*(dden + i) == (int )*(dden + (i + 1U))) {
#line 1347
        *(dnum + i) = (unsigned short )((int )*(dnum + i) + (int )*(dnum + (i + 1U)));
      } else {
#line 1350
        *(dnum + i) = (unsigned short )((int )*(dnum + i) * (int )*(dden + (i + 1U)) + (int )*(dnum + (i + 1U)) * (int )*(dden + i));
#line 1351
        *(dden + i) = (unsigned short )((int )*(dden + i) * (int )*(dden + (i + 1U)));
#line 1352
        if ((int )*(dnum + i) == (int )*(dden + i)) {
#line 1352
          *(dnum + i) = (unsigned short)1;
#line 1352
          *(dden + i) = (unsigned short)1;
        }
        {
#line 1353
        while (1) {
          while_continue___6: /* CIL Label */ ;
#line 1353
          if ((int )*(dnum + i) % 2 == 0) {
#line 1353
            if (! ((int )*(dden + i) % 2 == 0)) {
#line 1353
              goto while_break___6;
            }
          } else {
#line 1353
            goto while_break___6;
          }
#line 1353
          *(dnum + i) = (unsigned short )((int )*(dnum + i) / 2);
#line 1353
          *(dden + i) = (unsigned short )((int )*(dden + i) / 2);
        }
        while_break___6: /* CIL Label */ ;
        }
        {
#line 1354
        while (1) {
          while_continue___7: /* CIL Label */ ;
#line 1354
          if ((int )*(dnum + i) % 3 == 0) {
#line 1354
            if (! ((int )*(dden + i) % 3 == 0)) {
#line 1354
              goto while_break___7;
            }
          } else {
#line 1354
            goto while_break___7;
          }
#line 1354
          *(dnum + i) = (unsigned short )((int )*(dnum + i) / 3);
#line 1354
          *(dden + i) = (unsigned short )((int )*(dden + i) / 3);
        }
        while_break___7: /* CIL Label */ ;
        }
        {
#line 1355
        while (1) {
          while_continue___8: /* CIL Label */ ;
#line 1355
          if ((int )*(dnum + i) % 5 == 0) {
#line 1355
            if (! ((int )*(dden + i) % 5 == 0)) {
#line 1355
              goto while_break___8;
            }
          } else {
#line 1355
            goto while_break___8;
          }
#line 1355
          *(dnum + i) = (unsigned short )((int )*(dnum + i) / 5);
#line 1355
          *(dden + i) = (unsigned short )((int )*(dden + i) / 5);
        }
        while_break___8: /* CIL Label */ ;
        }
      }
#line 1358
      dp = sp + imgstride;
#line 1359
      j = i + 1U;
      {
#line 1359
      while (1) {
        while_continue___9: /* CIL Label */ ;
#line 1359
        if (! (j < frames)) {
#line 1359
          goto while_break___9;
        }
        {
#line 1361
        memcpy((void */* __restrict  */)dp, (void const   */* __restrict  */)(dp + imgstride),
               (size_t )imgstride);
#line 1362
        *(dnum + j) = *(dnum + (j + 1U));
#line 1363
        *(dden + j) = *(dden + (j + 1U));
#line 1359
        j ++;
#line 1359
        dp += imgstride;
        }
      }
      while_break___9: /* CIL Label */ ;
      }
#line 1366
      frames --;
#line 1366
      if (frames == i) {
#line 1366
        goto while_break___5;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
#line 1342
    i ++;
#line 1342
    sp += imgstride;
  }
  while_break___4: /* CIL Label */ ;
  }
#line 1372
  has_tcolor = 0U;
#line 1373
  trnssize = 0U;
#line 1373
  palsize = trnssize;
#line 1374
  colors = 0U;
#line 1376
  if ((int )coltype == 6) {
#line 1376
    if (! keep_coltype) {
#line 1378
      transparent = 255;
#line 1379
      simple_trans = 1;
#line 1380
      grayscale = 1;
#line 1382
      i = first;
      {
#line 1382
      while (1) {
        while_continue___10: /* CIL Label */ ;
#line 1382
        if (! (i <= frames)) {
#line 1382
          goto while_break___10;
        }
#line 1384
        sp = pdata + imgstride * i;
#line 1385
        j = 0U;
        {
#line 1385
        while (1) {
          while_continue___11: /* CIL Label */ ;
#line 1385
          if (! (j < width * height)) {
#line 1385
            goto while_break___11;
          }
#line 1387
          tmp___5 = sp;
#line 1387
          sp ++;
#line 1387
          r = *tmp___5;
#line 1388
          tmp___6 = sp;
#line 1388
          sp ++;
#line 1388
          g = *tmp___6;
#line 1389
          tmp___7 = sp;
#line 1389
          sp ++;
#line 1389
          b = *tmp___7;
#line 1390
          tmp___8 = sp;
#line 1390
          sp ++;
#line 1390
          a = *tmp___8;
#line 1391
          transparent &= (int )a;
#line 1393
          if ((int )a != 0) {
#line 1395
            if ((int )a != 255) {
#line 1396
              simple_trans = 0;
            } else
#line 1398
            if (((((int )r | (int )g) | (int )b) & 15) == 0) {
#line 1399
              cube[(((int )r << 4) + (int )g) + ((int )b >> 4)] = (unsigned char)1;
            }
#line 1401
            if ((int )r != (int )g) {
#line 1402
              grayscale = 0;
            } else
#line 1401
            if ((int )g != (int )b) {
#line 1402
              grayscale = 0;
            } else {
#line 1404
              gray[r] = (unsigned char)1;
            }
          }
#line 1407
          if (colors <= 256U) {
#line 1409
            found = 0;
#line 1410
            k = 0U;
            {
#line 1410
            while (1) {
              while_continue___12: /* CIL Label */ ;
#line 1410
              if (! (k < colors)) {
#line 1410
                goto while_break___12;
              }
#line 1411
              if ((int )col[k].r == (int )r) {
#line 1411
                if ((int )col[k].g == (int )g) {
#line 1411
                  if ((int )col[k].b == (int )b) {
#line 1411
                    if ((int )col[k].a == (int )a) {
#line 1413
                      found = 1;
#line 1414
                      (col[k].num) ++;
#line 1415
                      goto while_break___12;
                    }
                  }
                }
              }
#line 1410
              k ++;
            }
            while_break___12: /* CIL Label */ ;
            }
#line 1417
            if (found == 0) {
#line 1419
              if (colors < 256U) {
#line 1421
                (col[colors].num) ++;
#line 1422
                col[colors].r = r;
#line 1423
                col[colors].g = g;
#line 1424
                col[colors].b = b;
#line 1425
                col[colors].a = a;
#line 1426
                if ((int )a == 0) {
#line 1426
                  has_tcolor = 1U;
                }
              }
#line 1428
              colors ++;
            }
          }
#line 1385
          j ++;
        }
        while_break___11: /* CIL Label */ ;
        }
#line 1382
        i ++;
      }
      while_break___10: /* CIL Label */ ;
      }
#line 1434
      if (grayscale) {
#line 1434
        if (simple_trans) {
#line 1434
          if (colors <= 256U) {
#line 1436
            coltype = (unsigned char)0;
#line 1438
            i = 0U;
            {
#line 1438
            while (1) {
              while_continue___13: /* CIL Label */ ;
#line 1438
              if (! (i < 256U)) {
#line 1438
                goto while_break___13;
              }
#line 1439
              if ((int )gray[i] == 0) {
#line 1441
                trns[0] = (unsigned char)0;
#line 1442
                trns[1] = (unsigned char )i;
#line 1443
                trnssize = 2U;
#line 1444
                goto while_break___13;
              }
#line 1438
              i ++;
            }
            while_break___13: /* CIL Label */ ;
            }
#line 1447
            i = first;
            {
#line 1447
            while (1) {
              while_continue___14: /* CIL Label */ ;
#line 1447
              if (! (i <= frames)) {
#line 1447
                goto while_break___14;
              }
#line 1449
              dp = pdata + imgstride * i;
#line 1449
              sp = dp;
#line 1450
              j = 0U;
              {
#line 1450
              while (1) {
                while_continue___15: /* CIL Label */ ;
#line 1450
                if (! (j < width * height)) {
#line 1450
                  goto while_break___15;
                }
#line 1452
                tmp___9 = sp;
#line 1452
                sp ++;
#line 1452
                r = *tmp___9;
#line 1453
                tmp___10 = sp;
#line 1453
                sp ++;
#line 1453
                g = *tmp___10;
#line 1454
                tmp___11 = sp;
#line 1454
                sp ++;
#line 1454
                b = *tmp___11;
#line 1455
                tmp___14 = sp;
#line 1455
                sp ++;
#line 1455
                if ((int )*tmp___14 == 0) {
#line 1456
                  tmp___12 = dp;
#line 1456
                  dp ++;
#line 1456
                  *tmp___12 = trns[1];
                } else {
#line 1458
                  tmp___13 = dp;
#line 1458
                  dp ++;
#line 1458
                  *tmp___13 = g;
                }
#line 1450
                j ++;
              }
              while_break___15: /* CIL Label */ ;
              }
#line 1447
              i ++;
            }
            while_break___14: /* CIL Label */ ;
            }
          } else {
#line 1434
            goto _L___0;
          }
        } else {
#line 1434
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 1463
      if (colors <= 256U) {
#line 1465
        coltype = (unsigned char)3;
#line 1467
        if (has_tcolor == 0U) {
#line 1467
          if (colors < 256U) {
#line 1468
            tmp___15 = colors;
#line 1468
            colors ++;
#line 1468
            col[tmp___15].a = (unsigned char)0;
          }
        }
        {
#line 1470
        qsort((void *)(& col[0]), (size_t )colors, sizeof(COLORS ), & cmp_colors);
#line 1472
        palsize = colors;
#line 1473
        i = 0U;
        }
        {
#line 1473
        while (1) {
          while_continue___16: /* CIL Label */ ;
#line 1473
          if (! (i < colors)) {
#line 1473
            goto while_break___16;
          }
#line 1475
          palette[i].r = col[i].r;
#line 1476
          palette[i].g = col[i].g;
#line 1477
          palette[i].b = col[i].b;
#line 1478
          trns[i] = col[i].a;
#line 1479
          if ((int )trns[i] != 255) {
#line 1479
            trnssize = i + 1U;
          }
#line 1473
          i ++;
        }
        while_break___16: /* CIL Label */ ;
        }
#line 1482
        i = first;
        {
#line 1482
        while (1) {
          while_continue___17: /* CIL Label */ ;
#line 1482
          if (! (i <= frames)) {
#line 1482
            goto while_break___17;
          }
#line 1484
          dp = pdata + imgstride * i;
#line 1484
          sp = dp;
#line 1485
          j = 0U;
          {
#line 1485
          while (1) {
            while_continue___18: /* CIL Label */ ;
#line 1485
            if (! (j < width * height)) {
#line 1485
              goto while_break___18;
            }
#line 1487
            tmp___16 = sp;
#line 1487
            sp ++;
#line 1487
            r = *tmp___16;
#line 1488
            tmp___17 = sp;
#line 1488
            sp ++;
#line 1488
            g = *tmp___17;
#line 1489
            tmp___18 = sp;
#line 1489
            sp ++;
#line 1489
            b = *tmp___18;
#line 1490
            tmp___19 = sp;
#line 1490
            sp ++;
#line 1490
            a = *tmp___19;
#line 1491
            k = 0U;
            {
#line 1491
            while (1) {
              while_continue___19: /* CIL Label */ ;
#line 1491
              if (! (k < colors)) {
#line 1491
                goto while_break___19;
              }
#line 1492
              if ((int )col[k].r == (int )r) {
#line 1492
                if ((int )col[k].g == (int )g) {
#line 1492
                  if ((int )col[k].b == (int )b) {
#line 1492
                    if ((int )col[k].a == (int )a) {
#line 1493
                      goto while_break___19;
                    }
                  }
                }
              }
#line 1491
              k ++;
            }
            while_break___19: /* CIL Label */ ;
            }
#line 1494
            tmp___20 = dp;
#line 1494
            dp ++;
#line 1494
            *tmp___20 = (unsigned char )k;
#line 1485
            j ++;
          }
          while_break___18: /* CIL Label */ ;
          }
#line 1482
          i ++;
        }
        while_break___17: /* CIL Label */ ;
        }
      } else
#line 1499
      if (grayscale) {
#line 1501
        coltype = (unsigned char)4;
#line 1502
        i = first;
        {
#line 1502
        while (1) {
          while_continue___20: /* CIL Label */ ;
#line 1502
          if (! (i <= frames)) {
#line 1502
            goto while_break___20;
          }
#line 1504
          dp = pdata + imgstride * i;
#line 1504
          sp = dp;
#line 1505
          j = 0U;
          {
#line 1505
          while (1) {
            while_continue___21: /* CIL Label */ ;
#line 1505
            if (! (j < width * height)) {
#line 1505
              goto while_break___21;
            }
#line 1507
            tmp___21 = sp;
#line 1507
            sp ++;
#line 1507
            r = *tmp___21;
#line 1508
            tmp___22 = sp;
#line 1508
            sp ++;
#line 1508
            g = *tmp___22;
#line 1509
            tmp___23 = dp;
#line 1509
            dp ++;
#line 1509
            tmp___24 = sp;
#line 1509
            sp ++;
#line 1509
            *tmp___23 = *tmp___24;
#line 1510
            tmp___25 = dp;
#line 1510
            dp ++;
#line 1510
            tmp___26 = sp;
#line 1510
            sp ++;
#line 1510
            *tmp___25 = *tmp___26;
#line 1505
            j ++;
          }
          while_break___21: /* CIL Label */ ;
          }
#line 1502
          i ++;
        }
        while_break___20: /* CIL Label */ ;
        }
      } else
#line 1515
      if (simple_trans) {
#line 1517
        i = 0U;
        {
#line 1517
        while (1) {
          while_continue___22: /* CIL Label */ ;
#line 1517
          if (! (i < 4096U)) {
#line 1517
            goto while_break___22;
          }
#line 1518
          if ((int )cube[i] == 0) {
#line 1520
            trns[0] = (unsigned char)0;
#line 1521
            trns[1] = (unsigned char )((i >> 4) & 240U);
#line 1522
            trns[2] = (unsigned char)0;
#line 1523
            trns[3] = (unsigned char )(i & 240U);
#line 1524
            trns[4] = (unsigned char)0;
#line 1525
            trns[5] = (unsigned char )((i << 4) & 240U);
#line 1526
            trnssize = 6U;
#line 1527
            goto while_break___22;
          }
#line 1517
          i ++;
        }
        while_break___22: /* CIL Label */ ;
        }
#line 1529
        if (transparent == 255) {
#line 1531
          coltype = (unsigned char)2;
#line 1532
          i = first;
          {
#line 1532
          while (1) {
            while_continue___23: /* CIL Label */ ;
#line 1532
            if (! (i <= frames)) {
#line 1532
              goto while_break___23;
            }
#line 1534
            dp = pdata + imgstride * i;
#line 1534
            sp = dp;
#line 1535
            j = 0U;
            {
#line 1535
            while (1) {
              while_continue___24: /* CIL Label */ ;
#line 1535
              if (! (j < width * height)) {
#line 1535
                goto while_break___24;
              }
#line 1537
              tmp___27 = dp;
#line 1537
              dp ++;
#line 1537
              tmp___28 = sp;
#line 1537
              sp ++;
#line 1537
              *tmp___27 = *tmp___28;
#line 1538
              tmp___29 = dp;
#line 1538
              dp ++;
#line 1538
              tmp___30 = sp;
#line 1538
              sp ++;
#line 1538
              *tmp___29 = *tmp___30;
#line 1539
              tmp___31 = dp;
#line 1539
              dp ++;
#line 1539
              tmp___32 = sp;
#line 1539
              sp ++;
#line 1539
              *tmp___31 = *tmp___32;
#line 1540
              sp ++;
#line 1535
              j ++;
            }
            while_break___24: /* CIL Label */ ;
            }
#line 1532
            i ++;
          }
          while_break___23: /* CIL Label */ ;
          }
        } else
#line 1545
        if (trnssize != 0U) {
#line 1547
          coltype = (unsigned char)2;
#line 1548
          i = first;
          {
#line 1548
          while (1) {
            while_continue___25: /* CIL Label */ ;
#line 1548
            if (! (i <= frames)) {
#line 1548
              goto while_break___25;
            }
#line 1550
            dp = pdata + imgstride * i;
#line 1550
            sp = dp;
#line 1551
            j = 0U;
            {
#line 1551
            while (1) {
              while_continue___26: /* CIL Label */ ;
#line 1551
              if (! (j < width * height)) {
#line 1551
                goto while_break___26;
              }
#line 1553
              tmp___33 = sp;
#line 1553
              sp ++;
#line 1553
              r = *tmp___33;
#line 1554
              tmp___34 = sp;
#line 1554
              sp ++;
#line 1554
              g = *tmp___34;
#line 1555
              tmp___35 = sp;
#line 1555
              sp ++;
#line 1555
              b = *tmp___35;
#line 1556
              tmp___36 = sp;
#line 1556
              sp ++;
#line 1556
              a = *tmp___36;
#line 1557
              if ((int )a == 0) {
#line 1559
                tmp___37 = dp;
#line 1559
                dp ++;
#line 1559
                *tmp___37 = trns[1];
#line 1560
                tmp___38 = dp;
#line 1560
                dp ++;
#line 1560
                *tmp___38 = trns[3];
#line 1561
                tmp___39 = dp;
#line 1561
                dp ++;
#line 1561
                *tmp___39 = trns[5];
              } else {
#line 1565
                tmp___40 = dp;
#line 1565
                dp ++;
#line 1565
                *tmp___40 = r;
#line 1566
                tmp___41 = dp;
#line 1566
                dp ++;
#line 1566
                *tmp___41 = g;
#line 1567
                tmp___42 = dp;
#line 1567
                dp ++;
#line 1567
                *tmp___42 = b;
              }
#line 1551
              j ++;
            }
            while_break___26: /* CIL Label */ ;
            }
#line 1548
            i ++;
          }
          while_break___25: /* CIL Label */ ;
          }
        }
      }
    } else {
#line 1376
      goto _L___8;
    }
  } else
  _L___8: /* CIL Label */ 
#line 1575
  if ((int )coltype == 2) {
#line 1577
    grayscale___0 = 1;
#line 1579
    i = first;
    {
#line 1579
    while (1) {
      while_continue___27: /* CIL Label */ ;
#line 1579
      if (! (i <= frames)) {
#line 1579
        goto while_break___27;
      }
#line 1581
      sp = pdata + imgstride * i;
#line 1582
      j = 0U;
      {
#line 1582
      while (1) {
        while_continue___28: /* CIL Label */ ;
#line 1582
        if (! (j < width * height)) {
#line 1582
          goto while_break___28;
        }
#line 1584
        tmp___43 = sp;
#line 1584
        sp ++;
#line 1584
        r = *tmp___43;
#line 1585
        tmp___44 = sp;
#line 1585
        sp ++;
#line 1585
        g = *tmp___44;
#line 1586
        tmp___45 = sp;
#line 1586
        sp ++;
#line 1586
        b = *tmp___45;
#line 1588
        if (ts == 0) {
#line 1589
          if (((((int )r | (int )g) | (int )b) & 15) == 0) {
#line 1590
            cube[(((int )r << 4) + (int )g) + ((int )b >> 4)] = (unsigned char)1;
          }
        }
#line 1592
        if ((int )r != (int )g) {
#line 1593
          grayscale___0 = 0;
        } else
#line 1592
        if ((int )g != (int )b) {
#line 1593
          grayscale___0 = 0;
        } else {
#line 1595
          gray[r] = (unsigned char)1;
        }
#line 1597
        if (colors <= 256U) {
#line 1599
          found___0 = 0;
#line 1600
          k = 0U;
          {
#line 1600
          while (1) {
            while_continue___29: /* CIL Label */ ;
#line 1600
            if (! (k < colors)) {
#line 1600
              goto while_break___29;
            }
#line 1601
            if ((int )col[k].r == (int )r) {
#line 1601
              if ((int )col[k].g == (int )g) {
#line 1601
                if ((int )col[k].b == (int )b) {
#line 1603
                  found___0 = 1;
#line 1604
                  (col[k].num) ++;
#line 1605
                  goto while_break___29;
                }
              }
            }
#line 1600
            k ++;
          }
          while_break___29: /* CIL Label */ ;
          }
#line 1607
          if (found___0 == 0) {
#line 1609
            if (colors < 256U) {
#line 1611
              (col[colors].num) ++;
#line 1612
              col[colors].r = r;
#line 1613
              col[colors].g = g;
#line 1614
              col[colors].b = b;
#line 1615
              if (ts == 6) {
#line 1615
                if ((int )tr[1] == (int )r) {
#line 1615
                  if ((int )tr[3] == (int )g) {
#line 1615
                    if ((int )tr[5] == (int )b) {
#line 1617
                      col[colors].a = (unsigned char)0;
#line 1618
                      has_tcolor = 1U;
                    }
                  }
                }
              }
            }
#line 1621
            colors ++;
          }
        }
#line 1582
        j ++;
      }
      while_break___28: /* CIL Label */ ;
      }
#line 1579
      i ++;
    }
    while_break___27: /* CIL Label */ ;
    }
#line 1627
    if (grayscale___0) {
#line 1627
      if (colors <= 256U) {
#line 1627
        if (! keep_coltype) {
#line 1629
          i = 0U;
          {
#line 1629
          while (1) {
            while_continue___30: /* CIL Label */ ;
#line 1629
            if (! (i < 256U)) {
#line 1629
              goto while_break___30;
            }
#line 1630
            if ((int )gray[i] == 0) {
#line 1632
              trns[0] = (unsigned char)0;
#line 1633
              trns[1] = (unsigned char )i;
#line 1634
              trnssize = 2U;
#line 1635
              goto while_break___30;
            }
#line 1629
            i ++;
          }
          while_break___30: /* CIL Label */ ;
          }
#line 1637
          if (ts == 0) {
#line 1639
            coltype = (unsigned char)0;
#line 1640
            i = first;
            {
#line 1640
            while (1) {
              while_continue___31: /* CIL Label */ ;
#line 1640
              if (! (i <= frames)) {
#line 1640
                goto while_break___31;
              }
#line 1642
              dp = pdata + imgstride * i;
#line 1642
              sp = dp;
#line 1643
              j = 0U;
              {
#line 1643
              while (1) {
                while_continue___32: /* CIL Label */ ;
#line 1643
                if (! (j < width * height)) {
#line 1643
                  goto while_break___32;
                }
#line 1644
                tmp___46 = dp;
#line 1644
                dp ++;
#line 1644
                *tmp___46 = *sp;
#line 1643
                j ++;
#line 1643
                sp += 3;
              }
              while_break___32: /* CIL Label */ ;
              }
#line 1640
              i ++;
            }
            while_break___31: /* CIL Label */ ;
            }
          } else
#line 1648
          if (trnssize != 0U) {
#line 1650
            coltype = (unsigned char)0;
#line 1651
            i = first;
            {
#line 1651
            while (1) {
              while_continue___33: /* CIL Label */ ;
#line 1651
              if (! (i <= frames)) {
#line 1651
                goto while_break___33;
              }
#line 1653
              dp = pdata + imgstride * i;
#line 1653
              sp = dp;
#line 1654
              j = 0U;
              {
#line 1654
              while (1) {
                while_continue___34: /* CIL Label */ ;
#line 1654
                if (! (j < width * height)) {
#line 1654
                  goto while_break___34;
                }
#line 1656
                tmp___47 = sp;
#line 1656
                sp ++;
#line 1656
                r = *tmp___47;
#line 1657
                tmp___48 = sp;
#line 1657
                sp ++;
#line 1657
                g = *tmp___48;
#line 1658
                tmp___49 = sp;
#line 1658
                sp ++;
#line 1658
                b = *tmp___49;
#line 1659
                if ((int )tr[1] == (int )r) {
#line 1659
                  if ((int )tr[3] == (int )g) {
#line 1659
                    if ((int )tr[5] == (int )b) {
#line 1660
                      tmp___50 = dp;
#line 1660
                      dp ++;
#line 1660
                      *tmp___50 = trns[1];
                    } else {
#line 1662
                      tmp___51 = dp;
#line 1662
                      dp ++;
#line 1662
                      *tmp___51 = g;
                    }
                  } else {
#line 1662
                    tmp___51 = dp;
#line 1662
                    dp ++;
#line 1662
                    *tmp___51 = g;
                  }
                } else {
#line 1662
                  tmp___51 = dp;
#line 1662
                  dp ++;
#line 1662
                  *tmp___51 = g;
                }
#line 1654
                j ++;
              }
              while_break___34: /* CIL Label */ ;
              }
#line 1651
              i ++;
            }
            while_break___33: /* CIL Label */ ;
            }
          }
        } else {
#line 1627
          goto _L___3;
        }
      } else {
#line 1627
        goto _L___3;
      }
    } else
    _L___3: /* CIL Label */ 
#line 1668
    if (colors <= 256U) {
#line 1668
      if (! keep_coltype) {
#line 1670
        coltype = (unsigned char)3;
#line 1672
        if (has_tcolor == 0U) {
#line 1672
          if (colors < 256U) {
#line 1673
            tmp___52 = colors;
#line 1673
            colors ++;
#line 1673
            col[tmp___52].a = (unsigned char)0;
          }
        }
        {
#line 1675
        qsort((void *)(& col[0]), (size_t )colors, sizeof(COLORS ), & cmp_colors);
#line 1677
        palsize = colors;
#line 1678
        i = 0U;
        }
        {
#line 1678
        while (1) {
          while_continue___35: /* CIL Label */ ;
#line 1678
          if (! (i < colors)) {
#line 1678
            goto while_break___35;
          }
#line 1680
          palette[i].r = col[i].r;
#line 1681
          palette[i].g = col[i].g;
#line 1682
          palette[i].b = col[i].b;
#line 1683
          trns[i] = col[i].a;
#line 1684
          if ((int )trns[i] != 255) {
#line 1684
            trnssize = i + 1U;
          }
#line 1678
          i ++;
        }
        while_break___35: /* CIL Label */ ;
        }
#line 1687
        i = first;
        {
#line 1687
        while (1) {
          while_continue___36: /* CIL Label */ ;
#line 1687
          if (! (i <= frames)) {
#line 1687
            goto while_break___36;
          }
#line 1689
          dp = pdata + imgstride * i;
#line 1689
          sp = dp;
#line 1690
          j = 0U;
          {
#line 1690
          while (1) {
            while_continue___37: /* CIL Label */ ;
#line 1690
            if (! (j < width * height)) {
#line 1690
              goto while_break___37;
            }
#line 1692
            tmp___53 = sp;
#line 1692
            sp ++;
#line 1692
            r = *tmp___53;
#line 1693
            tmp___54 = sp;
#line 1693
            sp ++;
#line 1693
            g = *tmp___54;
#line 1694
            tmp___55 = sp;
#line 1694
            sp ++;
#line 1694
            b = *tmp___55;
#line 1696
            k = 0U;
            {
#line 1696
            while (1) {
              while_continue___38: /* CIL Label */ ;
#line 1696
              if (! (k < colors)) {
#line 1696
                goto while_break___38;
              }
#line 1697
              if ((int )col[k].r == (int )r) {
#line 1697
                if ((int )col[k].g == (int )g) {
#line 1697
                  if ((int )col[k].b == (int )b) {
#line 1698
                    goto while_break___38;
                  }
                }
              }
#line 1696
              k ++;
            }
            while_break___38: /* CIL Label */ ;
            }
#line 1699
            tmp___56 = dp;
#line 1699
            dp ++;
#line 1699
            *tmp___56 = (unsigned char )k;
#line 1690
            j ++;
          }
          while_break___37: /* CIL Label */ ;
          }
#line 1687
          i ++;
        }
        while_break___36: /* CIL Label */ ;
        }
      } else {
#line 1668
        goto _L___1;
      }
    } else
    _L___1: /* CIL Label */ 
#line 1705
    if (ts != 0) {
      {
#line 1707
      memcpy((void */* __restrict  */)(trns), (void const   */* __restrict  */)(tr),
             (size_t )ts);
#line 1708
      trnssize = (unsigned int )ts;
      }
    } else {
#line 1711
      i = 0U;
      {
#line 1711
      while (1) {
        while_continue___39: /* CIL Label */ ;
#line 1711
        if (! (i < 4096U)) {
#line 1711
          goto while_break___39;
        }
#line 1712
        if ((int )cube[i] == 0) {
#line 1714
          trns[0] = (unsigned char)0;
#line 1715
          trns[1] = (unsigned char )((i >> 4) & 240U);
#line 1716
          trns[2] = (unsigned char)0;
#line 1717
          trns[3] = (unsigned char )(i & 240U);
#line 1718
          trns[4] = (unsigned char)0;
#line 1719
          trns[5] = (unsigned char )((i << 4) & 240U);
#line 1720
          trnssize = 6U;
#line 1721
          goto while_break___39;
        }
#line 1711
        i ++;
      }
      while_break___39: /* CIL Label */ ;
      }
    }
  } else
#line 1726
  if ((int )coltype == 4) {
#line 1726
    if (! keep_coltype) {
#line 1728
      simple_trans___0 = 1;
#line 1730
      i = first;
      {
#line 1730
      while (1) {
        while_continue___40: /* CIL Label */ ;
#line 1730
        if (! (i <= frames)) {
#line 1730
          goto while_break___40;
        }
#line 1732
        sp = pdata + imgstride * i;
#line 1733
        j = 0U;
        {
#line 1733
        while (1) {
          while_continue___41: /* CIL Label */ ;
#line 1733
          if (! (j < width * height)) {
#line 1733
            goto while_break___41;
          }
#line 1735
          tmp___57 = sp;
#line 1735
          sp ++;
#line 1735
          g = *tmp___57;
#line 1736
          tmp___58 = sp;
#line 1736
          sp ++;
#line 1736
          a = *tmp___58;
#line 1738
          if ((int )a != 0) {
#line 1740
            if ((int )a != 255) {
#line 1741
              simple_trans___0 = 0;
            } else {
#line 1743
              gray[g] = (unsigned char)1;
            }
          }
#line 1746
          if (colors <= 256U) {
#line 1748
            found___1 = 0;
#line 1749
            k = 0U;
            {
#line 1749
            while (1) {
              while_continue___42: /* CIL Label */ ;
#line 1749
              if (! (k < colors)) {
#line 1749
                goto while_break___42;
              }
#line 1750
              if ((int )col[k].g == (int )g) {
#line 1750
                if ((int )col[k].a == (int )a) {
#line 1752
                  found___1 = 1;
#line 1753
                  (col[k].num) ++;
#line 1754
                  goto while_break___42;
                }
              }
#line 1749
              k ++;
            }
            while_break___42: /* CIL Label */ ;
            }
#line 1756
            if (found___1 == 0) {
#line 1758
              if (colors < 256U) {
#line 1760
                (col[colors].num) ++;
#line 1761
                col[colors].r = g;
#line 1762
                col[colors].g = g;
#line 1763
                col[colors].b = g;
#line 1764
                col[colors].a = a;
#line 1765
                if ((int )a == 0) {
#line 1765
                  has_tcolor = 1U;
                }
              }
#line 1767
              colors ++;
            }
          }
#line 1733
          j ++;
        }
        while_break___41: /* CIL Label */ ;
        }
#line 1730
        i ++;
      }
      while_break___40: /* CIL Label */ ;
      }
#line 1773
      if (simple_trans___0) {
#line 1773
        if (colors <= 256U) {
#line 1775
          coltype = (unsigned char)0;
#line 1777
          i = 0U;
          {
#line 1777
          while (1) {
            while_continue___43: /* CIL Label */ ;
#line 1777
            if (! (i < 256U)) {
#line 1777
              goto while_break___43;
            }
#line 1778
            if ((int )gray[i] == 0) {
#line 1780
              trns[0] = (unsigned char)0;
#line 1781
              trns[1] = (unsigned char )i;
#line 1782
              trnssize = 2U;
#line 1783
              goto while_break___43;
            }
#line 1777
            i ++;
          }
          while_break___43: /* CIL Label */ ;
          }
#line 1786
          i = first;
          {
#line 1786
          while (1) {
            while_continue___44: /* CIL Label */ ;
#line 1786
            if (! (i <= frames)) {
#line 1786
              goto while_break___44;
            }
#line 1788
            dp = pdata + imgstride * i;
#line 1788
            sp = dp;
#line 1789
            j = 0U;
            {
#line 1789
            while (1) {
              while_continue___45: /* CIL Label */ ;
#line 1789
              if (! (j < width * height)) {
#line 1789
                goto while_break___45;
              }
#line 1791
              tmp___59 = sp;
#line 1791
              sp ++;
#line 1791
              g = *tmp___59;
#line 1792
              tmp___62 = sp;
#line 1792
              sp ++;
#line 1792
              if ((int )*tmp___62 == 0) {
#line 1793
                tmp___60 = dp;
#line 1793
                dp ++;
#line 1793
                *tmp___60 = trns[1];
              } else {
#line 1795
                tmp___61 = dp;
#line 1795
                dp ++;
#line 1795
                *tmp___61 = g;
              }
#line 1789
              j ++;
            }
            while_break___45: /* CIL Label */ ;
            }
#line 1786
            i ++;
          }
          while_break___44: /* CIL Label */ ;
          }
        } else {
#line 1773
          goto _L___4;
        }
      } else
      _L___4: /* CIL Label */ 
#line 1800
      if (colors <= 256U) {
#line 1802
        coltype = (unsigned char)3;
#line 1804
        if (has_tcolor == 0U) {
#line 1804
          if (colors < 256U) {
#line 1805
            tmp___63 = colors;
#line 1805
            colors ++;
#line 1805
            col[tmp___63].a = (unsigned char)0;
          }
        }
        {
#line 1807
        qsort((void *)(& col[0]), (size_t )colors, sizeof(COLORS ), & cmp_colors);
#line 1809
        palsize = colors;
#line 1810
        i = 0U;
        }
        {
#line 1810
        while (1) {
          while_continue___46: /* CIL Label */ ;
#line 1810
          if (! (i < colors)) {
#line 1810
            goto while_break___46;
          }
#line 1812
          palette[i].r = col[i].r;
#line 1813
          palette[i].g = col[i].g;
#line 1814
          palette[i].b = col[i].b;
#line 1815
          trns[i] = col[i].a;
#line 1816
          if ((int )trns[i] != 255) {
#line 1816
            trnssize = i + 1U;
          }
#line 1810
          i ++;
        }
        while_break___46: /* CIL Label */ ;
        }
#line 1819
        i = first;
        {
#line 1819
        while (1) {
          while_continue___47: /* CIL Label */ ;
#line 1819
          if (! (i <= frames)) {
#line 1819
            goto while_break___47;
          }
#line 1821
          dp = pdata + imgstride * i;
#line 1821
          sp = dp;
#line 1822
          j = 0U;
          {
#line 1822
          while (1) {
            while_continue___48: /* CIL Label */ ;
#line 1822
            if (! (j < width * height)) {
#line 1822
              goto while_break___48;
            }
#line 1824
            tmp___64 = sp;
#line 1824
            sp ++;
#line 1824
            g = *tmp___64;
#line 1825
            tmp___65 = sp;
#line 1825
            sp ++;
#line 1825
            a = *tmp___65;
#line 1826
            k = 0U;
            {
#line 1826
            while (1) {
              while_continue___49: /* CIL Label */ ;
#line 1826
              if (! (k < colors)) {
#line 1826
                goto while_break___49;
              }
#line 1827
              if ((int )col[k].g == (int )g) {
#line 1827
                if ((int )col[k].a == (int )a) {
#line 1828
                  goto while_break___49;
                }
              }
#line 1826
              k ++;
            }
            while_break___49: /* CIL Label */ ;
            }
#line 1829
            tmp___66 = dp;
#line 1829
            dp ++;
#line 1829
            *tmp___66 = (unsigned char )k;
#line 1822
            j ++;
          }
          while_break___48: /* CIL Label */ ;
          }
#line 1819
          i ++;
        }
        while_break___47: /* CIL Label */ ;
        }
      }
    } else {
#line 1726
      goto _L___7;
    }
  } else
  _L___7: /* CIL Label */ 
#line 1835
  if ((int )coltype == 3) {
#line 1837
    simple_trans___1 = 1;
#line 1838
    grayscale___1 = 1;
#line 1840
    c = 0;
    {
#line 1840
    while (1) {
      while_continue___50: /* CIL Label */ ;
#line 1840
      if (! (c < ps)) {
#line 1840
        goto while_break___50;
      }
#line 1842
      col[c].r = pl[c][0];
#line 1843
      col[c].g = pl[c][1];
#line 1844
      col[c].b = pl[c][2];
#line 1845
      col[c].a = tr[c];
#line 1840
      c ++;
    }
    while_break___50: /* CIL Label */ ;
    }
#line 1848
    i = first;
    {
#line 1848
    while (1) {
      while_continue___51: /* CIL Label */ ;
#line 1848
      if (! (i <= frames)) {
#line 1848
        goto while_break___51;
      }
#line 1850
      sp = pdata + imgstride * i;
#line 1851
      j = 0U;
      {
#line 1851
      while (1) {
        while_continue___52: /* CIL Label */ ;
#line 1851
        if (! (j < width * height)) {
#line 1851
          goto while_break___52;
        }
#line 1852
        tmp___67 = sp;
#line 1852
        sp ++;
#line 1852
        (col[*tmp___67].num) ++;
#line 1851
        j ++;
      }
      while_break___52: /* CIL Label */ ;
      }
#line 1848
      i ++;
    }
    while_break___51: /* CIL Label */ ;
    }
#line 1855
    i = 0U;
    {
#line 1855
    while (1) {
      while_continue___53: /* CIL Label */ ;
#line 1855
      if (! (i < 256U)) {
#line 1855
        goto while_break___53;
      }
#line 1856
      if (col[i].num != 0U) {
#line 1858
        colors = i + 1U;
#line 1859
        if ((int )col[i].a != 0) {
#line 1861
          if ((int )col[i].a != 255) {
#line 1862
            simple_trans___1 = 0;
          } else
#line 1864
          if ((int )col[i].r != (int )col[i].g) {
#line 1865
            grayscale___1 = 0;
          } else
#line 1864
          if ((int )col[i].g != (int )col[i].b) {
#line 1865
            grayscale___1 = 0;
          } else {
#line 1867
            gray[col[i].g] = (unsigned char)1;
          }
        } else {
#line 1870
          has_tcolor = 1U;
        }
      }
#line 1855
      i ++;
    }
    while_break___53: /* CIL Label */ ;
    }
#line 1873
    if (grayscale___1) {
#line 1873
      if (simple_trans___1) {
#line 1873
        if (! keep_coltype) {
#line 1875
          i = 0U;
          {
#line 1875
          while (1) {
            while_continue___54: /* CIL Label */ ;
#line 1875
            if (! (i < 256U)) {
#line 1875
              goto while_break___54;
            }
#line 1876
            if ((int )gray[i] == 0) {
#line 1878
              trns[0] = (unsigned char)0;
#line 1879
              trns[1] = (unsigned char )i;
#line 1880
              trnssize = 2U;
#line 1881
              goto while_break___54;
            }
#line 1875
            i ++;
          }
          while_break___54: /* CIL Label */ ;
          }
#line 1883
          if (! has_tcolor) {
#line 1885
            coltype = (unsigned char)0;
#line 1886
            i = first;
            {
#line 1886
            while (1) {
              while_continue___55: /* CIL Label */ ;
#line 1886
              if (! (i <= frames)) {
#line 1886
                goto while_break___55;
              }
#line 1888
              sp = pdata + imgstride * i;
#line 1889
              j = 0U;
              {
#line 1889
              while (1) {
                while_continue___56: /* CIL Label */ ;
#line 1889
                if (! (j < width * height)) {
#line 1889
                  goto while_break___56;
                }
#line 1890
                *sp = pl[*sp][0];
#line 1889
                j ++;
#line 1889
                sp ++;
              }
              while_break___56: /* CIL Label */ ;
              }
#line 1886
              i ++;
            }
            while_break___55: /* CIL Label */ ;
            }
          } else
#line 1894
          if (trnssize != 0U) {
#line 1896
            coltype = (unsigned char)0;
#line 1897
            i = first;
            {
#line 1897
            while (1) {
              while_continue___57: /* CIL Label */ ;
#line 1897
              if (! (i <= frames)) {
#line 1897
                goto while_break___57;
              }
#line 1899
              sp = pdata + imgstride * i;
#line 1900
              j = 0U;
              {
#line 1900
              while (1) {
                while_continue___58: /* CIL Label */ ;
#line 1900
                if (! (j < width * height)) {
#line 1900
                  goto while_break___58;
                }
#line 1902
                if ((int )col[*sp].a == 0) {
#line 1903
                  *sp = trns[1];
                } else {
#line 1905
                  *sp = pl[*sp][0];
                }
#line 1900
                j ++;
#line 1900
                sp ++;
              }
              while_break___58: /* CIL Label */ ;
              }
#line 1897
              i ++;
            }
            while_break___57: /* CIL Label */ ;
            }
          }
        } else {
#line 1873
          goto _L___6;
        }
      } else {
#line 1873
        goto _L___6;
      }
    } else
    _L___6: /* CIL Label */ 
#line 1911
    if (! keep_palette) {
#line 1913
      i = 0U;
      {
#line 1913
      while (1) {
        while_continue___59: /* CIL Label */ ;
#line 1913
        if (! (i < 256U)) {
#line 1913
          goto while_break___59;
        }
#line 1914
        if (col[i].num == 0U) {
#line 1916
          col[i].a = (unsigned char)255;
#line 1917
          if (! has_tcolor) {
#line 1919
            col[i].a = (unsigned char)0;
#line 1920
            has_tcolor = 1U;
          }
        }
#line 1913
        i ++;
      }
      while_break___59: /* CIL Label */ ;
      }
      {
#line 1924
      qsort((void *)(& col[0]), (size_t )256, sizeof(COLORS ), & cmp_colors);
#line 1926
      i = 0U;
      }
      {
#line 1926
      while (1) {
        while_continue___60: /* CIL Label */ ;
#line 1926
        if (! (i < 256U)) {
#line 1926
          goto while_break___60;
        }
#line 1928
        palette[i].r = col[i].r;
#line 1929
        palette[i].g = col[i].g;
#line 1930
        palette[i].b = col[i].b;
#line 1931
        trns[i] = col[i].a;
#line 1932
        if (col[i].num != 0U) {
#line 1933
          palsize = i + 1U;
        }
#line 1934
        if ((int )trns[i] != 255) {
#line 1935
          trnssize = i + 1U;
        }
#line 1926
        i ++;
      }
      while_break___60: /* CIL Label */ ;
      }
#line 1938
      i = first;
      {
#line 1938
      while (1) {
        while_continue___61: /* CIL Label */ ;
#line 1938
        if (! (i <= frames)) {
#line 1938
          goto while_break___61;
        }
#line 1940
        sp = pdata + imgstride * i;
#line 1941
        j = 0U;
        {
#line 1941
        while (1) {
          while_continue___62: /* CIL Label */ ;
#line 1941
          if (! (j < width * height)) {
#line 1941
            goto while_break___62;
          }
#line 1943
          r = pl[*sp][0];
#line 1944
          g = pl[*sp][1];
#line 1945
          b = pl[*sp][2];
#line 1946
          a = tr[*sp];
#line 1948
          k = 0U;
          {
#line 1948
          while (1) {
            while_continue___63: /* CIL Label */ ;
#line 1948
            if (! (k < palsize)) {
#line 1948
              goto while_break___63;
            }
#line 1949
            if ((int )col[k].r == (int )r) {
#line 1949
              if ((int )col[k].g == (int )g) {
#line 1949
                if ((int )col[k].b == (int )b) {
#line 1949
                  if ((int )col[k].a == (int )a) {
#line 1950
                    goto while_break___63;
                  }
                }
              }
            }
#line 1948
            k ++;
          }
          while_break___63: /* CIL Label */ ;
          }
#line 1951
          tmp___68 = sp;
#line 1951
          sp ++;
#line 1951
          *tmp___68 = (unsigned char )k;
#line 1941
          j ++;
        }
        while_break___62: /* CIL Label */ ;
        }
#line 1938
        i ++;
      }
      while_break___61: /* CIL Label */ ;
      }
    } else {
#line 1957
      palsize = (unsigned int )ps;
#line 1958
      trnssize = (unsigned int )ts;
#line 1959
      i = 0U;
      {
#line 1959
      while (1) {
        while_continue___64: /* CIL Label */ ;
#line 1959
        if (! (i < palsize)) {
#line 1959
          goto while_break___64;
        }
#line 1961
        palette[i].r = col[i].r;
#line 1962
        palette[i].g = col[i].g;
#line 1963
        palette[i].b = col[i].b;
#line 1959
        i ++;
      }
      while_break___64: /* CIL Label */ ;
      }
#line 1965
      i = 0U;
      {
#line 1965
      while (1) {
        while_continue___65: /* CIL Label */ ;
#line 1965
        if (! (i < trnssize)) {
#line 1965
          goto while_break___65;
        }
#line 1966
        trns[i] = col[i].a;
#line 1965
        i ++;
      }
      while_break___65: /* CIL Label */ ;
      }
    }
  } else
#line 1970
  if ((int )coltype == 0) {
#line 1972
    if (ts != 0) {
      {
#line 1974
      memcpy((void */* __restrict  */)(trns), (void const   */* __restrict  */)(tr),
             (size_t )ts);
#line 1975
      trnssize = (unsigned int )ts;
      }
    } else {
#line 1979
      i = first;
      {
#line 1979
      while (1) {
        while_continue___66: /* CIL Label */ ;
#line 1979
        if (! (i <= frames)) {
#line 1979
          goto while_break___66;
        }
#line 1981
        sp = pdata + imgstride * i;
#line 1982
        j = 0U;
        {
#line 1982
        while (1) {
          while_continue___67: /* CIL Label */ ;
#line 1982
          if (! (j < width * height)) {
#line 1982
            goto while_break___67;
          }
#line 1983
          tmp___69 = sp;
#line 1983
          sp ++;
#line 1983
          gray[*tmp___69] = (unsigned char)1;
#line 1982
          j ++;
        }
        while_break___67: /* CIL Label */ ;
        }
#line 1979
        i ++;
      }
      while_break___66: /* CIL Label */ ;
      }
#line 1985
      i = 0U;
      {
#line 1985
      while (1) {
        while_continue___68: /* CIL Label */ ;
#line 1985
        if (! (i < 256U)) {
#line 1985
          goto while_break___68;
        }
#line 1986
        if ((int )gray[i] == 0) {
#line 1988
          trns[0] = (unsigned char)0;
#line 1989
          trns[1] = (unsigned char )i;
#line 1990
          trnssize = 2U;
#line 1991
          goto while_break___68;
        }
#line 1985
        i ++;
      }
      while_break___68: /* CIL Label */ ;
      }
    }
  }
#line 1997
  bpp = 1U;
#line 1998
  if ((int )coltype == 2) {
#line 1999
    bpp = 3U;
  } else
#line 2001
  if ((int )coltype == 4) {
#line 2002
    bpp = 2U;
  } else
#line 2004
  if ((int )coltype == 6) {
#line 2005
    bpp = 4U;
  }
#line 2007
  has_tcolor = 0U;
#line 2008
  if ((int )coltype == 0) {
#line 2010
    if (trnssize) {
#line 2012
      has_tcolor = 1U;
#line 2013
      tcolor = (unsigned int )trns[1];
    }
  } else
#line 2017
  if ((int )coltype == 2) {
#line 2019
    if (trnssize) {
#line 2021
      has_tcolor = 1U;
#line 2022
      tcolor = (unsigned int )(((((int )trns[5] << 8) + (int )trns[3]) << 8) + (int )trns[1]);
    }
  } else
#line 2026
  if ((int )coltype == 3) {
#line 2028
    i = 0U;
    {
#line 2028
    while (1) {
      while_continue___69: /* CIL Label */ ;
#line 2028
      if (! (i < trnssize)) {
#line 2028
        goto while_break___69;
      }
#line 2029
      if ((int )trns[i] == 0) {
#line 2031
        has_tcolor = 1U;
#line 2032
        tcolor = i;
#line 2033
        goto while_break___69;
      }
#line 2028
      i ++;
    }
    while_break___69: /* CIL Label */ ;
    }
  } else {
#line 2038
    has_tcolor = 1U;
#line 2039
    tcolor = 0U;
  }
#line 2042
  rowbytes = width * bpp;
#line 2043
  imagesize = rowbytes * height;
#line 2044
  idat_size = (rowbytes + 1U) * height;
#line 2045
  zbuf_size = ((idat_size + ((idat_size + 7U) >> 3)) + ((idat_size + 63U) >> 6)) + 11U;
#line 2047
  i = 0U;
  {
#line 2047
  while (1) {
    while_continue___70: /* CIL Label */ ;
#line 2047
    if (! (i < 12U)) {
#line 2047
      goto while_break___70;
    }
#line 2049
    op[i].zstream.data_type = 0;
#line 2050
    op[i].zstream.zalloc = (voidpf (*)(voidpf opaque , uInt items , uInt size ))0;
#line 2051
    op[i].zstream.zfree = (void (*)(voidpf opaque , voidpf address ))0;
#line 2052
    op[i].zstream.opaque = (voidpf )0;
#line 2054
    if (i & 1U) {
      {
#line 2055
      deflateInit2_(& op[i].zstream, 9, 8, 15, 8, 1, "1.2.8", (int )sizeof(z_stream ));
      }
    } else {
      {
#line 2057
      deflateInit2_(& op[i].zstream, 9, 8, 15, 8, 0, "1.2.8", (int )sizeof(z_stream ));
      }
    }
    {
#line 2059
    tmp___70 = malloc((size_t )zbuf_size);
#line 2059
    op[i].zbuf = (unsigned char *)tmp___70;
    }
#line 2060
    if ((unsigned long )op[i].zbuf == (unsigned long )((void *)0)) {
      {
#line 2062
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 2063
      return (1);
    }
#line 2047
    i ++;
  }
  while_break___70: /* CIL Label */ ;
  }
  {
#line 2067
  tmp___71 = malloc((size_t )imagesize);
#line 2067
  tmpframe = (unsigned char *)tmp___71;
#line 2068
  tmp___72 = malloc((size_t )zbuf_size);
#line 2068
  zbuf = (unsigned char *)tmp___72;
#line 2069
  tmp___73 = malloc((size_t )(rowbytes + 1U));
#line 2069
  row_buf = (unsigned char *)tmp___73;
#line 2070
  tmp___74 = malloc((size_t )(rowbytes + 1U));
#line 2070
  sub_row = (unsigned char *)tmp___74;
#line 2071
  tmp___75 = malloc((size_t )(rowbytes + 1U));
#line 2071
  up_row = (unsigned char *)tmp___75;
#line 2072
  tmp___76 = malloc((size_t )(rowbytes + 1U));
#line 2072
  avg_row = (unsigned char *)tmp___76;
#line 2073
  tmp___77 = malloc((size_t )(rowbytes + 1U));
#line 2073
  paeth_row = (unsigned char *)tmp___77;
  }
#line 2075
  if (tmpframe) {
#line 2075
    if (zbuf) {
#line 2075
      if (row_buf) {
#line 2075
        if (sub_row) {
#line 2075
          if (up_row) {
#line 2075
            if (avg_row) {
#line 2075
              if (paeth_row) {
#line 2077
                *(row_buf + 0) = (unsigned char)0;
#line 2078
                *(sub_row + 0) = (unsigned char)1;
#line 2079
                *(up_row + 0) = (unsigned char)2;
#line 2080
                *(avg_row + 0) = (unsigned char)3;
#line 2081
                *(paeth_row + 0) = (unsigned char)4;
              } else {
                {
#line 2085
                printf((char const   */* __restrict  */)"Error: not enough memory\n");
                }
#line 2086
                return (1);
              }
            } else {
              {
#line 2085
              printf((char const   */* __restrict  */)"Error: not enough memory\n");
              }
#line 2086
              return (1);
            }
          } else {
            {
#line 2085
            printf((char const   */* __restrict  */)"Error: not enough memory\n");
            }
#line 2086
            return (1);
          }
        } else {
          {
#line 2085
          printf((char const   */* __restrict  */)"Error: not enough memory\n");
          }
#line 2086
          return (1);
        }
      } else {
        {
#line 2085
        printf((char const   */* __restrict  */)"Error: not enough memory\n");
        }
#line 2086
        return (1);
      }
    } else {
      {
#line 2085
      printf((char const   */* __restrict  */)"Error: not enough memory\n");
      }
#line 2086
      return (1);
    }
  } else {
    {
#line 2085
    printf((char const   */* __restrict  */)"Error: not enough memory\n");
    }
#line 2086
    return (1);
  }
  {
#line 2089
  f = fopen((char const   */* __restrict  */)szOut, (char const   */* __restrict  */)"wb");
  }
#line 2089
  if ((unsigned long )f != (unsigned long )((FILE *)0)) {
    {
#line 2091
    tmp___78 = __bswap_32(width);
#line 2091
    tmp___79 = __bswap_32(height);
#line 2091
    ihdr.mWidth = tmp___78;
#line 2091
    ihdr.mHeight = tmp___79;
#line 2091
    ihdr.mDepth = (unsigned char)8;
#line 2091
    ihdr.mColorType = coltype;
#line 2091
    ihdr.mCompression = (unsigned char)0;
#line 2091
    ihdr.mFilterMethod = (unsigned char)0;
#line 2091
    ihdr.mInterlaceMethod = (unsigned char)0;
#line 2102
    tmp___80 = __bswap_32(frames);
#line 2102
    tmp___81 = __bswap_32(loops);
#line 2102
    actl.mFrameCount = tmp___80;
#line 2102
    actl.mLoopCount = tmp___81;
#line 2121
    fwrite((void const   */* __restrict  */)(png_sign), (size_t )1, (size_t )8, (FILE */* __restrict  */)f);
#line 2123
    write_chunk(f, "IHDR", (unsigned char *)(& ihdr), 13U);
    }
#line 2125
    if (frames > first) {
      {
#line 2126
      write_chunk(f, "acTL", (unsigned char *)(& actl), 8U);
      }
    }
#line 2128
    if (palsize > 0U) {
      {
#line 2129
      write_chunk(f, "PLTE", (unsigned char *)(& palette), palsize * 3U);
      }
    }
#line 2131
    if (trnssize > 0U) {
      {
#line 2132
      write_chunk(f, "tRNS", trns, trnssize);
      }
    }
#line 2134
    x0 = 0U;
#line 2135
    y0 = 0U;
#line 2136
    w0 = width;
#line 2137
    h0 = height;
#line 2138
    bop = (unsigned char)0;
#line 2140
    if (first == 0U) {
      {
#line 2142
      printf((char const   */* __restrict  */)"saving frame %d of %d\n", 0, frames);
#line 2143
      deflate_rect(pdata, (int )x0, (int )y0, (int )w0, (int )h0, (int )bpp, (int )rowbytes,
                   (int )zbuf_size, 0);
      }
#line 2145
      if (op[0].zstream.total_out <= op[1].zstream.total_out) {
        {
#line 2147
        zsize = (unsigned int )op[0].zstream.total_out;
#line 2148
        memcpy((void */* __restrict  */)zbuf, (void const   */* __restrict  */)op[0].zbuf,
               (size_t )zsize);
        }
      } else {
        {
#line 2152
        zsize = (unsigned int )op[1].zstream.total_out;
#line 2153
        memcpy((void */* __restrict  */)zbuf, (void const   */* __restrict  */)op[1].zbuf,
               (size_t )zsize);
        }
      }
      {
#line 2156
      deflateReset(& op[0].zstream);
#line 2157
      op[0].zstream.data_type = 0;
#line 2158
      deflateReset(& op[1].zstream);
#line 2159
      op[1].zstream.data_type = 0;
#line 2160
      write_IDATs(f, 0, zbuf, zsize, idat_size);
      }
    }
#line 2163
    cur_frame = pdata;
#line 2164
    next_frame = pdata + imgstride;
#line 2166
    if (frames > 0U) {
      {
#line 2168
      printf((char const   */* __restrict  */)"saving frame %d of %d\n", 1, frames);
#line 2169
      deflate_rect(next_frame, (int )x0, (int )y0, (int )w0, (int )h0, (int )bpp,
                   (int )rowbytes, (int )zbuf_size, 0);
      }
#line 2171
      if (op[0].zstream.total_out <= op[1].zstream.total_out) {
        {
#line 2173
        zsize = (unsigned int )op[0].zstream.total_out;
#line 2174
        memcpy((void */* __restrict  */)zbuf, (void const   */* __restrict  */)op[0].zbuf,
               (size_t )zsize);
        }
      } else {
        {
#line 2178
        zsize = (unsigned int )op[1].zstream.total_out;
#line 2179
        memcpy((void */* __restrict  */)zbuf, (void const   */* __restrict  */)op[1].zbuf,
               (size_t )zsize);
        }
      }
      {
#line 2182
      deflateReset(& op[0].zstream);
#line 2183
      op[0].zstream.data_type = 0;
#line 2184
      deflateReset(& op[1].zstream);
#line 2185
      op[1].zstream.data_type = 0;
#line 2187
      i = 1U;
      }
      {
#line 2187
      while (1) {
        while_continue___71: /* CIL Label */ ;
#line 2187
        if (! (i < frames)) {
#line 2187
          goto while_break___71;
        }
        {
#line 2192
        prev_frame = cur_frame;
#line 2193
        cur_frame = next_frame;
#line 2194
        next_frame += imgstride;
#line 2196
        printf((char const   */* __restrict  */)"saving frame %d of %d\n", i + 1U,
               frames);
#line 2198
        j = 0U;
        }
        {
#line 2198
        while (1) {
          while_continue___72: /* CIL Label */ ;
#line 2198
          if (! (j < 12U)) {
#line 2198
            goto while_break___72;
          }
#line 2199
          op[j].valid = 0;
#line 2198
          j ++;
        }
        while_break___72: /* CIL Label */ ;
        }
        {
#line 2202
        try_over = get_rect(width, height, cur_frame, next_frame, tmpframe, & x1,
                            & y1, & w1, & h1, bpp, has_tcolor, tcolor);
#line 2203
        deflate_rect(next_frame, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                     (int )rowbytes, (int )zbuf_size, 0);
        }
#line 2204
        if (try_over) {
          {
#line 2205
          deflate_rect(tmpframe, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                       (int )rowbytes, (int )zbuf_size, 1);
          }
        }
#line 2208
        if (has_tcolor) {
          {
#line 2210
          memcpy((void */* __restrict  */)tmpframe, (void const   */* __restrict  */)cur_frame,
                 (size_t )imagesize);
          }
#line 2211
          if ((int )coltype == 2) {
#line 2212
            j = 0U;
            {
#line 2212
            while (1) {
              while_continue___73: /* CIL Label */ ;
#line 2212
              if (! (j < h0)) {
#line 2212
                goto while_break___73;
              }
#line 2213
              k = 0U;
              {
#line 2213
              while (1) {
                while_continue___74: /* CIL Label */ ;
#line 2213
                if (! (k < w0)) {
#line 2213
                  goto while_break___74;
                }
                {
#line 2214
                memcpy((void */* __restrict  */)(tmpframe + ((j + y0) * width + (k + x0)) * 3U),
                       (void const   */* __restrict  */)(& tcolor), (size_t )3);
#line 2213
                k ++;
                }
              }
              while_break___74: /* CIL Label */ ;
              }
#line 2212
              j ++;
            }
            while_break___73: /* CIL Label */ ;
            }
          } else {
#line 2216
            j = 0U;
            {
#line 2216
            while (1) {
              while_continue___75: /* CIL Label */ ;
#line 2216
              if (! (j < h0)) {
#line 2216
                goto while_break___75;
              }
              {
#line 2217
              memset((void *)(tmpframe + ((j + y0) * width + x0) * bpp), (int )tcolor,
                     (size_t )(w0 * bpp));
#line 2216
              j ++;
              }
            }
            while_break___75: /* CIL Label */ ;
            }
          }
          {
#line 2219
          try_over = get_rect(width, height, tmpframe, next_frame, tmpframe, & x1,
                              & y1, & w1, & h1, bpp, has_tcolor, tcolor);
#line 2221
          deflate_rect(next_frame, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                       (int )rowbytes, (int )zbuf_size, 2);
          }
#line 2222
          if (try_over) {
            {
#line 2223
            deflate_rect(tmpframe, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                         (int )rowbytes, (int )zbuf_size, 3);
            }
          }
        }
#line 2226
        if (i > 1U) {
          {
#line 2229
          try_over = get_rect(width, height, prev_frame, next_frame, tmpframe, & x1,
                              & y1, & w1, & h1, bpp, has_tcolor, tcolor);
#line 2230
          deflate_rect(next_frame, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                       (int )rowbytes, (int )zbuf_size, 4);
          }
#line 2231
          if (try_over) {
            {
#line 2232
            deflate_rect(tmpframe, (int )x1, (int )y1, (int )w1, (int )h1, (int )bpp,
                         (int )rowbytes, (int )zbuf_size, 5);
            }
          }
        }
#line 2235
        op_min = (unsigned int )op[0].zstream.total_out;
#line 2236
        op_best = 0;
#line 2237
        j = 1U;
        {
#line 2237
        while (1) {
          while_continue___76: /* CIL Label */ ;
#line 2237
          if (! (j < 12U)) {
#line 2237
            goto while_break___76;
          }
#line 2239
          if (op[j].valid) {
#line 2241
            if (op[j].zstream.total_out < (uLong )op_min) {
#line 2243
              op_min = (unsigned int )op[j].zstream.total_out;
#line 2244
              op_best = (int )j;
            }
          }
#line 2237
          j ++;
        }
        while_break___76: /* CIL Label */ ;
        }
        {
#line 2249
        dop = (unsigned char )(op_best >> 2);
#line 2251
        tmp___82 = next_seq_num;
#line 2251
        next_seq_num ++;
#line 2251
        fctl.mSeq = __bswap_32(tmp___82);
#line 2252
        fctl.mWidth = __bswap_32(w0);
#line 2253
        fctl.mHeight = __bswap_32(h0);
#line 2254
        fctl.mXOffset = __bswap_32(x0);
#line 2255
        fctl.mYOffset = __bswap_32(y0);
#line 2256
        __x = *(dnum + i);
#line 2256
        __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 2256
        fctl.mDelayNum = __v;
#line 2257
        __x___0 = *(dden + i);
#line 2257
        __asm__  ("rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 2257
        fctl.mDelayDen = __v___0;
#line 2258
        fctl.mDisposeOp = dop;
#line 2259
        fctl.mBlendOp = bop;
#line 2260
        write_chunk(f, "fcTL", (unsigned char *)(& fctl), 26U);
#line 2262
        write_IDATs(f, (int )(i - first), zbuf, zsize, idat_size);
        }
#line 2265
        if ((int )dop == 1) {
#line 2267
          if ((int )coltype == 2) {
#line 2268
            j = 0U;
            {
#line 2268
            while (1) {
              while_continue___77: /* CIL Label */ ;
#line 2268
              if (! (j < h0)) {
#line 2268
                goto while_break___77;
              }
#line 2269
              k = 0U;
              {
#line 2269
              while (1) {
                while_continue___78: /* CIL Label */ ;
#line 2269
                if (! (k < w0)) {
#line 2269
                  goto while_break___78;
                }
                {
#line 2270
                memcpy((void */* __restrict  */)(cur_frame + ((j + y0) * width + (k + x0)) * 3U),
                       (void const   */* __restrict  */)(& tcolor), (size_t )3);
#line 2269
                k ++;
                }
              }
              while_break___78: /* CIL Label */ ;
              }
#line 2268
              j ++;
            }
            while_break___77: /* CIL Label */ ;
            }
          } else {
#line 2272
            j = 0U;
            {
#line 2272
            while (1) {
              while_continue___79: /* CIL Label */ ;
#line 2272
              if (! (j < h0)) {
#line 2272
                goto while_break___79;
              }
              {
#line 2273
              memset((void *)(cur_frame + ((j + y0) * width + x0) * bpp), (int )tcolor,
                     (size_t )(w0 * bpp));
#line 2272
              j ++;
              }
            }
            while_break___79: /* CIL Label */ ;
            }
          }
        } else
#line 2276
        if ((int )dop == 2) {
#line 2278
          j = 0U;
          {
#line 2278
          while (1) {
            while_continue___80: /* CIL Label */ ;
#line 2278
            if (! (j < h0)) {
#line 2278
              goto while_break___80;
            }
            {
#line 2279
            memcpy((void */* __restrict  */)(cur_frame + ((j + y0) * width + x0) * bpp),
                   (void const   */* __restrict  */)(prev_frame + ((j + y0) * width + x0) * bpp),
                   (size_t )(w0 * bpp));
#line 2278
            j ++;
            }
          }
          while_break___80: /* CIL Label */ ;
          }
        }
        {
#line 2283
        x0 = (unsigned int )op[op_best].x;
#line 2284
        y0 = (unsigned int )op[op_best].y;
#line 2285
        w0 = (unsigned int )op[op_best].w;
#line 2286
        h0 = (unsigned int )op[op_best].h;
#line 2287
        bop = (unsigned char )((op_best >> 1) & 1);
#line 2289
        zsize = (unsigned int )op[op_best].zstream.total_out;
#line 2290
        memcpy((void */* __restrict  */)zbuf, (void const   */* __restrict  */)op[op_best].zbuf,
               (size_t )zsize);
#line 2292
        j = 0U;
        }
        {
#line 2292
        while (1) {
          while_continue___81: /* CIL Label */ ;
#line 2292
          if (! (j < 12U)) {
#line 2292
            goto while_break___81;
          }
          {
#line 2294
          deflateReset(& op[j].zstream);
#line 2295
          op[j].zstream.data_type = 0;
#line 2292
          j ++;
          }
        }
        while_break___81: /* CIL Label */ ;
        }
#line 2187
        i ++;
      }
      while_break___71: /* CIL Label */ ;
      }
#line 2299
      if (frames > first) {
        {
#line 2301
        tmp___83 = next_seq_num;
#line 2301
        next_seq_num ++;
#line 2301
        fctl.mSeq = __bswap_32(tmp___83);
#line 2302
        fctl.mWidth = __bswap_32(w0);
#line 2303
        fctl.mHeight = __bswap_32(h0);
#line 2304
        fctl.mXOffset = __bswap_32(x0);
#line 2305
        fctl.mYOffset = __bswap_32(y0);
#line 2306
        __x___1 = *(dnum + frames);
#line 2306
        __asm__  ("rorw $8, %w0": "=r" (__v___1): "0" (__x___1): "cc");
#line 2306
        fctl.mDelayNum = __v___1;
#line 2307
        __x___2 = *(dden + frames);
#line 2307
        __asm__  ("rorw $8, %w0": "=r" (__v___2): "0" (__x___2): "cc");
#line 2307
        fctl.mDelayDen = __v___2;
#line 2308
        fctl.mDisposeOp = (unsigned char)0;
#line 2309
        fctl.mBlendOp = bop;
#line 2310
        write_chunk(f, "fcTL", (unsigned char *)(& fctl), 26U);
        }
      }
      {
#line 2313
      write_IDATs(f, (int )(frames - first), zbuf, zsize, idat_size);
      }
    }
    {
#line 2315
    write_chunk(f, "IEND", (unsigned char *)0, 0U);
#line 2316
    fclose(f);
    }
  } else {
    {
#line 2320
    printf((char const   */* __restrict  */)"Error: couldn\'t open file for writing\n");
    }
#line 2321
    return (1);
  }
#line 2324
  i = 0U;
  {
#line 2324
  while (1) {
    while_continue___82: /* CIL Label */ ;
#line 2324
    if (! (i < 12U)) {
#line 2324
      goto while_break___82;
    }
    {
#line 2326
    deflateEnd(& op[i].zstream);
    }
#line 2327
    if ((unsigned long )op[i].zbuf != (unsigned long )((void *)0)) {
      {
#line 2328
      free((void *)op[i].zbuf);
      }
    }
#line 2324
    i ++;
  }
  while_break___82: /* CIL Label */ ;
  }
  {
#line 2331
  free((void *)tmpframe);
#line 2332
  free((void *)zbuf);
#line 2333
  free((void *)row_buf);
#line 2334
  free((void *)sub_row);
#line 2335
  free((void *)up_row);
#line 2336
  free((void *)avg_row);
#line 2337
  free((void *)paeth_row);
  }
#line 2339
  return (0);
}
}
#line 2342 "/home/june/collector/temp/apngopt-1.2/apngopt.c"
int main(int argc , char **argv ) 
{ 
  char *szIn ;
  char szOut[256] ;
  char *szExt ;
  int res ;
  unsigned int w ;
  unsigned int h ;
  unsigned int first ;
  unsigned int frames ;
  unsigned int loops ;
  unsigned char coltype ;
  unsigned char *pOut1 ;
  unsigned char *pOut2 ;
  unsigned short *pDelayNum ;
  unsigned short *pDelayDen ;
  int tmp ;

  {
  {
#line 2350
  pOut1 = (unsigned char *)((void *)0);
#line 2351
  pOut2 = (unsigned char *)((void *)0);
#line 2352
  pDelayNum = (unsigned short *)((void *)0);
#line 2353
  pDelayDen = (unsigned short *)((void *)0);
#line 2355
  printf((char const   */* __restrict  */)"\nAPNG Optimizer 1.2\n\n");
  }
#line 2357
  if (argc <= 1) {
    {
#line 2359
    printf((char const   */* __restrict  */)"Usage: apngopt anim.png [anim.opt.png]\n");
    }
#line 2360
    return (1);
  }
#line 2363
  szIn = *(argv + 1);
#line 2365
  if (argc > 2) {
    {
#line 2367
    strncpy((char */* __restrict  */)(szOut), (char const   */* __restrict  */)*(argv + 2),
            (size_t )255);
#line 2368
    szOut[255] = (char )'\000';
    }
  } else {
    {
#line 2372
    strcpy((char */* __restrict  */)(szOut), (char const   */* __restrict  */)szIn);
#line 2373
    szExt = strrchr((char const   *)(szOut), '.');
    }
#line 2373
    if ((unsigned long )szExt != (unsigned long )((void *)0)) {
#line 2373
      *szExt = (char)0;
    }
    {
#line 2374
    strcat((char */* __restrict  */)(szOut), (char const   */* __restrict  */)".opt.png");
    }
  }
  {
#line 2377
  tmp = LoadAPNG(szIn, & w, & h, & coltype, & first, & frames, & loops, & pOut1, & pOut2,
                 & pDelayNum, & pDelayDen);
  }
#line 2377
  if (tmp != 0) {
    {
#line 2379
    printf((char const   */* __restrict  */)"Error: can\'t load \'%s\'\n", szIn);
    }
#line 2380
    return (1);
  }
  {
#line 2382
  printf((char const   */* __restrict  */)"OK\n");
  }
#line 2384
  if ((int )coltype == 6) {
    {
#line 2385
    res = SaveAPNG(szOut, pOut2, pDelayNum, pDelayDen, w, h, first, frames, loops,
                   (unsigned char)6);
    }
  } else
#line 2387
  if ((int )coltype == 4) {
    {
#line 2388
    res = SaveAPNG(szOut, pOut1, pDelayNum, pDelayDen, w, h, first, frames, loops,
                   coltype);
    }
  } else
#line 2390
  if (keep_original) {
    {
#line 2391
    res = SaveAPNG(szOut, pOut1, pDelayNum, pDelayDen, w, h, first, frames, loops,
                   coltype);
    }
  } else {
    {
#line 2393
    res = SaveAPNG(szOut, pOut2, pDelayNum, pDelayDen, w, h, first, frames, loops,
                   (unsigned char)6);
    }
  }
  {
#line 2395
  printf((char const   */* __restrict  */)"OK\n");
#line 2397
  free((void *)pOut1);
#line 2398
  free((void *)pOut2);
#line 2399
  free((void *)pDelayNum);
#line 2400
  free((void *)pDelayDen);
  }
#line 2402
  return (res);
}
}
