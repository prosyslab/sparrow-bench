/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.6/include/stddef.h"
typedef unsigned long size_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned char __u_char;
#line 32 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __u_int;
#line 33 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __u_long;
#line 133 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __pid_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 33 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_char u_char;
#line 35 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_int u_int;
#line 36 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_long u_long;
#line 98 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __pid_t pid_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 201 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned short u_int16_t;
#line 202 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned int u_int32_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 48 "/usr/include/arpa/nameser_compat.h"
struct __anonstruct_HEADER_49 {
   unsigned int id : 16 ;
   unsigned int rd : 1 ;
   unsigned int tc : 1 ;
   unsigned int aa : 1 ;
   unsigned int opcode : 4 ;
   unsigned int qr : 1 ;
   unsigned int rcode : 4 ;
   unsigned int cd : 1 ;
   unsigned int ad : 1 ;
   unsigned int unused : 1 ;
   unsigned int ra : 1 ;
   unsigned int qdcount : 16 ;
   unsigned int ancount : 16 ;
   unsigned int nscount : 16 ;
   unsigned int arcount : 16 ;
};
#line 48 "/usr/include/arpa/nameser_compat.h"
typedef struct __anonstruct_HEADER_49 HEADER;
#line 165 "ns_defs.h"
enum severity {
    ignore = 0,
    warn = 1,
    fail = 2,
    not_set = 3
} ;
#line 173 "ns_defs.h"
struct zoneinfo {
   char *z_origin ;
   time_t z_time ;
   time_t z_lastupdate ;
   u_int32_t z_refresh ;
   u_int32_t z_retry ;
   u_int32_t z_expire ;
   u_int32_t z_minimum ;
   u_int32_t z_serial ;
   char *z_source ;
   time_t z_ftime ;
   struct in_addr z_axfr_src ;
   struct in_addr z_xaddr ;
   struct in_addr z_addr[16] ;
   u_char z_addrcnt ;
   u_char z_type ;
   u_int32_t z_flags ;
   pid_t z_xferpid ;
   u_int z_options ;
   u_int z_optset ;
   int z_class ;
   int z_numxfrs ;
   enum severity z_checknames ;
   struct in_addr *z_also_notify ;
   int z_notify_count ;
   char *z_ixfr_base ;
   char *z_ixfr_tmp ;
   int z_maintain_ixfr_base ;
   int z_log_size_ixfr ;
   int z_max_log_size_ixfr ;
};
#line 303
enum transport {
    primary_trans = 0,
    secondary_trans = 1,
    response_trans = 2,
    update_trans = 3,
    num_trans = 4
} ;
#line 312
enum context {
    domain_ctx = 0,
    owner_ctx = 1,
    mailname_ctx = 2,
    hostname_ctx = 3
} ;
#line 362 "/usr/include/stdio.h"
extern int printf(char const   * __restrict  __format  , ...) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 413
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) strerror)(int __errnum ) ;
#line 50 "/usr/include/x86_64-linux-gnu/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 273 "/usr/include/resolv.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_init)(void) ;
#line 328
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) ;
#line 331
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) ;
#line 357
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __dn_expand)(u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  char * ,
                                                                                  int  ) ;
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 69 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) __assert_fail)(char const   *__assertion ,
                                                                                                   char const   *__file ,
                                                                                                   unsigned int __line ,
                                                                                                   char const   *__function ) ;
#line 104 "nxt-bad.c"
char const   *transport_strings[4]  = {      "primary",      "secondary",      "response",      (char const   *)((void *)0)};
#line 123
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) ;
#line 123 "nxt-bad.c"
int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) 
{ 
  int ch ;
  char const   *tmp ;

  {
  {
#line 127
  while (1) {
    while_continue: /* CIL Label */ ;
#line 127
    tmp = dn;
#line 127
    dn ++;
#line 127
    ch = (int )*tmp;
#line 127
    if (! (ch != 0)) {
#line 127
      goto while_break;
    }
#line 128
    if (ch > 32) {
#line 128
      if (! (ch < 127)) {
#line 129
        return (0);
      }
    } else {
#line 129
      return (0);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 130
  return (1);
}
}
#line 133
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) ;
#line 133 "nxt-bad.c"
int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) 
{ 
  int ppch ;
  int pch ;
  int ch ;
  char const   *tmp ;
  int nch ;
  char const   *tmp___0 ;

  {
#line 135
  ppch = '\000';
#line 135
  pch = 46;
#line 135
  tmp = dn;
#line 135
  dn ++;
#line 135
  ch = (int )*tmp;
  {
#line 137
  while (1) {
    while_continue: /* CIL Label */ ;
#line 137
    if (! (ch != 0)) {
#line 137
      goto while_break;
    }
#line 138
    tmp___0 = dn;
#line 138
    dn ++;
#line 138
    nch = (int )*tmp___0;
#line 140
    if (! (ch == 46)) {
#line 142
      if (pch == 46) {
#line 143
        if (ch >= 65) {
#line 143
          if (! (ch <= 90)) {
#line 143
            goto _L___0;
          }
        } else
        _L___0: /* CIL Label */ 
#line 143
        if (ch >= 97) {
#line 143
          if (! (ch <= 122)) {
#line 143
            goto _L;
          }
        } else
        _L: /* CIL Label */ 
#line 143
        if (ch >= 48) {
#line 143
          if (! (ch <= 57)) {
#line 144
            return (0);
          }
        } else {
#line 144
          return (0);
        }
      } else
#line 145
      if (nch == 46) {
#line 145
        goto _L___6;
      } else
#line 145
      if (nch == 0) {
        _L___6: /* CIL Label */ 
#line 146
        if (ch >= 65) {
#line 146
          if (! (ch <= 90)) {
#line 146
            goto _L___2;
          }
        } else
        _L___2: /* CIL Label */ 
#line 146
        if (ch >= 97) {
#line 146
          if (! (ch <= 122)) {
#line 146
            goto _L___1;
          }
        } else
        _L___1: /* CIL Label */ 
#line 146
        if (ch >= 48) {
#line 146
          if (! (ch <= 57)) {
#line 147
            return (0);
          }
        } else {
#line 147
          return (0);
        }
      } else
#line 149
      if (ch >= 65) {
#line 149
        if (! (ch <= 90)) {
#line 149
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 149
      if (ch >= 97) {
#line 149
        if (! (ch <= 122)) {
#line 149
          goto _L___4;
        }
      } else
      _L___4: /* CIL Label */ 
#line 149
      if (ch >= 48) {
#line 149
        if (! (ch <= 57)) {
#line 149
          goto _L___3;
        }
      } else
      _L___3: /* CIL Label */ 
#line 149
      if (! (ch == 45)) {
#line 150
        return (0);
      }
    }
#line 152
    ppch = pch;
#line 152
    pch = ch;
#line 152
    ch = nch;
  }
  while_break: /* CIL Label */ ;
  }
#line 154
  return (1);
}
}
#line 158 "nxt-bad.c"
enum context ns_ownercontext(int type , enum transport transport ) 
{ 
  enum context context ;
  char *__cil_tmp4 ;

  {
#line 163
  context = (enum context )0;
  {
#line 168
  if (type == 15) {
#line 168
    goto case_15;
  }
#line 168
  if (type == 11) {
#line 168
    goto case_15;
  }
#line 168
  if (type == 1) {
#line 168
    goto case_15;
  }
#line 184
  if (type == 8) {
#line 184
    goto case_8;
  }
#line 184
  if (type == 7) {
#line 184
    goto case_8;
  }
#line 187
  goto switch_default___0;
  case_15: /* CIL Label */ 
  case_11: /* CIL Label */ 
  case_1: /* CIL Label */ 
  {
#line 172
  if ((unsigned int )transport == 1U) {
#line 172
    goto case_1___0;
  }
#line 172
  if ((unsigned int )transport == 0U) {
#line 172
    goto case_1___0;
  }
#line 172
  if ((unsigned int )transport == 3U) {
#line 172
    goto case_1___0;
  }
#line 175
  if ((unsigned int )transport == 2U) {
#line 175
    goto case_2;
  }
#line 178
  goto switch_default;
  case_1___0: /* CIL Label */ 
  case_0: /* CIL Label */ 
  case_3: /* CIL Label */ 
#line 173
  context = (enum context )1;
#line 174
  goto switch_break___0;
  case_2: /* CIL Label */ 
#line 176
  context = (enum context )3;
#line 177
  goto switch_break___0;
  switch_default: /* CIL Label */ 
  {
#line 179
  printf((char const   */* __restrict  */)"impossible condition in ns_ownercontext()");
  }
  switch_break___0: /* CIL Label */ ;
  }
#line 182
  goto switch_break;
  case_8: /* CIL Label */ 
  case_7: /* CIL Label */ 
#line 185
  context = (enum context )2;
#line 186
  goto switch_break;
  switch_default___0: /* CIL Label */ 
#line 189
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 191
  return (context);
}
}
#line 202 "nxt-bad.c"
char *newstr(size_t len , int needpanic ) 
{ 
  u_char *buf ;
  u_char *bp ;
  void *tmp ;
  int *tmp___0 ;
  char *tmp___1 ;
  u_int16_t t_s ;
  u_char *t_cp ;
  u_char *tmp___2 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;

  {
#line 206
  if (! (len <= 65536UL)) {
    {
#line 206
    __assert_fail("len <= 65536", "nxt-bad.c", 206U, "newstr");
    }
  }
  {
#line 208
  tmp = malloc((2UL + len) + 1UL);
#line 208
  buf = (u_char *)tmp;
  }
#line 209
  if ((unsigned long )buf == (unsigned long )((void *)0)) {
#line 210
    if (needpanic) {
      {
#line 211
      tmp___0 = __errno_location();
#line 211
      tmp___1 = strerror(*tmp___0);
#line 211
      printf((char const   */* __restrict  */)"savestr: malloc failed (%s)", tmp___1);
      }
    } else {
#line 213
      return ((char *)((void *)0));
    }
  }
#line 215
  bp = buf;
  {
#line 216
  while (1) {
    while_continue: /* CIL Label */ ;
#line 216
    t_s = (u_int16_t )len;
#line 216
    t_cp = bp;
#line 216
    tmp___2 = t_cp;
#line 216
    t_cp ++;
#line 216
    *tmp___2 = (u_char )((int )t_s >> 8);
#line 216
    *t_cp = (u_char )t_s;
#line 216
    bp += 2;
#line 216
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
#line 217
  return ((char *)bp);
}
}
#line 223 "nxt-bad.c"
int ns_nameok(char const   *name , int class , struct zoneinfo *zp , enum transport transport ,
              enum context context , char const   *owner ) 
{ 
  enum severity severity ;
  int ok ;
  int tmp ;
  int tmp___0 ;
  char *__cil_tmp11 ;

  {
#line 230
  severity = (enum severity )3;
#line 231
  ok = 1;
#line 233
  if ((unsigned long )zp != (unsigned long )((void *)0)) {
#line 234
    severity = zp->z_checknames;
  }
#line 244
  if ((unsigned int )severity == 0U) {
#line 245
    return (1);
  }
  {
#line 247
  if ((unsigned int )context == 0U) {
#line 247
    goto case_0;
  }
#line 250
  if ((unsigned int )context == 3U) {
#line 250
    goto case_3;
  }
#line 253
  goto switch_default;
  case_0: /* CIL Label */ 
#line 248
  if (class != 1) {
#line 248
    tmp___0 = 1;
  } else {
    {
#line 248
    tmp = __res_dnok(name);
    }
#line 248
    if (tmp) {
#line 248
      tmp___0 = 1;
    } else {
#line 248
      tmp___0 = 0;
    }
  }
#line 248
  ok = tmp___0;
#line 249
  goto switch_break;
  case_3: /* CIL Label */ 
  {
#line 251
  ok = __res_hnok(name);
  }
#line 252
  goto switch_break;
  switch_default: /* CIL Label */ 
  {
#line 255
  printf((char const   */* __restrict  */)"unexpected context %d in ns_nameok", (int )context);
  }
#line 256
  return (0);
#line 259
  return (ok);
  switch_break: /* CIL Label */ ;
  }
#line 262
  return (ok);
}
}
#line 266 "nxt-bad.c"
static int rrextract(u_char *msg , int msglen , u_char *rrp , u_char *dname , int namelen ) 
{ 
  u_char *eom ;
  u_char *cp ;
  u_char *cp1 ;
  u_char *rdatap ;
  u_int class ;
  u_int type ;
  u_int dlen ;
  int n ;
  int len ;
  u_int32_t ttl ;
  u_char data[4140] ;
  HEADER *hp ;
  size_t tmp ;
  u_char const   *t_cp ;
  u_char const   *t_cp___0 ;
  u_char const   *t_cp___1 ;
  u_char const   *t_cp___2 ;
  enum context tmp___0 ;
  int tmp___1 ;
  size_t tmp___2 ;
  int tmp___3 ;
  size_t tmp___4 ;
  void *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;
  char *__cil_tmp41 ;
  char *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;

  {
  {
#line 271
  len = 0;
#line 274
  hp = (HEADER *)msg;
#line 276
  cp = rrp;
#line 277
  eom = msg + msglen;
#line 280
  printf((char const   */* __restrict  */)"Trying to do dn_expand..\n");
#line 281
  printf((char const   */* __restrict  */)"msg = %s, msglen = %d, rrp = %s, namelen = %d\n",
         (char *)msg, msglen, (char *)rrp, namelen);
#line 283
  n = __dn_expand((u_char const   *)msg, (u_char const   *)eom, (u_char const   *)cp,
                  (char *)dname, namelen);
  }
#line 283
  if (n < 0) {
    {
#line 284
    printf((char const   */* __restrict  */)"dn_expand returned %d\n", n);
#line 285
    hp->rcode = 1U;
    }
#line 286
    return (-1);
  }
  {
#line 289
  tmp = strlen((char const   *)dname);
#line 289
  n = (int )tmp;
#line 291
  printf((char const   */* __restrict  */)"First dn_expand returned n = %d\n", n);
#line 293
  cp += n;
#line 294
  len += n;
#line 295
  len = (int )((unsigned long )len + sizeof(HEADER ));
  }
  {
#line 298
  while (1) {
    while_continue: /* CIL Label */ ;
#line 298
    if ((unsigned long )(cp + 10) > (unsigned long )eom) {
#line 298
      hp->rcode = 1U;
#line 298
      return (-1);
    }
#line 298
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 301
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 301
    t_cp = (u_char const   *)cp;
#line 301
    type = (u_int )(((int )((u_int16_t )*(t_cp + 0)) << 8) | (int )((u_int16_t )*(t_cp + 1)));
#line 301
    cp += 2;
#line 301
    goto while_break___0;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 302
  cp += 2;
#line 303
  len += 2;
#line 304
  printf((char const   */* __restrict  */)"type = %d\n", type);
  }
  {
#line 305
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 305
    t_cp___0 = (u_char const   *)cp;
#line 305
    class = (u_int )(((int )((u_int16_t )*(t_cp___0 + 0)) << 8) | (int )((u_int16_t )*(t_cp___0 + 1)));
#line 305
    cp += 2;
#line 305
    goto while_break___1;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 306
  cp += 2;
#line 307
  len += 2;
#line 309
  if (class > (u_int )((1 << 8) - 1)) {
    {
#line 310
    printf((char const   */* __restrict  */)"bad class in rrextract");
#line 311
    hp->rcode = 1U;
    }
#line 312
    return (-1);
  }
  {
#line 314
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 314
    t_cp___1 = (u_char const   *)cp;
#line 314
    ttl = ((((u_int32_t )*(t_cp___1 + 0) << 24) | ((u_int32_t )*(t_cp___1 + 1) << 16)) | ((u_int32_t )*(t_cp___1 + 2) << 8)) | (u_int32_t )*(t_cp___1 + 3);
#line 314
    cp += 4;
#line 314
    goto while_break___2;
  }
  while_break___2: /* CIL Label */ ;
  }
  {
#line 315
  printf((char const   */* __restrict  */)"ttl = %d\n", ttl);
#line 316
  cp += 4;
#line 317
  len += 4;
  }
#line 319
  if (ttl > 2147483647U) {
    {
#line 320
    printf((char const   */* __restrict  */)"%s: converted TTL > %u to 0", dname,
           2147483647);
#line 323
    ttl = (u_int32_t )0;
    }
  }
  {
#line 325
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 325
    t_cp___2 = (u_char const   *)cp;
#line 325
    dlen = (u_int )(((int )((u_int16_t )*(t_cp___2 + 0)) << 8) | (int )((u_int16_t )*(t_cp___2 + 1)));
#line 325
    cp += 2;
#line 325
    goto while_break___3;
  }
  while_break___3: /* CIL Label */ ;
  }
  {
#line 326
  cp += 2;
#line 327
  len += 2;
#line 329
  printf((char const   */* __restrict  */)"msglen - len - 12 = %d, dlen = %d\n", (msglen - len) - 12,
         dlen);
  }
  {
#line 330
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 330
    if ((unsigned long )(cp + dlen) > (unsigned long )eom) {
#line 330
      hp->rcode = 1U;
#line 330
      return (-1);
    }
#line 330
    goto while_break___4;
  }
  while_break___4: /* CIL Label */ ;
  }
  {
#line 331
  printf((char const   */* __restrict  */)"bounds check succeeded\n");
#line 332
  rdatap = cp;
#line 334
  tmp___0 = ns_ownercontext((int )type, (enum transport )2);
#line 334
  tmp___1 = ns_nameok((char const   *)((char *)dname), (int )class, (struct zoneinfo *)((void *)0),
                      (enum transport )2, tmp___0, (char const   *)((char *)dname));
  }
#line 334
  if (! tmp___1) {
#line 337
    hp->rcode = 5U;
#line 338
    return (-1);
  }
  {
#line 340
  printf((char const   */* __restrict  */)"rrextract: dname %s type %d class %d ttl %d\n",
         dname, type, class, ttl);
  }
  {
#line 360
  if (type == 1U) {
#line 360
    goto case_1;
  }
#line 369
  if (type == 35U) {
#line 369
    goto case_35;
  }
#line 380
  if (type == 33U) {
#line 380
    goto case_33;
  }
#line 380
  if (type == 21U) {
#line 380
    goto case_33;
  }
#line 380
  if (type == 18U) {
#line 380
    goto case_33;
  }
#line 380
  if (type == 15U) {
#line 380
    goto case_33;
  }
#line 384
  if (type == 26U) {
#line 384
    goto case_26;
  }
#line 389
  if (type == 30U) {
#line 389
    goto case_30;
  }
#line 425
  goto switch_default;
  case_1: /* CIL Label */ 
#line 361
  if (dlen != 4U) {
#line 362
    hp->rcode = 1U;
#line 363
    return (-1);
  }
#line 366
  goto switch_break;
  case_35: /* CIL Label */ 
  {
#line 370
  printf((char const   */* __restrict  */)"NOT HANDLING T_NAPTR RECORDS\n");
  }
#line 371
  goto switch_break;
  case_33: /* CIL Label */ 
  case_21: /* CIL Label */ 
  case_18: /* CIL Label */ 
  case_15: /* CIL Label */ 
  {
#line 381
  printf((char const   */* __restrict  */)"NOT HANDLING T_SRV RECORDS\n");
  }
#line 382
  goto switch_break;
  case_26: /* CIL Label */ 
  {
#line 385
  printf((char const   */* __restrict  */)"NOT HANDLING T_PX RECORDS\n");
  }
#line 386
  goto switch_break;
  case_30: /* CIL Label */ 
  {
#line 391
  n = __dn_expand((u_char const   *)msg, (u_char const   *)eom, (u_char const   *)cp,
                  (char *)(data), (int )sizeof(data));
#line 392
  tmp___2 = strlen((char const   *)(data));
#line 392
  n = (int )tmp___2;
#line 393
  printf((char const   */* __restrict  */)"n = %d\n", n);
  }
#line 395
  if (n < 0) {
    {
#line 396
    printf((char const   */* __restrict  */)"n < 0\n");
#line 397
    hp->rcode = 1U;
    }
#line 398
    return (-1);
  }
  {
#line 401
  tmp___3 = ns_nameok((char const   *)((char *)(data)), (int )class, (struct zoneinfo *)((void *)0),
                      (enum transport )2, (enum context )0, (char const   *)((char *)dname));
  }
#line 401
  if (! tmp___3) {
    {
#line 402
    printf((char const   */* __restrict  */)"Name not ok!\n");
#line 403
    hp->rcode = 1U;
    }
#line 404
    return (-1);
  }
  {
#line 406
  cp += n;
#line 407
  tmp___4 = strlen((char const   *)((char *)(data)));
#line 407
  cp1 = (data + tmp___4) + 1;
#line 409
  printf((char const   */* __restrict  */)"Trying to copy dlen-n = %u bytes from cp to cp1!\n",
         dlen - (u_int )n);
#line 411
  memcpy((void */* __restrict  */)cp1, (void const   */* __restrict  */)cp, (size_t )(dlen - (u_int )n));
#line 415
  cp += dlen - (u_int )n;
#line 416
  cp1 += dlen - (u_int )n;
#line 419
  n = (int )(cp1 - data);
#line 420
  cp1 = data;
  }
#line 422
  goto switch_break;
  switch_default: /* CIL Label */ 
  {
#line 426
  printf((char const   */* __restrict  */)"unknown type %d", type);
  }
#line 427
  return ((int )((cp - rrp) + (long )dlen));
  switch_break: /* CIL Label */ ;
  }
#line 430
  if ((unsigned long )cp > (unsigned long )eom) {
#line 431
    hp->rcode = 1U;
#line 432
    return (-1);
  }
#line 434
  if ((u_int )(cp - rdatap) != dlen) {
    {
#line 436
    printf((char const   */* __restrict  */)"encoded rdata length is %u, but actual length was %u",
           dlen, (u_int )(cp - rdatap));
#line 438
    hp->rcode = 1U;
    }
#line 440
    return (-1);
  }
#line 442
  if (n > 2070) {
    {
#line 443
    printf((char const   */* __restrict  */)"update type %d: %d bytes is too much data",
           type, n);
#line 446
    hp->rcode = 1U;
    }
#line 447
    return (-1);
  }
#line 453
  return ((int )(cp - rrp));
}
}
#line 457 "nxt-bad.c"
int create_msg(u_char *buf ) 
{ 
  u_char *p ;
  char *temp ;
  char *temp1 ;
  u_char *comp_dn ;
  u_char *comp_dn2 ;
  char exp_dn[200] ;
  char exp_dn2[200] ;
  u_char **dnptrs ;
  u_char **lastdnptr ;
  u_char **dnptrs2 ;
  int i ;
  int len ;
  int comp_size ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  size_t tmp___4 ;
  u_char *tmp___5 ;
  char *tmp___6 ;
  u_char **tmp___7 ;
  u_char **tmp___8 ;
  size_t tmp___9 ;
  u_char *tmp___10 ;
  u_char *tmp___11 ;
  u_int16_t t_s ;
  u_char *t_cp ;
  u_char *tmp___12 ;
  u_int16_t t_s___0 ;
  u_char *t_cp___0 ;
  u_char *tmp___13 ;
  u_int32_t t_l ;
  u_char *t_cp___1 ;
  u_char *tmp___14 ;
  u_char *tmp___15 ;
  u_char *tmp___16 ;
  u_int16_t t_s___1 ;
  u_char *t_cp___2 ;
  u_char *tmp___17 ;
  u_char **tmp___18 ;
  u_char **tmp___19 ;
  size_t tmp___20 ;
  u_char *tmp___21 ;
  u_char *tmp___22 ;
  u_int32_t t_l___0 ;
  u_char *t_cp___3 ;
  u_char *tmp___23 ;
  u_char *tmp___24 ;
  u_char *tmp___25 ;
  u_int32_t t_l___1 ;
  u_char *t_cp___4 ;
  u_char *tmp___26 ;
  u_char *tmp___27 ;
  u_char *tmp___28 ;
  u_int32_t t_l___2 ;
  u_char *t_cp___5 ;
  u_char *tmp___29 ;
  u_char *tmp___30 ;
  u_char *tmp___31 ;
  u_int32_t t_l___3 ;
  u_char *t_cp___6 ;
  u_char *tmp___32 ;
  u_char *tmp___33 ;
  u_char *tmp___34 ;
  void *__cil_tmp68 ;
  void *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;

  {
  {
#line 464
  len = 0;
#line 467
  tmp = malloc(2UL * sizeof(unsigned char *));
#line 467
  dnptrs = (unsigned char **)tmp;
#line 468
  tmp___0 = malloc(2UL * sizeof(unsigned char *));
#line 468
  dnptrs2 = (unsigned char **)tmp___0;
#line 470
  tmp___1 = malloc(200UL * sizeof(unsigned char ));
#line 470
  comp_dn = (unsigned char *)tmp___1;
#line 471
  tmp___2 = malloc(200UL * sizeof(unsigned char ));
#line 471
  comp_dn2 = (unsigned char *)tmp___2;
#line 473
  tmp___3 = malloc(400UL * sizeof(char ));
#line 473
  temp1 = (char *)tmp___3;
#line 475
  temp = temp1;
#line 477
  p = buf;
#line 479
  strcpy((char */* __restrict  */)temp, (char const   */* __restrict  */)"HEADER JUNK:");
#line 481
  tmp___4 = strlen((char const   *)temp);
#line 481
  len = (int )((size_t )len + tmp___4);
  }
  {
#line 483
  while (1) {
    while_continue: /* CIL Label */ ;
#line 483
    if (! ((int )*temp != 0)) {
#line 483
      goto while_break;
    }
#line 484
    tmp___5 = p;
#line 484
    p ++;
#line 484
    tmp___6 = temp;
#line 484
    temp ++;
#line 484
    *tmp___5 = (u_char )*tmp___6;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 486
  strcpy((char */* __restrict  */)(exp_dn), (char const   */* __restrict  */)"lcs.mit.edu");
#line 488
  tmp___7 = dnptrs;
#line 488
  dnptrs ++;
#line 488
  *tmp___7 = (u_char *)(exp_dn);
#line 489
  tmp___8 = dnptrs;
#line 489
  dnptrs --;
#line 489
  *tmp___8 = (u_char *)((void *)0);
#line 491
  lastdnptr = (u_char **)((void *)0);
#line 493
  printf((char const   */* __restrict  */)"Calling dn_comp..\n");
#line 494
  comp_size = 200;
#line 495
  tmp___9 = strlen((char const   *)(exp_dn));
#line 495
  printf((char const   */* __restrict  */)"uncomp_size = %d\n", tmp___9);
#line 496
  printf((char const   */* __restrict  */)"comp_size = %d\n", comp_size);
#line 497
  printf((char const   */* __restrict  */)"exp_dn = %s, comp_dn = %s\n", exp_dn, (char *)comp_dn);
#line 499
  i = 0;
  }
  {
#line 499
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 499
    if (! (i < comp_size)) {
#line 499
      goto while_break___0;
    }
#line 500
    tmp___10 = p;
#line 500
    p ++;
#line 500
    tmp___11 = comp_dn;
#line 500
    comp_dn ++;
#line 500
    *tmp___10 = *tmp___11;
#line 499
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 502
  len += comp_size;
  {
#line 504
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 504
    t_s = (u_int16_t )30;
#line 504
    t_cp = p;
#line 504
    tmp___12 = t_cp;
#line 504
    t_cp ++;
#line 504
    *tmp___12 = (u_char )((int )t_s >> 8);
#line 504
    *t_cp = (u_char )t_s;
#line 504
    p += 2;
#line 504
    goto while_break___1;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 505
  p += 2;
  {
#line 507
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 507
    t_s___0 = (u_int16_t )255;
#line 507
    t_cp___0 = p;
#line 507
    tmp___13 = t_cp___0;
#line 507
    t_cp___0 ++;
#line 507
    *tmp___13 = (u_char )((int )t_s___0 >> 8);
#line 507
    *t_cp___0 = (u_char )t_s___0;
#line 507
    p += 2;
#line 507
    goto while_break___2;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 508
  p += 2;
  {
#line 510
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 510
    t_l = (u_int32_t )255;
#line 510
    t_cp___1 = p;
#line 510
    tmp___14 = t_cp___1;
#line 510
    t_cp___1 ++;
#line 510
    *tmp___14 = (u_char )(t_l >> 24);
#line 510
    tmp___15 = t_cp___1;
#line 510
    t_cp___1 ++;
#line 510
    *tmp___15 = (u_char )(t_l >> 16);
#line 510
    tmp___16 = t_cp___1;
#line 510
    t_cp___1 ++;
#line 510
    *tmp___16 = (u_char )(t_l >> 8);
#line 510
    *t_cp___1 = (u_char )t_l;
#line 510
    p += 4;
#line 510
    goto while_break___3;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 511
  p += 4;
  {
#line 513
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 513
    t_s___1 = (u_int16_t )16;
#line 513
    t_cp___2 = p;
#line 513
    tmp___17 = t_cp___2;
#line 513
    t_cp___2 ++;
#line 513
    *tmp___17 = (u_char )((int )t_s___1 >> 8);
#line 513
    *t_cp___2 = (u_char )t_s___1;
#line 513
    p += 2;
#line 513
    goto while_break___4;
  }
  while_break___4: /* CIL Label */ ;
  }
  {
#line 516
  p += 2;
#line 518
  len += 10;
#line 520
  strcpy((char */* __restrict  */)(exp_dn2), (char const   */* __restrict  */)"sls.lcs.mit.edu");
#line 522
  tmp___18 = dnptrs2;
#line 522
  dnptrs2 ++;
#line 522
  *tmp___18 = (u_char *)(exp_dn2);
#line 523
  tmp___19 = dnptrs2;
#line 523
  dnptrs2 --;
#line 523
  *tmp___19 = (u_char *)((void *)0);
#line 524
  lastdnptr = (u_char **)((void *)0);
#line 526
  printf((char const   */* __restrict  */)"Calling dn_comp..\n");
#line 527
  comp_size = 200;
#line 528
  tmp___20 = strlen((char const   *)(exp_dn2));
#line 528
  printf((char const   */* __restrict  */)"uncomp_size = %d\n", tmp___20);
#line 529
  printf((char const   */* __restrict  */)"comp_size = %d\n", comp_size);
#line 530
  printf((char const   */* __restrict  */)"exp_dn2 = %s, comp_dn2 = %s\n", exp_dn2,
         (char *)comp_dn2);
#line 532
  len += comp_size;
#line 534
  i = 0;
  }
  {
#line 534
  while (1) {
    while_continue___5: /* CIL Label */ ;
#line 534
    if (! (i < comp_size)) {
#line 534
      goto while_break___5;
    }
#line 535
    tmp___21 = p;
#line 535
    p ++;
#line 535
    tmp___22 = comp_dn2;
#line 535
    comp_dn2 ++;
#line 535
    *tmp___21 = *tmp___22;
#line 534
    i ++;
  }
  while_break___5: /* CIL Label */ ;
  }
  {
#line 537
  while (1) {
    while_continue___6: /* CIL Label */ ;
#line 537
    t_l___0 = (u_int32_t )(1 << 24);
#line 537
    t_cp___3 = p;
#line 537
    tmp___23 = t_cp___3;
#line 537
    t_cp___3 ++;
#line 537
    *tmp___23 = (u_char )(t_l___0 >> 24);
#line 537
    tmp___24 = t_cp___3;
#line 537
    t_cp___3 ++;
#line 537
    *tmp___24 = (u_char )(t_l___0 >> 16);
#line 537
    tmp___25 = t_cp___3;
#line 537
    t_cp___3 ++;
#line 537
    *tmp___25 = (u_char )(t_l___0 >> 8);
#line 537
    *t_cp___3 = (u_char )t_l___0;
#line 537
    p += 4;
#line 537
    goto while_break___6;
  }
  while_break___6: /* CIL Label */ ;
  }
#line 538
  p += 4;
  {
#line 539
  while (1) {
    while_continue___7: /* CIL Label */ ;
#line 539
    t_l___1 = (u_int32_t )0;
#line 539
    t_cp___4 = p;
#line 539
    tmp___26 = t_cp___4;
#line 539
    t_cp___4 ++;
#line 539
    *tmp___26 = (u_char )(t_l___1 >> 24);
#line 539
    tmp___27 = t_cp___4;
#line 539
    t_cp___4 ++;
#line 539
    *tmp___27 = (u_char )(t_l___1 >> 16);
#line 539
    tmp___28 = t_cp___4;
#line 539
    t_cp___4 ++;
#line 539
    *tmp___28 = (u_char )(t_l___1 >> 8);
#line 539
    *t_cp___4 = (u_char )t_l___1;
#line 539
    p += 4;
#line 539
    goto while_break___7;
  }
  while_break___7: /* CIL Label */ ;
  }
#line 540
  p += 4;
  {
#line 541
  while (1) {
    while_continue___8: /* CIL Label */ ;
#line 541
    t_l___2 = (u_int32_t )0;
#line 541
    t_cp___5 = p;
#line 541
    tmp___29 = t_cp___5;
#line 541
    t_cp___5 ++;
#line 541
    *tmp___29 = (u_char )(t_l___2 >> 24);
#line 541
    tmp___30 = t_cp___5;
#line 541
    t_cp___5 ++;
#line 541
    *tmp___30 = (u_char )(t_l___2 >> 16);
#line 541
    tmp___31 = t_cp___5;
#line 541
    t_cp___5 ++;
#line 541
    *tmp___31 = (u_char )(t_l___2 >> 8);
#line 541
    *t_cp___5 = (u_char )t_l___2;
#line 541
    p += 4;
#line 541
    goto while_break___8;
  }
  while_break___8: /* CIL Label */ ;
  }
#line 542
  p += 4;
  {
#line 543
  while (1) {
    while_continue___9: /* CIL Label */ ;
#line 543
    t_l___3 = (u_int32_t )0;
#line 543
    t_cp___6 = p;
#line 543
    tmp___32 = t_cp___6;
#line 543
    t_cp___6 ++;
#line 543
    *tmp___32 = (u_char )(t_l___3 >> 24);
#line 543
    tmp___33 = t_cp___6;
#line 543
    t_cp___6 ++;
#line 543
    *tmp___33 = (u_char )(t_l___3 >> 16);
#line 543
    tmp___34 = t_cp___6;
#line 543
    t_cp___6 ++;
#line 543
    *tmp___34 = (u_char )(t_l___3 >> 8);
#line 543
    *t_cp___6 = (u_char )t_l___3;
#line 543
    p += 4;
#line 543
    goto while_break___9;
  }
  while_break___9: /* CIL Label */ ;
  }
#line 544
  p += 4;
#line 546
  len += 16;
#line 548
  return (len);
}
}
#line 554 "nxt-bad.c"
int main(void) 
{ 
  int msglen ;
  int ret ;
  u_char *dp ;
  u_char *name ;
  void *tmp ;
  u_char *msg ;
  void *tmp___0 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;
  char *__cil_tmp11 ;

  {
  {
#line 558
  tmp = malloc(100UL * sizeof(u_char ));
#line 558
  name = (u_char *)tmp;
#line 559
  tmp___0 = malloc(1000UL * sizeof(u_char ));
#line 559
  msg = (u_char *)tmp___0;
#line 561
  printf((char const   */* __restrict  */)"Calling create_msg:\n");
#line 562
  msglen = create_msg(msg);
#line 564
  printf((char const   */* __restrict  */)"msglen = %d\n", msglen);
#line 566
  dp = msg + sizeof(HEADER );
#line 568
  printf((char const   */* __restrict  */)"Calling rrextract!\n");
#line 570
  __res_init();
#line 571
  ret = rrextract(msg, msglen, dp, name, 100);
#line 573
  printf((char const   */* __restrict  */)"rrextract returned %d\n", ret);
  }
#line 575
  return (0);
}
}
