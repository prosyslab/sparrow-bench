/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 196 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef int int32_t;
#line 48 "/usr/include/stdint.h"
typedef unsigned char uint8_t;
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.h"
struct __anonstruct_dw_str_25 {
   uint32_t len ;
   uint32_t max ;
   uint8_t sane ;
   uint8_t *str ;
};
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.h"
typedef struct __anonstruct_dw_str_25 dw_str;
#line 172 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 189 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __socklen_t;
#line 109 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __ssize_t ssize_t;
#line 195 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef short int16_t;
#line 197 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef long int64_t;
#line 54 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef long __fd_mask;
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
struct __anonstruct_fd_set_10 {
   __fd_mask __fds_bits[1024 / (8 * (int )sizeof(__fd_mask ))] ;
};
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef struct __anonstruct_fd_set_10 fd_set;
#line 33 "/usr/include/x86_64-linux-gnu/bits/socket.h"
typedef __socklen_t socklen_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 149 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 117 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 209 "/usr/include/netinet/in.h"
union __anonunion___in6_u_35 {
   uint8_t __u6_addr8[16] ;
   uint16_t __u6_addr16[8] ;
   uint32_t __u6_addr32[4] ;
};
#line 209 "/usr/include/netinet/in.h"
struct in6_addr {
   union __anonunion___in6_u_35 __in6_u ;
};
#line 237 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 252 "/usr/include/netinet/in.h"
struct sockaddr_in6 {
   sa_family_t sin6_family ;
   in_port_t sin6_port ;
   uint32_t sin6_flowinfo ;
   struct in6_addr sin6_addr ;
   uint32_t sin6_scope_id ;
};
#line 92 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_ip_addr_T_39 {
   uint8_t len ;
   uint8_t ip[17] ;
   dw_str *glueless ;
   uint8_t flags ;
};
#line 92 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_ip_addr_T_39 ip_addr_T;
#line 122 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
union __anonunion_u_42 {
   sa_family_t family ;
   struct sockaddr_in v4 ;
   struct sockaddr_in6 v6 ;
};
#line 122 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_sockaddr_all_T_41 {
   union __anonunion_u_42 u ;
};
#line 122 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_sockaddr_all_T_41 sockaddr_all_T;
#line 183 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_tcp_pend_T_46 {
   int local ;
   int upstream ;
   char *buffer ;
   int32_t wanted ;
   int32_t got ;
   int32_t sent ;
   int state ;
   int64_t die ;
};
#line 183 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_tcp_pend_T_46 tcp_pend_T;
#line 194 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef signed char int8_t;
#line 93 "/usr/include/stdint.h"
typedef long int_fast32_t;
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
struct dw_element;
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
struct dw_fila {
   struct dw_fila *last ;
   struct dw_fila *next ;
   struct dw_element *record ;
};
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
typedef struct dw_fila dw_fila;
#line 31 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
struct dw_element {
   dw_str *key ;
   dw_str *value ;
   dw_fila *fila ;
   int8_t immutable ;
   int64_t expire ;
   struct dw_element *next ;
   struct dw_element **prev ;
};
#line 31 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
typedef struct dw_element dw_element;
#line 43 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
struct __anonstruct_dw_hash_26 {
   dw_fila *fila ;
   dw_element **hash ;
   uint32_t mask ;
   int32_t size ;
   int32_t max ;
};
#line 43 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
typedef struct __anonstruct_dw_hash_26 dw_hash;
#line 26 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.h"
struct __anonstruct_dns_string_27 {
   dw_str *packet ;
   uint16_t *an ;
   uint16_t *ns ;
   uint16_t *ar ;
   int32_t ancount ;
   int32_t nscount ;
   int32_t arcount ;
   uint8_t type ;
};
#line 26 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.h"
typedef struct __anonstruct_dns_string_27 dns_string;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 38 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.h"
struct __anonstruct_dwr_rg_28 {
   uint32_t *mill ;
   uint32_t *belt ;
   int32_t index ;
};
#line 38 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.h"
typedef struct __anonstruct_dwr_rg_28 dwr_rg;
#line 138 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_local_T_43 {
   int from_socket ;
   int tcp_num ;
   uint16_t local_id ;
   ip_addr_T ip ;
   uint16_t port ;
   uint8_t glueless_type ;
   int glueless_conn ;
   dw_str *orig_query ;
   dw_str *action ;
};
#line 138 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_local_T_43 local_T;
#line 154 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_remote_T_44 {
   int socket ;
   int64_t die ;
   uint16_t remote_id ;
   int retries ;
   dw_str *ns ;
   uint8_t is_upstream ;
   dw_str *query ;
   uint8_t recurse_depth ;
   int8_t current_ns ;
   int child_id ;
   dw_str *glueless ;
   uint16_t num_locals ;
   local_T **local ;
};
#line 154 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_remote_T_44 remote_T;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 315 "/usr/include/libio.h"
typedef struct _IO_FILE _IO_FILE;
#line 25 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.h"
struct __anonstruct_dns_details_48 {
   dns_string *look ;
   int8_t *an_types ;
   int8_t *ns_types ;
   int8_t *ar_types ;
};
#line 25 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.h"
typedef struct __anonstruct_dns_details_48 dns_details;
#line 124 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __dev_t;
#line 125 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 126 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __gid_t;
#line 127 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __ino_t;
#line 129 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __mode_t;
#line 130 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __nlink_t;
#line 133 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __pid_t;
#line 147 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __clockid_t;
#line 153 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blksize_t;
#line 158 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blkcnt_t;
#line 175 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __syscall_slong_t;
#line 232 "/usr/include/unistd.h"
typedef __gid_t gid_t;
#line 260 "/usr/include/unistd.h"
typedef __pid_t pid_t;
#line 120 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   __syscall_slong_t tv_nsec ;
};
#line 46 "/usr/include/x86_64-linux-gnu/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   __ino_t st_ino ;
   __nlink_t st_nlink ;
   __mode_t st_mode ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   int __pad0 ;
   __dev_t st_rdev ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __syscall_slong_t __glibc_reserved[3] ;
};
#line 91 "/usr/include/time.h"
typedef __clockid_t clockid_t;
#line 85 "/usr/include/signal.h"
typedef void (*__sighandler_t)(int  );
#line 141 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __suseconds_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 108 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
struct __anonstruct_ip_mask_T_40 {
   uint8_t len ;
   uint8_t ip[17] ;
   uint8_t mask[17] ;
};
#line 108 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
typedef struct __anonstruct_ip_mask_T_40 ip_mask_T;
#line 227 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
struct __anonstruct_dwm_fs_27 {
   char pattern[9] ;
   char action[9] ;
   char newstate[9] ;
};
#line 227 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
typedef struct __anonstruct_dwm_fs_27 dwm_fs;
#line 19 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../libs/JsStr.h"
struct __anonstruct_js_string_1 {
   unsigned char *string ;
   unsigned int unit_size ;
   unsigned int unit_count ;
   unsigned int max_count ;
   int encoding ;
   int is_good ;
};
#line 19 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../libs/JsStr.h"
typedef struct __anonstruct_js_string_1 js_string;
#line 20 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress_rrs.h"
struct rrdesc {
   int rr_num ;
   char *description ;
   char tocompress ;
   struct rrdesc *next ;
};
#line 20 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress_rrs.h"
typedef struct rrdesc rrdesc;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
struct compress_state {
   js_string *compressed ;
   js_string *uncompressed ;
   unsigned int uncompressed_offset ;
   unsigned int this_dlabel_begin ;
   int *dlabel_points ;
   unsigned int this_rdlength_begin ;
   int this_rr_type ;
   int current_rdlength ;
   int valid_state ;
   int number_answers ;
};
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
typedef struct compress_state compress_state;
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/JsStr.h"
struct __anonstruct_js_file_2 {
   int filetype ;
   int file_desc ;
   js_string *buffer ;
   int number ;
   int eof ;
};
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/JsStr.h"
typedef struct __anonstruct_js_file_2 js_file;
#line 25 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/MaraHash.h"
struct mhash_spot {
   js_string *key ;
   void *value ;
   int datatype ;
   struct mhash_spot *next ;
};
#line 25 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/MaraHash.h"
typedef struct mhash_spot mhash_spot;
#line 41 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/MaraHash.h"
struct __anonstruct_mhash_12 {
   int hash_bits ;
   mhash_spot **hash_table ;
   unsigned int spots ;
};
#line 41 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/MaraHash.h"
typedef struct __anonstruct_mhash_12 mhash;
#line 242 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
struct __anonstruct_q_header_5 {
   uint16_t id ;
   int qr ;
   int opcode ;
   int aa ;
   int tc ;
   int rd ;
   int ra ;
   int z ;
   int rcode ;
   uint16_t qdcount ;
   uint16_t ancount ;
   uint16_t nscount ;
   uint16_t arcount ;
};
#line 242 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
typedef struct __anonstruct_q_header_5 q_header;
#line 259 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
struct __anonstruct_q_question_6 {
   js_string *qname ;
   uint16_t qtype ;
   uint16_t qclass ;
};
#line 259 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
typedef struct __anonstruct_q_question_6 q_question;
#line 266 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
struct __anonstruct_q_rr_7 {
   js_string *name ;
   uint16_t type ;
   uint16_t class ;
   uint32_t ttl ;
   uint16_t rdlength ;
   js_string *rdata ;
};
#line 266 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
typedef struct __anonstruct_q_rr_7 q_rr;
#line 412 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
struct __anonstruct_rr_soa_8 {
   js_string *mname ;
   js_string *rname ;
   uint32_t serial ;
   int32_t refresh ;
   int32_t retry ;
   int32_t expire ;
   uint32_t minimum ;
};
#line 412 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../MaraDns.h"
typedef struct __anonstruct_rr_soa_8 rr_soa;
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.h"
typedef unsigned char u8;
#line 55 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.h"
typedef unsigned int u32;
#line 91 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
typedef unsigned char MARA_BYTE;
#line 94 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
struct __anonstruct_keyInstance_25 {
   MARA_BYTE direction ;
   int keyLen ;
   char keyMaterial[65] ;
   int Nr ;
   u32 rk[60] ;
   u32 ek[60] ;
};
#line 94 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
typedef struct __anonstruct_keyInstance_25 keyInstance;
#line 104 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
struct __anonstruct_cipherInstance_26 {
   MARA_BYTE mode ;
   MARA_BYTE IV[16] ;
};
#line 104 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
typedef struct __anonstruct_cipherInstance_26 cipherInstance;
#line 133 "/usr/include/time.h"
struct tm {
   int tm_sec ;
   int tm_min ;
   int tm_hour ;
   int tm_mday ;
   int tm_mon ;
   int tm_year ;
   int tm_wday ;
   int tm_yday ;
   int tm_isdst ;
   long tm_gmtoff ;
   char const   *tm_zone ;
};
#line 19 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.h"
struct __anonstruct_mara_tuple_3 {
   int elements ;
   js_string **tuple_list ;
};
#line 19 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.h"
typedef struct __anonstruct_mara_tuple_3 mara_tuple;
#line 33 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.h"
struct __anonstruct_mhash_e_4 {
   void **point ;
   void *value ;
   int datatype ;
};
#line 33 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.h"
typedef struct __anonstruct_mhash_e_4 mhash_e;
#line 176 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
struct fila {
   struct fila *siguiente ;
   struct fila *previous ;
   unsigned char datatype ;
   void *record ;
   js_string *hash_point ;
   char nukable_hp ;
};
#line 176 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
typedef struct fila fila;
#line 206
struct rr_list;
#line 206 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
struct rr {
   int64_t expire ;
   uint32_t ttl ;
   uint32_t authoritative ;
   struct rr *next ;
   struct rr *ip ;
   struct rr *ip6 ;
   js_string *ptr ;
   uint16_t rr_type ;
   js_string *query ;
   js_string *data ;
   fila *zap ;
   char seen ;
   uint16_t perms ;
   struct rr_list *list ;
   char rcode ;
};
#line 206 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
typedef struct rr rr;
#line 234 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
struct rr_list {
   uint16_t rr_type ;
   rr *data ;
   struct rr_list *next ;
};
#line 234 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
typedef struct rr_list rr_list;
#line 27 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
struct csv2_rr {
   js_string *query ;
   int rtype ;
   int32_t ttl ;
   js_string *data ;
   struct csv2_rr *next ;
};
#line 27 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
typedef struct csv2_rr csv2_rr;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
struct csv2_origin {
   js_string *origin ;
   struct csv2_origin *next ;
};
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
typedef struct csv2_origin csv2_origin;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
struct csv2_add_state {
   csv2_rr *buffer ;
   js_string *zone ;
   js_string *origin ;
   csv2_origin *ostack ;
   int ostack_height ;
   int rrnum ;
   int add_method ;
   int32_t soa_serial ;
   int32_t default_ttl ;
   int in_ns ;
   int zone_nses_added ;
   mhash *bighash ;
};
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.h"
typedef struct csv2_add_state csv2_add_state;
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.h"
struct csv2_file {
   FILE *reading ;
   char *filename ;
   struct csv2_file *next ;
};
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.h"
typedef struct csv2_file csv2_file;
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.h"
struct csv2_read {
   FILE *reading ;
   char *filename ;
   csv2_file *stack ;
   char context[19] ;
   char chars_allowed ;
   char tilde_seen ;
   char tilde_handling ;
   int stack_height ;
   int cplace ;
   int mnum ;
   int mplace ;
   int linenum ;
   int justread ;
   int32_t unicode ;
   int ok_to_read ;
   char seen_bug_msg ;
};
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.h"
typedef struct csv2_read csv2_read;
#line 169 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../MaraDns.h"
struct __anonstruct_ipv4pair_7 {
   uint32_t ip ;
   uint32_t mask ;
};
#line 169 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../MaraDns.h"
typedef struct __anonstruct_ipv4pair_7 ipv4pair;
#line 162 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
struct __anonstruct_conn_68 {
   unsigned char type ;
   void *d ;
   int addrlen ;
};
#line 162 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../MaraDns.h"
typedef struct __anonstruct_conn_68 conn;
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 22 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr_functions.h"
int dw_assert_sanity(dw_str *object ) ;
#line 28
dw_str *dw_create(uint32_t size ) ;
#line 34
int dw_destroy(dw_str *object ) ;
#line 37
int dw_addchar(uint8_t add , dw_str *object ) ;
#line 42
int dw_cstr_append(uint8_t *add , int32_t len , dw_str *obj ) ;
#line 49
int dw_qrappend(uint8_t *add , dw_str *object , char nope ) ;
#line 92
dw_str *dw_substr(dw_str *obj , int32_t begin , int32_t amount , int32_t max ) ;
#line 99
int32_t dw_fetch_u16(dw_str *object , int32_t offset ) ;
#line 103
int32_t dw_pop_u16(dw_str *object ) ;
#line 107
int32_t dw_pop_u8(dw_str *object ) ;
#line 113
int32_t dw_fetch_u8(dw_str *object , int32_t offset ) ;
#line 129
int dw_put_u16(dw_str *obj , uint16_t value___6 , int32_t offset ) ;
#line 145
int dw_put_u8(dw_str *obj , uint8_t value___6 , int32_t offset ) ;
#line 159
int dw_issame(dw_str *a , dw_str *b ) ;
#line 164
int dw_append(dw_str *toappend , dw_str *target ) ;
#line 171
int dw_substr_append(dw_str *splice , int32_t begin , int32_t amount , dw_str *target ) ;
#line 178
uint8_t *dw_to_cstr(dw_str *obj ) ;
#line 186
int32_t dw_rfind(dw_str *obj , unsigned char rx ) ;
#line 197
dw_str *dw_qspop(dw_str *in ) ;
#line 205
dw_str *dw_zap_lws(dw_str *obj ) ;
#line 220
int32_t dw_atoi(dw_str *obj , int32_t index___0 , int base ) ;
#line 229
dw_str *dw_get_dname(uint8_t *raw , int offset , int max ) ;
#line 238
dw_str *dw_get_dname_type(uint8_t *raw , int offset , int max ) ;
#line 249
dw_str *dw_packet_to_cache(uint8_t *raw , int len , uint8_t type ) ;
#line 261
int32_t dw_get_a_dnsttl(dw_str *in , int offset , int32_t max , int depth ) ;
#line 266
int dw_filename_sanitize(dw_str *obj ) ;
#line 271
int32_t dw_cachepacket_to_ancount(dw_str *packet ) ;
#line 276
int dw_ends_in_dot(dw_str *in ) ;
#line 281
dw_str *dw_dnsname_convert(dw_str *in ) ;
#line 290
dw_str *dw_dnslabel_chop(dw_str *in ) ;
#line 294
int32_t dw_get_dn_end(dw_str *in , int offset ) ;
#line 305
int dw_rotate(dw_str *in , int32_t start , int32_t pivot , int32_t end ) ;
#line 26 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_assert_sanity(dw_str *object ) 
{ 


  {
#line 27
  if ((unsigned long )object == (unsigned long )((dw_str *)0)) {
#line 28
    return (-1);
  }
#line 30
  if ((int )object->sane != 114) {
#line 31
    return (-1);
  }
#line 33
  if ((unsigned long )object->str == (unsigned long )((uint8_t *)0)) {
#line 34
    return (-1);
  }
#line 36
  if (object->len >= object->max) {
#line 37
    return (-1);
  }
#line 39
  if (object->len > 268435455U) {
#line 40
    return (-1);
  }
#line 42
  return (0);
}
}
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_create(uint32_t size ) 
{ 
  dw_str *new ;
  void *tmp ;
  void *tmp___0 ;

  {
  {
#line 51
  tmp = malloc(sizeof(dw_str ));
#line 51
  new = (dw_str *)tmp;
  }
#line 52
  if ((unsigned long )new == (unsigned long )((dw_str *)0)) {
#line 53
    return ((dw_str *)0);
  }
#line 56
  if (size >= 134217728U) {
    {
#line 57
    free((void *)new);
    }
#line 58
    return ((dw_str *)0);
  }
  {
#line 61
  tmp___0 = malloc((size_t )(size + 2U));
#line 61
  new->str = (uint8_t *)tmp___0;
  }
#line 62
  if ((unsigned long )new->str == (unsigned long )((uint8_t *)0)) {
    {
#line 63
    free((void *)new);
    }
#line 64
    return ((dw_str *)0);
  }
#line 66
  new->len = (uint32_t )0;
#line 67
  new->max = size;
#line 68
  new->sane = (uint8_t )114;
#line 69
  return (new);
}
}
#line 76 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_destroy(dw_str *object ) 
{ 


  {
#line 77
  if ((unsigned long )object == (unsigned long )((dw_str *)0)) {
#line 78
    return (-1);
  }
#line 81
  if ((int )object->sane != 114) {
#line 82
    return (-1);
  }
#line 84
  if ((unsigned long )object->str == (unsigned long )((uint8_t *)0)) {
    {
#line 85
    free((void *)object);
    }
#line 86
    return (-1);
  }
  {
#line 88
  free((void *)object->str);
#line 90
  object->str = (uint8_t *)0;
#line 91
  object->sane = (uint8_t )0;
#line 92
  object->len = (uint32_t )0;
#line 93
  object->max = (uint32_t )0;
#line 94
  free((void *)object);
  }
#line 95
  return (0);
}
}
#line 100 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_addchar(uint8_t add , dw_str *object ) 
{ 
  int tmp ;

  {
  {
#line 101
  tmp = dw_assert_sanity(object);
  }
#line 101
  if (tmp == -1) {
#line 102
    return (-1);
  }
#line 104
  if (object->max > object->len + 1U) {
#line 105
    *(object->str + object->len) = add;
#line 106
    (object->len) ++;
  } else {
#line 108
    return (-1);
  }
#line 110
  return (0);
}
}
#line 116 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_cstr_append(uint8_t *add , int32_t len , dw_str *obj ) 
{ 
  int tmp ;

  {
  {
#line 117
  tmp = dw_assert_sanity(obj);
  }
#line 117
  if (tmp == -1) {
#line 118
    return (-1);
  }
#line 120
  if ((unsigned long )add == (unsigned long )((uint8_t *)0)) {
#line 121
    return (-1);
  }
#line 123
  if (len < 0) {
#line 124
    return (-1);
  }
#line 126
  if (obj->len + (uint32_t )len >= obj->max) {
#line 127
    return (-1);
  }
  {
#line 129
  while (1) {
    while_continue: /* CIL Label */ ;
#line 129
    if (! (len > 0)) {
#line 129
      goto while_break;
    }
#line 130
    *(obj->str + obj->len) = *add;
#line 131
    add ++;
#line 132
    (obj->len) ++;
#line 133
    len --;
  }
  while_break: /* CIL Label */ ;
  }
#line 135
  return (0);
}
}
#line 143 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_qrappend(uint8_t *add , dw_str *object , char nope ) 
{ 
  int tmp ;

  {
  {
#line 144
  tmp = dw_assert_sanity(object);
  }
#line 144
  if (tmp == -1) {
#line 145
    return (-1);
  }
#line 147
  if ((unsigned long )add == (unsigned long )((uint8_t *)0)) {
#line 148
    return (-1);
  }
  {
#line 150
  while (1) {
    while_continue: /* CIL Label */ ;
#line 150
    if ((int )*add != 0) {
#line 150
      if ((int )*add != (int )nope) {
#line 150
        if (! (object->len < object->max)) {
#line 150
          goto while_break;
        }
      } else {
#line 150
        goto while_break;
      }
    } else {
#line 150
      goto while_break;
    }
#line 151
    *(object->str + object->len) = *add;
#line 152
    add ++;
#line 153
    (object->len) ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 155
  return (0);
}
}
#line 261 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_substr(dw_str *obj , int32_t begin , int32_t amount , int32_t max ) 
{ 
  dw_str *copy ;
  int c ;
  int tmp ;

  {
  {
#line 262
  copy = (dw_str *)0;
#line 263
  c = 0;
#line 265
  tmp = dw_assert_sanity(obj);
  }
#line 265
  if (tmp == -1) {
#line 266
    goto catch_dw_substr;
  }
#line 270
  if (begin < 0) {
#line 271
    begin = (int32_t )(obj->len + (uint32_t )begin);
  }
#line 273
  if (amount < 0) {
#line 274
    amount = (int32_t )(((obj->len - (uint32_t )begin) + (uint32_t )amount) + 1U);
  }
#line 278
  if (max >= 0) {
    {
#line 279
    copy = dw_create((uint32_t )((amount + max) + 1));
    }
  } else
#line 280
  if (max == -1) {
    {
#line 281
    copy = dw_create(obj->max);
    }
  } else {
#line 283
    goto catch_dw_substr;
  }
#line 286
  if ((unsigned long )copy == (unsigned long )((dw_str *)0)) {
#line 287
    goto catch_dw_substr;
  }
#line 291
  c = 0;
  {
#line 291
  while (1) {
    while_continue: /* CIL Label */ ;
#line 291
    if (! (c < amount)) {
#line 291
      goto while_break;
    }
#line 293
    if ((uint32_t )(c + begin) > obj->len) {
#line 294
      goto while_break;
    } else
#line 293
    if ((uint32_t )c >= copy->max) {
#line 294
      goto while_break;
    }
#line 296
    *(copy->str + c) = *((obj->str + begin) + c);
#line 291
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 299
  copy->len = (uint32_t )c;
#line 301
  return (copy);
  catch_dw_substr: 
#line 305
  if ((unsigned long )copy != (unsigned long )((dw_str *)0)) {
    {
#line 306
    dw_destroy(copy);
#line 307
    copy = (dw_str *)0;
    }
  }
#line 309
  return ((dw_str *)0);
}
}
#line 319 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_fetch_u16(dw_str *object , int32_t offset ) 
{ 
  uint8_t *look ;
  int tmp ;

  {
  {
#line 320
  look = (uint8_t *)0;
#line 321
  tmp = dw_assert_sanity(object);
  }
#line 321
  if (tmp == -1) {
#line 322
    return (-1);
  }
#line 324
  if (offset < 0) {
#line 325
    offset = (int32_t )(((uint32_t )offset + object->len) - 1U);
  }
#line 327
  if ((uint32_t )(offset + 1) > object->len) {
#line 328
    return (-1);
  } else
#line 327
  if (offset < 0) {
#line 328
    return (-1);
  }
#line 330
  look = object->str;
#line 331
  look += offset;
#line 332
  return (((int )*look << 8) | (int )*(look + 1));
}
}
#line 337 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_pop_u16(dw_str *object ) 
{ 
  uint8_t *look ;
  int tmp ;

  {
  {
#line 338
  look = (uint8_t *)0;
#line 339
  tmp = dw_assert_sanity(object);
  }
#line 339
  if (tmp == -1) {
#line 340
    return (-1);
  }
#line 342
  if (object->len < 2U) {
#line 343
    return (-1);
  }
#line 345
  look = (object->str + object->len) - 2;
#line 346
  object->len -= 2U;
#line 347
  return (((int )*look << 8) | (int )*(look + 1));
}
}
#line 352 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_pop_u8(dw_str *object ) 
{ 
  uint8_t *look ;
  int tmp ;

  {
  {
#line 353
  look = (uint8_t *)0;
#line 354
  tmp = dw_assert_sanity(object);
  }
#line 354
  if (tmp == -1) {
#line 355
    return (-1);
  }
#line 357
  if (object->len < 1U) {
#line 358
    return (-1);
  }
#line 360
  look = (object->str + object->len) - 1;
#line 361
  (object->len) --;
#line 362
  return ((int32_t )*look);
}
}
#line 371 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_fetch_u8(dw_str *object , int32_t offset ) 
{ 
  uint8_t *look ;
  int tmp ;

  {
  {
#line 372
  look = (uint8_t *)0;
#line 373
  tmp = dw_assert_sanity(object);
  }
#line 373
  if (tmp == -1) {
#line 374
    return (-1);
  }
#line 376
  if (offset < 0) {
#line 377
    offset = (int32_t )(object->len + (uint32_t )offset);
  }
#line 379
  if ((uint32_t )offset > object->len) {
#line 380
    return (-1);
  } else
#line 379
  if (offset < 0) {
#line 380
    return (-1);
  }
#line 382
  look = object->str;
#line 383
  look += offset;
#line 384
  return ((int32_t )*look);
}
}
#line 402 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_put_u16(dw_str *obj , uint16_t value___6 , int32_t offset ) 
{ 
  uint8_t *look ;
  int tmp ;
  int expand_by ;

  {
  {
#line 403
  look = (uint8_t *)0;
#line 404
  tmp = dw_assert_sanity(obj);
  }
#line 404
  if (tmp == -1) {
#line 405
    return (-1);
  }
#line 409
  if (offset < 0) {
#line 410
    offset = (int32_t )((obj->len + (uint32_t )offset) + 1U);
  }
#line 414
  if ((uint32_t )offset > obj->len) {
#line 415
    return (-1);
  } else
#line 414
  if (obj->len > 268435455U) {
#line 415
    return (-1);
  } else
#line 416
  if (offset >= (int32_t )(obj->len & 16777215U) - 1) {
#line 418
    expand_by = (int )((obj->len - (uint32_t )offset) + 2U);
#line 419
    if (obj->len + (uint32_t )expand_by >= obj->max) {
#line 420
      return (-1);
    }
#line 422
    obj->len += (uint32_t )expand_by;
#line 423
    if (obj->len > obj->max) {
#line 424
      obj->len -= (uint32_t )expand_by;
#line 425
      return (-1);
    }
  }
#line 429
  look = obj->str + offset;
#line 430
  *look = (uint8_t )(((int )value___6 >> 8) & 255);
#line 431
  *(look + 1) = (uint8_t )((int )value___6 & 255);
#line 432
  return (0);
}
}
#line 452 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_put_u8(dw_str *obj , uint8_t value___6 , int32_t offset ) 
{ 
  uint8_t *look ;
  int tmp ;

  {
  {
#line 453
  look = (uint8_t *)0;
#line 454
  tmp = dw_assert_sanity(obj);
  }
#line 454
  if (tmp == -1) {
#line 455
    return (-1);
  }
#line 459
  if (offset < 0) {
#line 460
    offset = (int32_t )((obj->len + (uint32_t )offset) + 1U);
  }
#line 464
  if ((uint32_t )offset > obj->len) {
#line 465
    return (-1);
  } else
#line 464
  if (obj->len > 268435455U) {
#line 465
    return (-1);
  } else
#line 466
  if (offset == (int32_t )(obj->len & 16777215U)) {
#line 467
    (obj->len) ++;
#line 468
    if (obj->len > obj->max) {
#line 469
      (obj->len) --;
#line 470
      return (-1);
    }
  }
#line 474
  look = obj->str + offset;
#line 475
  *look = (uint8_t )((int )value___6 & 255);
#line 476
  return (0);
}
}
#line 511 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_issame(dw_str *a , dw_str *b ) 
{ 
  int c ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 512
  c = 0;
#line 513
  tmp = dw_assert_sanity(a);
  }
#line 513
  if (tmp == -1) {
#line 514
    return (-1);
  }
  {
#line 516
  tmp___0 = dw_assert_sanity(b);
  }
#line 516
  if (tmp___0 == -1) {
#line 517
    return (-1);
  }
#line 519
  if (a->len != b->len) {
#line 520
    return (0);
  }
#line 522
  c = 0;
  {
#line 522
  while (1) {
    while_continue: /* CIL Label */ ;
#line 522
    if (! ((uint32_t )c < a->len)) {
#line 522
      goto while_break;
    }
#line 523
    if ((int )*(a->str + c) != (int )*(b->str + c)) {
#line 524
      return (0);
    }
#line 522
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 527
  return (1);
}
}
#line 533 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_append(dw_str *toappend , dw_str *target ) 
{ 
  int c ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 534
  c = 0;
#line 535
  tmp = dw_assert_sanity(toappend);
  }
#line 535
  if (tmp == -1) {
#line 536
    return (-1);
  }
  {
#line 538
  tmp___0 = dw_assert_sanity(target);
  }
#line 538
  if (tmp___0 == -1) {
#line 539
    return (-1);
  }
#line 541
  if (target->len + toappend->len >= target->max) {
#line 542
    return (-1);
  }
#line 544
  c = 0;
  {
#line 544
  while (1) {
    while_continue: /* CIL Label */ ;
#line 544
    if (! ((uint32_t )c < toappend->len)) {
#line 544
      goto while_break;
    }
#line 545
    *((target->str + target->len) + c) = *(toappend->str + c);
#line 544
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 547
  target->len += toappend->len;
#line 548
  return (0);
}
}
#line 556 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_substr_append(dw_str *splice , int32_t begin , int32_t amount , dw_str *target ) 
{ 
  dw_str *tmp ;
  int tmp___0 ;

  {
  {
#line 558
  tmp = (dw_str *)0;
#line 560
  tmp = dw_substr(splice, begin, amount, 1);
  }
#line 561
  if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 562
    return (-1);
  }
  {
#line 565
  tmp___0 = dw_append(tmp, target);
  }
#line 565
  if (tmp___0 == -1) {
    {
#line 566
    dw_destroy(tmp);
    }
#line 567
    return (-1);
  }
  {
#line 570
  dw_destroy(tmp);
  }
#line 571
  return (0);
}
}
#line 578 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
uint8_t *dw_to_cstr(dw_str *obj ) 
{ 
  uint8_t *out ;
  int a ;
  int tmp ;
  void *tmp___0 ;

  {
  {
#line 579
  out = (uint8_t *)0;
#line 580
  a = 0;
#line 582
  tmp = dw_assert_sanity(obj);
  }
#line 582
  if (tmp == -1) {
#line 583
    return ((uint8_t *)0);
  }
  {
#line 586
  tmp___0 = malloc((size_t )(obj->len + 3U));
#line 586
  out = (uint8_t *)tmp___0;
#line 587
  a = 0;
  }
  {
#line 587
  while (1) {
    while_continue: /* CIL Label */ ;
#line 587
    if (! ((uint32_t )a < obj->len)) {
#line 587
      goto while_break;
    }
#line 588
    *(out + a) = *(obj->str + a);
#line 587
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 590
  *(out + a) = (uint8_t )0;
#line 592
  return (out);
}
}
#line 601 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_rfind(dw_str *obj , unsigned char rx ) 
{ 
  int index___0 ;
  int tmp ;

  {
  {
#line 602
  index___0 = 0;
#line 604
  tmp = dw_assert_sanity(obj);
  }
#line 604
  if (tmp == -1) {
#line 605
    return (-1);
  }
#line 608
  index___0 = (int )obj->len;
#line 611
  if (index___0 == 0) {
#line 612
    return (-2);
  }
#line 616
  index___0 --;
  {
#line 618
  while (1) {
    while_continue: /* CIL Label */ ;
#line 618
    if (index___0 >= 0) {
#line 618
      if (! ((int )*(obj->str + index___0) != (int )rx)) {
#line 618
        goto while_break;
      }
    } else {
#line 618
      goto while_break;
    }
#line 619
    index___0 --;
  }
  while_break: /* CIL Label */ ;
  }
#line 622
  if (index___0 == -1) {
#line 623
    return (-2);
  }
#line 626
  return (index___0);
}
}
#line 639 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_qspop(dw_str *in ) 
{ 
  int index___0 ;
  int len ;
  dw_str *out ;
  int tmp ;

  {
  {
#line 640
  index___0 = 0;
#line 641
  len = 0;
#line 642
  out = (dw_str *)0;
#line 644
  tmp = dw_assert_sanity(in);
  }
#line 644
  if (tmp == -1) {
#line 645
    goto catch_dw_qspop;
  }
  {
#line 648
  index___0 = dw_rfind(in, (unsigned char )',');
  }
#line 650
  if (index___0 == -2) {
    {
#line 651
    out = dw_substr(in, 0, -1, -1);
#line 652
    in->len = (uint32_t )0;
    }
#line 653
    return (out);
  } else
#line 654
  if (index___0 < 0) {
#line 655
    goto catch_dw_qspop;
  }
#line 658
  len = (int )in->len;
#line 659
  index___0 ++;
#line 660
  len -= index___0;
#line 661
  if (len < 0) {
#line 662
    goto catch_dw_qspop;
  }
  {
#line 664
  out = dw_substr(in, index___0, len, 1);
#line 665
  in->len -= (uint32_t )(len + 1);
  }
#line 666
  if (in->len >= in->max) {
#line 667
    in->len = (uint32_t )0;
#line 668
    goto catch_dw_qspop;
  }
#line 671
  return (out);
  catch_dw_qspop: 
#line 674
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 675
    dw_destroy(out);
#line 676
    out = (dw_str *)0;
    }
  }
#line 678
  return ((dw_str *)0);
}
}
#line 688 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_zap_lws(dw_str *obj ) 
{ 
  int index___0 ;
  dw_str *out ;
  int tmp ;

  {
  {
#line 689
  index___0 = 0;
#line 690
  out = (dw_str *)0;
#line 692
  tmp = dw_assert_sanity(obj);
  }
#line 692
  if (tmp == -1) {
#line 693
    goto catch_dw_zap_lws;
  }
  {
#line 696
  while (1) {
    while_continue: /* CIL Label */ ;
#line 696
    if ((uint32_t )index___0 < obj->len) {
#line 696
      if (! ((int )*(obj->str + index___0) == 32)) {
#line 696
        if (! ((int )*(obj->str + index___0) == 9)) {
#line 696
          goto while_break;
        }
      }
    } else {
#line 696
      goto while_break;
    }
#line 698
    index___0 ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 701
  if ((uint32_t )index___0 >= obj->len) {
    {
#line 702
    out = dw_create((uint32_t )1);
    }
#line 703
    return (out);
  }
  {
#line 706
  out = dw_substr(obj, index___0, -1, 1);
  }
#line 707
  return (out);
  catch_dw_zap_lws: 
#line 710
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 711
    dw_destroy(out);
#line 712
    out = (dw_str *)0;
    }
  }
#line 714
  return ((dw_str *)0);
}
}
#line 730 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_atoi(dw_str *obj , int32_t index___0 , int base ) 
{ 
  int32_t out ;
  int num ;
  int counter ;
  uint8_t look ;
  int tmp ;

  {
  {
#line 731
  out = 0;
#line 732
  num = 0;
#line 732
  counter = 0;
#line 733
  look = (uint8_t )0;
#line 734
  tmp = dw_assert_sanity(obj);
  }
#line 734
  if (tmp == -1) {
#line 735
    return (-1);
  }
#line 737
  if (base < 2) {
#line 738
    return (-1);
  } else
#line 737
  if (base > 36) {
#line 738
    return (-1);
  }
#line 740
  if (index___0 < 0) {
#line 741
    return (-1);
  } else
#line 740
  if ((uint32_t )index___0 >= obj->len) {
#line 741
    return (-1);
  }
#line 743
  look = *(obj->str + index___0);
  {
#line 744
  while (1) {
    while_continue: /* CIL Label */ ;
#line 744
    if ((uint32_t )index___0 < obj->len) {
#line 744
      if (! ((int )look == 32)) {
#line 744
        if (! ((int )look == 9)) {
#line 744
          goto while_break;
        }
      }
    } else {
#line 744
      goto while_break;
    }
#line 745
    index___0 ++;
#line 746
    look = *(obj->str + index___0);
  }
  while_break: /* CIL Label */ ;
  }
#line 748
  counter = 0;
  {
#line 748
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 748
    if (! (counter < 100)) {
#line 748
      goto while_break___0;
    }
#line 749
    if ((uint32_t )index___0 >= obj->len) {
#line 750
      return (out);
    }
#line 752
    look = *(obj->str + index___0);
#line 753
    if ((int )look >= 48) {
#line 753
      if ((int )look <= 57) {
#line 754
        num = (int )look - 48;
      } else {
#line 753
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 755
    if ((int )look >= 97) {
#line 755
      if ((int )look <= 122) {
#line 756
        num = ((int )look - 97) + 10;
      } else {
#line 755
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 757
    if ((int )look >= 65) {
#line 757
      if ((int )look <= 90) {
#line 758
        num = ((int )look - 65) + 10;
      } else {
#line 760
        return (out);
      }
    } else {
#line 760
      return (out);
    }
#line 762
    if (num >= base) {
#line 763
      return (-1);
    }
#line 765
    out *= base;
#line 766
    out += num;
#line 767
    index___0 ++;
#line 748
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 769
  return (-1);
}
}
#line 780 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_get_dname(uint8_t *raw , int offset , int max ) 
{ 
  int len ;
  int counter ;
  int soffset ;
  dw_str *out ;

  {
#line 781
  len = 0;
#line 781
  counter = 0;
#line 782
  soffset = 0;
#line 783
  out = (dw_str *)0;
#line 785
  if (max > 260) {
    {
#line 786
    out = dw_create((uint32_t )max);
    }
  } else {
    {
#line 788
    out = dw_create((uint32_t )260);
    }
  }
#line 791
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 792
    goto catch_dw_get_dname;
  } else
#line 791
  if ((unsigned long )raw == (unsigned long )((uint8_t *)0)) {
#line 792
    goto catch_dw_get_dname;
  }
#line 795
  counter = 0;
  {
#line 795
  while (1) {
    while_continue: /* CIL Label */ ;
#line 795
    if (! (counter < 400)) {
#line 795
      goto while_break;
    }
#line 796
    if (offset >= max - 2) {
#line 797
      goto catch_dw_get_dname;
    } else
#line 796
    if (soffset > 255) {
#line 797
      goto catch_dw_get_dname;
    }
#line 800
    len = (int )*(raw + offset);
#line 801
    if (len > 63) {
#line 802
      goto catch_dw_get_dname;
    } else
#line 801
    if (len < 0) {
#line 802
      goto catch_dw_get_dname;
    }
#line 805
    *(out->str + soffset) = (uint8_t )len;
#line 806
    if (len == 0) {
#line 807
      goto while_break;
    }
    {
#line 809
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 809
      if (! (len > 0)) {
#line 809
        goto while_break___0;
      }
#line 810
      soffset ++;
#line 811
      offset ++;
#line 812
      len --;
#line 813
      if (offset >= max - 2) {
#line 814
        goto catch_dw_get_dname;
      } else
#line 813
      if (soffset > 255) {
#line 814
        goto catch_dw_get_dname;
      }
#line 816
      *(out->str + soffset) = *(raw + offset);
#line 818
      if ((int )*(out->str + soffset) < 32) {
#line 819
        goto catch_dw_get_dname;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
#line 822
    soffset ++;
#line 823
    offset ++;
#line 795
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 825
  out->len = (uint32_t )(soffset + 1);
#line 826
  return (out);
  catch_dw_get_dname: 
#line 829
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 830
    dw_destroy(out);
    }
  }
#line 832
  return ((dw_str *)0);
}
}
#line 842 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_get_dname_type(uint8_t *raw , int offset , int max ) 
{ 
  dw_str *out ;

  {
  {
#line 843
  out = (dw_str *)0;
#line 845
  out = dw_get_dname(raw, offset, max);
  }
#line 846
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 847
    goto catch_dw_get_dname_class;
  }
#line 849
  offset = (int )((uint32_t )offset + out->len);
#line 857
  if ((int )*(raw + offset) == 255) {
#line 857
    if (((int )*((raw + offset) + 1) & 240) == 112) {
#line 858
      goto catch_dw_get_dname_class;
    }
  }
#line 860
  *(out->str + out->len) = *(raw + offset);
#line 861
  *((out->str + out->len) + 1) = *((raw + offset) + 1);
#line 862
  out->len += 2U;
#line 863
  return (out);
  catch_dw_get_dname_class: 
#line 866
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 867
    dw_destroy(out);
#line 868
    out = (dw_str *)0;
    }
  }
#line 870
  return ((dw_str *)0);
}
}
#line 875 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_get_dn_end(dw_str *in , int offset ) 
{ 
  int len ;
  int counter ;
  int tmp ;

  {
  {
#line 876
  len = 0;
#line 876
  counter = 0;
#line 878
  tmp = dw_assert_sanity(in);
  }
#line 878
  if (tmp == -1) {
#line 879
    return (-1);
  }
#line 882
  counter = 0;
  {
#line 882
  while (1) {
    while_continue: /* CIL Label */ ;
#line 882
    if (! (counter < 200)) {
#line 882
      goto while_break;
    }
#line 883
    if ((uint32_t )(offset + 1) > in->len) {
#line 884
      return (-1);
    }
#line 887
    len = (int )*(in->str + offset);
#line 888
    if (len >= 192) {
#line 889
      offset ++;
#line 890
      goto while_break;
    } else
#line 891
    if (len > 63) {
#line 892
      return (-1);
    } else
#line 891
    if (len < 0) {
#line 892
      return (-1);
    } else
#line 893
    if (len == 0) {
#line 894
      goto while_break;
    }
#line 896
    offset += len + 1;
#line 882
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 899
  return (offset + 1);
}
}
#line 913 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_get_a_dnsttl(dw_str *in , int offset , int32_t max , int depth ) 
{ 
  int32_t out ;
  int32_t type ;
  uint8_t *raw ;
  int tmp ;
  int32_t tmp___0 ;

  {
  {
#line 914
  out = 0;
#line 914
  type = 0;
#line 915
  raw = (uint8_t *)0;
#line 917
  tmp = dw_assert_sanity(in);
  }
#line 917
  if (tmp == -1) {
#line 918
    return (-1);
  }
#line 921
  if (depth <= 0) {
#line 922
    return (max);
  }
#line 925
  if (max > 31536000) {
#line 926
    max = 31536000;
  }
  {
#line 929
  offset = dw_get_dn_end(in, offset);
  }
#line 931
  if (offset < 0) {
#line 932
    return (-1);
  } else
#line 931
  if ((uint32_t )(offset + 8) > in->len) {
#line 932
    return (-1);
  }
#line 935
  raw = in->str + offset;
#line 938
  type = ((int32_t )*(raw + 0) << 8) | (int32_t )*(raw + 1);
#line 940
  if ((int )*(raw + 4) > 127) {
#line 941
    return (31536000);
  }
#line 943
  out = ((((int32_t )*(raw + 4) << 24) | ((int32_t )*(raw + 5) << 16)) | ((int32_t )*(raw + 6) << 8)) | (int32_t )*(raw + 7);
#line 947
  if (out < 60) {
#line 948
    out = 60;
  } else
#line 949
  if (out > max) {
#line 950
    out = max;
  }
#line 953
  if (type == 5) {
    {
#line 954
    offset = dw_get_dn_end(in, offset + 10);
    }
#line 955
    if (offset < 0) {
#line 956
      return (-1);
    } else
#line 955
    if ((uint32_t )offset > in->len) {
#line 956
      return (-1);
    }
    {
#line 958
    tmp___0 = dw_get_a_dnsttl(in, offset, out, depth - 1);
    }
#line 958
    return (tmp___0);
  }
#line 961
  return (out);
}
}
#line 998 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int32_t dw_cachepacket_to_ancount(dw_str *packet ) 
{ 
  int32_t offset ;
  int tmp ;
  int32_t tmp___0 ;

  {
  {
#line 999
  offset = 0;
#line 1001
  tmp = dw_assert_sanity(packet);
  }
#line 1001
  if (tmp == -1) {
#line 1002
    return (-1);
  } else
#line 1001
  if (packet->len < 7U) {
#line 1002
    return (-1);
  }
  {
#line 1009
  offset = (int32_t )(packet->len - 7U);
#line 1011
  tmp___0 = dw_fetch_u16(packet, offset);
  }
#line 1011
  return (tmp___0);
}
}
#line 1023 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_packet_to_cache(uint8_t *raw , int len , uint8_t type ) 
{ 
  int32_t ancount ;
  int32_t nscount ;
  int32_t arcount ;
  dw_str *hack ;
  dw_str *out ;
  int offset ;
  void *tmp ;

  {
  {
#line 1024
  ancount = 0;
#line 1024
  nscount = 0;
#line 1024
  arcount = 0;
#line 1025
  hack = (dw_str *)0;
#line 1025
  out = (dw_str *)0;
#line 1026
  offset = 0;
#line 1030
  tmp = malloc(sizeof(dw_str ));
#line 1030
  hack = (dw_str *)tmp;
#line 1031
  hack->max = (uint32_t )(len + 1);
#line 1032
  hack->len = (uint32_t )len;
#line 1033
  hack->str = raw;
#line 1034
  hack->sane = (uint8_t )114;
#line 1036
  ancount = dw_fetch_u16(hack, 6);
#line 1037
  nscount = dw_fetch_u16(hack, 8);
#line 1038
  arcount = dw_fetch_u16(hack, 10);
  }
#line 1040
  if (ancount < 0) {
#line 1041
    goto catch_dw_packet_to_cache;
  } else
#line 1040
  if (nscount < 0) {
#line 1041
    goto catch_dw_packet_to_cache;
  } else
#line 1040
  if (arcount < 0) {
#line 1041
    goto catch_dw_packet_to_cache;
  }
  {
#line 1045
  offset = dw_get_dn_end(hack, 12);
  }
#line 1046
  if (offset < 0) {
#line 1047
    goto catch_dw_packet_to_cache;
  }
  {
#line 1049
  offset += 4;
#line 1050
  out = dw_substr(hack, offset, -1, 7);
#line 1051
  dw_put_u16(out, (uint16_t )ancount, -1);
#line 1052
  dw_put_u16(out, (uint16_t )nscount, -1);
#line 1053
  dw_put_u16(out, (uint16_t )arcount, -1);
#line 1054
  dw_addchar(type, out);
#line 1055
  free((void *)hack);
  }
#line 1056
  return (out);
  catch_dw_packet_to_cache: 
#line 1059
  if ((unsigned long )hack != (unsigned long )((dw_str *)0)) {
    {
#line 1060
    free((void *)hack);
#line 1061
    hack = (dw_str *)0;
    }
  }
#line 1063
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1064
    dw_destroy(out);
#line 1065
    out = (dw_str *)0;
    }
  }
#line 1067
  return ((dw_str *)0);
}
}
#line 1073 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_filename_sanitize(dw_str *obj ) 
{ 
  int index___0 ;
  int look ;
  int tmp ;

  {
  {
#line 1074
  index___0 = 0;
#line 1075
  look = 0;
#line 1077
  tmp = dw_assert_sanity(obj);
  }
#line 1077
  if (tmp == -1) {
#line 1078
    return (-1);
  }
#line 1081
  index___0 = 0;
  {
#line 1081
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1081
    if (! ((uint32_t )index___0 < obj->len)) {
#line 1081
      goto while_break;
    }
#line 1082
    look = (int )*(obj->str + index___0);
#line 1083
    if (look < 97) {
#line 1083
      goto _L;
    } else
#line 1083
    if (look > 122) {
      _L: /* CIL Label */ 
#line 1083
      if (look != 47) {
#line 1083
        if (look != 45) {
#line 1083
          if (look != 95) {
#line 1085
            *(obj->str + index___0) = (uint8_t )'_';
          }
        }
      }
    }
#line 1081
    index___0 ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1089
  return (1);
}
}
#line 1095 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_ends_in_dot(dw_str *in ) 
{ 
  int tmp ;

  {
  {
#line 1096
  tmp = dw_assert_sanity(in);
  }
#line 1096
  if (tmp == -1) {
#line 1097
    return (0);
  }
#line 1100
  if (in->len < 1U) {
#line 1101
    return (-1);
  }
#line 1104
  if ((int )*((in->str + in->len) - 1) != 46) {
#line 1105
    return (-1);
  }
#line 1108
  return (1);
}
}
#line 1122 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_dnsname_delim_convert(dw_str *in , dw_str *out , int a , int place , int *count ,
                             uint8_t delim ) 
{ 


  {
#line 1125
  if ((int )*(in->str + a) == (int )delim) {
#line 1126
    if (*count <= 0) {
#line 1127
      return (-1);
    }
#line 1129
    if ((uint32_t )place < out->max) {
#line 1130
      *(out->str + place) = (uint8_t )*count;
    }
#line 1132
    place = a + 1;
#line 1133
    *count = -1;
  }
#line 1135
  (*count) ++;
#line 1136
  if ((uint32_t )(a + 1) < out->max) {
#line 1137
    *((out->str + a) + 1) = *(in->str + a);
  }
#line 1139
  if (*count > 63) {
#line 1140
    return (-1);
  }
#line 1143
  return (place);
}
}
#line 1150 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_dnsname_convert(dw_str *in ) 
{ 
  dw_str *out ;
  int c ;
  int place ;
  int a ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 1151
  out = (dw_str *)0;
#line 1152
  c = 0;
#line 1152
  place = 0;
#line 1152
  a = 0;
#line 1154
  tmp = dw_assert_sanity(in);
  }
#line 1154
  if (tmp == -1) {
#line 1155
    return ((dw_str *)0);
  }
  {
#line 1158
  tmp___0 = dw_ends_in_dot(in);
  }
#line 1158
  if (tmp___0 != 1) {
#line 1159
    return ((dw_str *)0);
  }
  {
#line 1162
  out = dw_create(in->len + 4U);
  }
#line 1163
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1164
    return ((dw_str *)0);
  }
#line 1166
  out->len = in->len + 1U;
#line 1168
  if ((int )*(in->str) == 46) {
#line 1169
    if (in->len != 1U) {
#line 1170
      goto catch_dw_dnsname_convert;
    }
#line 1172
    if (out->max > 1U) {
#line 1173
      *(out->str) = (uint8_t )0;
    }
#line 1175
    out->len = (uint32_t )1;
#line 1176
    return (out);
  }
#line 1179
  a = 0;
  {
#line 1179
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1179
    if (! ((uint32_t )a < in->len)) {
#line 1179
      goto while_break;
    }
    {
#line 1180
    place = dw_dnsname_delim_convert(in, out, a, place, & c, (uint8_t )'.');
    }
#line 1181
    if (place == -1) {
#line 1182
      goto catch_dw_dnsname_convert;
    }
#line 1179
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1186
  if (out->len - 1U < out->max) {
#line 1187
    *((out->str + out->len) - 1) = (uint8_t )0;
  }
#line 1189
  return (out);
  catch_dw_dnsname_convert: 
#line 1192
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1193
    dw_destroy(out);
    }
  }
#line 1195
  return ((dw_str *)0);
}
}
#line 1205 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
dw_str *dw_dnslabel_chop(dw_str *in ) 
{ 
  dw_str *out ;
  int offset ;
  int a ;
  int b ;
  int tmp ;

  {
  {
#line 1206
  out = (dw_str *)0;
#line 1207
  offset = 0;
#line 1207
  a = 0;
#line 1207
  b = 0;
#line 1209
  tmp = dw_assert_sanity(in);
  }
#line 1209
  if (tmp == -1) {
#line 1210
    return ((dw_str *)0);
  }
#line 1213
  if (in->len < 2U) {
#line 1214
    return ((dw_str *)0);
  }
#line 1216
  offset = (int )*(in->str);
#line 1217
  if (offset < 1) {
#line 1218
    return ((dw_str *)0);
  } else
#line 1217
  if (offset > 63) {
#line 1218
    return ((dw_str *)0);
  }
#line 1220
  if (in->len < (uint32_t )offset) {
#line 1221
    return ((dw_str *)0);
  }
  {
#line 1224
  out = dw_create((in->len - (uint32_t )offset) + 1U);
  }
#line 1225
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1226
    return ((dw_str *)0);
  }
#line 1229
  a = offset + 1;
#line 1230
  b = 0;
  {
#line 1231
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1231
    if ((uint32_t )a < in->len) {
#line 1231
      if (! ((uint32_t )b < out->max)) {
#line 1231
        goto while_break;
      }
    } else {
#line 1231
      goto while_break;
    }
#line 1232
    *(out->str + b) = *(in->str + a);
#line 1233
    a ++;
#line 1234
    b ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1237
  out->len = (uint32_t )b;
#line 1238
  return (out);
}
}
#line 1252 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwStr.c"
int dw_rotate(dw_str *in , int32_t start , int32_t pivot , int32_t end ) 
{ 
  dw_str *part1 ;
  dw_str *part2 ;
  dw_str *part3 ;

  {
#line 1253
  part1 = (dw_str *)0;
#line 1253
  part2 = (dw_str *)0;
#line 1253
  part3 = (dw_str *)0;
#line 1255
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 1256
    return (-1);
  } else
#line 1255
  if (start >= pivot) {
#line 1256
    return (-1);
  } else
#line 1255
  if (pivot >= end) {
#line 1256
    return (-1);
  } else
#line 1255
  if ((uint32_t )end >= in->len) {
#line 1256
    return (-1);
  }
  {
#line 1259
  part1 = dw_substr(in, start, pivot - start, 1);
  }
#line 1260
  if ((unsigned long )part1 == (unsigned long )((dw_str *)0)) {
#line 1261
    return (-1);
  }
  {
#line 1263
  part2 = dw_substr(in, pivot, end - pivot, 1);
  }
#line 1264
  if ((unsigned long )part2 == (unsigned long )((dw_str *)0)) {
    {
#line 1265
    dw_destroy(part1);
    }
#line 1266
    return (-1);
  }
  {
#line 1268
  part3 = dw_substr(in, end, -1, 1);
  }
#line 1269
  if ((unsigned long )part3 == (unsigned long )((dw_str *)0)) {
    {
#line 1270
    dw_destroy(part1);
#line 1271
    dw_destroy(part2);
    }
#line 1272
    return (-1);
  }
  {
#line 1274
  in->len = (uint32_t )start;
#line 1275
  dw_append(part2, in);
#line 1276
  dw_append(part1, in);
#line 1277
  dw_append(part3, in);
#line 1278
  dw_destroy(part1);
#line 1279
  dw_destroy(part2);
#line 1280
  dw_destroy(part3);
  }
#line 1281
  return (1);
}
}
#line 543 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 113 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) socket)(int __domain ,
                                                                             int __type ,
                                                                             int __protocol ) ;
#line 137
extern int connect(int __fd , struct sockaddr  const  *__addr , socklen_t __len ) ;
#line 149
extern ssize_t send(int __fd , void const   *__buf , size_t __n , int __flags ) ;
#line 156
extern ssize_t recv(int __fd , void *__buf , size_t __n , int __flags ) ;
#line 243
extern int accept(int __fd , struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 379 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint16_t ( __attribute__((__leaf__)) htons)(uint16_t __hostshort )  __attribute__((__const__)) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 137 "/usr/include/fcntl.h"
extern int fcntl(int __fd , int __cmd  , ...) ;
#line 82 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.h"
void dw_alog_3strings(char *s1 , char *s2 , char *s3 ) ;
#line 129
int32_t get_dns_qid(unsigned char *a , int len , int roy_arends_check ) ;
#line 253 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
uint16_t get_from_ip_port(ip_addr_T *from_ip , sockaddr_all_T *client ) ;
#line 258
int check_ip_acl(ip_addr_T *ip ) ;
#line 270
int do_bind(ip_addr_T *ip , int type ) ;
#line 273
ip_addr_T get_upstream_ip(dw_str *query , int b ) ;
#line 310
dw_str *make_dns_header(int32_t id , int16_t flags , int32_t ancount , int32_t nscount ,
                        int32_t arcount ) ;
#line 22 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.h"
void malloc_tcp_pend(void) ;
#line 25
void init_tcp_b_pend(void) ;
#line 29
int bind_all_tcp(void) ;
#line 35
void local_tcp_accept(int s ) ;
#line 41
void kill_tcp_expired(void) ;
#line 45
void tcp_get_wanted(int b ) ;
#line 49
void tcp_process_data(int b ) ;
#line 53
void tcp_send_wanted(int b ) ;
#line 57
void tcp_return_reply(int b , char *packet , int len ) ;
#line 61
void tcp_to_udp(int b ) ;
#line 67
int get_reply_from_cache(dw_str *query , sockaddr_all_T *client , int sock , int32_t id ,
                         int resurrect , int tcp_num , dw_str *orig_query , ip_addr_T *from_ip ) ;
#line 82
int forward_local_udp_packet(int sock , int32_t local_id , ip_addr_T *from_ip , uint16_t from_port ,
                             unsigned char *a , int len , int tcp_num , dw_str *orig_query ) ;
#line 87
void tcp_handle_all(int b ) ;
#line 92
void tcp_truncated_retry(int b , dw_str *query , int id , int udp_id , int is_up ) ;
#line 72 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.h"
int dwc_lower_case(dw_str *query ) ;
#line 50 "/usr/include/x86_64-linux-gnu/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 32 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
int32_t key_n[31] ;
#line 35
int64_t the_time ;
#line 39
ip_addr_T bind_address[129] ;
#line 43
int max_tcp_procs ;
#line 44
int timeout_seconds ;
#line 45
int timeout_seconds_tcp ;
#line 47
int upstream_port ;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
tcp_pend_T *tcp_pend  ;
#line 51 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
int tcp_b_local[129]  ;
#line 65 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void malloc_tcp_pend(void) 
{ 
  void *tmp ;

  {
  {
#line 66
  tmp = malloc((unsigned long )(max_tcp_procs + 1) * sizeof(tcp_pend_T ));
#line 66
  tcp_pend = (tcp_pend_T *)tmp;
  }
#line 67
  if ((unsigned long )tcp_pend == (unsigned long )((tcp_pend_T *)0)) {
    {
#line 68
    dw_alog_3strings((char *)"Fatal: Could not allocate tcp_pend", (char *)"", (char *)"");
#line 69
    exit(1);
    }
  }
#line 71
  return;
}
}
#line 74 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void init_tcp_b_pend(void) 
{ 
  int a ;

  {
#line 75
  a = 0;
#line 76
  a = 0;
  {
#line 76
  while (1) {
    while_continue: /* CIL Label */ ;
#line 76
    if (! (a < max_tcp_procs)) {
#line 76
      goto while_break;
    }
#line 77
    (tcp_pend + a)->local = -1;
#line 77
    (tcp_pend + a)->upstream = -1;
#line 77
    (tcp_pend + a)->buffer = (char *)0;
#line 77
    (tcp_pend + a)->wanted = 0;
#line 77
    (tcp_pend + a)->got = 0;
#line 77
    (tcp_pend + a)->sent = 0;
#line 77
    (tcp_pend + a)->state = 0;
#line 77
    (tcp_pend + a)->die = (int64_t )0;
#line 76
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 79
  return;
}
}
#line 83 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
int bind_all_tcp(void) 
{ 
  int a ;
  int count ;

  {
#line 84
  a = 0;
#line 85
  count = 0;
#line 86
  if (key_n[17] != 1) {
#line 87
    return (0);
  }
#line 89
  a = 0;
  {
#line 89
  while (1) {
    while_continue: /* CIL Label */ ;
#line 89
    if (! (a < 128)) {
#line 89
      goto while_break;
    }
#line 90
    if ((int )bind_address[a].len != 0) {
      {
#line 91
      tcp_b_local[a] = do_bind(& bind_address[a], 1);
      }
#line 92
      if (tcp_b_local[a] != -1) {
#line 93
        count ++;
      } else {
#line 95
        return (-1);
      }
    } else {
#line 98
      tcp_b_local[a] = -1;
    }
#line 89
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 101
  return (count);
}
}
#line 106 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
int32_t find_free_tcp_pend(void) 
{ 
  int32_t a ;

  {
#line 107
  a = 0;
#line 108
  a = 0;
  {
#line 108
  while (1) {
    while_continue: /* CIL Label */ ;
#line 108
    if (! (a < max_tcp_procs)) {
#line 108
      goto while_break;
    }
#line 109
    if ((tcp_pend + a)->local == -1) {
#line 110
      return (a);
    }
#line 108
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 113
  return (-1);
}
}
#line 117 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
int setup_tcp_server(sockaddr_all_T *server , dw_str *query , int b ) 
{ 
  int remote ;
  ip_addr_T rem_ip ;
  unsigned int tmp ;

  {
#line 118
  remote = -1;
#line 119
  rem_ip.len = (uint8_t )0;
#line 119
  rem_ip.ip[0] = (uint8_t )0;
#line 119
  rem_ip.ip[1] = (uint8_t )0;
#line 119
  tmp = 2U;
  {
#line 119
  while (1) {
    while_continue: /* CIL Label */ ;
#line 119
    if (tmp >= 17U) {
#line 119
      goto while_break;
    }
#line 119
    rem_ip.ip[tmp] = (unsigned char)0;
#line 119
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 119
  rem_ip.glueless = (dw_str *)0;
#line 119
  rem_ip.flags = (uint8_t )0;
#line 121
  rem_ip = get_upstream_ip(query, b);
  }
#line 122
  if ((unsigned long )rem_ip.glueless != (unsigned long )((dw_str *)0)) {
    {
#line 123
    dw_destroy(rem_ip.glueless);
    }
  }
#line 125
  if ((int )rem_ip.len == 4) {
    {
#line 126
    server->u.v4.sin_family = (sa_family_t )2;
#line 127
    server->u.v4.sin_port = htons((uint16_t )upstream_port);
#line 128
    memcpy((void */* __restrict  */)(& server->u.v4.sin_addr), (void const   */* __restrict  */)(rem_ip.ip),
           (size_t )4);
#line 129
    remote = socket(2, 1, 0);
    }
  } else
#line 131
  if ((int )rem_ip.len == 16) {
    {
#line 132
    server->u.v6.sin6_family = (sa_family_t )10;
#line 133
    server->u.v6.sin6_port = htons((uint16_t )upstream_port);
#line 134
    memcpy((void */* __restrict  */)(& server->u.v6.sin6_addr), (void const   */* __restrict  */)(rem_ip.ip),
           (size_t )16);
#line 135
    remote = socket(10, 1, 0);
    }
  } else {
#line 138
    return (-1);
  }
#line 140
  return (remote);
}
}
#line 147 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void local_tcp_accept(int s ) 
{ 
  sockaddr_all_T client ;
  int local ;
  socklen_t len ;
  int b ;
  ip_addr_T from_ip ;
  int tmp ;
  void *tmp___0 ;

  {
  {
#line 149
  local = 0;
#line 150
  len = (socklen_t )sizeof(struct sockaddr_in );
#line 151
  b = 0;
#line 154
  b = find_free_tcp_pend();
  }
#line 155
  if (b == -1) {
#line 156
    return;
  }
  {
#line 159
  len = (socklen_t )sizeof(client);
#line 160
  local = accept(s, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& client)),
                 (socklen_t */* __restrict  */)(& len));
#line 161
  fcntl(local, 4, 2048);
  }
#line 163
  if (local == -1) {
#line 164
    return;
  }
  {
#line 168
  get_from_ip_port(& from_ip, & client);
#line 169
  tmp = check_ip_acl(& from_ip);
  }
#line 169
  if (tmp != 1) {
    {
#line 170
    close(local);
    }
#line 171
    return;
  }
  {
#line 179
  (tcp_pend + b)->local = -1;
#line 179
  (tcp_pend + b)->upstream = -1;
#line 179
  (tcp_pend + b)->buffer = (char *)0;
#line 179
  (tcp_pend + b)->wanted = 0;
#line 179
  (tcp_pend + b)->got = 0;
#line 179
  (tcp_pend + b)->sent = 0;
#line 179
  (tcp_pend + b)->state = 0;
#line 179
  (tcp_pend + b)->die = (int64_t )0;
#line 180
  tmp___0 = malloc((size_t )3);
#line 180
  (tcp_pend + b)->buffer = (char *)tmp___0;
  }
#line 181
  if ((unsigned long )(tcp_pend + b)->buffer == (unsigned long )((char *)0)) {
    {
#line 182
    close(local);
#line 183
    (tcp_pend + b)->local = -1;
#line 183
    (tcp_pend + b)->upstream = -1;
    }
#line 183
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 183
      free((void *)(tcp_pend + b)->buffer);
#line 183
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 183
    (tcp_pend + b)->wanted = 0;
#line 183
    (tcp_pend + b)->got = 0;
#line 183
    (tcp_pend + b)->sent = 0;
#line 183
    (tcp_pend + b)->state = 0;
#line 183
    (tcp_pend + b)->die = (int64_t )0;
#line 184
    return;
  }
#line 186
  (tcp_pend + b)->local = local;
#line 187
  (tcp_pend + b)->wanted = 2;
#line 189
  (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
#line 190
  return;
}
}
#line 194 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_get_wanted(int b ) 
{ 
  char *buffer ;
  ssize_t len ;
  int toget ;
  void *tmp ;

  {
#line 195
  buffer = (char *)0;
#line 196
  len = (ssize_t )0;
#line 197
  toget = 0;
#line 198
  toget = (tcp_pend + b)->wanted - (tcp_pend + b)->got;
#line 199
  if (toget > 0) {
#line 199
    if ((tcp_pend + b)->state == 0) {
      {
#line 200
      tmp = malloc((size_t )(toget + 1));
#line 200
      buffer = (char *)tmp;
      }
#line 201
      if ((unsigned long )buffer == (unsigned long )((char *)0)) {
#line 202
        return;
      }
      {
#line 204
      len = recv((tcp_pend + b)->local, (void *)buffer, (size_t )toget, 64);
      }
#line 207
      if (len > (ssize_t )toget) {
        {
#line 208
        free((void *)buffer);
        }
#line 209
        return;
      } else
#line 207
      if (len < 0L) {
        {
#line 208
        free((void *)buffer);
        }
#line 209
        return;
      }
      {
#line 211
      memcpy((void */* __restrict  */)((tcp_pend + b)->buffer + (tcp_pend + b)->got),
             (void const   */* __restrict  */)buffer, (size_t )len);
#line 212
      (tcp_pend + b)->got = (int32_t )((ssize_t )(tcp_pend + b)->got + len);
#line 213
      (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
#line 215
      free((void *)buffer);
      }
    }
  }
#line 217
  return;
}
}
#line 221 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_process_data(int b ) 
{ 
  int32_t wanted ;
  void *tmp ;

  {
#line 222
  wanted = 0;
#line 223
  if ((tcp_pend + b)->wanted != (tcp_pend + b)->got) {
#line 225
    return;
  } else
#line 223
  if ((unsigned long )(tcp_pend + b)->buffer == (unsigned long )((char *)0)) {
#line 225
    return;
  } else
#line 223
  if ((tcp_pend + b)->state != 0) {
#line 225
    return;
  }
#line 227
  if ((tcp_pend + b)->wanted == 2) {
    {
#line 231
    (tcp_pend + b)->got = 0;
#line 232
    wanted = (int32_t )*((tcp_pend + b)->buffer + 0);
#line 233
    wanted <<= 8;
#line 234
    wanted |= (int )*((tcp_pend + b)->buffer + 1);
#line 235
    free((void *)(tcp_pend + b)->buffer);
#line 236
    (tcp_pend + b)->buffer = (char *)0;
    }
#line 237
    if (wanted < 12) {
      {
#line 238
      close((tcp_pend + b)->local);
#line 239
      (tcp_pend + b)->local = -1;
#line 239
      (tcp_pend + b)->upstream = -1;
      }
#line 239
      if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
        {
#line 239
        free((void *)(tcp_pend + b)->buffer);
#line 239
        (tcp_pend + b)->buffer = (char *)0;
        }
      }
#line 239
      (tcp_pend + b)->wanted = 0;
#line 239
      (tcp_pend + b)->got = 0;
#line 239
      (tcp_pend + b)->sent = 0;
#line 239
      (tcp_pend + b)->state = 0;
#line 239
      (tcp_pend + b)->die = (int64_t )0;
#line 240
      return;
    }
    {
#line 242
    (tcp_pend + b)->wanted = wanted;
#line 243
    tmp = malloc((size_t )(wanted + 1));
#line 243
    (tcp_pend + b)->buffer = (char *)tmp;
#line 244
    (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
    }
  } else
#line 246
  if ((tcp_pend + b)->wanted >= 12) {
    {
#line 247
    tcp_to_udp(b);
    }
  }
#line 250
  return;
}
}
#line 254 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_to_udp(int b ) 
{ 
  int32_t local_id ;
  dw_str *query ;
  dw_str *orig_query ;
  int tmp ;

  {
  {
#line 255
  local_id = -1;
#line 256
  query = (dw_str *)0;
#line 256
  orig_query = (dw_str *)0;
#line 258
  local_id = get_dns_qid((unsigned char *)((void *)(tcp_pend + b)->buffer), (tcp_pend + b)->wanted,
                         2);
  }
#line 260
  if (local_id == -1) {
    {
#line 261
    close((tcp_pend + b)->local);
#line 262
    (tcp_pend + b)->local = -1;
#line 262
    (tcp_pend + b)->upstream = -1;
    }
#line 262
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 262
      free((void *)(tcp_pend + b)->buffer);
#line 262
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 262
    (tcp_pend + b)->wanted = 0;
#line 262
    (tcp_pend + b)->got = 0;
#line 262
    (tcp_pend + b)->sent = 0;
#line 262
    (tcp_pend + b)->state = 0;
#line 262
    (tcp_pend + b)->die = (int64_t )0;
#line 263
    return;
  }
  {
#line 267
  query = dw_get_dname_type((uint8_t *)((void *)(tcp_pend + b)->buffer), 12, (tcp_pend + b)->wanted);
  }
#line 269
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
    {
#line 270
    close((tcp_pend + b)->local);
#line 271
    (tcp_pend + b)->local = -1;
#line 271
    (tcp_pend + b)->upstream = -1;
    }
#line 271
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 271
      free((void *)(tcp_pend + b)->buffer);
#line 271
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 271
    (tcp_pend + b)->wanted = 0;
#line 271
    (tcp_pend + b)->got = 0;
#line 271
    (tcp_pend + b)->sent = 0;
#line 271
    (tcp_pend + b)->state = 0;
#line 271
    (tcp_pend + b)->die = (int64_t )0;
#line 272
    return;
  }
  {
#line 274
  orig_query = dw_substr(query, 0, -1, -1);
#line 275
  dwc_lower_case(query);
#line 277
  tmp = get_reply_from_cache(query, (sockaddr_all_T *)0, 0, local_id, 0, b, orig_query,
                             (ip_addr_T *)0);
  }
#line 277
  if (tmp != 1) {
    {
#line 279
    forward_local_udp_packet(1, local_id, (ip_addr_T *)0, (uint16_t )0, (unsigned char *)((void *)(tcp_pend + b)->buffer),
                             (tcp_pend + b)->wanted, b, orig_query);
#line 282
    (tcp_pend + b)->state = 1;
#line 286
    (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 10);
    }
  }
  {
#line 290
  dw_destroy(query);
#line 291
  dw_destroy(orig_query);
  }
#line 292
  return;
}
}
#line 296 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_return_reply(int b , char *packet , int len ) 
{ 
  void *tmp ;

  {
#line 297
  if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
    {
#line 298
    free((void *)(tcp_pend + b)->buffer);
#line 299
    (tcp_pend + b)->buffer = (char *)0;
    }
  }
  {
#line 301
  (tcp_pend + b)->state = 2;
#line 302
  tmp = malloc((size_t )(len + 3));
#line 302
  (tcp_pend + b)->buffer = (char *)tmp;
#line 304
  *((tcp_pend + b)->buffer + 0) = (char )((len & 65280) >> 8);
#line 305
  *((tcp_pend + b)->buffer + 1) = (char )(len & 255);
#line 306
  memcpy((void */* __restrict  */)((tcp_pend + b)->buffer + 2), (void const   */* __restrict  */)packet,
         (size_t )len);
#line 307
  (tcp_pend + b)->wanted = len + 2;
#line 308
  (tcp_pend + b)->got = 0;
#line 309
  (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
  }
#line 310
  return;
}
}
#line 314 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_send_wanted(int b ) 
{ 
  ssize_t len ;
  int tosend ;

  {
#line 315
  len = (ssize_t )0;
#line 316
  tosend = 0;
#line 317
  if ((tcp_pend + b)->state != 2) {
#line 318
    return;
  }
#line 320
  tosend = (tcp_pend + b)->wanted - (tcp_pend + b)->got;
#line 321
  if (tosend > 0) {
#line 321
    if ((tcp_pend + b)->state == 2) {
      {
#line 322
      len = send((tcp_pend + b)->local, (void const   *)((tcp_pend + b)->buffer + (tcp_pend + b)->got),
                 (size_t )tosend, 64);
#line 324
      (tcp_pend + b)->got = (int32_t )((ssize_t )(tcp_pend + b)->got + len);
#line 325
      (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
      }
    } else {
#line 321
      goto _L;
    }
  } else {
    _L: /* CIL Label */ 
    {
#line 328
    close((tcp_pend + b)->local);
#line 329
    (tcp_pend + b)->local = -1;
#line 329
    (tcp_pend + b)->upstream = -1;
    }
#line 329
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 329
      free((void *)(tcp_pend + b)->buffer);
#line 329
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 329
    (tcp_pend + b)->wanted = 0;
#line 329
    (tcp_pend + b)->got = 0;
#line 329
    (tcp_pend + b)->sent = 0;
#line 329
    (tcp_pend + b)->state = 0;
#line 329
    (tcp_pend + b)->die = (int64_t )0;
  }
#line 331
  return;
}
}
#line 334 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
dw_str *make_dns_query_packet(dw_str *query , int id , int is_upstream ) 
{ 
  dw_str *out ;
  int tmp ;
  int tmp___0 ;

  {
#line 335
  out = (dw_str *)0;
#line 340
  if (is_upstream == 1) {
    {
#line 341
    out = make_dns_header(id, (int16_t )384, 0, 0, 0);
    }
  } else {
    {
#line 343
    out = make_dns_header(id, (int16_t )128, 0, 0, 0);
    }
  }
#line 345
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 346
    goto catch_make_dns_query_packet;
  }
  {
#line 348
  tmp = dw_append(query, out);
  }
#line 348
  if (tmp == -1) {
#line 349
    goto catch_make_dns_query_packet;
  }
  {
#line 351
  tmp___0 = dw_put_u16(out, (uint16_t )1, -1);
  }
#line 351
  if (tmp___0 == -1) {
#line 352
    goto catch_make_dns_query_packet;
  }
#line 355
  return (out);
  catch_make_dns_query_packet: 
#line 358
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 359
    dw_destroy(out);
    }
  }
#line 361
  return ((dw_str *)0);
}
}
#line 367 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_truncated_retry(int b , dw_str *query , int id , int udp_id , int is_up ) 
{ 
  dw_str *tmp ;
  sockaddr_all_T server ;
  socklen_t len ;
  void *tmp___0 ;
  int tmp___1 ;
  int *tmp___2 ;

  {
#line 368
  tmp = (dw_str *)0;
#line 370
  len = (socklen_t )sizeof(struct sockaddr_in );
#line 372
  if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
    {
#line 373
    free((void *)(tcp_pend + b)->buffer);
#line 374
    (tcp_pend + b)->buffer = (char *)0;
    }
  }
  {
#line 378
  tmp = make_dns_query_packet(query, id, is_up);
  }
#line 379
  if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 380
    goto catch_tcp_truncated_retry;
  }
  {
#line 382
  tmp___0 = malloc((size_t )(tmp->len + 3U));
#line 382
  (tcp_pend + b)->buffer = (char *)tmp___0;
  }
#line 383
  if ((unsigned long )(tcp_pend + b)->buffer == (unsigned long )((char *)0)) {
#line 384
    goto catch_tcp_truncated_retry;
  }
  {
#line 386
  *((tcp_pend + b)->buffer + 0) = (char )((tmp->len & 65280U) >> 8);
#line 387
  *((tcp_pend + b)->buffer + 1) = (char )(tmp->len & 255U);
#line 388
  memcpy((void */* __restrict  */)((tcp_pend + b)->buffer + 2), (void const   */* __restrict  */)tmp->str,
         (size_t )tmp->len);
#line 389
  (tcp_pend + b)->state = 3;
#line 390
  (tcp_pend + b)->got = 0;
#line 391
  (tcp_pend + b)->wanted = (int32_t )(tmp->len + 2U);
#line 394
  (tcp_pend + b)->upstream = setup_tcp_server(& server, query, udp_id);
  }
#line 395
  if ((tcp_pend + b)->upstream == -1) {
#line 396
    goto catch_tcp_truncated_retry;
  }
  {
#line 398
  fcntl((tcp_pend + b)->upstream, 4, 2048);
  }
#line 400
  if ((int )server.u.v4.sin_family == 10) {
#line 401
    len = (socklen_t )sizeof(struct sockaddr_in6 );
  }
  {
#line 403
  tmp___1 = connect((tcp_pend + b)->upstream, (struct sockaddr  const  *)((struct sockaddr *)(& server)),
                    len);
  }
#line 403
  if (tmp___1 == -1) {
    {
#line 403
    tmp___2 = __errno_location();
    }
#line 403
    if (*tmp___2 != 115) {
      {
#line 405
      close((tcp_pend + b)->upstream);
      }
#line 406
      goto catch_tcp_truncated_retry;
    }
  }
  {
#line 410
  dw_destroy(tmp);
  }
#line 411
  return;
  catch_tcp_truncated_retry: 
#line 414
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 415
    dw_destroy(tmp);
    }
  }
  {
#line 417
  close((tcp_pend + b)->local);
#line 418
  (tcp_pend + b)->local = -1;
#line 418
  (tcp_pend + b)->upstream = -1;
  }
#line 418
  if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
    {
#line 418
    free((void *)(tcp_pend + b)->buffer);
#line 418
    (tcp_pend + b)->buffer = (char *)0;
    }
  }
#line 418
  (tcp_pend + b)->wanted = 0;
#line 418
  (tcp_pend + b)->got = 0;
#line 418
  (tcp_pend + b)->sent = 0;
#line 418
  (tcp_pend + b)->state = 0;
#line 418
  (tcp_pend + b)->die = (int64_t )0;
#line 419
  return;
}
}
#line 422 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_upstream_send(int b ) 
{ 
  ssize_t len ;

  {
#line 423
  len = (ssize_t )0;
#line 425
  if ((tcp_pend + b)->state != 3) {
#line 426
    return;
  }
#line 429
  if ((tcp_pend + b)->wanted < (tcp_pend + b)->got) {
    {
#line 430
    close((tcp_pend + b)->local);
#line 431
    close((tcp_pend + b)->upstream);
#line 432
    (tcp_pend + b)->local = -1;
#line 432
    (tcp_pend + b)->upstream = -1;
    }
#line 432
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 432
      free((void *)(tcp_pend + b)->buffer);
#line 432
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 432
    (tcp_pend + b)->wanted = 0;
#line 432
    (tcp_pend + b)->got = 0;
#line 432
    (tcp_pend + b)->sent = 0;
#line 432
    (tcp_pend + b)->state = 0;
#line 432
    (tcp_pend + b)->die = (int64_t )0;
  }
  {
#line 435
  len = send((tcp_pend + b)->upstream, (void const   *)((tcp_pend + b)->buffer + (tcp_pend + b)->got),
             (size_t )((tcp_pend + b)->wanted - (tcp_pend + b)->got), 64);
  }
#line 438
  if (len == -1L) {
#line 439
    return;
  }
#line 442
  (tcp_pend + b)->got = (int32_t )((ssize_t )(tcp_pend + b)->got + len);
#line 443
  (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds << 8);
#line 444
  if ((tcp_pend + b)->got >= (tcp_pend + b)->wanted) {
    {
#line 446
    free((void *)(tcp_pend + b)->buffer);
#line 447
    (tcp_pend + b)->buffer = (char *)0;
#line 448
    (tcp_pend + b)->state = 4;
    }
  }
#line 450
  return;
}
}
#line 453 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_prepare_upstream_len(int b ) 
{ 
  void *tmp ;

  {
#line 454
  if ((tcp_pend + b)->state != 4) {
#line 455
    return;
  }
  {
#line 457
  tmp = malloc((size_t )3);
#line 457
  (tcp_pend + b)->buffer = (char *)tmp;
  }
#line 458
  if ((unsigned long )(tcp_pend + b)->buffer == (unsigned long )((char *)0)) {
    {
#line 459
    close((tcp_pend + b)->local);
#line 460
    close((tcp_pend + b)->upstream);
#line 461
    (tcp_pend + b)->local = -1;
#line 461
    (tcp_pend + b)->upstream = -1;
    }
#line 461
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 461
      free((void *)(tcp_pend + b)->buffer);
#line 461
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 461
    (tcp_pend + b)->wanted = 0;
#line 461
    (tcp_pend + b)->got = 0;
#line 461
    (tcp_pend + b)->sent = 0;
#line 461
    (tcp_pend + b)->state = 0;
#line 461
    (tcp_pend + b)->die = (int64_t )0;
  }
#line 463
  (tcp_pend + b)->wanted = 2;
#line 464
  (tcp_pend + b)->got = 0;
#line 465
  (tcp_pend + b)->state = 5;
#line 466
  return;
}
}
#line 470 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_get_upstream_len(int b ) 
{ 
  int32_t wanted ;
  int32_t toget ;
  ssize_t len ;
  void *tmp ;

  {
#line 471
  wanted = 0;
#line 472
  toget = 0;
#line 473
  len = (ssize_t )0;
#line 475
  if ((tcp_pend + b)->state != 5) {
#line 476
    return;
  }
#line 478
  toget = (tcp_pend + b)->wanted - (tcp_pend + b)->got;
#line 479
  if (toget > 0) {
    {
#line 480
    len = recv((tcp_pend + b)->upstream, (void *)((tcp_pend + b)->buffer + (tcp_pend + b)->got),
               (size_t )toget, 64);
    }
#line 483
    if (len <= 0L) {
#line 484
      return;
    }
#line 486
    (tcp_pend + b)->got = (int32_t )((ssize_t )(tcp_pend + b)->got + len);
#line 487
    (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
  } else
#line 489
  if (toget == 0) {
    {
#line 490
    wanted = (int )*((tcp_pend + b)->buffer + 0) & 255;
#line 491
    wanted <<= 8;
#line 492
    wanted |= (int )*((tcp_pend + b)->buffer + 1) & 255;
#line 493
    free((void *)(tcp_pend + b)->buffer);
#line 494
    (tcp_pend + b)->buffer = (char *)0;
#line 495
    (tcp_pend + b)->wanted = wanted;
#line 496
    tmp = malloc((size_t )(wanted + 3));
#line 496
    (tcp_pend + b)->buffer = (char *)tmp;
#line 497
    (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
#line 499
    (tcp_pend + b)->state = 6;
#line 500
    *((tcp_pend + b)->buffer + 0) = (char )((wanted & 65280) >> 8);
#line 501
    *((tcp_pend + b)->buffer + 1) = (char )(wanted & 255);
#line 502
    (tcp_pend + b)->got = 0;
    }
  }
#line 504
  return;
}
}
#line 508 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_downstream_forward(int b ) 
{ 
  ssize_t len ;
  ssize_t actual ;

  {
#line 509
  len = (ssize_t )0;
#line 510
  actual = (ssize_t )0;
#line 512
  if ((tcp_pend + b)->state != 6) {
#line 513
    return;
  }
#line 516
  if ((tcp_pend + b)->got >= (tcp_pend + b)->wanted) {
#line 516
    goto _L;
  } else
#line 516
  if ((unsigned long )(tcp_pend + b)->buffer == (unsigned long )((char *)0)) {
#line 516
    goto _L;
  } else
#line 516
  if ((tcp_pend + b)->sent >= (tcp_pend + b)->wanted + 2) {
    _L: /* CIL Label */ 
    {
#line 519
    close((tcp_pend + b)->local);
#line 520
    close((tcp_pend + b)->upstream);
#line 521
    (tcp_pend + b)->local = -1;
#line 521
    (tcp_pend + b)->upstream = -1;
    }
#line 521
    if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
      {
#line 521
      free((void *)(tcp_pend + b)->buffer);
#line 521
      (tcp_pend + b)->buffer = (char *)0;
      }
    }
#line 521
    (tcp_pend + b)->wanted = 0;
#line 521
    (tcp_pend + b)->got = 0;
#line 521
    (tcp_pend + b)->sent = 0;
#line 521
    (tcp_pend + b)->state = 0;
#line 521
    (tcp_pend + b)->die = (int64_t )0;
#line 522
    return;
  }
  {
#line 526
  len = recv((tcp_pend + b)->upstream, (void *)(((tcp_pend + b)->buffer + 2) + (tcp_pend + b)->got),
             (size_t )((tcp_pend + b)->wanted - (tcp_pend + b)->got), 64);
  }
#line 530
  if (len != (ssize_t )((tcp_pend + b)->wanted - (tcp_pend + b)->got)) {
#line 531
    if (len <= 0L) {
#line 532
      return;
    } else {
#line 534
      (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
    }
  }
  {
#line 539
  (tcp_pend + b)->got = (int32_t )((ssize_t )(tcp_pend + b)->got + len);
#line 542
  actual = send((tcp_pend + b)->local, (void const   *)((tcp_pend + b)->buffer + (tcp_pend + b)->sent),
                (size_t )(((tcp_pend + b)->got - (tcp_pend + b)->sent) + 2), 64);
  }
#line 546
  if (actual <= 0L) {
#line 547
    return;
  } else
#line 548
  if (actual != len) {
#line 549
    (tcp_pend + b)->die = the_time + ((int64_t )timeout_seconds_tcp << 8);
#line 551
    (tcp_pend + b)->sent = (int32_t )((ssize_t )(tcp_pend + b)->sent + actual);
#line 552
    return;
  } else
#line 553
  if (actual == len) {
#line 553
    if ((tcp_pend + b)->wanted == (tcp_pend + b)->got) {
      {
#line 555
      close((tcp_pend + b)->local);
#line 556
      close((tcp_pend + b)->upstream);
#line 557
      (tcp_pend + b)->local = -1;
#line 557
      (tcp_pend + b)->upstream = -1;
      }
#line 557
      if ((unsigned long )(tcp_pend + b)->buffer != (unsigned long )((char *)0)) {
        {
#line 557
        free((void *)(tcp_pend + b)->buffer);
#line 557
        (tcp_pend + b)->buffer = (char *)0;
        }
      }
#line 557
      (tcp_pend + b)->wanted = 0;
#line 557
      (tcp_pend + b)->got = 0;
#line 557
      (tcp_pend + b)->sent = 0;
#line 557
      (tcp_pend + b)->state = 0;
#line 557
      (tcp_pend + b)->die = (int64_t )0;
#line 558
      return;
    }
  }
#line 561
  (tcp_pend + b)->sent = (int32_t )((ssize_t )(tcp_pend + b)->sent + actual);
#line 563
  return;
}
}
#line 566 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_handle_all(int b ) 
{ 


  {
#line 567
  if (key_n[17] == 1) {
    {
#line 568
    tcp_get_wanted(b);
#line 569
    tcp_process_data(b);
#line 570
    tcp_send_wanted(b);
#line 571
    tcp_upstream_send(b);
#line 572
    tcp_prepare_upstream_len(b);
#line 573
    tcp_get_upstream_len(b);
#line 574
    tcp_downstream_forward(b);
    }
  }
#line 576
  return;
}
}
#line 579 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void kill_tcp_expired(void) 
{ 
  int a ;

  {
#line 580
  a = 0;
#line 581
  a = 0;
  {
#line 581
  while (1) {
    while_continue: /* CIL Label */ ;
#line 581
    if (! (a < max_tcp_procs)) {
#line 581
      goto while_break;
    }
#line 582
    if ((tcp_pend + a)->die > 0L) {
#line 582
      if ((tcp_pend + a)->die < the_time) {
        {
#line 583
        close((tcp_pend + a)->local);
#line 584
        (tcp_pend + a)->local = -1;
#line 584
        (tcp_pend + a)->upstream = -1;
        }
#line 584
        if ((unsigned long )(tcp_pend + a)->buffer != (unsigned long )((char *)0)) {
          {
#line 584
          free((void *)(tcp_pend + a)->buffer);
#line 584
          (tcp_pend + a)->buffer = (char *)0;
          }
        }
#line 584
        (tcp_pend + a)->wanted = 0;
#line 584
        (tcp_pend + a)->got = 0;
#line 584
        (tcp_pend + a)->sent = 0;
#line 584
        (tcp_pend + a)->state = 0;
#line 584
        (tcp_pend + a)->die = (int64_t )0;
      }
    }
#line 581
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 587
  return;
}
}
#line 590 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.c"
void tcp_process_results(int a , fd_set *rx_fd ) 
{ 
  int b ;
  int z ;

  {
#line 591
  b = 0;
#line 591
  z = 0;
  {
#line 594
  while (1) {
    while_continue: /* CIL Label */ ;
#line 594
    if (a > 0) {
#line 594
      if (! (z < 10000)) {
#line 594
        goto while_break;
      }
    } else {
#line 594
      goto while_break;
    }
#line 596
    b = 0;
    {
#line 596
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 596
      if (! (b < 128)) {
#line 596
        goto while_break___0;
      }
#line 597
      if (tcp_b_local[b] != -1) {
#line 597
        if ((rx_fd->__fds_bits[tcp_b_local[b] / (8 * (int )sizeof(__fd_mask ))] & (1L << tcp_b_local[b] % (8 * (int )sizeof(__fd_mask )))) != 0L) {
          {
#line 599
          local_tcp_accept(tcp_b_local[b]);
#line 600
          a --;
          }
#line 601
          if (a <= 0) {
#line 602
            return;
          }
        }
      }
#line 596
      b ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 606
    z ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 608
  return;
}
}
#line 79 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
int dwh_add(dw_hash *hash , dw_str *key___6 , dw_str *value___6 , int32_t ttl , int use_fila ) ;
#line 89
dw_str *dwh_get(dw_hash *hash , dw_str *key___6 , int ignore_expire , int use_fila ) ;
#line 92
int32_t dwh_get_ttl(dw_hash *hash , dw_str *key___6 ) ;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.h"
dw_str *dwd_fetch(dw_hash *hash , dw_str *key___6 ) ;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.h"
dns_string *dwc_make_dns_str(dw_str *in ) ;
#line 43
void dwc_zap_dns_str(dns_string *zap ) ;
#line 59
int dwc_rr_rotate(dw_str *in , int32_t *out_start , int32_t *out_end ) ;
#line 62
void dwc_process(dw_hash *cache___0 , dw_str *query , uint8_t action ) ;
#line 68
int dwc_has_bad_ip(dw_str *answer , dw_hash *blacklist_hash ) ;
#line 33 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
dns_string *dwc_init_dns_str(int32_t ancount , int32_t nscount , int32_t arcount ) 
{ 
  dns_string *out ;
  int a ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 35
  out = (dns_string *)0;
#line 38
  tmp = malloc(sizeof(dns_string ));
#line 38
  out = (dns_string *)tmp;
  }
#line 39
  if ((unsigned long )out == (unsigned long )((dns_string *)0)) {
#line 40
    return ((dns_string *)0);
  }
#line 42
  if (ancount < 0) {
#line 43
    goto catch_dwc_init_dns_str;
  } else
#line 42
  if (nscount < 0) {
#line 43
    goto catch_dwc_init_dns_str;
  } else
#line 42
  if (arcount < 0) {
#line 43
    goto catch_dwc_init_dns_str;
  }
  {
#line 45
  tmp___0 = malloc(((unsigned long )ancount * sizeof(uint16_t )) * 2UL + 2UL);
#line 45
  out->an = (uint16_t *)tmp___0;
  }
#line 46
  if ((unsigned long )out->an != (unsigned long )((uint16_t *)0)) {
#line 47
    a = 0;
    {
#line 47
    while (1) {
      while_continue: /* CIL Label */ ;
#line 47
      if (! (a < ancount * 2)) {
#line 47
        goto while_break;
      }
#line 48
      *(out->an + a) = (uint16_t )0;
#line 47
      a ++;
    }
    while_break: /* CIL Label */ ;
    }
  } else
#line 50
  if (ancount > 0) {
#line 51
    goto catch_dwc_init_dns_str;
  }
  {
#line 53
  tmp___1 = malloc(((unsigned long )nscount * sizeof(uint16_t )) * 2UL + 2UL);
#line 53
  out->ns = (uint16_t *)tmp___1;
  }
#line 54
  if ((unsigned long )out->ns != (unsigned long )((uint16_t *)0)) {
#line 55
    a = 0;
    {
#line 55
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 55
      if (! (a < nscount * 2)) {
#line 55
        goto while_break___0;
      }
#line 56
      *(out->ns + a) = (uint16_t )0;
#line 55
      a ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else
#line 58
  if (nscount > 0) {
#line 59
    goto catch_dwc_init_dns_str;
  }
  {
#line 61
  tmp___2 = malloc(((unsigned long )arcount * sizeof(uint16_t )) * 2UL + 2UL);
#line 61
  out->ar = (uint16_t *)tmp___2;
  }
#line 62
  if ((unsigned long )out->ar != (unsigned long )((uint16_t *)0)) {
#line 63
    a = 0;
    {
#line 63
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 63
      if (! (a < arcount * 2)) {
#line 63
        goto while_break___1;
      }
#line 64
      *(out->ar + a) = (uint16_t )0;
#line 63
      a ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  } else
#line 66
  if (arcount > 0) {
#line 67
    goto catch_dwc_init_dns_str;
  }
#line 69
  out->packet = (dw_str *)0;
#line 70
  out->ancount = ancount;
#line 71
  out->nscount = nscount;
#line 72
  out->arcount = arcount;
#line 73
  out->type = (uint8_t )0;
#line 74
  if ((unsigned long )out->an == (unsigned long )((uint16_t *)0)) {
#line 75
    goto catch_dwc_init_dns_str;
  } else
#line 74
  if ((unsigned long )out->ns == (unsigned long )((uint16_t *)0)) {
#line 75
    goto catch_dwc_init_dns_str;
  } else
#line 74
  if ((unsigned long )out->ar == (unsigned long )((uint16_t *)0)) {
#line 75
    goto catch_dwc_init_dns_str;
  }
#line 77
  return (out);
  catch_dwc_init_dns_str: 
#line 80
  if ((unsigned long )out->packet != (unsigned long )((dw_str *)0)) {
    {
#line 81
    dw_destroy(out->packet);
    }
  }
#line 83
  if ((unsigned long )out->an != (unsigned long )((uint16_t *)0)) {
    {
#line 84
    free((void *)out->an);
    }
  }
#line 86
  if ((unsigned long )out->ns != (unsigned long )((uint16_t *)0)) {
    {
#line 87
    free((void *)out->ns);
    }
  }
#line 89
  if ((unsigned long )out->ar != (unsigned long )((uint16_t *)0)) {
    {
#line 90
    free((void *)out->ar);
    }
  }
  {
#line 92
  free((void *)out);
  }
#line 93
  return ((dns_string *)0);
}
}
#line 97 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
void dwc_zap_dns_str(dns_string *zap ) 
{ 


  {
#line 98
  if ((unsigned long )zap == (unsigned long )((dns_string *)0)) {
#line 99
    return;
  }
#line 101
  if ((unsigned long )zap->packet != (unsigned long )((dw_str *)0)) {
    {
#line 102
    dw_destroy(zap->packet);
    }
  }
#line 104
  if ((unsigned long )zap->an != (unsigned long )((uint16_t *)0)) {
    {
#line 105
    free((void *)zap->an);
    }
  }
#line 107
  if ((unsigned long )zap->ns != (unsigned long )((uint16_t *)0)) {
    {
#line 108
    free((void *)zap->ns);
    }
  }
#line 110
  if ((unsigned long )zap->ar != (unsigned long )((uint16_t *)0)) {
    {
#line 111
    free((void *)zap->ar);
    }
  }
  {
#line 113
  free((void *)zap);
  }
#line 114
  return;
}
}
#line 117 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int32_t dwc_place_offsets(dw_str *in , int32_t offset , int32_t count , uint16_t *array ) 
{ 
  int tmp ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;

  {
  {
#line 120
  tmp = dw_assert_sanity(in);
  }
#line 120
  if (tmp == -1) {
#line 121
    return (-1);
  }
  {
#line 124
  while (1) {
    while_continue: /* CIL Label */ ;
#line 124
    if (! (count > 0)) {
#line 124
      goto while_break;
    }
#line 125
    count --;
#line 126
    offset -= 2;
#line 127
    if (offset < 0) {
#line 128
      return (-1);
    }
    {
#line 130
    tmp___0 = dw_fetch_u16(in, offset);
#line 130
    *(array + (count * 2 + 1)) = (uint16_t )tmp___0;
#line 131
    offset -= 2;
    }
#line 132
    if (offset < 0) {
#line 133
      return (-1);
    }
    {
#line 135
    tmp___1 = dw_fetch_u16(in, offset);
#line 135
    *(array + count * 2) = (uint16_t )tmp___1;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 137
  return (offset);
}
}
#line 142 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
dns_string *dwc_make_dns_str(dw_str *in ) 
{ 
  dns_string *out ;
  int32_t offset ;
  uint8_t type ;
  int32_t ancount ;
  int32_t nscount ;
  int32_t arcount ;
  int tmp ;

  {
  {
#line 143
  out = (dns_string *)0;
#line 144
  offset = 0;
#line 145
  type = (uint8_t )0;
#line 146
  ancount = 0;
#line 146
  nscount = 0;
#line 146
  arcount = 0;
#line 148
  tmp = dw_assert_sanity(in);
  }
#line 148
  if (tmp == -1) {
#line 149
    goto catch_dwc_make_dns_str;
  }
#line 151
  offset = (int32_t )(in->len - 1U);
#line 152
  if (offset < 7) {
#line 153
    goto catch_dwc_make_dns_str;
  }
#line 156
  type = *(in->str + offset);
#line 157
  if ((int )type != 0) {
#line 157
    if ((int )type != 1) {
#line 157
      if ((int )type != 2) {
#line 159
        goto catch_dwc_make_dns_str;
      }
    }
  }
  {
#line 161
  offset -= 2;
#line 162
  arcount = dw_fetch_u16(in, offset);
#line 163
  offset -= 2;
#line 164
  nscount = dw_fetch_u16(in, offset);
#line 165
  offset -= 2;
#line 166
  ancount = dw_fetch_u16(in, offset);
#line 167
  out = dwc_init_dns_str(ancount, nscount, arcount);
  }
#line 168
  if ((unsigned long )out == (unsigned long )((dns_string *)0)) {
#line 169
    goto catch_dwc_make_dns_str;
  }
  {
#line 171
  out->packet = dw_substr(in, 0, -1, -1);
#line 172
  out->type = type;
#line 174
  offset = dwc_place_offsets(in, offset, arcount, out->ar);
  }
#line 175
  if (offset < 0) {
#line 176
    goto catch_dwc_make_dns_str;
  }
  {
#line 178
  offset = dwc_place_offsets(in, offset, nscount, out->ns);
  }
#line 179
  if (offset < 0) {
#line 180
    goto catch_dwc_make_dns_str;
  }
  {
#line 182
  offset = dwc_place_offsets(in, offset, ancount, out->an);
  }
#line 183
  if (offset < 0) {
#line 184
    goto catch_dwc_make_dns_str;
  }
#line 187
  return (out);
  catch_dwc_make_dns_str: 
#line 190
  if ((unsigned long )out != (unsigned long )((dns_string *)0)) {
    {
#line 191
    dwc_zap_dns_str(out);
    }
  }
#line 193
  return ((dns_string *)0);
}
}
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
dw_str *dwc_convert_dns_str(dns_string *in ) 
{ 
  int32_t len ;
  int32_t counter ;
  dw_str *out ;

  {
#line 202
  len = 0;
#line 202
  counter = 0;
#line 203
  out = (dw_str *)0;
#line 205
  if ((unsigned long )in == (unsigned long )((dns_string *)0)) {
#line 206
    goto catch_dwc_convert_dns_str;
  }
#line 208
  if ((unsigned long )in->packet == (unsigned long )((dw_str *)0)) {
#line 209
    goto catch_dwc_convert_dns_str;
  } else
#line 208
  if ((unsigned long )in->an == (unsigned long )((uint16_t *)0)) {
#line 209
    goto catch_dwc_convert_dns_str;
  } else
#line 208
  if ((unsigned long )in->ns == (unsigned long )((uint16_t *)0)) {
#line 209
    goto catch_dwc_convert_dns_str;
  } else
#line 208
  if ((unsigned long )in->ar == (unsigned long )((uint16_t *)0)) {
#line 209
    goto catch_dwc_convert_dns_str;
  }
  {
#line 212
  len = (int32_t )(in->packet)->len;
#line 213
  len += ((in->ancount + in->nscount) + in->arcount) * 4;
#line 214
  len += 8;
#line 215
  out = dw_create((uint32_t )len);
#line 216
  dw_append(in->packet, out);
#line 217
  counter = 0;
  }
  {
#line 217
  while (1) {
    while_continue: /* CIL Label */ ;
#line 217
    if (! (counter < in->ancount * 2)) {
#line 217
      goto while_break;
    }
    {
#line 218
    dw_put_u16(out, *(in->an + counter), -1);
#line 219
    dw_put_u16(out, *(in->an + (counter + 1)), -1);
#line 217
    counter += 2;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 221
  counter = 0;
  {
#line 221
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 221
    if (! (counter < in->nscount * 2)) {
#line 221
      goto while_break___0;
    }
    {
#line 222
    dw_put_u16(out, *(in->ns + counter), -1);
#line 223
    dw_put_u16(out, *(in->ns + (counter + 1)), -1);
#line 221
    counter += 2;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 225
  counter = 0;
  {
#line 225
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 225
    if (! (counter < in->nscount * 2)) {
#line 225
      goto while_break___1;
    }
    {
#line 226
    dw_put_u16(out, *(in->ar + counter), -1);
#line 227
    dw_put_u16(out, *(in->ar + (counter + 1)), -1);
#line 225
    counter += 2;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  {
#line 230
  dw_put_u16(out, (uint16_t )in->ancount, -1);
#line 231
  dw_put_u16(out, (uint16_t )in->nscount, -1);
#line 232
  dw_put_u16(out, (uint16_t )in->arcount, -1);
#line 233
  dw_addchar(in->type, out);
  }
#line 234
  return (out);
  catch_dwc_convert_dns_str: 
#line 237
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 238
    dw_destroy(out);
    }
  }
#line 240
  return ((dw_str *)0);
}
}
#line 249 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
uint16_t dwc_get_type(dw_str *packet , uint16_t *list , int32_t max , int32_t offset ) 
{ 
  int32_t where ;
  int32_t val ;

  {
#line 251
  where = 0;
#line 251
  val = 0;
#line 253
  if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
#line 254
    goto catch_dwc_get_type;
  } else
#line 253
  if ((unsigned long )list == (unsigned long )((uint16_t *)0)) {
#line 254
    goto catch_dwc_get_type;
  }
#line 256
  if (offset < 0) {
#line 257
    goto catch_dwc_get_type;
  } else
#line 256
  if (offset > max) {
#line 257
    goto catch_dwc_get_type;
  }
#line 260
  where = (int32_t )*((list + offset * 2) + 1);
#line 261
  if (where < 0) {
#line 262
    goto catch_dwc_get_type;
  } else
#line 261
  if ((uint32_t )where > packet->len) {
#line 262
    goto catch_dwc_get_type;
  }
  {
#line 265
  val = dw_fetch_u16(packet, where);
  }
#line 267
  if (val < 0) {
#line 268
    goto catch_dwc_get_type;
  } else
#line 267
  if (val >= 65392) {
#line 267
    if (val <= 65407) {
#line 268
      goto catch_dwc_get_type;
    } else {
#line 267
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 267
  if (val >= 65536) {
#line 268
    goto catch_dwc_get_type;
  }
#line 271
  return ((uint16_t )val);
  catch_dwc_get_type: 
#line 274
  return ((uint16_t )65393);
}
}
#line 278 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_rr_find(dns_string *look ) 
{ 
  int rr ;
  uint16_t type ;

  {
#line 279
  rr = 0;
#line 280
  type = (uint16_t )5;
#line 282
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 283
    return (-1);
  }
#line 288
  rr = 0;
  {
#line 288
  while (1) {
    while_continue: /* CIL Label */ ;
#line 288
    if (rr < look->ancount) {
#line 288
      if (! ((int )type == 5)) {
#line 288
        goto while_break;
      }
    } else {
#line 288
      goto while_break;
    }
    {
#line 289
    type = dwc_get_type(look->packet, look->an, look->ancount, rr);
    }
#line 290
    if ((int )type == 65393) {
#line 291
      return (-1);
    }
#line 288
    rr ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 294
  if (rr > look->ancount) {
#line 295
    return (-1);
  }
#line 297
  rr --;
#line 299
  return (rr);
}
}
#line 309 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_rotate_offsets(dw_str *in , int end , int first_rr , int last_rr ) 
{ 
  int_fast32_t start ;
  int_fast32_t start_b ;
  int_fast32_t last_rr_len ;
  int_fast32_t this_rr ;
  int_fast32_t next_rr ;
  int_fast32_t next_rr_b ;
  int_fast32_t start_len ;
  int32_t tmp ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;
  int32_t tmp___2 ;

  {
#line 310
  start = (int_fast32_t )0;
#line 310
  start_b = (int_fast32_t )0;
#line 310
  last_rr_len = (int_fast32_t )0;
#line 310
  this_rr = (int_fast32_t )0;
#line 310
  next_rr = (int_fast32_t )0;
#line 310
  next_rr_b = (int_fast32_t )0;
#line 310
  start_len = (int_fast32_t )0;
#line 313
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 314
    return (-1);
  } else
#line 313
  if (first_rr >= last_rr) {
#line 314
    return (-1);
  } else
#line 313
  if (first_rr < 0) {
#line 314
    return (-1);
  }
#line 317
  if (first_rr == last_rr - 1) {
#line 318
    return (1);
  }
#line 321
  last_rr_len = (int_fast32_t )(end + last_rr * 4);
#line 323
  if (last_rr_len > (int_fast32_t )(in->len - 7U)) {
#line 324
    return (-1);
  } else
#line 325
  if (last_rr_len == (int_fast32_t )(in->len - 7U)) {
#line 326
    last_rr_len = (int_fast32_t )end;
  } else {
#line 328
    return (-1);
  }
  {
#line 332
  tmp = dw_fetch_u16(in, end + first_rr * 4);
#line 332
  start = (int_fast32_t )tmp;
#line 333
  tmp___0 = dw_fetch_u16(in, (end + 2) + first_rr * 4);
#line 333
  start_b = (int_fast32_t )tmp___0;
#line 335
  this_rr = (int_fast32_t )first_rr;
  }
  {
#line 335
  while (1) {
    while_continue: /* CIL Label */ ;
#line 335
    if (! (this_rr < (int_fast32_t )(last_rr - 1))) {
#line 335
      goto while_break;
    }
    {
#line 336
    tmp___1 = dw_fetch_u16(in, (int32_t )((int_fast32_t )end + (this_rr + 1L) * 4L));
#line 336
    next_rr = (int_fast32_t )tmp___1;
#line 337
    tmp___2 = dw_fetch_u16(in, (int32_t )((int_fast32_t )(end + 2) + (this_rr + 1L) * 4L));
#line 337
    next_rr_b = (int_fast32_t )tmp___2;
    }
#line 338
    if (this_rr == (int_fast32_t )first_rr) {
#line 339
      start_len = next_rr - start;
    }
    {
#line 341
    dw_put_u16(in, (uint16_t )(next_rr - start_len), (int32_t )((int_fast32_t )end + this_rr * 4L));
#line 342
    dw_put_u16(in, (uint16_t )(next_rr_b - start_len), (int32_t )((int_fast32_t )(end + 2) + this_rr * 4L));
#line 335
    this_rr ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 345
  dw_put_u16(in, (uint16_t )(last_rr_len - start_len), (int32_t )((int_fast32_t )end + this_rr * 4L));
#line 346
  dw_put_u16(in, (uint16_t )((last_rr_len - start_len) + (start_b - start)), (int32_t )((int_fast32_t )(end + 2) + this_rr * 4L));
  }
#line 349
  return (1);
}
}
#line 366 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_rr_rotate(dw_str *in , int32_t *out_start , int32_t *out_end ) 
{ 
  dns_string *look ;
  int ret ;
  int rr ;
  int32_t start ;
  int32_t pivot ;
  int32_t end ;
  int tmp ;
  int tmp___0 ;

  {
#line 367
  look = (dns_string *)0;
#line 368
  ret = -1;
#line 368
  rr = 0;
#line 369
  start = 0;
#line 369
  pivot = 0;
#line 369
  end = 0;
#line 371
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 372
    goto catch_dwc_rr_rotate;
  }
#line 375
  if ((unsigned long )out_start != (unsigned long )((int32_t *)0)) {
#line 376
    *out_start = -1;
#line 377
    if ((unsigned long )out_end == (unsigned long )((int32_t *)0)) {
#line 378
      goto catch_dwc_rr_rotate;
    }
#line 380
    *out_end = -1;
  }
  {
#line 383
  look = dwc_make_dns_str(in);
  }
#line 384
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 385
    goto catch_dwc_rr_rotate;
  } else
#line 384
  if ((unsigned long )look->an == (unsigned long )((uint16_t *)0)) {
#line 385
    goto catch_dwc_rr_rotate;
  } else
#line 384
  if (look->ancount == 0) {
#line 385
    goto catch_dwc_rr_rotate;
  }
#line 388
  if ((unsigned long )out_start == (unsigned long )((int32_t *)0)) {
    {
#line 389
    rr = dwc_rr_find(look);
    }
  } else {
#line 391
    rr = 0;
  }
#line 394
  if (rr == -1) {
#line 395
    goto catch_dwc_rr_rotate;
  } else
#line 394
  if (rr + 1 >= look->ancount) {
#line 394
    if ((unsigned long )out_start == (unsigned long )((int32_t *)0)) {
#line 395
      goto catch_dwc_rr_rotate;
    }
  }
#line 397
  start = (int32_t )*(look->an + rr * 2);
#line 398
  pivot = (int32_t )*(look->an + (rr + 1) * 2);
#line 399
  if (look->nscount == 0) {
#line 399
    if (look->arcount == 0) {
#line 400
      end = (int32_t )((in->len - 7U) - (uint32_t )(look->ancount * 4));
#line 401
      if (end < 0) {
#line 402
        goto catch_dwc_rr_rotate;
      }
    } else {
#line 399
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 404
  if (look->nscount > 0) {
#line 405
    end = (int32_t )*(look->ns);
  } else
#line 406
  if (look->arcount > 0) {
#line 407
    end = (int32_t )*(look->ar);
  } else {
#line 409
    goto catch_dwc_rr_rotate;
  }
#line 411
  if ((unsigned long )out_start == (unsigned long )((int32_t *)0)) {
#line 411
    goto _L___0;
  } else
#line 411
  if ((unsigned long )out_end == (unsigned long )((int32_t *)0)) {
    _L___0: /* CIL Label */ 
    {
#line 412
    tmp = dw_rotate(in, start, pivot, end);
    }
#line 412
    if (tmp == -1) {
#line 413
      goto catch_dwc_rr_rotate;
    }
    {
#line 415
    tmp___0 = dwc_rotate_offsets(in, (int )((in->len - 7U) - (uint32_t )(((look->ancount + look->nscount) + look->arcount) * 4)),
                                 rr, look->ancount);
    }
#line 415
    if (tmp___0 == -1) {
#line 418
      goto catch_dwc_rr_rotate;
    }
  } else {
#line 422
    *out_start = start;
#line 423
    *out_end = end;
  }
#line 425
  ret = 1;
  catch_dwc_rr_rotate: 
#line 428
  if ((unsigned long )look != (unsigned long )((dns_string *)0)) {
    {
#line 429
    dwc_zap_dns_str(look);
    }
  }
#line 431
  return (ret);
}
}
#line 435 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_ttl_age(dw_str *fetch , int32_t ttl ) 
{ 
  dns_string *look ;
  int ret ;
  int counter ;
  uint16_t left ;
  uint16_t right ;

  {
#line 436
  look = (dns_string *)0;
#line 437
  ret = -1;
#line 438
  counter = 0;
#line 439
  left = (uint16_t )0;
#line 439
  right = (uint16_t )0;
#line 441
  if (ttl == -1) {
#line 442
    goto catch_dwc_ttl_age;
  }
  {
#line 445
  look = dwc_make_dns_str(fetch);
  }
#line 447
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 448
    goto catch_dwc_ttl_age;
  } else
#line 447
  if ((unsigned long )look->an == (unsigned long )((uint16_t *)0)) {
#line 448
    goto catch_dwc_ttl_age;
  }
#line 451
  if (ttl < 5) {
#line 452
    ttl = 5;
  }
#line 455
  left = (uint16_t )(ttl >> 16);
#line 456
  left = (uint16_t )((int )left & 32767);
#line 457
  right = (uint16_t )(ttl & 65535);
#line 459
  counter = 0;
  {
#line 459
  while (1) {
    while_continue: /* CIL Label */ ;
#line 459
    if (! (counter < look->ancount)) {
#line 459
      goto while_break;
    }
    {
#line 460
    dw_put_u16(fetch, left, (int )*(look->an + (counter * 2 + 1)) + 4);
#line 461
    dw_put_u16(fetch, right, (int )*(look->an + (counter * 2 + 1)) + 6);
#line 459
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 464
  ret = 1;
  catch_dwc_ttl_age: 
#line 467
  if ((unsigned long )look != (unsigned long )((dns_string *)0)) {
    {
#line 468
    dwc_zap_dns_str(look);
    }
  }
#line 470
  return (ret);
}
}
#line 475 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
void dwc_process(dw_hash *cache___0 , dw_str *query , uint8_t action ) 
{ 
  dw_str *fetch ;
  int32_t ttl ;
  int tmp ;
  int tmp___0 ;

  {
#line 476
  fetch = (dw_str *)0;
#line 477
  ttl = 0;
#line 480
  if (key_n[19] == 1) {
#line 480
    if (((int )action & 2) == 2) {
      {
#line 481
      fetch = dwh_get(cache___0, query, 0, 1);
      }
#line 482
      if ((unsigned long )fetch == (unsigned long )((dw_str *)0)) {
#line 483
        goto catch_dwc_process;
      }
      {
#line 485
      ttl = dwh_get_ttl(cache___0, query);
      }
#line 486
      if (ttl == -1) {
#line 487
        goto catch_dwc_process;
      }
      {
#line 489
      tmp = dwc_ttl_age(fetch, ttl);
      }
#line 489
      if (tmp == -1) {
#line 490
        goto catch_dwc_process;
      }
      {
#line 492
      dwh_add(cache___0, query, fetch, -2, 1);
#line 493
      dw_destroy(fetch);
#line 494
      fetch = (dw_str *)0;
      }
    }
  }
#line 498
  if (key_n[18] == 1) {
#line 498
    if (((int )action & 1) == 1) {
      {
#line 499
      fetch = dwh_get(cache___0, query, 0, 1);
      }
#line 500
      if ((unsigned long )fetch == (unsigned long )((dw_str *)0)) {
#line 501
        goto catch_dwc_process;
      }
      {
#line 503
      tmp___0 = dwc_rr_rotate(fetch, (int32_t *)0, (int32_t *)0);
      }
#line 503
      if (tmp___0 == -1) {
#line 504
        goto catch_dwc_process;
      }
      {
#line 506
      ttl = dwh_get_ttl(cache___0, query);
      }
#line 507
      if (ttl == -1) {
#line 508
        goto catch_dwc_process;
      }
      {
#line 510
      dwh_add(cache___0, query, fetch, -2, 1);
      }
    }
  }
  catch_dwc_process: 
#line 514
  if ((unsigned long )fetch != (unsigned long )((dw_str *)0)) {
    {
#line 515
    dw_destroy(fetch);
    }
  }
#line 517
  return;
}
}
#line 523 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_check_ip(dw_hash *blacklist_hash , dw_str *ip ) 
{ 
  uint32_t ipc ;
  dw_str *tmp ;

  {
#line 524
  ipc = (uint32_t )0;
#line 526
  if ((unsigned long )ip == (unsigned long )((dw_str *)0)) {
#line 527
    return (0);
  }
#line 533
  if (ip->len == 4U) {
#line 533
    if (key_n[22] == 1) {
#line 534
      ipc = (uint32_t )(((((int )*(ip->str) << 24) | ((int )*(ip->str + 1) << 16)) | ((int )*(ip->str + 2) << 8)) | (int )*(ip->str + 3));
#line 538
      if ((ipc & 4294901760U) == 3232235520U) {
#line 539
        return (1);
      }
#line 541
      if ((ipc & 4293918720U) == 2886729728U) {
#line 542
        return (1);
      }
#line 544
      if ((ipc & 4278190080U) == 167772160U) {
#line 545
        return (1);
      }
#line 547
      if ((ipc & 4278190080U) == 2130706432U) {
#line 548
        return (1);
      }
#line 550
      if ((ipc & 4294901760U) == 2851995648U) {
#line 551
        return (1);
      }
#line 553
      if ((ipc & 4278190080U) == 3758096384U) {
#line 554
        return (1);
      }
#line 556
      if ((ipc & 4294901760U) == 0U) {
#line 557
        return (1);
      }
    }
  }
#line 562
  if ((unsigned long )blacklist_hash == (unsigned long )((dw_hash *)0)) {
#line 563
    return (0);
  }
  {
#line 567
  tmp = dwd_fetch(blacklist_hash, ip);
  }
#line 567
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
#line 568
    return (1);
  }
#line 572
  return (0);
}
}
#line 578 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_has_bad_ip(dw_str *answer , dw_hash *blacklist_hash ) 
{ 
  dns_string *look ;
  dw_str *ip ;
  int counter ;
  int32_t type ;
  int tmp ;
  int tmp___0 ;

  {
#line 579
  look = (dns_string *)0;
#line 580
  ip = (dw_str *)0;
#line 581
  counter = 0;
#line 582
  type = 0;
#line 584
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 585
    goto catch_has_bad_ip;
  }
  {
#line 588
  look = dwc_make_dns_str(answer);
  }
#line 589
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 590
    goto catch_has_bad_ip;
  } else
#line 589
  if ((unsigned long )look->an == (unsigned long )((uint16_t *)0)) {
#line 590
    goto catch_has_bad_ip;
  }
#line 593
  counter = 0;
  {
#line 593
  while (1) {
    while_continue: /* CIL Label */ ;
#line 593
    if (! (counter < look->ancount)) {
#line 593
      goto while_break;
    }
    {
#line 594
    type = dw_fetch_u16(answer, (int32_t )*(look->an + (counter * 2 + 1)));
    }
#line 595
    if (type == 1) {
      {
#line 596
      ip = dw_substr(answer, (int )*(look->an + (counter * 2 + 1)) + 10, 4, 1);
#line 598
      tmp = dwc_check_ip(blacklist_hash, ip);
      }
#line 598
      if (tmp != 0) {
        {
#line 599
        dwc_zap_dns_str(look);
#line 600
        dw_destroy(ip);
        }
#line 601
        return (1);
      }
      {
#line 603
      dw_destroy(ip);
#line 604
      ip = (dw_str *)0;
      }
    } else
#line 605
    if (type == 28) {
      {
#line 606
      ip = dw_substr(answer, (int )*(look->an + (counter * 2 + 1)) + 10, 16, 1);
#line 608
      tmp___0 = dwc_check_ip(blacklist_hash, ip);
      }
#line 608
      if (tmp___0 != 0) {
        {
#line 609
        dwc_zap_dns_str(look);
#line 610
        dw_destroy(ip);
        }
#line 611
        return (1);
      }
      {
#line 613
      dw_destroy(ip);
#line 614
      ip = (dw_str *)0;
      }
    }
#line 593
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  catch_has_bad_ip: 
#line 620
  if ((unsigned long )look != (unsigned long )((dns_string *)0)) {
    {
#line 621
    dwc_zap_dns_str(look);
    }
  }
#line 623
  return (0);
}
}
#line 629 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDnsStr.c"
int dwc_lower_case(dw_str *query ) 
{ 
  int length ;
  int place ;
  int counter ;
  uint8_t c ;

  {
#line 630
  length = 0;
#line 630
  place = 0;
#line 630
  counter = 0;
#line 633
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 634
    return (-1);
  } else
#line 633
  if (query->len == 0U) {
#line 634
    return (-1);
  } else
#line 633
  if ((unsigned long )query->str == (unsigned long )((uint8_t *)0)) {
#line 634
    return (-1);
  }
#line 637
  counter = 0;
  {
#line 637
  while (1) {
    while_continue: /* CIL Label */ ;
#line 637
    if (! ((uint32_t )counter < query->len)) {
#line 637
      goto while_break;
    }
#line 638
    if (counter == place) {
#line 639
      length = (int )*(query->str + place);
#line 640
      if (length == 0) {
#line 641
        goto while_break;
      }
#line 643
      place += length + 1;
    } else {
#line 645
      c = *(query->str + counter);
#line 646
      if ((int )c >= 65) {
#line 646
        if ((int )c <= 90) {
#line 647
          *(query->str + counter) = (uint8_t )((int )*(query->str + counter) + 32);
        }
      }
    }
#line 637
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 652
  return (1);
}
}
#line 169 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 242
extern int fflush(FILE *__stream ) ;
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
dw_hash *dwh_hash_init(uint32_t elements ) ;
#line 76
int dwh_zap(dw_hash *hash , dw_str *key___6 , dw_element *seek , int use_fila ) ;
#line 54 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.h"
uint16_t dwr_rng(dwr_rg *in ) ;
#line 123 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) bind)(int __fd ,
                                                                           struct sockaddr  const  *__addr ,
                                                                           socklen_t __len ) ;
#line 163
extern ssize_t sendto(int __fd , void const   *__buf , size_t __n , int __flags ,
                      struct sockaddr  const  *__addr , socklen_t __addr_len ) ;
#line 174
extern ssize_t recvfrom(int __fd , void * __restrict  __buf , size_t __n , int __flags ,
                        struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 227 "/usr/include/netinet/in.h"
extern struct in6_addr  const  in6addr_any ;
#line 377
extern  __attribute__((__nothrow__)) uint32_t ( __attribute__((__leaf__)) htonl)(uint32_t __hostlong )  __attribute__((__const__)) ;
#line 66 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 55 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.h"
void dw_log_ip(char *string , ip_addr_T *ip , int min_log_level ) ;
#line 58
void dw_log_dwstr(char *s1 , dw_str *s2 , int min_log_level ) ;
#line 62
void dw_log_dwstr_str(char *s1 , dw_str *s2 , char *s3 , int min_log_level ) ;
#line 66
void dw_log_string(char *string , int min_log_level ) ;
#line 134
int32_t set_dns_qid(unsigned char *packet , int len , uint16_t qid ) ;
#line 235 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
void zap_inflight(dw_str *query ) ;
#line 247
void reset_rem(int_fast32_t a ) ;
#line 276
int32_t find_free_remote(void) ;
#line 280
void get_local_udp_packet(int sock ) ;
#line 283
void get_remote_udp_packet(int b , int sock ) ;
#line 293
void init_inflight_hash(void) ;
#line 297
int bind_all_udp(void) ;
#line 316
dw_str *make_dns_packet(dw_str *question , dw_str *answer , int32_t id ) ;
#line 320
void make_remote_connection(int32_t n , unsigned char *packet , int len , dw_str *query ,
                            int x_socket_num ) ;
#line 324
void forward_remote_reply(unsigned char *packet , size_t len , remote_T *r_ip , int local_num ) ;
#line 329
void server_fail_noreply(int a , int local_num ) ;
#line 338
int setup_server(sockaddr_all_T *server , ip_addr_T *addr ) ;
#line 341
int do_random_bind(int s , int len ) ;
#line 349
unsigned char *make_synth_not_there_answer(unsigned char *a , int *count , int type ) ;
#line 74 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwTcpSocket.h"
void try_forward_local_udp_packet(int sock , int32_t local_id , ip_addr_T *from_ip ,
                                  uint16_t from_port , unsigned char *packet , int len ,
                                  sockaddr_all_T *client , dw_str *query , int tcp_num ,
                                  dw_str *orig_query ) ;
#line 24 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.h"
dw_str *dwc_decompress(dw_str *q , dw_str *in ) ;
#line 28
dw_str *dwc_compress(dw_str *q , dw_str *in ) ;
#line 121 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.h"
int dwx_cache_reply(dw_hash *cache___0 , dw_str *query , dw_str *in , int32_t ttl ,
                    int connection_number ) ;
#line 147
void dwx_do_ns_glueless(ip_addr_T addr , int32_t conn_number ) ;
#line 153
void dwx_glueless_done(dw_str *query , int32_t conn_num ) ;
#line 164
int send_reply_from_cache(unsigned char *a , ssize_t count , int b , int l ) ;
#line 170
void dwx_incomplete_cname_done(dw_str *query , int child , int l ) ;
#line 173
void dwx_cached_cname_done(dw_str *query , int b , int l , int depth ) ;
#line 176
int dwx_cname_in_cache(dw_str *orig_query , dw_str *query , sockaddr_all_T *client ,
                       ip_addr_T *from_ip , int32_t local_id , int sock , uint16_t from_port ) ;
#line 32 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
dwr_rg *rng_seed ;
#line 33
dw_hash *cache ;
#line 40
int b_local[129] ;
#line 41
int *b_remote ;
#line 44
remote_T *rem ;
#line 47 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
dw_hash *inflight  ;
#line 54
int handle_overload ;
#line 55
int resurrections ;
#line 56
int min_bind ;
#line 57
int num_ports ;
#line 59
int32_t max_ttl ;
#line 62
dw_hash *blacklist_dict ;
#line 70 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void init_inflight_hash(void) 
{ 


  {
#line 71
  inflight = (dw_hash *)0;
#line 72
  if (key_n[20] < 2) {
#line 73
    return;
  }
  {
#line 75
  inflight = dwh_hash_init((uint32_t )(key_n[0] + 10));
  }
#line 76
  return;
}
}
#line 82 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int bind_all_udp(void) 
{ 
  int a ;
  int count ;

  {
#line 83
  a = 0;
#line 84
  count = 0;
#line 85
  a = 0;
  {
#line 85
  while (1) {
    while_continue: /* CIL Label */ ;
#line 85
    if (! (a < 128)) {
#line 85
      goto while_break;
    }
#line 86
    if ((int )bind_address[a].len != 0) {
      {
#line 87
      b_local[a] = do_bind(& bind_address[a], 2);
      }
#line 88
      if (b_local[a] != -1) {
#line 89
        count ++;
      }
    } else {
#line 92
      b_local[a] = -1;
    }
#line 85
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 95
  return (count);
}
}
#line 100 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void setup_bind(sockaddr_all_T *dns_udp , uint16_t port , int len ) 
{ 


  {
#line 101
  if ((unsigned long )dns_udp == (unsigned long )((sockaddr_all_T *)0)) {
#line 102
    return;
  }
  {
#line 104
  memset((void *)dns_udp, 0, sizeof(*dns_udp));
  }
#line 105
  if (len == 4) {
    {
#line 106
    dns_udp->u.v4.sin_family = (sa_family_t )2;
#line 107
    dns_udp->u.v4.sin_addr.s_addr = htonl((in_addr_t )0);
#line 108
    dns_udp->u.v4.sin_port = htons(port);
    }
  } else
#line 110
  if (len == 16) {
    {
#line 111
    dns_udp->u.v6.sin6_family = (sa_family_t )10;
#line 112
    dns_udp->u.v6.sin6_addr = (struct in6_addr )in6addr_any;
#line 113
    dns_udp->u.v6.sin6_port = htons(port);
    }
  } else {
#line 116
    return;
  }
#line 118
  return;
}
}
#line 123 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int do_random_bind(int s , int len ) 
{ 
  sockaddr_all_T dns_udp ;
  int a ;
  int success ;
  socklen_t len_inet ;
  uint16_t tmp ;
  int tmp___0 ;

  {
#line 125
  a = 0;
#line 126
  success = 0;
#line 127
  len_inet = (socklen_t )sizeof(struct sockaddr_in );
#line 129
  a = 0;
  {
#line 129
  while (1) {
    while_continue: /* CIL Label */ ;
#line 129
    if (! (a < 10)) {
#line 129
      goto while_break;
    }
    {
#line 131
    tmp = dwr_rng(rng_seed);
#line 131
    setup_bind(& dns_udp, (uint16_t )(min_bind + ((int )tmp & num_ports)), len);
    }
#line 134
    if ((int )dns_udp.u.v4.sin_family == 10) {
#line 135
      len_inet = (socklen_t )sizeof(struct sockaddr_in6 );
    }
    {
#line 138
    tmp___0 = bind(s, (struct sockaddr  const  *)((struct sockaddr *)(& dns_udp)),
                   len_inet);
    }
#line 138
    if (tmp___0 != -1) {
#line 140
      success = 1;
#line 141
      goto while_break;
    }
#line 129
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 144
  if (success == 0) {
#line 145
    return (-1);
  }
#line 147
  return (1);
}
}
#line 152 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int setup_server(sockaddr_all_T *server , ip_addr_T *addr ) 
{ 
  int s ;

  {
#line 153
  s = -1;
#line 154
  if ((unsigned long )server == (unsigned long )((sockaddr_all_T *)0)) {
#line 155
    return (-1);
  } else
#line 154
  if ((unsigned long )addr == (unsigned long )((ip_addr_T *)0)) {
#line 155
    return (-1);
  }
  {
#line 158
  memset((void *)server, 0, sizeof(*server));
  }
#line 159
  if ((int )addr->len == 4) {
    {
#line 160
    server->u.v4.sin_family = (sa_family_t )2;
#line 161
    server->u.v4.sin_port = htons((uint16_t )upstream_port);
#line 162
    memcpy((void */* __restrict  */)(& server->u.v4.sin_addr), (void const   */* __restrict  */)(addr->ip),
           (size_t )4);
#line 163
    s = socket(2, 2, 0);
    }
  } else
#line 165
  if ((int )addr->len == 16) {
    {
#line 166
    server->u.v6.sin6_family = (sa_family_t )10;
#line 167
    server->u.v6.sin6_port = htons((uint16_t )upstream_port);
#line 168
    memcpy((void */* __restrict  */)(& server->u.v6.sin6_addr), (void const   */* __restrict  */)(addr->ip),
           (size_t )16);
#line 169
    s = socket(10, 2, 0);
    }
  } else {
#line 172
    return (-1);
  }
#line 174
  return (s);
}
}
#line 179 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void make_remote_connection(int32_t n , unsigned char *packet , int len , dw_str *query ,
                            int x_socket_num ) 
{ 
  sockaddr_all_T server ;
  int s ;
  int_fast32_t rnum ;
  ip_addr_T addr ;
  unsigned int tmp ;
  int counter ;
  socklen_t inet_len ;
  uint16_t tmp___0 ;
  int32_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t tmp___4 ;

  {
#line 182
  s = 0;
#line 183
  rnum = (int_fast32_t )-1;
#line 184
  addr.len = (uint8_t )0;
#line 184
  addr.ip[0] = (uint8_t )0;
#line 184
  addr.ip[1] = (uint8_t )0;
#line 184
  tmp = 2U;
  {
#line 184
  while (1) {
    while_continue: /* CIL Label */ ;
#line 184
    if (tmp >= 17U) {
#line 184
      goto while_break;
    }
#line 184
    addr.ip[tmp] = (unsigned char)0;
#line 184
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 184
  addr.glueless = (dw_str *)0;
#line 184
  addr.flags = (uint8_t )0;
#line 185
  counter = 0;
#line 186
  inet_len = (socklen_t )sizeof(struct sockaddr_in );
#line 188
  if ((rem + n)->socket != x_socket_num) {
#line 190
    return;
  } else
#line 188
  if ((int )(rem + n)->recurse_depth > 32) {
#line 190
    return;
  }
  {
#line 194
  tmp___0 = dwr_rng(rng_seed);
#line 194
  tmp___1 = set_dns_qid(packet, len, tmp___0);
#line 194
  rnum = (int_fast32_t )tmp___1;
  }
#line 195
  if (rnum == -1L) {
#line 196
    return;
  }
#line 200
  counter = 0;
  {
#line 200
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 200
    if (! (counter < 7)) {
#line 200
      goto while_break___0;
    }
    {
#line 201
    addr = get_upstream_ip(query, n);
    }
#line 203
    if ((int )(rem + n)->is_upstream == 1) {
#line 204
      *(packet + 2) = (unsigned char )((int )*(packet + 2) | 1);
    } else {
#line 206
      *(packet + 2) = (unsigned char )((int )*(packet + 2) & 254);
    }
#line 208
    if ((int )addr.len > 0) {
#line 209
      goto while_break___0;
    }
#line 200
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 212
  dw_log_ip((char *)"Making connection to IP", & addr, 128);
  }
#line 213
  if ((int )addr.len == 0) {
#line 214
    return;
  } else
#line 215
  if ((int )addr.len == 4) {
    {
#line 216
    s = setup_server(& server, & addr);
    }
  } else
#line 215
  if ((int )addr.len == 16) {
    {
#line 216
    s = setup_server(& server, & addr);
    }
  } else
#line 217
  if ((unsigned long )addr.glueless != (unsigned long )((dw_str *)0)) {
    {
#line 218
    dwx_do_ns_glueless(addr, n);
    }
#line 219
    return;
  }
#line 221
  if (s == -1) {
#line 222
    return;
  }
#line 226
  if ((int )server.u.v4.sin_family == 10) {
#line 227
    inet_len = (socklen_t )sizeof(struct sockaddr_in6 );
  }
  {
#line 230
  fcntl(s, 4, 2048);
#line 233
  tmp___2 = do_random_bind(s, (int )addr.len);
  }
#line 233
  if (tmp___2 == -1) {
    {
#line 236
    close(s);
    }
#line 237
    return;
  } else {
    {
#line 233
    tmp___3 = connect(s, (struct sockaddr  const  *)((struct sockaddr *)(& server)),
                      inet_len);
    }
#line 233
    if (tmp___3 == -1) {
      {
#line 236
      close(s);
      }
#line 237
      return;
    } else {
      {
#line 233
      tmp___4 = send(s, (void const   *)packet, (size_t )len, 0);
      }
#line 233
      if (tmp___4 < 0L) {
        {
#line 236
        close(s);
        }
#line 237
        return;
      }
    }
  }
#line 241
  *(b_remote + n) = s;
#line 242
  if ((rem + n)->socket != -1) {
    {
#line 243
    close((rem + n)->socket);
    }
  }
#line 245
  (rem + n)->socket = s;
#line 246
  (rem + n)->remote_id = (uint16_t )rnum;
#line 247
  return;
}
}
#line 253 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void send_server_fail(sockaddr_all_T *client , unsigned char *a , int len , int sock ,
                      int tcp_num ) 
{ 
  socklen_t c_len ;

  {
#line 255
  c_len = (socklen_t )sizeof(struct sockaddr_in );
#line 257
  if (len < 12) {
#line 258
    return;
  }
#line 262
  if ((int )client->u.v4.sin_family == 10) {
#line 263
    c_len = (socklen_t )sizeof(struct sockaddr_in6 );
  }
#line 265
  *(a + 2) = (unsigned char )((int )*(a + 2) | 128);
#line 266
  *(a + 3) = (unsigned char )((int )*(a + 3) & 240);
#line 266
  *(a + 3) = (unsigned char )((int )*(a + 3) | 2);
#line 268
  if (tcp_num == -1) {
    {
#line 269
    sendto(sock, (void const   *)((void *)a), (size_t )len, 0, (struct sockaddr  const  *)((struct sockaddr *)client),
           c_len);
    }
  }
#line 272
  return;
}
}
#line 279 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int find_inflight_query(unsigned char *a , int len ) 
{ 
  dw_str *query ;
  dw_str *answer ;
  int ret ;
  int tmp ;

  {
#line 280
  query = (dw_str *)0;
#line 280
  answer = (dw_str *)0;
#line 281
  ret = -1;
#line 283
  if (len < 12) {
#line 284
    goto catch_find_inflight_query;
  } else
#line 283
  if ((unsigned long )a == (unsigned long )((unsigned char *)0)) {
#line 284
    goto catch_find_inflight_query;
  } else
#line 283
  if (key_n[20] < 2) {
#line 284
    goto catch_find_inflight_query;
  }
  {
#line 287
  query = dw_get_dname_type(a, 12, len);
#line 288
  dwc_lower_case(query);
  }
#line 289
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 290
    goto catch_find_inflight_query;
  }
  {
#line 293
  answer = dwh_get(inflight, query, 0, 1);
  }
#line 294
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 295
    goto catch_find_inflight_query;
  }
  {
#line 298
  ret = dw_fetch_u16(answer, 0);
  }
#line 300
  if ((rem + ret)->socket == -1) {
#line 301
    ret = -1;
#line 302
    goto catch_find_inflight_query;
  }
  {
#line 305
  tmp = dw_issame(query, (rem + ret)->query);
  }
#line 305
  if (tmp != 1) {
    {
#line 306
    dwh_zap(inflight, query, (dw_element *)0, 1);
#line 307
    ret = -1;
    }
  }
  catch_find_inflight_query: 
#line 311
  if ((unsigned long )query != (unsigned long )((dw_str *)0)) {
    {
#line 312
    dw_destroy(query);
    }
  }
#line 314
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 315
    dw_destroy(answer);
    }
  }
#line 317
  return (ret);
}
}
#line 320 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void zap_inflight(dw_str *query ) 
{ 


  {
#line 321
  if (key_n[20] > 1) {
    {
#line 322
    dwh_zap(inflight, query, (dw_element *)0, 1);
    }
  }
#line 324
  return;
}
}
#line 327 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void make_new_udp_connect(int b , unsigned char *a , int len , int num_alloc ) 
{ 
  dw_str *answer ;
  dw_str *check ;
  int counter ;
  void *tmp ;

  {
#line 328
  answer = (dw_str *)0;
#line 328
  check = (dw_str *)0;
#line 329
  counter = 0;
#line 332
  if ((rem + b)->socket != -1) {
#line 333
    return;
  }
  {
#line 335
  (rem + b)->query = dw_get_dname_type(a, 12, len);
#line 336
  dwc_lower_case((rem + b)->query);
#line 337
  tmp = malloc((unsigned long )num_alloc * sizeof(local_T *));
#line 337
  (rem + b)->local = (local_T **)tmp;
  }
#line 338
  if ((unsigned long )(rem + b)->local == (unsigned long )((local_T **)0)) {
#line 339
    return;
  }
  {
#line 341
  make_remote_connection(b, a, len, (rem + b)->query, -1);
#line 343
  counter = 0;
  }
  {
#line 343
  while (1) {
    while_continue: /* CIL Label */ ;
#line 343
    if (! (counter < num_alloc)) {
#line 343
      goto while_break;
    }
#line 344
    *((rem + b)->local + counter) = (local_T *)0;
#line 343
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 346
  (rem + b)->num_locals = (uint16_t )1;
#line 347
  if (key_n[20] > 1) {
    {
#line 348
    answer = dw_create((uint32_t )3);
#line 349
    check = dwh_get(inflight, (rem + b)->query, 0, 1);
    }
#line 350
    if ((unsigned long )check == (unsigned long )((dw_str *)0)) {
      {
#line 351
      dw_put_u16(answer, (uint16_t )b, 0);
#line 352
      dwh_add(inflight, (rem + b)->query, answer, 120, 1);
      }
    } else {
      {
#line 354
      dw_destroy(check);
      }
    }
    {
#line 356
    dw_destroy(answer);
    }
  }
#line 358
  return;
}
}
#line 363 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int forward_local_udp_packet(int sock , int32_t local_id , ip_addr_T *from_ip , uint16_t from_port ,
                             unsigned char *a , int len , int tcp_num , dw_str *orig_query ) 
{ 
  int32_t b ;
  int num_alloc ;
  ip_addr_T null_addr ;
  unsigned int tmp ;
  void *tmp___0 ;

  {
#line 366
  b = 0;
#line 367
  num_alloc = 0;
#line 368
  null_addr.len = (uint8_t )0;
#line 368
  null_addr.ip[0] = (uint8_t )0;
#line 368
  null_addr.ip[1] = (uint8_t )0;
#line 368
  tmp = 2U;
  {
#line 368
  while (1) {
    while_continue: /* CIL Label */ ;
#line 368
    if (tmp >= 17U) {
#line 368
      goto while_break;
    }
#line 368
    null_addr.ip[tmp] = (unsigned char)0;
#line 368
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 368
  null_addr.glueless = (dw_str *)0;
#line 368
  null_addr.flags = (uint8_t )0;
#line 370
  num_alloc = key_n[20];
#line 371
  if (num_alloc < 1) {
#line 372
    num_alloc = 1;
  } else
#line 373
  if (num_alloc > 32000) {
#line 374
    num_alloc = 32000;
  }
  {
#line 376
  num_alloc ++;
#line 378
  b = find_inflight_query(a, len);
  }
#line 379
  if (b == -1) {
    {
#line 380
    b = find_free_remote();
    }
#line 381
    if (b == -1) {
#line 382
      return (-1);
    } else {
      {
#line 384
      reset_rem((int_fast32_t )b);
#line 385
      make_new_udp_connect(b, a, len, num_alloc);
      }
    }
  } else {
#line 388
    if ((int )(rem + b)->num_locals >= num_alloc - 2) {
#line 389
      return (-1);
    }
#line 391
    (rem + b)->num_locals = (uint16_t )((int )(rem + b)->num_locals + 1);
  }
  {
#line 398
  tmp___0 = malloc(sizeof(local_T ));
#line 398
  *((rem + b)->local + ((int )(rem + b)->num_locals - 1)) = (local_T *)tmp___0;
  }
#line 399
  if ((unsigned long )*((rem + b)->local + ((int )(rem + b)->num_locals - 1)) != (unsigned long )((local_T *)0)) {
#line 400
    (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->orig_query = (dw_str *)0;
#line 401
    (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->action = (dw_str *)0;
  }
#line 403
  if ((rem + b)->socket == -1) {
    {
#line 405
    reset_rem((int_fast32_t )b);
    }
#line 406
    return (-1);
  } else
#line 403
  if ((unsigned long )*((rem + b)->local + ((int )(rem + b)->num_locals - 1)) == (unsigned long )((local_T *)0)) {
    {
#line 405
    reset_rem((int_fast32_t )b);
    }
#line 406
    return (-1);
  }
#line 408
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->from_socket = sock;
#line 409
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->tcp_num = tcp_num;
#line 410
  if ((unsigned long )from_ip != (unsigned long )((ip_addr_T *)0)) {
#line 411
    (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->ip = *from_ip;
  } else {
#line 413
    (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->ip = null_addr;
  }
  {
#line 415
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->port = from_port;
#line 416
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->local_id = (uint16_t )local_id;
#line 417
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->glueless_type = (uint8_t )0;
#line 418
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->glueless_conn = -1;
#line 419
  (*((rem + b)->local + ((int )(rem + b)->num_locals - 1)))->orig_query = dw_substr(orig_query,
                                                                                    0,
                                                                                    -1,
                                                                                    -1);
#line 420
  (rem + b)->die = the_time + ((int64_t )timeout_seconds << 8);
  }
#line 421
  return (0);
}
}
#line 425 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
dw_str *make_dns_header(int32_t id , int16_t flags , int32_t ancount , int32_t nscount ,
                        int32_t arcount ) 
{ 
  dw_str *out ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
#line 427
  out = (dw_str *)0;
#line 429
  if (id < 0) {
#line 430
    return ((dw_str *)0);
  } else
#line 429
  if (ancount < 0) {
#line 430
    return ((dw_str *)0);
  } else
#line 429
  if (nscount < 0) {
#line 430
    return ((dw_str *)0);
  } else
#line 429
  if (arcount < 0) {
#line 430
    return ((dw_str *)0);
  }
  {
#line 434
  out = dw_create((uint32_t )515);
#line 437
  tmp = dw_put_u16(out, (uint16_t )id, -1);
  }
#line 437
  if (tmp == -1) {
#line 438
    goto catch_make_dns_header;
  }
  {
#line 442
  tmp___0 = dw_put_u16(out, (uint16_t )flags, -1);
  }
#line 442
  if (tmp___0 == -1) {
#line 443
    goto catch_make_dns_header;
  }
  {
#line 447
  tmp___1 = dw_put_u16(out, (uint16_t )1, -1);
  }
#line 447
  if (tmp___1 == -1) {
#line 448
    goto catch_make_dns_header;
  }
  {
#line 452
  tmp___2 = dw_put_u16(out, (uint16_t )ancount, -1);
  }
#line 452
  if (tmp___2 == -1) {
#line 455
    goto catch_make_dns_header;
  } else {
    {
#line 452
    tmp___3 = dw_put_u16(out, (uint16_t )nscount, -1);
    }
#line 452
    if (tmp___3 == -1) {
#line 455
      goto catch_make_dns_header;
    } else {
      {
#line 452
      tmp___4 = dw_put_u16(out, (uint16_t )arcount, -1);
      }
#line 452
      if (tmp___4 == -1) {
#line 455
        goto catch_make_dns_header;
      }
    }
  }
#line 458
  return (out);
  catch_make_dns_header: 
#line 461
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 462
    dw_destroy(out);
#line 463
    out = (dw_str *)0;
    }
  }
#line 465
  return ((dw_str *)0);
}
}
#line 471 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
dw_str *make_dns_packet(dw_str *question , dw_str *answer , int32_t id ) 
{ 
  int32_t ancount ;
  int32_t nscount ;
  int32_t arcount ;
  int is_nxdomain ;
  dw_str *out ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 472
  ancount = 0;
#line 472
  nscount = 0;
#line 472
  arcount = 0;
#line 473
  is_nxdomain = 0;
#line 474
  out = (dw_str *)0;
#line 476
  is_nxdomain = dw_pop_u8(answer);
  }
#line 477
  if (is_nxdomain != 3) {
#line 477
    if (is_nxdomain != 4) {
      {
#line 479
      arcount = dw_pop_u16(answer);
#line 480
      nscount = dw_pop_u16(answer);
#line 481
      ancount = dw_pop_u16(answer);
      }
    }
  }
#line 484
  if (is_nxdomain == 0) {
    {
#line 487
    out = make_dns_header(id, (int16_t )33152, ancount, nscount, arcount);
    }
  } else
#line 484
  if (is_nxdomain == 2) {
    {
#line 487
    out = make_dns_header(id, (int16_t )33152, ancount, nscount, arcount);
    }
  } else
#line 488
  if (is_nxdomain == 1) {
    {
#line 490
    out = make_dns_header(id, (int16_t )33155, ancount, nscount, arcount);
    }
  } else
#line 491
  if (is_nxdomain == 3) {
    {
#line 493
    out = make_dns_header(id, (int16_t )33664, 0, 0, 0);
    }
  } else
#line 494
  if (is_nxdomain == 4) {
    {
#line 496
    out = make_dns_header(id, (int16_t )33667, 0, 0, 0);
    }
  } else {
#line 498
    goto catch_make_dns_packet;
  }
  {
#line 501
  tmp = dw_append(question, out);
  }
#line 501
  if (tmp == -1) {
#line 503
    goto catch_make_dns_packet;
  } else {
    {
#line 501
    tmp___0 = dw_put_u16(out, (uint16_t )1, -1);
    }
#line 501
    if (tmp___0 == -1) {
#line 503
      goto catch_make_dns_packet;
    }
  }
#line 505
  if (is_nxdomain != 3) {
#line 505
    if (is_nxdomain != 4) {
      {
#line 505
      tmp___1 = dw_append(answer, out);
      }
#line 505
      if (tmp___1 == -1) {
#line 508
        goto catch_make_dns_packet;
      }
    }
  }
#line 511
  return (out);
  catch_make_dns_packet: 
#line 514
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 515
    dw_destroy(out);
#line 516
    out = (dw_str *)0;
    }
  }
#line 518
  return ((dw_str *)0);
}
}
#line 523 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int get_reply_from_cache(dw_str *query , sockaddr_all_T *client , int sock , int32_t id ,
                         int resurrect , int tcp_num , dw_str *orig_query , ip_addr_T *from_ip ) 
{ 
  dw_str *value___6 ;
  dw_str *comp ;
  dw_str *packet ;
  socklen_t c_len ;
  int ret ;
  int type ;
  int cache_type ;

  {
#line 527
  value___6 = (dw_str *)0;
#line 528
  comp = (dw_str *)0;
#line 529
  packet = (dw_str *)0;
#line 530
  c_len = (socklen_t )sizeof(struct sockaddr_in );
#line 531
  ret = -1;
#line 531
  type = 0;
#line 531
  cache_type = 0;
#line 533
  if ((unsigned long )client == (unsigned long )((sockaddr_all_T *)0)) {
#line 534
    goto catch_get_reply_from_cache;
  }
#line 538
  if ((int )client->u.v4.sin_family == 10) {
#line 539
    c_len = (socklen_t )sizeof(struct sockaddr_in6 );
  }
  {
#line 543
  dw_log_dwstr((char *)"Looking in cache for query ", query, 100);
#line 544
  type = dw_fetch_u16(query, -1);
  }
#line 545
  if (type == 15) {
#line 545
    if (key_n[25] != 0) {
      {
#line 546
      dw_log_ip((char *)"Attempt to get MX record (possible spam zombie) from IP",
                from_ip, 3);
      }
#line 548
      return (1);
    }
  }
  {
#line 550
  dwc_process(cache, query, (uint8_t )3);
#line 551
  value___6 = dwh_get(cache, query, resurrect, 1);
  }
#line 552
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
    {
#line 553
    dw_log_dwstr((char *)"Nothing found for ", query, 100);
    }
#line 554
    goto catch_get_reply_from_cache;
  }
  {
#line 556
  cache_type = dw_fetch_u8(value___6, -1);
  }
#line 557
  if (cache_type != 3) {
#line 557
    if (cache_type != 4) {
      {
#line 559
      comp = dwc_compress(query, value___6);
      }
    } else {
#line 557
      goto _L;
    }
  } else {
    _L: /* CIL Label */ 
    {
#line 562
    dwh_zap(cache, query, (dw_element *)0, 1);
    }
#line 563
    if ((unsigned long )client == (unsigned long )((sockaddr_all_T *)0)) {
#line 564
      ret = 2;
#line 565
      goto catch_get_reply_from_cache;
    }
    {
#line 567
    comp = dw_substr(value___6, 0, -1, -1);
    }
  }
#line 570
  if ((unsigned long )comp == (unsigned long )((dw_str *)0)) {
#line 571
    goto catch_get_reply_from_cache;
  }
#line 574
  if (comp->len == 7U) {
    {
#line 575
    dw_log_string((char *)"Warning: Removing empty packet from cache", 11);
#line 576
    dwh_zap(cache, query, (dw_element *)0, 1);
    }
#line 577
    goto catch_get_reply_from_cache;
  }
  {
#line 580
  dw_log_dwstr_str((char *)"Fetching ", query, (char *)" from cache", 100);
#line 581
  packet = make_dns_packet(orig_query, comp, id);
  }
#line 582
  if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
#line 583
    goto catch_get_reply_from_cache;
  }
#line 586
  if (tcp_num == -1) {
    {
#line 587
    sendto(sock, (void const   *)((void *)packet->str), (size_t )packet->len, 0, (struct sockaddr  const  *)((struct sockaddr *)client),
           c_len);
    }
  } else
#line 589
  if (key_n[17] == 1) {
    {
#line 590
    tcp_return_reply(tcp_num, (char *)((void *)packet->str), (int )packet->len);
    }
  }
#line 593
  ret = 1;
  catch_get_reply_from_cache: 
#line 596
  if ((unsigned long )value___6 != (unsigned long )((dw_str *)0)) {
    {
#line 597
    dw_destroy(value___6);
    }
  }
#line 599
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 600
    dw_destroy(packet);
    }
  }
#line 602
  if ((unsigned long )comp != (unsigned long )((dw_str *)0)) {
    {
#line 603
    dw_destroy(comp);
    }
  }
#line 605
  return (ret);
}
}
#line 611 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void try_forward_local_udp_packet(int sock , int32_t local_id , ip_addr_T *from_ip ,
                                  uint16_t from_port , unsigned char *packet , int len ,
                                  sockaddr_all_T *client , dw_str *query , int tcp_num ,
                                  dw_str *orig_query ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 618
  tmp = forward_local_udp_packet(sock, local_id, from_ip, from_port, packet, len,
                                 tcp_num, orig_query);
  }
#line 618
  if (tmp != -1) {
#line 620
    return;
  }
#line 625
  if (resurrections == 1) {
    {
#line 625
    tmp___0 = get_reply_from_cache(query, client, sock, local_id, 1, tcp_num, orig_query,
                                   from_ip);
    }
#line 625
    if (tmp___0 == 1) {
      {
#line 628
      dw_log_string((char *)"Resurrected from cache", 11);
      }
#line 629
      return;
    }
  }
#line 632
  if (handle_overload == 1) {
    {
#line 633
    send_server_fail(client, packet, len, sock, tcp_num);
    }
  }
#line 635
  return;
}
}
#line 638 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void get_local_udp_packet(int sock ) 
{ 
  unsigned char packet[522] ;
  int len ;
  sockaddr_all_T client ;
  socklen_t c_len ;
  ip_addr_T from_ip ;
  unsigned int tmp ;
  uint16_t from_port ;
  int32_t local_id ;
  dw_str *query ;
  dw_str *orig_query ;
  int_fast32_t qtype ;
  ssize_t tmp___0 ;
  int tmp___1 ;
  int32_t tmp___2 ;
  unsigned char *answer ;
  unsigned char tmp___3 ;
  unsigned char tmp___4 ;
  unsigned char tmp___5 ;
  unsigned char tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;

  {
#line 640
  len = 0;
#line 642
  c_len = (socklen_t )0;
#line 643
  from_ip.len = (uint8_t )0;
#line 643
  from_ip.ip[0] = (uint8_t )0;
#line 643
  from_ip.ip[1] = (uint8_t )0;
#line 643
  tmp = 2U;
  {
#line 643
  while (1) {
    while_continue: /* CIL Label */ ;
#line 643
    if (tmp >= 17U) {
#line 643
      goto while_break;
    }
#line 643
    from_ip.ip[tmp] = (unsigned char)0;
#line 643
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 643
  from_ip.glueless = (dw_str *)0;
#line 643
  from_ip.flags = (uint8_t )0;
#line 644
  from_port = (uint16_t )0;
#line 645
  local_id = -1;
#line 646
  query = (dw_str *)0;
#line 646
  orig_query = (dw_str *)0;
#line 647
  qtype = (int_fast32_t )0;
#line 652
  c_len = (socklen_t )sizeof(client);
#line 653
  fcntl(sock, 4, 2048);
#line 654
  tmp___0 = recvfrom(sock, (void */* __restrict  */)((void *)(packet)), (size_t )520,
                     0, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& client)),
                     (socklen_t */* __restrict  */)(& c_len));
#line 654
  len = (int )tmp___0;
  }
#line 657
  if (len < 12) {
#line 658
    goto catch_get_local_udp_packet;
  }
  {
#line 661
  from_port = get_from_ip_port(& from_ip, & client);
#line 663
  tmp___1 = check_ip_acl(& from_ip);
  }
#line 663
  if (tmp___1 != 1) {
#line 664
    goto catch_get_local_udp_packet;
  }
  {
#line 667
  local_id = get_dns_qid(packet, len, 2);
  }
#line 668
  if (local_id == -2) {
    {
#line 676
    query = dw_get_dname_type(packet, 12, len);
    }
#line 677
    if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 678
      goto catch_get_local_udp_packet;
    }
    {
#line 680
    len = (int )(query->len + 14U);
#line 681
    packet[11] = (unsigned char)0;
#line 682
    dw_destroy(query);
#line 683
    local_id = get_dns_qid(packet, len, 2);
    }
  }
#line 686
  if (local_id < 0) {
#line 687
    goto catch_get_local_udp_packet;
  } else
#line 686
  if (len < 13) {
#line 687
    goto catch_get_local_udp_packet;
  }
  {
#line 692
  query = dw_get_dname_type(packet, 12, len);
#line 693
  tmp___2 = dw_fetch_u16(query, -1);
#line 693
  qtype = (int_fast32_t )tmp___2;
  }
#line 696
  if (qtype == 28L) {
#line 696
    if (key_n[24] == 1) {
#line 696
      goto _L;
    } else {
#line 696
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 696
  if (qtype == 12L) {
#line 696
    if (key_n[27] == 1) {
      _L: /* CIL Label */ 
      {
#line 699
      answer = make_synth_not_there_answer(packet, & len, 0);
#line 702
      *(answer + 2) = (unsigned char )((int )*(answer + 2) | 128);
#line 705
      *(answer + 3) = (unsigned char )((int )*(answer + 3) | 128);
#line 708
      *(answer + 9) = (unsigned char)1;
#line 709
      tmp___6 = (unsigned char)0;
#line 709
      *(answer + 11) = tmp___6;
#line 709
      tmp___5 = tmp___6;
#line 709
      *(answer + 10) = tmp___5;
#line 709
      tmp___4 = tmp___5;
#line 709
      *(answer + 8) = tmp___4;
#line 709
      tmp___3 = tmp___4;
#line 709
      *(answer + 7) = tmp___3;
#line 709
      *(answer + 6) = tmp___3;
#line 711
      sendto(sock, (void const   *)((void *)answer), (size_t )(len + 40), 0, (struct sockaddr  const  *)((struct sockaddr *)(& client)),
             c_len);
#line 713
      free((void *)answer);
      }
#line 714
      goto catch_get_local_udp_packet;
    }
  }
  {
#line 717
  orig_query = dw_substr(query, 0, -1, -1);
#line 718
  dwc_lower_case(query);
#line 719
  dw_log_dwstr((char *)"Got DNS query for ", query, 100);
  }
#line 720
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 721
    goto catch_get_local_udp_packet;
  }
  {
#line 723
  tmp___7 = get_reply_from_cache(query, & client, sock, local_id, 0, -1, orig_query,
                                 & from_ip);
  }
#line 723
  if (tmp___7 == 1) {
#line 725
    goto catch_get_local_udp_packet;
  }
  {
#line 727
  tmp___8 = dwx_cname_in_cache(orig_query, query, & client, & from_ip, local_id, sock,
                               from_port);
  }
#line 727
  if (tmp___8 == 1) {
#line 729
    goto catch_get_local_udp_packet;
  }
  {
#line 733
  try_forward_local_udp_packet(sock, local_id, & from_ip, from_port, packet, len,
                               & client, query, -1, orig_query);
  }
  catch_get_local_udp_packet: 
#line 738
  if ((unsigned long )query != (unsigned long )((dw_str *)0)) {
    {
#line 739
    dw_destroy(query);
#line 740
    query = (dw_str *)0;
    }
  }
#line 742
  if ((unsigned long )orig_query != (unsigned long )((dw_str *)0)) {
    {
#line 743
    dw_destroy(orig_query);
#line 744
    query = (dw_str *)0;
    }
  }
#line 746
  return;
}
}
#line 749 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void forward_remote_reply(unsigned char *packet , size_t len , remote_T *r_ip , int local_num ) 
{ 
  sockaddr_all_T client ;
  socklen_t len_inet ;

  {
#line 752
  len_inet = (socklen_t )0;
#line 754
  if ((unsigned long )r_ip == (unsigned long )((remote_T *)0)) {
#line 755
    return;
  }
#line 757
  if ((*(r_ip->local + local_num))->from_socket == -1) {
#line 759
    return;
  } else
#line 757
  if ((int )(*(r_ip->local + local_num))->glueless_type != 0) {
#line 759
    return;
  }
  {
#line 761
  memset((void *)(& client), 0, sizeof(client));
#line 762
  len_inet = (socklen_t )sizeof(client);
  }
#line 764
  if ((int )(*(r_ip->local + local_num))->ip.len == 4) {
    {
#line 765
    client.u.v4.sin_family = (sa_family_t )2;
#line 766
    client.u.v4.sin_port = htons((*(r_ip->local + local_num))->port);
#line 767
    memcpy((void */* __restrict  */)(& client.u.v4.sin_addr), (void const   */* __restrict  */)((*(r_ip->local + local_num))->ip.ip),
           (size_t )4);
#line 768
    len_inet = (socklen_t )sizeof(struct sockaddr_in );
    }
  } else
#line 770
  if ((int )(*(r_ip->local + local_num))->ip.len == 16) {
    {
#line 771
    client.u.v6.sin6_family = (sa_family_t )10;
#line 772
    client.u.v6.sin6_port = htons((*(r_ip->local + local_num))->port);
#line 773
    memcpy((void */* __restrict  */)(& client.u.v6.sin6_addr), (void const   */* __restrict  */)((*(r_ip->local + local_num))->ip.ip),
           (size_t )16);
#line 775
    len_inet = (socklen_t )sizeof(struct sockaddr_in6 );
    }
  } else {
#line 778
    return;
  }
  {
#line 780
  sendto((*(r_ip->local + local_num))->from_socket, (void const   *)((void *)packet),
         len, 0, (struct sockaddr  const  *)((struct sockaddr *)(& client)), len_inet);
#line 787
  (*(r_ip->local + local_num))->from_socket = -1;
  }
#line 788
  return;
}
}
#line 792 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int cache_dns_reply(unsigned char *packet , int count , int b , int truncated ) 
{ 
  int32_t ttl ;
  int32_t ancount ;
  int is_nxdomain ;
  dw_str *question ;
  dw_str *answer ;
  dw_str *decomp ;
  int ret ;
  int qtype ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 793
  ttl = 60;
#line 794
  ancount = 0;
#line 795
  is_nxdomain = 0;
#line 796
  question = (dw_str *)0;
#line 796
  answer = (dw_str *)0;
#line 797
  decomp = (dw_str *)0;
#line 798
  ret = -1;
#line 798
  qtype = -1;
#line 800
  question = dw_get_dname_type(packet, 12, count);
#line 801
  dwc_lower_case(question);
#line 802
  qtype = dw_fetch_u16(question, -1);
#line 803
  dw_log_dwstr((char *)"Caching a reply for query ", question, 1000);
  }
#line 804
  if (((int )*(packet + 3) & 15) == 2) {
#line 805
    ret = -1;
#line 806
    goto catch_cache_dns_reply;
  } else
#line 807
  if (((int )*(packet + 3) & 15) == 3) {
#line 808
    is_nxdomain = 1;
  }
#line 810
  if (truncated == 1) {
    {
#line 811
    is_nxdomain += 3;
#line 812
    answer = dw_create((uint32_t )2);
#line 813
    tmp = dw_put_u8(answer, (uint8_t )is_nxdomain, 0);
    }
#line 813
    if (tmp == -1) {
#line 814
      goto catch_cache_dns_reply;
    }
    {
#line 816
    dwh_add(cache, question, answer, 7, 1);
#line 817
    ret = 1;
    }
  } else {
    {
#line 819
    answer = dw_packet_to_cache(packet, count, (uint8_t )is_nxdomain);
#line 820
    decomp = dwc_decompress(question, answer);
    }
#line 821
    if ((unsigned long )decomp == (unsigned long )((dw_str *)0)) {
#line 822
      goto catch_cache_dns_reply;
    }
    {
#line 824
    tmp___0 = dwc_has_bad_ip(decomp, blacklist_dict);
    }
#line 824
    if (tmp___0) {
#line 825
      ret = -2;
#line 826
      goto catch_cache_dns_reply;
    }
    {
#line 828
    ancount = dw_cachepacket_to_ancount(answer);
    }
#line 829
    if (ancount == 0) {
#line 830
      ancount = 32;
    }
#line 833
    if ((unsigned long )question == (unsigned long )((dw_str *)0)) {
#line 834
      goto catch_cache_dns_reply;
    } else
#line 833
    if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 834
      goto catch_cache_dns_reply;
    } else
#line 833
    if (ancount == -1) {
#line 834
      goto catch_cache_dns_reply;
    }
    {
#line 837
    ttl = dw_get_a_dnsttl(answer, 0, 31536000, ancount);
    }
#line 838
    if (ttl == -1) {
#line 838
      if ((unsigned long )decomp != (unsigned long )((dw_str *)0)) {
#line 838
        if (decomp->len == 7U) {
#line 839
          ttl = 30;
        }
      }
    }
#line 841
    if (ttl == -1) {
#line 842
      goto catch_cache_dns_reply;
    }
#line 844
    if (ttl < 30) {
#line 845
      ttl = 30;
    }
#line 847
    if (ttl > max_ttl) {
#line 848
      ttl = max_ttl;
    }
    {
#line 855
    ret = dwx_cache_reply(cache, question, decomp, ttl, b);
    }
  }
  catch_cache_dns_reply: 
#line 859
  if ((unsigned long )question != (unsigned long )((dw_str *)0)) {
    {
#line 860
    dw_destroy(question);
    }
  }
#line 862
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 863
    dw_destroy(answer);
    }
  }
#line 865
  if ((unsigned long )decomp != (unsigned long )((dw_str *)0)) {
    {
#line 866
    dw_destroy(decomp);
    }
  }
#line 868
  return (ret);
}
}
#line 873 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int verify_dns_packet(int b , unsigned char *packet , int len ) 
{ 
  int ret ;
  dw_str *question ;
  int32_t tmp ;
  int tmp___0 ;

  {
  {
#line 874
  ret = 0;
#line 875
  question = (dw_str *)0;
#line 879
  tmp = get_dns_qid(packet, len, 0);
  }
#line 879
  if (tmp != (int32_t )(rem + b)->remote_id) {
#line 880
    goto catch_verify_dns_packet;
  }
  {
#line 883
  question = dw_get_dname_type(packet, 12, len);
  }
#line 884
  if ((unsigned long )question == (unsigned long )((dw_str *)0)) {
#line 885
    goto catch_verify_dns_packet;
  }
  {
#line 888
  dwc_lower_case(question);
#line 889
  tmp___0 = dw_issame(question, (rem + b)->query);
  }
#line 889
  if (tmp___0 != 1) {
#line 890
    goto catch_verify_dns_packet;
  }
#line 893
  ret = 1;
  catch_verify_dns_packet: 
#line 896
  if ((unsigned long )question != (unsigned long )((dw_str *)0)) {
    {
#line 897
    dw_destroy(question);
#line 898
    question = (dw_str *)0;
    }
  }
#line 900
  return (ret);
}
}
#line 904 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
unsigned char *make_synth_not_there_answer(unsigned char *a , int *count , int type ) 
{ 
  unsigned char not_there[41] ;
  unsigned char *answer ;
  int counter ;
  void *tmp ;

  {
  {
#line 907
  not_there[0] = (unsigned char )'\300';
#line 907
  not_there[1] = (unsigned char )'\f';
#line 907
  not_there[2] = (unsigned char )'\000';
#line 907
  not_there[3] = (unsigned char )'\006';
#line 907
  not_there[4] = (unsigned char )'\000';
#line 907
  not_there[5] = (unsigned char )'\001';
#line 907
  not_there[6] = (unsigned char )'\000';
#line 907
  not_there[7] = (unsigned char )'\000';
#line 907
  not_there[8] = (unsigned char )'\000';
#line 907
  not_there[9] = (unsigned char )'\000';
#line 907
  not_there[10] = (unsigned char )'\000';
#line 907
  not_there[11] = (unsigned char )'\034';
#line 907
  not_there[12] = (unsigned char )'\001';
#line 907
  not_there[13] = (unsigned char )'z';
#line 907
  not_there[14] = (unsigned char )'\300';
#line 907
  not_there[15] = (unsigned char )'\f';
#line 907
  not_there[16] = (unsigned char )'\001';
#line 907
  not_there[17] = (unsigned char )'y';
#line 907
  not_there[18] = (unsigned char )'\300';
#line 907
  not_there[19] = (unsigned char )'\f';
#line 907
  not_there[20] = (unsigned char )'\000';
#line 907
  not_there[21] = (unsigned char )'\000';
#line 907
  not_there[22] = (unsigned char )'\000';
#line 907
  not_there[23] = (unsigned char )'\001';
#line 907
  not_there[24] = (unsigned char )'\000';
#line 907
  not_there[25] = (unsigned char )'\000';
#line 907
  not_there[26] = (unsigned char )'\000';
#line 907
  not_there[27] = (unsigned char )'\001';
#line 907
  not_there[28] = (unsigned char )'\000';
#line 907
  not_there[29] = (unsigned char )'\000';
#line 907
  not_there[30] = (unsigned char )'\000';
#line 907
  not_there[31] = (unsigned char )'\001';
#line 907
  not_there[32] = (unsigned char )'\000';
#line 907
  not_there[33] = (unsigned char )'\000';
#line 907
  not_there[34] = (unsigned char )'\000';
#line 907
  not_there[35] = (unsigned char )'\001';
#line 907
  not_there[36] = (unsigned char )'\000';
#line 907
  not_there[37] = (unsigned char )'\000';
#line 907
  not_there[38] = (unsigned char )'\000';
#line 907
  not_there[39] = (unsigned char )'\001';
#line 907
  not_there[40] = (unsigned char )'\000';
#line 916
  answer = (unsigned char *)0;
#line 917
  counter = 0;
#line 919
  tmp = malloc((size_t )(*count + 43));
#line 919
  answer = (unsigned char *)tmp;
  }
#line 920
  if ((unsigned long )answer == (unsigned long )((unsigned char *)0)) {
#line 921
    return ((unsigned char *)0);
  }
#line 924
  if (type == 1) {
#line 925
    counter = 0;
    {
#line 925
    while (1) {
      while_continue: /* CIL Label */ ;
#line 925
      if (! (counter < 40)) {
#line 925
        goto while_break;
      }
#line 926
      *(answer + counter) = not_there[counter];
#line 925
      counter ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 928
    return (answer);
  }
#line 932
  counter = 0;
  {
#line 932
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 932
    if (counter < 12) {
#line 932
      if (! (counter < *count)) {
#line 932
        goto while_break___0;
      }
    } else {
#line 932
      goto while_break___0;
    }
#line 933
    *(answer + counter) = *(a + counter);
#line 932
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 937
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 937
    if (counter < 520) {
#line 937
      if (! (counter < *count)) {
#line 937
        goto while_break___1;
      }
    } else {
#line 937
      goto while_break___1;
    }
#line 938
    if ((int )*(a + counter) == 0) {
#line 939
      goto while_break___1;
    }
#line 943
    *(answer + counter) = *(a + counter);
#line 937
    counter ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 945
  if (*count < counter + 5) {
    {
#line 946
    free((void *)answer);
    }
#line 947
    return ((unsigned char *)0);
  } else
#line 945
  if (counter > 512) {
    {
#line 946
    free((void *)answer);
    }
#line 947
    return ((unsigned char *)0);
  }
#line 951
  *count = counter + 5;
  {
#line 952
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 952
    if (! (counter < *count)) {
#line 952
      goto while_break___2;
    }
#line 953
    *(answer + counter) = *(a + counter);
#line 952
    counter ++;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 957
  counter = 0;
  {
#line 957
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 957
    if (! (counter < 40)) {
#line 957
      goto while_break___3;
    }
#line 958
    *(answer + (*count + counter)) = not_there[counter];
#line 957
    counter ++;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 962
  return (answer);
}
}
#line 966 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void make_synth_not_there(int b , int sock , unsigned char *a , int count ) 
{ 
  unsigned char *answer ;
  int local_num ;
  unsigned char tmp ;
  unsigned char tmp___0 ;
  unsigned char tmp___1 ;
  unsigned char tmp___2 ;

  {
#line 967
  answer = (unsigned char *)0;
#line 968
  local_num = 0;
#line 970
  if ((unsigned long )a == (unsigned long )((unsigned char *)0)) {
#line 971
    return;
  } else
#line 970
  if (count < 12) {
#line 971
    return;
  } else
#line 970
  if ((unsigned long )(rem + b)->local == (unsigned long )((local_T **)0)) {
#line 971
    return;
  }
  {
#line 975
  answer = make_synth_not_there_answer(a, & count, 0);
  }
#line 976
  if ((unsigned long )answer == (unsigned long )((unsigned char *)0)) {
#line 977
    return;
  }
#line 981
  *(answer + 2) = (unsigned char )((int )*(answer + 2) | 128);
#line 984
  *(answer + 9) = (unsigned char)1;
#line 985
  tmp___2 = (unsigned char)0;
#line 985
  *(answer + 11) = tmp___2;
#line 985
  tmp___1 = tmp___2;
#line 985
  *(answer + 10) = tmp___1;
#line 985
  tmp___0 = tmp___1;
#line 985
  *(answer + 8) = tmp___0;
#line 985
  tmp = tmp___0;
#line 985
  *(answer + 7) = tmp;
#line 985
  *(answer + 6) = tmp;
#line 988
  local_num = 0;
  {
#line 988
  while (1) {
    while_continue: /* CIL Label */ ;
#line 988
    if (! (local_num < (int )(rem + b)->num_locals)) {
#line 988
      goto while_break;
    }
#line 989
    if ((int )(*((rem + b)->local + local_num))->glueless_type != 0) {
#line 990
      goto __Cont;
    }
#line 993
    *(answer + 0) = (unsigned char )(((int )(*((rem + b)->local + local_num))->local_id >> 8) & 255);
#line 994
    *(answer + 1) = (unsigned char )((int )(*((rem + b)->local + local_num))->local_id & 255);
#line 996
    if ((*((rem + b)->local + local_num))->tcp_num == -1) {
      {
#line 997
      forward_remote_reply(answer, (size_t )(count + 40), rem + b, local_num);
      }
    } else {
      {
#line 1000
      tcp_return_reply((*((rem + b)->local + local_num))->tcp_num, (char *)((void *)answer),
                       count);
      }
    }
    __Cont: /* CIL Label */ 
#line 988
    local_num ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1006
  close(*(b_remote + b));
#line 1007
  *(b_remote + b) = -1;
#line 1008
  reset_rem((int_fast32_t )b);
#line 1011
  free((void *)answer);
  }
#line 1012
  return;
}
}
#line 1022 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int send_reply_from_cache(unsigned char *a , ssize_t count , int b , int l ) 
{ 
  dw_str *query ;
  sockaddr_all_T client ;
  int conn_num ;
  int ret ;

  {
  {
#line 1023
  query = (dw_str *)0;
#line 1025
  conn_num = 0;
#line 1026
  ret = 1;
#line 1028
  query = dw_get_dname_type(a, 12, (int )count);
  }
#line 1029
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 1030
    goto catch_send_reply_from_cache;
  } else
#line 1029
  if ((unsigned long )(rem + b)->local == (unsigned long )((local_T **)0)) {
#line 1030
    goto catch_send_reply_from_cache;
  } else
#line 1029
  if ((unsigned long )*((rem + b)->local + l) == (unsigned long )((local_T *)0)) {
#line 1030
    goto catch_send_reply_from_cache;
  }
  {
#line 1032
  memset((void *)(& client), 0, sizeof(client));
  }
#line 1033
  if ((int )(*((rem + b)->local + l))->glueless_type != 0) {
#line 1034
    conn_num = (*((rem + b)->local + l))->glueless_conn;
#line 1035
    if ((int )(*((rem + b)->local + l))->glueless_type == 1) {
#line 1036
      if ((rem + conn_num)->child_id == b) {
        {
#line 1037
        dwx_glueless_done(query, conn_num);
        }
      }
#line 1039
      ret = 4;
    } else
#line 1040
    if ((int )(*((rem + b)->local + l))->glueless_type == 2) {
      {
#line 1041
      dwx_incomplete_cname_done(query, b, l);
#line 1042
      ret = 4;
      }
    } else
#line 1043
    if ((int )(*((rem + b)->local + l))->glueless_type == 3) {
      {
#line 1044
      dwx_cached_cname_done(query, b, l, 0);
#line 1045
      ret = 4;
      }
    }
#line 1047
    goto catch_send_reply_from_cache;
  } else
#line 1048
  if ((int )(*((rem + b)->local + l))->ip.len == 4) {
    {
#line 1049
    client.u.v4.sin_family = (sa_family_t )2;
#line 1050
    client.u.v4.sin_port = htons((*((rem + b)->local + l))->port);
#line 1051
    memcpy((void */* __restrict  */)(& client.u.v4.sin_addr), (void const   */* __restrict  */)((*((rem + b)->local + l))->ip.ip),
           (size_t )4);
    }
  } else
#line 1053
  if ((int )(*((rem + b)->local + l))->ip.len == 16) {
    {
#line 1054
    client.u.v6.sin6_family = (sa_family_t )10;
#line 1055
    client.u.v6.sin6_port = htons((*((rem + b)->local + l))->port);
#line 1056
    memcpy((void */* __restrict  */)(& client.u.v6.sin6_addr), (void const   */* __restrict  */)((*((rem + b)->local + l))->ip.ip),
           (size_t )16);
    }
  } else {
#line 1060
    ret = 1;
#line 1061
    goto catch_send_reply_from_cache;
  }
  {
#line 1064
  get_reply_from_cache(query, & client, (*((rem + b)->local + l))->from_socket, (int32_t )(*((rem + b)->local + l))->local_id,
                       0, -1, (*((rem + b)->local + l))->orig_query, (ip_addr_T *)0);
  }
  catch_send_reply_from_cache: 
#line 1069
  if ((unsigned long )query != (unsigned long )((dw_str *)0)) {
    {
#line 1070
    dw_destroy(query);
    }
  }
#line 1072
  return (ret);
}
}
#line 1077 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
int get_rem_udp_packet_core(unsigned char *a , ssize_t count , int b , int sock ,
                            int l ) 
{ 
  int cache_dns_reply_return_value ;
  int z ;
  int y ;
  int x ;
  unsigned char tmp ;
  unsigned char tmp___0 ;
  unsigned char tmp___1 ;
  unsigned char tmp___2 ;
  int tmp___3 ;

  {
#line 1080
  cache_dns_reply_return_value = -1;
#line 1081
  z = 0;
#line 1081
  y = 0;
#line 1081
  x = 0;
#line 1083
  if (count < 12L) {
#line 1084
    return (-1);
  }
#line 1087
  if ((unsigned long )*((rem + b)->local + l) == (unsigned long )((local_T *)0)) {
#line 1088
    return (-1);
  }
#line 1093
  if (((int )*(a + 2) & 2) != 0) {
#line 1093
    if ((int )*(a + 7) > 0) {
#line 1093
      if (key_n[26] == 1) {
#line 1095
        tmp___2 = (unsigned char)0;
#line 1095
        *(a + 11) = tmp___2;
#line 1095
        tmp___1 = tmp___2;
#line 1095
        *(a + 10) = tmp___1;
#line 1095
        tmp___0 = tmp___1;
#line 1095
        *(a + 9) = tmp___0;
#line 1095
        tmp = tmp___0;
#line 1095
        *(a + 8) = tmp;
#line 1095
        *(a + 6) = tmp;
#line 1096
        *(a + 7) = (unsigned char)1;
#line 1098
        z = 12;
        {
#line 1098
        while (1) {
          while_continue: /* CIL Label */ ;
#line 1098
          if (! ((ssize_t )z < count)) {
#line 1098
            goto while_break;
          }
#line 1099
          if (y == 0) {
#line 1100
            y = 1;
#line 1101
            x = (int )*(a + z);
#line 1102
            if (x > 63) {
#line 1103
              return (-1);
            }
#line 1105
            if (x == 0) {
#line 1106
              x = 4;
#line 1107
              y = 7;
            }
          } else
#line 1109
          if (y == 1) {
#line 1110
            x --;
#line 1111
            if (x == 0) {
#line 1112
              y = 0;
            }
          } else
#line 1114
          if (y == 7) {
#line 1115
            x --;
#line 1116
            if (x == 0) {
#line 1117
              y = 2;
            }
          } else
#line 1119
          if (y == 2) {
#line 1120
            if ((int )*(a + z) != 192) {
#line 1121
              return (-1);
            }
#line 1123
            y = 3;
          } else
#line 1124
          if (y == 3) {
#line 1125
            if ((int )*(a + z) != 12) {
#line 1126
              return (-1);
            }
#line 1128
            y = 4;
#line 1129
            x = 8;
          } else
#line 1130
          if (y == 4) {
#line 1131
            x --;
#line 1132
            if (x == 0) {
#line 1133
              y = 5;
            }
          } else
#line 1135
          if (y == 5) {
#line 1136
            if ((int )*(a + z) != 0) {
#line 1137
              return (-1);
            }
#line 1139
            y = 6;
          } else
#line 1140
          if (y == 6) {
#line 1141
            if ((ssize_t )((z + (int )*(a + z)) + 1) > count) {
#line 1142
              return (-1);
            }
#line 1144
            count = (ssize_t )((z + (int )*(a + z)) + 1);
#line 1145
            y = 8;
          }
#line 1098
          z ++;
        }
        while_break: /* CIL Label */ ;
        }
#line 1148
        *(a + 2) = (unsigned char )((int )*(a + 2) & 253);
      }
    }
  }
#line 1151
  if (((int )*(a + 2) & 2) == 0) {
    {
#line 1152
    fflush(stdout);
#line 1153
    cache_dns_reply_return_value = cache_dns_reply(a, (int )count, b, 0);
    }
#line 1154
    if (cache_dns_reply_return_value == -2) {
      {
#line 1155
      make_synth_not_there(b, sock, a, (int )count);
      }
#line 1156
      return (-1);
    }
#line 1158
    if (cache_dns_reply_return_value < 0) {
#line 1159
      return (-1);
    }
#line 1161
    if (cache_dns_reply_return_value >= 16) {
#line 1162
      return (3);
    }
  } else
#line 1165
  if ((*((rem + b)->local + l))->tcp_num != -1) {
#line 1165
    if (key_n[17] == 1) {
      {
#line 1168
      tcp_truncated_retry((*((rem + b)->local + l))->tcp_num, (rem + b)->query, (int )(*((rem + b)->local + l))->local_id,
                          b, (int )(rem + b)->is_upstream);
#line 1172
      (rem + b)->die = the_time + ((int64_t )timeout_seconds << 11);
      }
#line 1173
      return (2);
    } else {
#line 1165
      goto _L;
    }
  } else {
    _L: /* CIL Label */ 
#line 1176
    if (key_n[17] != 1) {
#line 1192
      return (-1);
    }
    {
#line 1194
    cache_dns_reply(a, (int )count, b, 1);
    }
  }
  {
#line 1199
  set_dns_qid(a, (int )count, (*((rem + b)->local + l))->local_id);
  }
#line 1202
  if ((*((rem + b)->local + l))->tcp_num == -1) {
    {
#line 1204
    tmp___3 = send_reply_from_cache(a, count, b, l);
    }
#line 1204
    return (tmp___3);
  } else
#line 1202
  if ((int )(*((rem + b)->local + l))->glueless_type != 0) {
    {
#line 1204
    tmp___3 = send_reply_from_cache(a, count, b, l);
    }
#line 1204
    return (tmp___3);
  } else
#line 1205
  if (key_n[17] == 1) {
    {
#line 1206
    tcp_return_reply((*((rem + b)->local + l))->tcp_num, (char *)((void *)a), (int )count);
    }
  }
#line 1209
  return (1);
}
}
#line 1213 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void get_remote_udp_packet(int b , int sock ) 
{ 
  ssize_t count ;
  unsigned char a[520] ;
  int l ;
  int kill ;
  int core_ret ;
  int tmp ;

  {
  {
#line 1216
  l = 0;
#line 1216
  kill = 1;
#line 1216
  core_ret = 0;
#line 1218
  count = recv(sock, (void *)(a), (size_t )514, 0);
  }
#line 1219
  if (count < 12L) {
#line 1220
    return;
  } else
#line 1219
  if (count > 512L) {
#line 1220
    return;
  }
  {
#line 1222
  a[2] = (unsigned char )((int )a[2] | 128);
#line 1236
  tmp = verify_dns_packet(b, a, (int )count);
  }
#line 1236
  if (tmp != 1) {
#line 1237
    return;
  }
#line 1244
  l = 0;
  {
#line 1244
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1244
    if (! (l < (int )(rem + b)->num_locals)) {
#line 1244
      goto while_break;
    }
    {
#line 1245
    core_ret = get_rem_udp_packet_core(a, count, b, sock, l);
    }
#line 1246
    if (core_ret == -1) {
#line 1247
      return;
    } else
#line 1248
    if (core_ret == 2) {
#line 1249
      kill = 0;
    } else
#line 1248
    if (core_ret == 3) {
#line 1249
      kill = 0;
    }
#line 1244
    l ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1254
  if (kill == 1) {
    {
#line 1255
    close(*(b_remote + b));
#line 1256
    *(b_remote + b) = -1;
#line 1257
    reset_rem((int_fast32_t )b);
    }
  }
#line 1259
  return;
}
}
#line 1263 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwUdpSocket.c"
void server_fail_noreply(int a , int local_num ) 
{ 
  dw_str *packet ;
  int tmp ;
  int tmp___0 ;

  {
#line 1264
  packet = (dw_str *)0;
#line 1266
  if ((unsigned long )*((rem + a)->local + local_num) == (unsigned long )((local_T *)0)) {
#line 1268
    return;
  } else
#line 1266
  if ((int )(*((rem + a)->local + local_num))->glueless_type != 0) {
#line 1268
    return;
  }
  {
#line 1273
  packet = make_dns_header((int32_t )(*((rem + a)->local + local_num))->local_id,
                           (int16_t )33154, 0, 0, 0);
#line 1276
  dw_log_dwstr((char *)"Sending SERVER FAIL for query ", (rem + a)->query, 100);
#line 1278
  tmp = dw_append((rem + a)->query, packet);
  }
#line 1278
  if (tmp == -1) {
#line 1280
    goto catch_server_fail_noreply;
  } else {
    {
#line 1278
    tmp___0 = dw_put_u16(packet, (uint16_t )1, -1);
    }
#line 1278
    if (tmp___0 == -1) {
#line 1280
      goto catch_server_fail_noreply;
    }
  }
#line 1283
  if ((*((rem + a)->local + local_num))->tcp_num == -1) {
    {
#line 1285
    forward_remote_reply(packet->str, (size_t )packet->len, rem + a, 0);
    }
  } else
#line 1283
  if ((int )(*((rem + a)->local + local_num))->glueless_type != 0) {
    {
#line 1285
    forward_remote_reply(packet->str, (size_t )packet->len, rem + a, 0);
    }
  } else
#line 1287
  if (key_n[17] == 1) {
    {
#line 1288
    tcp_return_reply((*((rem + a)->local + local_num))->tcp_num, (char *)((void *)packet->str),
                     (int )packet->len);
    }
  }
  catch_server_fail_noreply: 
#line 1293
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 1294
    dw_destroy(packet);
#line 1295
    packet = (dw_str *)0;
    }
  }
#line 1297
  return;
}
}
#line 47 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.h"
void dwr_zap(dwr_rg *tozap ) ;
#line 51
dwr_rg *dwr_init_rg(dw_str *obj ) ;
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.c"
void dwr_beltmill(uint32_t *a , uint32_t *b ) 
{ 
  uint32_t q[3] ;
  uint32_t A[19] ;
  uint32_t x ;
  int s ;
  int i ;
  int v ;
  int y ;
  int r ;
  int z ;

  {
#line 34
  s = 0;
#line 35
  i = 0;
#line 36
  v = 0;
#line 37
  y = 0;
#line 38
  r = 0;
#line 39
  z = 0;
#line 40
  s = 0;
  {
#line 40
  while (1) {
    while_continue: /* CIL Label */ ;
#line 40
    if (! (s < 3)) {
#line 40
      goto while_break;
    }
#line 41
    q[s] = *(b + ((s * 13 + 13) - 1));
#line 42
    i = 12;
    {
#line 42
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 42
      if (! (i > 0)) {
#line 42
        goto while_break___0;
      }
#line 43
      v = i - 1;
#line 44
      if (v < 0) {
#line 45
        v = 12;
      }
#line 47
      *(b + (s * 13 + i)) = *(b + (s * 13 + v));
#line 42
      i --;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 50
    *(b + s * 13) = q[s];
#line 40
    s ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 52
  i = 0;
  {
#line 52
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 52
    if (! (i < 12)) {
#line 52
      goto while_break___1;
    }
#line 53
    s = (i + 1) + (i % 3) * 13;
#line 54
    *(b + s) ^= *(a + (i + 1));
#line 52
    i ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 56
  i = 0;
  {
#line 56
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 56
    if (! (i < 19)) {
#line 56
      goto while_break___2;
    }
#line 57
    y = (i * 7) % 19;
#line 58
    r = ((i * (i + 1)) / 2) % 32;
#line 59
    x = *(a + y) ^ (*(a + (y + 1) % 19) | ~ *(a + (y + 2) % 19));
#line 61
    A[i] = (x >> r) | (x << (32 - r));
#line 56
    i ++;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 63
  i = 0;
  {
#line 63
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 63
    if (! (i < 19)) {
#line 63
      goto while_break___3;
    }
#line 64
    y = i;
#line 65
    r = (i + 1) % 19;
#line 66
    z = (i + 4) % 19;
#line 67
    *(a + i) = (A[y] ^ A[r]) ^ A[z];
#line 63
    i ++;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 69
  *(a + 0) ^= 1U;
#line 70
  i = 0;
  {
#line 70
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 70
    if (! (i < 3)) {
#line 70
      goto while_break___4;
    }
#line 71
    *(a + (i + 13)) ^= q[i];
#line 70
    i ++;
  }
  while_break___4: /* CIL Label */ ;
  }
#line 73
  return;
}
}
#line 76 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.c"
void dwr_zap(dwr_rg *tozap ) 
{ 


  {
#line 77
  if ((unsigned long )tozap != (unsigned long )((dwr_rg *)0)) {
#line 78
    if ((unsigned long )tozap->mill != (unsigned long )((uint32_t *)0)) {
      {
#line 79
      free((void *)tozap->mill);
      }
    }
#line 81
    if ((unsigned long )tozap->belt != (unsigned long )((uint32_t *)0)) {
      {
#line 82
      free((void *)tozap->belt);
      }
    }
    {
#line 84
    free((void *)tozap);
    }
  }
#line 86
  return;
}
}
#line 91 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.c"
dwr_rg *dwr_new(void) 
{ 
  int q ;
  dwr_rg *new ;
  uint32_t *a ;
  uint32_t *b ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 92
  q = 0;
#line 93
  new = (dwr_rg *)0;
#line 94
  a = (uint32_t *)0;
#line 94
  b = (uint32_t *)0;
#line 96
  tmp = malloc(sizeof(dwr_rg ));
#line 96
  new = (dwr_rg *)tmp;
  }
#line 97
  if ((unsigned long )new == (unsigned long )((dwr_rg *)0)) {
#line 98
    goto catch_dwr_new;
  }
  {
#line 100
  tmp___0 = malloc(20UL * sizeof(uint32_t ));
#line 100
  new->mill = (uint32_t *)tmp___0;
#line 101
  tmp___1 = malloc(40UL * sizeof(uint32_t ));
#line 101
  new->belt = (uint32_t *)tmp___1;
#line 103
  new->index = 0;
#line 104
  a = new->mill;
#line 105
  b = new->belt;
  }
#line 106
  if ((unsigned long )a == (unsigned long )((uint32_t *)0)) {
#line 107
    goto catch_dwr_new;
  } else
#line 106
  if ((unsigned long )b == (unsigned long )((uint32_t *)0)) {
#line 107
    goto catch_dwr_new;
  }
#line 109
  q = 0;
  {
#line 109
  while (1) {
    while_continue: /* CIL Label */ ;
#line 109
    if (! (q < 19)) {
#line 109
      goto while_break;
    }
#line 110
    *(a + q) = (uint32_t )0;
#line 109
    q ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 112
  q = 0;
  {
#line 112
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 112
    if (! (q < 39)) {
#line 112
      goto while_break___0;
    }
#line 113
    *(b + q) = (uint32_t )0;
#line 112
    q ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 115
  return (new);
  catch_dwr_new: 
  {
#line 117
  dwr_zap(new);
  }
#line 118
  return ((dwr_rg *)0);
}
}
#line 129 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.c"
dwr_rg *dwr_init_rg(dw_str *obj ) 
{ 
  uint32_t p[3] ;
  int q ;
  int c ;
  int r ;
  int done ;
  dwr_rg *new ;
  uint32_t *a ;
  uint32_t *b ;
  int index ;
  int32_t counter ;
  int tmp ;
  int x ;

  {
  {
#line 131
  q = 0;
#line 132
  c = 0;
#line 133
  r = 0;
#line 134
  done = 0;
#line 135
  new = (dwr_rg *)0;
#line 136
  a = (uint32_t *)0;
#line 136
  b = (uint32_t *)0;
#line 137
  index = 0;
#line 138
  counter = 0;
#line 140
  tmp = dw_assert_sanity(obj);
  }
#line 140
  if (tmp == -1) {
#line 141
    return ((dwr_rg *)0);
  }
  {
#line 143
  new = dwr_new();
  }
#line 144
  if ((unsigned long )new == (unsigned long )((dwr_rg *)0)) {
#line 145
    return ((dwr_rg *)0);
  }
#line 147
  a = new->mill;
#line 148
  b = new->belt;
#line 149
  counter = 0;
  {
#line 149
  while (1) {
    while_continue: /* CIL Label */ ;
#line 149
    if (! (counter < 16777218)) {
#line 149
      goto while_break;
    }
#line 150
    p[2] = (uint32_t )0;
#line 150
    p[1] = p[2];
#line 150
    p[0] = p[1];
#line 151
    r = 0;
    {
#line 151
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 151
      if (! (r < 3)) {
#line 151
        goto while_break___0;
      }
#line 152
      q = 0;
      {
#line 152
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 152
        if (! (q < 32)) {
#line 152
          goto while_break___1;
        }
#line 153
        x = 0;
#line 154
        x = (int )*(obj->str + index);
#line 155
        index ++;
#line 156
        x &= 255;
#line 157
        if ((uint32_t )index > obj->len) {
#line 158
          done = 1;
#line 159
          x = 1;
        }
#line 162
        p[r] |= (unsigned int )(x << q);
#line 163
        if (done == 1) {
#line 164
          c = 0;
          {
#line 164
          while (1) {
            while_continue___2: /* CIL Label */ ;
#line 164
            if (! (c < 3)) {
#line 164
              goto while_break___2;
            }
#line 164
            *(b + c * 13) ^= p[c];
#line 164
            *(a + (16 + c)) ^= p[c];
#line 164
            c ++;
          }
          while_break___2: /* CIL Label */ ;
          }
          {
#line 164
          dwr_beltmill(a, b);
#line 165
          c = 0;
          }
          {
#line 165
          while (1) {
            while_continue___3: /* CIL Label */ ;
#line 165
            if (! (c < 16)) {
#line 165
              goto while_break___3;
            }
            {
#line 166
            dwr_beltmill(a, b);
#line 165
            c ++;
            }
          }
          while_break___3: /* CIL Label */ ;
          }
#line 168
          return (new);
        }
#line 152
        q += 8;
      }
      while_break___1: /* CIL Label */ ;
      }
#line 151
      r ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 172
    c = 0;
    {
#line 172
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 172
      if (! (c < 3)) {
#line 172
        goto while_break___4;
      }
#line 172
      *(b + c * 13) ^= p[c];
#line 172
      *(a + (16 + c)) ^= p[c];
#line 172
      c ++;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
#line 172
    dwr_beltmill(a, b);
#line 149
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 174
  return ((dwr_rg *)0);
}
}
#line 180 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRadioGatun.c"
uint16_t dwr_rng(dwr_rg *in ) 
{ 
  uint32_t *o ;

  {
#line 182
  if ((unsigned long )in == (unsigned long )((dwr_rg *)0)) {
#line 183
    return ((uint16_t )0);
  }
#line 188
  o = in->mill + 1;
#line 189
  if (in->index >= 100000000) {
#line 190
    in->index = 0;
  }
#line 192
  if (in->index % 4 == 0) {
    {
#line 193
    dwr_beltmill(in->mill, in->belt);
#line 194
    (in->index) ++;
    }
#line 195
    return ((uint16_t )(((*(o + 0) & 255U) << 8) | ((*(o + 0) & 65280U) >> 8)));
  } else {
#line 197
    (in->index) ++;
    {
#line 199
    if (in->index % 4 == 2) {
#line 199
      goto case_2;
    }
#line 202
    if (in->index % 4 == 3) {
#line 202
      goto case_3;
    }
#line 205
    if (in->index % 4 == 0) {
#line 205
      goto case_0;
    }
#line 198
    goto switch_break;
    case_2: /* CIL Label */ 
#line 200
    return ((uint16_t )(((*(o + 0) & 16711680U) >> 8) | ((*(o + 0) & 4278190080U) >> 24)));
    case_3: /* CIL Label */ 
#line 203
    return ((uint16_t )(((*(o + 1) & 255U) << 8) | ((*(o + 1) & 65280U) >> 8)));
    case_0: /* CIL Label */ 
#line 206
    return ((uint16_t )(((*(o + 1) & 16711680U) >> 8) | ((*(o + 1) & 4278190080U) >> 24)));
    switch_break: /* CIL Label */ ;
    }
  }
#line 210
  return ((uint16_t )0);
}
}
#line 468 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) calloc)(size_t __nmemb ,
                                                                               size_t __size )  __attribute__((__malloc__)) ;
#line 434 "/usr/include/libio.h"
extern int _IO_getc(_IO_FILE *__fp ) ;
#line 435
extern int _IO_putc(int __c , _IO_FILE *__fp ) ;
#line 237 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 531
extern int fgetc(FILE *__stream ) ;
#line 828
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) feof)(FILE *__stream ) ;
#line 846
extern void perror(char const   *__s ) ;
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.h"
void set_add_constant(void) ;
#line 56
void dwh_hash_zap(dw_hash *hash ) ;
#line 62
void dwh_process_mararc_params(void) ;
#line 102
dw_hash *dwh_hash_autogrow(dw_hash *hash ) ;
#line 106
int dwh_write_hash(dw_hash *hash , char *filename ) ;
#line 110
dw_hash *dwh_read_hash(char *filename ) ;
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 70 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.h"
void dw_log_3strings(char *s1 , char *s2 , char *s3 , int min_log_level ) ;
#line 78
void dw_log_hex(char *s1 , uint32_t number , int min_log_level ) ;
#line 150
int32_t get_key_n(int32_t get , int32_t min , int32_t max , int32_t def ) ;
#line 34 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
uint32_t add_constant  =    (uint32_t )1962698146;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int32_t cache_size  =    0;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void set_add_constant(void) 
{ 
  FILE *in ;
  dwr_rg *quick_n_dirty ;
  dw_str *seedit ;
  int counter ;
  time_t timestamp ;
  int tmp ;
  uint16_t tmp___0 ;
  uint16_t tmp___1 ;

  {
  {
#line 51
  in = (FILE *)0;
#line 52
  quick_n_dirty = (dwr_rg *)0;
#line 53
  seedit = (dw_str *)0;
#line 54
  counter = 0;
#line 55
  timestamp = (time_t )0;
#line 60
  in = fopen((char const   */* __restrict  */)"/dev/urandom", (char const   */* __restrict  */)"rb");
  }
#line 63
  if ((unsigned long )in == (unsigned long )((FILE *)0)) {
#line 64
    goto catch_set_add_constant;
  }
  {
#line 67
  seedit = dw_create((uint32_t )14);
  }
#line 69
  if ((unsigned long )seedit == (unsigned long )((dw_str *)0)) {
#line 70
    goto catch_set_add_constant;
  }
#line 73
  seedit->len = (uint32_t )11;
#line 74
  counter = 0;
  {
#line 74
  while (1) {
    while_continue: /* CIL Label */ ;
#line 74
    if (! (counter < 8)) {
#line 74
      goto while_break;
    }
    {
#line 75
    tmp = _IO_getc(in);
#line 75
    *(seedit->str + counter) = (uint8_t )tmp;
#line 74
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 77
  timestamp = time((time_t *)0);
#line 78
  *(seedit->str + 8) = (uint8_t )(timestamp & 255L);
#line 79
  *(seedit->str + 9) = (uint8_t )((timestamp & 65280L) >> 8);
#line 80
  *(seedit->str + 10) = (uint8_t )((timestamp & 16711680L) >> 16);
#line 82
  quick_n_dirty = dwr_init_rg(seedit);
#line 83
  dw_destroy(seedit);
  }
#line 84
  if ((unsigned long )quick_n_dirty == (unsigned long )((dwr_rg *)0)) {
#line 85
    goto catch_set_add_constant;
  }
  {
#line 88
  tmp___0 = dwr_rng(quick_n_dirty);
#line 88
  add_constant ^= (unsigned int )tmp___0;
#line 89
  tmp___1 = dwr_rng(quick_n_dirty);
#line 89
  add_constant ^= (unsigned int )((int )tmp___1 << 15);
#line 90
  dwr_zap(quick_n_dirty);
#line 91
  fclose(in);
  }
#line 93
  return;
  catch_set_add_constant: 
  {
#line 97
  printf((char const   */* __restrict  */)"Warning: Can not set add_constant\n");
  }
#line 99
  if ((unsigned long )in != (unsigned long )((FILE *)0)) {
    {
#line 100
    fclose(in);
    }
  }
#line 102
  return;
}
}
#line 106 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_process_mararc_params(void) 
{ 
  int32_t possible_magic_number ;

  {
  {
#line 109
  cache_size = get_key_n(9, 32, 16777216, -1);
#line 113
  possible_magic_number = key_n[8];
  }
#line 114
  if (possible_magic_number > 1073741824) {
    {
#line 115
    dw_log_string((char *)"Warning: hash_magic_number disabled", 0);
    }
  }
  {
#line 117
  dw_log_hex((char *)"add_constant is set to 0x", add_constant, 10);
  }
#line 119
  return;
}
}
#line 123 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
uint32_t dwh_hash_compress(dw_str *obj ) 
{ 
  uint32_t out ;
  uint32_t tmp ;
  int offset ;
  int tmp___0 ;

  {
  {
#line 124
  out = (uint32_t )0;
#line 125
  tmp = (uint32_t )0;
#line 127
  offset = 0;
#line 129
  tmp___0 = dw_assert_sanity(obj);
  }
#line 129
  if (tmp___0 == -1) {
#line 130
    return ((uint32_t )0);
  }
  {
#line 133
  while (1) {
    while_continue: /* CIL Label */ ;
#line 133
    if (! ((uint32_t )offset < obj->len)) {
#line 133
      goto while_break;
    }
#line 139
    if ((uint32_t )(offset + 3) < obj->len) {
#line 140
      tmp = (uint32_t )(((((int )*(obj->str + offset) << 24) | ((int )*((obj->str + offset) + 1) << 16)) | ((int )*((obj->str + offset) + 2) << 8)) | (int )*((obj->str + offset) + 3));
    } else {
#line 145
      tmp = (uint32_t )((int )*(obj->str + offset) << 24);
#line 146
      if ((uint32_t )(offset + 1) < obj->len) {
#line 147
        tmp |= (unsigned int )((int )*((obj->str + offset) + 1) << 16);
#line 148
        if ((uint32_t )(offset + 2) < obj->len) {
#line 149
          tmp |= (unsigned int )((int )*((obj->str + offset) + 2) << 8);
        }
      }
    }
#line 154
    out ^= tmp;
#line 155
    out *= 2105255083U;
#line 156
    out += add_constant;
#line 157
    out = (out >> 19) | (out << 13);
#line 158
    offset += 4;
  }
  while_break: /* CIL Label */ ;
  }
#line 161
  out ^= obj->len;
#line 162
  out *= 2105255083U;
#line 163
  out += add_constant;
#line 164
  out = (out >> 19) | (out << 13);
#line 171
  return (out);
}
}
#line 180 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_hash_zap(dw_hash *hash ) 
{ 


  {
#line 181
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 182
    return;
  }
#line 184
  if ((unsigned long )hash->hash != (unsigned long )((dw_element **)0)) {
    {
#line 185
    free((void *)hash->hash);
    }
  }
  {
#line 187
  free((void *)hash);
  }
#line 188
  return;
}
}
#line 193 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_hash_nuke(dw_hash *hash ) 
{ 
  int32_t count ;
  int32_t noloop ;
  dw_element *point ;
  dw_element *next ;

  {
#line 194
  count = 0;
#line 194
  noloop = 0;
#line 195
  point = (dw_element *)0;
#line 195
  next = (dw_element *)0;
#line 198
  count = 0;
  {
#line 198
  while (1) {
    while_continue: /* CIL Label */ ;
#line 198
    if (! ((uint32_t )count <= hash->mask)) {
#line 198
      goto while_break;
    }
#line 199
    point = *(hash->hash + count);
#line 200
    noloop = 0;
    {
#line 200
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 200
      if (noloop < 10000) {
#line 200
        if (! ((unsigned long )point != (unsigned long )((dw_element *)0))) {
#line 200
          goto while_break___0;
        }
      } else {
#line 200
        goto while_break___0;
      }
#line 201
      next = point->next;
#line 202
      if ((unsigned long )point->fila != (unsigned long )((dw_fila *)0)) {
        {
#line 203
        free((void *)point->fila);
        }
      }
      {
#line 205
      dw_destroy(point->key);
#line 206
      dw_destroy(point->value);
#line 207
      free((void *)point);
#line 208
      point = next;
#line 200
      noloop ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
#line 198
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 211
  dwh_hash_zap(hash);
  }
#line 212
  return;
}
}
#line 215 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_hash *dwh_hash_init(uint32_t elements ) 
{ 
  uint32_t power_two ;
  uint32_t a ;
  dw_hash *out ;
  dw_element **list ;
  void *tmp ;
  void *tmp___0 ;

  {
#line 216
  power_two = (uint32_t )1;
#line 217
  a = (uint32_t )0;
#line 221
  if (elements == 0U) {
#line 221
    if (cache_size > 0) {
#line 222
      elements = (uint32_t )cache_size;
    } else {
#line 221
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 223
  if (elements < 2U) {
#line 224
    elements = (uint32_t )2;
  } else
#line 225
  if (elements > 134217728U) {
#line 226
    elements = (uint32_t )134217728;
  }
#line 230
  a = elements;
  {
#line 231
  while (1) {
    while_continue: /* CIL Label */ ;
#line 231
    if (! (a > 0U)) {
#line 231
      goto while_break;
    }
#line 232
    power_two <<= 1;
#line 233
    a >>= 1;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 237
  tmp = calloc((size_t )(power_two + 1U), sizeof(dw_element *));
#line 237
  list = (dw_element **)tmp;
  }
#line 238
  if ((unsigned long )list == (unsigned long )((dw_element **)0)) {
#line 239
    return ((dw_hash *)0);
  }
  {
#line 242
  tmp___0 = malloc(sizeof(dw_hash ));
#line 242
  out = (dw_hash *)tmp___0;
  }
#line 243
  if ((unsigned long )out == (unsigned long )((dw_hash *)0)) {
    {
#line 244
    free((void *)list);
    }
#line 245
    return ((dw_hash *)0);
  }
#line 248
  out->fila = (dw_fila *)0;
#line 249
  out->hash = list;
#line 250
  power_two --;
#line 251
  out->mask = power_two;
#line 252
  out->size = 0;
#line 253
  out->max = (int32_t )elements;
#line 255
  return (out);
}
}
#line 261 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_fila_new(dw_hash *hash , dw_element *val ) 
{ 
  dw_fila *new ;
  void *tmp ;

  {
  {
#line 262
  new = (dw_fila *)0;
#line 264
  tmp = malloc(sizeof(dw_fila ));
#line 264
  new = (dw_fila *)tmp;
  }
#line 266
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 267
    goto catch_dwh_fila_new;
  } else
#line 266
  if ((unsigned long )val == (unsigned long )((dw_element *)0)) {
#line 267
    goto catch_dwh_fila_new;
  } else
#line 266
  if ((unsigned long )new == (unsigned long )((dw_fila *)0)) {
#line 267
    goto catch_dwh_fila_new;
  }
#line 270
  new->record = val;
#line 271
  val->fila = new;
#line 273
  if ((unsigned long )hash->fila == (unsigned long )((dw_fila *)0)) {
#line 274
    new->last = new;
#line 275
    new->next = new;
#line 276
    hash->fila = new;
#line 277
    return (1);
  }
#line 280
  new->next = hash->fila;
#line 281
  new->last = (hash->fila)->last;
#line 282
  ((hash->fila)->last)->next = new;
#line 283
  (hash->fila)->last = new;
#line 284
  hash->fila = new;
#line 285
  return (1);
  catch_dwh_fila_new: 
#line 288
  if ((unsigned long )new != (unsigned long )((dw_fila *)0)) {
    {
#line 289
    free((void *)new);
#line 290
    new = (dw_fila *)0;
    }
  }
#line 292
  return (-1);
}
}
#line 298 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_fila_zap(dw_hash *hash , dw_fila *zap , int get_hash ) 
{ 
  dw_element *record ;
  dw_fila *change ;

  {
#line 299
  record = (dw_element *)0;
#line 300
  change = (dw_fila *)0;
#line 302
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 303
    return (-1);
  } else
#line 302
  if ((unsigned long )zap == (unsigned long )((dw_fila *)0)) {
#line 303
    return (-1);
  }
#line 306
  if (get_hash == 1) {
#line 307
    record = zap->record;
  }
#line 310
  change = zap->next;
#line 311
  (zap->last)->next = change;
#line 312
  change->last = zap->last;
#line 313
  if ((unsigned long )zap == (unsigned long )hash->fila) {
#line 314
    hash->fila = change;
  }
#line 316
  if ((unsigned long )zap == (unsigned long )hash->fila) {
#line 317
    hash->fila = (dw_fila *)0;
  }
  {
#line 320
  free((void *)zap);
  }
#line 321
  if ((unsigned long )record != (unsigned long )((dw_element *)0)) {
    {
#line 322
    dwh_zap(hash, (dw_str *)0, record, 1);
    }
  }
#line 324
  return (1);
}
}
#line 330 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_fila_fetch(dw_hash *hash , dw_fila *get ) 
{ 
  dw_fila *change ;

  {
#line 331
  change = (dw_fila *)0;
#line 333
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 334
    return (-1);
  } else
#line 333
  if ((unsigned long )get == (unsigned long )((dw_fila *)0)) {
#line 334
    return (-1);
  } else
#line 333
  if ((unsigned long )hash->fila == (unsigned long )((dw_fila *)0)) {
#line 334
    return (-1);
  }
#line 339
  if ((unsigned long )get == (unsigned long )hash->fila) {
#line 340
    return (1);
  }
#line 344
  change = get->next;
#line 345
  (get->last)->next = get->next;
#line 346
  change->last = get->last;
#line 348
  get->last = (hash->fila)->last;
#line 349
  get->next = hash->fila;
#line 350
  ((hash->fila)->last)->next = get;
#line 351
  (hash->fila)->last = get;
#line 352
  hash->fila = get;
#line 353
  return (1);
}
}
#line 359 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_element *dwh_grep(dw_hash *hash , dw_str *key___6 ) 
{ 
  dw_element *seek ;
  int32_t index___0 ;
  int max ;
  uint32_t tmp ;
  int tmp___0 ;

  {
#line 360
  seek = (dw_element *)0;
#line 361
  index___0 = 0;
#line 362
  max = 0;
#line 363
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 364
    return ((dw_element *)0);
  } else
#line 363
  if ((unsigned long )key___6 == (unsigned long )((dw_str *)0)) {
#line 364
    return ((dw_element *)0);
  }
  {
#line 367
  tmp = dwh_hash_compress(key___6);
#line 367
  index___0 = (int32_t )(tmp & hash->mask);
#line 369
  seek = *(hash->hash + index___0);
#line 371
  max = 0;
  }
  {
#line 372
  while (1) {
    while_continue: /* CIL Label */ ;
#line 372
    if ((unsigned long )seek != (unsigned long )((dw_element *)0)) {
#line 372
      if (! (max < 32000)) {
#line 372
        goto while_break;
      }
    } else {
#line 372
      goto while_break;
    }
    {
#line 373
    tmp___0 = dw_issame(key___6, seek->key);
    }
#line 373
    if (tmp___0 == 1) {
#line 374
      return (seek);
    }
#line 376
    seek = seek->next;
#line 377
    max ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 379
  return ((dw_element *)0);
}
}
#line 387 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_str *dwh_get(dw_hash *hash , dw_str *key___6 , int ignore_expire , int use_fila ) 
{ 
  dw_element *seek ;
  dw_str *out ;

  {
  {
#line 388
  seek = (dw_element *)0;
#line 389
  out = (dw_str *)0;
#line 391
  seek = dwh_grep(hash, key___6);
  }
#line 392
  if ((unsigned long )seek == (unsigned long )((dw_element *)0)) {
#line 393
    return ((dw_str *)0);
  }
#line 399
  if (use_fila == 1) {
#line 399
    if (ignore_expire != 1) {
#line 399
      if (the_time > seek->expire) {
#line 399
        goto _L;
      } else
#line 399
      if ((long long )the_time + 24219648000LL < (long long )seek->expire) {
        _L: /* CIL Label */ 
#line 399
        if (seek->expire != 0L) {
#line 402
          return ((dw_str *)0);
        }
      }
    }
  }
  {
#line 405
  out = dw_substr(seek->value, 0, -1, -1);
  }
#line 406
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 407
    return ((dw_str *)0);
  }
#line 411
  if (use_fila == 1) {
#line 411
    if ((int )seek->immutable == 0) {
      {
#line 412
      dwh_fila_fetch(hash, seek->fila);
      }
    }
  }
#line 415
  return (out);
}
}
#line 420 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int32_t dwh_get_ttl(dw_hash *hash , dw_str *key___6 ) 
{ 
  dw_element *seek ;
  int64_t time___0 ;

  {
  {
#line 421
  seek = (dw_element *)0;
#line 422
  time___0 = (int64_t )0;
#line 424
  seek = dwh_grep(hash, key___6);
  }
#line 425
  if ((unsigned long )seek == (unsigned long )((dw_element *)0)) {
#line 426
    return (-1);
  }
#line 429
  time___0 = seek->expire - the_time;
#line 430
  time___0 >>= 8;
#line 431
  if (time___0 < 0L) {
#line 432
    return (-1);
  } else
#line 431
  if (time___0 > 31536000L) {
#line 432
    return (-1);
  }
#line 435
  return ((int32_t )time___0);
}
}
#line 444 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_zap(dw_hash *hash , dw_str *key___6 , dw_element *seek , int use_fila ) 
{ 
  int tmp ;

  {
#line 446
  if ((unsigned long )seek == (unsigned long )((dw_element *)0)) {
    {
#line 447
    tmp = dw_assert_sanity(key___6);
    }
#line 447
    if (tmp == -1) {
#line 448
      return (-1);
    }
    {
#line 451
    seek = dwh_grep(hash, key___6);
    }
  }
#line 454
  if ((unsigned long )seek == (unsigned long )((dw_element *)0)) {
#line 455
    return (0);
  }
#line 458
  if ((int )seek->immutable == 1) {
#line 459
    return (-1);
  }
#line 463
  if ((unsigned long )seek->prev != (unsigned long )((struct dw_element **)0)) {
#line 464
    *(seek->prev) = seek->next;
  }
#line 466
  if ((unsigned long )seek->next != (unsigned long )((struct dw_element *)0)) {
#line 467
    (seek->next)->prev = seek->prev;
  }
#line 471
  if ((unsigned long )key___6 != (unsigned long )((dw_str *)0)) {
#line 471
    if (use_fila == 1) {
      {
#line 474
      dwh_fila_zap(hash, seek->fila, 0);
      }
    }
  }
  {
#line 478
  dw_destroy(seek->key);
#line 479
  dw_destroy(seek->value);
#line 480
  free((void *)seek);
  }
#line 481
  if (hash->size > 0) {
#line 482
    (hash->size) --;
  }
#line 484
  return (1);
}
}
#line 489 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_element *dwh_init_element(dw_str *key___6 , dw_str *value___6 , int32_t ttl , dw_hash *hash ) 
{ 
  dw_element *new ;
  dw_str *key_copy ;
  dw_str *val_copy ;
  dw_element *seek ;
  void *tmp ;

  {
  {
#line 491
  new = (dw_element *)0;
#line 492
  key_copy = (dw_str *)0;
#line 492
  val_copy = (dw_str *)0;
#line 493
  seek = (dw_element *)0;
#line 499
  tmp = malloc(sizeof(dw_element ));
#line 499
  new = (dw_element *)tmp;
#line 501
  key_copy = dw_substr(key___6, 0, -1, -1);
#line 502
  val_copy = dw_substr(value___6, 0, -1, -1);
  }
#line 504
  if ((unsigned long )new == (unsigned long )((dw_element *)0)) {
#line 505
    goto catch_init_element;
  } else
#line 504
  if ((unsigned long )key_copy == (unsigned long )((dw_str *)0)) {
#line 505
    goto catch_init_element;
  } else
#line 504
  if ((unsigned long )val_copy == (unsigned long )((dw_str *)0)) {
#line 505
    goto catch_init_element;
  }
#line 508
  new->key = key_copy;
#line 509
  new->value = val_copy;
#line 510
  new->fila = (dw_fila *)0;
#line 511
  new->immutable = (int8_t )0;
#line 513
  if (ttl < 30) {
#line 513
    if (ttl != -2) {
#line 514
      ttl = 30;
    } else {
#line 513
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 515
  if (ttl > 63072000) {
#line 516
    ttl = 63072000;
  }
#line 518
  if (ttl != -2) {
#line 519
    new->expire = the_time + ((int64_t )ttl << 8);
  } else {
    {
#line 521
    seek = dwh_grep(hash, key___6);
    }
#line 522
    if ((unsigned long )seek == (unsigned long )((dw_element *)0)) {
#line 523
      new->expire = the_time + 7680L;
    } else {
#line 525
      new->expire = seek->expire;
    }
  }
#line 528
  new->next = (struct dw_element *)0;
#line 529
  new->prev = (struct dw_element **)0;
#line 531
  return (new);
  catch_init_element: 
#line 534
  if ((unsigned long )new != (unsigned long )((dw_element *)0)) {
    {
#line 535
    free((void *)new);
#line 536
    new = (dw_element *)0;
    }
  }
#line 538
  if ((unsigned long )key_copy != (unsigned long )((dw_str *)0)) {
    {
#line 539
    dw_destroy(key_copy);
#line 540
    key_copy = (dw_str *)0;
    }
  }
#line 542
  if ((unsigned long )val_copy != (unsigned long )((dw_str *)0)) {
    {
#line 543
    dw_destroy(val_copy);
#line 544
    val_copy = (dw_str *)0;
    }
  }
#line 546
  return ((dw_element *)0);
}
}
#line 550 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_place_new(dw_hash *hash , dw_element *new , int use_fila ) 
{ 
  int32_t index___0 ;
  int tmp ;
  uint32_t tmp___0 ;

  {
#line 551
  index___0 = 0;
#line 553
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 554
    return (-1);
  } else
#line 553
  if ((unsigned long )new == (unsigned long )((dw_element *)0)) {
#line 554
    return (-1);
  }
  {
#line 559
  tmp = dwh_zap(hash, new->key, (dw_element *)0, use_fila);
  }
#line 559
  if (tmp == -1) {
#line 560
    return (-1);
  }
  {
#line 564
  tmp___0 = dwh_hash_compress(new->key);
#line 564
  index___0 = (int32_t )(tmp___0 & hash->mask);
#line 565
  new->next = *(hash->hash + index___0);
#line 566
  new->prev = hash->hash + index___0;
  }
#line 567
  if ((unsigned long )new->next != (unsigned long )((struct dw_element *)0)) {
#line 568
    (new->next)->prev = & new->next;
  }
#line 570
  *(hash->hash + index___0) = new;
#line 573
  if (use_fila == 1) {
    {
#line 574
    dwh_fila_new(hash, new);
#line 578
    (hash->size) ++;
    }
#line 579
    if (hash->size >= hash->max) {
      {
#line 580
      dwh_fila_zap(hash, (hash->fila)->last, 1);
      }
    }
  } else {
#line 583
    (hash->size) ++;
  }
#line 586
  return (1);
}
}
#line 596 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_add(dw_hash *hash , dw_str *key___6 , dw_str *value___6 , int32_t ttl , int use_fila ) 
{ 
  dw_element *new ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 598
  new = (dw_element *)0;
#line 601
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 602
    goto catch_dwh_add;
  } else
#line 601
  if ((unsigned long )key___6 == (unsigned long )((dw_str *)0)) {
#line 602
    goto catch_dwh_add;
  } else
#line 601
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
#line 602
    goto catch_dwh_add;
  }
  {
#line 604
  tmp = dw_assert_sanity(key___6);
  }
#line 604
  if (tmp == -1) {
#line 605
    goto catch_dwh_add;
  } else {
    {
#line 604
    tmp___0 = dw_assert_sanity(value___6);
    }
#line 604
    if (tmp___0 == -1) {
#line 605
      goto catch_dwh_add;
    }
  }
#line 608
  if (ttl > 0) {
#line 608
    goto _L;
  } else
#line 608
  if (ttl == -2) {
    _L: /* CIL Label */ 
    {
#line 609
    new = dwh_init_element(key___6, value___6, ttl, hash);
    }
#line 610
    if ((unsigned long )new == (unsigned long )((dw_element *)0)) {
#line 611
      goto catch_dwh_add;
    }
    {
#line 615
    tmp___1 = dwh_place_new(hash, new, use_fila);
    }
#line 615
    if (tmp___1 == -1) {
#line 616
      goto catch_dwh_add;
    }
#line 618
    if (use_fila == 2) {
#line 619
      new->immutable = (int8_t )1;
#line 620
      new->expire = (int64_t )0;
    }
  }
#line 624
  return (1);
  catch_dwh_add: 
#line 627
  if ((unsigned long )new != (unsigned long )((dw_element *)0)) {
    {
#line 628
    free((void *)new);
#line 629
    new = (dw_element *)0;
    }
  }
#line 632
  return (-1);
}
}
#line 643 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_hash *dwh_hash_autogrow(dw_hash *hash ) 
{ 
  dw_hash *new ;
  int32_t count ;
  int32_t noloop ;
  dw_element *point ;
  dw_element *next ;

  {
#line 644
  new = (dw_hash *)0;
#line 645
  count = 0;
#line 645
  noloop = 0;
#line 646
  point = (dw_element *)0;
#line 646
  next = (dw_element *)0;
#line 647
  if ((unsigned long )hash->fila != (unsigned long )((dw_fila *)0)) {
#line 648
    return (hash);
  }
#line 650
  if ((uint32_t )hash->size < hash->mask) {
#line 651
    return (hash);
  }
#line 653
  if (((hash->mask + 1U) & hash->mask) != 0U) {
#line 654
    return (hash);
  }
  {
#line 656
  new = dwh_hash_init(hash->mask + 1U);
  }
#line 657
  if ((unsigned long )new == (unsigned long )((dw_hash *)0)) {
#line 658
    return (hash);
  }
#line 661
  count = 0;
  {
#line 661
  while (1) {
    while_continue: /* CIL Label */ ;
#line 661
    if (! ((uint32_t )count <= hash->mask)) {
#line 661
      goto while_break;
    }
#line 662
    point = *(hash->hash + count);
#line 663
    noloop = 0;
    {
#line 663
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 663
      if (noloop < 10000) {
#line 663
        if (! ((unsigned long )point != (unsigned long )((dw_element *)0))) {
#line 663
          goto while_break___0;
        }
      } else {
#line 663
        goto while_break___0;
      }
      {
#line 664
      next = point->next;
#line 665
      dwh_place_new(new, point, 0);
#line 666
      point = next;
#line 663
      noloop ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
#line 661
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 669
  dwh_hash_zap(hash);
  }
#line 670
  return (new);
}
}
#line 783 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_put_int32(FILE *handle , int32_t num ) 
{ 
  int counter ;
  uint8_t val ;

  {
#line 784
  counter = 0;
#line 785
  val = (uint8_t )0;
#line 787
  if (num < 0) {
#line 788
    counter = 0;
    {
#line 788
    while (1) {
      while_continue: /* CIL Label */ ;
#line 788
      if (! (counter < 4)) {
#line 788
        goto while_break;
      }
      {
#line 789
      _IO_putc(255, handle);
#line 788
      counter ++;
      }
    }
    while_break: /* CIL Label */ ;
    }
#line 791
    return;
  }
#line 793
  counter = 24;
  {
#line 793
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 793
    if (! (counter >= 0)) {
#line 793
      goto while_break___0;
    }
    {
#line 794
    val = (uint8_t )(num >> counter);
#line 795
    val = (uint8_t )((int )val & 255);
#line 796
    _IO_putc((int )val, handle);
#line 793
    counter -= 8;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 798
  return;
}
}
#line 801 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_put_int64(FILE *handle , int64_t num ) 
{ 
  int counter ;
  uint8_t val ;

  {
#line 802
  counter = 0;
#line 803
  val = (uint8_t )0;
#line 808
  if (num < 0L) {
#line 809
    counter = 0;
    {
#line 809
    while (1) {
      while_continue: /* CIL Label */ ;
#line 809
      if (! (counter < 7)) {
#line 809
        goto while_break;
      }
      {
#line 810
      _IO_putc(0, handle);
#line 809
      counter ++;
      }
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 812
    _IO_putc(1, handle);
    }
#line 813
    return;
  }
#line 815
  counter = 56;
  {
#line 815
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 815
    if (! (counter >= 0)) {
#line 815
      goto while_break___0;
    }
    {
#line 816
    val = (uint8_t )(num >> counter);
#line 817
    val = (uint8_t )((int )val & 255);
#line 818
    _IO_putc((int )val, handle);
#line 815
    counter -= 8;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 820
  return;
}
}
#line 825 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_put_dwstr(FILE *handle , dw_str *str ) 
{ 
  int counter ;
  int val ;
  int tmp ;

  {
  {
#line 826
  counter = 0;
#line 827
  val = 0;
#line 829
  tmp = dw_assert_sanity(str);
  }
#line 829
  if (tmp == -1) {
    {
#line 830
    dwh_put_int32(handle, -1);
    }
#line 831
    return;
  }
#line 834
  if (str->len > 16777216U) {
    {
#line 835
    dwh_put_int32(handle, -1);
    }
#line 836
    return;
  }
  {
#line 839
  dwh_put_int32(handle, (int32_t )str->len);
#line 841
  counter = 0;
  }
  {
#line 841
  while (1) {
    while_continue: /* CIL Label */ ;
#line 841
    if (! ((uint32_t )counter < str->len)) {
#line 841
      goto while_break;
    }
    {
#line 842
    val = (int )*(str->str + counter);
#line 843
    val &= 255;
#line 844
    _IO_putc(val, handle);
#line 841
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 847
  return;
}
}
#line 851 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
void dwh_put_hash_element(FILE *handle , dw_element *element ) 
{ 


  {
#line 852
  if ((unsigned long )element == (unsigned long )((dw_element *)0)) {
#line 854
    return;
  } else
#line 852
  if ((unsigned long )element->key == (unsigned long )((dw_str *)0)) {
#line 854
    return;
  } else
#line 852
  if (element->expire == 0L) {
#line 854
    return;
  } else
#line 852
  if ((element->key)->len == 0U) {
#line 854
    return;
  } else
#line 852
  if ((element->value)->len == 0U) {
#line 854
    return;
  }
  {
#line 857
  dwh_put_dwstr(handle, element->key);
#line 858
  dwh_put_dwstr(handle, element->value);
#line 859
  dwh_put_int64(handle, element->expire);
  }
#line 861
  return;
}
}
#line 865 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int dwh_write_hash(dw_hash *hash , char *filename ) 
{ 
  FILE *handle ;
  dw_fila *seek ;
  int index___0 ;

  {
#line 866
  handle = (FILE *)0;
#line 867
  seek = (dw_fila *)0;
#line 868
  index___0 = 0;
#line 870
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 871
    return (-1);
  } else
#line 870
  if ((unsigned long )filename == (unsigned long )((char *)0)) {
#line 871
    return (-1);
  }
  {
#line 874
  handle = fopen((char const   */* __restrict  */)filename, (char const   */* __restrict  */)"wb");
  }
#line 876
  if ((unsigned long )handle == (unsigned long )((FILE *)0)) {
    {
#line 877
    dw_log_3strings((char *)"Could not open hash at ", filename, (char *)" for writing",
                    1);
#line 880
    perror("System said");
    }
#line 882
    return (-1);
  }
  {
#line 886
  dwh_put_int32(handle, 4478771);
#line 888
  dwh_put_int32(handle, 0);
  }
#line 894
  if ((unsigned long )hash->fila != (unsigned long )((dw_fila *)0)) {
#line 895
    seek = (hash->fila)->last;
#line 896
    index___0 = 0;
    {
#line 896
    while (1) {
      while_continue: /* CIL Label */ ;
#line 896
      if (! (index___0 < 16777217)) {
#line 896
        goto while_break;
      }
      {
#line 897
      dwh_put_hash_element(handle, seek->record);
      }
#line 898
      if ((unsigned long )seek == (unsigned long )hash->fila) {
#line 899
        goto while_break;
      }
#line 901
      seek = seek->last;
#line 896
      index___0 ++;
    }
    while_break: /* CIL Label */ ;
    }
  }
  {
#line 905
  fclose(handle);
  }
#line 906
  return (1);
}
}
#line 912 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int32_t dwh_get_int32(FILE *handle ) 
{ 
  int32_t out ;
  uint8_t get ;
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 913
  out = 0;
#line 914
  get = (uint8_t )0;
#line 915
  counter = 0;
#line 917
  tmp = feof(handle);
  }
#line 917
  if (tmp) {
#line 918
    return (-2);
  }
  {
#line 921
  tmp___0 = fgetc(handle);
#line 921
  get = (uint8_t )tmp___0;
  }
#line 922
  if ((int )get > 127) {
    {
#line 923
    tmp___1 = feof(handle);
    }
#line 923
    if (tmp___1) {
#line 924
      return (-2);
    }
#line 926
    return (-1);
  }
#line 928
  get = (uint8_t )((int )get & 255);
#line 929
  out = (int )get << 24;
#line 931
  counter = 16;
  {
#line 931
  while (1) {
    while_continue: /* CIL Label */ ;
#line 931
    if (! (counter >= 0)) {
#line 931
      goto while_break;
    }
    {
#line 932
    tmp___2 = fgetc(handle);
#line 932
    get = (uint8_t )tmp___2;
#line 933
    tmp___3 = feof(handle);
    }
#line 933
    if (tmp___3) {
#line 934
      return (-2);
    }
#line 936
    get = (uint8_t )((int )get & 255);
#line 937
    out |= (int )get << counter;
#line 931
    counter -= 8;
  }
  while_break: /* CIL Label */ ;
  }
#line 940
  return (out);
}
}
#line 946 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
int64_t dwh_get_int64(FILE *handle ) 
{ 
  int64_t out ;
  uint8_t get ;
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 947
  out = (int64_t )0;
#line 948
  get = (uint8_t )0;
#line 949
  counter = 0;
#line 951
  tmp = feof(handle);
  }
#line 951
  if (tmp) {
#line 952
    return ((int64_t )-2);
  }
  {
#line 955
  tmp___0 = _IO_getc(handle);
#line 955
  get = (uint8_t )tmp___0;
  }
#line 956
  if ((int )get > 127) {
    {
#line 957
    tmp___1 = feof(handle);
    }
#line 957
    if (tmp___1) {
#line 958
      return ((int64_t )-2);
    }
#line 960
    return ((int64_t )-1);
  }
#line 962
  get = (uint8_t )((int )get & 255);
#line 963
  out = (int64_t )get << 56;
#line 965
  counter = 48;
  {
#line 965
  while (1) {
    while_continue: /* CIL Label */ ;
#line 965
    if (! (counter >= 0)) {
#line 965
      goto while_break;
    }
    {
#line 966
    tmp___2 = _IO_getc(handle);
#line 966
    get = (uint8_t )tmp___2;
#line 967
    tmp___3 = feof(handle);
    }
#line 967
    if (tmp___3) {
#line 968
      return ((int64_t )-2);
    }
#line 970
    get = (uint8_t )((int )get & 255);
#line 971
    out |= (int64_t )get << counter;
#line 965
    counter -= 8;
  }
  while_break: /* CIL Label */ ;
  }
#line 974
  return (out);
}
}
#line 979 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_str *dwh_get_dwstr(FILE *handle ) 
{ 
  dw_str *out ;
  int32_t len ;
  uint8_t get ;
  uint8_t *str ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 980
  out = (dw_str *)0;
#line 981
  len = 0;
#line 982
  get = (uint8_t )0;
#line 983
  str = (uint8_t *)0;
#line 985
  len = dwh_get_int32(handle);
  }
#line 987
  if (len == -2) {
#line 988
    return ((dw_str *)0);
  }
#line 991
  if (len < 0) {
#line 992
    len = 0;
  }
  {
#line 995
  out = dw_create((uint32_t )(len + 1));
  }
#line 997
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
    {
#line 998
    dw_destroy(out);
    }
#line 999
    return ((dw_str *)0);
  } else {
    {
#line 997
    tmp = dw_assert_sanity(out);
    }
#line 997
    if (tmp == -1) {
      {
#line 998
      dw_destroy(out);
      }
#line 999
      return ((dw_str *)0);
    }
  }
#line 1002
  out->len = (uint32_t )len;
#line 1003
  str = out->str;
  {
#line 1005
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1005
    if (! (len > 0)) {
#line 1005
      goto while_break;
    }
    {
#line 1006
    tmp___0 = _IO_getc(handle);
#line 1006
    get = (uint8_t )tmp___0;
#line 1007
    tmp___1 = feof(handle);
    }
#line 1007
    if (tmp___1) {
#line 1008
      get = (uint8_t )0;
    }
#line 1010
    *str = get;
#line 1011
    str ++;
#line 1005
    len --;
  }
  while_break: /* CIL Label */ ;
  }
#line 1014
  return (out);
}
}
#line 1020 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_element *dwh_get_hash_element(FILE *handle ) 
{ 
  dw_element *out ;
  void *tmp ;

  {
  {
#line 1021
  out = (dw_element *)0;
#line 1024
  tmp = malloc(sizeof(dw_element ));
#line 1024
  out = (dw_element *)tmp;
  }
#line 1025
  if ((unsigned long )out == (unsigned long )((dw_element *)0)) {
#line 1026
    return ((dw_element *)0);
  }
  {
#line 1028
  out->key = (dw_str *)0;
#line 1029
  out->value = (dw_str *)0;
#line 1031
  out->key = dwh_get_dwstr(handle);
#line 1032
  out->value = dwh_get_dwstr(handle);
#line 1033
  out->expire = dwh_get_int64(handle);
  }
#line 1034
  if ((unsigned long )out->key == (unsigned long )((dw_str *)0)) {
#line 1035
    goto catch_dwh_get_hash_element;
  } else
#line 1034
  if ((unsigned long )out->value == (unsigned long )((dw_str *)0)) {
#line 1035
    goto catch_dwh_get_hash_element;
  } else
#line 1034
  if (out->expire < 2L) {
#line 1035
    goto catch_dwh_get_hash_element;
  }
#line 1037
  if ((out->key)->len == 0U) {
#line 1038
    goto catch_dwh_get_hash_element;
  } else
#line 1037
  if ((out->value)->len == 0U) {
#line 1038
    goto catch_dwh_get_hash_element;
  }
#line 1040
  return (out);
  catch_dwh_get_hash_element: 
#line 1043
  if ((unsigned long )out->key != (unsigned long )((dw_str *)0)) {
    {
#line 1044
    free((void *)out->key);
#line 1045
    out->key = (dw_str *)0;
    }
  }
#line 1047
  if ((unsigned long )out->value != (unsigned long )((dw_str *)0)) {
    {
#line 1048
    free((void *)out->value);
#line 1049
    out->value = (dw_str *)0;
    }
  }
#line 1051
  if ((unsigned long )out != (unsigned long )((dw_element *)0)) {
    {
#line 1052
    free((void *)out);
#line 1053
    out = (dw_element *)0;
    }
  }
#line 1055
  return ((dw_element *)0);
}
}
#line 1060 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwHash.c"
dw_hash *dwh_read_hash(char *filename ) 
{ 
  FILE *handle ;
  dw_hash *new ;
  dw_element *ele ;
  int32_t max ;
  int32_t counter ;
  int32_t tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 1061
  handle = (FILE *)0;
#line 1062
  new = (dw_hash *)0;
#line 1063
  ele = (dw_element *)0;
#line 1064
  max = 0;
#line 1064
  counter = 0;
#line 1066
  if ((unsigned long )filename == (unsigned long )((char *)0)) {
#line 1067
    return ((dw_hash *)0);
  }
  {
#line 1070
  handle = fopen((char const   */* __restrict  */)filename, (char const   */* __restrict  */)"rb");
  }
#line 1071
  if ((unsigned long )handle == (unsigned long )((FILE *)0)) {
    {
#line 1072
    dw_log_3strings((char *)"Could not open hash at ", filename, (char *)" for reading",
                    1);
#line 1075
    perror("System said");
    }
#line 1077
    return ((dw_hash *)0);
  }
  {
#line 1080
  tmp = dwh_get_int32(handle);
  }
#line 1080
  if (tmp != 4478771) {
#line 1081
    return ((dw_hash *)0);
  }
  {
#line 1084
  dwh_get_int32(handle);
  }
#line 1087
  if (cache_size > 32) {
#line 1087
    if (cache_size < 16777218) {
#line 1088
      max = cache_size;
    } else {
#line 1090
      max = 1024;
    }
  } else {
#line 1090
    max = 1024;
  }
  {
#line 1093
  new = dwh_hash_init((uint32_t )max);
  }
#line 1094
  if ((unsigned long )new == (unsigned long )((dw_hash *)0)) {
#line 1095
    return ((dw_hash *)0);
  }
#line 1098
  counter = 0;
  {
#line 1099
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1099
    tmp___1 = feof(handle);
    }
#line 1099
    if (tmp___1) {
#line 1099
      goto while_break;
    } else
#line 1099
    if (! (counter < 16777218)) {
#line 1099
      goto while_break;
    }
    {
#line 1100
    ele = dwh_get_hash_element(handle);
    }
#line 1101
    if ((unsigned long )ele != (unsigned long )((dw_element *)0)) {
      {
#line 1102
      tmp___0 = dwh_place_new(new, ele, 1);
      }
#line 1102
      if (tmp___0 == -1) {
#line 1103
        goto while_break;
      }
    } else {
#line 1106
      goto while_break;
    }
#line 1108
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1111
  fclose(handle);
  }
#line 1112
  return (new);
}
}
#line 58 "/usr/include/arpa/inet.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) inet_pton)(int __af ,
                                                                                char const   * __restrict  __cp ,
                                                                                void * __restrict  __buf ) ;
#line 91 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.h"
void dw_fatal(char *why ) ;
#line 139
char *pop_last_item(dw_str *list ) ;
#line 135 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.h"
dw_str *dwx_ns_convert(dw_str *in , int is_upstream , dw_str *bailiwick ) ;
#line 137
ip_addr_T dwx_ns_getip(dw_str *list , dwr_rg *rng , int b ) ;
#line 167
int dwx_do_cname_glueless(dw_str *query , int conn_num ) ;
#line 185
int dwx_make_cname_reply(int conn_num , dw_str *query , dw_str *action , dw_str *answer ,
                         int depth ) ;
#line 170 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_dname_issame(uint8_t *p1 , uint8_t *p2 , uint8_t *pmax1 , uint8_t *pmax2 ) 
{ 
  int len ;
  int counter ;
  uint8_t lc1 ;
  uint8_t lc2 ;

  {
#line 172
  len = 0;
#line 172
  counter = 0;
#line 175
  counter = 0;
  {
#line 175
  while (1) {
    while_continue: /* CIL Label */ ;
#line 175
    if (! (counter < 260)) {
#line 175
      goto while_break;
    }
#line 176
    if ((int )*p1 != (int )*p2) {
#line 177
      return (0);
    }
#line 180
    len = (int )*p1;
#line 181
    if (len > 63) {
#line 182
      return (-1);
    } else
#line 181
    if (len < 0) {
#line 182
      return (-1);
    }
#line 184
    if (len == 0) {
#line 185
      return (1);
    }
    {
#line 188
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 188
      if (len >= 0) {
#line 188
        if (! (counter < 260)) {
#line 188
          goto while_break___0;
        }
      } else {
#line 188
        goto while_break___0;
      }
#line 189
      p1 ++;
#line 190
      p2 ++;
#line 191
      counter ++;
#line 193
      if ((unsigned long )p1 > (unsigned long )pmax1) {
#line 194
        return (-1);
      } else
#line 193
      if ((unsigned long )p2 > (unsigned long )pmax2) {
#line 194
        return (-1);
      }
#line 197
      lc1 = *p1;
#line 198
      lc2 = *p2;
#line 199
      if ((int )lc1 >= 65) {
#line 199
        if ((int )lc1 <= 90) {
#line 199
          lc1 = (uint8_t )((int )lc1 + 32);
        }
      }
#line 200
      if ((int )lc2 >= 65) {
#line 200
        if ((int )lc2 <= 90) {
#line 200
          lc2 = (uint8_t )((int )lc2 + 32);
        }
      }
#line 201
      if ((int )lc1 != (int )lc2) {
#line 202
        return (0);
      }
#line 188
      len --;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 175
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 206
  return (-1);
}
}
#line 211 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_dname_issame_dw(dw_str *in , uint32_t offset1 , uint32_t offset2 ) 
{ 
  uint8_t *p1 ;
  uint8_t *p2 ;
  uint8_t *pmax ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 212
  p1 = (uint8_t *)0;
#line 212
  p2 = (uint8_t *)0;
#line 212
  pmax = (uint8_t *)0;
#line 214
  tmp = dw_assert_sanity(in);
  }
#line 214
  if (tmp == -1) {
#line 216
    return (-1);
  } else
#line 214
  if (offset1 > in->len) {
#line 216
    return (-1);
  } else
#line 214
  if (offset2 > in->len) {
#line 216
    return (-1);
  }
  {
#line 219
  p1 = in->str + offset1;
#line 220
  p2 = in->str + offset2;
#line 221
  pmax = in->str + in->len;
#line 223
  tmp___0 = dwx_dname_issame(p1, p2, pmax, pmax);
  }
#line 223
  return (tmp___0);
}
}
#line 229 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_dname_issame_2dw(dw_str *in1 , uint32_t offset1 , dw_str *in2 , uint32_t offset2 ) 
{ 
  uint8_t *p1 ;
  uint8_t *p2 ;
  uint8_t *pmax1 ;
  uint8_t *pmax2 ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 231
  p1 = (uint8_t *)0;
#line 231
  p2 = (uint8_t *)0;
#line 231
  pmax1 = (uint8_t *)0;
#line 231
  pmax2 = (uint8_t *)0;
#line 233
  tmp = dw_assert_sanity(in1);
  }
#line 233
  if (tmp == -1) {
#line 235
    return (-1);
  } else {
    {
#line 233
    tmp___0 = dw_assert_sanity(in2);
    }
#line 233
    if (tmp___0 == -1) {
#line 235
      return (-1);
    } else
#line 233
    if (offset1 > in1->len) {
#line 235
      return (-1);
    } else
#line 233
    if (offset2 > in2->len) {
#line 235
      return (-1);
    }
  }
  {
#line 238
  p1 = in1->str + offset1;
#line 239
  p2 = in2->str + offset2;
#line 240
  pmax1 = in1->str + in1->len;
#line 241
  pmax2 = in2->str + in2->len;
#line 243
  tmp___1 = dwx_dname_issame(p1, p2, pmax1, pmax2);
  }
#line 243
  return (tmp___1);
}
}
#line 248 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_zap_dns_details(dns_details *victim ) 
{ 


  {
#line 249
  if ((unsigned long )victim == (unsigned long )((dns_details *)0)) {
#line 250
    return;
  }
#line 252
  if ((unsigned long )victim->an_types != (unsigned long )((int8_t *)0)) {
    {
#line 253
    free((void *)victim->an_types);
#line 254
    victim->an_types = (int8_t *)0;
    }
  }
#line 256
  if ((unsigned long )victim->ns_types != (unsigned long )((int8_t *)0)) {
    {
#line 257
    free((void *)victim->ns_types);
#line 258
    victim->ns_types = (int8_t *)0;
    }
  }
#line 260
  if ((unsigned long )victim->ar_types != (unsigned long )((int8_t *)0)) {
    {
#line 261
    free((void *)victim->ar_types);
#line 262
    victim->ar_types = (int8_t *)0;
    }
  }
#line 264
  if ((unsigned long )victim->look != (unsigned long )((dns_string *)0)) {
    {
#line 265
    dwc_zap_dns_str(victim->look);
#line 266
    victim->look = (dns_string *)0;
    }
  }
  {
#line 268
  free((void *)victim);
  }
#line 269
  return;
}
}
#line 272 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int8_t dwx_rrtype_number(int32_t rr ) 
{ 


  {
#line 273
  if (rr < 1) {
#line 274
    return ((int8_t )-1);
  }
#line 276
  if (rr >= 30) {
#line 277
    return ((int8_t )31);
  }
#line 286
  return ((int8_t )rr);
}
}
#line 290 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dns_details *dwx_init_dns_details(dns_string *look ) 
{ 
  dns_details *out ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
#line 291
  out = (dns_details *)0;
#line 293
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 294
    return ((dns_details *)0);
  }
  {
#line 297
  tmp = malloc(sizeof(dns_details ) + 1UL);
#line 297
  out = (dns_details *)tmp;
  }
#line 298
  if ((unsigned long )out == (unsigned long )((dns_details *)0)) {
    {
#line 299
    dw_fatal((char *)"Fatal: Can not init dns_details\n");
    }
  }
  {
#line 301
  out->look = look;
#line 302
  tmp___0 = malloc(sizeof(int8_t ) * (unsigned long )look->ancount + 1UL);
#line 302
  out->an_types = (int8_t *)tmp___0;
#line 303
  tmp___1 = malloc(sizeof(int8_t ) * (unsigned long )look->nscount + 1UL);
#line 303
  out->ns_types = (int8_t *)tmp___1;
#line 304
  tmp___2 = malloc(sizeof(int8_t ) * (unsigned long )look->arcount + 1UL);
#line 304
  out->ar_types = (int8_t *)tmp___2;
  }
#line 305
  return (out);
}
}
#line 341 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dns_details *dwx_create_dns_details(dw_str *in , dw_str *query ) 
{ 
  dns_string *look ;
  dns_details *out ;
  int counter ;
  int32_t tmp ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;

  {
#line 342
  look = (dns_string *)0;
#line 343
  out = (dns_details *)0;
#line 344
  counter = 0;
#line 346
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 347
    return ((dns_details *)0);
  }
  {
#line 350
  look = dwc_make_dns_str(in);
  }
#line 351
  if ((unsigned long )look == (unsigned long )((dns_string *)0)) {
#line 352
    goto catch_dwx_create_dns_details;
  }
  {
#line 354
  out = dwx_init_dns_details(look);
  }
#line 355
  if ((unsigned long )out == (unsigned long )((dns_details *)0)) {
#line 356
    goto catch_dwx_create_dns_details;
  }
#line 359
  counter = 0;
  {
#line 359
  while (1) {
    while_continue: /* CIL Label */ ;
#line 359
    if (! (counter < look->ancount * 2)) {
#line 359
      goto while_break;
    }
    {
#line 360
    tmp = dw_fetch_u16(in, (int32_t )*(look->an + (counter + 1)));
#line 360
    *(out->an_types + (counter >> 1)) = dwx_rrtype_number(tmp);
#line 359
    counter += 2;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 363
  counter = 0;
  {
#line 363
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 363
    if (! (counter < look->nscount * 2)) {
#line 363
      goto while_break___0;
    }
    {
#line 364
    tmp___0 = dw_fetch_u16(in, (int32_t )*(look->ns + (counter + 1)));
#line 364
    *(out->ns_types + (counter >> 1)) = dwx_rrtype_number(tmp___0);
#line 363
    counter += 2;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 367
  counter = 0;
  {
#line 367
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 367
    if (! (counter < look->arcount * 2)) {
#line 367
      goto while_break___1;
    }
    {
#line 368
    tmp___1 = dw_fetch_u16(in, (int32_t )*(look->ar + (counter + 1)));
#line 368
    *(out->ar_types + (counter >> 1)) = dwx_rrtype_number(tmp___1);
#line 367
    counter += 2;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
#line 372
  return (out);
  catch_dwx_create_dns_details: 
#line 375
  if ((unsigned long )look != (unsigned long )((dns_string *)0)) {
#line 375
    if ((unsigned long )out == (unsigned long )((dns_details *)0)) {
      {
#line 376
      dwc_zap_dns_str(look);
      }
    } else
#line 375
    if ((unsigned long )out->look != (unsigned long )look) {
      {
#line 376
      dwc_zap_dns_str(look);
      }
    }
  }
#line 378
  if ((unsigned long )out != (unsigned long )((dns_details *)0)) {
    {
#line 379
    dwx_zap_dns_details(out);
    }
  }
#line 381
  return ((dns_details *)0);
}
}
#line 384 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_check_answer_section_any(dw_str *in , dw_str *query , dns_details *view ) 
{ 
  int32_t qtype ;
  int counter ;
  int cname_chain ;
  int use_cname ;
  int tmp ;
  int32_t tmp___0 ;
  int tmp___1 ;
  int32_t tmp___2 ;
  int tmp___3 ;
  int32_t tmp___4 ;
  int tmp___5 ;
  int32_t tmp___6 ;

  {
  {
#line 385
  qtype = 0;
#line 386
  counter = 0;
#line 386
  cname_chain = 0;
#line 386
  use_cname = 1;
#line 388
  qtype = dw_fetch_u16(query, -1);
  }
#line 389
  if (qtype != 255) {
#line 390
    return (-1);
  }
#line 392
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 393
    return (-1);
  } else
#line 392
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 393
    return (-1);
  } else
#line 392
  if ((unsigned long )(view->look)->an == (unsigned long )((uint16_t *)0)) {
#line 393
    return (-1);
  }
#line 396
  counter = 0;
  {
#line 396
  while (1) {
    while_continue: /* CIL Label */ ;
#line 396
    if (! (counter < (view->look)->ancount * 2)) {
#line 396
      goto while_break;
    }
    {
#line 397
    tmp___5 = dwx_dname_issame_2dw(query, (uint32_t )0, in, (uint32_t )*((view->look)->an + counter));
    }
#line 397
    if (tmp___5 == 1) {
      {
#line 397
      tmp___6 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
      }
#line 397
      if (tmp___6 != 5) {
#line 402
        use_cname = 0;
      } else {
#line 397
        goto _L___7;
      }
    } else
    _L___7: /* CIL Label */ 
#line 403
    if (cname_chain == 0) {
#line 403
      if (counter >> 1 == cname_chain) {
#line 403
        if (use_cname == 1) {
          {
#line 403
          tmp___3 = dwx_dname_issame_2dw(query, (uint32_t )0, in, (uint32_t )*((view->look)->an + counter));
          }
#line 403
          if (tmp___3 == 1) {
            {
#line 403
            tmp___4 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
            }
#line 403
            if (tmp___4 == 5) {
#line 409
              cname_chain ++;
            } else {
#line 403
              goto _L___6;
            }
          } else {
#line 403
            goto _L___6;
          }
        } else {
#line 403
          goto _L___6;
        }
      } else {
#line 403
        goto _L___6;
      }
    } else
    _L___6: /* CIL Label */ 
#line 410
    if (cname_chain > 0) {
#line 410
      if (counter >> 1 == cname_chain) {
#line 410
        if (use_cname == 1) {
          {
#line 410
          tmp___1 = dwx_dname_issame_dw(in, (uint32_t )((int )*((view->look)->an + ((cname_chain - 1) * 2 + 1)) + 10),
                                        (uint32_t )*((view->look)->an + counter));
          }
#line 410
          if (tmp___1 == 1) {
            {
#line 410
            tmp___2 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
            }
#line 410
            if (tmp___2 == 5) {
#line 418
              cname_chain ++;
            } else {
#line 410
              goto _L___2;
            }
          } else {
#line 410
            goto _L___2;
          }
        } else {
#line 410
          goto _L___2;
        }
      } else {
#line 410
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 419
    if (cname_chain > 0) {
      {
#line 419
      tmp = dwx_dname_issame_dw(in, (uint32_t )((int )*((view->look)->an + ((cname_chain - 1) * 2 + 1)) + 10),
                                (uint32_t )*((view->look)->an + counter));
      }
#line 419
      if (tmp == 1) {
        {
#line 419
        tmp___0 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
        }
#line 419
        if (tmp___0 != 5) {
#line 427
          use_cname = 0;
        } else {
#line 429
          *(view->an_types + (counter >> 1)) = (int8_t )36;
        }
      } else {
#line 429
        *(view->an_types + (counter >> 1)) = (int8_t )36;
      }
    } else {
#line 429
      *(view->an_types + (counter >> 1)) = (int8_t )36;
    }
#line 396
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 433
  return (1);
}
}
#line 456 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_check_answer_section(dw_str *in , dw_str *query , dns_details *view ) 
{ 
  int32_t qtype ;
  int counter ;
  int cname_chain ;
  int use_cname ;
  int offset ;
  int tmp ;
  int tmp___0 ;
  int32_t tmp___1 ;
  int tmp___2 ;
  int32_t tmp___3 ;
  int tmp___4 ;
  int32_t tmp___5 ;
  int tmp___6 ;
  int32_t tmp___7 ;

  {
  {
#line 457
  qtype = 0;
#line 458
  counter = 0;
#line 458
  cname_chain = 0;
#line 458
  use_cname = 1;
#line 458
  offset = 0;
#line 460
  qtype = dw_fetch_u16(query, -1);
  }
#line 461
  if (qtype == -1) {
#line 462
    return (-1);
  }
#line 464
  if (qtype == 255) {
    {
#line 465
    tmp = dwx_check_answer_section_any(in, query, view);
    }
#line 465
    return (tmp);
  }
#line 467
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 468
    return (-1);
  } else
#line 467
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 468
    return (-1);
  } else
#line 467
  if ((unsigned long )(view->look)->an == (unsigned long )((uint16_t *)0)) {
#line 468
    return (-1);
  }
#line 471
  counter = 0;
  {
#line 471
  while (1) {
    while_continue: /* CIL Label */ ;
#line 471
    if (! (counter < (view->look)->ancount * 2)) {
#line 471
      goto while_break;
    }
    {
#line 472
    tmp___6 = dwx_dname_issame_2dw(query, (uint32_t )0, in, (uint32_t )*((view->look)->an + counter));
    }
#line 472
    if (tmp___6 == 1) {
      {
#line 472
      tmp___7 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
      }
#line 472
      if (tmp___7 == qtype) {
#line 476
        offset ++;
#line 477
        use_cname = 0;
      } else {
#line 472
        goto _L___9;
      }
    } else
    _L___9: /* CIL Label */ 
#line 478
    if (cname_chain == 0) {
#line 478
      if (qtype != 5) {
#line 478
        if (offset == cname_chain) {
#line 478
          if (use_cname == 1) {
            {
#line 478
            tmp___4 = dwx_dname_issame_2dw(query, (uint32_t )0, in, (uint32_t )*((view->look)->an + counter));
            }
#line 478
            if (tmp___4 == 1) {
              {
#line 478
              tmp___5 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
              }
#line 478
              if (tmp___5 == 5) {
#line 485
                offset ++;
#line 486
                cname_chain ++;
              } else {
#line 478
                goto _L___8;
              }
            } else {
#line 478
              goto _L___8;
            }
          } else {
#line 478
            goto _L___8;
          }
        } else {
#line 478
          goto _L___8;
        }
      } else {
#line 478
        goto _L___8;
      }
    } else
    _L___8: /* CIL Label */ 
#line 487
    if (cname_chain > 0) {
#line 487
      if (qtype != 5) {
#line 487
        if (offset == cname_chain) {
#line 487
          if (use_cname == 1) {
            {
#line 487
            tmp___2 = dwx_dname_issame_dw(in, (uint32_t )((int )*((view->look)->an + ((cname_chain - 1) * 2 + 1)) + 10),
                                          (uint32_t )*((view->look)->an + counter));
            }
#line 487
            if (tmp___2 == 1) {
              {
#line 487
              tmp___3 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
              }
#line 487
              if (tmp___3 == 5) {
#line 496
                offset ++;
#line 497
                cname_chain ++;
              } else {
#line 487
                goto _L___3;
              }
            } else {
#line 487
              goto _L___3;
            }
          } else {
#line 487
            goto _L___3;
          }
        } else {
#line 487
          goto _L___3;
        }
      } else {
#line 487
        goto _L___3;
      }
    } else
    _L___3: /* CIL Label */ 
#line 498
    if (cname_chain > 0) {
#line 498
      if (qtype != 5) {
        {
#line 498
        tmp___0 = dwx_dname_issame_dw(in, (uint32_t )((int )*((view->look)->an + ((cname_chain - 1) * 2 + 1)) + 10),
                                      (uint32_t )*((view->look)->an + counter));
        }
#line 498
        if (tmp___0 == 1) {
          {
#line 498
          tmp___1 = dw_fetch_u16(in, (int32_t )*((view->look)->an + (counter + 1)));
          }
#line 498
          if (tmp___1 == qtype) {
#line 505
            offset ++;
#line 506
            use_cname = 0;
          } else {
#line 508
            *(view->an_types + (counter >> 1)) = (int8_t )36;
          }
        } else {
#line 508
          *(view->an_types + (counter >> 1)) = (int8_t )36;
        }
      } else {
#line 508
        *(view->an_types + (counter >> 1)) = (int8_t )36;
      }
    } else {
#line 508
      *(view->an_types + (counter >> 1)) = (int8_t )36;
    }
#line 471
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 512
  return (1);
}
}
#line 519 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_if_an_then_no_ns_nor_ar(dns_details *view ) 
{ 
  int counter ;

  {
#line 520
  counter = 0;
#line 521
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 523
    return (-1);
  } else
#line 521
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 523
    return (-1);
  } else
#line 521
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 523
    return (-1);
  } else
#line 521
  if ((unsigned long )view->ar_types == (unsigned long )((int8_t *)0)) {
#line 523
    return (-1);
  }
#line 526
  if ((view->look)->ancount == 0) {
#line 527
    return (1);
  }
#line 530
  counter = 0;
  {
#line 530
  while (1) {
    while_continue: /* CIL Label */ ;
#line 530
    if (! (counter < (view->look)->nscount * 2)) {
#line 530
      goto while_break;
    }
#line 531
    *(view->ns_types + (counter >> 1)) = (int8_t )36;
#line 530
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 533
  counter = 0;
  {
#line 533
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 533
    if (! (counter < (view->look)->arcount * 2)) {
#line 533
      goto while_break___0;
    }
#line 534
    *(view->ar_types + (counter >> 1)) = (int8_t )36;
#line 533
    counter += 2;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 537
  return (1);
}
}
#line 544 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_cleanup_ns_ar(dns_details *view ) 
{ 
  int counter ;

  {
#line 545
  counter = 0;
#line 547
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 549
    return (-1);
  } else
#line 547
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 549
    return (-1);
  } else
#line 547
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 549
    return (-1);
  } else
#line 547
  if ((unsigned long )view->ar_types == (unsigned long )((int8_t *)0)) {
#line 549
    return (-1);
  }
#line 552
  counter = 0;
  {
#line 552
  while (1) {
    while_continue: /* CIL Label */ ;
#line 552
    if (! (counter < (view->look)->nscount * 2)) {
#line 552
      goto while_break;
    }
#line 553
    if ((int )*(view->ns_types + (counter >> 1)) != 2) {
#line 553
      if ((int )*(view->ns_types + (counter >> 1)) != 6) {
#line 555
        *(view->ns_types + (counter >> 1)) = (int8_t )36;
      }
    }
#line 552
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 558
  counter = 0;
  {
#line 558
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 558
    if (! (counter < (view->look)->arcount * 2)) {
#line 558
      goto while_break___0;
    }
#line 559
    if ((int )*(view->ar_types + (counter >> 1)) != 1) {
#line 559
      if ((int )*(view->ar_types + (counter >> 1)) != 28) {
#line 561
        *(view->ar_types + (counter >> 1)) = (int8_t )36;
      }
    }
#line 558
    counter += 2;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 564
  return (1);
}
}
#line 657 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_string_bailiwick_query(dw_str *in , int32_t offset , dw_str *query ) 
{ 
  int32_t q_offset ;
  int noloop ;
  int32_t len ;
  int tmp ;
  int tmp___0 ;

  {
#line 659
  q_offset = 0;
#line 660
  noloop = 0;
#line 661
  len = 0;
#line 663
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 664
    return (0);
  } else
#line 663
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 664
    return (0);
  }
#line 667
  if (query->len <= 2U) {
#line 668
    return (0);
  }
  {
#line 671
  tmp = dwx_dname_issame_2dw(in, (uint32_t )offset, query, (uint32_t )0);
  }
#line 671
  if (tmp == 1) {
#line 672
    return (1);
  }
  {
#line 677
  while (1) {
    while_continue: /* CIL Label */ ;
#line 677
    if (noloop < 1024) {
#line 677
      if (! ((int )*(query->str + q_offset) != 0)) {
#line 677
        goto while_break;
      }
    } else {
#line 677
      goto while_break;
    }
#line 680
    len = (int32_t )*(query->str + q_offset);
#line 681
    if (len < 0) {
#line 682
      return (0);
    } else
#line 681
    if (len > 63) {
#line 682
      return (0);
    }
#line 684
    q_offset += len;
#line 685
    q_offset ++;
#line 687
    if (q_offset < 0) {
#line 688
      return (0);
    } else
#line 687
    if ((uint32_t )q_offset >= query->len) {
#line 688
      return (0);
    }
    {
#line 691
    tmp___0 = dwx_dname_issame_2dw(in, (uint32_t )offset, query, (uint32_t )q_offset);
    }
#line 691
    if (tmp___0 == 1) {
#line 692
      return (1);
    }
#line 695
    noloop ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 698
  return (0);
}
}
#line 707 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_string_bailiwick_top(dw_str *in , int32_t offset , dw_str *bailiwick ) 
{ 
  int noloop ;
  int32_t len ;
  int tmp ;

  {
#line 709
  noloop = 0;
#line 710
  len = 0;
#line 712
  if ((unsigned long )bailiwick == (unsigned long )((dw_str *)0)) {
#line 713
    return (0);
  } else
#line 712
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 713
    return (0);
  }
#line 716
  if (offset < 0) {
#line 717
    return (0);
  } else
#line 716
  if ((uint32_t )offset >= in->len) {
#line 717
    return (0);
  }
  {
#line 720
  while (1) {
    while_continue: /* CIL Label */ ;
#line 720
    if (noloop < 1024) {
#line 720
      if (! ((int )*(in->str + offset) != 0)) {
#line 720
        goto while_break;
      }
    } else {
#line 720
      goto while_break;
    }
#line 722
    len = (int32_t )*(in->str + offset);
#line 723
    if (len < 0) {
#line 724
      return (0);
    } else
#line 723
    if (len > 63) {
#line 724
      return (0);
    }
#line 727
    offset += len;
#line 728
    offset ++;
#line 730
    if (offset < 0) {
#line 731
      return (0);
    } else
#line 730
    if ((uint32_t )offset >= in->len) {
#line 731
      return (0);
    }
    {
#line 734
    tmp = dwx_dname_issame_2dw(in, (uint32_t )offset, bailiwick, (uint32_t )0);
    }
#line 734
    if (tmp == 1) {
#line 735
      return (1);
    }
#line 738
    noloop ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 741
  return (0);
}
}
#line 744 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_string_in_bailiwick(dw_str *in , int32_t offset , dw_str *bailiwick , dw_str *query ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 747
  tmp = dwx_string_bailiwick_query(in, offset, query);
  }
#line 747
  if (tmp != 1) {
#line 748
    return (0);
  }
  {
#line 751
  tmp___0 = dwx_string_bailiwick_top(in, offset, bailiwick);
  }
#line 751
  if (tmp___0 != 1) {
#line 752
    return (0);
  }
#line 755
  return (1);
}
}
#line 765 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_check_bailiwick_ns_section(dns_details *view , dw_str *query , dw_str *bailiwick ) 
{ 
  int ns ;
  dw_str *in ;
  dns_string *look ;
  int max ;
  int tmp ;

  {
#line 767
  ns = 0;
#line 768
  in = (dw_str *)0;
#line 769
  look = (dns_string *)0;
#line 770
  max = 0;
#line 772
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 773
    return (-1);
  } else
#line 772
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 773
    return (-1);
  } else
#line 772
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 773
    return (-1);
  }
#line 776
  look = view->look;
#line 778
  if (look->nscount <= 0) {
#line 779
    return (1);
  }
#line 781
  if (look->nscount > 15) {
#line 782
    max = 15;
  } else {
#line 784
    max = look->nscount;
  }
#line 787
  in = look->packet;
#line 788
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 789
    return (-1);
  }
#line 791
  ns = 0;
  {
#line 791
  while (1) {
    while_continue: /* CIL Label */ ;
#line 791
    if (! (ns < max * 2)) {
#line 791
      goto while_break;
    }
    {
#line 793
    tmp = dwx_string_in_bailiwick(in, (int32_t )*(look->ns + ns), bailiwick, query);
    }
#line 793
    if (tmp != 1) {
#line 795
      *(view->ns_types + (ns >> 1)) = (int8_t )37;
    }
#line 791
    ns += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 798
  return (1);
}
}
#line 803 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_make_link(dns_details *view , int ns , int ar ) 
{ 


  {
#line 804
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 805
    return;
  } else
#line 804
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 805
    return;
  }
#line 807
  if (ns >> 1 > 15) {
#line 808
    return;
  }
#line 812
  if ((int )*(view->ar_types + (ar >> 1)) == 1) {
#line 815
    *(view->ns_types + (ns >> 1)) = (int8_t )((int )*(view->ns_types + (ns >> 1)) | 33);
  } else
#line 812
  if ((int )*(view->ar_types + (ar >> 1)) >= 80) {
#line 812
    if ((int )*(view->ar_types + (ar >> 1)) <= 95) {
#line 815
      *(view->ns_types + (ns >> 1)) = (int8_t )((int )*(view->ns_types + (ns >> 1)) | 33);
    } else {
#line 812
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 816
  if ((int )*(view->ar_types + (ar >> 1)) == 28) {
#line 819
    *(view->ns_types + (ns >> 1)) = (int8_t )((int )*(view->ns_types + (ns >> 1)) | 34);
  } else
#line 816
  if ((int )*(view->ar_types + (ar >> 1)) >= 64) {
#line 816
    if ((int )*(view->ar_types + (ar >> 1)) <= 79) {
#line 819
      *(view->ns_types + (ns >> 1)) = (int8_t )((int )*(view->ns_types + (ns >> 1)) | 34);
    }
  }
#line 823
  if ((int )*(view->ar_types + (ar >> 1)) == 1) {
#line 824
    *(view->ar_types + (ar >> 1)) = (int8_t )(80 + (ns >> 1));
  } else
#line 825
  if ((int )*(view->ar_types + (ar >> 1)) == 28) {
#line 826
    *(view->ar_types + (ar >> 1)) = (int8_t )(64 + (ns >> 1));
  }
#line 829
  return;
}
}
#line 835 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_link_ns_records(dns_details *view ) 
{ 
  int ns ;
  int ar ;
  int max ;
  dw_str *in ;
  dns_string *look ;
  int tmp ;

  {
#line 836
  ns = 0;
#line 837
  ar = 0;
#line 838
  max = 0;
#line 839
  in = (dw_str *)0;
#line 840
  look = (dns_string *)0;
#line 842
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 843
    return (-1);
  } else
#line 842
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 843
    return (-1);
  }
#line 846
  look = view->look;
#line 848
  if (look->nscount > 15) {
#line 849
    max = 15;
  } else {
#line 851
    max = look->nscount;
  }
#line 854
  in = look->packet;
#line 856
  ns = 0;
  {
#line 856
  while (1) {
    while_continue: /* CIL Label */ ;
#line 856
    if (! (ns < max * 2)) {
#line 856
      goto while_break;
    }
#line 857
    if ((int )*(view->ns_types + (ns >> 1)) == 2) {
#line 858
      *(view->ns_types + (ns >> 1)) = (int8_t )32;
#line 859
      ar = 0;
      {
#line 859
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 859
        if (! (ar < (view->look)->arcount * 2)) {
#line 859
          goto while_break___0;
        }
        {
#line 860
        tmp = dwx_dname_issame_dw(in, (uint32_t )((int )*(look->ns + (ns + 1)) + 10),
                                  (uint32_t )*(look->ar + ar));
        }
#line 860
        if (tmp == 1) {
          {
#line 863
          dwx_make_link(view, ns, ar);
          }
        }
#line 859
        ar += 2;
      }
      while_break___0: /* CIL Label */ ;
      }
    }
#line 856
    ns += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 868
  return (1);
}
}
#line 877 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_get_1_dns_rr(dw_str *in , int32_t offset ) 
{ 
  int32_t end ;
  int32_t rdlength ;
  dw_str *out ;
  int32_t tmp ;

  {
#line 878
  end = 0;
#line 878
  rdlength = 0;
#line 879
  out = (dw_str *)0;
#line 881
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 882
    goto catch_dwx_get_1_dns_rr;
  } else
#line 881
  if (offset < 0) {
#line 882
    goto catch_dwx_get_1_dns_rr;
  } else
#line 881
  if ((uint32_t )offset > in->len) {
#line 882
    goto catch_dwx_get_1_dns_rr;
  }
  {
#line 885
  end = dw_get_dn_end(in, offset);
  }
#line 886
  if (end == -1) {
#line 887
    goto catch_dwx_get_1_dns_rr;
  } else
#line 886
  if (end < offset) {
#line 887
    goto catch_dwx_get_1_dns_rr;
  }
  {
#line 889
  tmp = dw_fetch_u16(in, end + 2);
  }
#line 889
  if (tmp != 1) {
#line 890
    goto catch_dwx_get_1_dns_rr;
  }
  {
#line 892
  rdlength = dw_fetch_u16(in, end + 8);
  }
#line 893
  if (rdlength < 0) {
#line 894
    goto catch_dwx_get_1_dns_rr;
  }
#line 897
  end += 10 + rdlength;
#line 898
  if (end <= offset) {
#line 899
    goto catch_dwx_get_1_dns_rr;
  }
  {
#line 902
  out = dw_substr(in, offset, end - offset, 1);
  }
#line 903
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 904
    goto catch_dwx_get_1_dns_rr;
  }
#line 906
  return (out);
  catch_dwx_get_1_dns_rr: 
#line 909
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 910
    dw_destroy(out);
    }
  }
#line 912
  return ((dw_str *)0);
}
}
#line 923 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_get_dns_string(dw_str *in , int32_t offset ) 
{ 
  int32_t end ;
  dw_str *tmp ;

  {
#line 924
  end = 0;
#line 926
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 927
    return ((dw_str *)0);
  } else
#line 926
  if (offset < 0) {
#line 927
    return ((dw_str *)0);
  } else
#line 926
  if ((uint32_t )offset > in->len) {
#line 927
    return ((dw_str *)0);
  }
  {
#line 930
  end = dw_get_dn_end(in, offset);
  }
#line 931
  if (end < offset) {
#line 932
    return ((dw_str *)0);
  }
  {
#line 935
  tmp = dw_substr(in, offset, end - offset, 1);
  }
#line 935
  return (tmp);
}
}
#line 957 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_cname_refer(dns_details *view ) 
{ 
  int32_t offset ;
  int32_t final_offset ;
  dw_str *out ;
  dw_str *tmp ;
  int counter ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 958
  offset = 0;
#line 958
  final_offset = 0;
#line 959
  out = (dw_str *)0;
#line 959
  tmp = (dw_str *)0;
#line 960
  counter = 0;
#line 962
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 963
    goto catch_dwx_make_cname_refer;
  } else
#line 962
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 963
    goto catch_dwx_make_cname_refer;
  } else
#line 962
  if ((unsigned long )view->an_types == (unsigned long )((int8_t *)0)) {
#line 963
    goto catch_dwx_make_cname_refer;
  }
  {
#line 966
  out = dw_create((uint32_t )(257 * (view->look)->ancount));
  }
#line 967
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 968
    goto catch_dwx_make_cname_refer;
  }
#line 971
  counter = 0;
  {
#line 971
  while (1) {
    while_continue: /* CIL Label */ ;
#line 971
    if (! (counter < (view->look)->ancount * 2)) {
#line 971
      goto while_break;
    }
#line 972
    if ((int )*(view->an_types + (counter >> 1)) == 36) {
#line 973
      goto __Cont;
    }
#line 975
    if ((int )*(view->an_types + (counter >> 1)) != 5) {
#line 976
      goto catch_dwx_make_cname_refer;
    }
    {
#line 978
    offset = (int32_t )*((view->look)->an + (counter + 1));
#line 979
    offset += 10;
#line 980
    tmp = dwx_get_dns_string((view->look)->packet, offset);
    }
#line 981
    if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 982
      goto catch_dwx_make_cname_refer;
    }
#line 984
    if (tmp->len > 256U) {
#line 985
      goto catch_dwx_make_cname_refer;
    }
    {
#line 987
    final_offset = (int32_t )out->len;
#line 988
    tmp___0 = dw_put_u16(out, (uint16_t )tmp->len, -1);
    }
#line 988
    if (tmp___0 == -1) {
#line 989
      goto catch_dwx_make_cname_refer;
    }
    {
#line 991
    tmp___1 = dw_append(tmp, out);
    }
#line 991
    if (tmp___1 == -1) {
#line 992
      goto catch_dwx_make_cname_refer;
    }
    {
#line 994
    dw_destroy(tmp);
#line 995
    tmp = (dw_str *)0;
    }
    __Cont: /* CIL Label */ 
#line 971
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 997
  tmp___2 = dw_put_u16(out, (uint16_t )final_offset, -1);
  }
#line 997
  if (tmp___2 == -1) {
#line 999
    goto catch_dwx_make_cname_refer;
  } else {
    {
#line 997
    tmp___3 = dw_addchar((uint8_t )17, out);
    }
#line 997
    if (tmp___3 == -1) {
#line 999
      goto catch_dwx_make_cname_refer;
    }
  }
#line 1001
  return (out);
  catch_dwx_make_cname_refer: 
#line 1004
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1005
    dw_destroy(out);
    }
  }
#line 1007
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 1008
    dw_destroy(tmp);
    }
  }
#line 1010
  return ((dw_str *)0);
}
}
#line 1014 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_nsglue(dw_str *in , int32_t toffset , int type ) 
{ 
  int otype ;
  int len ;
  dw_str *out ;
  int tmp ;
  int tmp___0 ;

  {
#line 1015
  otype = 0;
#line 1015
  len = 0;
#line 1016
  out = (dw_str *)0;
#line 1018
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 1019
    return ((dw_str *)0);
  }
#line 1022
  if (type >= 80) {
#line 1022
    if (type <= 95) {
#line 1023
      otype = 1;
#line 1024
      len = 4;
    } else {
#line 1022
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 1025
  if (type >= 64) {
#line 1025
    if (type <= 79) {
#line 1026
      otype = 28;
#line 1027
      len = 16;
    } else {
#line 1029
      return ((dw_str *)0);
    }
  } else {
#line 1029
    return ((dw_str *)0);
  }
  {
#line 1032
  out = dw_create((uint32_t )(len + 2));
  }
#line 1033
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1034
    return ((dw_str *)0);
  }
  {
#line 1037
  tmp = dw_addchar((uint8_t )otype, out);
  }
#line 1037
  if (tmp == -1) {
    {
#line 1038
    dw_destroy(out);
    }
#line 1039
    return ((dw_str *)0);
  }
  {
#line 1042
  tmp___0 = dw_substr_append(in, toffset, len, out);
  }
#line 1042
  if (tmp___0 == -1) {
    {
#line 1043
    dw_destroy(out);
    }
#line 1044
    return ((dw_str *)0);
  }
#line 1047
  return (out);
}
}
#line 1051 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_nsglueless(dw_str *in , int32_t offset ) 
{ 
  dw_str *out ;
  dw_str *tmp ;
  int32_t rdlength ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 1052
  out = (dw_str *)0;
#line 1052
  tmp = (dw_str *)0;
#line 1053
  rdlength = 0;
#line 1055
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 1056
    return ((dw_str *)0);
  }
  {
#line 1059
  rdlength = dw_fetch_u16(in, offset);
#line 1060
  offset += 2;
#line 1061
  tmp = dwx_get_dns_string(in, offset);
  }
#line 1062
  if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 1063
    return ((dw_str *)0);
  }
#line 1065
  if (tmp->len != (uint32_t )rdlength) {
    {
#line 1066
    dw_destroy(tmp);
    }
#line 1067
    return ((dw_str *)0);
  }
  {
#line 1070
  out = dw_create((uint32_t )(rdlength + 5));
  }
#line 1071
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
    {
#line 1072
    dw_destroy(tmp);
    }
#line 1073
    return ((dw_str *)0);
  }
  {
#line 1076
  tmp___0 = dw_addchar((uint8_t )2, out);
  }
#line 1076
  if (tmp___0 == -1) {
    {
#line 1079
    dw_destroy(out);
#line 1080
    dw_destroy(tmp);
    }
#line 1081
    return ((dw_str *)0);
  } else {
    {
#line 1076
    tmp___1 = dw_put_u16(out, (uint16_t )rdlength, -1);
    }
#line 1076
    if (tmp___1 == -1) {
      {
#line 1079
      dw_destroy(out);
#line 1080
      dw_destroy(tmp);
      }
#line 1081
      return ((dw_str *)0);
    } else {
      {
#line 1076
      tmp___2 = dw_append(tmp, out);
      }
#line 1076
      if (tmp___2 == -1) {
        {
#line 1079
        dw_destroy(out);
#line 1080
        dw_destroy(tmp);
        }
#line 1081
        return ((dw_str *)0);
      }
    }
  }
  {
#line 1084
  dw_destroy(tmp);
  }
#line 1085
  return (out);
}
}
#line 1089 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_make_ns_refer_glued(dns_details *view , dw_str *out , uint16_t *offset , int *onumber ) 
{ 
  dw_str *tmp ;
  int counter ;
  int32_t toffset ;
  int tmp___0 ;

  {
#line 1091
  tmp = (dw_str *)0;
#line 1092
  counter = 0;
#line 1093
  toffset = 0;
#line 1095
  counter = 0;
  {
#line 1095
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1095
    if (! (counter < (view->look)->arcount * 2)) {
#line 1095
      goto while_break;
    }
#line 1096
    toffset = (int32_t )*((view->look)->ar + (counter + 1));
#line 1097
    toffset += 10;
#line 1098
    if ((int )*(view->ar_types + (counter >> 1)) >= 80) {
#line 1098
      if ((int )*(view->ar_types + (counter >> 1)) <= 95) {
#line 1098
        goto _L;
      } else {
#line 1098
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 1098
    if ((int )*(view->ar_types + (counter >> 1)) >= 64) {
#line 1098
      if ((int )*(view->ar_types + (counter >> 1)) <= 79) {
        _L: /* CIL Label */ 
        {
#line 1102
        *(offset + *onumber) = (uint16_t )out->len;
#line 1103
        (*onumber) ++;
#line 1104
        tmp = dwx_make_nsglue((view->look)->packet, toffset, (int )*(view->ar_types + (counter >> 1)));
#line 1106
        tmp___0 = dw_append(tmp, out);
        }
#line 1106
        if (tmp___0 == -1) {
          {
#line 1108
          dw_destroy(tmp);
          }
#line 1109
          return (-1);
        } else
#line 1106
        if (*onumber > 31) {
          {
#line 1108
          dw_destroy(tmp);
          }
#line 1109
          return (-1);
        }
        {
#line 1111
        dw_destroy(tmp);
#line 1112
        tmp = (dw_str *)0;
        }
      }
    }
#line 1095
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 1116
  return (1);
}
}
#line 1124 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_find_ns_referral(dns_details *view , int32_t out_len ) 
{ 
  int counter ;
  int max ;
  int max_num ;
  int32_t len ;
  dw_str *out ;
  int32_t tmp ;

  {
#line 1125
  counter = 0;
#line 1125
  max = 0;
#line 1125
  max_num = 0;
#line 1126
  len = 0;
#line 1127
  out = (dw_str *)0;
#line 1129
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1131
    return ((dw_str *)0);
  } else
#line 1129
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 1131
    return ((dw_str *)0);
  } else
#line 1129
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 1131
    return ((dw_str *)0);
  } else
#line 1129
  if ((unsigned long )(view->look)->ns == (unsigned long )((uint16_t *)0)) {
#line 1131
    return ((dw_str *)0);
  }
#line 1136
  counter = 0;
  {
#line 1136
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1136
    if (! (counter < (view->look)->nscount)) {
#line 1136
      goto while_break;
    }
#line 1137
    if ((int )*(view->ns_types + counter) != 36) {
#line 1137
      if ((int )*(view->ns_types + counter) != 37) {
        {
#line 1139
        tmp = dw_get_dn_end((view->look)->packet, (int )*((view->look)->ns + counter * 2));
#line 1139
        len = tmp - (int32_t )*((view->look)->ns + counter * 2);
        }
#line 1142
        if (len > max) {
#line 1143
          max = len;
#line 1144
          max_num = counter;
        }
      }
    }
#line 1136
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1149
  out = dw_substr((view->look)->packet, (int32_t )*((view->look)->ns + max_num * 2),
                  max, out_len + 3);
  }
#line 1151
  return (out);
}
}
#line 1158 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_ns_refer_proc(dns_details *view , int32_t out_len ) 
{ 
  uint16_t offset[33] ;
  int counter ;
  int onumber ;
  int32_t toffset ;
  dw_str *out ;
  dw_str *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 1160
  counter = 0;
#line 1160
  onumber = 0;
#line 1161
  toffset = 0;
#line 1162
  out = (dw_str *)0;
#line 1162
  tmp = (dw_str *)0;
#line 1164
  out = dwx_find_ns_referral(view, out_len);
  }
#line 1165
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1166
    return ((dw_str *)0);
  }
  {
#line 1169
  tmp___0 = dwx_make_ns_refer_glued(view, out, offset, & onumber);
  }
#line 1169
  if (tmp___0 == -1) {
#line 1170
    goto catch_dwx_make_ns_refer_proc;
  }
#line 1174
  counter = 0;
  {
#line 1174
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1174
    if (! (counter < (view->look)->nscount * 2)) {
#line 1174
      goto while_break;
    }
#line 1175
    if ((int )*(view->ns_types + (counter >> 1)) == 32) {
      {
#line 1176
      offset[onumber] = (uint16_t )out->len;
#line 1177
      onumber ++;
#line 1178
      toffset = (int32_t )*((view->look)->ns + (counter + 1));
#line 1179
      toffset += 8;
#line 1180
      tmp = dwx_make_nsglueless((view->look)->packet, toffset);
#line 1181
      tmp___1 = dw_append(tmp, out);
      }
#line 1181
      if (tmp___1 == -1) {
#line 1183
        goto catch_dwx_make_ns_refer_proc;
      } else
#line 1181
      if (onumber > 31) {
#line 1183
        goto catch_dwx_make_ns_refer_proc;
      }
      {
#line 1185
      dw_destroy(tmp);
#line 1186
      tmp = (dw_str *)0;
      }
    }
#line 1174
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 1190
  counter = 0;
  {
#line 1190
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 1190
    if (! (counter < onumber)) {
#line 1190
      goto while_break___0;
    }
    {
#line 1191
    tmp___2 = dw_put_u16(out, offset[counter], -1);
    }
#line 1191
    if (tmp___2 == -1) {
#line 1192
      goto catch_dwx_make_ns_refer_proc;
    }
#line 1190
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 1195
  tmp___3 = dw_addchar((uint8_t )onumber, out);
  }
#line 1195
  if (tmp___3 == -1) {
#line 1197
    goto catch_dwx_make_ns_refer_proc;
  } else {
    {
#line 1195
    tmp___4 = dw_addchar((uint8_t )16, out);
    }
#line 1195
    if (tmp___4 == -1) {
#line 1197
      goto catch_dwx_make_ns_refer_proc;
    }
  }
#line 1200
  return (out);
  catch_dwx_make_ns_refer_proc: 
#line 1203
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1204
    dw_destroy(out);
    }
  }
#line 1206
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 1207
    dw_destroy(tmp);
    }
  }
#line 1209
  return ((dw_str *)0);
}
}
#line 1233 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_ns_refer(dns_details *view ) 
{ 
  int32_t offset ;
  int32_t rdlength ;
  int counter ;
  int32_t out_len ;
  dw_str *tmp ;

  {
#line 1234
  offset = 0;
#line 1234
  rdlength = 0;
#line 1236
  out_len = 0;
#line 1238
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1241
    return ((dw_str *)0);
  } else
#line 1238
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 1241
    return ((dw_str *)0);
  } else
#line 1238
  if ((unsigned long )view->ar_types == (unsigned long )((int8_t *)0)) {
#line 1241
    return ((dw_str *)0);
  } else
#line 1238
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 1241
    return ((dw_str *)0);
  } else
#line 1238
  if ((unsigned long )(view->look)->ar == (unsigned long )((uint16_t *)0)) {
#line 1241
    return ((dw_str *)0);
  } else
#line 1238
  if ((unsigned long )(view->look)->ns == (unsigned long )((uint16_t *)0)) {
#line 1241
    return ((dw_str *)0);
  }
#line 1246
  counter = 0;
  {
#line 1246
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1246
    if (! (counter < (view->look)->arcount * 2)) {
#line 1246
      goto while_break;
    }
#line 1247
    if ((int )*(view->ar_types + (counter >> 1)) >= 80) {
#line 1247
      if ((int )*(view->ar_types + (counter >> 1)) <= 95) {
#line 1249
        out_len += 8;
      }
    }
#line 1251
    if ((int )*(view->ar_types + (counter >> 1)) >= 64) {
#line 1251
      if ((int )*(view->ar_types + (counter >> 1)) <= 79) {
#line 1253
        out_len += 20;
      }
    }
#line 1246
    counter += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 1257
  counter = 0;
  {
#line 1257
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 1257
    if (! (counter < (view->look)->nscount * 2)) {
#line 1257
      goto while_break___0;
    }
#line 1258
    if ((int )*(view->ns_types + (counter >> 1)) == 32) {
      {
#line 1259
      offset = (int32_t )*((view->look)->ns + (counter + 1));
#line 1260
      offset += 8;
#line 1261
      rdlength = dw_fetch_u16((view->look)->packet, offset);
      }
#line 1262
      if (rdlength <= 0) {
#line 1263
        return ((dw_str *)0);
      }
#line 1265
      out_len += rdlength + 6;
    }
#line 1257
    counter += 2;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 1269
  tmp = dwx_make_ns_refer_proc(view, out_len);
  }
#line 1269
  return (tmp);
}
}
#line 1279 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_copy_over_section(dw_str *out , dw_str *packet , int8_t *types , uint16_t *section ,
                          int32_t count , uint16_t *offsets , int32_t *out_count ,
                          int *this_offset , int max_offset ) 
{ 
  int counter ;
  dw_str *tmp ;
  int tmp___0 ;

  {
#line 1282
  counter = 0;
#line 1283
  tmp = (dw_str *)0;
#line 1285
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1286
    goto catch_dwx_copy_over_section;
  } else
#line 1285
  if ((unsigned long )types == (unsigned long )((int8_t *)0)) {
#line 1286
    goto catch_dwx_copy_over_section;
  } else
#line 1285
  if ((unsigned long )section == (unsigned long )((uint16_t *)0)) {
#line 1286
    goto catch_dwx_copy_over_section;
  } else
#line 1285
  if ((unsigned long )offsets == (unsigned long )((uint16_t *)0)) {
#line 1286
    goto catch_dwx_copy_over_section;
  }
#line 1289
  counter = 0;
  {
#line 1289
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1289
    if (! (counter < count)) {
#line 1289
      goto while_break;
    }
#line 1290
    if ((int )*(types + counter) == 36) {
#line 1292
      goto __Cont;
    } else
#line 1290
    if ((int )*(types + counter) == 37) {
#line 1292
      goto __Cont;
    }
    {
#line 1294
    tmp = dwx_get_1_dns_rr(packet, (int32_t )*(section + counter * 2));
    }
#line 1295
    if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 1296
      goto catch_dwx_copy_over_section;
    } else
#line 1295
    if (*this_offset + 1 > max_offset) {
#line 1296
      goto catch_dwx_copy_over_section;
    }
    {
#line 1298
    *(offsets + *this_offset) = (uint16_t )out->len;
#line 1299
    *(offsets + (*this_offset + 1)) = (uint16_t )(out->len + (uint32_t )((int )*(section + (counter * 2 + 1)) - (int )*(section + counter * 2)));
#line 1301
    *this_offset += 2;
#line 1302
    tmp___0 = dw_append(tmp, out);
    }
#line 1302
    if (tmp___0 == -1) {
#line 1303
      goto catch_dwx_copy_over_section;
    }
    {
#line 1305
    (*out_count) ++;
#line 1306
    dw_destroy(tmp);
#line 1307
    tmp = (dw_str *)0;
    }
    __Cont: /* CIL Label */ 
#line 1289
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1310
  return (1);
  catch_dwx_copy_over_section: 
#line 1313
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 1314
    dw_destroy(tmp);
    }
  }
#line 1316
  return (-1);
}
}
#line 1322 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_remake_footer(dw_str *out , uint16_t *offsets , uint16_t an , uint16_t ns ,
                      uint16_t ar , int type ) 
{ 
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 1324
  counter = 0;
#line 1326
  counter = 0;
  {
#line 1326
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1326
    if (! (counter < (((int )an + (int )ns) + (int )ar) * 2)) {
#line 1326
      goto while_break;
    }
    {
#line 1328
    tmp = dw_put_u16(out, *(offsets + counter), -1);
    }
#line 1328
    if (tmp == -1) {
#line 1329
      return (-1);
    }
#line 1326
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1334
  tmp___0 = dw_put_u16(out, an, -1);
  }
#line 1334
  if (tmp___0 == -1) {
#line 1338
    return (-1);
  } else {
    {
#line 1334
    tmp___1 = dw_put_u16(out, ns, -1);
    }
#line 1334
    if (tmp___1 == -1) {
#line 1338
      return (-1);
    } else {
      {
#line 1334
      tmp___2 = dw_put_u16(out, ar, -1);
      }
#line 1334
      if (tmp___2 == -1) {
#line 1338
        return (-1);
      } else {
        {
#line 1334
        tmp___3 = dw_addchar((uint8_t )type, out);
        }
#line 1334
        if (tmp___3 == -1) {
#line 1338
          return (-1);
        }
      }
    }
  }
#line 1341
  return (1);
}
}
#line 1369 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_remake_complete_reply(dns_details *view , int type ) 
{ 
  uint16_t *offsets ;
  int this_offset ;
  int32_t total_count___0 ;
  int32_t an ;
  int32_t ns ;
  int32_t ar ;
  dw_str *out ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 1370
  offsets = (uint16_t *)0;
#line 1371
  this_offset = 0;
#line 1372
  total_count___0 = 0;
#line 1372
  an = 0;
#line 1372
  ns = 0;
#line 1372
  ar = 0;
#line 1373
  out = (dw_str *)0;
#line 1375
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1376
    goto catch_dwx_make_complete_reply;
  } else
#line 1375
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 1376
    goto catch_dwx_make_complete_reply;
  } else
#line 1375
  if ((unsigned long )(view->look)->packet == (unsigned long )((dw_str *)0)) {
#line 1376
    goto catch_dwx_make_complete_reply;
  }
  {
#line 1379
  total_count___0 = (((view->look)->ancount + (view->look)->nscount) + (view->look)->arcount) * 2;
#line 1382
  tmp = malloc(sizeof(uint16_t ) * (unsigned long )total_count___0 + 1UL);
#line 1382
  offsets = (uint16_t *)tmp;
  }
#line 1383
  if ((unsigned long )offsets == (unsigned long )((uint16_t *)0)) {
#line 1384
    goto catch_dwx_make_complete_reply;
  }
  {
#line 1387
  out = dw_create(((view->look)->packet)->len + 1U);
#line 1388
  tmp___0 = dwx_copy_over_section(out, (view->look)->packet, view->an_types, (view->look)->an,
                                  (view->look)->ancount, offsets, & an, & this_offset,
                                  total_count___0);
  }
#line 1388
  if (tmp___0 == -1) {
#line 1397
    goto catch_dwx_make_complete_reply;
  } else {
    {
#line 1388
    tmp___1 = dwx_copy_over_section(out, (view->look)->packet, view->ns_types, (view->look)->ns,
                                    (view->look)->nscount, offsets, & ns, & this_offset,
                                    total_count___0);
    }
#line 1388
    if (tmp___1 == -1) {
#line 1397
      goto catch_dwx_make_complete_reply;
    } else {
      {
#line 1388
      tmp___2 = dwx_copy_over_section(out, (view->look)->packet, view->ar_types, (view->look)->ar,
                                      (view->look)->arcount, offsets, & ar, & this_offset,
                                      total_count___0);
      }
#line 1388
      if (tmp___2 == -1) {
#line 1397
        goto catch_dwx_make_complete_reply;
      }
    }
  }
  {
#line 1400
  tmp___3 = dwx_remake_footer(out, offsets, (uint16_t )an, (uint16_t )ns, (uint16_t )ar,
                              type);
  }
#line 1400
  if (tmp___3 == -1) {
#line 1401
    goto catch_dwx_make_complete_reply;
  }
  {
#line 1404
  free((void *)offsets);
  }
#line 1405
  return (out);
  catch_dwx_make_complete_reply: 
#line 1408
  if ((unsigned long )offsets != (unsigned long )((uint16_t *)0)) {
    {
#line 1409
    free((void *)offsets);
    }
  }
#line 1411
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1412
    dw_destroy(out);
    }
  }
#line 1414
  return ((dw_str *)0);
}
}
#line 1421 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_determine_answer_type(dns_details *view , dw_str *query , dw_str *in ) 
{ 
  int32_t query_type ;
  int counter ;
  int max ;
  int index___0 ;
  int8_t tmp ;
  int8_t tmp___0 ;
  int tmp___1 ;
  int32_t tmp___2 ;

  {
#line 1422
  query_type = 0;
#line 1423
  counter = 0;
#line 1424
  max = 32;
#line 1425
  index___0 = -1;
#line 1427
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 1428
    return (20);
  } else
#line 1427
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1428
    return (20);
  } else
#line 1427
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 1428
    return (20);
  }
  {
#line 1430
  query_type = dw_fetch_u16(query, -1);
  }
#line 1431
  if (query_type == -1) {
#line 1432
    return (20);
  }
#line 1435
  if ((view->look)->ancount > 0) {
#line 1436
    if ((unsigned long )view->an_types == (unsigned long )((int8_t *)0)) {
#line 1437
      return (20);
    }
#line 1439
    index___0 = 0;
    {
#line 1439
    while (1) {
      while_continue: /* CIL Label */ ;
#line 1439
      if (! (index___0 < 7)) {
#line 1439
        goto while_break;
      }
      {
#line 1440
      tmp = dwx_rrtype_number(query_type);
      }
#line 1440
      if ((int )*(view->an_types + index___0) == (int )tmp) {
#line 1444
        return (0);
      } else
#line 1440
      if (query_type == 255) {
#line 1440
        if ((int )*(view->an_types + index___0) != 5) {
#line 1444
          return (0);
        }
      }
#line 1446
      if ((int )*(view->an_types + index___0) == 5) {
#line 1447
        if ((view->look)->ancount < max) {
#line 1448
          max = (view->look)->ancount;
        }
#line 1450
        counter = index___0 + 1;
        {
#line 1450
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 1450
          if (! (counter < max)) {
#line 1450
            goto while_break___0;
          }
          {
#line 1452
          tmp___0 = dwx_rrtype_number(query_type);
          }
#line 1452
          if ((int )*(view->an_types + counter) == (int )tmp___0) {
#line 1457
            return (0);
          } else
#line 1452
          if (query_type == 255) {
#line 1452
            if ((int )*(view->an_types + counter) != 5) {
#line 1457
              return (0);
            }
          }
#line 1459
          if ((int )*(view->an_types + counter) != 5) {
#line 1459
            if ((int )*(view->an_types + counter) != 36) {
#line 1462
              return (19);
            }
          }
#line 1450
          counter ++;
        }
        while_break___0: /* CIL Label */ ;
        }
#line 1465
        return (17);
      }
#line 1467
      if ((int )*(view->an_types + index___0) != 36) {
#line 1468
        return (19);
      }
#line 1439
      index___0 ++;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 1472
  if ((unsigned long )view->ns_types == (unsigned long )((int8_t *)0)) {
#line 1473
    return (20);
  }
#line 1475
  if ((int )*(view->ns_types + 0) == 6) {
#line 1476
    return (2);
  }
#line 1478
  if ((int )*(view->ns_types + 0) == 2) {
#line 1480
    index___0 = 0;
    {
#line 1480
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 1480
      if (! (index___0 < (view->look)->arcount * 2)) {
#line 1480
        goto while_break___1;
      }
      {
#line 1481
      tmp___1 = dwx_dname_issame_2dw(query, (uint32_t )0, in, (uint32_t )*((view->look)->ar + index___0));
      }
#line 1481
      if (tmp___1 == 1) {
        {
#line 1481
        tmp___2 = dw_fetch_u16(in, (int32_t )*((view->look)->ar + (index___0 + 1)));
        }
#line 1481
        if (tmp___2 == query_type) {
#line 1485
          *(view->ar_types + (index___0 >> 1)) = (int8_t )38;
#line 1486
          return (23);
        }
      }
#line 1480
      index___0 += 2;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 1489
    return (16);
  }
#line 1491
  return (19);
}
}
#line 1502 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_cache_string(dns_details *view , int type ) 
{ 
  dw_str *out ;
  uint8_t in_type ;

  {
#line 1503
  out = (dw_str *)0;
#line 1504
  in_type = (uint8_t )0;
#line 1506
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1508
    return ((dw_str *)0);
  } else
#line 1506
  if ((unsigned long )view->look == (unsigned long )((dns_string *)0)) {
#line 1508
    return ((dw_str *)0);
  } else
#line 1506
  if ((unsigned long )(view->look)->packet == (unsigned long )((dw_str *)0)) {
#line 1508
    return ((dw_str *)0);
  } else
#line 1506
  if (((view->look)->packet)->len == 0U) {
#line 1508
    return ((dw_str *)0);
  } else
#line 1506
  if ((unsigned long )((view->look)->packet)->str == (unsigned long )((uint8_t *)0)) {
#line 1508
    return ((dw_str *)0);
  }
#line 1511
  in_type = *((((view->look)->packet)->str + ((view->look)->packet)->len) - 1);
#line 1513
  if ((int )in_type == 1) {
#line 1513
    if (type == 2) {
#line 1514
      type = 1;
    }
  }
#line 1517
  if ((int )in_type != 0) {
#line 1517
    if ((int )in_type != 1) {
#line 1518
      return ((dw_str *)0);
    }
  }
#line 1529
  if (type == 17) {
    {
#line 1530
    out = dwx_make_cname_refer(view);
    }
  } else
#line 1531
  if (type == 16) {
    {
#line 1532
    out = dwx_make_ns_refer(view);
    }
  } else
#line 1533
  if (type == 0) {
    {
#line 1535
    out = dwx_remake_complete_reply(view, type);
    }
  } else
#line 1533
  if (type == 1) {
    {
#line 1535
    out = dwx_remake_complete_reply(view, type);
    }
  } else
#line 1533
  if (type == 2) {
    {
#line 1535
    out = dwx_remake_complete_reply(view, type);
    }
  } else {
#line 1537
    return ((dw_str *)0);
  }
#line 1540
  return (out);
}
}
#line 1548 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_synth_notthere(dw_str *query ) 
{ 
  dw_str *hack ;
  dw_str *out ;
  int l ;
  void *tmp ;
  unsigned char *tmp___0 ;

  {
  {
#line 1550
  l = 20;
#line 1552
  tmp = malloc(sizeof(dw_str ));
#line 1552
  hack = (dw_str *)tmp;
  }
#line 1553
  if ((unsigned long )hack == (unsigned long )((dw_str *)0)) {
#line 1554
    return ((dw_str *)0);
  }
  {
#line 1556
  tmp___0 = make_synth_not_there_answer((unsigned char *)0, & l, 1);
#line 1556
  hack->str = tmp___0;
#line 1557
  hack->len = (uint32_t )40;
#line 1558
  hack->sane = (uint8_t )114;
#line 1559
  hack->max = (uint32_t )59;
#line 1560
  dw_put_u16(hack, (uint16_t )0, -1);
#line 1561
  dw_put_u16(hack, (uint16_t )1, -1);
#line 1562
  dw_put_u16(hack, (uint16_t )0, -1);
#line 1563
  dw_put_u8(hack, (uint8_t )2, -1);
#line 1564
  out = dwc_decompress(query, hack);
#line 1565
  dw_destroy(hack);
  }
#line 1567
  return (out);
}
}
#line 1574 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_answer_in_ar(dns_details *view , dw_str *in ) 
{ 
  dw_str *tmp ;
  dw_str *out ;
  int32_t dname_len ;
  int index___0 ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 1575
  tmp = (dw_str *)0;
#line 1575
  out = (dw_str *)0;
#line 1576
  dname_len = 0;
#line 1577
  index___0 = 0;
#line 1579
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1580
    return ((dw_str *)0);
  } else
#line 1579
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 1580
    return ((dw_str *)0);
  }
#line 1583
  index___0 = 0;
  {
#line 1583
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1583
    if (! (index___0 < (view->look)->arcount)) {
#line 1583
      goto while_break;
    }
#line 1584
    if ((int )*(view->ar_types + index___0) == 38) {
#line 1584
      if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
        {
#line 1585
        tmp = dwx_get_1_dns_rr(in, (int32_t )*((view->look)->ar + index___0 * 2));
#line 1586
        dname_len = (int )*((view->look)->ar + (index___0 * 2 + 1)) - (int )*((view->look)->ar + index___0 * 2);
        }
      }
    }
#line 1583
    index___0 ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1591
  if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 1592
    return ((dw_str *)0);
  }
  {
#line 1594
  out = dw_create(tmp->len + 14U);
  }
#line 1595
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
    {
#line 1596
    dw_destroy(tmp);
    }
#line 1597
    return ((dw_str *)0);
  }
  {
#line 1599
  tmp___0 = dw_append(tmp, out);
  }
#line 1599
  if (tmp___0 == -1) {
    {
#line 1606
    dw_destroy(tmp);
#line 1607
    dw_destroy(out);
    }
#line 1608
    return ((dw_str *)0);
  } else {
    {
#line 1599
    tmp___1 = dw_put_u16(out, (uint16_t )0, -1);
    }
#line 1599
    if (tmp___1 == -1) {
      {
#line 1606
      dw_destroy(tmp);
#line 1607
      dw_destroy(out);
      }
#line 1608
      return ((dw_str *)0);
    } else {
      {
#line 1599
      tmp___2 = dw_put_u16(out, (uint16_t )dname_len, -1);
      }
#line 1599
      if (tmp___2 == -1) {
        {
#line 1606
        dw_destroy(tmp);
#line 1607
        dw_destroy(out);
        }
#line 1608
        return ((dw_str *)0);
      } else {
        {
#line 1599
        tmp___3 = dw_put_u16(out, (uint16_t )1, -1);
        }
#line 1599
        if (tmp___3 == -1) {
          {
#line 1606
          dw_destroy(tmp);
#line 1607
          dw_destroy(out);
          }
#line 1608
          return ((dw_str *)0);
        } else {
          {
#line 1599
          tmp___4 = dw_put_u16(out, (uint16_t )0, -1);
          }
#line 1599
          if (tmp___4 == -1) {
            {
#line 1606
            dw_destroy(tmp);
#line 1607
            dw_destroy(out);
            }
#line 1608
            return ((dw_str *)0);
          } else {
            {
#line 1599
            tmp___5 = dw_put_u16(out, (uint16_t )0, -1);
            }
#line 1599
            if (tmp___5 == -1) {
              {
#line 1606
              dw_destroy(tmp);
#line 1607
              dw_destroy(out);
              }
#line 1608
              return ((dw_str *)0);
            } else {
              {
#line 1599
              tmp___6 = dw_addchar((uint8_t )0, out);
              }
#line 1599
              if (tmp___6 == -1) {
                {
#line 1606
                dw_destroy(tmp);
#line 1607
                dw_destroy(out);
                }
#line 1608
                return ((dw_str *)0);
              }
            }
          }
        }
      }
    }
  }
  {
#line 1611
  dw_destroy(tmp);
  }
#line 1612
  return (out);
}
}
#line 1622 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_dissect_packet(dw_str *in , dw_str *query , dw_str *bailiwick ) 
{ 
  dns_details *view ;
  dw_str *out ;
  int type ;
  int_fast32_t qtype ;
  int32_t tmp ;
  dw_str *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 1623
  view = (dns_details *)0;
#line 1624
  out = (dw_str *)0;
#line 1625
  type = 0;
#line 1626
  qtype = (int_fast32_t )0;
#line 1628
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 1629
    return ((dw_str *)0);
  } else
#line 1628
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 1629
    return ((dw_str *)0);
  } else
#line 1628
  if ((unsigned long )bailiwick == (unsigned long )((dw_str *)0)) {
#line 1629
    return ((dw_str *)0);
  }
  {
#line 1632
  tmp = dw_fetch_u16(query, -1);
#line 1632
  qtype = (int_fast32_t )tmp;
  }
#line 1634
  if (qtype == -1L) {
#line 1635
    return ((dw_str *)0);
  }
#line 1638
  if (in->len == 7U) {
#line 1638
    if (qtype == 28L) {
      {
#line 1639
      tmp___0 = dwx_synth_notthere(query);
      }
#line 1639
      return (tmp___0);
    }
  }
  {
#line 1642
  view = dwx_create_dns_details(in, query);
  }
#line 1644
  if ((unsigned long )view == (unsigned long )((dns_details *)0)) {
#line 1648
    goto catch_dwx_dissect_packet;
  } else {
    {
#line 1644
    tmp___1 = dwx_check_answer_section(in, query, view);
    }
#line 1644
    if (tmp___1 == -1) {
#line 1648
      goto catch_dwx_dissect_packet;
    } else {
      {
#line 1644
      tmp___2 = dwx_if_an_then_no_ns_nor_ar(view);
      }
#line 1644
      if (tmp___2 == -1) {
#line 1648
        goto catch_dwx_dissect_packet;
      } else {
        {
#line 1644
        tmp___3 = dwx_cleanup_ns_ar(view);
        }
#line 1644
        if (tmp___3 == -1) {
#line 1648
          goto catch_dwx_dissect_packet;
        }
      }
    }
  }
  {
#line 1650
  type = dwx_determine_answer_type(view, query, in);
  }
#line 1651
  if (type == 23) {
    {
#line 1652
    out = dwx_answer_in_ar(view, in);
    }
#line 1653
    if ((unsigned long )view != (unsigned long )((dns_details *)0)) {
      {
#line 1654
      dwx_zap_dns_details(view);
      }
    }
#line 1656
    return (out);
  }
#line 1658
  if (type == 16) {
    {
#line 1658
    tmp___4 = dwx_check_bailiwick_ns_section(view, query, bailiwick);
    }
#line 1658
    if (tmp___4 == -1) {
#line 1661
      goto catch_dwx_dissect_packet;
    } else {
      {
#line 1658
      tmp___5 = dwx_link_ns_records(view);
      }
#line 1658
      if (tmp___5 == -1) {
#line 1661
        goto catch_dwx_dissect_packet;
      }
    }
  }
  {
#line 1664
  out = dwx_make_cache_string(view, type);
#line 1665
  dwx_zap_dns_details(view);
  }
#line 1666
  return (out);
  catch_dwx_dissect_packet: 
#line 1669
  if ((unsigned long )view != (unsigned long )((dns_details *)0)) {
    {
#line 1670
    dwx_zap_dns_details(view);
    }
  }
#line 1672
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1673
    dw_destroy(out);
    }
  }
#line 1675
  return ((dw_str *)0);
}
}
#line 1680 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_handle_ns_refer_connect(int connection_number , dw_str *packet , dw_str *query ) 
{ 


  {
#line 1683
  (rem + connection_number)->die = the_time + ((int64_t )timeout_seconds << 8);
#line 1687
  if ((rem + connection_number)->socket != -1) {
    {
#line 1691
    close((rem + connection_number)->socket);
#line 1692
    (rem + connection_number)->socket = -1;
#line 1693
    *(b_remote + connection_number) = -1;
    }
  }
  {
#line 1695
  make_remote_connection(connection_number, packet->str, (int )packet->len, query,
                         (rem + connection_number)->socket);
  }
#line 1698
  return;
}
}
#line 1705 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_handle_ns_refer(int connection_number , dw_str *action , dw_str *query ,
                         int32_t ttl ) 
{ 
  dw_str *place ;
  dw_str *packet ;
  int32_t tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 1707
  place = (dw_str *)0;
#line 1707
  packet = (dw_str *)0;
#line 1709
  if ((unsigned long )(rem + connection_number)->ns == (unsigned long )((dw_str *)0)) {
#line 1711
    goto catch_dwx_handle_ns_refer;
  } else
#line 1709
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 1711
    goto catch_dwx_handle_ns_refer;
  } else
#line 1709
  if ((int )(rem + connection_number)->is_upstream == 1) {
#line 1711
    goto catch_dwx_handle_ns_refer;
  }
  {
#line 1714
  tmp = dw_fetch_u8(action, -1);
  }
#line 1714
  if (tmp != 16) {
#line 1715
    goto catch_dwx_handle_ns_refer;
  }
  {
#line 1719
  dw_destroy((rem + connection_number)->ns);
#line 1720
  (rem + connection_number)->ns = (dw_str *)0;
#line 1721
  (rem + connection_number)->ns = dw_substr(action, 0, -1, -1);
#line 1724
  place = dw_get_dname(action->str, 0, 260);
  }
#line 1725
  if ((unsigned long )place == (unsigned long )((dw_str *)0)) {
#line 1726
    goto catch_dwx_handle_ns_refer;
  }
#line 1728
  if (ttl < 3600) {
#line 1730
    ttl = 3600;
  }
#line 1732
  if (ttl > max_ttl) {
#line 1733
    ttl = max_ttl;
  }
  {
#line 1735
  dw_put_u16(place, (uint16_t )65395, -1);
#line 1736
  dwh_add(cache, place, action, ttl, 1);
#line 1739
  packet = make_dns_header((int32_t )(rem + connection_number)->remote_id, (int16_t )0,
                           0, 0, 0);
#line 1741
  tmp___0 = dw_append(query, packet);
  }
#line 1741
  if (tmp___0 == -1) {
#line 1742
    goto catch_dwx_handle_ns_refer;
  } else {
    {
#line 1741
    tmp___1 = dw_put_u16(packet, (uint16_t )1, -1);
    }
#line 1741
    if (tmp___1 == -1) {
#line 1742
      goto catch_dwx_handle_ns_refer;
    }
  }
  {
#line 1745
  dwx_handle_ns_refer_connect(connection_number, packet, query);
  }
  catch_dwx_handle_ns_refer: 
#line 1748
  if ((unsigned long )place != (unsigned long )((dw_str *)0)) {
    {
#line 1749
    dw_destroy(place);
    }
  }
#line 1751
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 1752
    dw_destroy(packet);
    }
  }
#line 1754
  return;
}
}
#line 1770 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_make_one_cname_rr(dw_str *question , int32_t question_offset , dw_str *answer ,
                              int32_t answer_offset , int32_t ttl , int *len , int size ) 
{ 
  dw_str *out ;
  dw_str *temp ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
#line 1773
  out = (dw_str *)0;
#line 1773
  temp = (dw_str *)0;
#line 1775
  if ((unsigned long )question == (unsigned long )((dw_str *)0)) {
#line 1777
    goto catch_dwx_make_one_cname_rr;
  } else
#line 1775
  if (question_offset < 0) {
#line 1777
    goto catch_dwx_make_one_cname_rr;
  } else
#line 1775
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 1777
    goto catch_dwx_make_one_cname_rr;
  } else
#line 1775
  if (answer_offset < 0) {
#line 1777
    goto catch_dwx_make_one_cname_rr;
  } else
#line 1775
  if ((unsigned long )len == (unsigned long )((int *)0)) {
#line 1777
    goto catch_dwx_make_one_cname_rr;
  }
  {
#line 1780
  temp = dw_get_dname(question->str, question_offset, size);
  }
#line 1781
  if ((unsigned long )temp == (unsigned long )((dw_str *)0)) {
#line 1782
    goto catch_dwx_make_one_cname_rr;
  }
  {
#line 1784
  out = dw_substr(temp, 0, -1, -1);
  }
#line 1785
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 1786
    goto catch_dwx_make_one_cname_rr;
  }
  {
#line 1788
  *len = (int )out->len;
#line 1789
  tmp = dw_put_u16(out, (uint16_t )5, -1);
  }
#line 1789
  if (tmp == -1) {
#line 1793
    goto catch_dwx_make_one_cname_rr;
  } else {
    {
#line 1789
    tmp___0 = dw_put_u16(out, (uint16_t )1, -1);
    }
#line 1789
    if (tmp___0 == -1) {
#line 1793
      goto catch_dwx_make_one_cname_rr;
    } else {
      {
#line 1789
      tmp___1 = dw_put_u16(out, (uint16_t )((ttl >> 16) & 65535), -1);
      }
#line 1789
      if (tmp___1 == -1) {
#line 1793
        goto catch_dwx_make_one_cname_rr;
      } else {
        {
#line 1789
        tmp___2 = dw_put_u16(out, (uint16_t )(ttl & 65535), -1);
        }
#line 1789
        if (tmp___2 == -1) {
#line 1793
          goto catch_dwx_make_one_cname_rr;
        }
      }
    }
  }
  {
#line 1795
  dw_destroy(temp);
#line 1796
  temp = dw_get_dname(answer->str, answer_offset, 260);
  }
#line 1797
  if ((unsigned long )temp == (unsigned long )((dw_str *)0)) {
#line 1799
    goto catch_dwx_make_one_cname_rr;
  } else {
    {
#line 1797
    tmp___3 = dw_put_u16(out, (uint16_t )temp->len, -1);
    }
#line 1797
    if (tmp___3 == -1) {
#line 1799
      goto catch_dwx_make_one_cname_rr;
    } else {
      {
#line 1797
      tmp___4 = dw_append(temp, out);
      }
#line 1797
      if (tmp___4 == -1) {
#line 1799
        goto catch_dwx_make_one_cname_rr;
      }
    }
  }
  {
#line 1801
  dw_destroy(temp);
#line 1802
  temp = (dw_str *)0;
  }
#line 1804
  return (out);
  catch_dwx_make_one_cname_rr: 
#line 1807
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 1808
    dw_destroy(out);
    }
  }
#line 1810
  if ((unsigned long )temp != (unsigned long )((dw_str *)0)) {
    {
#line 1811
    dw_destroy(temp);
    }
  }
#line 1813
  return ((dw_str *)0);
}
}
#line 1818 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_add_final_answer(dw_str *query , dw_str *answer , dw_str *value___6 , uint16_t *offsets ,
                          int this_offset ) 
{ 
  int32_t start ;
  int32_t end ;
  dw_str *temp ;
  int first_offset ;
  int place ;
  int rdlength ;
  int last_place ;

  {
#line 1820
  start = 0;
#line 1820
  end = 0;
#line 1821
  temp = (dw_str *)0;
#line 1822
  first_offset = 0;
#line 1822
  place = 0;
#line 1822
  rdlength = 0;
#line 1823
  last_place = 0;
#line 1825
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
#line 1826
    return;
  }
  {
#line 1832
  dwc_rr_rotate(answer, & start, & end);
  }
#line 1834
  if (start < 0) {
#line 1835
    return;
  } else
#line 1834
  if (end < 0) {
#line 1835
    return;
  }
  {
#line 1838
  temp = dw_substr(answer, start, end - start, 1);
  }
#line 1839
  if ((unsigned long )temp == (unsigned long )((dw_str *)0)) {
#line 1840
    return;
  }
#line 1843
  first_offset = (int )value___6->len;
  {
#line 1844
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1844
    if (! (this_offset < 15)) {
#line 1844
      goto while_break;
    }
    {
#line 1846
    last_place = place;
#line 1848
    *(offsets + this_offset * 2) = (uint16_t )(place + first_offset);
#line 1849
    place = dw_get_dn_end(temp, place);
    }
#line 1850
    if (place < 0) {
      {
#line 1851
      dw_destroy(temp);
      }
#line 1852
      return;
    }
    {
#line 1854
    *(offsets + (this_offset * 2 + 1)) = (uint16_t )(place + first_offset);
#line 1855
    place += 8;
#line 1856
    rdlength = dw_fetch_u16(temp, place);
    }
#line 1857
    if (rdlength < 0) {
      {
#line 1858
      dw_destroy(temp);
      }
#line 1859
      return;
    }
#line 1861
    place += rdlength + 2;
#line 1864
    if ((uint32_t )(place + first_offset) > (value___6->max - 8U) - (uint32_t )(this_offset * 4)) {
#line 1865
      if ((uint32_t )last_place < temp->len) {
#line 1866
        temp->len = (uint32_t )last_place;
#line 1867
        place = last_place;
      }
#line 1869
      goto while_break;
    }
#line 1872
    this_offset ++;
#line 1873
    if ((uint32_t )place >= temp->len) {
#line 1874
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1879
  if ((uint32_t )place < temp->len) {
#line 1880
    temp->len = (uint32_t )place;
  }
#line 1883
  if ((uint32_t )(place + first_offset) > (value___6->max - 8U) - (uint32_t )(this_offset * 4)) {
#line 1884
    if ((uint32_t )last_place < temp->len) {
#line 1885
      temp->len = (uint32_t )last_place;
#line 1886
      this_offset --;
    }
  }
  {
#line 1890
  dw_append(temp, value___6);
#line 1891
  dw_destroy(temp);
#line 1894
  rdlength = 0;
  }
  {
#line 1894
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 1894
    if (! (rdlength < this_offset * 2)) {
#line 1894
      goto while_break___0;
    }
    {
#line 1895
    dw_put_u16(value___6, *(offsets + rdlength), -1);
#line 1894
    rdlength ++;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 1897
  dw_put_u16(value___6, (uint16_t )this_offset, -1);
#line 1898
  dw_put_u16(value___6, (uint16_t )0, -1);
#line 1899
  dw_put_u16(value___6, (uint16_t )0, -1);
#line 1900
  dw_put_u8(value___6, (uint8_t )0, -1);
  }
#line 1902
  return;
}
}
#line 1907 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_alt_cname_reply(dw_str *query , dw_str *action , dw_str *answer , int32_t ttl ) 
{ 
  int len ;
  int place ;
  int type ;
  dw_str *value___6 ;

  {
  {
#line 1909
  len = 0;
#line 1909
  place = 0;
#line 1909
  type = 0;
#line 1910
  value___6 = (dw_str *)0;
#line 1912
  type = dw_fetch_u8(answer, -1);
#line 1914
  value___6 = dwx_make_one_cname_rr(query, 0, action, 2, ttl, & len, 260);
#line 1915
  place = dw_get_dn_end(value___6, 0);
#line 1916
  dw_put_u16(value___6, (uint16_t )0, -1);
#line 1917
  dw_put_u16(value___6, (uint16_t )place, -1);
#line 1918
  dw_put_u16(value___6, (uint16_t )1, -1);
#line 1919
  dw_put_u16(value___6, (uint16_t )0, -1);
#line 1920
  dw_put_u16(value___6, (uint16_t )0, -1);
#line 1921
  dw_put_u8(value___6, (uint8_t )0, -1);
  }
#line 1922
  return (value___6);
}
}
#line 1926 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_create_cname_reply(dw_str *query , dw_str *action , dw_str *answer , int32_t ttl ) 
{ 
  dw_str *value___6 ;
  dw_str *temp ;
  int32_t length ;
  int32_t final_offset ;
  int32_t current_offset ;
  int this_offset ;
  int len ;
  uint16_t offsets[32] ;
  int32_t tmp ;
  dw_str *tmp___0 ;
  int32_t tmp___1 ;
  int tmp___2 ;

  {
  {
#line 1928
  value___6 = (dw_str *)0;
#line 1928
  temp = (dw_str *)0;
#line 1929
  length = 0;
#line 1929
  final_offset = 0;
#line 1929
  current_offset = 0;
#line 1930
  this_offset = 0;
#line 1930
  len = 0;
#line 1933
  final_offset = dw_fetch_u16(action, -2);
  }
#line 1934
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 1936
    goto catch_dwx_create_cname_reply;
  } else
#line 1934
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 1936
    goto catch_dwx_create_cname_reply;
  } else
#line 1934
  if (final_offset == -1) {
#line 1936
    goto catch_dwx_create_cname_reply;
  } else {
    {
#line 1934
    tmp = dw_fetch_u8(action, -1);
    }
#line 1934
    if (tmp != 17) {
#line 1936
      goto catch_dwx_create_cname_reply;
    }
  }
  {
#line 1938
  tmp___1 = dw_fetch_u8(answer, -1);
  }
#line 1938
  if (tmp___1 != 0) {
    {
#line 1939
    tmp___0 = dwx_alt_cname_reply(query, action, answer, ttl);
    }
#line 1939
    return (tmp___0);
  }
  {
#line 1943
  value___6 = dwx_make_one_cname_rr(query, 0, action, 2, ttl, & len, 1024);
  }
#line 1944
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
    {
#line 1945
    dw_log_string((char *)"dwx_make_one_cname_rr problem", 100);
    }
#line 1946
    goto catch_dwx_create_cname_reply;
  } else
#line 1944
  if (value___6->len > 1020U) {
    {
#line 1945
    dw_log_string((char *)"dwx_make_one_cname_rr problem", 100);
    }
#line 1946
    goto catch_dwx_create_cname_reply;
  }
#line 1948
  offsets[0] = (uint16_t )0;
#line 1949
  offsets[1] = (uint16_t )len;
#line 1950
  this_offset = 1;
  {
#line 1953
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1953
    if (current_offset < final_offset) {
#line 1953
      if (! (this_offset < 12)) {
#line 1953
        goto while_break;
      }
    } else {
#line 1953
      goto while_break;
    }
    {
#line 1954
    length = dw_fetch_u16(action, current_offset);
    }
#line 1955
    if (length < 1) {
#line 1956
      goto catch_dwx_create_cname_reply;
    }
    {
#line 1958
    temp = dwx_make_one_cname_rr(action, current_offset + 2, action, (current_offset + length) + 4,
                                 ttl, & len, 260);
    }
#line 1961
    if ((unsigned long )temp == (unsigned long )((dw_str *)0)) {
#line 1962
      goto catch_dwx_create_cname_reply;
    }
    {
#line 1964
    offsets[this_offset * 2] = (uint16_t )value___6->len;
#line 1965
    offsets[this_offset * 2 + 1] = (uint16_t )(value___6->len + (uint32_t )len);
#line 1966
    tmp___2 = dw_append(temp, value___6);
    }
#line 1966
    if (tmp___2 == -1) {
      {
#line 1967
      dw_log_string((char *)"Append error making cname reply", 100);
      }
#line 1968
      goto catch_dwx_create_cname_reply;
    } else
#line 1966
    if (value___6->len > 1020U) {
      {
#line 1967
      dw_log_string((char *)"Append error making cname reply", 100);
      }
#line 1968
      goto catch_dwx_create_cname_reply;
    }
    {
#line 1970
    dw_destroy(temp);
#line 1971
    current_offset += length + 2;
#line 1972
    this_offset ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1976
  dwx_add_final_answer(query, answer, value___6, offsets, this_offset);
  }
#line 1978
  if (value___6->len > 1020U) {
    {
#line 1979
    dw_log_string((char *)"Final append error making cname reply", 100);
    }
#line 1980
    goto catch_dwx_create_cname_reply;
  }
#line 1984
  return (value___6);
  catch_dwx_create_cname_reply: 
#line 1987
  if ((unsigned long )value___6 != (unsigned long )((dw_str *)0)) {
    {
#line 1988
    dw_destroy(value___6);
    }
  }
#line 1990
  if ((unsigned long )temp != (unsigned long )((dw_str *)0)) {
    {
#line 1991
    dw_destroy(temp);
    }
  }
#line 1993
  return ((dw_str *)0);
}
}
#line 2050 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_send_glueless_cname_upstream(int conn_num , int c , int depth , dw_str *uncomp ) 
{ 
  dw_str *cname_cache ;
  dw_str *child_action ;
  int upstream ;
  int tmp ;

  {
  {
#line 2052
  cname_cache = (dw_str *)0;
#line 2052
  child_action = (dw_str *)0;
#line 2053
  upstream = -1;
#line 2055
  upstream = (*((rem + conn_num)->local + c))->glueless_conn;
#line 2056
  cname_cache = dw_substr((rem + upstream)->query, 0, -1, -1);
  }
#line 2057
  if ((unsigned long )cname_cache == (unsigned long )((dw_str *)0)) {
#line 2059
    goto catch_dwx_send_glueless_cname_upstream;
  } else
#line 2057
  if (cname_cache->len < 3U) {
#line 2059
    goto catch_dwx_send_glueless_cname_upstream;
  } else {
    {
#line 2057
    tmp = dw_put_u16(cname_cache, (uint16_t )65394, -3);
    }
#line 2057
    if (tmp == -1) {
#line 2059
      goto catch_dwx_send_glueless_cname_upstream;
    }
  }
  {
#line 2061
  child_action = dwh_get(cache, cname_cache, 0, 1);
#line 2062
  dwx_make_cname_reply(upstream, (rem + upstream)->query, child_action, uncomp, depth + 1);
  }
  catch_dwx_send_glueless_cname_upstream: 
#line 2066
  if ((unsigned long )cname_cache != (unsigned long )((dw_str *)0)) {
    {
#line 2067
    dw_destroy(cname_cache);
    }
  }
#line 2069
  if ((unsigned long )child_action != (unsigned long )((dw_str *)0)) {
    {
#line 2070
    dw_destroy(child_action);
    }
  }
#line 2072
  return;
}
}
#line 2078 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_make_cname_reply(int conn_num , dw_str *query , dw_str *action , dw_str *answer ,
                         int depth ) 
{ 
  dw_str *uncomp ;
  dw_str *reply ;
  dw_str *comp ;
  int ret ;
  int c ;
  int_fast32_t ttl ;
  int ancount ;
  int32_t tmp ;

  {
#line 2080
  uncomp = (dw_str *)0;
#line 2080
  reply = (dw_str *)0;
#line 2080
  comp = (dw_str *)0;
#line 2081
  ret = -1;
#line 2081
  c = 0;
#line 2082
  ttl = (int_fast32_t )3600;
#line 2083
  ancount = 0;
#line 2085
  if (depth > 32) {
#line 2086
    goto catch_dwx_make_cname_reply;
  }
#line 2089
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 2090
    goto catch_dwx_make_cname_reply;
  } else
#line 2089
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 2090
    goto catch_dwx_make_cname_reply;
  } else
#line 2089
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 2090
    goto catch_dwx_make_cname_reply;
  }
  {
#line 2093
  ancount = dw_fetch_u16(answer, -6);
  }
#line 2094
  if (ancount < 1) {
#line 2095
    goto catch_dwx_make_cname_reply;
  }
  {
#line 2097
  tmp = dw_get_a_dnsttl(answer, 0, 31536000, ancount);
#line 2097
  ttl = (int_fast32_t )tmp;
  }
#line 2098
  if (ttl < 0L) {
    {
#line 2099
    dw_log_dwstr((char *)"Invalid TTL in answer ", answer, 100);
#line 2100
    ttl = (int_fast32_t )3600;
    }
  }
#line 2102
  if (ttl < 60L) {
#line 2103
    ttl = (int_fast32_t )60;
  }
#line 2105
  if (ttl > (int_fast32_t )max_ttl) {
#line 2106
    ttl = (int_fast32_t )max_ttl;
  }
  {
#line 2109
  uncomp = dwx_create_cname_reply(query, action, answer, (int32_t )ttl);
#line 2110
  comp = dwc_compress(query, uncomp);
  }
#line 2113
  if ((unsigned long )uncomp == (unsigned long )((dw_str *)0)) {
#line 2115
    goto catch_dwx_make_cname_reply;
  } else
#line 2113
  if ((unsigned long )comp == (unsigned long )((dw_str *)0)) {
#line 2115
    goto catch_dwx_make_cname_reply;
  } else
#line 2113
  if ((unsigned long )(rem + conn_num)->local == (unsigned long )((local_T **)0)) {
#line 2115
    goto catch_dwx_make_cname_reply;
  } else
#line 2113
  if ((int )(rem + conn_num)->num_locals < 1) {
#line 2115
    goto catch_dwx_make_cname_reply;
  }
  {
#line 2119
  dwh_add(cache, query, uncomp, (int32_t )ttl, 1);
#line 2122
  c = 0;
  }
  {
#line 2122
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2122
    if (! (c < (int )(rem + conn_num)->num_locals)) {
#line 2122
      goto while_break;
    }
#line 2123
    if ((unsigned long )*((rem + conn_num)->local + c) == (unsigned long )((local_T *)0)) {
#line 2124
      goto catch_dwx_make_cname_reply;
    }
#line 2126
    if ((int )(*((rem + conn_num)->local + c))->glueless_type == 2) {
      {
#line 2127
      dwx_send_glueless_cname_upstream(conn_num, c, depth, uncomp);
      }
#line 2129
      goto __Cont;
    }
#line 2131
    if ((int )(*((rem + conn_num)->local + c))->glueless_type == 1) {
#line 2133
      goto __Cont;
    }
#line 2135
    if ((int )(*((rem + conn_num)->local + c))->glueless_type == 3) {
      {
#line 2136
      dwx_cached_cname_done(query, conn_num, c, depth);
      }
#line 2137
      goto __Cont;
    }
    {
#line 2139
    reply = make_dns_packet(query, comp, (int32_t )(*((rem + conn_num)->local + c))->local_id);
    }
#line 2141
    if ((unsigned long )reply == (unsigned long )((dw_str *)0)) {
#line 2142
      goto catch_dwx_make_cname_reply;
    }
    {
#line 2144
    send_reply_from_cache(reply->str, (ssize_t )reply->len, conn_num, c);
#line 2145
    dw_destroy(reply);
    }
    __Cont: /* CIL Label */ 
#line 2122
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 2148
  reset_rem((int_fast32_t )conn_num);
#line 2149
  close(*(b_remote + conn_num));
#line 2150
  *(b_remote + conn_num) = -1;
#line 2151
  reply = (dw_str *)0;
  }
  catch_dwx_make_cname_reply: 
#line 2155
  if ((unsigned long )reply != (unsigned long )((dw_str *)0)) {
    {
#line 2156
    dw_destroy(reply);
    }
  }
#line 2158
  if ((unsigned long )uncomp != (unsigned long )((dw_str *)0)) {
    {
#line 2159
    dw_destroy(uncomp);
    }
  }
#line 2161
  if ((unsigned long )comp != (unsigned long )((dw_str *)0)) {
    {
#line 2162
    dw_destroy(comp);
    }
  }
#line 2164
  return (ret);
}
}
#line 2168 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_handle_cname_refer(int connection_number , dw_str *action , dw_str *query ,
                           int32_t ttl ) 
{ 
  int32_t qtype ;
  int32_t offset ;
  dw_str *real_query ;
  dw_str *cname_cache ;
  dw_str *answer ;
  int ret ;
  int tmp ;
  int32_t tmp___0 ;
  int tmp___1 ;

  {
#line 2170
  qtype = 0;
#line 2170
  offset = 0;
#line 2171
  real_query = (dw_str *)0;
#line 2171
  cname_cache = (dw_str *)0;
#line 2171
  answer = (dw_str *)0;
#line 2172
  ret = -1;
#line 2175
  if (ttl < key_n[28]) {
#line 2176
    ttl = key_n[28];
  }
#line 2178
  if (ttl < 30) {
#line 2179
    ttl = 30;
  }
#line 2181
  if (ttl > max_ttl) {
#line 2182
    ttl = max_ttl;
  }
  {
#line 2184
  cname_cache = dw_substr(query, 0, -1, -1);
  }
#line 2185
  if ((unsigned long )cname_cache == (unsigned long )((dw_str *)0)) {
#line 2187
    goto catch_dwx_handle_cname_refer;
  } else
#line 2185
  if (cname_cache->len < 3U) {
#line 2187
    goto catch_dwx_handle_cname_refer;
  } else {
    {
#line 2185
    tmp = dw_put_u16(cname_cache, (uint16_t )65394, -3);
    }
#line 2185
    if (tmp == -1) {
#line 2187
      goto catch_dwx_handle_cname_refer;
    }
  }
  {
#line 2189
  dwh_add(cache, cname_cache, action, ttl, 1);
  }
#line 2192
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 2194
    goto catch_dwx_handle_cname_refer;
  } else
#line 2192
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 2194
    goto catch_dwx_handle_cname_refer;
  } else {
    {
#line 2192
    tmp___0 = dw_fetch_u8(action, -1);
    }
#line 2192
    if (tmp___0 != 17) {
#line 2194
      goto catch_dwx_handle_cname_refer;
    }
  }
  {
#line 2196
  offset = dw_fetch_u16(action, -2);
#line 2197
  offset += 2;
#line 2198
  real_query = dw_get_dname(action->str, offset, 260);
#line 2199
  dwc_lower_case(real_query);
  }
#line 2200
  if ((unsigned long )real_query == (unsigned long )((dw_str *)0)) {
#line 2201
    goto catch_dwx_handle_cname_refer;
  }
  {
#line 2203
  qtype = dw_fetch_u16(query, -1);
  }
#line 2204
  if (qtype == -1) {
#line 2205
    goto catch_dwx_handle_cname_refer;
  } else {
    {
#line 2204
    tmp___1 = dw_put_u16(real_query, (uint16_t )qtype, -1);
    }
#line 2204
    if (tmp___1 == -1) {
#line 2205
      goto catch_dwx_handle_cname_refer;
    }
  }
  {
#line 2209
  answer = dwh_get(cache, real_query, 0, 1);
  }
#line 2210
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 2211
    ret = dwx_make_cname_reply(connection_number, query, action, answer, 0);
    }
#line 2213
    goto catch_dwx_handle_cname_refer;
  } else {
    {
#line 2215
    ret = dwx_do_cname_glueless(real_query, connection_number);
    }
  }
  catch_dwx_handle_cname_refer: 
#line 2219
  if ((unsigned long )real_query != (unsigned long )((dw_str *)0)) {
    {
#line 2220
    dw_destroy(real_query);
    }
  }
#line 2222
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 2223
    dw_destroy(answer);
    }
  }
#line 2225
  if ((unsigned long )cname_cache != (unsigned long )((dw_str *)0)) {
    {
#line 2226
    dw_destroy(cname_cache);
    }
  }
#line 2228
  return (ret);
}
}
#line 2246 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_cache_reply(dw_hash *cache___0 , dw_str *query , dw_str *in , int32_t ttl ,
                    int connection_number ) 
{ 
  dw_str *action ;
  dw_str *bailiwick ;
  int type ;
  int ret ;

  {
#line 2248
  action = (dw_str *)0;
#line 2249
  bailiwick = (dw_str *)0;
#line 2251
  ret = 0;
#line 2253
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 2254
    ret = -1;
#line 2255
    goto catch_dwx_cache_reply;
  } else
#line 2253
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 2254
    ret = -1;
#line 2255
    goto catch_dwx_cache_reply;
  }
#line 2258
  if ((unsigned long )(rem + connection_number)->ns == (unsigned long )((dw_str *)0)) {
#line 2259
    ret = -1;
#line 2260
    goto catch_dwx_cache_reply;
  }
#line 2263
  if (ttl < 30) {
#line 2264
    ttl = 30;
  }
#line 2266
  if (ttl > max_ttl) {
#line 2267
    ttl = max_ttl;
  }
  {
#line 2270
  bailiwick = dw_get_dname(((rem + connection_number)->ns)->str, 0, 260);
  }
#line 2271
  if ((unsigned long )bailiwick == (unsigned long )((dw_str *)0)) {
#line 2272
    ret = -1;
#line 2273
    goto catch_dwx_cache_reply;
  } else
#line 2271
  if (bailiwick->len > 256U) {
#line 2272
    ret = -1;
#line 2273
    goto catch_dwx_cache_reply;
  }
  {
#line 2276
  action = dwx_dissect_packet(in, query, bailiwick);
  }
#line 2277
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 2278
    ret = -1;
#line 2279
    goto catch_dwx_cache_reply;
  }
  {
#line 2281
  type = dw_fetch_u8(action, -1);
  }
#line 2283
  if (type == 0) {
    {
#line 2285
    dw_log_dwstr((char *)"Caching direct answer at ", query, 100);
#line 2286
    dwh_add(cache___0, query, action, ttl, 1);
#line 2287
    ret = 1;
    }
#line 2288
    goto catch_dwx_cache_reply;
  } else
#line 2283
  if (type == 1) {
    {
#line 2285
    dw_log_dwstr((char *)"Caching direct answer at ", query, 100);
#line 2286
    dwh_add(cache___0, query, action, ttl, 1);
#line 2287
    ret = 1;
    }
#line 2288
    goto catch_dwx_cache_reply;
  } else
#line 2283
  if (type == 2) {
    {
#line 2285
    dw_log_dwstr((char *)"Caching direct answer at ", query, 100);
#line 2286
    dwh_add(cache___0, query, action, ttl, 1);
#line 2287
    ret = 1;
    }
#line 2288
    goto catch_dwx_cache_reply;
  }
#line 2291
  if (type == 16) {
#line 2291
    if ((int )(rem + connection_number)->is_upstream == 0) {
      {
#line 2292
      ret = 16;
#line 2293
      dw_log_dwstr((char *)"Processing NS refer for ", query, 100);
#line 2294
      dwx_handle_ns_refer(connection_number, action, query, ttl);
      }
#line 2295
      goto catch_dwx_cache_reply;
    }
  }
#line 2298
  if (type == 17) {
#line 2298
    if ((int )(rem + connection_number)->is_upstream == 0) {
      {
#line 2300
      ret = type;
#line 2301
      dw_log_dwstr((char *)"Processing incomplete CNAME for ", query, 100);
#line 2302
      dwx_handle_cname_refer(connection_number, action, query, ttl);
      }
#line 2303
      goto catch_dwx_cache_reply;
    }
  }
#line 2307
  ret = -1;
  catch_dwx_cache_reply: 
#line 2310
  if ((unsigned long )bailiwick != (unsigned long )((dw_str *)0)) {
    {
#line 2311
    dw_destroy(bailiwick);
    }
  }
#line 2313
  if ((unsigned long )action != (unsigned long )((dw_str *)0)) {
    {
#line 2314
    dw_destroy(action);
#line 2315
    action = (dw_str *)0;
    }
  }
#line 2317
  return (ret);
}
}
#line 2324 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_ns_convert_1ip(char *ip_human , uint8_t *ip_raw ) 
{ 
  int ip_type ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 2325
  ip_type = 0;
#line 2327
  tmp___0 = inet_pton(2, (char const   */* __restrict  */)ip_human, (void */* __restrict  */)ip_raw);
  }
#line 2327
  if (tmp___0 > 0) {
#line 2328
    ip_type = 4;
  } else {
    {
#line 2330
    tmp = inet_pton(10, (char const   */* __restrict  */)ip_human, (void */* __restrict  */)ip_raw);
    }
#line 2330
    if (tmp > 0) {
#line 2331
      ip_type = 16;
    }
  }
#line 2335
  return (ip_type);
}
}
#line 2340 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_ns_convert_number(int in ) 
{ 


  {
#line 2341
  if (in == 4) {
#line 2342
    return (1);
  } else
#line 2343
  if (in == 16) {
#line 2344
    return (28);
  }
#line 2346
  return (-1);
}
}
#line 2350 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_ns_add_1record(dw_str *out , int ip_type , uint8_t *ip_raw ) 
{ 
  int num ;
  int counter ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 2351
  num = 0;
#line 2351
  counter = 0;
#line 2353
  num = dwx_ns_convert_number(ip_type);
  }
#line 2354
  if (num == -1) {
#line 2355
    return (-1);
  } else {
    {
#line 2354
    tmp = dw_put_u8(out, (uint8_t )num, -1);
    }
#line 2354
    if (tmp == -1) {
#line 2355
      return (-1);
    }
  }
#line 2357
  counter = 0;
  {
#line 2357
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2357
    if (! (counter < ip_type)) {
#line 2357
      goto while_break;
    }
    {
#line 2358
    tmp___0 = dw_put_u8(out, *(ip_raw + counter), -1);
    }
#line 2358
    if (tmp___0 == -1) {
#line 2359
      return (-1);
    }
#line 2357
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2362
  return (1);
}
}
#line 2366 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_ns_convert_init(dw_str *bailiwick ) 
{ 
  dw_str *out ;
  dw_str *dname ;
  int tmp ;

  {
#line 2367
  out = (dw_str *)0;
#line 2367
  dname = (dw_str *)0;
#line 2369
  if ((unsigned long )bailiwick == (unsigned long )((dw_str *)0)) {
    {
#line 2370
    out = dw_create((uint32_t )256);
    }
#line 2371
    if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 2372
      return ((dw_str *)0);
    }
    {
#line 2374
    tmp = dw_put_u8(out, (uint8_t )0, -1);
    }
#line 2374
    if (tmp == -1) {
      {
#line 2375
      dw_destroy(out);
      }
#line 2376
      return ((dw_str *)0);
    }
  } else {
    {
#line 2379
    dname = dw_get_dname(bailiwick->str, 0, 260);
    }
#line 2380
    if ((unsigned long )dname == (unsigned long )((dw_str *)0)) {
#line 2381
      return ((dw_str *)0);
    }
#line 2383
    if (dname->len > 256U) {
      {
#line 2384
      dw_destroy(dname);
      }
#line 2385
      return ((dw_str *)0);
    }
    {
#line 2387
    out = dw_substr(dname, 0, -1, 256);
#line 2388
    dw_destroy(dname);
    }
#line 2389
    if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 2390
      return ((dw_str *)0);
    }
  }
#line 2394
  return (out);
}
}
#line 2398 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_zap_whitespace(char *in ) 
{ 
  int counter ;

  {
#line 2399
  counter = 0;
#line 2401
  if ((unsigned long )in == (unsigned long )((char *)0)) {
#line 2402
    return;
  }
#line 2405
  counter = 0;
  {
#line 2405
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2405
    if (! (counter < 512)) {
#line 2405
      goto while_break;
    }
#line 2406
    if ((int )*in == 0) {
#line 2407
      return;
    }
#line 2409
    if ((int )*in == 32) {
#line 2410
      *in = (char)0;
#line 2411
      return;
    } else
#line 2409
    if ((int )*in == 9) {
#line 2410
      *in = (char)0;
#line 2411
      return;
    }
#line 2413
    in ++;
#line 2405
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2415
  return;
}
}
#line 2419 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_ns_convert_mangle(dw_str *mangle , int is_upstream , dw_str *b ) 
{ 
  int counter ;
  int ip_type ;
  int a ;
  char *ip_human ;
  uint8_t ip_raw[24] ;
  uint16_t offsets[32] ;
  dw_str *out ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 2420
  counter = 0;
#line 2420
  ip_type = 0;
#line 2420
  a = 0;
#line 2421
  ip_human = (char *)0;
#line 2424
  out = (dw_str *)0;
#line 2427
  out = dwx_ns_convert_init(b);
  }
#line 2428
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 2429
    goto clean_dwx_ns_convert_mangle;
  }
#line 2433
  counter = 0;
  {
#line 2433
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2433
    if (! (counter < 30)) {
#line 2433
      goto while_break;
    }
    {
#line 2434
    ip_human = pop_last_item(mangle);
#line 2435
    dwx_zap_whitespace(ip_human);
#line 2436
    ip_type = dwx_ns_convert_1ip(ip_human, ip_raw);
#line 2437
    free((void *)ip_human);
    }
#line 2438
    if (ip_type == 0) {
#line 2439
      goto while_break;
    }
    {
#line 2441
    offsets[counter] = (uint16_t )out->len;
#line 2442
    tmp = dwx_ns_add_1record(out, ip_type, ip_raw);
    }
#line 2442
    if (tmp == -1) {
#line 2443
      goto clean_dwx_ns_convert_mangle;
    }
#line 2433
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2448
  a = 0;
  {
#line 2448
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 2448
    if (a < counter) {
#line 2448
      if (! (a < 31)) {
#line 2448
        goto while_break___0;
      }
    } else {
#line 2448
      goto while_break___0;
    }
    {
#line 2449
    tmp___0 = dw_put_u16(out, offsets[a], -1);
    }
#line 2449
    if (tmp___0 == -1) {
#line 2450
      goto clean_dwx_ns_convert_mangle;
    }
#line 2448
    a ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 2455
  tmp___1 = dw_put_u8(out, (uint8_t )counter, -1);
  }
#line 2455
  if (tmp___1 == -1) {
#line 2456
    goto clean_dwx_ns_convert_mangle;
  }
#line 2458
  if (is_upstream == 1) {
    {
#line 2458
    tmp___3 = dw_put_u8(out, (uint8_t )22, -1);
    }
#line 2458
    if (tmp___3 == -1) {
#line 2459
      goto clean_dwx_ns_convert_mangle;
    } else {
#line 2458
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 2460
  if (is_upstream != 1) {
    {
#line 2460
    tmp___2 = dw_put_u8(out, (uint8_t )16, -1);
    }
#line 2460
    if (tmp___2 == -1) {
#line 2461
      goto clean_dwx_ns_convert_mangle;
    }
  }
#line 2464
  return (out);
  clean_dwx_ns_convert_mangle: 
#line 2467
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 2468
    dw_destroy(out);
    }
  }
#line 2470
  return ((dw_str *)0);
}
}
#line 2484 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
dw_str *dwx_ns_convert(dw_str *in , int is_upstream , dw_str *bailiwick ) 
{ 
  dw_str *mangle ;
  dw_str *out ;

  {
  {
#line 2488
  mangle = (dw_str *)0;
#line 2488
  out = (dw_str *)0;
#line 2490
  mangle = dw_substr(in, 0, -1, -1);
  }
#line 2491
  if ((unsigned long )mangle == (unsigned long )((dw_str *)0)) {
#line 2492
    goto clean_dwx_ns_convert;
  }
  {
#line 2495
  out = dwx_ns_convert_mangle(mangle, is_upstream, bailiwick);
  }
#line 2496
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 2497
    goto clean_dwx_ns_convert;
  }
#line 2500
  if ((unsigned long )mangle != (unsigned long )((dw_str *)0)) {
    {
#line 2501
    dw_destroy(mangle);
    }
  }
#line 2503
  return (out);
  clean_dwx_ns_convert: 
#line 2506
  if ((unsigned long )mangle != (unsigned long )((dw_str *)0)) {
    {
#line 2507
    dw_destroy(mangle);
    }
  }
#line 2509
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 2510
    dw_destroy(out);
    }
  }
#line 2512
  return ((dw_str *)0);
}
}
#line 2518 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
ip_addr_T dwx_ns_getip_ipv4(dw_str *list , int offset ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  int counter ;
  int temp ;
  int32_t tmp___0 ;

  {
#line 2519
  addr.len = (uint8_t )0;
#line 2519
  addr.ip[0] = (uint8_t )0;
#line 2519
  addr.ip[1] = (uint8_t )0;
#line 2519
  tmp = 2U;
  {
#line 2519
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2519
    if (tmp >= 17U) {
#line 2519
      goto while_break;
    }
#line 2519
    addr.ip[tmp] = (unsigned char)0;
#line 2519
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2519
  addr.glueless = (dw_str *)0;
#line 2519
  addr.flags = (uint8_t )0;
#line 2520
  counter = 0;
#line 2520
  temp = 0;
#line 2522
  if ((unsigned long )list == (unsigned long )((dw_str *)0)) {
#line 2523
    return (addr);
  } else {
    {
#line 2522
    tmp___0 = dw_fetch_u8(list, offset);
    }
#line 2522
    if (tmp___0 != 1) {
#line 2523
      return (addr);
    }
  }
#line 2526
  counter = 0;
  {
#line 2526
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 2526
    if (! (counter < 4)) {
#line 2526
      goto while_break___0;
    }
    {
#line 2527
    temp = dw_fetch_u8(list, (offset + 1) + counter);
    }
#line 2528
    if (temp < 0) {
#line 2529
      return (addr);
    }
#line 2531
    addr.ip[counter] = (uint8_t )temp;
#line 2526
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 2534
  addr.len = (uint8_t )4;
#line 2536
  return (addr);
}
}
#line 2543 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
ip_addr_T dwx_ns_getip_ipv6(dw_str *list , int offset ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  int counter ;
  int temp ;
  int32_t tmp___0 ;

  {
#line 2544
  addr.len = (uint8_t )0;
#line 2544
  addr.ip[0] = (uint8_t )0;
#line 2544
  addr.ip[1] = (uint8_t )0;
#line 2544
  tmp = 2U;
  {
#line 2544
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2544
    if (tmp >= 17U) {
#line 2544
      goto while_break;
    }
#line 2544
    addr.ip[tmp] = (unsigned char)0;
#line 2544
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2544
  addr.glueless = (dw_str *)0;
#line 2544
  addr.flags = (uint8_t )0;
#line 2545
  counter = 0;
#line 2545
  temp = 0;
#line 2547
  if ((unsigned long )list == (unsigned long )((dw_str *)0)) {
#line 2548
    return (addr);
  } else {
    {
#line 2547
    tmp___0 = dw_fetch_u8(list, offset);
    }
#line 2547
    if (tmp___0 != 28) {
#line 2548
      return (addr);
    }
  }
#line 2551
  counter = 0;
  {
#line 2551
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 2551
    if (! (counter < 16)) {
#line 2551
      goto while_break___0;
    }
    {
#line 2552
    temp = dw_fetch_u8(list, (offset + 1) + counter);
    }
#line 2553
    if (temp < 0) {
#line 2554
      return (addr);
    }
#line 2556
    addr.ip[counter] = (uint8_t )temp;
#line 2551
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 2559
  addr.len = (uint8_t )16;
#line 2561
  return (addr);
}
}
#line 2570 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
ip_addr_T dwx_get_rr_from_answer(dw_str *answer ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  int counter ;
  int ancount ;
  int stack[20] ;
  int type ;
  int place ;
  int z ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;
  int32_t tmp___2 ;
  int32_t tmp___3 ;
  uint16_t tmp___4 ;

  {
#line 2571
  addr.len = (uint8_t )0;
#line 2571
  addr.ip[0] = (uint8_t )0;
#line 2571
  addr.ip[1] = (uint8_t )0;
#line 2571
  tmp = 2U;
  {
#line 2571
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2571
    if (tmp >= 17U) {
#line 2571
      goto while_break;
    }
#line 2571
    addr.ip[tmp] = (unsigned char)0;
#line 2571
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2571
  addr.glueless = (dw_str *)0;
#line 2571
  addr.flags = (uint8_t )0;
#line 2572
  counter = 0;
#line 2572
  ancount = 0;
#line 2572
  type = 0;
#line 2572
  place = 0;
#line 2572
  z = 0;
#line 2574
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 2575
    goto catch_dwx_get_rr_from_answer;
  }
  {
#line 2578
  tmp___0 = dw_fetch_u8(answer, -1);
  }
#line 2578
  if (tmp___0 != 0) {
#line 2579
    goto catch_dwx_get_rr_from_answer;
  }
  {
#line 2582
  (answer->len) --;
#line 2584
  tmp___1 = dw_pop_u16(answer);
  }
#line 2584
  if (tmp___1 == -1) {
#line 2585
    goto catch_dwx_get_rr_from_answer;
  } else {
    {
#line 2584
    tmp___2 = dw_pop_u16(answer);
    }
#line 2584
    if (tmp___2 == -1) {
#line 2585
      goto catch_dwx_get_rr_from_answer;
    }
  }
  {
#line 2587
  ancount = dw_pop_u16(answer);
#line 2589
  counter = 0;
  }
  {
#line 2589
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 2589
    if (counter < ancount) {
#line 2589
      if (! (counter < 16)) {
#line 2589
        goto while_break___0;
      }
    } else {
#line 2589
      goto while_break___0;
    }
    {
#line 2590
    z = dw_pop_u16(answer);
    }
#line 2591
    if (z == -1) {
#line 2592
      goto catch_dwx_get_rr_from_answer;
    } else {
      {
#line 2591
      tmp___3 = dw_pop_u16(answer);
      }
#line 2591
      if (tmp___3 == -1) {
#line 2592
        goto catch_dwx_get_rr_from_answer;
      }
    }
    {
#line 2597
    type = dw_fetch_u16(answer, z);
    }
#line 2598
    if (type == 1) {
#line 2603
      stack[place] = z;
#line 2604
      place ++;
    } else
#line 2598
    if (type == 28) {
#line 2603
      stack[place] = z;
#line 2604
      place ++;
    }
#line 2589
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 2608
  if (place == 0) {
#line 2609
    goto catch_dwx_get_rr_from_answer;
  }
  {
#line 2611
  tmp___4 = dwr_rng(rng_seed);
#line 2611
  place = (int )tmp___4 % place;
#line 2612
  type = dw_fetch_u16(answer, stack[place]);
  }
#line 2613
  if (type == 1) {
#line 2614
    addr.len = (uint8_t )4;
#line 2615
    addr.ip[0] = *((answer->str + stack[place]) + 10);
#line 2616
    addr.ip[1] = *((answer->str + stack[place]) + 11);
#line 2617
    addr.ip[2] = *((answer->str + stack[place]) + 12);
#line 2618
    addr.ip[3] = *((answer->str + stack[place]) + 13);
  }
  catch_dwx_get_rr_from_answer: 
#line 2623
  return (addr);
}
}
#line 2629 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
ip_addr_T dwx_ns_getip_glueless(dw_str *list , int offset ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  dw_str *query ;
  dw_str *answer ;
  int type ;
  int tmp___0 ;

  {
#line 2630
  addr.len = (uint8_t )0;
#line 2630
  addr.ip[0] = (uint8_t )0;
#line 2630
  addr.ip[1] = (uint8_t )0;
#line 2630
  tmp = 2U;
  {
#line 2630
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2630
    if (tmp >= 17U) {
#line 2630
      goto while_break;
    }
#line 2630
    addr.ip[tmp] = (unsigned char)0;
#line 2630
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2630
  addr.glueless = (dw_str *)0;
#line 2630
  addr.flags = (uint8_t )0;
#line 2631
  query = (dw_str *)0;
#line 2631
  answer = (dw_str *)0;
#line 2632
  type = 1;
#line 2634
  if ((unsigned long )list == (unsigned long )((dw_str *)0)) {
#line 2635
    goto catch_dwx_ns_getip_glueless;
  } else
#line 2634
  if ((int )*(list->str + offset) != 2) {
#line 2635
    goto catch_dwx_ns_getip_glueless;
  }
#line 2637
  type = key_n[23];
#line 2638
  if (type != 1) {
#line 2638
    if (type != 28) {
#line 2638
      if (type != 255) {
#line 2639
        type = 1;
      }
    }
  }
  {
#line 2643
  query = dw_get_dname(list->str + 3, offset, 256);
#line 2644
  dwc_lower_case(query);
  }
#line 2645
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 2646
    goto catch_dwx_ns_getip_glueless;
  } else {
    {
#line 2645
    tmp___0 = dw_put_u16(query, (uint16_t )type, -1);
    }
#line 2645
    if (tmp___0 == -1) {
#line 2646
      goto catch_dwx_ns_getip_glueless;
    }
  }
  {
#line 2648
  answer = dwh_get(cache, query, 0, 1);
  }
#line 2649
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 2650
    addr = dwx_get_rr_from_answer(answer);
    }
#line 2651
    if ((int )addr.len != 0) {
#line 2652
      goto catch_dwx_ns_getip_glueless;
    }
  }
  {
#line 2656
  addr.glueless = dw_get_dname(list->str + 3, offset, 260);
#line 2657
  dw_put_u16(addr.glueless, (uint16_t )key_n[23], -1);
  }
#line 2658
  if ((unsigned long )addr.glueless == (unsigned long )((dw_str *)0)) {
#line 2659
    goto catch_dwx_ns_getip_glueless;
  }
#line 2661
  addr.len = (uint8_t )127;
  catch_dwx_ns_getip_glueless: 
#line 2664
  if ((unsigned long )query != (unsigned long )((dw_str *)0)) {
    {
#line 2665
    dw_destroy(query);
    }
  }
#line 2667
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 2668
    dw_destroy(answer);
    }
  }
#line 2670
  return (addr);
}
}
#line 2675 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_nsref_type(int a , int *offset , dw_str *list ) 
{ 
  int32_t tmp ;

  {
#line 2676
  if ((unsigned long )list == (unsigned long )((dw_str *)0)) {
#line 2677
    return (-1);
  } else
#line 2676
  if ((unsigned long )offset == (unsigned long )((int *)0)) {
#line 2677
    return (-1);
  }
  {
#line 2680
  *offset = -1 * (2 + a * 2);
#line 2681
  (*offset) --;
#line 2682
  *offset = dw_fetch_u16(list, *offset);
  }
#line 2683
  if (*offset < 0) {
#line 2684
    return (-1);
  } else
#line 2683
  if ((uint32_t )*offset > list->len) {
#line 2684
    return (-1);
  }
  {
#line 2687
  tmp = dw_fetch_u8(list, *offset);
  }
#line 2687
  return (tmp);
}
}
#line 2693 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_choose_ns(int b , int count , dwr_rg *rng , dw_str *list ) 
{ 
  int out ;
  int offset ;
  int a ;
  int type ;
  uint16_t tmp ;

  {
#line 2694
  out = 0;
#line 2694
  offset = 0;
#line 2694
  a = 0;
#line 2694
  type = 0;
#line 2696
  if (count <= 1) {
#line 2697
    return (0);
  }
#line 2716
  if ((int )(rem + b)->current_ns < 0) {
#line 2717
    a = 0;
    {
#line 2717
    while (1) {
      while_continue: /* CIL Label */ ;
#line 2717
      if (! (a < 5)) {
#line 2717
        goto while_break;
      }
      {
#line 2718
      tmp = dwr_rng(rng);
#line 2718
      out = (int )tmp % count;
#line 2719
      type = dwx_nsref_type(out, & offset, list);
      }
#line 2720
      if (type == 1) {
#line 2725
        goto while_break;
      } else
#line 2720
      if (type == 28) {
#line 2725
        goto while_break;
      }
#line 2717
      a ++;
    }
    while_break: /* CIL Label */ ;
    }
  } else {
#line 2729
    out = (int )(rem + b)->current_ns;
#line 2730
    out = (out + 173) % count;
  }
#line 2732
  (rem + b)->current_ns = (int8_t )out;
#line 2734
  return (out);
}
}
#line 2742 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
ip_addr_T dwx_ns_getip(dw_str *list , dwr_rg *rng , int b ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  int type ;
  int count ;
  int offset ;
  int a ;
  int rr ;

  {
#line 2743
  addr.len = (uint8_t )0;
#line 2743
  addr.ip[0] = (uint8_t )0;
#line 2743
  addr.ip[1] = (uint8_t )0;
#line 2743
  tmp = 2U;
  {
#line 2743
  while (1) {
    while_continue: /* CIL Label */ ;
#line 2743
    if (tmp >= 17U) {
#line 2743
      goto while_break;
    }
#line 2743
    addr.ip[tmp] = (unsigned char)0;
#line 2743
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 2743
  addr.glueless = (dw_str *)0;
#line 2743
  addr.flags = (uint8_t )0;
#line 2744
  type = 0;
#line 2744
  count = 0;
#line 2744
  offset = 0;
#line 2744
  a = 0;
#line 2744
  rr = 0;
#line 2746
  if ((unsigned long )list == (unsigned long )((dw_str *)0)) {
#line 2747
    goto catch_dwx_ns_getip;
  } else
#line 2746
  if ((unsigned long )rng == (unsigned long )((dwr_rg *)0)) {
#line 2747
    goto catch_dwx_ns_getip;
  }
  {
#line 2751
  type = dw_fetch_u8(list, -1);
  }
#line 2752
  if (type != 16) {
#line 2752
    if (type != 22) {
#line 2753
      goto catch_dwx_ns_getip;
    }
  }
  {
#line 2755
  count = dw_fetch_u8(list, -2);
  }
#line 2756
  if (count <= 0) {
#line 2757
    goto catch_dwx_ns_getip;
  } else
#line 2756
  if (count > 127) {
#line 2757
    goto catch_dwx_ns_getip;
  }
  {
#line 2761
  a = dwx_choose_ns(b, count, rng, list);
#line 2762
  rr = dwx_nsref_type(a, & offset, list);
  }
#line 2764
  if (rr == 1) {
    {
#line 2765
    addr = dwx_ns_getip_ipv4(list, offset);
    }
  } else
#line 2767
  if (rr == 28) {
    {
#line 2768
    addr = dwx_ns_getip_ipv6(list, offset);
    }
  } else
#line 2770
  if (rr == 2) {
    {
#line 2771
    addr = dwx_ns_getip_glueless(list, offset);
    }
  } else {
#line 2773
    goto catch_dwx_ns_getip;
  }
#line 2776
  if (type == 22) {
#line 2777
    addr.flags = (uint8_t )1;
  }
#line 2779
  return (addr);
  catch_dwx_ns_getip: 
#line 2782
  addr.len = (uint8_t )0;
#line 2783
  return (addr);
}
}
#line 2789 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_find_inflight(dw_str *query ) 
{ 
  dw_str *answer ;
  int ret ;
  int tmp ;

  {
  {
#line 2790
  answer = (dw_str *)0;
#line 2791
  ret = -1;
#line 2793
  answer = dwh_get(inflight, query, 0, 1);
  }
#line 2794
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 2795
    return (-1);
  }
  {
#line 2798
  ret = dw_fetch_u16(answer, 0);
#line 2799
  dw_destroy(answer);
  }
#line 2801
  if ((rem + ret)->socket == -1) {
#line 2802
    return (-1);
  }
  {
#line 2805
  tmp = dw_issame(query, (rem + ret)->query);
  }
#line 2805
  if (tmp != 1) {
    {
#line 2806
    dwh_zap(inflight, query, (dw_element *)0, 1);
    }
#line 2807
    return (-1);
  }
#line 2810
  return (ret);
}
}
#line 2815 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_init_conn_local(int32_t conn_number , int local_number ) 
{ 


  {
#line 2816
  if ((unsigned long )(rem + conn_number)->local == (unsigned long )((local_T **)0)) {
#line 2818
    return;
  } else
#line 2816
  if ((unsigned long )*((rem + conn_number)->local + local_number) == (unsigned long )((local_T *)0)) {
#line 2818
    return;
  }
#line 2820
  (*((rem + conn_number)->local + local_number))->from_socket = -1;
#line 2821
  (*((rem + conn_number)->local + local_number))->port = (uint16_t )0;
#line 2822
  (*((rem + conn_number)->local + local_number))->tcp_num = -1;
#line 2823
  (*((rem + conn_number)->local + local_number))->action = (dw_str *)0;
#line 2824
  return;
}
}
#line 2885 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_do_glueless_new(dw_str *query , int32_t conn_number , int type ) 
{ 
  int32_t new_conn_num ;
  int num_alloc ;
  dw_str *packet ;
  int tmp ;
  int tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
#line 2886
  new_conn_num = 0;
#line 2887
  num_alloc = 0;
#line 2888
  packet = (dw_str *)0;
#line 2890
  num_alloc = key_n[20];
#line 2891
  if (num_alloc < 1) {
#line 2892
    num_alloc = 1;
  } else
#line 2893
  if (num_alloc > 32000) {
#line 2894
    num_alloc = 32000;
  }
#line 2896
  num_alloc ++;
#line 2897
  if ((int )(rem + conn_number)->recurse_depth > 32) {
#line 2898
    return;
  }
  {
#line 2901
  new_conn_num = find_free_remote();
  }
#line 2902
  if (new_conn_num == -1) {
#line 2903
    return;
  }
  {
#line 2906
  reset_rem((int_fast32_t )new_conn_num);
#line 2907
  close(*(b_remote + new_conn_num));
#line 2908
  *(b_remote + new_conn_num) = -1;
#line 2909
  (rem + new_conn_num)->query = dw_substr(query, 0, -1, -1);
#line 2910
  (rem + new_conn_num)->recurse_depth = (uint8_t )((int )(rem + conn_number)->recurse_depth + 1);
#line 2911
  (rem + new_conn_num)->socket = -1;
#line 2912
  (rem + new_conn_num)->remote_id = dwr_rng(rng_seed);
#line 2915
  packet = make_dns_header((int32_t )(rem + new_conn_num)->remote_id, (int16_t )0,
                           0, 0, 0);
  }
#line 2916
  if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
    {
#line 2918
    reset_rem((int_fast32_t )new_conn_num);
#line 2919
    close(*(b_remote + new_conn_num));
#line 2920
    *(b_remote + new_conn_num) = -1;
    }
#line 2921
    goto catch_dwx_do_ns_glueless_new;
  } else {
    {
#line 2916
    tmp = dw_append((rem + new_conn_num)->query, packet);
    }
#line 2916
    if (tmp == -1) {
      {
#line 2918
      reset_rem((int_fast32_t )new_conn_num);
#line 2919
      close(*(b_remote + new_conn_num));
#line 2920
      *(b_remote + new_conn_num) = -1;
      }
#line 2921
      goto catch_dwx_do_ns_glueless_new;
    } else {
      {
#line 2916
      tmp___0 = dw_put_u16(packet, (uint16_t )1, -1);
      }
#line 2916
      if (tmp___0 == -1) {
        {
#line 2918
        reset_rem((int_fast32_t )new_conn_num);
#line 2919
        close(*(b_remote + new_conn_num));
#line 2920
        *(b_remote + new_conn_num) = -1;
        }
#line 2921
        goto catch_dwx_do_ns_glueless_new;
      }
    }
  }
  {
#line 2924
  tmp___1 = malloc((unsigned long )num_alloc * sizeof(local_T *));
#line 2924
  (rem + new_conn_num)->local = (local_T **)tmp___1;
  }
#line 2925
  if ((unsigned long )(rem + new_conn_num)->local == (unsigned long )((local_T **)0)) {
    {
#line 2926
    reset_rem((int_fast32_t )new_conn_num);
#line 2927
    close(*(b_remote + new_conn_num));
#line 2928
    *(b_remote + new_conn_num) = -1;
    }
#line 2929
    goto catch_dwx_do_ns_glueless_new;
  }
  {
#line 2931
  make_remote_connection(new_conn_num, packet->str, (int )packet->len, (rem + new_conn_num)->query,
                         -1);
#line 2933
  (rem + conn_number)->die = the_time + ((int64_t )timeout_seconds << 12);
#line 2934
  (rem + conn_number)->child_id = new_conn_num;
#line 2936
  (rem + new_conn_num)->die = the_time + ((int64_t )timeout_seconds << 8);
#line 2937
  (rem + new_conn_num)->num_locals = (uint16_t )1;
#line 2938
  tmp___2 = malloc(sizeof(local_T ));
#line 2938
  *((rem + new_conn_num)->local + 0) = (local_T *)tmp___2;
  }
#line 2939
  if ((unsigned long )*((rem + new_conn_num)->local + 0) != (unsigned long )((local_T *)0)) {
#line 2940
    (*((rem + new_conn_num)->local + 0))->orig_query = (dw_str *)0;
#line 2941
    (*((rem + new_conn_num)->local + 0))->action = (dw_str *)0;
  }
  {
#line 2943
  dwx_init_conn_local(new_conn_num, 0);
  }
#line 2944
  if ((rem + new_conn_num)->socket == -1) {
    {
#line 2946
    reset_rem((int_fast32_t )new_conn_num);
#line 2947
    close(*(b_remote + new_conn_num));
#line 2948
    *(b_remote + new_conn_num) = -1;
    }
#line 2949
    goto catch_dwx_do_ns_glueless_new;
  } else
#line 2944
  if ((unsigned long )*((rem + new_conn_num)->local + 0) == (unsigned long )((local_T *)0)) {
    {
#line 2946
    reset_rem((int_fast32_t )new_conn_num);
#line 2947
    close(*(b_remote + new_conn_num));
#line 2948
    *(b_remote + new_conn_num) = -1;
    }
#line 2949
    goto catch_dwx_do_ns_glueless_new;
  }
#line 2951
  (*((rem + new_conn_num)->local + 0))->glueless_type = (uint8_t )type;
#line 2952
  (*((rem + new_conn_num)->local + 0))->glueless_conn = conn_number;
  catch_dwx_do_ns_glueless_new: 
#line 2955
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 2956
    dw_destroy(packet);
    }
  }
#line 2959
  return;
}
}
#line 2970 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_do_ns_glueless(ip_addr_T addr , int32_t conn_number ) 
{ 


  {
#line 2973
  if ((int )addr.len != 127) {
#line 2974
    goto clean_dwx_do_ns_glueless;
  } else
#line 2973
  if ((unsigned long )addr.glueless == (unsigned long )((dw_str *)0)) {
#line 2974
    goto clean_dwx_do_ns_glueless;
  }
  {
#line 2991
  dwc_lower_case(addr.glueless);
#line 2992
  dwx_do_glueless_new(addr.glueless, conn_number, 1);
  }
  clean_dwx_do_ns_glueless: 
  {
#line 2995
  dw_destroy(addr.glueless);
  }
#line 2996
  return;
}
}
#line 3002 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_glueless_done(dw_str *query , int32_t conn_num ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  dw_str *answer ;
  dw_str *packet ;
  sockaddr_all_T server ;
  int s ;
  socklen_t inet_len ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t tmp___4 ;

  {
#line 3003
  addr.len = (uint8_t )0;
#line 3003
  addr.ip[0] = (uint8_t )0;
#line 3003
  addr.ip[1] = (uint8_t )0;
#line 3003
  tmp = 2U;
  {
#line 3003
  while (1) {
    while_continue: /* CIL Label */ ;
#line 3003
    if (tmp >= 17U) {
#line 3003
      goto while_break;
    }
#line 3003
    addr.ip[tmp] = (unsigned char)0;
#line 3003
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 3003
  addr.glueless = (dw_str *)0;
#line 3003
  addr.flags = (uint8_t )0;
#line 3004
  answer = (dw_str *)0;
#line 3004
  packet = (dw_str *)0;
#line 3006
  s = -1;
#line 3007
  inet_len = (socklen_t )sizeof(struct sockaddr_in );
#line 3010
  answer = dwh_get(cache, query, 0, 1);
  }
#line 3011
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 3012
    goto catch_dwx_glueless_done;
  }
  {
#line 3014
  addr = dwx_get_rr_from_answer(answer);
  }
#line 3015
  if ((int )addr.len != 4) {
#line 3015
    if ((int )addr.len != 16) {
#line 3020
      goto catch_dwx_glueless_done;
    }
  }
  {
#line 3022
  s = setup_server(& server, & addr);
  }
#line 3023
  if (s == -1) {
#line 3024
    goto catch_dwx_glueless_done;
  }
#line 3027
  if ((int )server.u.v4.sin_family == 10) {
#line 3028
    inet_len = (socklen_t )sizeof(struct sockaddr_in6 );
  }
  {
#line 3031
  (rem + conn_num)->remote_id = dwr_rng(rng_seed);
#line 3034
  packet = make_dns_header((int32_t )(rem + conn_num)->remote_id, (int16_t )0, 0,
                           0, 0);
  }
#line 3035
  if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
#line 3037
    goto catch_dwx_glueless_done;
  } else {
    {
#line 3035
    tmp___0 = dw_append((rem + conn_num)->query, packet);
    }
#line 3035
    if (tmp___0 == -1) {
#line 3037
      goto catch_dwx_glueless_done;
    } else {
      {
#line 3035
      tmp___1 = dw_put_u16(packet, (uint16_t )1, -1);
      }
#line 3035
      if (tmp___1 == -1) {
#line 3037
        goto catch_dwx_glueless_done;
      }
    }
  }
  {
#line 3039
  fcntl(s, 4, 2048);
#line 3040
  tmp___2 = do_random_bind(s, (int )addr.len);
  }
#line 3040
  if (tmp___2 == -1) {
    {
#line 3043
    close(s);
    }
#line 3044
    goto catch_dwx_glueless_done;
  } else {
    {
#line 3040
    tmp___3 = connect(s, (struct sockaddr  const  *)((struct sockaddr *)(& server)),
                      inet_len);
    }
#line 3040
    if (tmp___3 == -1) {
      {
#line 3043
      close(s);
      }
#line 3044
      goto catch_dwx_glueless_done;
    } else {
      {
#line 3040
      tmp___4 = send(s, (void const   *)packet->str, (size_t )packet->len, 0);
      }
#line 3040
      if (tmp___4 < 0L) {
        {
#line 3043
        close(s);
        }
#line 3044
        goto catch_dwx_glueless_done;
      }
    }
  }
#line 3047
  *(b_remote + conn_num) = s;
#line 3048
  if ((rem + conn_num)->socket != -1) {
    {
#line 3049
    close((rem + conn_num)->socket);
    }
  }
#line 3051
  (rem + conn_num)->socket = s;
  catch_dwx_glueless_done: 
#line 3055
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 3056
    dw_destroy(answer);
    }
  }
#line 3058
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 3059
    dw_destroy(packet);
    }
  }
#line 3061
  return;
}
}
#line 3064 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_do_cname_glueless(dw_str *query , int conn_num ) 
{ 


  {
#line 3067
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 3068
    return (-1);
  }
  {
#line 3083
  dwx_do_glueless_new(query, conn_num, 2);
  }
#line 3085
  return (1);
}
}
#line 3089 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_incomplete_cname_done(dw_str *query , int child , int l ) 
{ 
  int parent ;
  dw_str *cname_cache ;
  dw_str *action ;
  dw_str *answer ;
  int tmp ;

  {
#line 3090
  parent = 0;
#line 3091
  cname_cache = (dw_str *)0;
#line 3091
  action = (dw_str *)0;
#line 3091
  answer = (dw_str *)0;
#line 3098
  if ((unsigned long )(rem + child)->local == (unsigned long )((local_T **)0)) {
#line 3099
    goto catch_dwx_incomplete_cname_done;
  } else
#line 3098
  if ((unsigned long )*((rem + child)->local + l) == (unsigned long )((local_T *)0)) {
#line 3099
    goto catch_dwx_incomplete_cname_done;
  }
#line 3102
  parent = (*((rem + child)->local + l))->glueless_conn;
#line 3103
  if ((rem + parent)->child_id != child) {
#line 3104
    goto catch_dwx_incomplete_cname_done;
  }
  {
#line 3106
  cname_cache = dw_substr((rem + parent)->query, 0, -1, -1);
  }
#line 3107
  if ((unsigned long )cname_cache == (unsigned long )((dw_str *)0)) {
#line 3109
    goto catch_dwx_incomplete_cname_done;
  } else
#line 3107
  if (cname_cache->len < 3U) {
#line 3109
    goto catch_dwx_incomplete_cname_done;
  } else {
    {
#line 3107
    tmp = dw_put_u16(cname_cache, (uint16_t )65394, -3);
    }
#line 3107
    if (tmp == -1) {
#line 3109
      goto catch_dwx_incomplete_cname_done;
    }
  }
  {
#line 3111
  action = dwh_get(cache, cname_cache, 0, 1);
#line 3112
  answer = dwh_get(cache, query, 0, 1);
  }
#line 3113
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 3114
    goto catch_dwx_incomplete_cname_done;
  } else
#line 3113
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 3114
    goto catch_dwx_incomplete_cname_done;
  }
  {
#line 3117
  dwx_make_cname_reply(parent, (rem + parent)->query, action, answer, 0);
  }
  catch_dwx_incomplete_cname_done: 
#line 3120
  if ((unsigned long )cname_cache != (unsigned long )((dw_str *)0)) {
    {
#line 3121
    dw_destroy(cname_cache);
    }
  }
#line 3123
  if ((unsigned long )action != (unsigned long )((dw_str *)0)) {
    {
#line 3124
    dw_destroy(action);
    }
  }
#line 3126
  if ((unsigned long )answer != (unsigned long )((dw_str *)0)) {
    {
#line 3127
    dw_destroy(answer);
    }
  }
#line 3129
  return;
}
}
#line 3140 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
int dwx_cname_in_cache(dw_str *orig_query , dw_str *query , sockaddr_all_T *client ,
                       ip_addr_T *from_ip , int32_t local_id , int sock , uint16_t from_port ) 
{ 
  dw_str *cname_cache ;
  dw_str *action ;
  dw_str *real_query ;
  dw_str *packet ;
  int ret ;
  int_fast32_t b ;
  int_fast32_t offset ;
  int_fast32_t num_alloc ;
  int_fast32_t qtype ;
  int tmp ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;
  int tmp___2 ;
  int32_t tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;

  {
#line 3143
  cname_cache = (dw_str *)0;
#line 3143
  action = (dw_str *)0;
#line 3143
  real_query = (dw_str *)0;
#line 3143
  packet = (dw_str *)0;
#line 3144
  ret = 0;
#line 3145
  b = (int_fast32_t )0;
#line 3145
  offset = (int_fast32_t )0;
#line 3145
  num_alloc = (int_fast32_t )1;
#line 3145
  qtype = (int_fast32_t )0;
#line 3147
  num_alloc = (int_fast32_t )key_n[20];
#line 3148
  if (num_alloc < 1L) {
#line 3149
    num_alloc = (int_fast32_t )1;
  }
#line 3151
  if (num_alloc > 32000L) {
#line 3152
    num_alloc = (int_fast32_t )32000;
  }
#line 3155
  if ((unsigned long )orig_query == (unsigned long )((dw_str *)0)) {
#line 3156
    return (0);
  } else
#line 3155
  if ((unsigned long )query == (unsigned long )((dw_str *)0)) {
#line 3156
    return (0);
  } else
#line 3155
  if ((unsigned long )client == (unsigned long )((sockaddr_all_T *)0)) {
#line 3156
    return (0);
  } else
#line 3155
  if ((unsigned long )from_ip == (unsigned long )((ip_addr_T *)0)) {
#line 3156
    return (0);
  }
  {
#line 3159
  cname_cache = dw_substr(query, 0, -1, -1);
  }
#line 3160
  if ((unsigned long )cname_cache == (unsigned long )((dw_str *)0)) {
#line 3162
    goto catch_dwx_cname_in_cache;
  } else
#line 3160
  if (cname_cache->len < 3U) {
#line 3162
    goto catch_dwx_cname_in_cache;
  } else {
    {
#line 3160
    tmp = dw_put_u16(cname_cache, (uint16_t )65394, -3);
    }
#line 3160
    if (tmp == -1) {
#line 3162
      goto catch_dwx_cname_in_cache;
    }
  }
  {
#line 3164
  action = dwh_get(cache, cname_cache, 0, 1);
  }
#line 3165
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 3166
    goto catch_dwx_cname_in_cache;
  }
  {
#line 3168
  dw_log_dwstr((char *)"Cached CNAME refer found for ", query, 100);
#line 3171
  tmp___0 = dw_fetch_u16(action, -2);
#line 3171
  offset = (int_fast32_t )tmp___0;
#line 3172
  offset += 2L;
#line 3173
  real_query = dw_get_dname(action->str, (int )offset, 260);
#line 3174
  dwc_lower_case(real_query);
  }
#line 3175
  if ((unsigned long )real_query == (unsigned long )((dw_str *)0)) {
#line 3176
    goto catch_dwx_cname_in_cache;
  }
  {
#line 3178
  tmp___1 = dw_fetch_u16(query, -1);
#line 3178
  qtype = (int_fast32_t )tmp___1;
  }
#line 3179
  if (qtype == -1L) {
#line 3180
    goto catch_dwx_cname_in_cache;
  } else {
    {
#line 3179
    tmp___2 = dw_put_u16(real_query, (uint16_t )qtype, -1);
    }
#line 3179
    if (tmp___2 == -1) {
#line 3180
      goto catch_dwx_cname_in_cache;
    }
  }
  {
#line 3183
  tmp___3 = find_free_remote();
#line 3183
  b = (int_fast32_t )tmp___3;
  }
#line 3184
  if (b == -1L) {
#line 3185
    goto catch_dwx_cname_in_cache;
  }
  {
#line 3187
  reset_rem(b);
#line 3188
  (rem + b)->query = dw_substr(real_query, 0, -1, -1);
#line 3189
  (rem + b)->remote_id = dwr_rng(rng_seed);
#line 3190
  tmp___4 = malloc((unsigned long )num_alloc * sizeof(local_T *));
#line 3190
  (rem + b)->local = (local_T **)tmp___4;
  }
#line 3191
  if ((unsigned long )(rem + b)->local == (unsigned long )((local_T **)0)) {
#line 3192
    goto catch_dwx_cname_in_cache;
  }
  {
#line 3194
  tmp___5 = malloc(sizeof(local_T ));
#line 3194
  *((rem + b)->local + 0) = (local_T *)tmp___5;
#line 3195
  (rem + b)->num_locals = (uint16_t )0;
  }
#line 3196
  if ((unsigned long )*((rem + b)->local + 0) == (unsigned long )((local_T *)0)) {
    {
#line 3197
    reset_rem(b);
    }
#line 3198
    goto catch_dwx_cname_in_cache;
  }
  {
#line 3200
  (rem + b)->num_locals = (uint16_t )1;
#line 3201
  (rem + b)->die = the_time + ((int64_t )timeout_seconds << 12);
#line 3202
  (*((rem + b)->local + 0))->orig_query = dw_substr(orig_query, 0, -1, -1);
#line 3203
  (*((rem + b)->local + 0))->action = dw_substr(action, 0, -1, -1);
#line 3204
  (*((rem + b)->local + 0))->from_socket = sock;
#line 3205
  (*((rem + b)->local + 0))->tcp_num = -1;
#line 3206
  (*((rem + b)->local + 0))->port = from_port;
#line 3207
  (*((rem + b)->local + 0))->local_id = (uint16_t )local_id;
#line 3208
  (*((rem + b)->local + 0))->glueless_type = (uint8_t )3;
#line 3209
  (*((rem + b)->local + 0))->glueless_conn = -1;
#line 3210
  (*((rem + b)->local + 0))->ip = *from_ip;
#line 3213
  packet = make_dns_header((int32_t )(rem + b)->remote_id, (int16_t )0, 0, 0, 0);
  }
#line 3214
  if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
    {
#line 3216
    reset_rem(b);
    }
#line 3217
    goto catch_dwx_cname_in_cache;
  } else {
    {
#line 3214
    tmp___6 = dw_append((rem + b)->query, packet);
    }
#line 3214
    if (tmp___6 == -1) {
      {
#line 3216
      reset_rem(b);
      }
#line 3217
      goto catch_dwx_cname_in_cache;
    } else {
      {
#line 3214
      tmp___7 = dw_put_u16(packet, (uint16_t )1, -1);
      }
#line 3214
      if (tmp___7 == -1) {
        {
#line 3216
        reset_rem(b);
        }
#line 3217
        goto catch_dwx_cname_in_cache;
      }
    }
  }
  {
#line 3220
  make_remote_connection((int32_t )b, packet->str, (int )packet->len, (rem + b)->query,
                         -1);
#line 3223
  ret = 1;
  }
  catch_dwx_cname_in_cache: 
#line 3226
  if ((unsigned long )cname_cache != (unsigned long )((dw_str *)0)) {
    {
#line 3227
    dw_destroy(cname_cache);
    }
  }
#line 3229
  if ((unsigned long )action != (unsigned long )((dw_str *)0)) {
    {
#line 3230
    dw_destroy(action);
    }
  }
#line 3232
  if ((unsigned long )real_query != (unsigned long )((dw_str *)0)) {
    {
#line 3233
    dw_destroy(real_query);
    }
  }
#line 3235
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 3236
    dw_destroy(packet);
    }
  }
#line 3238
  return (ret);
}
}
#line 3241 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwRecurse.c"
void dwx_cached_cname_done(dw_str *query , int b , int l , int depth ) 
{ 
  dw_str *answer ;
  dw_str *oquery ;
  dw_str *action ;

  {
#line 3243
  answer = (dw_str *)0;
#line 3243
  oquery = (dw_str *)0;
#line 3243
  action = (dw_str *)0;
#line 3245
  if ((unsigned long )(rem + b)->local == (unsigned long )((local_T **)0)) {
#line 3246
    return;
  } else
#line 3245
  if ((unsigned long )*((rem + b)->local + l) == (unsigned long )((local_T *)0)) {
#line 3246
    return;
  } else
#line 3245
  if (depth > 32) {
#line 3246
    return;
  }
  {
#line 3249
  oquery = dw_substr((*((rem + b)->local + l))->orig_query, 0, -1, -1);
#line 3250
  dwc_lower_case(oquery);
#line 3251
  action = dw_substr((*((rem + b)->local + l))->action, 0, -1, -1);
#line 3252
  answer = dwh_get(cache, query, 0, 1);
#line 3254
  (*((rem + b)->local + l))->glueless_type = (uint8_t )0;
  }
#line 3256
  if ((unsigned long )answer == (unsigned long )((dw_str *)0)) {
#line 3257
    goto catch_dwx_cached_cname_done;
  } else
#line 3256
  if ((unsigned long )oquery == (unsigned long )((dw_str *)0)) {
#line 3257
    goto catch_dwx_cached_cname_done;
  } else
#line 3256
  if ((unsigned long )action == (unsigned long )((dw_str *)0)) {
#line 3257
    goto catch_dwx_cached_cname_done;
  }
  {
#line 3260
  dwx_make_cname_reply(b, oquery, action, answer, depth + 1);
  }
  catch_dwx_cached_cname_done: 
  {
#line 3263
  dw_destroy(answer);
#line 3264
  dw_destroy(oquery);
#line 3265
  dw_destroy(action);
  }
#line 3266
  return;
}
}
#line 36 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_decomp_offset(dw_str *in , int32_t offset , int32_t qlen ) 
{ 
  int32_t t ;
  int tmp ;

  {
  {
#line 37
  t = 0;
#line 39
  tmp = dw_assert_sanity(in);
  }
#line 39
  if (tmp == -1) {
#line 40
    return (-1);
  }
#line 43
  t = offset;
#line 44
  if (t < 0) {
#line 45
    return (-1);
  } else
#line 44
  if ((uint32_t )t > in->len) {
#line 45
    return (-1);
  }
#line 47
  if ((int )*(in->str + t) < 64) {
#line 48
    return (t);
  }
#line 50
  offset = (int )*(in->str + t) & 63;
#line 51
  offset <<= 8;
#line 52
  offset += (int32_t )*((in->str + t) + 1);
#line 54
  offset -= 12;
#line 55
  if (offset < qlen) {
#line 55
    if (qlen > 0) {
#line 56
      return (-2 - offset);
    }
  }
#line 58
  offset -= qlen;
#line 59
  offset -= 2;
#line 60
  if (offset < 0) {
#line 61
    return (-1);
  } else
#line 60
  if ((uint32_t )offset > in->len) {
#line 61
    return (-1);
  }
#line 63
  return (offset);
}
}
#line 68 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_finish_name(dw_str *out , int32_t *delta , int32_t offset , int compress_followed ,
                        int32_t t ) 
{ 
  int tmp ;

  {
  {
#line 71
  tmp = dw_assert_sanity(out);
  }
#line 71
  if (tmp == -1) {
#line 72
    return (-1);
  } else
#line 71
  if (offset < 0) {
#line 72
    return (-1);
  }
  {
#line 75
  dw_addchar((uint8_t )0, out);
  }
#line 76
  if (compress_followed != 0) {
#line 77
    (*delta) ++;
  }
#line 79
  if (compress_followed == 0) {
#line 80
    t = offset + 1;
  }
#line 82
  return (t);
}
}
#line 94 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_decomp_dname(dw_str *in , dw_str *out , dw_str *q , int32_t *delta , int32_t where_dname ) 
{ 
  int32_t counter ;
  int32_t offset ;
  int32_t t ;
  int compress_followed ;
  int len ;
  int use_q_string ;
  dw_str *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 96
  counter = 0;
#line 96
  offset = 0;
#line 96
  t = 0;
#line 97
  compress_followed = 0;
#line 97
  len = 0;
#line 97
  use_q_string = 0;
#line 98
  tmp = (dw_str *)0;
#line 100
  tmp___0 = dw_assert_sanity(in);
  }
#line 100
  if (tmp___0 == -1) {
#line 103
    return (-1);
  } else {
    {
#line 100
    tmp___1 = dw_assert_sanity(out);
    }
#line 100
    if (tmp___1 == -1) {
#line 103
      return (-1);
    } else {
      {
#line 100
      tmp___2 = dw_assert_sanity(q);
      }
#line 100
      if (tmp___2 == -1) {
#line 103
        return (-1);
      } else
#line 100
      if ((unsigned long )delta == (unsigned long )((int32_t *)0)) {
#line 103
        return (-1);
      } else
#line 100
      if (where_dname < 0) {
#line 103
        return (-1);
      }
    }
  }
#line 106
  offset = where_dname;
#line 107
  counter = 0;
  {
#line 107
  while (1) {
    while_continue: /* CIL Label */ ;
#line 107
    if (! (counter < 200)) {
#line 107
      goto while_break;
    }
#line 108
    if (use_q_string == 0) {
#line 109
      if ((uint32_t )(offset + 1) > in->len) {
#line 110
        return (-1);
      }
#line 112
      len = (int )*(in->str + offset);
    } else {
#line 114
      if ((uint32_t )(offset + 1) > q->len) {
#line 115
        return (-1);
      }
#line 117
      len = (int )*(q->str + offset);
    }
#line 119
    if (len >= 192) {
#line 120
      if (use_q_string == 1) {
#line 121
        return (-1);
      }
#line 123
      if (compress_followed == 0) {
#line 124
        t = offset + 2;
#line 125
        *delta = -2;
      }
      {
#line 127
      offset = dwc_decomp_offset(in, offset, (int32_t )q->len);
      }
#line 128
      if (offset == -1) {
#line 129
        return (-1);
      } else
#line 130
      if (offset < 0) {
#line 131
        use_q_string = 1;
#line 132
        offset = -2 - offset;
      }
#line 134
      compress_followed = 1;
    } else
#line 135
    if (len > 63) {
#line 136
      return (-1);
    } else
#line 135
    if (len < 0) {
#line 136
      return (-1);
    } else
#line 137
    if (len == 0) {
      {
#line 138
      t = dwc_finish_name(out, delta, offset, compress_followed, t);
      }
#line 140
      goto while_break;
    } else {
#line 142
      if (use_q_string == 0) {
        {
#line 143
        tmp = dw_substr(in, offset, len + 1, 1);
        }
      } else {
        {
#line 145
        tmp = dw_substr(q, offset, len + 1, 1);
        }
      }
      {
#line 147
      dw_append(tmp, out);
#line 148
      dw_destroy(tmp);
#line 149
      offset += len + 1;
      }
#line 150
      if (compress_followed != 0) {
#line 151
        *delta += len + 1;
      }
    }
#line 107
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 155
  return (t);
}
}
#line 172 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int16_t dwc_type_desc(int32_t type ) 
{ 


  {
  {
#line 174
  if (type == 15) {
#line 174
    goto case_15;
  }
#line 178
  if (type == 5) {
#line 178
    goto case_5;
  }
#line 178
  if (type == 12) {
#line 178
    goto case_5;
  }
#line 178
  if (type == 2) {
#line 178
    goto case_5;
  }
#line 180
  if (type == 6) {
#line 180
    goto case_6;
  }
#line 187
  if (type == 9) {
#line 187
    goto case_9;
  }
#line 187
  if (type == 8) {
#line 187
    goto case_9;
  }
#line 187
  if (type == 7) {
#line 187
    goto case_9;
  }
#line 187
  if (type == 4) {
#line 187
    goto case_9;
  }
#line 187
  if (type == 3) {
#line 187
    goto case_9;
  }
#line 190
  if (type == 17) {
#line 190
    goto case_17;
  }
#line 190
  if (type == 14) {
#line 190
    goto case_17;
  }
#line 193
  if (type == 21) {
#line 193
    goto case_21;
  }
#line 193
  if (type == 18) {
#line 193
    goto case_21;
  }
#line 195
  if (type == 33) {
#line 195
    goto case_33;
  }
#line 197
  goto switch_default;
  case_15: /* CIL Label */ 
#line 175
  return ((int16_t )4624);
  case_5: /* CIL Label */ 
  case_12: /* CIL Label */ 
  case_2: /* CIL Label */ 
#line 179
  return ((int16_t )4112);
  case_6: /* CIL Label */ 
#line 181
  return ((int16_t )4138);
  case_9: /* CIL Label */ 
  case_8: /* CIL Label */ 
  case_7: /* CIL Label */ 
  case_4: /* CIL Label */ 
  case_3: /* CIL Label */ 
#line 188
  return ((int16_t )16);
  case_17: /* CIL Label */ 
  case_14: /* CIL Label */ 
#line 191
  return ((int16_t )32);
  case_21: /* CIL Label */ 
  case_18: /* CIL Label */ 
#line 194
  return ((int16_t )528);
  case_33: /* CIL Label */ 
#line 196
  return ((int16_t )1552);
  switch_default: /* CIL Label */ 
#line 198
  return ((int16_t )0);
  switch_break: /* CIL Label */ ;
  }
}
}
#line 211 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_decomp_rddata(int16_t desc , int32_t offset , dw_str *in , dw_str *out ,
                          dw_str *q ) 
{ 
  dw_str *tmp ;
  int lead ;
  int ndnames ;
  int tail ;
  int32_t rdo ;
  int32_t rdlength ;
  int32_t delta ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 213
  tmp = (dw_str *)0;
#line 214
  lead = 0;
#line 214
  ndnames = 0;
#line 214
  tail = 0;
#line 215
  rdo = 0;
#line 215
  rdlength = 0;
#line 215
  delta = 0;
#line 217
  tmp___0 = dw_assert_sanity(in);
  }
#line 217
  if (tmp___0 == -1) {
#line 220
    return (-1);
  } else {
    {
#line 217
    tmp___1 = dw_assert_sanity(out);
    }
#line 217
    if (tmp___1 == -1) {
#line 220
      return (-1);
    } else {
      {
#line 217
      tmp___2 = dw_assert_sanity(q);
      }
#line 217
      if (tmp___2 == -1) {
#line 220
        return (-1);
      } else
#line 217
      if ((int )desc < 0) {
#line 220
        return (-1);
      } else
#line 217
      if (offset < 0) {
#line 220
        return (-1);
      }
    }
  }
#line 223
  lead = ((int )desc & 3840) >> 8;
#line 224
  ndnames = ((int )desc & 240) >> 4;
#line 225
  tail = ((int )desc & 15) << 1;
#line 226
  offset += 10;
#line 227
  rdo = (int32_t )(out->len - 2U);
#line 228
  if (lead > 0) {
#line 229
    if (in->len < (uint32_t )(offset + lead)) {
#line 230
      goto catch_dwc_decomp_rddata;
    }
    {
#line 232
    tmp = dw_substr(in, offset, lead, 1);
#line 233
    tmp___3 = dw_append(tmp, out);
    }
#line 233
    if (tmp___3 == -1) {
#line 234
      goto catch_dwc_decomp_rddata;
    }
    {
#line 236
    dw_destroy(tmp);
#line 237
    tmp = (dw_str *)0;
#line 238
    offset += lead;
    }
  }
  {
#line 240
  while (1) {
    while_continue: /* CIL Label */ ;
#line 240
    if (! (ndnames > 0)) {
#line 240
      goto while_break;
    }
    {
#line 241
    delta = 0;
#line 242
    offset = dwc_decomp_dname(in, out, q, & delta, offset);
    }
#line 244
    if (offset < 0) {
#line 245
      goto catch_dwc_decomp_rddata;
    }
    {
#line 247
    rdlength = dw_fetch_u16(out, rdo);
#line 248
    rdlength += delta;
#line 249
    dw_put_u16(out, (uint16_t )rdlength, rdo);
#line 250
    ndnames --;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 252
  if (tail > 0) {
#line 253
    if (in->len < (uint32_t )(offset + tail)) {
#line 254
      goto catch_dwc_decomp_rddata;
    }
    {
#line 256
    tmp = dw_substr(in, offset, tail, 1);
#line 257
    dw_append(tmp, out);
#line 258
    dw_destroy(tmp);
#line 259
    tmp = (dw_str *)0;
#line 260
    offset += tail;
    }
  }
#line 263
  return (offset);
  catch_dwc_decomp_rddata: 
#line 266
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 267
    dw_destroy(tmp);
    }
  }
#line 269
  return (-1);
}
}
#line 279 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_decomp_rr(dw_str *in , dw_str *out , dw_str *q , dw_str *stack , int32_t offset ) 
{ 
  int32_t val ;
  int32_t delta ;
  int16_t desc ;
  dw_str *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 282
  val = 0;
#line 282
  delta = 0;
#line 283
  desc = (int16_t )0;
#line 284
  tmp = (dw_str *)0;
#line 286
  tmp___0 = dw_assert_sanity(in);
  }
#line 286
  if (tmp___0 == -1) {
#line 289
    return (-1);
  } else {
    {
#line 286
    tmp___1 = dw_assert_sanity(out);
    }
#line 286
    if (tmp___1 == -1) {
#line 289
      return (-1);
    } else {
      {
#line 286
      tmp___2 = dw_assert_sanity(q);
      }
#line 286
      if (tmp___2 == -1) {
#line 289
        return (-1);
      } else {
        {
#line 286
        tmp___3 = dw_assert_sanity(stack);
        }
#line 286
        if (tmp___3 == -1) {
#line 289
          return (-1);
        } else
#line 286
        if (offset < 0) {
#line 289
          return (-1);
        }
      }
    }
  }
  {
#line 292
  dw_put_u16(stack, (uint16_t )out->len, -1);
#line 295
  offset = dwc_decomp_dname(in, out, q, & delta, offset);
  }
#line 296
  if (offset < 0) {
#line 297
    goto catch_dwc_decomp_rr;
  } else
#line 296
  if ((uint32_t )offset > in->len - 7U) {
#line 297
    goto catch_dwc_decomp_rr;
  }
  {
#line 300
  dw_put_u16(stack, (uint16_t )out->len, -1);
#line 301
  val = dw_fetch_u16(in, offset);
  }
#line 302
  if (val == -1) {
#line 303
    goto catch_dwc_decomp_rr;
  }
  {
#line 305
  desc = dwc_type_desc(val);
#line 308
  tmp = dw_substr(in, offset, 10, 1);
#line 309
  dw_append(tmp, out);
#line 310
  dw_destroy(tmp);
#line 311
  tmp = (dw_str *)0;
#line 313
  val = dw_fetch_u16(in, offset + 8);
  }
#line 314
  if ((int )desc == 0) {
#line 315
    if (in->len < (uint32_t )((offset + 10) + val)) {
#line 316
      goto catch_dwc_decomp_rr;
    }
    {
#line 318
    tmp = dw_substr(in, offset + 10, val, 1);
#line 319
    dw_append(tmp, out);
#line 320
    dw_destroy(tmp);
#line 321
    offset += val + 10;
    }
  } else {
    {
#line 323
    offset = dwc_decomp_rddata(desc, offset, in, out, q);
    }
  }
#line 326
  return (offset);
  catch_dwc_decomp_rr: 
#line 329
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 330
    dw_destroy(tmp);
    }
  }
#line 332
  return (-1);
}
}
#line 340 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
dw_str *dwc_decompress(dw_str *q , dw_str *in ) 
{ 
  dw_str *out ;
  dw_str *tmp ;
  dw_str *stack ;
  int32_t offset ;
  int rr ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 341
  out = (dw_str *)0;
#line 341
  tmp = (dw_str *)0;
#line 341
  stack = (dw_str *)0;
#line 342
  offset = 0;
#line 343
  rr = 0;
#line 345
  tmp___0 = dw_assert_sanity(in);
  }
#line 345
  if (tmp___0 == -1) {
#line 346
    return ((dw_str *)0);
  } else {
    {
#line 345
    tmp___1 = dw_assert_sanity(q);
    }
#line 345
    if (tmp___1 == -1) {
#line 346
      return ((dw_str *)0);
    }
  }
  {
#line 349
  out = dw_create((uint32_t )2048);
  }
#line 350
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 351
    return ((dw_str *)0);
  }
  {
#line 353
  stack = dw_create((uint32_t )2048);
  }
#line 354
  if ((unsigned long )stack == (unsigned long )((dw_str *)0)) {
#line 355
    goto catch_dwc_decompress;
  }
#line 358
  rr = 0;
  {
#line 358
  while (1) {
    while_continue: /* CIL Label */ ;
#line 358
    if (rr < 1000) {
#line 358
      if (! ((uint32_t )offset < in->len - 7U)) {
#line 358
        goto while_break;
      }
    } else {
#line 358
      goto while_break;
    }
    {
#line 359
    offset = dwc_decomp_rr(in, out, q, stack, offset);
    }
#line 360
    if (offset < 0) {
#line 361
      goto catch_dwc_decompress;
    } else
#line 360
    if ((uint32_t )offset > in->len - 7U) {
#line 361
      goto catch_dwc_decompress;
    }
#line 358
    rr ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 365
  dw_append(stack, out);
#line 366
  dw_destroy(stack);
#line 367
  tmp = dw_substr(in, -7, -1, 1);
#line 368
  dw_append(tmp, out);
#line 369
  dw_destroy(tmp);
#line 370
  tmp = (dw_str *)0;
  }
#line 371
  return (out);
  catch_dwc_decompress: 
#line 374
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 375
    dw_destroy(out);
    }
  }
#line 377
  if ((unsigned long )tmp != (unsigned long )((dw_str *)0)) {
    {
#line 378
    dw_destroy(tmp);
    }
  }
#line 380
  if ((unsigned long )stack != (unsigned long )((dw_str *)0)) {
    {
#line 381
    dw_destroy(stack);
    }
  }
#line 383
  return ((dw_str *)0);
}
}
#line 392 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int dwc_label_same(dw_str *a , int32_t a_o , dw_str *b , int32_t b_o ) 
{ 
  int c ;
  int noloop ;
  uint8_t lc1 ;
  uint8_t lc2 ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 393
  c = 0;
#line 393
  noloop = 0;
#line 396
  tmp = dw_assert_sanity(a);
  }
#line 396
  if (tmp == -1) {
#line 398
    return (-1);
  } else {
    {
#line 396
    tmp___0 = dw_assert_sanity(b);
    }
#line 396
    if (tmp___0 == -1) {
#line 398
      return (-1);
    } else
#line 396
    if ((uint32_t )a_o > a->len) {
#line 398
      return (-1);
    } else
#line 396
    if ((uint32_t )b_o > b->len) {
#line 398
      return (-1);
    } else
#line 396
    if (a_o < 0) {
#line 398
      return (-1);
    } else
#line 396
    if (b_o < 0) {
#line 398
      return (-1);
    }
  }
#line 401
  lc1 = *(a->str + a_o);
#line 402
  lc2 = *(b->str + b_o);
#line 403
  if ((int )lc1 >= 65) {
#line 403
    if ((int )lc1 <= 90) {
#line 403
      lc1 = (uint8_t )((int )lc1 + 32);
    }
  }
#line 404
  if ((int )lc2 >= 65) {
#line 404
    if ((int )lc2 <= 90) {
#line 404
      lc2 = (uint8_t )((int )lc2 + 32);
    }
  }
#line 405
  if ((int )lc1 != (int )lc2) {
#line 406
    return (0);
  }
#line 409
  c = (int )*(a->str + a_o);
#line 411
  if (c < 0) {
#line 412
    return (-1);
  } else
#line 411
  if (c > 64) {
#line 412
    return (-1);
  } else
#line 411
  if ((uint32_t )(a_o + c) > a->len) {
#line 412
    return (-1);
  } else
#line 411
  if ((uint32_t )(b_o + c) > b->len) {
#line 412
    return (-1);
  }
#line 415
  noloop = 0;
  {
#line 415
  while (1) {
    while_continue: /* CIL Label */ ;
#line 415
    if (noloop < 128) {
#line 415
      if (! (c > 0)) {
#line 415
        goto while_break;
      }
    } else {
#line 415
      goto while_break;
    }
#line 416
    lc1 = *((a->str + a_o) + c);
#line 417
    lc2 = *((b->str + b_o) + c);
#line 418
    if ((int )lc1 >= 65) {
#line 418
      if ((int )lc1 <= 90) {
#line 418
        lc1 = (uint8_t )((int )lc1 + 32);
      }
    }
#line 419
    if ((int )lc2 >= 65) {
#line 419
      if ((int )lc2 <= 90) {
#line 419
        lc2 = (uint8_t )((int )lc2 + 32);
      }
    }
#line 420
    if ((int )lc1 != (int )lc2) {
#line 421
      return (0);
    }
#line 423
    c --;
#line 415
    noloop ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 426
  return (1);
}
}
#line 441 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int dwc_dname_same(dw_str *u , int32_t u_o , dw_str *c , int32_t c_o , dw_str *q ) 
{ 
  int count ;
  int in_q ;
  int len ;
  int32_t place ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 442
  count = 0;
#line 442
  in_q = 0;
#line 442
  len = 0;
#line 443
  place = 0;
#line 445
  place = c_o;
#line 447
  tmp = dw_assert_sanity(u);
  }
#line 447
  if (tmp == -1) {
#line 449
    return (-1);
  } else {
    {
#line 447
    tmp___0 = dw_assert_sanity(c);
    }
#line 447
    if (tmp___0 == -1) {
#line 449
      return (-1);
    } else
#line 447
    if (u_o < 0) {
#line 449
      return (-1);
    } else
#line 447
    if ((uint32_t )u_o > u->len) {
#line 449
      return (-1);
    } else
#line 447
    if (c_o < 0) {
#line 449
      return (-1);
    } else
#line 447
    if ((uint32_t )c_o > c->len) {
#line 449
      return (-1);
    }
  }
#line 452
  count = 0;
  {
#line 452
  while (1) {
    while_continue: /* CIL Label */ ;
#line 452
    if (! (count < 300)) {
#line 452
      goto while_break;
    }
#line 454
    if (in_q == 0) {
#line 455
      if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
        {
#line 456
        place = dwc_decomp_offset(c, place, (int32_t )q->len);
        }
      } else {
        {
#line 458
        place = dwc_decomp_offset(c, place, 0);
        }
      }
#line 460
      if (place == -1) {
#line 461
        return (-1);
      } else
#line 460
      if ((unsigned long )q == (unsigned long )((dw_str *)0)) {
#line 460
        if (place < 0) {
#line 461
          return (-1);
        }
      }
#line 463
      if (place < -1) {
#line 463
        if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
#line 464
          in_q = 1;
#line 465
          place = -2 - place;
        }
      }
    }
#line 468
    if (in_q == 0) {
      {
#line 469
      tmp___1 = dwc_label_same(u, u_o, c, place);
      }
#line 469
      if (tmp___1 != 1) {
#line 470
        return (0);
      }
    } else {
      {
#line 473
      tmp___2 = dwc_label_same(u, u_o, q, place);
      }
#line 473
      if (tmp___2 != 1) {
#line 474
        return (0);
      }
    }
#line 477
    len = (int )*(u->str + u_o);
#line 478
    if (len == 0) {
#line 479
      return (1);
    }
#line 481
    if (len < 0) {
#line 482
      return (-1);
    } else
#line 481
    if (len > 64) {
#line 482
      return (-1);
    } else
#line 481
    if ((uint32_t )(u_o + len) >= u->len) {
#line 482
      return (-1);
    }
#line 484
    if (in_q == 0) {
#line 484
      if ((uint32_t )(place + len) >= c->len) {
#line 485
        return (-1);
      } else {
#line 484
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 486
    if (in_q == 1) {
#line 486
      if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
#line 486
        if ((uint32_t )(place + len) >= q->len) {
#line 487
          return (-1);
        }
      }
    }
#line 489
    u_o += len + 1;
#line 490
    place += len + 1;
#line 452
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 492
  return (-1);
}
}
#line 528 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_in_bailiwick(dw_str *b , int32_t b_o , dw_str *h , int32_t h_o , dw_str *q ) 
{ 
  int count ;
  int in_q_string ;
  int len ;
  int32_t place ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 530
  count = 0;
#line 530
  in_q_string = 0;
#line 530
  len = 0;
#line 531
  place = 0;
#line 533
  tmp = dw_assert_sanity(b);
  }
#line 533
  if (tmp == -1) {
#line 535
    return (-1);
  } else {
    {
#line 533
    tmp___0 = dw_assert_sanity(h);
    }
#line 533
    if (tmp___0 == -1) {
#line 535
      return (-1);
    } else
#line 533
    if (b_o < 0) {
#line 535
      return (-1);
    } else
#line 533
    if ((uint32_t )b_o > b->len) {
#line 535
      return (-1);
    } else
#line 533
    if (h_o < 0) {
#line 535
      return (-1);
    } else
#line 533
    if ((uint32_t )h_o > h->len) {
#line 535
      return (-1);
    }
  }
#line 537
  place = h_o;
#line 538
  count = 0;
  {
#line 538
  while (1) {
    while_continue: /* CIL Label */ ;
#line 538
    if (! (count < 300)) {
#line 538
      goto while_break;
    }
#line 539
    if (in_q_string == 0) {
#line 540
      if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
        {
#line 541
        place = dwc_decomp_offset(h, place, (int32_t )q->len);
        }
      } else {
        {
#line 543
        place = dwc_decomp_offset(h, place, 0);
        }
      }
#line 545
      if (place == -1) {
#line 546
        return (-1);
      } else
#line 545
      if ((unsigned long )q == (unsigned long )((dw_str *)0)) {
#line 545
        if (place < 0) {
#line 546
          return (-1);
        }
      }
#line 548
      if (place < 0) {
#line 548
        if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
#line 549
          place = -2 - place;
#line 550
          in_q_string = 1;
        }
      }
    }
#line 553
    if (in_q_string == 0) {
      {
#line 554
      tmp___1 = dwc_dname_same(b, b_o, h, place, q);
      }
#line 554
      if (tmp___1 == 1) {
#line 555
        return (place);
      }
    } else {
      {
#line 558
      tmp___2 = dwc_dname_same(b, b_o, q, place, q);
      }
#line 558
      if (tmp___2 == 1) {
#line 559
        return (-3 - place);
      }
    }
#line 563
    if (in_q_string == 0) {
#line 564
      len = (int )*(h->str + place);
#line 565
      if ((uint32_t )((len + place) + 1) > h->len) {
#line 566
        return (-1);
      }
    } else
#line 568
    if ((unsigned long )q != (unsigned long )((dw_str *)0)) {
#line 569
      len = (int )*(q->str + place);
#line 570
      if ((uint32_t )((len + place) + 1) > q->len) {
#line 571
        return (-1);
      }
    } else {
#line 574
      return (-1);
    }
#line 576
    if (len == 0) {
#line 577
      return (-2);
    }
#line 579
    place += len + 1;
#line 538
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 581
  return (-1);
}
}
#line 594 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int dwc_push_offsets(dw_str *dns , int32_t place , dw_str *stack , int32_t offset ) 
{ 
  int len ;
  int count ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 598
  tmp = dw_assert_sanity(dns);
  }
#line 598
  if (tmp == -1) {
#line 599
    return (-1);
  } else {
    {
#line 598
    tmp___0 = dw_assert_sanity(stack);
    }
#line 598
    if (tmp___0 == -1) {
#line 599
      return (-1);
    }
  }
#line 602
  count = 0;
  {
#line 602
  while (1) {
    while_continue: /* CIL Label */ ;
#line 602
    if (! (count < 300)) {
#line 602
      goto while_break;
    }
#line 603
    if ((uint32_t )place > dns->len) {
#line 604
      return (-1);
    } else
#line 603
    if (place < 0) {
#line 604
      return (-1);
    }
#line 606
    len = (int )*(dns->str + place);
#line 607
    if (len >= 192) {
#line 608
      return (0);
    } else
#line 607
    if (len == 0) {
#line 608
      return (0);
    }
#line 610
    if (len >= 64) {
#line 611
      return (-1);
    }
#line 613
    if (place < 0) {
#line 615
      return (-1);
    } else
#line 613
    if (place >= 16383) {
#line 615
      return (-1);
    } else
#line 613
    if (place + offset < 0) {
#line 615
      return (-1);
    } else
#line 613
    if (place + offset > 65535) {
#line 615
      return (-1);
    }
    {
#line 617
    tmp___1 = dw_put_u16(stack, (uint16_t )(place + offset), -1);
    }
#line 617
    if (tmp___1 == -1) {
#line 618
      return (-1);
    }
#line 620
    place += len + 1;
#line 602
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 622
  return (0);
}
}
#line 640 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_seek_comp_pointer(dw_str *u , int32_t u_o , dw_str *c , dw_str *q , dw_str *s ) 
{ 
  int32_t s_o ;
  int32_t offset ;
  int in_q ;
  int count ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 642
  s_o = 0;
#line 644
  offset = 0;
#line 645
  in_q = 0;
#line 646
  count = 0;
#line 648
  tmp = dw_assert_sanity(u);
  }
#line 648
  if (tmp == -1) {
#line 650
    return (-1);
  } else {
    {
#line 648
    tmp___0 = dw_assert_sanity(c);
    }
#line 648
    if (tmp___0 == -1) {
#line 650
      return (-1);
    } else
#line 648
    if (u_o < 0) {
#line 650
      return (-1);
    } else
#line 648
    if ((uint32_t )u_o > u->len) {
#line 650
      return (-1);
    }
  }
#line 653
  count = 0;
  {
#line 653
  while (1) {
    while_continue: /* CIL Label */ ;
#line 653
    if (count < 1000) {
#line 653
      if (! ((uint32_t )s_o < s->len)) {
#line 653
        goto while_break;
      }
    } else {
#line 653
      goto while_break;
    }
    {
#line 654
    offset = dw_fetch_u16(s, s_o);
#line 655
    in_q = 0;
    }
#line 656
    if (offset < 0) {
#line 657
      return (-1);
    }
#line 659
    if (offset >= 32768) {
#line 660
      in_q = 1;
    }
#line 662
    offset &= 16383;
#line 663
    if (in_q == 1) {
      {
#line 664
      tmp___1 = dwc_dname_same(u, u_o, q, offset, (dw_str *)0);
      }
#line 664
      if (tmp___1 == 1) {
#line 665
        return (12 + offset);
      }
    } else {
      {
#line 668
      tmp___2 = dwc_dname_same(u, u_o, c, offset, q);
      }
#line 668
      if (tmp___2 == 1) {
#line 669
        return ((int32_t )(((12U + q->len) + 2U) + (uint32_t )offset));
      }
    }
#line 672
    s_o += 2;
#line 653
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 674
  return (-2);
}
}
#line 691 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_compress_dlabels(dw_str *u , int32_t u_o , dw_str *c , int num_dlabels ,
                             dw_str *s , dw_str *q , uint8_t d ) 
{ 
  int32_t point ;
  int count ;
  int len ;
  dw_str *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int32_t tmp___4 ;
  int32_t tmp___5 ;
  int tmp___6 ;

  {
  {
#line 693
  point = 0;
#line 694
  count = 0;
#line 694
  len = 0;
#line 695
  tmp = (dw_str *)0;
#line 697
  tmp___0 = dw_assert_sanity(u);
  }
#line 697
  if (tmp___0 == -1) {
#line 700
    return (-1);
  } else {
    {
#line 697
    tmp___1 = dw_assert_sanity(c);
    }
#line 697
    if (tmp___1 == -1) {
#line 700
      return (-1);
    } else {
      {
#line 697
      tmp___2 = dw_assert_sanity(s);
      }
#line 697
      if (tmp___2 == -1) {
#line 700
        return (-1);
      } else
#line 697
      if (u_o < 0) {
#line 700
        return (-1);
      } else
#line 697
      if ((uint32_t )u_o > u->len) {
#line 700
        return (-1);
      }
    }
  }
#line 703
  if ((int )d >= 20) {
#line 704
    return (u_o);
  } else
#line 703
  if (num_dlabels <= 0) {
#line 704
    return (u_o);
  }
#line 707
  count = 0;
  {
#line 707
  while (1) {
    while_continue: /* CIL Label */ ;
#line 707
    if (! (count < 300)) {
#line 707
      goto while_break;
    }
    {
#line 708
    point = dwc_seek_comp_pointer(u, u_o, c, q, s);
    }
#line 709
    if (point > 0) {
      {
#line 710
      point &= 16383;
#line 711
      point |= 49152;
#line 712
      tmp___3 = dw_put_u16(c, (uint16_t )point, -1);
      }
#line 712
      if (tmp___3 == -1) {
#line 713
        return (-1);
      }
      {
#line 715
      point = dw_get_dn_end(u, u_o);
      }
#line 716
      if (point == -1) {
#line 717
        return (-1);
      }
      {
#line 719
      tmp___4 = dwc_compress_dlabels(u, point, c, num_dlabels - 1, s, q, (uint8_t )((int )d + 1));
      }
#line 719
      return (tmp___4);
    } else
#line 721
    if (point == -2) {
#line 723
      len = (int )*(u->str + u_o);
#line 724
      if (len > 63) {
#line 725
        return (-1);
      } else
#line 724
      if (len < 0) {
#line 725
        return (-1);
      } else
#line 726
      if (len == 0) {
        {
#line 727
        dw_addchar((uint8_t )0, c);
#line 728
        tmp___5 = dwc_compress_dlabels(u, u_o + 1, c, num_dlabels - 1, s, q, (uint8_t )((int )d + 1));
        }
#line 728
        return (tmp___5);
      }
      {
#line 732
      tmp___6 = dw_put_u16(s, (uint16_t )c->len, -1);
      }
#line 732
      if (tmp___6 == -1) {
#line 733
        return (-1);
      }
      {
#line 736
      tmp = dw_substr(u, u_o, len + 1, 1);
      }
#line 737
      if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 738
        return (-1);
      }
      {
#line 740
      dw_append(tmp, c);
#line 741
      dw_destroy(tmp);
#line 742
      u_o += len + 1;
      }
    } else {
#line 745
      return (-1);
    }
#line 707
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 749
  return (-1);
}
}
#line 761 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int32_t dwc_comp_rddata(int16_t desc , dw_str *u , int32_t offset , dw_str *c , dw_str *s ,
                        dw_str *q ) 
{ 
  dw_str *tmp ;
  int lead ;
  int ndnames ;
  int tail ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 764
  tmp = (dw_str *)0;
#line 765
  lead = 0;
#line 765
  ndnames = 0;
#line 765
  tail = 0;
#line 767
  tmp___0 = dw_assert_sanity(u);
  }
#line 767
  if (tmp___0 == -1) {
#line 770
    return (-1);
  } else {
    {
#line 767
    tmp___1 = dw_assert_sanity(c);
    }
#line 767
    if (tmp___1 == -1) {
#line 770
      return (-1);
    } else {
      {
#line 767
      tmp___2 = dw_assert_sanity(s);
      }
#line 767
      if (tmp___2 == -1) {
#line 770
        return (-1);
      } else
#line 767
      if ((int )desc < 0) {
#line 770
        return (-1);
      } else
#line 767
      if (offset < 0) {
#line 770
        return (-1);
      } else
#line 767
      if ((uint32_t )offset > u->len) {
#line 770
        return (-1);
      }
    }
  }
#line 773
  lead = ((int )desc & 3840) >> 8;
#line 774
  ndnames = ((int )desc & 240) >> 4;
#line 775
  tail = ((int )desc & 15) << 1;
#line 779
  if (lead > 0) {
    {
#line 780
    tmp = dw_substr(u, offset, lead, 1);
#line 781
    tmp___3 = dw_append(tmp, c);
    }
#line 781
    if (tmp___3 == -1) {
      {
#line 782
      dw_destroy(tmp);
      }
#line 783
      return (-1);
    }
    {
#line 785
    dw_destroy(tmp);
#line 786
    offset += lead;
    }
  }
  {
#line 789
  offset = dwc_compress_dlabels(u, offset, c, ndnames, s, q, (uint8_t )0);
  }
#line 790
  if (offset == -1) {
#line 791
    return (-1);
  }
#line 796
  if (tail > 0) {
    {
#line 797
    tmp = dw_substr(u, offset, tail, 1);
#line 798
    tmp___4 = dw_append(tmp, c);
    }
#line 798
    if (tmp___4 == -1) {
      {
#line 799
      dw_destroy(tmp);
      }
#line 800
      return (-1);
    }
    {
#line 802
    dw_destroy(tmp);
#line 803
    offset += tail;
    }
  }
#line 806
  return (offset);
}
}
#line 821 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int dwc_compress_rr(uint16_t *o , dw_str *u , dw_str *c , dw_str *q , dw_str *s ) 
{ 
  uint16_t name ;
  uint16_t data ;
  int16_t desc ;
  int32_t offset ;
  int32_t rdplace ;
  int32_t type ;
  int32_t len ;
  int32_t rdold ;
  dw_str *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 822
  name = (uint16_t )0;
#line 822
  data = (uint16_t )0;
#line 823
  desc = (int16_t )0;
#line 824
  offset = 0;
#line 824
  rdplace = 0;
#line 824
  type = 0;
#line 824
  len = 0;
#line 824
  rdold = 0;
#line 825
  tmp = (dw_str *)0;
#line 827
  tmp___0 = dw_assert_sanity(u);
  }
#line 827
  if (tmp___0 == -1) {
#line 830
    return (-1);
  } else {
    {
#line 827
    tmp___1 = dw_assert_sanity(c);
    }
#line 827
    if (tmp___1 == -1) {
#line 830
      return (-1);
    } else {
      {
#line 827
      tmp___2 = dw_assert_sanity(q);
      }
#line 827
      if (tmp___2 == -1) {
#line 830
        return (-1);
      } else {
        {
#line 827
        tmp___3 = dw_assert_sanity(s);
        }
#line 827
        if (tmp___3 == -1) {
#line 830
          return (-1);
        } else
#line 827
        if ((unsigned long )o == (unsigned long )((uint16_t *)0)) {
#line 830
          return (-1);
        }
      }
    }
  }
#line 833
  name = *(o + 0);
#line 834
  data = *(o + 1);
#line 835
  offset = (int32_t )name;
#line 837
  if ((uint32_t )name > u->len) {
#line 838
    return (-1);
  } else
#line 837
  if ((uint32_t )data > u->len) {
#line 838
    return (-1);
  } else
#line 837
  if ((int )name > (int )data) {
#line 838
    return (-1);
  }
  {
#line 841
  offset = dwc_compress_dlabels(u, offset, c, 1, s, q, (uint8_t )0);
  }
#line 842
  if (offset == -1) {
#line 843
    return (-1);
  } else
#line 842
  if (offset != (int32_t )data) {
#line 843
    return (-1);
  }
  {
#line 847
  tmp = dw_substr(u, offset, 10, 1);
  }
#line 848
  if ((unsigned long )tmp == (unsigned long )((dw_str *)0)) {
#line 849
    return (-1);
  }
  {
#line 851
  dw_append(tmp, c);
#line 852
  dw_destroy(tmp);
#line 854
  type = dw_fetch_u16(u, offset);
#line 855
  rdplace = offset + 8;
#line 856
  offset += 10;
#line 857
  desc = dwc_type_desc(type);
  }
#line 858
  if (((int )desc & 4096) == 0) {
    {
#line 859
    len = dw_fetch_u16(u, rdplace);
#line 860
    tmp = dw_substr(u, offset, len, 1);
#line 861
    tmp___4 = dw_append(tmp, c);
    }
#line 861
    if (tmp___4 == -1) {
      {
#line 862
      dw_destroy(tmp);
      }
#line 863
      return (-1);
    }
    {
#line 865
    dw_destroy(tmp);
    }
  } else {
    {
#line 867
    rdold = (int32_t )c->len;
#line 868
    offset = dwc_comp_rddata(desc, u, offset, c, s, q);
#line 869
    dw_put_u16(c, (uint16_t )(c->len - (uint32_t )rdold), rdold - 2);
    }
#line 870
    if (offset == -1) {
#line 871
      return (-1);
    }
  }
#line 875
  return (1);
}
}
#line 880 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
int dwc_compress_all_rrs(dns_string *unpack , dw_str *in , dw_str *out , dw_str *q ,
                         dw_str *stack ) 
{ 
  int32_t seek ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
  {
#line 882
  seek = 0;
#line 884
  tmp = dw_assert_sanity(in);
  }
#line 884
  if (tmp == -1) {
#line 887
    return (-1);
  } else {
    {
#line 884
    tmp___0 = dw_assert_sanity(out);
    }
#line 884
    if (tmp___0 == -1) {
#line 887
      return (-1);
    } else {
      {
#line 884
      tmp___1 = dw_assert_sanity(q);
      }
#line 884
      if (tmp___1 == -1) {
#line 887
        return (-1);
      } else {
        {
#line 884
        tmp___2 = dw_assert_sanity(stack);
        }
#line 884
        if (tmp___2 == -1) {
#line 887
          return (-1);
        } else
#line 884
        if ((unsigned long )unpack == (unsigned long )((dns_string *)0)) {
#line 887
          return (-1);
        }
      }
    }
  }
#line 891
  seek = 0;
  {
#line 891
  while (1) {
    while_continue: /* CIL Label */ ;
#line 891
    if (! (seek < unpack->ancount * 2)) {
#line 891
      goto while_break;
    }
    {
#line 892
    tmp___3 = dwc_compress_rr(unpack->an + seek, in, out, q, stack);
    }
#line 892
    if (tmp___3 == -1) {
#line 893
      return (-1);
    }
#line 891
    seek += 2;
  }
  while_break: /* CIL Label */ ;
  }
#line 898
  seek = 0;
  {
#line 898
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 898
    if (! (seek < unpack->nscount * 2)) {
#line 898
      goto while_break___0;
    }
    {
#line 899
    tmp___4 = dwc_compress_rr(unpack->ns + seek, in, out, q, stack);
    }
#line 899
    if (tmp___4 == -1) {
#line 900
      return (-1);
    }
#line 898
    seek += 2;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 905
  seek = 0;
  {
#line 905
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 905
    if (! (seek < unpack->arcount * 2)) {
#line 905
      goto while_break___1;
    }
    {
#line 906
    tmp___5 = dwc_compress_rr(unpack->ar + seek, in, out, q, stack);
    }
#line 906
    if (tmp___5 == -1) {
#line 907
      return (-1);
    }
#line 905
    seek += 2;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 911
  return (1);
}
}
#line 917 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwCompress.c"
dw_str *dwc_compress(dw_str *q , dw_str *in ) 
{ 
  dw_str *stack ;
  dw_str *out ;
  dns_string *unpack ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 918
  stack = (dw_str *)0;
#line 919
  out = (dw_str *)0;
#line 920
  unpack = (dns_string *)0;
#line 922
  tmp = dw_assert_sanity(q);
  }
#line 922
  if (tmp == -1) {
#line 923
    return ((dw_str *)0);
  } else {
    {
#line 922
    tmp___0 = dw_assert_sanity(in);
    }
#line 922
    if (tmp___0 == -1) {
#line 923
      return ((dw_str *)0);
    }
  }
  {
#line 926
  stack = dw_create((uint32_t )1024);
#line 927
  out = dw_create((uint32_t )515);
  }
#line 928
  if ((unsigned long )stack == (unsigned long )((dw_str *)0)) {
#line 929
    goto catch_dwc_compress;
  }
  {
#line 931
  tmp___1 = dwc_push_offsets(q, 0, stack, 32768);
  }
#line 931
  if (tmp___1 == -1) {
#line 932
    goto catch_dwc_compress;
  }
  {
#line 934
  unpack = dwc_make_dns_str(in);
  }
#line 935
  if ((unsigned long )unpack == (unsigned long )((dns_string *)0)) {
#line 936
    goto catch_dwc_compress;
  }
  {
#line 939
  tmp___2 = dwc_compress_all_rrs(unpack, in, out, q, stack);
  }
#line 939
  if (tmp___2 == -1) {
#line 940
    goto catch_dwc_compress;
  }
  {
#line 943
  dw_put_u16(out, (uint16_t )unpack->ancount, -1);
#line 944
  dw_put_u16(out, (uint16_t )unpack->nscount, -1);
#line 945
  dw_put_u16(out, (uint16_t )unpack->arcount, -1);
#line 946
  dw_addchar(unpack->type, out);
#line 947
  dw_destroy(stack);
#line 948
  dwc_zap_dns_str(unpack);
  }
#line 949
  return (out);
  catch_dwc_compress: 
#line 952
  if ((unsigned long )stack != (unsigned long )((dw_str *)0)) {
    {
#line 953
    dw_destroy(stack);
    }
  }
#line 955
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 956
    dw_destroy(out);
    }
  }
#line 958
  if ((unsigned long )unpack != (unsigned long )((dns_string *)0)) {
    {
#line 959
    dwc_zap_dns_str(unpack);
    }
  }
#line 961
  return ((dw_str *)0);
}
}
#line 23 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.h"
dw_hash *dwd_init(void) ;
#line 39
dw_hash *dwd_add(dw_hash *hash , dw_str *key___6 , dw_str *value___6 ) ;
#line 49
dw_str *dwd_nextkey(dw_hash *hash , dw_str *key___6 ) ;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.c"
dw_hash *dwd_init(void) 
{ 
  dw_hash *tmp ;

  {
  {
#line 45
  tmp = dwh_hash_init((uint32_t )2);
  }
#line 45
  return (tmp);
}
}
#line 60 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.c"
dw_hash *dwd_add(dw_hash *hash , dw_str *key___6 , dw_str *value___6 ) 
{ 
  int a ;
  dw_hash *tmp ;

  {
  {
#line 61
  a = 0;
#line 62
  a = dwh_add(hash, key___6, value___6, 1, 0);
  }
#line 63
  if (a == -1) {
#line 64
    return (hash);
  }
  {
#line 66
  tmp = dwh_hash_autogrow(hash);
  }
#line 66
  return (tmp);
}
}
#line 72 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.c"
dw_str *dwd_fetch(dw_hash *hash , dw_str *key___6 ) 
{ 
  dw_str *tmp ;

  {
  {
#line 74
  tmp = dwh_get(hash, key___6, 1, 0);
  }
#line 74
  return (tmp);
}
}
#line 80 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwDict.c"
dw_str *dwd_nextkey(dw_hash *hash , dw_str *key___6 ) 
{ 
  int32_t count ;
  int found ;
  int noloop ;
  dw_element *point ;
  dw_element *next ;
  uint32_t tmp ;
  dw_str *tmp___0 ;
  int tmp___1 ;

  {
#line 81
  count = 0;
#line 82
  found = 0;
#line 82
  noloop = 0;
#line 83
  point = (dw_element *)0;
#line 83
  next = (dw_element *)0;
#line 85
  if ((unsigned long )hash == (unsigned long )((dw_hash *)0)) {
#line 86
    return ((dw_str *)0);
  }
#line 89
  if ((unsigned long )key___6 == (unsigned long )((dw_str *)0)) {
#line 90
    found = 1;
#line 91
    count = 0;
  } else {
    {
#line 93
    tmp = dwh_hash_compress(key___6);
#line 93
    count = (int32_t )(tmp & hash->mask);
    }
  }
  {
#line 97
  while (1) {
    while_continue: /* CIL Label */ ;
#line 97
    if (! ((uint32_t )count <= hash->mask)) {
#line 97
      goto while_break;
    }
#line 98
    point = *(hash->hash + count);
#line 99
    noloop = 0;
    {
#line 99
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 99
      if (noloop < 10000) {
#line 99
        if (! ((unsigned long )point != (unsigned long )((dw_element *)0))) {
#line 99
          goto while_break___0;
        }
      } else {
#line 99
        goto while_break___0;
      }
#line 100
      next = point->next;
#line 101
      if (found == 1) {
        {
#line 102
        tmp___0 = dw_substr(point->key, 0, -1, -1);
        }
#line 102
        return (tmp___0);
      }
      {
#line 104
      tmp___1 = dw_issame(point->key, key___6);
      }
#line 104
      if (tmp___1 == 1) {
#line 105
        found = 1;
      }
#line 107
      point = next;
#line 99
      noloop ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 97
    count ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 111
  return ((dw_str *)0);
}
}
#line 360 "/usr/include/unistd.h"
extern ssize_t read(int __fd , void *__buf , size_t __nbytes ) ;
#line 497
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) chdir)(char const   *__path ) ;
#line 628
extern  __attribute__((__nothrow__)) __pid_t ( __attribute__((__leaf__)) getpid)(void) ;
#line 700
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setuid)(__uid_t __uid ) ;
#line 717
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setgid)(__gid_t __gid ) ;
#line 944
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) chroot)(char const   *__path ) ;
#line 146 "/usr/include/fcntl.h"
extern int ( __attribute__((__nonnull__(1))) open)(char const   *__file , int __oflag 
                                                   , ...) ;
#line 342 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) clock_gettime)(clockid_t __clock_id ,
                                                                                    struct timespec *__tp ) ;
#line 209 "/usr/include/x86_64-linux-gnu/sys/stat.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) stat)(char const   * __restrict  __file ,
                                                                                             struct stat * __restrict  __buf ) ;
#line 180 "/usr/include/grp.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setgroups)(size_t __n ,
                                                                                __gid_t const   *__groups ) ;
#line 102 "/usr/include/signal.h"
extern  __attribute__((__nothrow__)) __sighandler_t ( __attribute__((__leaf__)) signal)(int __sig ,
                                                                                        void (*__handler)(int  ) ) ;
#line 239 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
int dwm_parse_mararc(char *name ) ;
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.h"
void dw_log_init(void) ;
#line 52
void dw_log_close(void) ;
#line 75
void dw_log_number(char *s1 , int number , char *s2 , int min_log_level ) ;
#line 88
void dw_alog_number(char *s1 , int number , char *s2 ) ;
#line 96
void set_time(void) ;
#line 100
void process_mararc(char *name ) ;
#line 103
void init_cache(void) ;
#line 108
void setup_signals(void) ;
#line 112
void process_signal(int number ) ;
#line 115
void init_rng(void) ;
#line 118
void sandbox(void) ;
#line 122
dw_str *get_bind_addrs(void) ;
#line 145
void make_netmask(int num , uint8_t *str , int len ) ;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int64_t the_time  =    (int64_t )0;
#line 38 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
dwr_rg *rng_seed  ;
#line 41 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int do_read_cache  =    1;
#line 42 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
struct stat mararc_st  ;
#line 45
dw_str *key_s[8] ;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
dw_hash *cache  =    (dw_hash *)0;
#line 53
int32_t maradns_uid ;
#line 54
int32_t maradns_gid ;
#line 73 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_init(void) 
{ 


  {
#line 79
  return;
}
}
#line 83 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_close(void) 
{ 


  {
#line 89
  return;
}
}
#line 93 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_dwstr_p(char *s1 , dw_str *s2 , int min_log_level ) 
{ 
  int32_t ll ;
  uint8_t q ;

  {
#line 94
  ll = key_n[14];
#line 95
  q = (uint8_t )0;
#line 97
  if (ll <= 0) {
#line 98
    return;
  } else
#line 97
  if (ll < min_log_level) {
#line 98
    return;
  }
  {
#line 102
  printf((char const   */* __restrict  */)"%s", s1);
  }
#line 108
  if ((unsigned long )s2 == (unsigned long )((dw_str *)0)) {
    {
#line 110
    printf((char const   */* __restrict  */)"(null dw_str)");
    }
#line 114
    return;
  }
#line 117
  ll = 0;
  {
#line 117
  while (1) {
    while_continue: /* CIL Label */ ;
#line 117
    if (! ((uint32_t )ll < s2->len)) {
#line 117
      goto while_break;
    }
#line 118
    q = *(s2->str + ll);
#line 119
    if ((int )q >= 46) {
#line 119
      if ((int )q <= 126) {
#line 119
        if ((int )q != 92) {
          {
#line 121
          printf((char const   */* __restrict  */)"%c", (int )q);
          }
        } else {
          {
#line 127
          printf((char const   */* __restrict  */)"\\%03o", (int )q);
          }
        }
      } else {
        {
#line 127
        printf((char const   */* __restrict  */)"\\%03o", (int )q);
        }
      }
    } else {
      {
#line 127
      printf((char const   */* __restrict  */)"\\%03o", (int )q);
      }
    }
#line 117
    ll ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 133
  return;
}
}
#line 136 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_ip_p(ip_addr_T *ip ) 
{ 
  int counter ;

  {
#line 137
  counter = 0;
#line 139
  if ((unsigned long )ip == (unsigned long )((ip_addr_T *)0)) {
    {
#line 141
    printf((char const   */* __restrict  */)"%s", "(null IP)\n");
    }
#line 145
    return;
  }
#line 148
  if ((int )ip->len == 4) {
#line 149
    counter = 0;
    {
#line 149
    while (1) {
      while_continue: /* CIL Label */ ;
#line 149
      if (! (counter < 3)) {
#line 149
        goto while_break;
      }
      {
#line 151
      printf((char const   */* __restrict  */)"%d.", (int )ip->ip[counter]);
#line 149
      counter ++;
      }
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 157
    printf((char const   */* __restrict  */)"%d ", (int )ip->ip[3]);
    }
  } else
#line 162
  if ((int )ip->len == 16) {
#line 163
    counter = 0;
    {
#line 163
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 163
      if (! (counter < 15)) {
#line 163
        goto while_break___0;
      }
      {
#line 165
      printf((char const   */* __restrict  */)"%02x:", (int )ip->ip[counter]);
#line 163
      counter ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 171
    printf((char const   */* __restrict  */)"%02x ", (int )ip->ip[15]);
    }
  } else {
    {
#line 178
    printf((char const   */* __restrict  */)"%s%d", "IP of length ", (int )ip->len);
    }
  }
#line 183
  return;
}
}
#line 186 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_ip(char *string , ip_addr_T *ip , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 187
  ll = key_n[14];
#line 188
  if (ll <= 0) {
#line 189
    return;
  } else
#line 188
  if (ll < min_log_level) {
#line 189
    return;
  }
  {
#line 193
  printf((char const   */* __restrict  */)"%s ", string);
#line 199
  dw_log_ip_p(ip);
#line 202
  printf((char const   */* __restrict  */)"%s", "\n");
  }
#line 207
  return;
}
}
#line 210 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_dwstr(char *s1 , dw_str *s2 , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 211
  ll = key_n[14];
#line 212
  if (ll <= 0) {
#line 213
    return;
  } else
#line 212
  if (ll < min_log_level) {
#line 213
    return;
  }
  {
#line 216
  dw_log_dwstr_p(s1, s2, min_log_level);
#line 221
  printf((char const   */* __restrict  */)"%s", "\n");
  }
#line 225
  return;
}
}
#line 229 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_dwstr_str(char *s1 , dw_str *s2 , char *s3 , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 230
  ll = key_n[14];
#line 231
  if (ll <= 0) {
#line 232
    return;
  } else
#line 231
  if (ll < min_log_level) {
#line 232
    return;
  }
  {
#line 235
  dw_log_dwstr_p(s1, s2, min_log_level);
#line 240
  printf((char const   */* __restrict  */)"%s\n", s3);
  }
#line 244
  return;
}
}
#line 249 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_string(char *string , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 250
  ll = key_n[14];
#line 252
  if (ll <= 0) {
#line 253
    return;
  } else
#line 252
  if (ll < min_log_level) {
#line 253
    return;
  }
  {
#line 257
  printf((char const   */* __restrict  */)"%s\n", string);
  }
#line 263
  return;
}
}
#line 267 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_3strings(char *s1 , char *s2 , char *s3 , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 268
  ll = key_n[14];
#line 270
  if (ll <= 0) {
#line 271
    return;
  } else
#line 270
  if (ll < min_log_level) {
#line 271
    return;
  }
  {
#line 275
  printf((char const   */* __restrict  */)"%s%s%s\n", s1, s2, s3);
  }
#line 280
  return;
}
}
#line 285 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_number(char *s1 , int number , char *s2 , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 286
  ll = key_n[14];
#line 288
  if (ll <= 0) {
#line 289
    return;
  } else
#line 288
  if (ll < min_log_level) {
#line 289
    return;
  }
  {
#line 293
  printf((char const   */* __restrict  */)"%s%d%s\n", s1, number, s2);
  }
#line 299
  return;
}
}
#line 301 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_log_hex(char *s1 , uint32_t number , int min_log_level ) 
{ 
  int32_t ll ;

  {
#line 302
  ll = key_n[14];
#line 304
  if (ll <= 0) {
#line 305
    return;
  } else
#line 304
  if (ll < min_log_level) {
#line 305
    return;
  }
  {
#line 309
  printf((char const   */* __restrict  */)"%s%x\n", s1, number);
  }
#line 314
  return;
}
}
#line 318 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_alog_3strings(char *s1 , char *s2 , char *s3 ) 
{ 


  {
  {
#line 321
  printf((char const   */* __restrict  */)"%s%s%s\n", s1, s2, s3);
  }
#line 327
  return;
}
}
#line 333 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_alog_number(char *s1 , int number , char *s2 ) 
{ 


  {
  {
#line 336
  printf((char const   */* __restrict  */)"%s%d %s\n", s1, number, s2);
  }
#line 342
  return;
}
}
#line 346 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void dw_fatal(char *why ) 
{ 


  {
#line 347
  if ((unsigned long )why != (unsigned long )((char *)0)) {
    {
#line 349
    printf((char const   */* __restrict  */)"Fatal: %s\n", why);
    }
  } else {
    {
#line 356
    printf((char const   */* __restrict  */)"Fatal: Unknown fatal error\n");
    }
  }
  {
#line 362
  dw_log_close();
#line 363
  exit(1);
  }
}
}
#line 369 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void set_time(void) 
{ 
  struct timespec posix_time ;
  time_t coarse ;
  long fine ;
  long result ;
  int tmp ;

  {
  {
#line 391
  tmp = clock_gettime(0, & posix_time);
#line 391
  result = (long )tmp;
  }
#line 392
  if (result == 0L) {
#line 393
    coarse = posix_time.tv_sec;
#line 394
    fine = posix_time.tv_nsec;
#line 395
    if (sizeof(coarse) > 4UL) {
#line 396
      if (coarse != -1L) {
#line 397
        the_time = coarse - 290805600L;
      }
    } else
#line 400
    if (coarse < 1178488417L) {
#line 401
      the_time = coarse + 4004161696L;
    } else {
#line 403
      the_time = coarse - 290805600L;
    }
#line 406
    the_time <<= 8;
#line 407
    fine /= 3906250L;
#line 408
    if (fine > 0L) {
#line 408
      if (fine <= 256L) {
#line 409
        the_time += fine;
      }
    }
  }
#line 424
  return;
}
}
#line 429 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int got_signal  =    0;
#line 439 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void handle_signal(int code ) 
{ 


  {
  {
#line 442
  if (code == 2) {
#line 442
    goto case_2;
  }
#line 442
  if (code == 15) {
#line 442
    goto case_2;
  }
#line 445
  if (code == 1) {
#line 445
    goto case_1;
  }
#line 448
  if (code == 10) {
#line 448
    goto case_10;
  }
#line 440
  goto switch_break;
  case_2: /* CIL Label */ 
  case_15: /* CIL Label */ 
#line 443
  got_signal = 1;
#line 444
  goto switch_break;
  case_1: /* CIL Label */ 
#line 446
  got_signal = 2;
#line 447
  goto switch_break;
  case_10: /* CIL Label */ 
#line 449
  got_signal = 3;
  switch_break: /* CIL Label */ ;
  }
  {
#line 451
  signal(code, & handle_signal);
  }
#line 452
  return;
}
}
#line 455 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void setup_signals(void) 
{ 


  {
  {
#line 456
  signal(15, & handle_signal);
#line 457
  signal(1, & handle_signal);
#line 458
  signal(10, & handle_signal);
#line 459
  signal(2, & handle_signal);
  }
#line 460
  return;
}
}
#line 464 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void process_signal(int number ) 
{ 
  dw_str *filename ;
  char *fname_convert ;
  uint8_t *tmp ;

  {
#line 465
  filename = (dw_str *)0;
#line 466
  fname_convert = (char *)0;
#line 470
  got_signal = 0;
#line 474
  filename = key_s[5];
#line 475
  if ((unsigned long )cache != (unsigned long )((dw_hash *)0)) {
#line 475
    if ((unsigned long )filename != (unsigned long )((dw_str *)0)) {
      {
#line 476
      dw_filename_sanitize(filename);
#line 477
      tmp = dw_to_cstr(filename);
#line 477
      fname_convert = (char *)tmp;
#line 478
      dwh_write_hash(cache, fname_convert);
#line 479
      free((void *)fname_convert);
      }
    }
  }
#line 484
  if (number == 1) {
    {
#line 485
    exit(0);
    }
  } else
#line 486
  if (number == 2) {
    {
#line 487
    exit(8);
    }
  }
#line 490
  return;
}
}
#line 493 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void init_cache(void) 
{ 
  dw_str *filename ;
  char *fname_convert ;
  struct stat cache_st ;
  uint8_t *tmp ;
  int tmp___0 ;

  {
  {
#line 494
  filename = (dw_str *)0;
#line 495
  fname_convert = (char *)0;
#line 498
  dwh_process_mararc_params();
  }
#line 499
  if ((unsigned long )cache != (unsigned long )((dw_hash *)0)) {
#line 500
    return;
  }
#line 504
  filename = key_s[5];
#line 505
  if ((unsigned long )filename != (unsigned long )((dw_str *)0)) {
#line 505
    if (do_read_cache == 1) {
      {
#line 506
      dw_filename_sanitize(filename);
#line 507
      tmp = dw_to_cstr(filename);
#line 507
      fname_convert = (char *)tmp;
#line 508
      tmp___0 = stat((char const   */* __restrict  */)fname_convert, (struct stat */* __restrict  */)(& cache_st));
      }
#line 508
      if (tmp___0 == 0) {
#line 508
        if (cache_st.st_mtim.tv_sec < mararc_st.st_mtim.tv_sec) {
          {
#line 510
          dw_log_string((char *)"Cache older than rc file; not reading cache", 0);
          }
        } else {
          {
#line 513
          cache = dwh_read_hash(fname_convert);
          }
        }
      } else {
        {
#line 513
        cache = dwh_read_hash(fname_convert);
        }
      }
      {
#line 515
      free((void *)fname_convert);
      }
    }
  }
#line 518
  if ((unsigned long )cache == (unsigned long )((dw_hash *)0)) {
    {
#line 519
    cache = dwh_hash_init((uint32_t )0);
    }
  }
#line 521
  return;
}
}
#line 525 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void process_mararc(char *name ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 526
  tmp = dwm_parse_mararc(name);
  }
#line 526
  if (tmp != 1) {
    {
#line 527
    dw_log_3strings((char *)"Fatal error parsing file ", name, (char *)"", 1);
#line 528
    exit(1);
    }
  }
  {
#line 536
  tmp___0 = stat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& mararc_st));
  }
#line 536
  if (tmp___0 != 0) {
    {
#line 537
    dw_log_string((char *)"Can not stat rc file; not reading cache", 0);
#line 538
    do_read_cache = 0;
    }
  }
#line 540
  return;
}
}
#line 544 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void noise_to_rng(uint8_t *noise , int len ) 
{ 
  dw_str *z ;
  int tmp ;

  {
  {
#line 545
  z = (dw_str *)0;
#line 547
  z = dw_create((uint32_t )(len + 1));
  }
#line 548
  if ((unsigned long )z == (unsigned long )((dw_str *)0)) {
    {
#line 549
    dw_fatal((char *)"error creating rng dw_str");
    }
  }
  {
#line 552
  tmp = dw_cstr_append(noise, len, z);
  }
#line 552
  if (tmp == -1) {
    {
#line 553
    dw_fatal((char *)"error putting noise in dw_str object");
    }
  }
  {
#line 556
  rng_seed = dwr_init_rg(z);
  }
#line 558
  if ((unsigned long )rng_seed == (unsigned long )((dwr_rg *)0)) {
    {
#line 559
    dw_fatal((char *)"error initializing rng_seed");
    }
  }
#line 562
  if ((unsigned long )z != (unsigned long )((dw_str *)0)) {
    {
#line 563
    dw_destroy(z);
#line 564
    z = (dw_str *)0;
    }
  }
#line 566
  return;
}
}
#line 571 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void get_entropy_from_seedfile(uint8_t *noise , int len ) 
{ 
  char *filename ;
  int zap ;
  int seed ;
  uint8_t *tmp ;
  ssize_t tmp___0 ;

  {
#line 572
  filename = (char *)0;
#line 573
  zap = 0;
#line 574
  seed = -1;
#line 576
  if ((unsigned long )key_s[4] == (unsigned long )((dw_str *)0)) {
#line 580
    filename = (char *)"/dev/urandom";
  } else {
    {
#line 583
    tmp = dw_to_cstr(key_s[4]);
#line 583
    filename = (char *)tmp;
#line 584
    zap = 1;
    }
  }
  {
#line 587
  seed = open((char const   *)filename, 0);
  }
#line 588
  if (seed == -1) {
    {
#line 589
    dw_log_3strings((char *)"Fatal error opening random seed file ", filename, (char *)"",
                    1);
#line 591
    exit(1);
    }
  }
  {
#line 594
  tmp___0 = read(seed, (void *)noise, (size_t )len);
  }
#line 594
  if (tmp___0 < 16L) {
    {
#line 595
    dw_log_3strings((char *)"Unable to get 128 bits of entropy; file ", filename,
                    (char *)" must be\n at least 16 bytes (128 bits) long", 1);
#line 598
    exit(1);
    }
  }
#line 601
  if (zap == 1) {
    {
#line 602
    free((void *)filename);
#line 603
    filename = (char *)0;
    }
  }
  {
#line 605
  close(seed);
  }
#line 607
  return;
}
}
#line 611 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void init_rng(void) 
{ 
  int a ;
  uint8_t *noise ;
  int64_t tstamp ;
  pid_t pnum ;
  void *tmp ;

  {
  {
#line 612
  a = 0;
#line 613
  noise = (uint8_t *)0;
#line 614
  tstamp = (int64_t )0;
#line 615
  pnum = 1;
#line 617
  tmp = malloc((size_t )512);
#line 617
  noise = (uint8_t *)tmp;
  }
#line 618
  if ((unsigned long )noise == (unsigned long )((uint8_t *)0)) {
    {
#line 619
    dw_fatal((char *)"error allocating memory for noise");
    }
  }
  {
#line 628
  get_entropy_from_seedfile(noise, 256);
#line 631
  set_time();
#line 632
  tstamp = the_time;
#line 633
  a = 0;
  }
  {
#line 633
  while (1) {
    while_continue: /* CIL Label */ ;
#line 633
    if (! (a < 8)) {
#line 633
      goto while_break;
    }
#line 634
    *((noise + a) + 256) = (uint8_t )(tstamp & 255L);
#line 635
    tstamp >>= 8;
#line 633
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 639
  pnum = getpid();
#line 640
  a = 0;
  }
  {
#line 640
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 640
    if (! ((unsigned long )a < sizeof(pnum))) {
#line 640
      goto while_break___0;
    }
#line 641
    *((noise + a) + 272) = (uint8_t )(pnum & 255);
#line 642
    pnum >>= 8;
#line 640
    a ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 646
  noise_to_rng(noise, 510);
  }
#line 648
  if ((unsigned long )noise != (unsigned long )((uint8_t *)0)) {
    {
#line 649
    free((void *)noise);
#line 650
    noise = (uint8_t *)0;
    }
  }
#line 653
  return;
}
}
#line 656 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void sandbox(void) 
{ 
  unsigned char *c ;
  gid_t g ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
#line 659
  c = (unsigned char *)0;
#line 660
  g = (gid_t )99;
#line 661
  if ((unsigned long )key_s[2] == (unsigned long )((dw_str *)0)) {
    {
#line 662
    dw_fatal((char *)"chroot_dir not set");
    }
  }
  {
#line 664
  c = dw_to_cstr(key_s[2]);
  }
#line 665
  if ((unsigned long )c == (unsigned long )((unsigned char *)0)) {
    {
#line 666
    dw_fatal((char *)"Converting chroot_dir to string failed");
    }
  }
  {
#line 668
  tmp = chdir((char const   *)((char *)c));
  }
#line 668
  if (tmp != 0) {
    {
#line 669
    printf((char const   */* __restrict  */)"There is no directory %s\n", (char *)c);
#line 670
    dw_fatal((char *)"chdir() failed");
    }
  }
  {
#line 673
  tmp___0 = chroot((char const   *)((char *)c));
  }
#line 673
  if (tmp___0 == -1) {
    {
#line 674
    dw_fatal((char *)"chroot() failed");
    }
  }
  {
#line 677
  tmp___1 = setgroups((size_t )1, (__gid_t const   *)(& g));
  }
#line 677
  if (tmp___1 == -1) {
    {
#line 678
    dw_fatal((char *)"setgroups() failed");
    }
  }
  {
#line 680
  tmp___2 = setgid((__gid_t )maradns_gid);
  }
#line 680
  if (tmp___2 != 0) {
    {
#line 681
    dw_fatal((char *)"setgid() failed");
    }
  }
  {
#line 683
  tmp___3 = setuid((__uid_t )maradns_uid);
  }
#line 683
  if (tmp___3 != 0) {
    {
#line 684
    dw_fatal((char *)"setuid() failed");
    }
  }
  {
#line 686
  tmp___4 = setuid((__uid_t )0);
  }
#line 686
  if (tmp___4 == 0) {
    {
#line 687
    dw_fatal((char *)"Your kernel\'s setuid() is broken");
    }
  }
#line 690
  if ((unsigned long )c != (unsigned long )((unsigned char *)0)) {
    {
#line 691
    free((void *)c);
#line 692
    c = (unsigned char *)0;
    }
  }
#line 694
  return;
}
}
#line 701 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
dw_str *get_bind_addrs(void) 
{ 
  dw_str *bind___0 ;
  int tmp ;
  int tmp___0 ;

  {
#line 702
  bind___0 = (dw_str *)0;
#line 704
  if ((unsigned long )key_s[0] != (unsigned long )((dw_str *)0)) {
    {
#line 705
    bind___0 = dw_substr(key_s[0], 0, -1, -1);
    }
  } else
#line 706
  if ((unsigned long )key_s[1] != (unsigned long )((dw_str *)0)) {
    {
#line 707
    bind___0 = dw_substr(key_s[1], 0, -1, -1);
    }
  } else {
    {
#line 709
    dw_fatal((char *)"Please set bind_address");
    }
  }
#line 712
  if ((unsigned long )bind___0 == (unsigned long )((dw_str *)0)) {
#line 713
    goto catch_get_bind_addrs;
  }
#line 716
  if ((unsigned long )key_s[0] != (unsigned long )((dw_str *)0)) {
#line 716
    if ((unsigned long )key_s[1] != (unsigned long )((dw_str *)0)) {
      {
#line 718
      tmp = dw_addchar((uint8_t )',', bind___0);
      }
#line 718
      if (tmp == -1) {
#line 719
        goto catch_get_bind_addrs;
      }
      {
#line 721
      tmp___0 = dw_append(key_s[1], bind___0);
      }
#line 721
      if (tmp___0 == -1) {
#line 722
        goto catch_get_bind_addrs;
      }
    }
  }
#line 726
  return (bind___0);
  catch_get_bind_addrs: 
#line 729
  if ((unsigned long )bind___0 != (unsigned long )((dw_str *)0)) {
    {
#line 730
    dw_destroy(bind___0);
#line 731
    bind___0 = (dw_str *)0;
    }
  }
#line 733
  return ((dw_str *)0);
}
}
#line 754 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int32_t get_dns_qid(unsigned char *a , int len , int roy_arends_check ) 
{ 


  {
#line 756
  if (len < 12) {
#line 757
    return (-1);
  }
#line 759
  if (roy_arends_check == 1) {
#line 759
    if (((int )*(a + 2) & 128) != 0) {
#line 761
      return (-1);
    }
  }
#line 763
  if (roy_arends_check == 2) {
#line 763
    if (((int )*(a + 2) & 249) != 1) {
#line 777
      return (-1);
    } else
#line 763
    if (((int )*(a + 3) & 127) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 4) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 5) != 1) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 6) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 7) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 8) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 9) != 0) {
#line 777
      return (-1);
    } else
#line 763
    if ((int )*(a + 10) != 0) {
#line 777
      return (-1);
    }
  }
#line 779
  if (roy_arends_check == 2) {
#line 779
    if ((int )*(a + 11) == 1) {
#line 780
      return (-2);
    }
  }
#line 782
  if (roy_arends_check == 2) {
#line 782
    if ((int )*(a + 11) != 0) {
#line 783
      return (-1);
    }
  }
#line 788
  if ((int )*(a + 5) == 0) {
#line 788
    if ((int )*(a + 4) == 0) {
#line 788
      if ((int )*(a + 6) == 0) {
#line 788
        if ((int )*(a + 7) == 0) {
#line 788
          if ((int )*(a + 8) == 0) {
#line 788
            if ((int )*(a + 9) == 0) {
#line 788
              if ((int )*(a + 10) == 0) {
#line 788
                if ((int )*(a + 11) == 0) {
                  {
#line 790
                  dw_log_string((char *)"Warning: Blank DNS packet", 10);
                  }
#line 791
                  return (-1);
                }
              }
            }
          }
        }
      }
    }
  }
#line 794
  return (((int )*(a + 0) << 8) | (int )*(a + 1));
}
}
#line 800 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int32_t set_dns_qid(unsigned char *packet , int len , uint16_t qid ) 
{ 


  {
#line 802
  if (len < 12) {
#line 803
    return (-1);
  }
#line 805
  *packet = (unsigned char )((int )qid >> 8);
#line 806
  *(packet + 1) = (unsigned char )((int )qid & 255);
#line 807
  return ((int32_t )qid);
}
}
#line 813 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
char *pop_last_item(dw_str *list ) 
{ 
  dw_str *a ;
  dw_str *b ;
  char *ret ;
  uint8_t *tmp ;

  {
  {
#line 814
  a = (dw_str *)0;
#line 814
  b = (dw_str *)0;
#line 815
  ret = (char *)0;
#line 817
  a = dw_qspop(list);
  }
#line 818
  if ((unsigned long )a == (unsigned long )((dw_str *)0)) {
#line 819
    goto catch_pop_last_item;
  }
  {
#line 821
  b = dw_zap_lws(a);
  }
#line 822
  if ((unsigned long )b == (unsigned long )((dw_str *)0)) {
#line 823
    goto catch_pop_last_item;
  }
  {
#line 825
  tmp = dw_to_cstr(b);
#line 825
  ret = (char *)tmp;
  }
  catch_pop_last_item: 
#line 828
  if ((unsigned long )a != (unsigned long )((dw_str *)0)) {
    {
#line 829
    dw_destroy(a);
#line 830
    a = (dw_str *)0;
    }
  }
#line 832
  if ((unsigned long )b != (unsigned long )((dw_str *)0)) {
    {
#line 833
    dw_destroy(b);
#line 834
    b = (dw_str *)0;
    }
  }
#line 836
  return (ret);
}
}
#line 843 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
void make_netmask(int num , uint8_t *str , int len ) 
{ 
  int div___0 ;
  int rem___0 ;
  uint8_t last ;

  {
#line 844
  div___0 = 0;
#line 844
  rem___0 = 0;
#line 845
  last = (uint8_t )0;
#line 847
  if (len < 1) {
#line 848
    return;
  } else
#line 847
  if (len > 64) {
#line 848
    return;
  }
#line 853
  div___0 = num >> 3;
#line 854
  rem___0 = num & 7;
#line 856
  if (div___0 < 0) {
#line 857
    return;
  } else
#line 856
  if (div___0 > len) {
#line 857
    return;
  }
#line 861
  last = (uint8_t )255;
#line 862
  last = (uint8_t )((int )last << (8 - rem___0));
  {
#line 866
  while (1) {
    while_continue: /* CIL Label */ ;
#line 866
    if (! (div___0 > 0)) {
#line 866
      goto while_break;
    }
#line 867
    *str = (uint8_t )255;
#line 868
    str ++;
#line 869
    div___0 --;
#line 870
    len --;
  }
  while_break: /* CIL Label */ ;
  }
#line 872
  if (len > 0) {
#line 873
    *str = last;
#line 874
    len --;
    {
#line 875
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 875
      if (! (len > 0)) {
#line 875
        goto while_break___0;
      }
#line 876
      str ++;
#line 877
      *str = (uint8_t )0;
#line 878
      len --;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
#line 881
  return;
}
}
#line 886 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSys.c"
int32_t get_key_n(int32_t get , int32_t min , int32_t max , int32_t def ) 
{ 
  int32_t val ;

  {
#line 889
  val = key_n[get];
#line 891
  if (val < min) {
#line 892
    if (def == -1) {
#line 893
      val = min;
    } else {
#line 895
      val = def;
    }
  } else
#line 897
  if (val > max) {
#line 898
    if (def == -1) {
#line 899
      val = max;
    } else {
#line 901
      val = def;
    }
  }
#line 904
  return (val);
}
}
#line 147 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 106 "/usr/include/x86_64-linux-gnu/sys/select.h"
extern int select(int __nfds , fd_set * __restrict  __readfds , fd_set * __restrict  __writefds ,
                  fd_set * __restrict  __exceptfds , struct timeval * __restrict  __timeout ) ;
#line 244 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
dw_str *dwm_dict_fetch(int num , dw_str *key___6 ) ;
#line 249
dw_str *dwm_dict_nextkey(int num , dw_str *key___6 ) ;
#line 226 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setsockopt)(int __fd ,
                                                                                 int __level ,
                                                                                 int __optname ,
                                                                                 void const   *__optval ,
                                                                                 socklen_t __optlen ) ;
#line 233
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) listen)(int __fd ,
                                                                             int __n ) ;
#line 375 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint16_t ( __attribute__((__leaf__)) ntohs)(uint16_t __netshort )  __attribute__((__const__)) ;
#line 236 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1), __leaf__)) strchr)(char const   *__s ,
                                                                                               int __c )  __attribute__((__pure__)) ;
#line 265 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.h"
int bind_set_dns(ip_addr_T *ip , sockaddr_all_T *dns_do , int type ) ;
#line 290
void process_mararc_params(void) ;
#line 300
void init_b_remote(void) ;
#line 304
int bigloop(void) ;
#line 334
void process_root_upstream(void) ;
#line 39 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
ip_addr_T bind_address[129]  ;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
ip_addr_T upstream_address[129]  ;
#line 43 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
ip_mask_T recursive_acl[129]  ;
#line 46 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int b_local[129]  ;
#line 47 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int *b_remote  ;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
remote_T *rem  ;
#line 56 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int maxprocs  =    32;
#line 57 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int max_tcp_procs  =    8;
#line 59 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int timeout_seconds  =    1;
#line 60 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int timeout_seconds_tcp  =    4;
#line 65 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int dns_port  =    53;
#line 66 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int upstream_port  =    53;
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int handle_overload  =    1;
#line 68 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int handle_noreply  =    1;
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int resurrections  =    1;
#line 70 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int min_bind  =    15000;
#line 71 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int num_ports  =    4096;
#line 72 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int32_t maradns_uid  =    99;
#line 73 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int32_t maradns_gid  =    99;
#line 74 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int32_t max_ttl  =    86400;
#line 75 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int num_retries  =    5;
#line 76 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
dw_hash *blacklist_dict  =    (dw_hash *)0;
#line 105 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void reset_rem(int_fast32_t a ) 
{ 
  int qq ;

  {
#line 106
  if ((rem + a)->socket != -1) {
    {
#line 107
    close((rem + a)->socket);
#line 108
    (rem + a)->socket = -1;
    }
  }
#line 110
  (rem + a)->die = (int64_t )0;
#line 111
  (rem + a)->remote_id = (uint16_t )0;
#line 112
  (rem + a)->retries = num_retries;
#line 113
  if ((unsigned long )(rem + a)->ns != (unsigned long )((dw_str *)0)) {
    {
#line 114
    dw_destroy((rem + a)->ns);
#line 115
    (rem + a)->ns = (dw_str *)0;
    }
  }
#line 117
  (rem + a)->is_upstream = (uint8_t )0;
#line 118
  if ((unsigned long )(rem + a)->query != (unsigned long )((dw_str *)0)) {
    {
#line 119
    zap_inflight((rem + a)->query);
#line 120
    dw_destroy((rem + a)->query);
#line 121
    (rem + a)->query = (dw_str *)0;
    }
  }
#line 123
  (rem + a)->recurse_depth = (uint8_t )0;
#line 124
  (rem + a)->current_ns = (int8_t )-1;
#line 125
  (rem + a)->child_id = -1;
#line 126
  if ((unsigned long )(rem + a)->glueless != (unsigned long )((dw_str *)0)) {
    {
#line 127
    dw_destroy((rem + a)->glueless);
#line 128
    (rem + a)->glueless = (dw_str *)0;
    }
  }
#line 130
  if ((unsigned long )(rem + a)->local != (unsigned long )((local_T **)0)) {
#line 132
    qq = 0;
    {
#line 132
    while (1) {
      while_continue: /* CIL Label */ ;
#line 132
      if (! (qq < (int )(rem + a)->num_locals)) {
#line 132
        goto while_break;
      }
#line 133
      if ((unsigned long )*((rem + a)->local + qq) != (unsigned long )((local_T *)0)) {
        {
#line 134
        dw_destroy((*((rem + a)->local + qq))->orig_query);
#line 135
        dw_destroy((*((rem + a)->local + qq))->action);
#line 136
        free((void *)*((rem + a)->local + qq));
#line 137
        *((rem + a)->local + qq) = (local_T *)0;
        }
      }
#line 132
      qq ++;
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 139
    free((void *)(rem + a)->local);
    }
  }
#line 141
  (rem + a)->local = (local_T **)0;
#line 142
  (rem + a)->num_locals = (uint16_t )0;
#line 143
  return;
}
}
#line 150 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int bind_set_dns(ip_addr_T *ip , sockaddr_all_T *dns_do , int type ) 
{ 
  int sock ;

  {
#line 151
  sock = -1;
#line 153
  if ((unsigned long )ip == (unsigned long )((ip_addr_T *)0)) {
#line 154
    return (-1);
  } else
#line 153
  if ((unsigned long )dns_do == (unsigned long )((sockaddr_all_T *)0)) {
#line 154
    return (-1);
  }
  {
#line 157
  memset((void *)dns_do, 0, sizeof(sockaddr_all_T ));
  }
#line 160
  if ((int )ip->len == 4) {
    {
#line 161
    dns_do->u.v4.sin_family = (sa_family_t )2;
#line 162
    memcpy((void */* __restrict  */)(& dns_do->u.v4.sin_addr.s_addr), (void const   */* __restrict  */)(ip->ip),
           (size_t )ip->len);
#line 163
    dns_do->u.v4.sin_port = htons((uint16_t )dns_port);
#line 164
    sock = socket(2, type, 0);
    }
  } else
#line 166
  if ((int )ip->len == 16) {
    {
#line 167
    dns_do->u.v6.sin6_family = (sa_family_t )10;
#line 168
    memcpy((void */* __restrict  */)(& dns_do->u.v6.sin6_addr), (void const   */* __restrict  */)(ip->ip),
           (size_t )ip->len);
#line 169
    dns_do->u.v6.sin6_port = htons((uint16_t )dns_port);
#line 170
    sock = socket(10, type, 0);
    }
  }
#line 174
  if (sock != -1) {
    {
#line 175
    fcntl(sock, 4, 2048);
    }
  }
#line 178
  return (sock);
}
}
#line 184 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int do_bind(ip_addr_T *ip , int type ) 
{ 
  int on ;
  int sock ;
  sockaddr_all_T dns_do ;
  unsigned int len_inet ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 185
  on = 1;
#line 186
  sock = -1;
#line 188
  len_inet = (unsigned int )sizeof(struct sockaddr_in );
#line 190
  sock = bind_set_dns(ip, & dns_do, type);
  }
#line 191
  if (sock == -1) {
#line 192
    return (-1);
  }
  {
#line 195
  tmp = setsockopt(sock, 1, 2, (void const   *)((char *)(& on)), (socklen_t )sizeof(on));
  }
#line 195
  if (tmp) {
    {
#line 198
    close(sock);
    }
#line 199
    return (-1);
  }
#line 203
  if ((int )ip->len == 16) {
#line 204
    len_inet = (unsigned int )sizeof(struct sockaddr_in6 );
  }
  {
#line 207
  tmp___0 = bind(sock, (struct sockaddr  const  *)((struct sockaddr *)(& dns_do)),
                 len_inet);
  }
#line 207
  if (tmp___0 == -1) {
    {
#line 208
    close(sock);
    }
#line 209
    return (-1);
  }
#line 212
  if (type == 1) {
    {
#line 212
    tmp___1 = listen(sock, 250);
    }
#line 212
    if (tmp___1 == -1) {
      {
#line 213
      close(sock);
      }
#line 214
      return (-1);
    }
  }
#line 217
  return (sock);
}
}
#line 223 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void pop_ip_core(dw_str *list , ip_addr_T *ip , char *c ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
#line 224
  if ((unsigned long )c == (unsigned long )((char *)0)) {
#line 225
    return;
  } else
#line 224
  if ((unsigned long )ip == (unsigned long )((ip_addr_T *)0)) {
#line 225
    return;
  }
  {
#line 227
  ip->len = (uint8_t )0;
#line 228
  tmp___0 = inet_pton(2, (char const   */* __restrict  */)c, (void */* __restrict  */)(ip->ip));
  }
#line 228
  if (tmp___0 > 0) {
#line 229
    ip->len = (uint8_t )4;
  } else {
    {
#line 232
    tmp = inet_pton(10, (char const   */* __restrict  */)c, (void */* __restrict  */)(ip->ip));
    }
#line 232
    if (tmp > 0) {
#line 233
      ip->len = (uint8_t )16;
    }
  }
#line 237
  return;
}
}
#line 241 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void pop_ip(dw_str *list , ip_addr_T *ip ) 
{ 
  char *c ;

  {
  {
#line 242
  c = (char *)0;
#line 244
  c = pop_last_item(list);
#line 245
  pop_ip_core(list, ip, c);
  }
#line 247
  if ((unsigned long )c != (unsigned long )((char *)0)) {
    {
#line 248
    free((void *)c);
#line 249
    c = (char *)0;
    }
  }
#line 251
  return;
}
}
#line 254 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
dw_str *make_ip_str(ip_addr_T *in ) 
{ 
  dw_str *out ;
  int counter ;

  {
#line 255
  out = (dw_str *)0;
#line 256
  counter = 0;
#line 258
  if ((unsigned long )in == (unsigned long )((ip_addr_T *)0)) {
#line 259
    goto catch_make_ip_str;
  }
#line 262
  if ((int )in->len != 4) {
#line 262
    if ((int )in->len != 16) {
#line 263
      goto catch_make_ip_str;
    }
  }
  {
#line 266
  out = dw_create((uint32_t )((int )in->len + 1));
  }
#line 268
  if ((unsigned long )out == (unsigned long )((dw_str *)0)) {
#line 269
    goto catch_make_ip_str;
  }
#line 272
  out->len = (uint32_t )in->len;
#line 274
  counter = 0;
  {
#line 274
  while (1) {
    while_continue: /* CIL Label */ ;
#line 274
    if (! (counter < (int )in->len)) {
#line 274
      goto while_break;
    }
#line 275
    *(out->str + counter) = in->ip[counter];
#line 274
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 278
  return (out);
  catch_make_ip_str: 
#line 281
  if ((unsigned long )out != (unsigned long )((dw_str *)0)) {
    {
#line 282
    dw_destroy(out);
    }
  }
#line 284
  return ((dw_str *)0);
}
}
#line 289 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
dw_hash *make_ip_dict(dw_str *in ) 
{ 
  dw_hash *out ;
  dw_str *key___6 ;
  dw_str *value___6 ;
  int counter ;
  ip_addr_T ip ;

  {
#line 290
  out = (dw_hash *)0;
#line 291
  key___6 = (dw_str *)0;
#line 291
  value___6 = (dw_str *)0;
#line 292
  counter = 0;
#line 295
  if ((unsigned long )in == (unsigned long )((dw_str *)0)) {
#line 296
    return ((dw_hash *)0);
  }
  {
#line 299
  value___6 = dw_create((uint32_t )2);
  }
#line 300
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
#line 301
    return ((dw_hash *)0);
  }
  {
#line 304
  value___6->len = (uint32_t )1;
#line 305
  *(value___6->str) = (uint8_t )'y';
#line 307
  out = dwd_init();
#line 309
  ip.len = (uint8_t )1;
#line 310
  counter = 0;
  }
  {
#line 310
  while (1) {
    while_continue: /* CIL Label */ ;
#line 310
    if (counter < 1000) {
#line 310
      if (! ((int )ip.len != 0)) {
#line 310
        goto while_break;
      }
    } else {
#line 310
      goto while_break;
    }
    {
#line 311
    pop_ip(in, & ip);
    }
#line 312
    if ((int )ip.len != 0) {
      {
#line 313
      key___6 = make_ip_str(& ip);
      }
#line 314
      if ((unsigned long )key___6 != (unsigned long )((dw_str *)0)) {
        {
#line 315
        dwd_add(out, key___6, value___6);
#line 316
        dw_destroy(key___6);
#line 317
        key___6 = (dw_str *)0;
        }
      }
    }
#line 310
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 322
  dw_destroy(value___6);
  }
#line 323
  return (out);
}
}
#line 331 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void pop_ip_mask(dw_str *list , ip_mask_T *ip_mask ) 
{ 
  char *c ;
  char *q ;
  int n ;

  {
  {
#line 332
  c = (char *)0;
#line 333
  q = (char *)0;
#line 336
  c = pop_last_item(list);
  }
#line 337
  if ((unsigned long )c == (unsigned long )((char *)0)) {
#line 338
    goto catch_pop_ip_mask;
  }
  {
#line 341
  q = strchr((char const   *)c, '/');
  }
#line 342
  if ((unsigned long )q == (unsigned long )((char *)0)) {
    {
#line 343
    pop_ip_core(list, (ip_addr_T *)ip_mask, c);
#line 344
    make_netmask((int )ip_mask->len * 8, ip_mask->mask, (int )ip_mask->len);
    }
#line 345
    goto catch_pop_ip_mask;
  } else
#line 342
  if ((int )*q != 47) {
    {
#line 343
    pop_ip_core(list, (ip_addr_T *)ip_mask, c);
#line 344
    make_netmask((int )ip_mask->len * 8, ip_mask->mask, (int )ip_mask->len);
    }
#line 345
    goto catch_pop_ip_mask;
  }
  {
#line 347
  *q = (char)0;
#line 348
  pop_ip_core(list, (ip_addr_T *)ip_mask, c);
#line 349
  *q = (char )'/';
#line 351
  q ++;
  }
#line 352
  if ((int )*q == 0) {
#line 353
    goto catch_pop_ip_mask;
  }
  {
#line 356
  n = atoi((char const   *)q);
  }
#line 357
  if ((int )ip_mask->len != 4) {
#line 357
    if ((int )ip_mask->len != 16) {
#line 358
      goto catch_pop_ip_mask;
    }
  }
#line 360
  if (n < 0) {
#line 361
    n = (int )ip_mask->len * 8;
  } else
#line 360
  if (n > (int )ip_mask->len * 8) {
#line 361
    n = (int )ip_mask->len * 8;
  }
  {
#line 363
  make_netmask(n, ip_mask->mask, (int )ip_mask->len);
  }
  catch_pop_ip_mask: 
#line 366
  if ((unsigned long )c != (unsigned long )((char *)0)) {
    {
#line 367
    free((void *)c);
#line 368
    c = (char *)0;
    }
  }
#line 370
  return;
}
}
#line 374 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void set_ip_list(ip_addr_T *list , dw_str *str ) 
{ 
  int a ;

  {
#line 375
  a = 0;
#line 377
  if ((unsigned long )list == (unsigned long )((ip_addr_T *)0)) {
#line 378
    return;
  } else
#line 377
  if ((unsigned long )str == (unsigned long )((dw_str *)0)) {
#line 378
    return;
  }
  {
#line 382
  while (1) {
    while_continue: /* CIL Label */ ;
#line 382
    if (! (a < 127)) {
#line 382
      goto while_break;
    }
    {
#line 383
    pop_ip(str, list + a);
    }
#line 384
    if ((int )(list + a)->len == 0) {
#line 385
      goto while_break;
    }
#line 387
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 390
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 390
    if (! (a < 128)) {
#line 390
      goto while_break___0;
    }
#line 391
    (list + a)->len = (uint8_t )0;
#line 392
    a ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 394
  return;
}
}
#line 398 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void set_ipmask_list(ip_mask_T *list , dw_str *str ) 
{ 
  int a ;

  {
#line 399
  a = 0;
#line 401
  if ((unsigned long )list == (unsigned long )((ip_mask_T *)0)) {
#line 402
    return;
  } else
#line 401
  if ((unsigned long )str == (unsigned long )((dw_str *)0)) {
#line 402
    return;
  }
  {
#line 406
  while (1) {
    while_continue: /* CIL Label */ ;
#line 406
    if (! (a < 127)) {
#line 406
      goto while_break;
    }
    {
#line 407
    pop_ip_mask(str, list + a);
    }
#line 408
    if ((int )(list + a)->len == 0) {
#line 409
      goto while_break;
    }
#line 411
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 414
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 414
    if (! (a < 128)) {
#line 414
      goto while_break___0;
    }
#line 415
    (list + a)->len = (uint8_t )0;
#line 416
    a ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 418
  return;
}
}
#line 424 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
uint16_t get_from_ip_port(ip_addr_T *from_ip , sockaddr_all_T *client ) 
{ 
  uint16_t from_port ;

  {
#line 425
  from_port = (uint16_t )0;
#line 427
  if ((unsigned long )from_ip == (unsigned long )((ip_addr_T *)0)) {
#line 428
    return ((uint16_t )0);
  } else
#line 427
  if ((unsigned long )client == (unsigned long )((sockaddr_all_T *)0)) {
#line 428
    return ((uint16_t )0);
  }
#line 431
  if ((int )client->u.v4.sin_family == 2) {
    {
#line 432
    from_ip->len = (uint8_t )4;
#line 434
    memcpy((void */* __restrict  */)(from_ip->ip), (void const   */* __restrict  */)(& client->u.v4.sin_addr.s_addr),
           (size_t )4);
#line 436
    from_port = ntohs(client->u.v4.sin_port);
    }
  } else
#line 438
  if ((int )client->u.v4.sin_family == 10) {
    {
#line 439
    from_ip->len = (uint8_t )16;
#line 441
    memcpy((void */* __restrict  */)(from_ip->ip), (void const   */* __restrict  */)(& client->u.v6.sin6_addr),
           (size_t )16);
#line 443
    from_port = ntohs(client->u.v6.sin6_port);
    }
  }
#line 446
  return (from_port);
}
}
#line 452 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int check_ip_acl(ip_addr_T *ip ) 
{ 
  int a ;
  int b ;
  uint8_t m ;

  {
#line 453
  a = 0;
#line 454
  b = 0;
#line 457
  a = 0;
  {
#line 457
  while (1) {
    while_continue: /* CIL Label */ ;
#line 457
    if (! (a < 128)) {
#line 457
      goto while_break;
    }
#line 458
    if ((int )recursive_acl[a].len == 0) {
#line 459
      return (0);
    }
#line 461
    if ((int )ip->len != (int )recursive_acl[a].len) {
#line 462
      goto __Cont;
    }
#line 464
    b = 0;
    {
#line 464
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 464
      if (! (b < (int )ip->len)) {
#line 464
        goto while_break___0;
      }
#line 465
      m = recursive_acl[a].mask[b];
#line 466
      if (((int )recursive_acl[a].ip[b] & (int )m) != ((int )ip->ip[b] & (int )m)) {
#line 467
        goto while_break___0;
      }
#line 464
      b ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 470
    if (b == (int )ip->len) {
#line 471
      return (1);
    }
    __Cont: /* CIL Label */ 
#line 457
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 474
  return (0);
}
}
#line 483 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void process_numeric_mararc_params(void) 
{ 


  {
  {
#line 485
  maxprocs = get_key_n(0, 8, 16384, -1);
#line 486
  max_tcp_procs = get_key_n(15, 4, 1024, -1);
#line 488
  timeout_seconds = get_key_n(1, 1, 300, -1);
#line 489
  timeout_seconds_tcp = get_key_n(16, 1, 300, -1);
#line 494
  dns_port = get_key_n(2, 1, 65535, 53);
#line 495
  upstream_port = get_key_n(3, 1, 65535, 53);
#line 496
  handle_overload = get_key_n(4, 0, 1, 1);
#line 497
  handle_noreply = get_key_n(5, 0, 1, 1);
#line 498
  min_bind = get_key_n(6, 1025, 32767, 15000);
#line 499
  num_ports = get_key_n(7, 256, 32768, 4096);
#line 500
  maradns_uid = get_key_n(10, 10, 65535, 99);
#line 501
  maradns_gid = get_key_n(11, 10, 65535, 99);
#line 502
  resurrections = get_key_n(12, 0, 1, 1);
#line 503
  num_retries = get_key_n(13, 0, 32, 5);
#line 504
  max_ttl = get_key_n(29, 300, 7776000, 86400);
  }
#line 509
  if ((num_ports & (num_ports - 1)) != 0) {
    {
#line 510
    dw_fatal((char *)"num_ports must be a power of 2");
    }
  }
#line 512
  num_ports --;
#line 514
  return;
}
}
#line 517 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int process_root_upstream_servers(int param , int is_upstream , char *bad ) 
{ 
  dw_str *q ;
  dw_str *r ;
  dw_str *s ;
  dw_str *ns_refer ;
  dw_str *check ;
  int a ;
  int out ;

  {
#line 518
  q = (dw_str *)0;
#line 518
  r = (dw_str *)0;
#line 518
  s = (dw_str *)0;
#line 518
  ns_refer = (dw_str *)0;
#line 518
  check = (dw_str *)0;
#line 519
  a = 0;
#line 519
  out = 0;
#line 521
  q = (dw_str *)0;
#line 523
  a = 0;
  {
#line 523
  while (1) {
    while_continue: /* CIL Label */ ;
#line 523
    if (! (a < 20000)) {
#line 523
      goto while_break;
    }
    {
#line 524
    r = dwm_dict_nextkey(param, q);
#line 525
    dw_destroy(q);
    }
#line 526
    if ((unsigned long )r == (unsigned long )((dw_str *)0)) {
#line 527
      goto while_break;
    }
    {
#line 529
    out = 1;
#line 530
    s = dwm_dict_fetch(param, r);
#line 531
    q = dw_dnsname_convert(r);
#line 532
    ns_refer = dwx_ns_convert(s, is_upstream, q);
    }
#line 533
    if ((unsigned long )q == (unsigned long )((dw_str *)0)) {
      {
#line 534
      dw_log_dwstr_str(bad, r, (char *)"\"]", 0);
#line 535
      dw_fatal((char *)"Please fix this line");
      }
    } else
#line 533
    if ((unsigned long )ns_refer == (unsigned long )((dw_str *)0)) {
      {
#line 534
      dw_log_dwstr_str(bad, r, (char *)"\"]", 0);
#line 535
      dw_fatal((char *)"Please fix this line");
      }
    } else
#line 533
    if (ns_refer->len < 4U) {
      {
#line 534
      dw_log_dwstr_str(bad, r, (char *)"\"]", 0);
#line 535
      dw_fatal((char *)"Please fix this line");
      }
    }
    {
#line 537
    dw_put_u16(q, (uint16_t )65395, -1);
#line 541
    check = dwh_get(cache, q, 1, 1);
    }
#line 542
    if ((unsigned long )check != (unsigned long )((dw_str *)0)) {
      {
#line 543
      dw_log_dwstr_str(bad, r, (char *)"\"] (used in both root_servers and upstream_servers)",
                       0);
#line 545
      dw_fatal((char *)"Same entry can not be in both");
      }
    }
    {
#line 548
    dwh_add(cache, q, ns_refer, 1, 2);
#line 549
    dw_destroy(q);
#line 550
    dw_destroy(s);
#line 551
    dw_destroy(ns_refer);
#line 552
    q = dw_substr(r, 0, -1, -1);
#line 553
    dw_destroy(r);
#line 523
    a ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 555
  if (a == 20000) {
    {
#line 556
    dw_fatal((char *)"Too many upstream servers, limit 20,000");
    }
  }
#line 559
  return (out);
}
}
#line 566 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void process_root_upstream(void) 
{ 
  int elements_in_cache ;
  dw_str *s ;
  dw_str *q ;
  dw_str *ns_refer ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 567
  elements_in_cache = 0;
#line 568
  s = (dw_str *)0;
#line 568
  q = (dw_str *)0;
#line 568
  ns_refer = (dw_str *)0;
#line 570
  tmp = process_root_upstream_servers(0, 1, (char *)"Bad dwood3rc line looks like:\nupstream_servers[\"");
#line 570
  elements_in_cache += tmp;
#line 573
  tmp___0 = process_root_upstream_servers(1, 0, (char *)"Bad dwood3rc line looks like:\nroot_servers[\"");
#line 573
  elements_in_cache += tmp___0;
  }
#line 577
  if (elements_in_cache == 0) {
    {
#line 578
    dw_log_3strings((char *)"Using default ICANN root servers:", (char *)" ", (char *)"198.41.0.4,192.228.79.201,192.33.4.12,199.7.91.13,192.203.230.10,192.5.5.241,192.112.36.4,128.63.2.53,192.36.148.17,192.58.128.30,193.0.14.129,199.7.83.42,202.12.27.33        ",
                    1);
#line 580
    s = dw_create((uint32_t )256);
#line 581
    q = dw_create((uint32_t )16);
#line 582
    dw_qrappend((uint8_t *)"198.41.0.4,192.228.79.201,192.33.4.12,199.7.91.13,192.203.230.10,192.5.5.241,192.112.36.4,128.63.2.53,192.36.148.17,192.58.128.30,193.0.14.129,199.7.83.42,202.12.27.33        ",
                s, (char)0);
#line 583
    ns_refer = dwx_ns_convert(s, 0, (dw_str *)0);
#line 584
    dw_put_u8(q, (uint8_t )0, -1);
#line 585
    dw_put_u16(q, (uint16_t )65395, -1);
#line 586
    dwh_add(cache, q, ns_refer, 1, 2);
#line 587
    dw_destroy(q);
#line 588
    dw_destroy(s);
#line 589
    dw_destroy(ns_refer);
    }
  }
#line 591
  return;
}
}
#line 595 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void process_mararc_params(void) 
{ 
  dw_str *bind___0 ;
  dw_str *r_acl ;
  int a ;
  int tmp ;
  void *tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 596
  bind___0 = (dw_str *)0;
#line 596
  r_acl = (dw_str *)0;
#line 599
  bind___0 = get_bind_addrs();
  }
#line 600
  if ((unsigned long )bind___0 == (unsigned long )((dw_str *)0)) {
    {
#line 601
    dw_fatal((char *)"Could not bind");
    }
  }
  {
#line 603
  set_ip_list(bind_address, bind___0);
#line 605
  r_acl = dw_substr(key_s[3], 0, -1, -1);
  }
#line 606
  if ((unsigned long )r_acl == (unsigned long )((dw_str *)0)) {
    {
#line 607
    dw_fatal((char *)"Could not get recursive_acl");
    }
  }
  {
#line 609
  set_ipmask_list(recursive_acl, r_acl);
#line 614
  a = 0;
  }
  {
#line 614
  while (1) {
    while_continue: /* CIL Label */ ;
#line 614
    if (! (a < 128)) {
#line 614
      goto while_break;
    }
#line 615
    if ((int )bind_address[a].len == 0) {
#line 616
      goto while_break;
    }
    {
#line 618
    tmp = check_ip_acl(& bind_address[a]);
    }
#line 618
    if (tmp != 1) {
      {
#line 619
      dw_log_ip((char *)"This IP is not in recursive_acl: ", & bind_address[a], 0);
#line 621
      dw_fatal((char *)"All bind_address values must be in recursive_acl");
      }
    }
#line 614
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 625
  if (128 == a) {
    {
#line 626
    dw_fatal((char *)"Too many bind_address IPs");
    }
  }
  {
#line 630
  process_numeric_mararc_params();
#line 634
  tmp___0 = malloc((unsigned long )(maxprocs + 1) * sizeof(int ));
#line 634
  b_remote = (int *)tmp___0;
#line 635
  tmp___1 = malloc((unsigned long )(maxprocs + 1) * sizeof(remote_T ));
#line 635
  rem = (remote_T *)tmp___1;
  }
#line 638
  if ((unsigned long )b_remote == (unsigned long )((int *)0)) {
    {
#line 639
    dw_fatal((char *)"Could not allocate b_remote!");
    }
  }
#line 641
  if ((unsigned long )rem == (unsigned long )((remote_T *)0)) {
    {
#line 642
    dw_fatal((char *)"Could not allocate rem!");
    }
  }
  {
#line 645
  blacklist_dict = make_ip_dict(key_s[6]);
  }
#line 647
  if ((unsigned long )bind___0 != (unsigned long )((dw_str *)0)) {
    {
#line 648
    dw_destroy(bind___0);
#line 649
    bind___0 = (dw_str *)0;
    }
  }
#line 651
  if ((unsigned long )r_acl != (unsigned long )((dw_str *)0)) {
    {
#line 652
    dw_destroy(r_acl);
#line 653
    r_acl = (dw_str *)0;
    }
  }
#line 655
  return;
}
}
#line 658 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void init_b_remote(void) 
{ 
  int a ;

  {
#line 659
  a = 0;
#line 660
  a = 0;
  {
#line 660
  while (1) {
    while_continue: /* CIL Label */ ;
#line 660
    if (! (a < maxprocs)) {
#line 660
      goto while_break;
    }
    {
#line 661
    *(b_remote + a) = -1;
#line 662
    (rem + a)->socket = -1;
#line 663
    (rem + a)->query = (dw_str *)0;
#line 664
    (rem + a)->glueless = (dw_str *)0;
#line 665
    (rem + a)->local = (local_T **)0;
#line 666
    (rem + a)->ns = (dw_str *)0;
#line 667
    reset_rem((int_fast32_t )a);
#line 660
    a ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 669
  return;
}
}
#line 672 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int find_max(int *list , int max ) 
{ 
  int a ;
  int ret ;

  {
#line 673
  a = 0;
#line 674
  ret = -1;
#line 675
  a = 0;
  {
#line 675
  while (1) {
    while_continue: /* CIL Label */ ;
#line 675
    if (! (a < max)) {
#line 675
      goto while_break;
    }
#line 676
    if (*(list + a) > ret) {
#line 677
      ret = *(list + a);
    }
#line 675
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 680
  return (ret);
}
}
#line 685 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int get_max(void) 
{ 
  int a ;
  int b ;
  int c ;
  int max ;

  {
  {
#line 686
  a = 0;
#line 687
  b = 0;
#line 688
  c = 0;
#line 689
  max = 0;
#line 692
  c = find_max(b_local, 128);
#line 693
  b = find_max(b_remote, maxprocs);
  }
#line 694
  if (c > b) {
#line 695
    max = c;
  } else {
#line 697
    max = b;
  }
#line 701
  a = 0;
  {
#line 701
  while (1) {
    while_continue: /* CIL Label */ ;
#line 701
    if (! (a < 128)) {
#line 701
      goto while_break;
    }
#line 702
    if (tcp_b_local[a] > max) {
#line 703
      max = tcp_b_local[a];
    }
#line 701
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 708
  return (max + 1);
}
}
#line 712 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void set_rx_fd(fd_set *rx_fd ) 
{ 
  int a ;
  int __d0 ;
  int __d1 ;

  {
#line 713
  a = 0;
  {
#line 714
  while (1) {
    while_continue: /* CIL Label */ ;
#line 714
    __asm__  volatile   ("cld; rep; "
                         "stosq": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                         "1" (& rx_fd->__fds_bits[0]): "memory");
#line 714
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
#line 717
  a = 0;
  {
#line 717
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 717
    if (! (a < 128)) {
#line 717
      goto while_break___0;
    }
#line 718
    if (b_local[a] != -1) {
#line 719
      rx_fd->__fds_bits[b_local[a] / (8 * (int )sizeof(__fd_mask ))] |= 1L << b_local[a] % (8 * (int )sizeof(__fd_mask ));
    }
#line 717
    a ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 722
  a = 0;
  {
#line 722
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 722
    if (! (a < maxprocs)) {
#line 722
      goto while_break___1;
    }
#line 723
    if (*(b_remote + a) != -1) {
#line 724
      rx_fd->__fds_bits[*(b_remote + a) / (8 * (int )sizeof(__fd_mask ))] |= 1L << *(b_remote + a) % (8 * (int )sizeof(__fd_mask ));
    }
#line 722
    a ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 729
  if (key_n[17] == 1) {
#line 730
    a = 0;
    {
#line 730
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 730
      if (! (a < 128)) {
#line 730
        goto while_break___2;
      }
#line 731
      if (tcp_b_local[a] != -1) {
#line 732
        rx_fd->__fds_bits[tcp_b_local[a] / (8 * (int )sizeof(__fd_mask ))] |= 1L << tcp_b_local[a] % (8 * (int )sizeof(__fd_mask ));
      }
#line 730
      a ++;
    }
    while_break___2: /* CIL Label */ ;
    }
  }
#line 737
  return;
}
}
#line 740 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int32_t find_free_remote(void) 
{ 
  int32_t a ;

  {
#line 741
  a = 0;
#line 742
  a = 0;
  {
#line 742
  while (1) {
    while_continue: /* CIL Label */ ;
#line 742
    if (! (a < maxprocs)) {
#line 742
      goto while_break;
    }
#line 743
    if ((rem + a)->socket == -1) {
#line 743
      if ((unsigned long )(rem + a)->local == (unsigned long )((local_T **)0)) {
#line 745
        return (a);
      }
    }
#line 742
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 748
  return (-1);
}
}
#line 752 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
dw_str *get_upstream_ns(dw_str *query , int connection_number ) 
{ 
  dw_str *q ;
  dw_str *r ;
  int a ;
  int32_t tmp ;

  {
  {
#line 753
  q = (dw_str *)0;
#line 753
  r = (dw_str *)0;
#line 754
  a = 0;
#line 758
  r = dw_substr(query, 0, -1, -1);
#line 759
  dw_pop_u16(r);
#line 760
  dw_put_u16(r, (uint16_t )65395, -1);
#line 763
  a = 0;
  }
  {
#line 763
  while (1) {
    while_continue: /* CIL Label */ ;
#line 763
    if ((unsigned long )q == (unsigned long )((dw_str *)0)) {
#line 763
      if (! (a < 260)) {
#line 763
        goto while_break;
      }
    } else {
#line 763
      goto while_break;
    }
    {
#line 764
    q = dwh_get(cache, r, 0, 1);
    }
#line 765
    if ((unsigned long )q == (unsigned long )((dw_str *)0)) {
      {
#line 766
      q = dw_dnslabel_chop(r);
#line 767
      dw_destroy(r);
#line 768
      r = (dw_str *)0;
#line 769
      r = dw_substr(q, 0, -1, -1);
#line 770
      dw_destroy(q);
#line 771
      q = (dw_str *)0;
      }
    }
#line 773
    if ((unsigned long )r == (unsigned long )((dw_str *)0)) {
#line 774
      goto while_break;
    }
#line 763
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 778
  dw_destroy(r);
#line 779
  r = (dw_str *)0;
#line 782
  tmp = dw_fetch_u8(q, -1);
  }
#line 782
  if (tmp == 22) {
#line 783
    (rem + connection_number)->is_upstream = (uint8_t )1;
  }
#line 787
  return (q);
}
}
#line 793 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
ip_addr_T get_upstream_ip(dw_str *query , int b ) 
{ 
  ip_addr_T addr ;
  unsigned int tmp ;
  ip_addr_T tmp___0 ;

  {
#line 794
  addr.len = (uint8_t )0;
#line 794
  addr.ip[0] = (uint8_t )0;
#line 794
  addr.ip[1] = (uint8_t )0;
#line 794
  tmp = 2U;
  {
#line 794
  while (1) {
    while_continue: /* CIL Label */ ;
#line 794
    if (tmp >= 17U) {
#line 794
      goto while_break;
    }
#line 794
    addr.ip[tmp] = (unsigned char)0;
#line 794
    tmp ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 794
  addr.glueless = (dw_str *)0;
#line 794
  addr.flags = (uint8_t )0;
#line 796
  if ((unsigned long )(rem + b)->ns == (unsigned long )((dw_str *)0)) {
    {
#line 797
    (rem + b)->ns = get_upstream_ns(query, b);
    }
  }
#line 800
  if ((unsigned long )(rem + b)->ns == (unsigned long )((dw_str *)0)) {
#line 801
    return (addr);
  }
  {
#line 804
  tmp___0 = dwx_ns_getip((rem + b)->ns, rng_seed, b);
  }
#line 804
  return (tmp___0);
}
}
#line 814 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void process_results(int a , fd_set *rx_fd ) 
{ 
  int b ;
  int z ;

  {
#line 815
  b = 0;
#line 815
  z = 0;
  {
#line 818
  while (1) {
    while_continue: /* CIL Label */ ;
#line 818
    if (a > 0) {
#line 818
      if (! (z < 50000)) {
#line 818
        goto while_break;
      }
    } else {
#line 818
      goto while_break;
    }
#line 820
    b = 0;
    {
#line 820
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 820
      if (! (b < 128)) {
#line 820
        goto while_break___0;
      }
#line 821
      if (b_local[b] != -1) {
#line 821
        if ((rx_fd->__fds_bits[b_local[b] / (8 * (int )sizeof(__fd_mask ))] & (1L << b_local[b] % (8 * (int )sizeof(__fd_mask )))) != 0L) {
          {
#line 822
          get_local_udp_packet(b_local[b]);
#line 823
          a --;
          }
#line 823
          if (a <= 0) {
#line 823
            return;
          }
        }
      }
#line 820
      b ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 827
    b = 0;
    {
#line 827
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 827
      if (! (b < maxprocs)) {
#line 827
        goto while_break___1;
      }
#line 828
      if (*(b_remote + b) != -1) {
#line 828
        if ((rx_fd->__fds_bits[*(b_remote + b) / (8 * (int )sizeof(__fd_mask ))] & (1L << *(b_remote + b) % (8 * (int )sizeof(__fd_mask )))) != 0L) {
          {
#line 829
          get_remote_udp_packet(b, *(b_remote + b));
#line 830
          a --;
          }
#line 830
          if (a <= 0) {
#line 830
            return;
          }
        }
      }
#line 827
      b ++;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 834
    b = 0;
    {
#line 834
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 834
      if (! (b < 128)) {
#line 834
        goto while_break___2;
      }
#line 835
      if (tcp_b_local[b] != -1) {
#line 835
        if ((rx_fd->__fds_bits[tcp_b_local[b] / (8 * (int )sizeof(__fd_mask ))] & (1L << tcp_b_local[b] % (8 * (int )sizeof(__fd_mask )))) != 0L) {
          {
#line 837
          local_tcp_accept(tcp_b_local[b]);
#line 838
          a --;
          }
#line 838
          if (a <= 0) {
#line 838
            return;
          }
        }
      }
#line 834
      b ++;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 841
    z ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 843
  return;
}
}
#line 846 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int handle_resurrections(int a ) 
{ 
  dw_str *value___6 ;
  dw_str *packet ;
  int ret ;
  int local_num ;

  {
  {
#line 847
  value___6 = (dw_str *)0;
#line 848
  packet = (dw_str *)0;
#line 849
  ret = 0;
#line 850
  local_num = 0;
#line 852
  value___6 = dwh_get(cache, (rem + a)->query, 1, 1);
  }
#line 853
  if ((unsigned long )value___6 == (unsigned long )((dw_str *)0)) {
#line 854
    goto catch_handle_resurrections;
  }
#line 857
  local_num = 0;
  {
#line 857
  while (1) {
    while_continue: /* CIL Label */ ;
#line 857
    if (! (local_num < (int )(rem + a)->num_locals)) {
#line 857
      goto while_break;
    }
#line 858
    if ((int )(*((rem + a)->local + local_num))->glueless_type != 0) {
#line 859
      goto __Cont;
    }
    {
#line 861
    packet = make_dns_packet((rem + a)->query, value___6, (int32_t )(*((rem + a)->local + local_num))->local_id);
    }
#line 863
    if ((unsigned long )packet == (unsigned long )((dw_str *)0)) {
#line 864
      goto catch_handle_resurrections;
    }
#line 867
    if ((*((rem + a)->local + local_num))->tcp_num == -1) {
      {
#line 868
      forward_remote_reply(packet->str, (size_t )packet->len, rem + a, local_num);
      }
    } else {
      {
#line 871
      tcp_return_reply((*((rem + a)->local + local_num))->tcp_num, (char *)((void *)packet->str),
                       (int )packet->len);
      }
    }
#line 874
    if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
      {
#line 875
      dw_destroy(packet);
#line 876
      packet = (dw_str *)0;
      }
    }
    __Cont: /* CIL Label */ 
#line 857
    local_num ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 880
  ret = 1;
  catch_handle_resurrections: 
#line 883
  if ((unsigned long )value___6 != (unsigned long )((dw_str *)0)) {
    {
#line 884
    dw_destroy(value___6);
#line 885
    value___6 = (dw_str *)0;
    }
  }
#line 887
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 888
    dw_destroy(packet);
#line 889
    packet = (dw_str *)0;
    }
  }
#line 891
  return (ret);
}
}
#line 899 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int handle_expired(int a ) 
{ 
  dw_str *packet ;
  int ret ;
  int t ;
  int local_num ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 900
  packet = (dw_str *)0;
#line 901
  ret = 0;
#line 901
  t = 0;
#line 901
  local_num = 0;
#line 903
  if ((rem + a)->retries > 0) {
    {
#line 905
    ((rem + a)->retries) --;
#line 906
    close((rem + a)->socket);
#line 907
    (rem + a)->socket = -1;
#line 910
    (rem + a)->remote_id = dwr_rng(rng_seed);
    }
#line 911
    if ((int )(rem + a)->is_upstream == 1) {
      {
#line 912
      packet = make_dns_header((int32_t )(rem + a)->remote_id, (int16_t )384, 0, 0,
                               0);
      }
    } else {
      {
#line 914
      packet = make_dns_header((int32_t )(rem + a)->remote_id, (int16_t )128, 0, 0,
                               0);
      }
    }
    {
#line 916
    tmp = dw_append((rem + a)->query, packet);
    }
#line 916
    if (tmp == -1) {
#line 918
      goto catch_handle_expired;
    } else {
      {
#line 916
      tmp___0 = dw_put_u16(packet, (uint16_t )1, -1);
      }
#line 916
      if (tmp___0 == -1) {
#line 918
        goto catch_handle_expired;
      }
    }
    {
#line 920
    dw_log_dwstr_str((char *)"Connection for query ", (rem + a)->query, (char *)" did not respond; trying again",
                     128);
#line 922
    make_remote_connection(a, packet->str, (int )packet->len, (rem + a)->query, -1);
#line 924
    (rem + a)->die = the_time + ((int64_t )timeout_seconds << 8);
#line 925
    ret = 1;
    }
#line 926
    goto catch_handle_expired;
  }
#line 928
  if (resurrections == 1) {
    {
#line 929
    tmp___1 = handle_resurrections(a);
    }
#line 929
    if (tmp___1 == 1) {
#line 930
      goto catch_handle_expired;
    }
  }
#line 933
  local_num = 0;
  {
#line 933
  while (1) {
    while_continue: /* CIL Label */ ;
#line 933
    if (! (local_num < (int )(rem + a)->num_locals)) {
#line 933
      goto while_break;
    }
#line 934
    if (handle_noreply == 1) {
      {
#line 935
      server_fail_noreply(a, local_num);
      }
    } else
#line 936
    if ((*((rem + a)->local + local_num))->tcp_num != -1) {
      {
#line 937
      t = (*((rem + a)->local + local_num))->tcp_num;
#line 939
      close((tcp_pend + t)->local);
#line 940
      (tcp_pend + t)->local = -1;
#line 940
      (tcp_pend + t)->upstream = -1;
      }
#line 940
      if ((unsigned long )(tcp_pend + t)->buffer != (unsigned long )((char *)0)) {
        {
#line 940
        free((void *)(tcp_pend + t)->buffer);
#line 940
        (tcp_pend + t)->buffer = (char *)0;
        }
      }
#line 940
      (tcp_pend + t)->wanted = 0;
#line 940
      (tcp_pend + t)->got = 0;
#line 940
      (tcp_pend + t)->sent = 0;
#line 940
      (tcp_pend + t)->state = 0;
#line 940
      (tcp_pend + t)->die = (int64_t )0;
    }
#line 933
    local_num ++;
  }
  while_break: /* CIL Label */ ;
  }
  catch_handle_expired: 
#line 945
  if ((unsigned long )packet != (unsigned long )((dw_str *)0)) {
    {
#line 946
    dw_destroy(packet);
#line 947
    packet = (dw_str *)0;
    }
  }
#line 949
  return (ret);
}
}
#line 953 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
void kill_expired(void) 
{ 
  int a ;
  int tmp ;

  {
#line 954
  a = 0;
#line 955
  a = 0;
  {
#line 955
  while (1) {
    while_continue: /* CIL Label */ ;
#line 955
    if (! (a < maxprocs)) {
#line 955
      goto while_break;
    }
#line 956
    if ((rem + a)->die > 0L) {
#line 956
      if ((rem + a)->die < the_time) {
        {
#line 957
        tmp = handle_expired(a);
        }
#line 957
        if (tmp == 1) {
#line 958
          goto __Cont;
        }
        {
#line 960
        close((rem + a)->socket);
#line 961
        *(b_remote + a) = -1;
#line 962
        reset_rem((int_fast32_t )a);
        }
      }
    }
    __Cont: /* CIL Label */ 
#line 955
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 965
  return;
}
}
#line 977 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwSocket.c"
int bigloop(void) 
{ 
  int a ;
  int b ;
  int max ;
  fd_set rx_fd ;
  struct timeval timeout ;

  {
#line 978
  a = 0;
#line 978
  b = 0;
#line 979
  max = 0;
  {
#line 983
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 987
    set_time();
#line 988
    max = get_max();
#line 989
    set_rx_fd(& rx_fd);
#line 990
    timeout.tv_sec = (__time_t )0;
#line 991
    timeout.tv_usec = (__suseconds_t )50000;
#line 992
    a = select(max, (fd_set */* __restrict  */)(& rx_fd), (fd_set */* __restrict  */)((void *)0),
               (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& timeout));
    }
#line 995
    if (a > 0) {
      {
#line 996
      process_results(a, & rx_fd);
      }
    }
#line 1004
    b = 0;
    {
#line 1004
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1004
      if (! (b < max_tcp_procs)) {
#line 1004
        goto while_break___0;
      }
      {
#line 1005
      tcp_handle_all(b);
#line 1004
      b ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 1007
    kill_expired();
#line 1008
    kill_tcp_expired();
    }
#line 1011
    if (got_signal != 0) {
      {
#line 1012
      dw_log_number((char *)"Got signal ", got_signal, (char *)" to process...", 1);
#line 1014
      process_signal(got_signal);
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1021
  return (0);
}
}
#line 85 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
dw_str *key_s[8]  ;
#line 86 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
dw_hash *key_d[3]  ;
#line 87 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
int32_t key_n[31]  ;
#line 89 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
char *key_s_names[8]  = 
#line 89
  {      (char *)"bind_address",      (char *)"ipv4_bind_addresses",      (char *)"chroot_dir",      (char *)"recursive_acl", 
        (char *)"random_seed_file",      (char *)"cache_file",      (char *)"ip_blacklist",      (char *)0};
#line 101 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
char *key_d_names[3]  = {      (char *)"upstream_servers",      (char *)"root_servers",      (char *)0};
#line 106 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.h"
char *key_n_names[31]  = 
#line 106
  {      (char *)"maxprocs",      (char *)"timeout_seconds",      (char *)"dns_port",      (char *)"upstream_port", 
        (char *)"handle_overload",      (char *)"handle_noreply",      (char *)"recurse_min_bind_port",      (char *)"recurse_number_ports", 
        (char *)"hash_magic_number",      (char *)"maximum_cache_elements",      (char *)"maradns_uid",      (char *)"maradns_gid", 
        (char *)"resurrections",      (char *)"num_retries",      (char *)"verbose_level",      (char *)"max_tcp_procs", 
        (char *)"timeout_seconds_tcp",      (char *)"tcp_listen",      (char *)"max_ar_chain",      (char *)"ttl_age", 
        (char *)"max_inflights",      (char *)"deliver_all",      (char *)"filter_rfc1918",      (char *)"ns_glueless_type", 
        (char *)"reject_aaaa",      (char *)"reject_mx",      (char *)"truncation_hack",      (char *)"reject_ptr", 
        (char *)"min_ttl_incomplete_cname",      (char *)"max_ttl",      (char *)0};
#line 252
int dwm_parse_file(char *name ) ;
#line 27 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
dwm_fs fsm[53]  ;
#line 28 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char *fsm_desc  =    (char *)"a Hb Y1c Wxb Rxp T;\nb Xb Rxp T;\nc B1c Wd =e [f +g (y\nd Wd =e [f +g\ne We N4h Qi {6w\nf Wf Qn\ng =5e\nh N4h Wk Hb Rxp T;\ni I3m\nk Wk Hb Rxp T;\nm I3m Qk\nn .2o S2p -2p\no Qq\np D2p Qq\nq Wq ]r\nr Wr =s +t\ns Ws Qu\nt =5s\nu I3v\nv I3v Qk\nw }k\nxp T;\ny Qz\nz I7z Qxa\nxa )k\nxb Hb Wxb Y8xb Rxp T;\n";
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_linenum  =    0;
#line 32 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_file_depth  =    0;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char *dwm_set_newstate(char *c , int d , int32_t state ) 
{ 


  {
#line 41
  if ((int )*c < 97) {
#line 42
    return ((char *)0);
  } else
#line 41
  if ((int )*c > 122) {
#line 42
    return ((char *)0);
  }
#line 46
  if ((int )*c == 120) {
#line 47
    c ++;
#line 48
    if ((int )*c < 97) {
#line 49
      return ((char *)0);
    } else
#line 48
    if ((int )*c > 122) {
#line 49
      return ((char *)0);
    }
#line 51
    fsm[state].newstate[d] = (char )(((int )*c - 97) + 26);
  } else {
#line 53
    fsm[state].newstate[d] = (char )((int )*c - 97);
  }
#line 55
  c ++;
#line 56
  return (c);
}
}
#line 66 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char *dwm_set_action(char *c , int max , int d , int32_t state ) 
{ 
  int b ;
  char *tmp ;

  {
#line 67
  b = 0;
#line 68
  if ((int )*c == 59) {
#line 69
    fsm[state].action[d] = (char)10;
#line 70
    fsm[state].newstate[d] = (char)0;
#line 71
    c ++;
#line 72
    max ++;
#line 73
    if (max > 52) {
#line 74
      return ((char *)0);
    }
#line 76
    return (c);
  } else {
#line 78
    b = (int )*c - 48;
#line 79
    if (b < 1) {
#line 80
      return ((char *)0);
    } else
#line 79
    if (b > 9) {
#line 80
      return ((char *)0);
    }
#line 82
    fsm[state].action[d] = (char )b;
  }
#line 84
  c ++;
#line 85
  max ++;
#line 86
  if (max >= 52) {
#line 87
    return ((char *)0);
  }
  {
#line 89
  tmp = dwm_set_newstate(c, d, state);
  }
#line 89
  return (tmp);
}
}
#line 94 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char dwm_pattern_process(int b ) 
{ 


  {
#line 96
  if (b == 35) {
#line 97
    return ((char)0);
  } else
#line 96
  if (b == 34) {
#line 97
    return ((char)0);
  }
#line 100
  if (b == 72) {
#line 101
    b = '#';
  }
#line 105
  if (b == 81) {
#line 106
    b = '\"';
  }
#line 109
  if (b >= 65) {
#line 109
    if (b <= 90) {
#line 110
      b -= 64;
    }
  }
#line 112
  return ((char )b);
}
}
#line 116 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char *dwm_set_fsm(int32_t state , char *c , int max ) 
{ 
  int b ;
  int d ;

  {
#line 117
  b = 0;
#line 117
  d = 0;
  {
#line 119
  while (1) {
    while_continue: /* CIL Label */ ;
#line 119
    if (! (max < 52)) {
#line 119
      goto while_break;
    }
#line 122
    b = (int )*c;
#line 123
    if (b < 33) {
#line 124
      return ((char *)0);
    } else
#line 123
    if (b > 126) {
#line 124
      return ((char *)0);
    }
    {
#line 126
    fsm[state].pattern[d] = dwm_pattern_process(b);
#line 129
    c ++;
#line 130
    max ++;
    }
#line 131
    if ((int )*c >= 97) {
#line 131
      if ((int )*c <= 122) {
        {
#line 132
        fsm[state].action[d] = (char)0;
#line 133
        c = dwm_set_newstate(c, d, state);
        }
      } else {
        {
#line 135
        c = dwm_set_action(c, max, d, state);
        }
      }
    } else {
      {
#line 135
      c = dwm_set_action(c, max, d, state);
      }
    }
#line 139
    if ((unsigned long )c == (unsigned long )((char *)0)) {
#line 140
      return ((char *)0);
    }
    {
#line 144
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 144
      if (! ((int )*c == 32)) {
#line 144
        goto while_break___0;
      }
#line 145
      c ++;
#line 146
      max ++;
#line 147
      if (max >= 52) {
#line 148
        return ((char *)0);
      }
    }
    while_break___0: /* CIL Label */ ;
    }
#line 152
    if ((int )*c == 13) {
#line 153
      return (c);
    } else
#line 152
    if ((int )*c == 10) {
#line 153
      return (c);
    }
#line 155
    d ++;
#line 156
    if (d >= 7) {
#line 157
      return ((char *)0);
    }
#line 119
    max ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 160
  return ((char *)0);
}
}
#line 164 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
char *dwm_tokenize_line(char *c ) 
{ 
  int b ;
  int max ;

  {
#line 165
  b = 0;
#line 166
  max = 0;
#line 169
  if ((int )*c < 97) {
#line 170
    return ((char *)0);
  } else
#line 169
  if ((int )*c > 122) {
#line 170
    return ((char *)0);
  }
#line 174
  if ((int )*c == 120) {
#line 175
    c ++;
#line 176
    max ++;
#line 177
    if ((int )*c < 97) {
#line 178
      return ((char *)0);
    } else
#line 177
    if ((int )*c > 122) {
#line 178
      return ((char *)0);
    }
#line 180
    b = ((int )*c - 97) + 26;
  } else {
#line 182
    b = (int )*c - 97;
  }
#line 184
  if (b < 0) {
#line 185
    return ((char *)0);
  } else
#line 184
  if (b > 51) {
#line 185
    return ((char *)0);
  }
#line 188
  c ++;
#line 189
  if ((int )*c != 32) {
#line 190
    return ((char *)0);
  }
  {
#line 192
  while (1) {
    while_continue: /* CIL Label */ ;
#line 192
    if ((int )*c == 32) {
#line 192
      if (! (max < 52)) {
#line 192
        goto while_break;
      }
    } else {
#line 192
      goto while_break;
    }
#line 193
    c ++;
#line 194
    max ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 196
  if (max >= 52) {
#line 197
    return ((char *)0);
  }
  {
#line 201
  c = dwm_set_fsm(b, c, max);
  }
#line 202
  if ((unsigned long )c == (unsigned long )((char *)0)) {
#line 203
    return ((char *)0);
  }
#line 205
  if ((int )*c != 13) {
#line 205
    if ((int )*c != 10) {
#line 206
      return ((char *)0);
    }
  }
#line 208
  c ++;
#line 209
  return (c);
}
}
#line 214 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_init_fsm(void) 
{ 
  char *c ;
  int a ;
  int b ;

  {
#line 215
  c = (char *)0;
#line 216
  a = 0;
#line 217
  b = 0;
#line 220
  a = 0;
  {
#line 220
  while (1) {
    while_continue: /* CIL Label */ ;
#line 220
    if (! (a < 52)) {
#line 220
      goto while_break;
    }
#line 221
    b = 0;
    {
#line 221
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 221
      if (! (b < 8)) {
#line 221
        goto while_break___0;
      }
#line 222
      fsm[a].pattern[b] = (char)0;
#line 223
      fsm[a].action[b] = (char)0;
#line 224
      fsm[a].newstate[b] = (char)0;
#line 221
      b ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 220
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 229
  c = fsm_desc;
#line 230
  b = 0;
#line 231
  a = 0;
  {
#line 231
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 231
    if (! (a < 52)) {
#line 231
      goto while_break___1;
    }
    {
#line 232
    c = dwm_tokenize_line(c);
    }
#line 234
    if ((unsigned long )c == (unsigned long )((char *)0)) {
#line 235
      return;
    }
#line 238
    if ((int )*c == 0) {
#line 239
      return;
    }
#line 231
    a ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 242
  return;
}
}
#line 245 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_fatal(char *why ) 
{ 


  {
  {
#line 246
  dw_alog_number((char *)"Fatal error in dwood3rc file on line ", dwm_linenum, why);
#line 248
  exit(1);
  }
}
}
#line 253 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_char_class(int32_t in , int cclass ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;

  {
  {
#line 259
  if (cclass == 1) {
#line 259
    goto case_1;
  }
#line 262
  if (cclass == 2) {
#line 262
    goto case_2;
  }
#line 265
  if (cclass == 4) {
#line 265
    goto case_4;
  }
#line 268
  if (cclass == 9) {
#line 268
    goto case_9;
  }
#line 271
  if (cclass == 14) {
#line 271
    goto case_14;
  }
#line 274
  if (cclass == 18) {
#line 274
    goto case_18;
  }
#line 277
  if (cclass == 19) {
#line 277
    goto case_19;
  }
#line 280
  if (cclass == 20) {
#line 280
    goto case_20;
  }
#line 283
  if (cclass == 23) {
#line 283
    goto case_23;
  }
#line 286
  if (cclass == 24) {
#line 286
    goto case_24;
  }
#line 289
  if (cclass == 25) {
#line 289
    goto case_25;
  }
#line 292
  goto switch_default;
  case_1: /* CIL Label */ 
#line 260
  if (in >= 97) {
#line 260
    if (in <= 122) {
#line 260
      tmp = 1;
    } else {
#line 260
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 260
  if (in >= 65) {
#line 260
    if (in <= 90) {
#line 260
      tmp = 1;
    } else {
#line 260
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 260
  if (in == 95) {
#line 260
    tmp = 1;
  } else {
#line 260
    tmp = -1;
  }
#line 260
  return (tmp);
  case_2: /* CIL Label */ 
#line 263
  if (in >= 97) {
#line 263
    if (in <= 122) {
#line 263
      tmp___0 = 1;
    } else {
#line 263
      goto _L___3;
    }
  } else
  _L___3: /* CIL Label */ 
#line 263
  if (in >= 65) {
#line 263
    if (in <= 90) {
#line 263
      tmp___0 = 1;
    } else {
#line 263
      goto _L___2;
    }
  } else
  _L___2: /* CIL Label */ 
#line 263
  if (in >= 48) {
#line 263
    if (in <= 57) {
#line 263
      tmp___0 = 1;
    } else {
#line 263
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 263
  if (in == 95) {
#line 263
    tmp___0 = 1;
  } else {
#line 263
    tmp___0 = -1;
  }
#line 263
  return (tmp___0);
  case_4: /* CIL Label */ 
#line 266
  if (in >= 97) {
#line 266
    if (in <= 122) {
#line 266
      tmp___1 = 1;
    } else {
#line 266
      goto _L___6;
    }
  } else
  _L___6: /* CIL Label */ 
#line 266
  if (in >= 65) {
#line 266
    if (in <= 90) {
#line 266
      tmp___1 = 1;
    } else {
#line 266
      goto _L___5;
    }
  } else
  _L___5: /* CIL Label */ 
#line 266
  if (in >= 48) {
#line 266
    if (in <= 57) {
#line 266
      tmp___1 = 1;
    } else {
#line 266
      goto _L___4;
    }
  } else
  _L___4: /* CIL Label */ 
#line 266
  if (in == 45) {
#line 266
    tmp___1 = 1;
  } else
#line 266
  if (in == 46) {
#line 266
    tmp___1 = 1;
  } else
#line 266
  if (in == 95) {
#line 266
    tmp___1 = 1;
  } else {
#line 266
    tmp___1 = -1;
  }
#line 266
  return (tmp___1);
  case_9: /* CIL Label */ 
#line 269
  if (in >= 32) {
#line 269
    if (in <= 126) {
#line 269
      if (in != 35) {
#line 269
        if (in != 34) {
#line 269
          tmp___2 = 1;
        } else {
#line 269
          tmp___2 = -1;
        }
      } else {
#line 269
        tmp___2 = -1;
      }
    } else {
#line 269
      tmp___2 = -1;
    }
  } else {
#line 269
    tmp___2 = -1;
  }
#line 269
  return (tmp___2);
  case_14: /* CIL Label */ 
#line 272
  if (in >= 48) {
#line 272
    if (in <= 57) {
#line 272
      tmp___3 = 1;
    } else {
#line 272
      tmp___3 = -1;
    }
  } else {
#line 272
    tmp___3 = -1;
  }
#line 272
  return (tmp___3);
  case_18: /* CIL Label */ 
#line 275
  if (in == 13) {
#line 275
    tmp___4 = 1;
  } else {
#line 275
    tmp___4 = -1;
  }
#line 275
  return (tmp___4);
  case_19: /* CIL Label */ 
#line 278
  if (in >= 97) {
#line 278
    if (in <= 122) {
#line 278
      tmp___5 = 1;
    } else {
#line 278
      goto _L___8;
    }
  } else
  _L___8: /* CIL Label */ 
#line 278
  if (in >= 65) {
#line 278
    if (in <= 90) {
#line 278
      tmp___5 = 1;
    } else {
#line 278
      goto _L___7;
    }
  } else
  _L___7: /* CIL Label */ 
#line 278
  if (in >= 48) {
#line 278
    if (in <= 57) {
#line 278
      tmp___5 = 1;
    } else {
#line 278
      tmp___5 = -1;
    }
  } else {
#line 278
    tmp___5 = -1;
  }
#line 278
  return (tmp___5);
  case_20: /* CIL Label */ 
#line 281
  if (in == 10) {
#line 281
    tmp___6 = 1;
  } else {
#line 281
    tmp___6 = -1;
  }
#line 281
  return (tmp___6);
  case_23: /* CIL Label */ 
#line 284
  if (in == 32) {
#line 284
    tmp___7 = 1;
  } else
#line 284
  if (in == 9) {
#line 284
    tmp___7 = 1;
  } else {
#line 284
    tmp___7 = -1;
  }
#line 284
  return (tmp___7);
  case_24: /* CIL Label */ 
#line 287
  if (in >= 32) {
#line 287
    if (in <= 126) {
#line 287
      tmp___8 = 1;
    } else {
#line 287
      goto _L___9;
    }
  } else
  _L___9: /* CIL Label */ 
#line 287
  if (in == 9) {
#line 287
    tmp___8 = 1;
  } else
#line 287
  if (in > 127) {
#line 287
    tmp___8 = 1;
  } else {
#line 287
    tmp___8 = -1;
  }
#line 287
  return (tmp___8);
  case_25: /* CIL Label */ 
#line 290
  if (in >= 97) {
#line 290
    if (in <= 122) {
#line 290
      tmp___9 = 1;
    } else {
#line 290
      goto _L___10;
    }
  } else
  _L___10: /* CIL Label */ 
#line 290
  if (in >= 65) {
#line 290
    if (in <= 90) {
#line 290
      tmp___9 = 1;
    } else {
#line 290
      tmp___9 = -1;
    }
  } else {
#line 290
    tmp___9 = -1;
  }
#line 290
  return (tmp___9);
  switch_default: /* CIL Label */ 
#line 293
  return (-1);
  switch_break: /* CIL Label */ ;
  }
}
}
#line 301 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int32_t dwm_process_character(int32_t in , int32_t state ) 
{ 
  uint16_t action ;
  uint16_t newstate ;
  int32_t match ;
  int a ;
  int b ;

  {
#line 302
  action = (uint16_t )0;
#line 303
  newstate = (uint16_t )0;
#line 304
  match = -1;
#line 305
  a = 0;
#line 305
  b = 0;
#line 308
  if (state >= 52) {
#line 309
    return (-1);
  }
#line 312
  if ((int )fsm[state].pattern[0] == 0) {
#line 313
    return (-1);
  }
#line 316
  a = 0;
  {
#line 316
  while (1) {
    while_continue: /* CIL Label */ ;
#line 316
    if (a < 8) {
#line 316
      if (! ((int )fsm[state].pattern[a] != 0)) {
#line 316
        goto while_break;
      }
    } else {
#line 316
      goto while_break;
    }
#line 317
    b = (int )fsm[state].pattern[a];
#line 318
    if (b == 0) {
#line 319
      return (-1);
    } else
#line 322
    if (b < 32) {
      {
#line 323
      match = dwm_char_class(in, b);
      }
    } else
#line 328
    if (in == b) {
#line 329
      match = 1;
    } else {
#line 331
      match = -1;
    }
#line 334
    if (match == 1) {
#line 335
      action = (uint16_t )fsm[state].action[a];
#line 336
      newstate = (uint16_t )fsm[state].newstate[a];
#line 337
      goto while_break;
    }
#line 316
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 341
  if ((int )fsm[state].pattern[a] == 0) {
#line 342
    return (-1);
  }
#line 345
  if ((int )newstate >= 52) {
#line 346
    return (-1);
  } else
#line 345
  if ((int )action > 4096) {
#line 346
    return (-1);
  }
#line 349
  return (((int )action << 16) | (int )newstate);
}
}
#line 355 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_dict_init(void) 
{ 
  int a ;

  {
#line 357
  a = 0;
  {
#line 357
  while (1) {
    while_continue: /* CIL Label */ ;
#line 357
    if (! (a < 2)) {
#line 357
      goto while_break;
    }
#line 358
    key_d[a] = (dw_hash *)0;
#line 357
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 360
  return;
}
}
#line 363 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_init_mararc(void) 
{ 
  int a ;

  {
#line 364
  a = 0;
#line 365
  a = 0;
  {
#line 365
  while (1) {
    while_continue: /* CIL Label */ ;
#line 365
    if (! (a < 7)) {
#line 365
      goto while_break;
    }
#line 366
    key_s[a] = (dw_str *)0;
#line 365
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 368
  dwm_dict_init();
#line 370
  key_n[0] = 32;
#line 372
  key_n[1] = 1;
#line 376
  key_n[2] = 53;
#line 377
  key_n[3] = 53;
#line 378
  key_n[4] = 1;
#line 379
  key_n[5] = 1;
#line 380
  key_n[6] = 15000;
#line 381
  key_n[7] = 4096;
#line 382
  key_n[8] = 1;
#line 383
  key_n[9] = 1024;
#line 384
  key_n[10] = 99;
#line 385
  key_n[11] = 99;
#line 386
  key_n[12] = 1;
#line 387
  key_n[13] = 5;
#line 388
  key_n[14] = 3;
#line 389
  key_n[15] = 8;
#line 390
  key_n[16] = 4;
#line 391
  key_n[17] = 0;
#line 392
  key_n[18] = 1;
#line 393
  key_n[19] = 1;
#line 394
  key_n[20] = 8;
#line 395
  key_n[21] = 1;
#line 396
  key_n[22] = 1;
#line 397
  key_n[23] = 1;
#line 398
  key_n[24] = 0;
#line 399
  key_n[25] = 1;
#line 400
  key_n[26] = 1;
#line 401
  key_n[27] = 0;
#line 402
  key_n[28] = 3600;
#line 403
  key_n[29] = 86400;
  }
#line 404
  return;
}
}
#line 408 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int32_t dwm_grep_params(dw_str *seek , char **list , int max ) 
{ 
  int e ;
  dw_str *look ;
  int ret ;
  int tmp ;

  {
#line 409
  e = 0;
#line 410
  look = (dw_str *)0;
#line 411
  ret = 0;
#line 413
  if ((unsigned long )seek == (unsigned long )((dw_str *)0)) {
#line 414
    ret = -1;
#line 415
    goto catch_dwm_grep_params;
  } else
#line 413
  if ((unsigned long )list == (unsigned long )((char **)0)) {
#line 414
    ret = -1;
#line 415
    goto catch_dwm_grep_params;
  } else
#line 413
  if (max < 1) {
#line 414
    ret = -1;
#line 415
    goto catch_dwm_grep_params;
  }
#line 418
  e = 0;
  {
#line 418
  while (1) {
    while_continue: /* CIL Label */ ;
#line 418
    if (! (e < max)) {
#line 418
      goto while_break;
    }
#line 419
    if ((unsigned long )*(list + e) == (unsigned long )((char *)0)) {
#line 420
      ret = -1;
#line 421
      goto catch_dwm_grep_params;
    }
    {
#line 423
    look = dw_create((uint32_t )64);
#line 424
    dw_qrappend((uint8_t *)*(list + e), look, (char)0);
#line 425
    tmp = dw_issame(seek, look);
    }
#line 425
    if (tmp == 1) {
#line 426
      ret = e;
#line 427
      goto catch_dwm_grep_params;
    }
#line 429
    if ((unsigned long )look != (unsigned long )((dw_str *)0)) {
      {
#line 430
      dw_destroy(look);
#line 431
      look = (dw_str *)0;
      }
    }
#line 418
    e ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 435
  ret = -1;
  catch_dwm_grep_params: 
#line 438
  if ((unsigned long )look != (unsigned long )((dw_str *)0)) {
    {
#line 439
    dw_destroy(look);
#line 440
    look = (dw_str *)0;
    }
  }
#line 442
  return (ret);
}
}
#line 446 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_execfile(dw_str *execfile , dw_str *fname ) 
{ 
  char *name ;
  char *a ;
  dw_str *cmp ;
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  uint8_t *tmp___2 ;

  {
  {
#line 447
  name = (char *)0;
#line 447
  a = (char *)0;
#line 448
  cmp = (dw_str *)0;
#line 449
  counter = 0;
#line 451
  cmp = dw_create((uint32_t )10);
  }
#line 452
  if ((unsigned long )cmp == (unsigned long )((dw_str *)0)) {
#line 453
    return;
  }
  {
#line 455
  tmp = dw_cstr_append((uint8_t *)"execfile", 8, cmp);
  }
#line 455
  if (tmp == -1) {
    {
#line 456
    dw_destroy(cmp);
    }
#line 457
    return;
  }
  {
#line 459
  tmp___0 = dw_issame(cmp, execfile);
  }
#line 459
  if (tmp___0 != 1) {
    {
#line 460
    dwm_fatal((char *)"Should have execfile here");
#line 461
    dw_destroy(cmp);
    }
#line 462
    return;
  }
  {
#line 464
  dw_destroy(cmp);
#line 467
  tmp___1 = chdir("/etc/maradns/deadwood/execfile/");
  }
#line 467
  if (tmp___1 != 0) {
    {
#line 468
    dwm_fatal((char *)"Could not enter execfile directory");
    }
#line 469
    return;
  }
  {
#line 473
  tmp___2 = dw_to_cstr(fname);
#line 473
  name = (char *)tmp___2;
  }
#line 474
  if ((unsigned long )name == (unsigned long )((char *)0)) {
#line 475
    return;
  }
#line 478
  a = name;
#line 481
  if ((int )*a == 47) {
#line 482
    *a = (char )'_';
  }
#line 484
  counter = 0;
  {
#line 484
  while (1) {
    while_continue: /* CIL Label */ ;
#line 484
    if (! (counter < 200)) {
#line 484
      goto while_break;
    }
#line 485
    if ((int )*a == 0) {
#line 486
      goto while_break;
    }
#line 488
    if ((int )*a < 97) {
#line 488
      goto _L;
    } else
#line 488
    if ((int )*a > 122) {
      _L: /* CIL Label */ 
#line 488
      if ((int )*a != 95) {
#line 488
        if ((int )*a != 47) {
#line 489
          *a = (char )'_';
        }
      }
    }
#line 491
    a ++;
#line 484
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 494
  dwm_parse_file(name);
#line 496
  free((void *)name);
  }
#line 497
  return;
}
}
#line 513 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_set_todo(dw_str **actions ) 
{ 


  {
#line 514
  if ((unsigned long )*(actions + 1) == (unsigned long )((dw_str *)0)) {
#line 515
    return (0);
  }
#line 517
  if ((unsigned long )*(actions + 6) != (unsigned long )((dw_str *)0)) {
#line 517
    if ((unsigned long )*(actions + 1) != (unsigned long )((dw_str *)0)) {
#line 517
      if ((unsigned long )*(actions + 2) == (unsigned long )((dw_str *)0)) {
#line 519
        return (6);
      }
    }
  }
#line 521
  if ((unsigned long )*(actions + 7) != (unsigned long )((dw_str *)0)) {
    {
#line 522
    dwm_execfile(*(actions + 1), *(actions + 7));
    }
#line 523
    return (0);
  }
#line 525
  if ((unsigned long )*(actions + 3) == (unsigned long )((dw_str *)0)) {
#line 526
    if ((unsigned long )*(actions + 4) == (unsigned long )((dw_str *)0)) {
#line 527
      return (-1);
    } else
#line 528
    if ((unsigned long )*(actions + 2) != (unsigned long )((dw_str *)0)) {
#line 529
      return (-1);
    } else
#line 530
    if ((unsigned long )*(actions + 5) != (unsigned long )((dw_str *)0)) {
#line 531
      return (-1);
    } else {
#line 533
      return (5);
    }
  }
#line 536
  if ((unsigned long )*(actions + 2) != (unsigned long )((dw_str *)0)) {
#line 537
    if ((unsigned long )*(actions + 6) != (unsigned long )((dw_str *)0)) {
#line 538
      return (0);
    }
#line 540
    if ((unsigned long )*(actions + 5) != (unsigned long )((dw_str *)0)) {
#line 541
      return (4);
    }
#line 543
    return (3);
  }
#line 545
  if ((unsigned long )*(actions + 5) != (unsigned long )((dw_str *)0)) {
#line 546
    return (2);
  }
#line 548
  return (1);
}
}
#line 562 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_dict_add(int num , dw_str *key___6 , dw_str *value___6 , int todo ) 
{ 
  dw_str *temp ;
  dw_str *check ;

  {
#line 563
  temp = (dw_str *)0;
#line 564
  check = (dw_str *)0;
#line 566
  if (num >= 2) {
    {
#line 567
    dwm_fatal((char *)"Unknown dictionary variable");
    }
  } else
#line 566
  if (num < 0) {
    {
#line 567
    dwm_fatal((char *)"Unknown dictionary variable");
    }
  }
#line 570
  if (todo == 6) {
#line 570
    if ((unsigned long )key___6 != (unsigned long )((dw_str *)0)) {
      {
#line 571
      dwm_fatal((char *)"Illegal dictionary initialization");
      }
    } else
#line 570
    if ((unsigned long )value___6 != (unsigned long )((dw_str *)0)) {
      {
#line 571
      dwm_fatal((char *)"Illegal dictionary initialization");
      }
    }
  }
#line 575
  if ((unsigned long )key_d[num] == (unsigned long )((dw_hash *)0)) {
#line 575
    if (todo == 6) {
      {
#line 576
      key_d[num] = dwd_init();
      }
#line 577
      return;
    } else {
#line 575
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 579
  if ((unsigned long )key_d[num] != (unsigned long )((dw_hash *)0)) {
#line 579
    if (todo == 6) {
      {
#line 580
      dwm_fatal((char *)"Dictionary variable already initialized");
      }
    } else {
#line 579
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 582
  if ((unsigned long )key_d[num] == (unsigned long )((dw_hash *)0)) {
    {
#line 583
    dwm_fatal((char *)"Uninitialized dictionary variable");
    }
  }
#line 586
  if (todo != 4) {
    {
#line 588
    check = dwd_fetch(key_d[num], key___6);
    }
#line 589
    if ((unsigned long )check != (unsigned long )((dw_str *)0)) {
      {
#line 590
      dw_log_dwstr_str((char *)"Warning: Dictionary element \"", key___6, (char *)"\" defined more than once",
                       0);
#line 592
      dw_destroy(check);
      }
    }
    {
#line 600
    key_d[num] = dwd_add(key_d[num], key___6, value___6);
    }
#line 601
    return;
  }
  {
#line 605
  temp = dwd_fetch(key_d[num], key___6);
  }
#line 606
  if ((unsigned long )temp == (unsigned long )((dw_str *)0)) {
    {
#line 607
    dwm_fatal((char *)"Appending unset dictionary index");
    }
  }
  {
#line 610
  dw_append(value___6, temp);
#line 612
  dwd_add(key_d[num], key___6, temp);
#line 614
  dw_destroy(temp);
  }
#line 616
  return;
}
}
#line 621 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
dw_str *dwm_dict_fetch(int num , dw_str *key___6 ) 
{ 
  dw_str *tmp ;

  {
#line 622
  if (num >= 2) {
#line 623
    return ((dw_str *)0);
  }
  {
#line 626
  tmp = dwd_fetch(key_d[num], key___6);
  }
#line 626
  return (tmp);
}
}
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
dw_str *dwm_dict_nextkey(int num , dw_str *key___6 ) 
{ 
  dw_str *tmp ;

  {
#line 634
  if (num >= 2) {
#line 635
    return ((dw_str *)0);
  }
  {
#line 637
  tmp = dwd_nextkey(key_d[num], key___6);
  }
#line 637
  return (tmp);
}
}
#line 641 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_set_keys(dw_str **actions ) 
{ 
  int todo ;
  int num ;
  dw_str **list ;
  int32_t val ;

  {
  {
#line 642
  todo = 0;
#line 642
  num = 0;
#line 643
  list = (dw_str **)0;
#line 645
  todo = dwm_set_todo(actions);
  }
#line 646
  if (todo == 0) {
#line 647
    return;
  } else
#line 648
  if (todo == -1) {
    {
#line 649
    dwm_fatal((char *)"Bad deadwoodrc action");
    }
  }
#line 652
  if (todo == 1) {
    {
#line 653
    num = dwm_grep_params(*(actions + 1), key_s_names, 7);
#line 654
    list = key_s;
    }
  } else
#line 652
  if (todo == 2) {
    {
#line 653
    num = dwm_grep_params(*(actions + 1), key_s_names, 7);
#line 654
    list = key_s;
    }
  } else
#line 655
  if (todo == 3) {
#line 655
    goto _L;
  } else
#line 655
  if (todo == 4) {
#line 655
    goto _L;
  } else
#line 655
  if (todo == 6) {
    _L: /* CIL Label */ 
    {
#line 656
    num = dwm_grep_params(*(actions + 1), key_d_names, 2);
    }
#line 657
    if (num < 0) {
      {
#line 658
      dwm_fatal((char *)"Unknown dwood3rc dictionary parameter");
      }
    }
    {
#line 660
    dwm_dict_add(num, *(actions + 2), *(actions + 3), todo);
    }
#line 661
    return;
  } else
#line 662
  if (todo == 5) {
    {
#line 664
    num = dwm_grep_params(*(actions + 1), key_n_names, 30);
#line 665
    val = dw_atoi(*(actions + 4), 0, 10);
    }
#line 666
    if (val == -1) {
      {
#line 667
      dwm_fatal((char *)"Invalid numeric value");
      }
    }
#line 669
    if (num < 0) {
      {
#line 670
      dwm_fatal((char *)"Unknown dwood3rc numeric parameter");
      }
    }
#line 672
    key_n[num] = val;
#line 673
    return;
  } else {
#line 675
    return;
  }
#line 678
  if ((unsigned long )list == (unsigned long )((dw_str **)0)) {
    {
#line 679
    dwm_fatal((char *)"Unknown dwood3rc action");
    }
  }
#line 681
  if (num < 0) {
    {
#line 682
    dwm_fatal((char *)"Unknown dwood3rc string parameter");
    }
  }
#line 685
  if ((unsigned long )*(list + num) == (unsigned long )((dw_str *)0)) {
#line 685
    if ((todo & 1) == 0) {
      {
#line 686
      dwm_fatal((char *)"Appending to unset string parameter");
      }
    } else {
#line 685
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 687
  if ((unsigned long )*(list + num) != (unsigned long )((dw_str *)0)) {
#line 687
    if ((todo & 1) == 0) {
      {
#line 688
      dw_append(*(actions + 3), *(list + num));
      }
#line 689
      return;
    } else {
#line 687
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 690
  if ((unsigned long )*(list + num) != (unsigned long )((dw_str *)0)) {
    {
#line 691
    dwm_fatal((char *)"Deadwoodrc parameter set twice");
    }
  }
  {
#line 694
  *(list + num) = dw_substr(*(actions + 3), 0, -1, -1);
  }
#line 695
  return;
}
}
#line 698 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
void dwm_do_action(int32_t ch , int32_t action , dw_str **actions ) 
{ 


  {
#line 699
  if ((unsigned long )*(actions + action) == (unsigned long )((dw_str *)0)) {
    {
#line 703
    *(actions + action) = dw_create((uint32_t )384);
    }
  }
  {
#line 705
  dw_addchar((uint8_t )ch, *(actions + action));
  }
#line 706
  return;
}
}
#line 709 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_parse_line(FILE *look ) 
{ 
  dw_str *actions[11] ;
  int a ;
  int32_t action ;
  int32_t state ;
  int32_t mix ;
  int32_t ch ;
  int32_t last ;
  int ret ;
  int tmp ;
  int tmp___0 ;

  {
#line 711
  a = 0;
#line 712
  action = 0;
#line 712
  state = 0;
#line 712
  mix = 0;
#line 712
  ch = 0;
#line 712
  last = 0;
#line 713
  ret = 0;
#line 715
  a = 0;
  {
#line 715
  while (1) {
    while_continue: /* CIL Label */ ;
#line 715
    if (! (a < 11)) {
#line 715
      goto while_break;
    }
#line 716
    actions[a] = (dw_str *)0;
#line 715
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 719
  ch = fgetc(look);
#line 720
  tmp = feof(look);
  }
#line 720
  if (tmp) {
#line 721
    ret = 1;
#line 722
    goto catch_dwm_parse_line;
  }
  {
#line 725
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 725
    if (! (action != 10)) {
#line 725
      goto while_break___0;
    }
    {
#line 726
    mix = dwm_process_character(ch, state);
    }
#line 727
    if (mix < 0) {
#line 728
      ret = -1;
#line 729
      goto catch_dwm_parse_line;
    }
#line 731
    action = (mix >> 16) & 32767;
#line 732
    state = mix & 32767;
#line 733
    if (action == 10) {
#line 734
      ret = 0;
#line 735
      goto while_break___0;
    } else
#line 736
    if (action == 8) {
#line 737
      ret = -4;
#line 738
      goto catch_dwm_parse_line;
    } else
#line 739
    if (action > 0) {
#line 739
      if (action < 10) {
        {
#line 740
        dwm_do_action(ch, action, actions);
        }
      }
    }
    {
#line 742
    last = ch;
#line 743
    ch = fgetc(look);
#line 744
    tmp___0 = feof(look);
    }
#line 744
    if (tmp___0) {
#line 744
      if (last != 13) {
#line 744
        if (last != 10) {
#line 745
          ret = -3;
#line 746
          goto catch_dwm_parse_line;
        }
      }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 750
  dwm_set_keys(actions);
  }
  catch_dwm_parse_line: 
#line 753
  a = 0;
  {
#line 753
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 753
    if (! (a < 11)) {
#line 753
      goto while_break___1;
    }
#line 754
    if ((unsigned long )actions[a] != (unsigned long )((dw_str *)0)) {
      {
#line 755
      dw_destroy(actions[a]);
#line 756
      actions[a] = (dw_str *)0;
      }
    }
#line 753
    a ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 759
  return (ret);
}
}
#line 764 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_parse_file(char *name ) 
{ 
  FILE *look ;
  int a ;

  {
#line 766
  a = 0;
#line 768
  if (dwm_file_depth > 8) {
#line 769
    return (-1);
  } else
#line 768
  if ((unsigned long )name == (unsigned long )((char *)0)) {
#line 769
    return (-1);
  }
  {
#line 772
  dwm_file_depth ++;
#line 774
  look = fopen((char const   */* __restrict  */)name, (char const   */* __restrict  */)"rb");
  }
#line 775
  if ((unsigned long )look == (unsigned long )((void *)0)) {
#line 776
    return (-1);
  }
  {
#line 779
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 780
    a = dwm_parse_line(look);
    }
#line 781
    if (a == -3) {
      {
#line 782
      dwm_fatal((char *)"incomplete last line");
      }
    } else
#line 783
    if (a == -4) {
      {
#line 784
      dwm_fatal((char *)"leading whitespace not allowed");
      }
    }
#line 786
    if (a != 0) {
#line 786
      if (a != 1) {
        {
#line 787
        dwm_fatal((char *)"deadwoodrc parse error");
        }
      }
    }
#line 789
    if (dwm_file_depth == 1) {
#line 790
      dwm_linenum ++;
    }
#line 779
    if (! (a == 0)) {
#line 779
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 794
  fclose(look);
#line 796
  dwm_file_depth --;
  }
#line 798
  return (1);
}
}
#line 807 "/home/wheatley/newnew/temp/maradns-2.0.09/deadwood-3.2.05/src/DwMararc.c"
int dwm_parse_mararc(char *name ) 
{ 
  int tmp ;

  {
  {
#line 808
  dwm_linenum = 1;
#line 810
  dwm_init_fsm();
#line 811
  dwm_init_mararc();
#line 813
  tmp = dwm_parse_file(name);
  }
#line 813
  return (tmp);
}
}
#line 66 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../libs/JsStr.h"
js_string *js_create(unsigned int max_count , unsigned int unit_size ) ;
#line 70
int js_destroy(js_string *object ) ;
#line 72
int js_has_sanity(js_string *object ) ;
#line 82
int js_copy(js_string *src , js_string *dest ) ;
#line 90
int js_adduint16(js_string *js , int number ) ;
#line 93
int js_readuint16(js_string *js , unsigned int offset ) ;
#line 98
void *js_alloc(int unit_count , int unit_size ) ;
#line 99
int js_dealloc(void *pointer ) ;
#line 111
int js_adduint32(js_string *js , uint32_t number ) ;
#line 112
int js_substr_append(js_string *source , js_string *dest , int offset , int length ) ;
#line 114
uint32_t js_readuint32(js_string *js , unsigned int offset ) ;
#line 37 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/functions_dns.h"
int dlabel_length(js_string *raw , unsigned int offset ) ;
#line 43
int compress_data(js_string *in , js_string *out ) ;
#line 37 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
extern js_string *decomp_get_label(js_string *compressed , int compressed_offset ) ;
#line 39
rrdesc **decomp_export_rrformats(void) ;
#line 40
char *decomp_get_rrdesc(int rr_num ) ;
#line 64 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
compress_state *compress_init_state(js_string *uncompressed ) 
{ 
  compress_state *new ;
  int tmp ;
  void *tmp___0 ;
  js_string *tmp___1 ;
  int *tmp___2 ;
  void *tmp___3 ;

  {
  {
#line 68
  tmp = js_has_sanity(uncompressed);
  }
#line 68
  if (tmp != 1) {
#line 69
    return ((compress_state *)0);
  }
  {
#line 72
  tmp___0 = js_alloc(1, (int )sizeof(compress_state ));
#line 72
  new = (compress_state *)tmp___0;
  }
#line 72
  if ((unsigned long )new == (unsigned long )((compress_state *)0)) {
#line 73
    return ((compress_state *)0);
  }
  {
#line 76
  new->uncompressed_offset = 0U;
#line 77
  new->this_dlabel_begin = 0U;
#line 78
  new->this_rdlength_begin = 0U;
#line 79
  new->this_rr_type = 0;
#line 80
  new->current_rdlength = 0;
#line 81
  new->valid_state = 1;
#line 82
  new->number_answers = 0;
#line 83
  new->uncompressed = uncompressed;
#line 86
  tmp___1 = js_create(4100U, 1U);
#line 86
  new->compressed = tmp___1;
  }
#line 86
  if ((unsigned long )tmp___1 == (unsigned long )((js_string *)0)) {
    {
#line 87
    js_dealloc((void *)new);
    }
#line 88
    return ((compress_state *)0);
  }
  {
#line 90
  tmp___3 = js_alloc(163, (int )sizeof(int ));
#line 90
  tmp___2 = (int *)tmp___3;
#line 90
  new->dlabel_points = tmp___2;
  }
#line 90
  if ((unsigned long )tmp___2 == (unsigned long )((int *)0)) {
    {
#line 92
    js_destroy(new->compressed);
#line 93
    js_dealloc((void *)new);
    }
#line 94
    return ((compress_state *)0);
  }
#line 96
  *(new->dlabel_points + 0) = 0;
#line 99
  return (new);
}
}
#line 110 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
js_string *compress_get_dlabel(js_string *packet , int offset ) 
{ 
  js_string *tmp ;

  {
  {
#line 111
  tmp = decomp_get_label(packet, offset);
  }
#line 111
  return (tmp);
}
}
#line 118 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_issame(js_string *js1 , js_string *js2 ) 
{ 
  int counter ;
  int max ;
  int lc1 ;
  int lc2 ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 119
  counter = 0;
#line 124
  tmp = js_has_sanity(js1);
  }
#line 124
  if (tmp == -1) {
#line 125
    return (-1);
  }
  {
#line 126
  tmp___0 = js_has_sanity(js2);
  }
#line 126
  if (tmp___0 == -1) {
#line 127
    return (-1);
  }
#line 130
  if (js1->unit_size != js2->unit_size) {
#line 131
    return (0);
  }
#line 133
  if (js1->unit_count != js2->unit_count) {
#line 134
    return (0);
  }
#line 140
  max = (int )js1->unit_count;
  {
#line 143
  while (1) {
    while_continue: /* CIL Label */ ;
#line 143
    if (! ((unsigned int )counter < (unsigned int )max * js1->unit_size)) {
#line 143
      goto while_break;
    }
#line 144
    lc1 = (int )*(js1->string + counter);
#line 145
    lc2 = (int )*(js2->string + counter);
#line 146
    if (lc1 >= 65) {
#line 146
      if (lc1 <= 90) {
#line 146
        lc1 += 32;
      }
    }
#line 147
    if (lc2 >= 65) {
#line 147
      if (lc2 <= 90) {
#line 147
        lc2 += 32;
      }
    }
#line 148
    if (lc1 != lc2) {
#line 149
      return (0);
    }
#line 150
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 154
  return (1);
}
}
#line 165 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_compare_dlabels(js_string *packet1 , js_string *packet2 , int offset1 ,
                             int offset2 ) 
{ 
  js_string *a ;
  js_string *b ;
  int ret ;

  {
  {
#line 170
  a = compress_get_dlabel(packet1, offset1);
  }
#line 171
  if ((unsigned long )a == (unsigned long )((js_string *)0)) {
#line 172
    return (-1);
  }
  {
#line 173
  b = compress_get_dlabel(packet2, offset2);
  }
#line 174
  if ((unsigned long )b == (unsigned long )((js_string *)0)) {
    {
#line 175
    js_destroy(a);
    }
#line 176
    return (-1);
  }
  {
#line 178
  ret = compress_issame(a, b);
#line 179
  js_destroy(a);
#line 180
  js_destroy(b);
  }
#line 181
  return (ret);
}
}
#line 200 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_add_dlabel_points(compress_state *state , int offset ) 
{ 
  int counter ;
  int limit ;
  unsigned int len ;

  {
#line 204
  if ((unsigned long )state == (unsigned long )((compress_state *)0)) {
#line 205
    return (-1);
  }
#line 206
  if (state->valid_state != 1) {
#line 207
    return (-1);
  }
#line 210
  counter = 0;
  {
#line 211
  while (1) {
    while_continue: /* CIL Label */ ;
#line 211
    if (*(state->dlabel_points + counter) != 0) {
#line 211
      if (! (counter < 150)) {
#line 211
        goto while_break;
      }
    } else {
#line 211
      goto while_break;
    }
#line 213
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 217
  limit = 0;
  {
#line 218
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 218
    if (! (limit < 257)) {
#line 218
      goto while_break___0;
    }
#line 222
    if ((unsigned int )offset >= (state->compressed)->unit_count) {
#line 223
      state->valid_state = 0;
#line 224
      return (-1);
    }
#line 228
    len = (unsigned int )*((state->compressed)->string + offset);
#line 229
    if (len >= 192U) {
#line 230
      goto while_break___0;
    }
#line 233
    if ((unsigned int )offset + len >= (state->compressed)->unit_count) {
#line 234
      state->valid_state = 0;
#line 235
      return (-1);
    }
#line 237
    if (counter >= 150) {
#line 238
      state->valid_state = 0;
#line 239
      return (-1);
    }
#line 243
    *(state->dlabel_points + counter) = offset;
#line 244
    *(state->dlabel_points + (counter + 1)) = 0;
#line 245
    counter ++;
#line 246
    if (len == 0U) {
#line 247
      goto while_break___0;
    } else
#line 246
    if (len > 63U) {
#line 247
      goto while_break___0;
    }
#line 249
    offset = (int )((unsigned int )offset + len);
#line 250
    offset ++;
#line 253
    limit ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 257
  if (limit >= 257) {
#line 258
    state->valid_state = 0;
#line 259
    return (-1);
  }
#line 262
  return (1);
}
}
#line 279 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_sub_dlabel(compress_state *state ) 
{ 
  unsigned int len ;
  unsigned int counter ;
  int tmp ;
  uint16_t compress_pointer ;
  int length ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 284
  if ((unsigned long )state == (unsigned long )((compress_state *)0)) {
#line 285
    return (-1);
  }
#line 287
  if (state->valid_state != 1) {
#line 288
    return (-1);
  }
#line 290
  if (state->uncompressed_offset >= (state->uncompressed)->unit_count) {
#line 291
    state->valid_state = 0;
#line 292
    return (-1);
  }
#line 296
  len = (unsigned int )*((state->uncompressed)->string + state->uncompressed_offset);
#line 297
  if (len == 0U) {
    {
#line 299
    tmp = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                           1);
    }
#line 299
    if (tmp != 1) {
#line 301
      state->valid_state = 0;
#line 302
      return (-1);
    }
#line 304
    if (state->uncompressed_offset + 1U > (state->uncompressed)->unit_count) {
#line 307
      state->valid_state = 0;
#line 308
      return (-1);
    } else
#line 304
    if (state->uncompressed_offset + 1U >= (state->uncompressed)->max_count) {
#line 307
      state->valid_state = 0;
#line 308
      return (-1);
    }
#line 310
    if (state->uncompressed_offset == (state->uncompressed)->unit_count) {
#line 311
      return (3);
    }
#line 313
    (state->uncompressed_offset) ++;
#line 314
    return (0);
  }
#line 316
  if (len > 63U) {
#line 317
    state->valid_state = 0;
#line 318
    return (-1);
  } else
#line 316
  if (len < 0U) {
#line 317
    state->valid_state = 0;
#line 318
    return (-1);
  }
#line 320
  if ((state->uncompressed_offset + len) + 1U >= (state->uncompressed)->unit_count) {
#line 323
    state->valid_state = 0;
#line 324
    return (-1);
  } else
#line 320
  if ((state->uncompressed_offset + len) + 1U >= (state->uncompressed)->max_count) {
#line 323
    state->valid_state = 0;
#line 324
    return (-1);
  }
#line 329
  counter = 0U;
  {
#line 330
  while (1) {
    while_continue: /* CIL Label */ ;
#line 330
    if (! (counter < 155U)) {
#line 330
      goto while_break;
    }
#line 333
    if (*(state->dlabel_points + counter) == 0) {
#line 334
      goto while_break;
    }
#line 338
    if ((unsigned int )*(state->dlabel_points + counter) >= state->this_dlabel_begin) {
#line 339
      goto while_break;
    }
    {
#line 343
    tmp___1 = compress_compare_dlabels(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                                       *(state->dlabel_points + counter));
    }
#line 343
    if (tmp___1 == 1) {
#line 348
      if (*(state->dlabel_points + counter) < 12) {
#line 350
        state->valid_state = 0;
#line 351
        return (-1);
      } else
#line 348
      if (*(state->dlabel_points + counter) >= 16384) {
#line 350
        state->valid_state = 0;
#line 351
        return (-1);
      }
      {
#line 353
      compress_pointer = (uint16_t )*(state->dlabel_points + counter);
#line 354
      compress_pointer = (uint16_t )((int )compress_pointer | 49152);
#line 355
      tmp___0 = js_adduint16(state->compressed, (int )compress_pointer);
      }
#line 355
      if (tmp___0 != 1) {
#line 356
        state->valid_state = 0;
#line 357
        return (-1);
      }
      {
#line 361
      length = dlabel_length(state->uncompressed, state->uncompressed_offset);
      }
#line 363
      if (length == -1) {
#line 364
        state->valid_state = 0;
#line 365
        return (-1);
      }
#line 367
      if (state->uncompressed_offset + (unsigned int )length > (state->uncompressed)->unit_count) {
#line 371
        state->valid_state = 0;
#line 372
        return (-1);
      } else
#line 367
      if (state->uncompressed_offset + (unsigned int )length >= (state->uncompressed)->max_count) {
#line 371
        state->valid_state = 0;
#line 372
        return (-1);
      }
#line 374
      state->uncompressed_offset += (unsigned int )length;
#line 375
      if (state->uncompressed_offset == (state->uncompressed)->unit_count) {
#line 376
        return (3);
      }
#line 378
      return (2);
    }
#line 380
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 384
  if (counter >= 155U) {
#line 385
    state->valid_state = 0;
#line 386
    return (-1);
  }
  {
#line 390
  tmp___2 = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                             (int )(len + 1U));
  }
#line 390
  if (tmp___2 != 1) {
#line 392
    state->valid_state = 0;
#line 393
    return (-1);
  }
#line 395
  state->uncompressed_offset += len;
#line 396
  (state->uncompressed_offset) ++;
#line 397
  return (1);
}
}
#line 413 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_dlabel(compress_state *state ) 
{ 
  int offset ;
  int ret ;
  int tmp ;

  {
#line 417
  if (state->valid_state != 1) {
#line 418
    return (-1);
  }
#line 421
  offset = (int )(state->compressed)->unit_count;
#line 422
  state->this_dlabel_begin = state->uncompressed_offset;
#line 424
  ret = 1;
  {
#line 425
  while (1) {
    while_continue: /* CIL Label */ ;
#line 425
    if (! (ret == 1)) {
#line 425
      goto while_break;
    }
    {
#line 426
    ret = compress_sub_dlabel(state);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 430
  if (ret == 3) {
#line 431
    return (1);
  }
  {
#line 434
  tmp = compress_add_dlabel_points(state, offset);
  }
#line 434
  if (tmp != 1) {
#line 435
    state->valid_state = 0;
#line 436
    return (-1);
  }
#line 439
  return (1);
}
}
#line 454 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
char compress_get_tocomp(int rr_num ) 
{ 
  rrdesc *point ;
  rrdesc **hash ;

  {
  {
#line 457
  hash = decomp_export_rrformats();
  }
#line 458
  if ((unsigned long )hash == (unsigned long )((rrdesc **)0)) {
#line 459
    return ((char)0);
  }
#line 462
  point = *(hash + rr_num % 7);
#line 464
  if ((unsigned long )point == (unsigned long )((rrdesc *)0)) {
#line 465
    return ((char)0);
  }
  {
#line 467
  while (1) {
    while_continue: /* CIL Label */ ;
#line 467
    if (! (point->rr_num != rr_num)) {
#line 467
      goto while_break;
    }
#line 468
    point = point->next;
#line 469
    if ((unsigned long )point == (unsigned long )((rrdesc *)0)) {
#line 470
      return ((char)0);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 473
  return (point->tocompress);
}
}
#line 489 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_rddata(compress_state *state ) 
{ 
  char *desc ;
  char to_compress ;
  int subtype ;
  int total ;
  int ctotal ;
  int tmp ;
  int tmp___0 ;
  int len ;
  int point ;
  int tmp___1 ;
  int tmp___2 ;
  int len___0 ;
  int clen ;
  int coffset ;
  int tmp___3 ;
  int len___1 ;
  int tmp___4 ;
  int len___2 ;
  int tmp___5 ;
  unsigned char left ;
  unsigned char right ;
  unsigned int off ;

  {
#line 495
  if (state->valid_state != 1) {
#line 496
    return (-1);
  }
  {
#line 499
  desc = decomp_get_rrdesc(state->this_rr_type);
#line 500
  to_compress = compress_get_tocomp(state->this_rr_type);
  }
#line 502
  if ((unsigned long )desc == (unsigned long )((char *)0)) {
#line 503
    if (state->current_rdlength == 0) {
#line 504
      return (1);
    }
    {
#line 506
    tmp = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                           state->current_rdlength);
    }
#line 506
    if (tmp != 1) {
#line 509
      state->valid_state = 0;
#line 510
      return (-1);
    } else {
#line 513
      state->uncompressed_offset += (unsigned int )state->current_rdlength;
#line 514
      return (1);
    }
  } else {
#line 518
    subtype = (int )*desc;
#line 519
    total = 0;
#line 520
    ctotal = 0;
    {
#line 521
    while (1) {
      while_continue: /* CIL Label */ ;
#line 521
      if (! (subtype != 0)) {
#line 521
        goto while_break;
      }
#line 523
      if (subtype > 0) {
#line 523
        if (subtype < 64) {
          {
#line 524
          tmp___0 = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                                     subtype);
          }
#line 524
          if (tmp___0 != 1) {
#line 528
            state->valid_state = 0;
#line 529
            return (-1);
          }
#line 531
          total += subtype;
#line 532
          ctotal += subtype;
#line 533
          state->uncompressed_offset += (unsigned int )subtype;
        } else {
#line 523
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 536
      if (subtype == 64) {
#line 538
        if ((int )to_compress == 0) {
          {
#line 540
          len = dlabel_length(state->uncompressed, state->uncompressed_offset);
          }
#line 542
          if (len < 1) {
#line 543
            state->valid_state = 0;
#line 544
            return (-1);
          }
          {
#line 546
          point = (int )(state->compressed)->unit_count;
#line 547
          tmp___1 = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                                     len);
          }
#line 547
          if (tmp___1 != 1) {
#line 551
            state->valid_state = 0;
#line 552
            return (-1);
          }
          {
#line 554
          tmp___2 = compress_add_dlabel_points(state, point);
          }
#line 554
          if (tmp___2 != 1) {
#line 555
            state->valid_state = 0;
#line 556
            return (-1);
          }
#line 558
          state->uncompressed_offset += (unsigned int )len;
#line 559
          total += len;
#line 560
          ctotal += len;
        } else {
          {
#line 564
          len___0 = dlabel_length(state->uncompressed, state->uncompressed_offset);
          }
#line 566
          if (len___0 < 1) {
#line 567
            state->valid_state = 0;
#line 568
            return (-1);
          }
          {
#line 570
          coffset = (int )(state->compressed)->unit_count;
#line 571
          tmp___3 = compress_dlabel(state);
          }
#line 571
          if (tmp___3 != 1) {
#line 572
            state->valid_state = 0;
#line 573
            return (-1);
          }
          {
#line 575
          total += len___0;
#line 576
          clen = dlabel_length(state->compressed, (unsigned int )coffset);
#line 577
          ctotal += clen;
          }
        }
      } else
#line 581
      if (subtype == 65) {
#line 583
        if (state->uncompressed_offset >= (state->uncompressed)->unit_count) {
#line 585
          state->valid_state = 0;
#line 586
          return (-1);
        }
#line 588
        len___1 = (int )*((state->uncompressed)->string + state->uncompressed_offset);
#line 590
        if (len___1 < 0) {
#line 591
          state->valid_state = 0;
#line 592
          return (-1);
        } else
#line 590
        if (len___1 > 256) {
#line 591
          state->valid_state = 0;
#line 592
          return (-1);
        }
        {
#line 594
        tmp___4 = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                                   len___1);
        }
#line 594
        if (tmp___4 != 1) {
#line 598
          state->valid_state = 0;
#line 599
          return (-1);
        }
#line 601
        total += len___1;
#line 602
        ctotal += len___1;
#line 603
        state->uncompressed_offset += (unsigned int )len___1;
      } else
#line 606
      if (subtype == 66) {
#line 608
        len___2 = state->current_rdlength - total;
#line 609
        if (len___2 == 0) {
#line 610
          goto while_break;
        }
        {
#line 612
        tmp___5 = js_substr_append(state->uncompressed, state->compressed, (int )state->uncompressed_offset,
                                   len___2);
        }
#line 612
        if (tmp___5 != 1) {
#line 616
          state->valid_state = 0;
#line 617
          return (-1);
        }
#line 619
        total += len___2;
#line 620
        ctotal += len___2;
#line 621
        state->uncompressed_offset += (unsigned int )len___2;
      } else {
#line 625
        state->valid_state = 0;
#line 626
        return (-1);
      }
#line 628
      desc ++;
#line 630
      if (subtype != 66) {
#line 631
        subtype = (int )*desc;
      } else {
#line 633
        subtype = 0;
      }
    }
    while_break: /* CIL Label */ ;
    }
#line 636
    if (state->current_rdlength != total) {
#line 637
      state->valid_state = 0;
#line 638
      return (-1);
    }
  }
#line 643
  if (ctotal != total) {
#line 646
    off = state->this_rdlength_begin;
#line 647
    if (ctotal > 65535) {
#line 648
      state->valid_state = 0;
#line 649
      return (-1);
    } else
#line 647
    if (ctotal < 2) {
#line 648
      state->valid_state = 0;
#line 649
      return (-1);
    }
#line 651
    left = (unsigned char )((ctotal >> 8) & 255);
#line 652
    right = (unsigned char )(ctotal & 255);
#line 653
    if (off < 12U) {
#line 654
      state->valid_state = 0;
#line 655
      return (-1);
    } else
#line 653
    if (off >= (state->compressed)->unit_count - 1U) {
#line 654
      state->valid_state = 0;
#line 655
      return (-1);
    }
#line 657
    *((state->compressed)->string + off) = left;
#line 658
    *(((state->compressed)->string + off) + 1) = right;
  }
#line 662
  return (1);
}
}
#line 678 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_get_uint16(compress_state *state ) 
{ 
  int number ;
  int tmp ;

  {
#line 681
  if (state->valid_state != 1) {
#line 682
    return (-1);
  }
  {
#line 685
  number = js_readuint16(state->uncompressed, state->uncompressed_offset);
  }
#line 686
  if (number == -1) {
#line 687
    state->valid_state = 0;
#line 688
    return (-1);
  }
#line 690
  if (number < 0) {
#line 691
    state->valid_state = 0;
#line 692
    return (-1);
  } else
#line 690
  if (number > 65535) {
#line 691
    state->valid_state = 0;
#line 692
    return (-1);
  }
  {
#line 694
  tmp = js_adduint16(state->compressed, number);
  }
#line 694
  if (tmp != 1) {
#line 695
    state->valid_state = 0;
#line 696
    return (-1);
  }
#line 698
  state->uncompressed_offset += 2U;
#line 699
  if (state->uncompressed_offset > (state->uncompressed)->unit_count) {
#line 700
    state->valid_state = 0;
#line 701
    return (-1);
  }
#line 705
  return (number);
}
}
#line 723 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_get_type_etc(compress_state *state ) 
{ 
  int number ;
  uint32_t tmp ;
  int tmp___0 ;

  {
#line 726
  if (state->valid_state != 1) {
#line 727
    return (-1);
  }
  {
#line 731
  number = compress_get_uint16(state);
  }
#line 732
  if (number == -1) {
#line 733
    state->valid_state = 0;
#line 734
    return (-1);
  }
  {
#line 736
  state->this_rr_type = number;
#line 739
  number = compress_get_uint16(state);
  }
#line 740
  if (number == -1) {
#line 741
    state->valid_state = 0;
#line 742
    return (-1);
  }
  {
#line 746
  tmp = js_readuint32(state->uncompressed, state->uncompressed_offset);
#line 746
  number = (int )tmp;
  }
#line 747
  if ((unsigned int )number == 4294967295U) {
#line 748
    state->valid_state = 0;
#line 749
    return (-1);
  }
  {
#line 751
  tmp___0 = js_adduint32(state->compressed, (uint32_t )number);
  }
#line 751
  if (tmp___0 != 1) {
#line 752
    state->valid_state = 0;
#line 753
    return (-1);
  }
#line 755
  state->uncompressed_offset += 4U;
#line 756
  if (state->uncompressed_offset >= (state->uncompressed)->unit_count) {
#line 757
    state->valid_state = 0;
#line 758
    return (-1);
  }
#line 762
  return (1);
}
}
#line 773 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_get_header(compress_state *state ) 
{ 
  int qdcount ;
  int ancount ;
  int nscount ;
  int arcount ;
  int total ;
  int tmp ;

  {
#line 780
  if (state->valid_state != 1) {
#line 781
    return (-1);
  }
#line 784
  if (state->uncompressed_offset != 0U) {
#line 785
    state->valid_state = 0;
#line 786
    return (-1);
  }
  {
#line 790
  tmp = js_substr_append(state->uncompressed, state->compressed, 0, 4);
  }
#line 790
  if (tmp != 1) {
#line 792
    state->valid_state = 0;
#line 793
    return (-1);
  }
#line 797
  state->uncompressed_offset += 4U;
#line 798
  if (state->uncompressed_offset >= (state->uncompressed)->unit_count) {
#line 799
    state->valid_state = 0;
#line 800
    return (-1);
  }
  {
#line 804
  qdcount = compress_get_uint16(state);
  }
#line 805
  if (qdcount == -1) {
#line 806
    state->valid_state = 0;
#line 807
    return (-1);
  }
  {
#line 811
  ancount = compress_get_uint16(state);
  }
#line 812
  if (ancount == -1) {
#line 813
    state->valid_state = 0;
#line 814
    return (-1);
  }
  {
#line 818
  nscount = compress_get_uint16(state);
  }
#line 819
  if (nscount == -1) {
#line 820
    state->valid_state = 0;
#line 821
    return (-1);
  }
  {
#line 825
  arcount = compress_get_uint16(state);
  }
#line 826
  if (arcount == -1) {
#line 827
    state->valid_state = 0;
#line 828
    return (-1);
  }
#line 833
  if (qdcount < 0) {
#line 834
    state->valid_state = 0;
#line 835
    return (-1);
  } else
#line 833
  if (qdcount > 1) {
#line 834
    state->valid_state = 0;
#line 835
    return (-1);
  }
#line 837
  total = (ancount + nscount) + arcount;
#line 840
  if (total != 0) {
#line 840
    if (qdcount != 1) {
#line 841
      state->valid_state = 0;
#line 842
      return (-1);
    }
  }
#line 845
  if (qdcount == 0) {
#line 846
    state->number_answers = -2;
#line 847
    return (1);
  }
#line 850
  state->number_answers = total;
#line 851
  return (1);
}
}
#line 863 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_get_question(compress_state *state ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 866
  if (state->valid_state != 1) {
#line 867
    return (-1);
  }
#line 869
  if (state->uncompressed_offset != 12U) {
#line 870
    state->valid_state = 0;
#line 871
    return (-1);
  }
#line 874
  if (state->number_answers == -2) {
#line 875
    return (1);
  }
  {
#line 879
  tmp = compress_dlabel(state);
  }
#line 879
  if (tmp != 1) {
#line 880
    state->valid_state = 0;
#line 881
    return (-1);
  }
  {
#line 884
  tmp___0 = compress_get_uint16(state);
  }
#line 884
  if (tmp___0 == -1) {
#line 885
    state->valid_state = 0;
#line 886
    return (-1);
  }
  {
#line 889
  tmp___1 = compress_get_uint16(state);
  }
#line 889
  if (tmp___1 == -1) {
#line 890
    state->valid_state = 0;
#line 891
    return (-1);
  }
#line 894
  return (1);
}
}
#line 901 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_get_rdlength(compress_state *state ) 
{ 
  int number ;

  {
  {
#line 905
  state->this_rdlength_begin = (state->compressed)->unit_count;
#line 907
  number = compress_get_uint16(state);
  }
#line 908
  if (number == -1) {
#line 909
    state->valid_state = 0;
#line 910
    return (-1);
  }
#line 912
  state->current_rdlength = number;
#line 914
  return (1);
}
}
#line 923 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_answers(compress_state *state ) 
{ 
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 926
  if (state->valid_state != 1) {
#line 927
    return (-1);
  }
#line 930
  counter = 0;
  {
#line 930
  while (1) {
    while_continue: /* CIL Label */ ;
#line 930
    if (! (counter < state->number_answers)) {
#line 930
      goto while_break;
    }
    {
#line 931
    tmp = compress_dlabel(state);
    }
#line 931
    if (tmp == -1) {
#line 932
      state->valid_state = 0;
#line 933
      return (-1);
    }
    {
#line 935
    tmp___0 = compress_get_type_etc(state);
    }
#line 935
    if (tmp___0 == -1) {
#line 936
      state->valid_state = 0;
#line 937
      return (-1);
    }
    {
#line 939
    tmp___1 = compress_get_rdlength(state);
    }
#line 939
    if (tmp___1 == -1) {
#line 940
      state->valid_state = 0;
#line 941
      return (-1);
    }
    {
#line 943
    tmp___2 = compress_rddata(state);
    }
#line 943
    if (tmp___2 == -1) {
#line 944
      state->valid_state = 0;
#line 945
      return (-1);
    }
#line 930
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 948
  return (1);
}
}
#line 959 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
js_string *compress_destroy_state(compress_state *state ) 
{ 
  js_string *ret ;

  {
  {
#line 961
  js_dealloc((void *)state->dlabel_points);
#line 962
  ret = state->compressed;
#line 963
  js_dealloc((void *)state);
  }
#line 964
  return (ret);
}
}
#line 980 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress.c"
int compress_data(js_string *in , js_string *out ) 
{ 
  js_string *compressed ;
  compress_state *state ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 984
  state = compress_init_state(in);
  }
#line 985
  if ((unsigned long )state == (unsigned long )((compress_state *)0)) {
#line 986
    return (-1);
  }
  {
#line 992
  tmp = compress_get_header(state);
  }
#line 992
  if (tmp == -1) {
    {
#line 993
    compressed = compress_destroy_state(state);
#line 994
    js_destroy(compressed);
    }
#line 995
    return (-1);
  }
  {
#line 998
  tmp___0 = compress_get_question(state);
  }
#line 998
  if (tmp___0 == -1) {
    {
#line 999
    compressed = compress_destroy_state(state);
#line 1000
    js_destroy(compressed);
    }
#line 1001
    return (-1);
  }
  {
#line 1004
  tmp___1 = compress_answers(state);
  }
#line 1004
  if (tmp___1 == -1) {
    {
#line 1005
    compressed = compress_destroy_state(state);
#line 1006
    js_destroy(compressed);
    }
#line 1007
    return (-1);
  }
  {
#line 1010
  compressed = compress_destroy_state(state);
#line 1016
  tmp___2 = js_copy(compressed, out);
  }
#line 1016
  if (tmp___2 == -1) {
    {
#line 1017
    js_destroy(compressed);
    }
#line 1018
    return (-1);
  }
  {
#line 1021
  js_destroy(compressed);
  }
#line 1022
  return (1);
}
}
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/bobbit.c"
int bobbit_label(js_string *js ) 
{ 
  int counter ;
  unsigned char length ;

  {
#line 31
  counter = 0;
#line 34
  if (js->unit_size != 1U) {
#line 35
    return (-1);
  }
#line 36
  if (js->unit_count >= js->max_count) {
#line 37
    return (-1);
  }
#line 38
  if (js->unit_count < 1U) {
#line 39
    return (-1);
  }
#line 41
  length = *(js->string);
#line 43
  if ((int )length == 95) {
#line 44
    length = (unsigned char)0;
  } else
#line 45
  if ((unsigned int )((int )length + 1) > js->unit_count) {
#line 46
    return (-1);
  } else
#line 45
  if ((int )length > 63) {
#line 46
    return (-1);
  } else
#line 47
  if ((int )length == 0) {
#line 48
    return (0);
  }
#line 50
  length = (unsigned char )((int )length + 1);
  {
#line 52
  while (1) {
    while_continue: /* CIL Label */ ;
#line 52
    if (! ((unsigned int )counter < js->unit_count - (unsigned int )length)) {
#line 52
      goto while_break;
    }
#line 53
    *(js->string + counter) = *((js->string + counter) + (int )length);
#line 54
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 57
  js->unit_count -= (unsigned int )length;
#line 59
  return (1);
}
}
#line 65 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.h"
int js_octets(js_string *js ) ;
#line 121
int js_newline_chars(js_string *js ) ;
#line 122
int js_tolower(js_string *js ) ;
#line 123
unsigned int js_atoi(js_string *js , int offset ) ;
#line 124
int js_space_chars(js_string *js ) ;
#line 125
js_string *js_an_chars(js_string *js ) ;
#line 126
js_string *js_numbers(js_string *js ) ;
#line 12 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
int js_newline_chars(js_string *js ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 15
  tmp = js_has_sanity(js);
  }
#line 15
  if (tmp == -1) {
#line 16
    return (-1);
  }
  {
#line 20
  if (js->encoding == 1) {
#line 20
    goto case_1;
  }
#line 24
  if (js->encoding == 3) {
#line 24
    goto case_3;
  }
#line 24
  if (js->encoding == 2) {
#line 24
    goto case_3;
  }
#line 19
  goto switch_break;
  case_1: /* CIL Label */ 
#line 21
  js->unit_count = 0U;
#line 22
  return (1);
  case_3: /* CIL Label */ 
  case_2: /* CIL Label */ 
#line 25
  if (js->unit_size != 1U) {
#line 26
    return (-1);
  }
  {
#line 27
  tmp___0 = js_octets(js);
  }
#line 27
  if (tmp___0 < 2) {
#line 28
    return (-1);
  }
#line 29
  *(js->string) = (unsigned char )'\r';
#line 30
  *(js->string + 1) = (unsigned char )'\n';
#line 31
  js->unit_count = 2U;
#line 32
  return (1);
  switch_break: /* CIL Label */ ;
  }
#line 36
  return (-1);
}
}
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
int js_space_chars(js_string *js ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 48
  tmp = js_has_sanity(js);
  }
#line 48
  if (tmp == -1) {
#line 49
    return (-1);
  }
  {
#line 53
  if (js->encoding == 1) {
#line 53
    goto case_1;
  }
#line 57
  if (js->encoding == 3) {
#line 57
    goto case_3;
  }
#line 57
  if (js->encoding == 2) {
#line 57
    goto case_3;
  }
#line 52
  goto switch_break;
  case_1: /* CIL Label */ 
#line 54
  js->unit_count = 0U;
#line 55
  return (1);
  case_3: /* CIL Label */ 
  case_2: /* CIL Label */ 
#line 58
  if (js->unit_size != 1U) {
#line 59
    return (-1);
  }
  {
#line 60
  tmp___0 = js_octets(js);
  }
#line 60
  if (tmp___0 < 3) {
#line 61
    return (-1);
  }
#line 62
  *(js->string) = (unsigned char )' ';
#line 63
  *(js->string + 1) = (unsigned char )'\t';
#line 64
  if (js->encoding != 2) {
#line 65
    *(js->string + 2) = (unsigned char)160;
#line 66
    js->unit_count = 3U;
  } else {
#line 69
    js->unit_count = 2U;
  }
#line 70
  return (1);
  switch_break: /* CIL Label */ ;
  }
#line 74
  return (-1);
}
}
#line 81 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
unsigned int js_atoi(js_string *js , int offset ) 
{ 
  int value___6 ;
  int sign ;
  int tmp ;

  {
  {
#line 85
  tmp = js_has_sanity(js);
  }
#line 85
  if (tmp == -1) {
#line 86
    return (0U);
  }
#line 89
  if (js->encoding != 2) {
#line 89
    if (js->encoding != 3) {
#line 90
      return (0U);
    } else {
#line 89
      goto _L;
    }
  } else {
    _L: /* CIL Label */ 
#line 93
    if ((unsigned int )offset >= js->unit_count) {
#line 94
      return (0U);
    }
#line 95
    value___6 = 0;
#line 96
    sign = 1;
    {
#line 97
    while (1) {
      while_continue: /* CIL Label */ ;
#line 97
      if ((unsigned int )offset < js->unit_count) {
#line 97
        if ((int )*(js->string + offset) >= 48) {
#line 97
          if (! ((int )*(js->string + offset) <= 57)) {
#line 97
            goto while_break;
          }
        } else {
#line 97
          goto while_break;
        }
      } else {
#line 97
        goto while_break;
      }
#line 99
      value___6 *= 10;
#line 100
      value___6 += (int )*(js->string + offset) - 48;
#line 101
      offset ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 103
    value___6 *= sign;
#line 104
    return ((unsigned int )value___6);
  }
#line 107
  return (0U);
}
}
#line 113 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
int js_tolower(js_string *js ) 
{ 
  int counter ;
  int tmp ;

  {
  {
#line 116
  tmp = js_has_sanity(js);
  }
#line 116
  if (tmp == -1) {
#line 117
    return (-1);
  }
#line 119
  if (js->unit_size != 1U) {
#line 121
    return (-1);
  }
#line 123
  if (js->encoding == 2) {
#line 124
    counter = 0;
    {
#line 124
    while (1) {
      while_continue: /* CIL Label */ ;
#line 124
      if (! ((unsigned int )counter < js->unit_count)) {
#line 124
        goto while_break;
      }
#line 125
      if ((int )*(js->string + counter) >= 65) {
#line 125
        if ((int )*(js->string + counter) <= 90) {
#line 127
          *(js->string + counter) = (unsigned char )((int )*(js->string + counter) + 32);
        }
      }
#line 124
      counter ++;
    }
    while_break: /* CIL Label */ ;
    }
  } else
#line 129
  if (js->encoding == 3) {
#line 130
    counter = 0;
    {
#line 130
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 130
      if (! ((unsigned int )counter < js->unit_count)) {
#line 130
        goto while_break___0;
      }
#line 131
      if ((int )*(js->string + counter) >= 65) {
#line 131
        if ((int )*(js->string + counter) <= 90) {
#line 133
          *(js->string + counter) = (unsigned char )((int )*(js->string + counter) + 32);
        }
      }
#line 134
      if ((int )*(js->string + counter) >= 192) {
#line 134
        if ((int )*(js->string + counter) <= 214) {
#line 136
          *(js->string + counter) = (unsigned char )((int )*(js->string + counter) + 32);
        }
      }
#line 139
      if ((int )*(js->string + counter) >= 216) {
#line 139
        if ((int )*(js->string + counter) <= 222) {
#line 141
          *(js->string + counter) = (unsigned char )((int )*(js->string + counter) + 32);
        }
      }
#line 130
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  } else {
#line 146
    return (0);
  }
#line 148
  return (1);
}
}
#line 159 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
js_string *js_anq_chars(js_string *js , int do_nums ) 
{ 
  int place ;
  int do_lets ;
  unsigned char counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 160
  place = 0;
#line 160
  do_lets = 1;
#line 164
  tmp = js_has_sanity(js);
  }
#line 164
  if (tmp == -1) {
#line 165
    return ((js_string *)0);
  }
#line 168
  if (do_nums == 2) {
#line 169
    do_lets = 0;
  }
  {
#line 173
  if (js->encoding == 3) {
#line 173
    goto case_3;
  }
#line 196
  if (js->encoding == 2) {
#line 196
    goto case_2;
  }
#line 225
  goto switch_default;
  case_3: /* CIL Label */ 
  {
#line 174
  tmp___0 = js_octets(js);
  }
#line 174
  if (tmp___0 < 192) {
#line 175
    return ((js_string *)0);
  }
#line 176
  if (do_lets == 1) {
#line 178
    counter = (unsigned char)192;
    {
#line 178
    while (1) {
      while_continue: /* CIL Label */ ;
#line 178
      if (! ((int )counter <= 214)) {
#line 178
        goto while_break;
      }
#line 179
      *(js->string + place) = counter;
#line 180
      place ++;
#line 178
      counter = (unsigned char )((int )counter + 1);
    }
    while_break: /* CIL Label */ ;
    }
#line 183
    counter = (unsigned char)216;
    {
#line 183
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 183
      if (! ((int )counter <= 246)) {
#line 183
        goto while_break___0;
      }
#line 184
      *(js->string + place) = counter;
#line 185
      place ++;
#line 183
      counter = (unsigned char )((int )counter + 1);
    }
    while_break___0: /* CIL Label */ ;
    }
#line 188
    counter = (unsigned char)248;
    {
#line 188
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 188
      if (! ((int )counter < 255)) {
#line 188
        goto while_break___1;
      }
#line 189
      *(js->string + place) = counter;
#line 190
      place ++;
#line 188
      counter = (unsigned char )((int )counter + 1);
    }
    while_break___1: /* CIL Label */ ;
    }
#line 193
    *(js->string + place) = (unsigned char)255;
#line 194
    place ++;
  }
  case_2: /* CIL Label */ 
  {
#line 197
  tmp___1 = js_octets(js);
  }
#line 197
  if (tmp___1 < 96) {
#line 198
    return ((js_string *)0);
  }
#line 199
  if (do_lets == 1) {
#line 201
    counter = (unsigned char )'A';
    {
#line 201
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 201
      if (! ((int )counter <= 90)) {
#line 201
        goto while_break___2;
      }
#line 202
      *(js->string + place) = counter;
#line 203
      place ++;
#line 201
      counter = (unsigned char )((int )counter + 1);
    }
    while_break___2: /* CIL Label */ ;
    }
#line 206
    counter = (unsigned char )'a';
    {
#line 206
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 206
      if (! ((int )counter <= 122)) {
#line 206
        goto while_break___3;
      }
#line 207
      *(js->string + place) = counter;
#line 208
      place ++;
#line 206
      counter = (unsigned char )((int )counter + 1);
    }
    while_break___3: /* CIL Label */ ;
    }
  }
#line 211
  if (do_nums == 1) {
#line 211
    goto _L;
  } else
#line 211
  if (do_nums == 2) {
    _L: /* CIL Label */ 
#line 213
    counter = (unsigned char )'0';
    {
#line 213
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 213
      if (! ((int )counter <= 57)) {
#line 213
        goto while_break___4;
      }
#line 214
      *(js->string + place) = counter;
#line 215
      place ++;
#line 213
      counter = (unsigned char )((int )counter + 1);
    }
    while_break___4: /* CIL Label */ ;
    }
#line 218
    if (do_nums != 2) {
#line 219
      *(js->string + place) = (unsigned char )'_';
#line 220
      place ++;
    }
  }
#line 223
  js->unit_count = (unsigned int )place;
#line 224
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 226
  return ((js_string *)0);
  switch_break: /* CIL Label */ ;
  }
#line 229
  return (js);
}
}
#line 239 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
js_string *js_alpha_chars(js_string *js ) 
{ 
  js_string *tmp ;

  {
  {
#line 240
  tmp = js_anq_chars(js, 0);
  }
#line 240
  return (tmp);
}
}
#line 249 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
js_string *js_an_chars(js_string *js ) 
{ 
  js_string *tmp ;

  {
  {
#line 250
  tmp = js_anq_chars(js, 1);
  }
#line 250
  return (tmp);
}
}
#line 259 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrCP.c"
js_string *js_numbers(js_string *js ) 
{ 
  js_string *tmp ;

  {
  {
#line 260
  tmp = js_anq_chars(js, 2);
  }
#line 260
  return (tmp);
}
}
#line 27 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_esc_txt.c"
int escape_stdout_csv2(js_string *js ) 
{ 
  unsigned char this ;
  int inquote ;
  int counter ;
  int tmp ;

  {
  {
#line 29
  inquote = 0;
#line 29
  counter = 0;
#line 32
  tmp = js_has_sanity(js);
  }
#line 32
  if (tmp < 0) {
#line 33
    return (-1);
  }
#line 34
  if (js->unit_size != 1U) {
#line 35
    return (-1);
  }
#line 37
  inquote = 0;
  {
#line 39
  while (1) {
    while_continue: /* CIL Label */ ;
#line 39
    if (! ((unsigned int )counter < js->unit_count)) {
#line 39
      goto while_break;
    }
#line 40
    this = *(js->string + counter);
#line 41
    if ((int )this < 32) {
#line 41
      goto _L;
    } else
#line 41
    if ((int )this > 122) {
#line 41
      goto _L;
    } else
#line 41
    if ((int )this == 35) {
      _L: /* CIL Label */ 
#line 46
      if (inquote == 1) {
        {
#line 47
        printf((char const   */* __restrict  */)"\'");
#line 48
        inquote = 0;
        }
      }
      {
#line 50
      printf((char const   */* __restrict  */)"\\x%02x", (int )this);
      }
    } else
#line 52
    if ((int )this == 39) {
#line 53
      if (inquote == 1) {
        {
#line 54
        printf((char const   */* __restrict  */)"\'\\\'\'");
        }
      } else {
        {
#line 57
        printf((char const   */* __restrict  */)"\\\'");
        }
      }
    } else {
#line 61
      if (inquote == 0) {
        {
#line 62
        inquote = 1;
#line 63
        printf((char const   */* __restrict  */)"\'");
        }
      }
      {
#line 65
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    }
#line 67
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 70
  if (inquote == 1) {
    {
#line 71
    printf((char const   */* __restrict  */)"\'");
    }
  }
#line 74
  return (1);
}
}
#line 80 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_esc_txt.c"
void human_readable_dns_query(js_string *query , int hide_qtype ) 
{ 
  unsigned char this ;
  int counter ;
  int dlen ;
  int qtype ;
  int x ;
  unsigned char *that ;
  int tmp ;

  {
  {
#line 82
  counter = 0;
#line 82
  dlen = -1;
#line 85
  tmp = js_has_sanity(query);
  }
#line 85
  if (tmp < 0) {
    {
#line 86
    printf((char const   */* __restrict  */)":ERROR:\n");
    }
#line 87
    return;
  }
#line 89
  if (query->unit_size != 1U) {
    {
#line 90
    printf((char const   */* __restrict  */)":ERROR:\n");
    }
#line 91
    return;
  }
#line 94
  if (query->unit_count < 2U) {
    {
#line 95
    printf((char const   */* __restrict  */)":ERROR:\n");
    }
  }
#line 98
  that = query->string;
#line 99
  qtype = (int )*((that + query->unit_count) - 1);
#line 100
  qtype += (int )*((that + query->unit_count) - 2) << 8;
#line 101
  if (hide_qtype != 1) {
    {
#line 102
    printf((char const   */* __restrict  */)"%d:", qtype);
    }
  }
#line 105
  x = 0;
  {
#line 105
  while (1) {
    while_continue: /* CIL Label */ ;
#line 105
    if (! (x < 10000)) {
#line 105
      goto while_break;
    }
#line 106
    if ((unsigned int )counter > query->unit_count) {
      {
#line 107
      printf((char const   */* __restrict  */)":ERROR:105:\n");
      }
#line 108
      return;
    } else
#line 106
    if (counter < 0) {
      {
#line 107
      printf((char const   */* __restrict  */)":ERROR:105:\n");
      }
#line 108
      return;
    }
#line 110
    dlen = (int )*(query->string + counter);
#line 111
    if (dlen == 95) {
      {
#line 112
      printf((char const   */* __restrict  */)"{STAR}");
      }
#line 113
      if (counter == 0) {
#line 113
        if (query->unit_count != 3U) {
#line 116
          counter ++;
#line 117
          goto __Cont;
        } else {
#line 119
          goto while_break;
        }
      } else {
#line 119
        goto while_break;
      }
    }
#line 122
    if (dlen > 64) {
      {
#line 123
      printf((char const   */* __restrict  */)":ERROR:110:%d:\n", dlen);
      }
#line 124
      return;
    } else
#line 122
    if (dlen < 0) {
      {
#line 123
      printf((char const   */* __restrict  */)":ERROR:110:%d:\n", dlen);
      }
#line 124
      return;
    }
#line 126
    if (dlen == 0) {
#line 127
      goto while_break;
    }
    {
#line 129
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 129
      if (! (dlen > 0)) {
#line 129
        goto while_break___0;
      }
#line 130
      counter ++;
#line 131
      if ((unsigned int )counter > query->unit_count) {
        {
#line 132
        printf((char const   */* __restrict  */)":ERROR:119:\n");
        }
#line 133
        return;
      } else
#line 131
      if (counter < 0) {
        {
#line 132
        printf((char const   */* __restrict  */)":ERROR:119:\n");
        }
#line 133
        return;
      }
#line 135
      this = *(query->string + counter);
#line 136
      if ((int )this < 32) {
        {
#line 138
        printf((char const   */* __restrict  */)"\\x%02x", (int )this);
        }
      } else
#line 136
      if ((int )this > 127) {
        {
#line 138
        printf((char const   */* __restrict  */)"\\x%02x", (int )this);
        }
      } else
#line 136
      if ((int )this == 46) {
        {
#line 138
        printf((char const   */* __restrict  */)"\\x%02x", (int )this);
        }
      } else
#line 136
      if ((int )this == 58) {
        {
#line 138
        printf((char const   */* __restrict  */)"\\x%02x", (int )this);
        }
      } else {
        {
#line 140
        printf((char const   */* __restrict  */)"%c", (int )this);
        }
      }
#line 142
      dlen --;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 144
    counter ++;
#line 145
    printf((char const   */* __restrict  */)".");
    }
    __Cont: /* CIL Label */ 
#line 105
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 148
  if ((unsigned int )counter != query->unit_count - 3U) {
    {
#line 149
    printf((char const   */* __restrict  */)":ERROR:%d:%d:\n", counter, query->unit_count);
    }
  }
#line 152
  return;
}
}
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../libs/JsStr.h"
int js_set_encode(js_string *js , int encoding ) ;
#line 81
int js_append(js_string *toappend , js_string *target ) ;
#line 83
int js_substr(js_string *source , js_string *dest , int start , int count ) ;
#line 110
int js_qstr2js(js_string *js , char *string ) ;
#line 117
int show_esc_stdout(js_string *js ) ;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/../server/timestamp.h"
int show_timestamp(void) ;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress_rrdescs.h"
char *rr_descs[17]  = 
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Compress_rrdescs.h"
  {      (char *)":1|A|4|N|en;IPv4 Addresses [RFC 1035];",      (char *)":15|MX|2;D|C|en;Mail exchanger records [RFC 1035];",      (char *)":2|NS|D|C|en;NS (name server) records [RFC 1035];",      (char *)":6|SOA|D;D;4;4;4;4;4|C|en;SOA records [RFC 1035];", 
        (char *)":12|PTR|D|C|en;Reverse DNS lookup records [RFC 1035];",      (char *)":16|TXT|T;V|N|en;Text data [RFC 1035];",      (char *)":5|CNAME|D|C|en;CNAME records [RFC 1035];",      (char *)":3|MD|D|N|en;[RFC 1035];", 
        (char *)":4|MF|D|N|en;[RFC 1035];",      (char *)":7|MB|D|N|en;[RFC 1035];",      (char *)":8|MG|D|N|en;[RFC 1035];",      (char *)":9|MR|D|N|en;[RFC 1035];", 
        (char *)":14|MINFO|D;D|N|en;[RFC 1035];",      (char *)":17|RP|D;D|N|en;[RFC 1183];",      (char *)":18|AFSDB|2;D|N|en;[RFC 1183];",      (char *)":21|RT|2;D|N|en;[RFC 1183];", 
        (char *)":33|SRV|2;2;2;D|N|en;Service [RFC 2052];"};
#line 29 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/functions_dns.h"
int decompress_data(js_string *compressed , js_string *uncompressed ) ;
#line 158
int decomp_init(int alog_level ) ;
#line 31 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
rrdesc **rr_formats  ;
#line 34 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int dlog_level  =    -1;
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_message(char *message , int min_log_level ) 
{ 


  {
#line 46
  if (dlog_level >= min_log_level) {
    {
#line 47
    show_timestamp();
#line 48
    printf((char const   */* __restrict  */)"%s\n", message);
    }
  }
#line 50
  return (1);
}
}
#line 68 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
js_string *decomp_get_label(js_string *compressed , unsigned int compressed_offset ) 
{ 
  js_string *ret ;
  int counter ;
  int cplace ;
  int cplace_save ;
  int dplace ;
  int limit ;

  {
  {
#line 73
  decomp_message((char *)"Performing sanity checks on compressed string...", 5);
  }
#line 76
  if ((unsigned long )compressed == (unsigned long )((js_string *)0)) {
#line 77
    return ((js_string *)0);
  }
#line 78
  if (compressed->unit_size != 1U) {
#line 79
    return ((js_string *)0);
  }
#line 80
  if (compressed->unit_count > compressed->max_count) {
#line 81
    return ((js_string *)0);
  }
#line 82
  if (compressed_offset > compressed->unit_count) {
#line 83
    return ((js_string *)0);
  }
  {
#line 85
  decomp_message((char *)"Compressed string is sane.  Initializing variables...",
                 5);
#line 88
  cplace = (int )compressed_offset;
#line 89
  cplace_save = cplace;
#line 90
  dplace = 0;
#line 91
  counter = 0;
#line 92
  limit = 0;
#line 93
  ret = js_create(259U, 1U);
  }
#line 93
  if ((unsigned long )ret == (unsigned long )((js_string *)0)) {
#line 94
    return ((js_string *)0);
  }
  {
#line 96
  decomp_message((char *)"Variables initalized.", 5);
  }
  {
#line 99
  while (1) {
    while_continue: /* CIL Label */ ;
#line 100
    if ((unsigned int )cplace >= compressed->unit_count) {
      {
#line 101
      js_destroy(ret);
      }
#line 102
      return ((js_string *)0);
    }
#line 104
    limit ++;
#line 105
    counter = (int )*(compressed->string + cplace);
#line 107
    if (counter > 63) {
#line 107
      if (counter < 192) {
        {
#line 108
        decomp_message((char *)"Invalid length value in compressed string", 4);
#line 109
        js_destroy(ret);
        }
#line 110
        return ((js_string *)0);
      } else {
#line 107
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 112
    if (counter >= 192) {
#line 114
      if ((unsigned int )(cplace + 1) >= compressed->unit_count) {
        {
#line 115
        decomp_message((char *)"Compression pointer isn\'t fitting", 4);
#line 116
        js_destroy(ret);
        }
#line 117
        return ((js_string *)0);
      }
#line 120
      cplace_save = cplace;
#line 121
      cplace = (counter & 63) << 8;
#line 122
      cplace |= (int )*((compressed->string + cplace_save) + 1);
#line 124
      if (cplace >= cplace_save) {
        {
#line 125
        decomp_message((char *)"Compressed pointer goes forward", 4);
#line 126
        js_destroy(ret);
        }
#line 127
        return ((js_string *)0);
      }
#line 130
      if (cplace < 12) {
        {
#line 131
        decomp_message((char *)"Compressed pointer points to header", 4);
#line 132
        js_destroy(ret);
        }
#line 133
        return ((js_string *)0);
      }
    } else
#line 137
    if (counter > 0) {
#line 137
      if (counter <= 63) {
#line 138
        counter ++;
#line 139
        if ((unsigned int )(dplace + counter) >= ret->max_count) {
          {
#line 140
          decomp_message((char *)"Pointing past end of ret string", 4);
#line 141
          js_destroy(ret);
          }
#line 142
          return ((js_string *)0);
        }
#line 144
        if ((unsigned int )(cplace + counter) >= compressed->unit_count) {
          {
#line 145
          decomp_message((char *)"Pointing past end of compressed string", 4);
#line 146
          js_destroy(ret);
          }
#line 147
          return ((js_string *)0);
        }
        {
#line 149
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 149
          if (! (counter > 0)) {
#line 149
            goto while_break___0;
          }
#line 150
          *(ret->string + dplace) = *(compressed->string + cplace);
#line 151
          (ret->unit_count) ++;
#line 152
          dplace ++;
#line 153
          cplace ++;
#line 154
          counter --;
        }
        while_break___0: /* CIL Label */ ;
        }
#line 156
        counter = 100;
      } else {
#line 137
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 158
    if (counter == 0) {
#line 159
      if ((unsigned int )(dplace + counter) >= ret->max_count) {
        {
#line 160
        decomp_message((char *)"Pointing past end of the compressed string", 4);
#line 161
        js_destroy(ret);
        }
#line 162
        return ((js_string *)0);
      }
#line 164
      *(ret->string + dplace) = (unsigned char)0;
#line 165
      (ret->unit_count) ++;
    } else {
      {
#line 168
      decomp_message((char *)"This, folks, should never happen", 4);
#line 169
      js_destroy(ret);
      }
#line 170
      return ((js_string *)0);
    }
#line 99
    if (counter > 0) {
#line 99
      if (! (limit < 256)) {
#line 99
        goto while_break;
      }
    } else {
#line 99
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 174
  if (limit >= 256) {
    {
#line 175
    decomp_message((char *)"Limit exceeded when decompressing dlabel", 4);
#line 176
    js_destroy(ret);
    }
#line 177
    return ((js_string *)0);
  }
#line 182
  return (ret);
}
}
#line 202 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_append_dlabel(js_string *compressed , js_string *uncompressed , unsigned int compressed_offset ) 
{ 
  js_string *dlabel ;
  int length ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 206
  length = 0;
#line 209
  tmp = js_has_sanity(compressed);
  }
#line 209
  if (tmp != 1) {
#line 210
    return (-1);
  }
  {
#line 212
  tmp___0 = js_has_sanity(uncompressed);
  }
#line 212
  if (tmp___0 != 1) {
#line 213
    return (-1);
  }
#line 215
  if (compressed->unit_size != 1U) {
#line 216
    return (-1);
  }
#line 218
  if (uncompressed->unit_size != 1U) {
#line 219
    return (-1);
  }
#line 221
  if (compressed_offset >= compressed->unit_count) {
#line 222
    return (-1);
  }
  {
#line 226
  dlabel = decomp_get_label(compressed, compressed_offset);
  }
#line 227
  if ((unsigned long )dlabel == (unsigned long )((js_string *)0)) {
#line 228
    return (-1);
  }
  {
#line 230
  length = dlabel_length(compressed, compressed_offset);
  }
#line 231
  if (length == -1) {
    {
#line 232
    js_destroy(dlabel);
    }
#line 233
    return (-1);
  }
  {
#line 237
  tmp___1 = js_append(dlabel, uncompressed);
  }
#line 237
  if (tmp___1 == -1) {
    {
#line 238
    js_destroy(dlabel);
    }
#line 239
    return (-1);
  }
  {
#line 243
  js_destroy(dlabel);
  }
#line 244
  return (length);
}
}
#line 271 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_append_bytes(js_string *compressed , js_string *uncompressed , unsigned int compressed_offset ,
                        int length ) 
{ 
  js_string *temp ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 275
  temp = js_create((unsigned int )(length + 2), 1U);
  }
#line 275
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 276
    return (-1);
  }
#line 279
  if (compressed->unit_count < compressed_offset + (unsigned int )length) {
    {
#line 280
    js_destroy(temp);
    }
#line 281
    return (-1);
  }
  {
#line 284
  tmp = js_substr(compressed, temp, (int )compressed_offset, length);
  }
#line 284
  if (tmp != 1) {
    {
#line 285
    js_destroy(temp);
    }
#line 286
    return (-1);
  }
  {
#line 289
  tmp___0 = js_append(temp, uncompressed);
  }
#line 289
  if (tmp___0 == -1) {
    {
#line 290
    js_destroy(temp);
    }
#line 291
    return (-1);
  }
  {
#line 294
  js_destroy(temp);
  }
#line 295
  return (1);
}
}
#line 319 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_get_type_etc(js_string *compressed , js_string *uncompressed , unsigned int compressed_offset ) 
{ 
  int type ;
  int tmp ;

  {
  {
#line 324
  type = js_readuint16(compressed, compressed_offset);
#line 326
  tmp = decomp_append_bytes(compressed, uncompressed, compressed_offset, 8);
  }
#line 326
  if (tmp != 1) {
#line 328
    return (-1);
  }
#line 331
  return (type);
}
}
#line 354 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_get_rdlength(js_string *compressed , unsigned int compressed_offset ) 
{ 
  int rdlength ;

  {
  {
#line 359
  rdlength = js_readuint16(compressed, compressed_offset);
  }
#line 361
  return (rdlength);
}
}
#line 385 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_get_header(js_string *compressed , js_string *uncompressed ) 
{ 
  int qdcount ;
  int ancount ;
  int nscount ;
  int arcount ;
  int total ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 389
  tmp = js_has_sanity(compressed);
  }
#line 389
  if (tmp == -1) {
#line 390
    return (-1);
  }
  {
#line 392
  tmp___0 = js_has_sanity(uncompressed);
  }
#line 392
  if (tmp___0 == -1) {
#line 393
    return (-1);
  }
#line 395
  if (compressed->unit_count < 12U) {
#line 396
    return (-1);
  }
#line 398
  if (uncompressed->unit_count != 0U) {
#line 399
    return (-1);
  }
  {
#line 403
  qdcount = js_readuint16(compressed, 4U);
  }
#line 404
  if (qdcount < 0) {
#line 405
    return (-1);
  } else
#line 404
  if (qdcount > 1) {
#line 405
    return (-1);
  }
  {
#line 408
  ancount = js_readuint16(compressed, 6U);
  }
#line 409
  if (ancount < 0) {
#line 410
    return (-1);
  } else
#line 409
  if (ancount > 65535) {
#line 410
    return (-1);
  }
  {
#line 411
  nscount = js_readuint16(compressed, 8U);
  }
#line 412
  if (nscount < 0) {
#line 413
    return (-1);
  } else
#line 412
  if (nscount > 65535) {
#line 413
    return (-1);
  }
  {
#line 414
  arcount = js_readuint16(compressed, 10U);
  }
#line 415
  if (arcount < 0) {
#line 416
    return (-1);
  } else
#line 415
  if (arcount > 65535) {
#line 416
    return (-1);
  }
  {
#line 418
  total = (ancount + nscount) + arcount;
#line 421
  tmp___1 = decomp_append_bytes(compressed, uncompressed, 0U, 12);
  }
#line 421
  if (tmp___1 != 1) {
#line 422
    return (-1);
  }
#line 425
  if (qdcount == 0) {
#line 425
    if (total >= 1) {
#line 426
      return (-2 - total);
    }
  }
#line 429
  if (qdcount == 0) {
#line 430
    return (-2);
  }
#line 432
  return (total);
}
}
#line 453 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_get_question(js_string *compressed , js_string *uncompressed ) 
{ 
  int length ;
  int tmp ;

  {
#line 457
  if (compressed->unit_count < 12U) {
#line 458
    return (-1);
  }
#line 461
  if (uncompressed->unit_count != 12U) {
#line 462
    return (-1);
  }
  {
#line 466
  length = decomp_append_dlabel(compressed, uncompressed, 12U);
  }
#line 467
  if (length < 1) {
#line 468
    return (-1);
  }
  {
#line 472
  tmp = decomp_append_bytes(compressed, uncompressed, (unsigned int )(12 + length),
                            4);
  }
#line 472
  if (tmp != 1) {
#line 474
    return (-1);
  }
#line 477
  length += 4;
#line 479
  return (length);
}
}
#line 502 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_init_rrdesc(void) 
{ 
  int counter ;
  void *tmp ;

  {
  {
#line 505
  tmp = js_alloc(7, (int )sizeof(rrdesc *));
#line 505
  rr_formats = (rrdesc **)tmp;
  }
#line 505
  if ((unsigned long )rr_formats == (unsigned long )((rrdesc **)0)) {
#line 506
    return (-1);
  }
#line 509
  counter = 0;
  {
#line 509
  while (1) {
    while_continue: /* CIL Label */ ;
#line 509
    if (! (counter < 7)) {
#line 509
      goto while_break;
    }
#line 510
    *(rr_formats + counter) = (rrdesc *)0;
#line 509
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 512
  return (1);
}
}
#line 537 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_add_rrdesc(js_string *desc ) 
{ 
  int rtype ;
  int place ;
  int counter ;
  int fieldnum ;
  int subfieldnum ;
  unsigned char c ;
  rrdesc *new ;
  rrdesc *point ;
  int tmp ;
  void *tmp___0 ;
  char *tmp___1 ;
  void *tmp___2 ;
  unsigned int tmp___3 ;

  {
  {
#line 543
  tmp = js_has_sanity(desc);
  }
#line 543
  if (tmp != 1) {
#line 544
    return (-1);
  }
  {
#line 545
  js_set_encode(desc, 2);
#line 548
  tmp___0 = js_alloc(1, (int )sizeof(rrdesc ));
#line 548
  new = (rrdesc *)tmp___0;
  }
#line 548
  if ((unsigned long )new == (unsigned long )((rrdesc *)0)) {
#line 549
    return (-1);
  }
  {
#line 554
  tmp___2 = js_alloc(16, 1);
#line 554
  tmp___1 = (char *)tmp___2;
#line 554
  new->description = tmp___1;
  }
#line 554
  if ((unsigned long )tmp___1 == (unsigned long )((char *)0)) {
    {
#line 555
    js_dealloc((void *)new);
    }
#line 556
    return (-1);
  }
#line 559
  counter = 0;
  {
#line 559
  while (1) {
    while_continue: /* CIL Label */ ;
#line 559
    if (! (counter < 15)) {
#line 559
      goto while_break;
    }
#line 560
    *(new->description + counter) = (char)0;
#line 559
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 567
  new->tocompress = (char)79;
#line 570
  subfieldnum = 1;
#line 570
  fieldnum = subfieldnum;
#line 571
  rtype = -1;
#line 572
  counter = 0;
  {
#line 572
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 572
    if (! ((unsigned int )counter < desc->unit_count)) {
#line 572
      goto while_break___0;
    }
#line 573
    c = *(desc->string + counter);
#line 574
    if (fieldnum == 1) {
#line 575
      if (subfieldnum == 1) {
#line 576
        if ((int )c == 58) {
#line 577
          subfieldnum ++;
        }
      } else
#line 580
      if (subfieldnum == 2) {
#line 581
        if (rtype == -1) {
          {
#line 582
          tmp___3 = js_atoi(desc, counter);
#line 582
          rtype = (int )tmp___3;
          }
#line 583
          if (rtype <= 0) {
            {
#line 584
            js_dealloc((void *)new->description);
#line 585
            js_dealloc((void *)new);
            }
#line 586
            return (-1);
          } else
#line 583
          if (rtype > 65535) {
            {
#line 584
            js_dealloc((void *)new->description);
#line 585
            js_dealloc((void *)new);
            }
#line 586
            return (-1);
          }
#line 588
          new->rr_num = rtype;
        }
#line 590
        if ((int )c == 124) {
#line 591
          subfieldnum = 1;
#line 592
          fieldnum = 2;
        }
      }
    } else
#line 596
    if (fieldnum == 2) {
#line 597
      if ((int )c == 124) {
#line 598
        subfieldnum = 1;
#line 599
        fieldnum = 3;
      }
    } else
#line 602
    if (fieldnum == 3) {
#line 604
      if (subfieldnum > 14) {
        {
#line 605
        js_dealloc((void *)new->description);
#line 606
        js_dealloc((void *)new);
        }
#line 607
        return (-1);
      }
#line 612
      if ((int )*(new->description + (subfieldnum - 1)) == 0) {
#line 613
        if ((int )c >= 49) {
#line 613
          if ((int )c <= 57) {
#line 614
            *(new->description + (subfieldnum - 1)) = (char )((int )c - 48);
          } else {
#line 613
            goto _L;
          }
        } else
        _L: /* CIL Label */ 
#line 616
        if ((int )c == 68) {
#line 617
          *(new->description + (subfieldnum - 1)) = (char)64;
        } else
#line 619
        if ((int )c == 84) {
#line 620
          *(new->description + (subfieldnum - 1)) = (char)65;
        } else
#line 622
        if ((int )c == 86) {
#line 623
          *(new->description + (subfieldnum - 1)) = (char)66;
        } else {
          {
#line 626
          js_dealloc((void *)new->description);
#line 627
          js_dealloc((void *)new);
          }
#line 628
          return (-1);
        }
      } else
#line 631
      if ((int )c != 59) {
#line 631
        if ((int )c != 124) {
          {
#line 632
          js_dealloc((void *)new->description);
#line 633
          js_dealloc((void *)new);
          }
#line 634
          return (-1);
        } else {
#line 631
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 636
      if ((int )c == 59) {
#line 638
        if ((int )*(new->description + (subfieldnum - 1)) == 66) {
          {
#line 639
          js_dealloc((void *)new->description);
#line 640
          js_dealloc((void *)new);
          }
#line 641
          return (-1);
        }
#line 643
        subfieldnum ++;
      } else
#line 645
      if ((int )c == 124) {
#line 646
        subfieldnum = 1;
#line 647
        fieldnum = 4;
      } else {
        {
#line 650
        js_dealloc((void *)new->description);
#line 651
        js_dealloc((void *)new);
        }
#line 652
        return (-1);
      }
    } else
#line 655
    if (fieldnum == 4) {
#line 657
      if ((int )c == 67) {
#line 657
        if ((int )new->tocompress == 79) {
#line 658
          new->tocompress = (char)1;
        } else {
#line 657
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 660
      if ((int )c == 78) {
#line 660
        if ((int )new->tocompress == 79) {
#line 661
          new->tocompress = (char)0;
        } else {
#line 660
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 663
      if ((int )c == 124) {
#line 663
        if ((int )new->tocompress != 79) {
#line 664
          subfieldnum = 1;
#line 665
          fieldnum = 5;
        } else {
          {
#line 668
          js_dealloc((void *)new->description);
#line 669
          js_dealloc((void *)new);
          }
#line 670
          return (-4);
        }
      } else {
        {
#line 668
        js_dealloc((void *)new->description);
#line 669
        js_dealloc((void *)new);
        }
#line 670
        return (-4);
      }
    } else
#line 673
    if (fieldnum == 5) {
#line 678
      goto while_break___0;
    }
#line 572
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 685
  place = rtype % 7;
#line 686
  if ((unsigned long )rr_formats == (unsigned long )((rrdesc **)0)) {
    {
#line 687
    js_dealloc((void *)new->description);
#line 688
    js_dealloc((void *)new);
    }
#line 689
    return (-1);
  }
#line 691
  point = *(rr_formats + place);
#line 692
  if ((unsigned long )point == (unsigned long )((rrdesc *)0)) {
#line 693
    *(rr_formats + place) = new;
  } else {
    {
#line 696
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 696
      if (! ((unsigned long )point->next != (unsigned long )((struct rrdesc *)0))) {
#line 696
        goto while_break___1;
      }
#line 697
      point = point->next;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 698
    point->next = new;
  }
#line 701
  new->next = (struct rrdesc *)0;
#line 704
  return (1);
}
}
#line 728 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_init(int alog_level ) 
{ 
  js_string *temp ;
  int counter ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 733
  temp = js_create(256U, 1U);
  }
#line 733
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 734
    return (-1);
  }
  {
#line 738
  decomp_init_rrdesc();
#line 739
  counter = 0;
  }
  {
#line 739
  while (1) {
    while_continue: /* CIL Label */ ;
#line 739
    if (! (counter < 17)) {
#line 739
      goto while_break;
    }
    {
#line 740
    tmp = js_qstr2js(temp, rr_descs[counter]);
    }
#line 740
    if (tmp != 1) {
      {
#line 741
      js_destroy(temp);
      }
#line 742
      return (-1);
    }
    {
#line 744
    tmp___0 = decomp_add_rrdesc(temp);
    }
#line 744
    if (tmp___0 != 1) {
      {
#line 745
      js_destroy(temp);
      }
#line 746
      return (-1);
    }
#line 739
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 751
  dlog_level = alog_level;
#line 753
  js_destroy(temp);
  }
#line 754
  return (1);
}
}
#line 783 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
char *decomp_get_rrdesc(int rr_num ) 
{ 
  rrdesc *point ;

  {
#line 786
  if ((unsigned long )rr_formats == (unsigned long )((rrdesc **)0)) {
#line 787
    return ((char *)0);
  }
#line 789
  point = *(rr_formats + rr_num % 7);
#line 790
  if ((unsigned long )point == (unsigned long )((rrdesc *)0)) {
#line 791
    return ((char *)0);
  }
  {
#line 793
  while (1) {
    while_continue: /* CIL Label */ ;
#line 793
    if (! (point->rr_num != rr_num)) {
#line 793
      goto while_break;
    }
#line 794
    point = point->next;
#line 795
    if ((unsigned long )point == (unsigned long )((rrdesc *)0)) {
#line 796
      return ((char *)0);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return (point->description);
}
}
#line 823 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_get_rddata(js_string *compressed , js_string *out , unsigned int compressed_offset ,
                      int type , int rdlength ) 
{ 
  char *desc ;
  int subtype ;
  int total ;
  int len ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 829
  desc = decomp_get_rrdesc(type);
  }
#line 831
  if ((unsigned long )desc == (unsigned long )((char *)0)) {
#line 832
    if (rdlength == 0) {
#line 833
      return (1);
    }
    {
#line 835
    tmp = decomp_append_bytes(compressed, out, compressed_offset, rdlength);
    }
#line 835
    if (tmp != 1) {
#line 837
      return (-1);
    } else {
#line 840
      return (1);
    }
  } else {
#line 844
    subtype = (int )*desc;
#line 845
    total = 0;
    {
#line 847
    while (1) {
      while_continue: /* CIL Label */ ;
#line 847
      if (! (subtype != 0)) {
#line 847
        goto while_break;
      }
#line 849
      if (subtype > 0) {
#line 849
        if (subtype < 64) {
          {
#line 850
          tmp___0 = decomp_append_bytes(compressed, out, compressed_offset, subtype);
          }
#line 850
          if (tmp___0 != 1) {
#line 852
            return (-1);
          }
#line 854
          total += subtype;
#line 855
          compressed_offset += (unsigned int )subtype;
        } else {
#line 849
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 858
      if (subtype == 64) {
        {
#line 859
        len = decomp_append_dlabel(compressed, out, compressed_offset);
        }
#line 861
        if (len == -1) {
#line 862
          return (-1);
        }
#line 864
        total += len;
#line 865
        compressed_offset += (unsigned int )len;
      } else
#line 868
      if (subtype == 65) {
#line 870
        len = (int )*(compressed->string + compressed_offset);
#line 871
        len ++;
#line 873
        if (len < 0) {
#line 874
          return (-1);
        } else
#line 873
        if (len > 256) {
#line 874
          return (-1);
        }
        {
#line 876
        tmp___1 = decomp_append_bytes(compressed, out, compressed_offset, len);
        }
#line 876
        if (tmp___1 != 1) {
#line 879
          return (-1);
        }
#line 881
        total += len;
#line 882
        compressed_offset += (unsigned int )len;
      } else
#line 885
      if (subtype == 66) {
#line 886
        len = rdlength - total;
#line 887
        if (len == 0) {
#line 888
          goto while_break;
        }
        {
#line 890
        tmp___2 = decomp_append_bytes(compressed, out, compressed_offset, len);
        }
#line 890
        if (tmp___2 != 1) {
#line 892
          return (-1);
        }
#line 894
        total += len;
#line 895
        compressed_offset += (unsigned int )len;
      } else {
#line 898
        return (-1);
      }
#line 900
      desc ++;
#line 902
      if (subtype != 66) {
#line 903
        subtype = (int )*desc;
      } else {
#line 905
        subtype = 0;
      }
    }
    while_break: /* CIL Label */ ;
    }
#line 908
    if (rdlength != total) {
#line 909
      return (-1);
    }
  }
#line 914
  return (1);
}
}
#line 934 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decomp_decompress_packet(js_string *compressed , js_string *uncompressed ) 
{ 
  int answers ;
  int type ;
  int rdlength ;
  int offset ;
  int length ;
  js_string *rddata ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 943
  tmp = js_has_sanity(compressed);
  }
#line 943
  if (tmp == -1) {
#line 944
    return (-1);
  }
  {
#line 945
  tmp___0 = js_has_sanity(uncompressed);
  }
#line 945
  if (tmp___0 == -1) {
#line 946
    return (-1);
  }
#line 947
  if (compressed->unit_size != 1U) {
#line 948
    return (-1);
  } else
#line 947
  if (uncompressed->unit_size != 1U) {
#line 948
    return (-1);
  }
#line 949
  if (uncompressed->unit_count != 0U) {
#line 950
    return (-1);
  }
  {
#line 958
  rddata = js_create(4512U, 1U);
  }
#line 958
  if ((unsigned long )rddata == (unsigned long )((js_string *)0)) {
#line 959
    return (-1);
  }
  {
#line 964
  answers = decomp_get_header(compressed, uncompressed);
  }
#line 965
  if (answers == -2) {
    {
#line 966
    js_destroy(rddata);
    }
#line 967
    return (1);
  } else
#line 969
  if (answers == -1) {
    {
#line 970
    js_destroy(rddata);
    }
#line 971
    return (-1);
  }
#line 975
  if (answers <= -3) {
#line 976
    answers = -2 - answers;
#line 978
    length = 0;
  } else {
    {
#line 981
    length = decomp_get_question(compressed, uncompressed);
    }
#line 982
    if (length < 1) {
      {
#line 983
      js_destroy(rddata);
      }
#line 984
      return (-1);
    }
  }
#line 988
  offset = 12 + length;
  {
#line 991
  while (1) {
    while_continue: /* CIL Label */ ;
#line 991
    if (! (answers > 0)) {
#line 991
      goto while_break;
    }
    {
#line 992
    length = decomp_append_dlabel(compressed, uncompressed, (unsigned int )offset);
    }
#line 993
    if (length < 1) {
      {
#line 994
      js_destroy(rddata);
      }
#line 995
      return (-1);
    }
    {
#line 997
    offset += length;
#line 998
    type = decomp_get_type_etc(compressed, uncompressed, (unsigned int )offset);
    }
#line 999
    if (type == -1) {
      {
#line 1000
      js_destroy(rddata);
      }
#line 1001
      return (-1);
    }
    {
#line 1003
    offset += 8;
#line 1004
    rdlength = decomp_get_rdlength(compressed, (unsigned int )offset);
    }
#line 1005
    if (rdlength == -1) {
      {
#line 1006
      js_destroy(rddata);
      }
#line 1007
      return (-1);
    }
    {
#line 1009
    offset += 2;
#line 1011
    rddata->unit_count = 0U;
#line 1012
    tmp___1 = decomp_get_rddata(compressed, rddata, (unsigned int )offset, type, rdlength);
    }
#line 1012
    if (tmp___1 != 1) {
      {
#line 1014
      js_destroy(rddata);
      }
#line 1015
      return (-1);
    }
    {
#line 1018
    tmp___2 = js_adduint16(uncompressed, (int )rddata->unit_count);
    }
#line 1018
    if (tmp___2 == -1) {
      {
#line 1019
      js_destroy(rddata);
      }
#line 1020
      return (-1);
    }
    {
#line 1023
    tmp___3 = js_append(rddata, uncompressed);
    }
#line 1023
    if (tmp___3 == -1) {
      {
#line 1024
      js_destroy(rddata);
      }
#line 1025
      return (-1);
    }
#line 1027
    offset += rdlength;
#line 1028
    answers --;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1031
  js_destroy(rddata);
  }
#line 1032
  return (1);
}
}
#line 1050 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
int decompress_data(js_string *compressed , js_string *uncompressed ) 
{ 
  int tmp ;

  {
#line 1052
  uncompressed->unit_count = 0U;
#line 1054
  if (dlog_level >= 5) {
    {
#line 1055
    printf((char const   */* __restrict  */)"About to decompress packet: ");
#line 1056
    show_esc_stdout(compressed);
#line 1057
    printf((char const   */* __restrict  */)"\n");
    }
  }
#line 1060
  if (dlog_level == -1) {
#line 1061
    return (-1);
  } else {
    {
#line 1064
    tmp = decomp_decompress_packet(compressed, uncompressed);
    }
#line 1064
    return (tmp);
  }
#line 1068
  return (-1);
}
}
#line 1075 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Decompress.c"
rrdesc **decomp_export_rrformats(void) 
{ 


  {
#line 1076
  return (rr_formats);
}
}
#line 73 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/JsStr.h"
int js_str2js(js_string *js , char *string , int count , int size ) ;
#line 75
int js_issame(js_string *js1 , js_string *js2 ) ;
#line 78
int js_match(js_string *exp , js_string *js ) ;
#line 79
int js_match_offset(js_string *exp , js_string *js , int offset ) ;
#line 84
int js_notmatch_offset(js_string *exp , js_string *js , int offset ) ;
#line 85
int js_notmatch(js_string *exp , js_string *js ) ;
#line 92
int js_length(js_string *js ) ;
#line 100
int js_show_stdout(js_string *js ) ;
#line 103
int js_open_read(js_string *filename , js_file *desc ) ;
#line 106
int js_close(js_file *desc ) ;
#line 107
int js_buf_eof(js_file *desc ) ;
#line 109
int js_buf_getline(js_file *desc , js_string *js ) ;
#line 58 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/MaraHash.h"
mhash *mhash_create(int hash_bits ) ;
#line 63
int mhash_put_js(mhash *hash , js_string *key___6 , js_string *value___6 ) ;
#line 64
js_string *mhash_get_js(mhash *hash , js_string *key___6 ) ;
#line 21 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/functions_MaraHash.h"
int mhash_autogrow(mhash *hash ) ;
#line 40
void *mhash_undef(mhash *hash , js_string *key___6 ) ;
#line 147 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strncmp)(char const   *__s1 ,
                                                                                                char const   *__s2 ,
                                                                                                size_t __n )  __attribute__((__pure__)) ;
#line 36 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
char *keywords[56]  = 
#line 36 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
  {      (char *)"bind_address",      (char *)"ipv4_bind_addresses",      (char *)"ipv6_bind_address",      (char *)"csv2_synthip_list", 
        (char *)"chroot_dir",      (char *)"debug_response_delay",      (char *)"debug_msg_level",      (char *)"default_rrany_set", 
        (char *)"hide_disclaimer",      (char *)"maradns_uid",      (char *)"maradns_gid",      (char *)"maradns_user", 
        (char *)"max_ar_chain",      (char *)"max_chain",      (char *)"max_glueless_level",      (char *)"max_queries_total", 
        (char *)"max_tcp_procs",      (char *)"max_total",      (char *)"maximum_cache_elements",      (char *)"maxprocs", 
        (char *)"min_ttl_cname",      (char *)"min_ttl",      (char *)"min_visible_ttl",      (char *)"no_fingerprint", 
        (char *)"random_seed_file",      (char *)"recursive_acl",      (char *)"spammers",      (char *)"timeout_seconds", 
        (char *)"timestamp_type",      (char *)"verbose_level",      (char *)"tcp_convert_acl",      (char *)"tcp_convert_server", 
        (char *)"tcp_convert_recursion",      (char *)"reject_aaaa",      (char *)"reject_ptr",      (char *)"verbose_query", 
        (char *)"csv2_default_zonefile",      (char *)"dos_protection_level",      (char *)"no_cname_warnings",      (char *)"long_packet_ipv4", 
        (char *)"synth_soa_origin",      (char *)"synth_soa_serial",      (char *)"bind_star_handling",      (char *)"admin_acl", 
        (char *)"remote_admin",      (char *)"handle_noreply",      (char *)"retry_cycles",      (char *)"csv2_tilde_handling", 
        (char *)"dns_port",      (char *)"upstream_port",      (char *)"recurse_delegation",      (char *)"recurse_min_bind_port", 
        (char *)"recurse_number_ports",      (char *)"max_mem",      (char *)"notthere_ip",      (char *)"zone_transfer_acl"};
#line 155 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int mara_goodjs(js_string *test ) 
{ 
  int tmp ;

  {
  {
#line 156
  tmp = js_has_sanity(test);
  }
#line 156
  if (tmp == -1) {
#line 157
    return (-1);
  }
#line 159
  if (test->unit_size != 1U) {
#line 160
    return (-1);
  }
#line 161
  return (1);
}
}
#line 167 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int is_numeric_js(js_string *test ) 
{ 
  int counter ;
  int tmp ;

  {
  {
#line 169
  tmp = mara_goodjs(test);
  }
#line 169
  if (! tmp) {
#line 170
    return (-1);
  }
#line 172
  if (test->unit_count > test->max_count) {
#line 173
    return (-1);
  }
#line 175
  if (test->unit_count == 0U) {
#line 176
    return (0);
  }
#line 177
  counter = 0;
  {
#line 177
  while (1) {
    while_continue: /* CIL Label */ ;
#line 177
    if (! ((unsigned int )counter < test->unit_count)) {
#line 177
      goto while_break;
    }
#line 178
    if ((int )*(test->string + counter) < 48) {
#line 180
      return (0);
    } else
#line 178
    if ((int )*(test->string + counter) > 57) {
#line 180
      return (0);
    }
#line 177
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 182
  return (1);
}
}
#line 185 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
js_string *kvar[56]  ;
#line 194 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int keyword2num(js_string *keyword ) 
{ 
  int counter ;
  js_string *name ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 195
  counter = 0;
#line 198
  tmp = mara_goodjs(keyword);
  }
#line 198
  if (tmp == -1) {
#line 199
    return (-1);
  }
  {
#line 201
  name = js_create(256U, 1U);
  }
#line 201
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
#line 202
    return (-1);
  }
  {
#line 204
  js_set_encode(name, 3);
  }
  {
#line 206
  while (1) {
    while_continue: /* CIL Label */ ;
#line 206
    if (! (counter < 56)) {
#line 206
      goto while_break;
    }
    {
#line 207
    tmp___0 = js_qstr2js(name, keywords[counter]);
    }
#line 207
    if (tmp___0 == -1) {
      {
#line 208
      js_destroy(name);
      }
#line 209
      return (-1);
    }
    {
#line 211
    js_set_encode(name, 3);
#line 213
    js_set_encode(keyword, 3);
#line 214
    tmp___1 = js_issame(keyword, name);
    }
#line 214
    if (tmp___1) {
      {
#line 215
      js_destroy(name);
      }
#line 216
      return (counter);
    }
#line 218
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 221
  js_destroy(name);
  }
#line 222
  return (-2);
}
}
#line 231 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int num2keyword(int num , js_string *keyword ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 232
  tmp = mara_goodjs(keyword);
  }
#line 232
  if (tmp == -1) {
#line 233
    return (-1);
  }
#line 235
  if (num < 0) {
#line 236
    return (-1);
  } else
#line 235
  if (num >= 56) {
#line 236
    return (-1);
  }
  {
#line 238
  tmp___0 = js_qstr2js(keyword, keywords[num]);
  }
#line 238
  return (tmp___0);
}
}
#line 246 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int init_kvars(void) 
{ 
  int counter ;
  js_string *tmp ;

  {
#line 248
  counter = 0;
  {
#line 248
  while (1) {
    while_continue: /* CIL Label */ ;
#line 248
    if (! (counter < 56)) {
#line 248
      goto while_break;
    }
    {
#line 249
    tmp = js_create(256U, 1U);
#line 249
    kvar[counter] = tmp;
    }
#line 249
    if ((unsigned long )tmp == (unsigned long )((js_string *)0)) {
#line 250
      return (-1);
    }
    {
#line 251
    js_set_encode(kvar[counter], 3);
#line 248
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 253
  return (1);
}
}
#line 265 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int read_kvar(js_string *name , js_string *value___6 ) 
{ 
  int num ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 270
  tmp = mara_goodjs(name);
  }
#line 270
  if (tmp == -1) {
#line 271
    return (-1);
  }
  {
#line 272
  tmp___0 = mara_goodjs(value___6);
  }
#line 272
  if (tmp___0 == -1) {
#line 273
    return (-1);
  }
  {
#line 276
  num = keyword2num(name);
  }
#line 277
  if (num == -1) {
#line 278
    return (-1);
  }
#line 281
  if (num == -2) {
#line 282
    return (num);
  }
  {
#line 285
  tmp___1 = js_copy(kvar[num], value___6);
  }
#line 285
  if (tmp___1 == -1) {
#line 286
    return (-1);
  }
  {
#line 289
  tmp___2 = js_length(kvar[num]);
  }
#line 289
  if (tmp___2 == 0) {
#line 290
    return (0);
  }
#line 292
  return (1);
}
}
#line 302 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int write_kvar(js_string *name , js_string *value___6 , int is_plus ) 
{ 
  int num ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 305
  num = keyword2num(name);
#line 308
  tmp = mara_goodjs(name);
  }
#line 308
  if (tmp == -1) {
#line 309
    return (-1);
  }
  {
#line 310
  tmp___0 = mara_goodjs(value___6);
  }
#line 310
  if (tmp___0 == -1) {
#line 311
    return (-1);
  }
#line 312
  if (num == -1) {
#line 313
    return (-1);
  }
#line 316
  if (num == -2) {
#line 317
    return (num);
  }
#line 320
  if (is_plus != 1) {
    {
#line 321
    tmp___1 = js_copy(value___6, kvar[num]);
    }
#line 321
    if (tmp___1 == -1) {
#line 322
      return (-1);
    }
  } else {
    {
#line 325
    tmp___2 = is_numeric_js(kvar[num]);
    }
#line 325
    if (tmp___2 == 1) {
#line 326
      return (-5);
    }
    {
#line 328
    tmp___3 = js_length(kvar[num]);
    }
#line 328
    if (tmp___3 == 0) {
#line 329
      return (-4);
    }
    {
#line 331
    tmp___4 = js_append(value___6, kvar[num]);
    }
#line 331
    if (tmp___4 == -1) {
#line 332
      return (-1);
    }
  }
#line 336
  return (1);
}
}
#line 344 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
char *dkeywords[6]  = {      (char *)"csv1",      (char *)"csv2",      (char *)"root_servers",      (char *)"upstream_servers", 
        (char *)"ipv4_alias",      (char *)"future"};
#line 351 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
mhash *dvar[6]  ;
#line 358 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
mhash *dvar_raw(int index___0 ) 
{ 


  {
#line 359
  if (index___0 < 0) {
#line 360
    return ((mhash *)0);
  } else
#line 359
  if (index___0 > 6) {
#line 360
    return ((mhash *)0);
  }
#line 361
  return (dvar[index___0]);
}
}
#line 371 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int dq_keyword2n(char *in ) 
{ 
  int counter ;
  int tmp ;

  {
#line 373
  counter = 0;
  {
#line 373
  while (1) {
    while_continue: /* CIL Label */ ;
#line 373
    if (! (counter < 6)) {
#line 373
      goto while_break;
    }
    {
#line 374
    tmp = strncmp((char const   *)in, (char const   *)dkeywords[counter], (size_t )128);
    }
#line 374
    if (! tmp) {
#line 375
      return (counter);
    }
#line 373
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 377
  return (-2);
}
}
#line 387 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int dkeyword2num(js_string *keyword ) 
{ 
  int counter ;
  js_string *name ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 388
  counter = 0;
#line 391
  tmp = mara_goodjs(keyword);
  }
#line 391
  if (tmp == -1) {
#line 392
    return (-1);
  }
  {
#line 394
  name = js_create(256U, 1U);
  }
#line 394
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
#line 395
    return (-1);
  }
  {
#line 397
  js_set_encode(name, 3);
  }
  {
#line 399
  while (1) {
    while_continue: /* CIL Label */ ;
#line 399
    if (! (counter < 6)) {
#line 399
      goto while_break;
    }
    {
#line 400
    tmp___0 = js_qstr2js(name, dkeywords[counter]);
    }
#line 400
    if (tmp___0 == -1) {
      {
#line 401
      js_destroy(name);
      }
#line 402
      return (-1);
    }
    {
#line 404
    tmp___1 = js_issame(keyword, name);
    }
#line 404
    if (tmp___1) {
      {
#line 405
      js_destroy(name);
      }
#line 406
      return (counter);
    }
#line 408
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 411
  js_destroy(name);
  }
#line 412
  return (-2);
}
}
#line 421 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int num2dkeyword(int num , js_string *keyword ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 422
  tmp = mara_goodjs(keyword);
  }
#line 422
  if (tmp == -1) {
#line 423
    return (-1);
  }
#line 425
  if (num < 0) {
#line 426
    return (-1);
  } else
#line 425
  if (num >= 6) {
#line 426
    return (-1);
  }
  {
#line 428
  tmp___0 = js_qstr2js(keyword, dkeywords[num]);
  }
#line 428
  return (tmp___0);
}
}
#line 436 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int init_dvars(void) 
{ 
  int counter ;

  {
#line 439
  counter = 0;
  {
#line 439
  while (1) {
    while_continue: /* CIL Label */ ;
#line 439
    if (! (counter < 6)) {
#line 439
      goto while_break;
    }
#line 440
    dvar[counter] = (mhash *)0;
#line 439
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 442
  return (1);
}
}
#line 450 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int new_dvar(js_string *name ) 
{ 
  int num ;
  mhash *tmp ;

  {
  {
#line 452
  num = dkeyword2num(name);
  }
#line 453
  if ((unsigned long )dvar[num] != (unsigned long )((mhash *)0)) {
#line 454
    return (-1);
  } else
#line 453
  if (num < 0) {
#line 454
    return (-1);
  } else
#line 453
  if (num > 6) {
#line 454
    return (-1);
  }
  {
#line 455
  tmp = mhash_create(7);
#line 455
  dvar[num] = tmp;
  }
#line 455
  if ((unsigned long )tmp == (unsigned long )((mhash *)0)) {
#line 456
    return (-1);
  }
#line 458
  return (1);
}
}
#line 467 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int read_dvar(js_string *name , js_string *key___6 , js_string *value___6 ) 
{ 
  int num ;
  js_string *place ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 471
  num = dkeyword2num(name);
#line 474
  tmp = mara_goodjs(name);
  }
#line 474
  if (tmp == -1) {
#line 475
    return (-1);
  }
  {
#line 476
  tmp___0 = mara_goodjs(key___6);
  }
#line 476
  if (tmp___0 == -1) {
#line 477
    return (-1);
  }
  {
#line 478
  tmp___1 = mara_goodjs(value___6);
  }
#line 478
  if (tmp___1 == -1) {
#line 479
    return (-1);
  }
#line 480
  if (num == -1) {
#line 481
    return (-1);
  }
#line 482
  if ((unsigned long )dvar[num] == (unsigned long )((mhash *)0)) {
#line 483
    return (-1);
  } else
#line 482
  if (num < 0) {
#line 483
    return (-1);
  } else
#line 482
  if (num > 6) {
#line 483
    return (-1);
  }
#line 486
  if (num == -2) {
#line 487
    return (num);
  }
  {
#line 490
  place = mhash_get_js(dvar[num], key___6);
  }
#line 495
  if ((unsigned long )place == (unsigned long )((js_string *)0)) {
#line 496
    return (-1);
  }
  {
#line 499
  tmp___2 = js_copy(place, value___6);
  }
#line 499
  if (tmp___2 == -1) {
#line 500
    return (-1);
  }
#line 502
  return (1);
}
}
#line 517 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int write_dvar(js_string *name , js_string *key___6 , js_string *value___6 , int is_plus ) 
{ 
  int num ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int y ;
  int z ;
  js_string *tmp___2 ;
  int tmp___3 ;
  js_string *see ;
  js_string *base ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;

  {
  {
#line 522
  num = dkeyword2num(name);
#line 525
  tmp = mara_goodjs(name);
  }
#line 525
  if (tmp == -1) {
#line 526
    return (-1);
  }
  {
#line 527
  tmp___0 = mara_goodjs(key___6);
  }
#line 527
  if (tmp___0 == -1) {
#line 528
    return (-1);
  }
  {
#line 529
  tmp___1 = mara_goodjs(value___6);
  }
#line 529
  if (tmp___1 == -1) {
#line 530
    return (-1);
  }
#line 531
  if (num == -1) {
#line 532
    return (-1);
  }
#line 533
  if ((unsigned long )dvar[num] == (unsigned long )((mhash *)0)) {
#line 534
    return (-6);
  }
#line 535
  if (num < 0) {
#line 536
    return (-1);
  } else
#line 535
  if (num > 6) {
#line 536
    return (-1);
  }
#line 539
  if (num == -2) {
#line 540
    return (num);
  }
#line 544
  if (num <= 3) {
#line 546
    y = 0;
#line 547
    z = 0;
    {
#line 547
    while (1) {
      while_continue: /* CIL Label */ ;
#line 547
      if (! ((unsigned int )z < key___6->unit_count)) {
#line 547
        goto while_break;
      }
#line 548
      if ((int )*(key___6->string + z) <= 90) {
#line 548
        if ((int )*(key___6->string + z) >= 65) {
#line 549
          y = 1;
#line 550
          *(key___6->string + z) = (unsigned char )((int )*(key___6->string + z) + 32);
        }
      }
#line 547
      z ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 553
    if (y == 1) {
#line 554
      if (num <= 1) {
        {
#line 555
        printf((char const   */* __restrict  */)"csv%d zone name ", num + 1);
        }
      } else
#line 556
      if (num == 2) {
        {
#line 557
        printf((char const   */* __restrict  */)"root_servers name ");
        }
      } else
#line 558
      if (num == 3) {
        {
#line 559
        printf((char const   */* __restrict  */)"upstream_servers name ");
        }
      } else {
        {
#line 561
        printf((char const   */* __restrict  */)"unknown num %d name ", num);
        }
      }
      {
#line 563
      show_esc_stdout(key___6);
#line 564
      printf((char const   */* __restrict  */)" had upper-case letters.  Converted.\n");
      }
    }
  }
  {
#line 569
  tmp___2 = mhash_get_js(dvar[num], key___6);
  }
#line 569
  if ((unsigned long )tmp___2 != (unsigned long )((js_string *)0)) {
#line 569
    if (is_plus != 1) {
#line 570
      return (-3);
    }
  }
#line 573
  if (is_plus != 1) {
    {
#line 574
    tmp___3 = mhash_put_js(dvar[num], key___6, value___6);
    }
#line 574
    if (tmp___3 == -1) {
#line 575
      return (-1);
    }
  } else {
    {
#line 578
    base = mhash_get_js(dvar[num], key___6);
    }
#line 578
    if ((unsigned long )base == (unsigned long )((js_string *)0)) {
#line 579
      return (-4);
    }
    {
#line 581
    tmp___4 = is_numeric_js(base);
    }
#line 581
    if (tmp___4 == 1) {
#line 582
      return (-5);
    }
    {
#line 584
    see = js_create(256U, 1U);
    }
#line 584
    if ((unsigned long )see == (unsigned long )((js_string *)0)) {
#line 585
      return (-1);
    }
    {
#line 587
    tmp___5 = js_set_encode(see, 3);
    }
#line 587
    if (tmp___5 == -1) {
#line 588
      return (-1);
    }
    {
#line 590
    tmp___6 = js_copy(base, see);
    }
#line 590
    if (tmp___6 == -1) {
#line 591
      return (-1);
    }
    {
#line 593
    tmp___7 = js_append(value___6, see);
    }
#line 593
    if (tmp___7 == -1) {
      {
#line 594
      js_destroy(see);
      }
#line 595
      return (-1);
    }
    {
#line 597
    tmp___8 = js_copy(see, value___6);
    }
#line 597
    if (tmp___8 == -1) {
      {
#line 598
      js_destroy(see);
      }
#line 599
      return (-1);
    }
    {
#line 601
    js_destroy(see);
#line 602
    tmp___9 = mhash_undef(dvar[num], key___6);
#line 602
    see = (js_string *)tmp___9;
    }
#line 602
    if ((unsigned long )see == (unsigned long )((js_string *)0)) {
#line 603
      return (-1);
    }
    {
#line 605
    js_destroy(see);
#line 606
    tmp___10 = mhash_put_js(dvar[num], key___6, value___6);
    }
#line 606
    if (tmp___10 == -1) {
#line 607
      return (-1);
    }
  }
  {
#line 612
  tmp___11 = mhash_autogrow(dvar[num]);
  }
#line 612
  return (tmp___11);
}
}
#line 633
int parseline(js_string *line___6 , js_string *var___6 , js_string *key___6 , js_string *value___6 ,
              int *do_plus ) ;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq  =    (js_string *)0;
#line 630 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int parseline(js_string *line___6 , js_string *var___6 , js_string *key___6 , js_string *value___6 ,
              int *do_plus ) 
{ 
  int quote1 ;
  int quote2 ;
  int quote3 ;
  int quote4 ;
  int varstart ;
  int varend ;
  int valstart ;
  int valend ;
  int equalp ;
  int hashp ;
  int tempp ;
  int ret ;
  char quote ;
  char plus ;
  char equal ;
  char hash ;
  char left ;
  char right ;
  char cleft ;
  char cright ;
  char bslash ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int q ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;

  {
#line 644
  ret = 1;
#line 645
  quote = (char )'\"';
#line 646
  plus = (char )'+';
#line 647
  equal = (char )'=';
#line 648
  hash = (char )'#';
#line 649
  left = (char )'[';
#line 650
  right = (char )']';
#line 651
  cleft = (char )'{';
#line 652
  cright = (char )'}';
#line 653
  bslash = (char )'\\';
#line 655
  if ((unsigned long )do_plus != (unsigned long )((int *)0)) {
#line 656
    *do_plus = 0;
  }
  {
#line 659
  tmp = mara_goodjs(line___6);
  }
#line 659
  if (tmp == -1) {
#line 660
    return (-1);
  }
  {
#line 661
  tmp___0 = mara_goodjs(var___6);
  }
#line 661
  if (tmp___0 == -1) {
#line 662
    return (-1);
  }
  {
#line 663
  tmp___1 = mara_goodjs(key___6);
  }
#line 663
  if (tmp___1 == -1) {
#line 664
    return (-1);
  }
  {
#line 665
  tmp___2 = mara_goodjs(value___6);
  }
#line 665
  if (tmp___2 == -1) {
#line 666
    return (-1);
  }
#line 668
  if ((unsigned long )quotes == (unsigned long )((js_string *)0)) {
    {
#line 669
    quotes = js_create(256U, 1U);
    }
#line 669
    if ((unsigned long )quotes == (unsigned long )((js_string *)0)) {
#line 670
      return (-1);
    }
  }
#line 671
  if ((unsigned long )numbers == (unsigned long )((js_string *)0)) {
    {
#line 672
    numbers = js_create(256U, 1U);
    }
#line 672
    if ((unsigned long )numbers == (unsigned long )((js_string *)0)) {
#line 673
      return (-1);
    }
  }
#line 674
  if ((unsigned long )alphanumeric == (unsigned long )((js_string *)0)) {
    {
#line 675
    alphanumeric = js_create(256U, 1U);
    }
#line 675
    if ((unsigned long )alphanumeric == (unsigned long )((js_string *)0)) {
#line 676
      return (-1);
    }
  }
#line 677
  if ((unsigned long )plusq == (unsigned long )((js_string *)0)) {
    {
#line 678
    plusq = js_create(256U, 1U);
    }
#line 678
    if ((unsigned long )plusq == (unsigned long )((js_string *)0)) {
#line 679
      return (-1);
    }
  }
#line 681
  if ((unsigned long )equals == (unsigned long )((js_string *)0)) {
    {
#line 682
    equals = js_create(256U, 1U);
    }
#line 682
    if ((unsigned long )equals == (unsigned long )((js_string *)0)) {
#line 683
      return (-1);
    }
  }
#line 684
  if ((unsigned long )hashq == (unsigned long )((js_string *)0)) {
    {
#line 685
    hashq = js_create(256U, 1U);
    }
#line 685
    if ((unsigned long )hashq == (unsigned long )((js_string *)0)) {
#line 686
      return (-1);
    }
  }
#line 687
  if ((unsigned long )bslashq == (unsigned long )((js_string *)0)) {
    {
#line 688
    bslashq = js_create(256U, 1U);
    }
#line 688
    if ((unsigned long )bslashq == (unsigned long )((js_string *)0)) {
#line 689
      return (-1);
    }
  }
#line 690
  if ((unsigned long )allq == (unsigned long )((js_string *)0)) {
    {
#line 691
    allq = js_create(256U, 1U);
    }
#line 691
    if ((unsigned long )allq == (unsigned long )((js_string *)0)) {
#line 692
      return (-1);
    }
  }
#line 693
  if ((unsigned long )leftq == (unsigned long )((js_string *)0)) {
    {
#line 694
    leftq = js_create(256U, 1U);
    }
#line 694
    if ((unsigned long )leftq == (unsigned long )((js_string *)0)) {
#line 695
      return (-1);
    }
  }
#line 696
  if ((unsigned long )rightq == (unsigned long )((js_string *)0)) {
    {
#line 697
    rightq = js_create(256U, 1U);
    }
#line 697
    if ((unsigned long )rightq == (unsigned long )((js_string *)0)) {
#line 698
      return (-1);
    }
  }
#line 699
  if ((unsigned long )cleftq == (unsigned long )((js_string *)0)) {
    {
#line 700
    cleftq = js_create(256U, 1U);
    }
#line 700
    if ((unsigned long )cleftq == (unsigned long )((js_string *)0)) {
#line 701
      return (-1);
    }
  }
#line 702
  if ((unsigned long )crightq == (unsigned long )((js_string *)0)) {
    {
#line 703
    crightq = js_create(256U, 1U);
    }
#line 703
    if ((unsigned long )crightq == (unsigned long )((js_string *)0)) {
#line 704
      return (-1);
    }
  }
#line 705
  if ((unsigned long )blankq == (unsigned long )((js_string *)0)) {
    {
#line 706
    blankq = js_create(256U, 1U);
    }
#line 706
    if ((unsigned long )blankq == (unsigned long )((js_string *)0)) {
#line 707
      return (-1);
    }
  }
  {
#line 710
  js_str2js(equals, & equal, 1, 1);
#line 711
  js_str2js(plusq, & plus, 1, 1);
#line 712
  js_str2js(hashq, & hash, 1, 1);
#line 713
  js_str2js(bslashq, & bslash, 1, 1);
#line 714
  js_str2js(leftq, & left, 1, 1);
#line 715
  js_str2js(rightq, & right, 1, 1);
#line 716
  js_str2js(cleftq, & cleft, 1, 1);
#line 717
  js_str2js(crightq, & cright, 1, 1);
#line 718
  js_set_encode(alphanumeric, 3);
#line 719
  js_set_encode(numbers, 3);
#line 720
  js_set_encode(blankq, 3);
#line 721
  js_an_chars(alphanumeric);
#line 722
  js_numbers(numbers);
#line 723
  js_space_chars(blankq);
#line 725
  js_set_encode(allq, 3);
#line 726
  js_set_encode(quotes, 3);
#line 727
  js_space_chars(allq);
#line 729
  js_newline_chars(quotes);
#line 730
  js_append(quotes, allq);
#line 731
  js_append(quotes, blankq);
#line 733
  js_str2js(quotes, & quote, 1, 1);
#line 734
  js_append(quotes, allq);
#line 735
  js_append(equals, allq);
#line 736
  js_append(plusq, allq);
#line 737
  js_append(hashq, allq);
#line 738
  js_append(bslashq, allq);
#line 739
  js_append(alphanumeric, allq);
#line 740
  js_append(leftq, allq);
#line 741
  js_append(rightq, allq);
#line 742
  js_append(cleftq, allq);
#line 743
  js_append(crightq, allq);
#line 746
  js_qstr2js(var___6, (char *)"");
#line 747
  js_qstr2js(value___6, (char *)"");
#line 749
  js_qstr2js(key___6, (char *)"NOTHASH");
#line 752
  quote4 = -2;
#line 752
  quote3 = quote4;
#line 752
  quote2 = quote3;
#line 752
  quote1 = quote2;
#line 758
  hashp = js_match(hashq, line___6);
  }
#line 758
  if (hashp == -1) {
#line 759
    return (-1);
  }
  {
#line 760
  tempp = js_notmatch(blankq, line___6);
  }
#line 761
  if (tempp == -1) {
#line 762
    return (-1);
  }
#line 763
  if (tempp == -2) {
#line 764
    return (1);
  } else
#line 763
  if (tempp == hashp) {
#line 764
    return (1);
  }
  {
#line 767
  quote1 = js_match(quotes, line___6);
  }
#line 767
  if (quote1 == -1) {
#line 768
    return (-1);
  }
#line 769
  if (quote1 != -2) {
    {
#line 770
    quote2 = js_match_offset(quotes, line___6, quote1 + 1);
    }
#line 771
    if (quote2 != -2) {
      {
#line 772
      quote3 = js_match_offset(quotes, line___6, quote2 + 1);
      }
#line 773
      if (quote3 != -2) {
        {
#line 774
        quote4 = js_match_offset(quotes, line___6, quote3 + 1);
        }
#line 774
        if (quote4 == -2) {
          {
#line 775
          js_qstr2js(var___6, (char *)"ERROR");
#line 776
          js_qstr2js(value___6, (char *)"2nd quoted expression needs to be unquoted");
          }
#line 778
          return (1);
        }
      }
    } else {
      {
#line 783
      js_qstr2js(var___6, (char *)"ERROR");
#line 784
      js_qstr2js(value___6, (char *)"Quoted expression needs to be unquoted");
      }
#line 785
      return (1);
    }
  }
  {
#line 790
  hashp = js_match(hashq, line___6);
  }
#line 790
  if (hashp == -1) {
#line 791
    return (-1);
  }
#line 793
  if (hashp > quote1) {
#line 793
    if (hashp < quote2) {
      {
#line 794
      hashp = js_match_offset(hashq, line___6, quote2);
      }
    }
  }
#line 796
  if (hashp > quote3) {
#line 796
    if (hashp < quote4) {
      {
#line 797
      hashp = js_match_offset(hashq, line___6, quote4);
      }
    }
  }
#line 799
  if (hashp == -2) {
    {
#line 800
    tmp___3 = js_length(line___6);
#line 800
    hashp = tmp___3 + 1;
    }
  }
#line 802
  if (quote1 > hashp) {
#line 803
    quote4 = -2;
#line 803
    quote3 = quote4;
#line 803
    quote2 = quote3;
#line 803
    quote1 = quote2;
  }
#line 804
  if (quote3 > hashp) {
#line 805
    quote4 = -2;
#line 805
    quote3 = quote4;
  }
  {
#line 809
  tempp = js_notmatch(allq, line___6);
  }
#line 809
  if (tempp == -1) {
#line 810
    return (-1);
  }
#line 814
  if (tempp != -2) {
#line 814
    if (tempp < hashp) {
#line 814
      if (tempp < quote1) {
#line 814
        goto _L;
      } else
#line 814
      if (tempp > quote2) {
        _L: /* CIL Label */ 
#line 814
        if (tempp < quote3) {
          {
#line 816
          js_qstr2js(var___6, (char *)"ERROR");
#line 817
          js_qstr2js(value___6, (char *)"Unknown character in line");
          }
#line 818
          return (1);
        } else
#line 814
        if (tempp > quote4) {
          {
#line 816
          js_qstr2js(var___6, (char *)"ERROR");
#line 817
          js_qstr2js(value___6, (char *)"Unknown character in line");
          }
#line 818
          return (1);
        }
      }
    }
  }
#line 822
  if (quote4 != -2) {
    {
#line 823
    tempp = js_match_offset(quotes, line___6, quote4 + 1);
    }
#line 823
    if (tempp == -1) {
#line 824
      return (-1);
    }
#line 825
    if (tempp != -2) {
#line 825
      if (tempp < hashp) {
        {
#line 826
        js_qstr2js(var___6, (char *)"ERROR");
#line 827
        js_qstr2js(value___6, (char *)"Maximum allowed quotes on a line is four");
        }
#line 828
        return (1);
      }
    }
  }
  {
#line 833
  equalp = js_match(equals, line___6);
  }
#line 833
  if (equalp == -1) {
#line 834
    return (-1);
  }
  {
#line 836
  tempp = js_match(plusq, line___6);
  }
#line 836
  if (tempp == -1) {
#line 837
    return (-1);
  }
#line 838
  if (tempp != -2) {
#line 838
    if (tempp != equalp - 1) {
      {
#line 839
      js_qstr2js(var___6, (char *)"ERROR");
#line 840
      js_qstr2js(value___6, (char *)"+ only allowed in += form");
      }
#line 841
      return (1);
    }
  }
#line 843
  if (tempp == equalp - 1) {
#line 843
    if ((unsigned long )do_plus != (unsigned long )((int *)0)) {
#line 844
      *do_plus = 1;
    }
  }
  {
#line 845
  tmp___4 = js_match_offset(plusq, line___6, equalp);
  }
#line 845
  if (tmp___4 != -2) {
    {
#line 846
    js_qstr2js(var___6, (char *)"ERROR");
#line 847
    js_qstr2js(value___6, (char *)"+ only allowed once on line");
    }
#line 848
    return (1);
  }
  {
#line 852
  varend = -2;
#line 852
  varstart = varend;
#line 853
  varstart = js_match(alphanumeric, line___6);
  }
#line 853
  if (varstart == -1) {
#line 854
    return (-1);
  }
#line 855
  if (varstart != -2) {
#line 855
    if (varstart < hashp) {
#line 856
      varend = varstart;
      {
#line 857
      while (1) {
        while_continue: /* CIL Label */ ;
        {
#line 857
        tmp___5 = js_match_offset(alphanumeric, line___6, varend + 1);
        }
#line 857
        if (! (tmp___5 == varend + 1)) {
#line 857
          goto while_break;
        }
#line 858
        varend ++;
      }
      while_break: /* CIL Label */ ;
      }
    } else {
#line 855
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 860
  if (varstart >= hashp) {
#line 861
    varstart = -2;
  }
#line 863
  if (varstart > quote1) {
#line 863
    if (varend < quote2) {
      {
#line 865
      js_qstr2js(var___6, (char *)"ERROR");
#line 866
      js_qstr2js(value___6, (char *)"Variable name can not be in quotes");
      }
#line 867
      return (1);
    } else {
#line 863
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 863
  if (varstart > quote3) {
#line 863
    if (varend < quote4) {
      {
#line 865
      js_qstr2js(var___6, (char *)"ERROR");
#line 866
      js_qstr2js(value___6, (char *)"Variable name can not be in quotes");
      }
#line 867
      return (1);
    }
  }
  {
#line 871
  tempp = js_match(leftq, line___6);
  }
#line 872
  if (tempp != -2) {
#line 875
    if (tempp != varend + 1) {
      {
#line 876
      js_qstr2js(var___6, (char *)"ERROR");
#line 877
      js_qstr2js(value___6, (char *)"Left square bracket must be immediately after variable name");
      }
#line 879
      return (1);
    }
#line 881
    if (quote1 != tempp + 1) {
      {
#line 882
      js_qstr2js(var___6, (char *)"ERROR");
#line 883
      js_qstr2js(value___6, (char *)"Dictionary element must be in quotes");
      }
#line 884
      return (1);
    }
    {
#line 886
    tmp___6 = js_match_offset(leftq, line___6, tempp + 1);
    }
#line 886
    if (tmp___6 != -2) {
      {
#line 887
      js_qstr2js(var___6, (char *)"ERROR");
#line 888
      js_qstr2js(value___6, (char *)"Multiple left square brackets forbidden");
      }
#line 889
      return (1);
    }
    {
#line 891
    tmp___7 = js_match(rightq, line___6);
    }
#line 891
    if (tmp___7 != quote2 + 1) {
      {
#line 892
      js_qstr2js(var___6, (char *)"ERROR");
#line 893
      js_qstr2js(value___6, (char *)"Right square bracket must be after quotes");
      }
#line 894
      return (1);
    }
    {
#line 898
    tmp___8 = js_substr(line___6, key___6, quote1 + 1, (quote2 - quote1) - 1);
    }
#line 898
    if (tmp___8 == -1) {
#line 899
      return (-1);
    }
#line 905
    quote1 = quote3;
#line 906
    quote2 = quote4;
#line 907
    quote4 = -2;
#line 907
    quote3 = quote4;
#line 908
    ret = 2;
  }
#line 912
  valend = -2;
#line 912
  valstart = valend;
#line 914
  if (quote1 != -2) {
#line 914
    if (quote2 != -2) {
#line 915
      valstart = quote1 + 1;
#line 916
      valend = quote2 - 1;
#line 919
      if (ret != 2) {
        {
#line 922
        q = js_match_offset(alphanumeric, line___6, varend + 1);
        }
#line 923
        if (q < quote1) {
#line 923
          if (q != -2) {
            {
#line 924
            js_qstr2js(var___6, (char *)"ERROR");
#line 925
            js_qstr2js(value___6, (char *)"Second bare word found before quotes");
            }
#line 926
            return (1);
          }
        }
      }
    } else {
#line 914
      goto _L___3;
    }
  } else {
    _L___3: /* CIL Label */ 
#line 933
    if (equalp < 0) {
      {
#line 934
      js_qstr2js(var___6, (char *)"ERROR");
#line 935
      js_qstr2js(value___6, (char *)"Statement needs an = sign");
      }
#line 936
      return (1);
    }
    {
#line 938
    valstart = js_match_offset(numbers, line___6, equalp);
    }
#line 938
    if (valstart == -1) {
#line 939
      return (-1);
    }
#line 941
    if (valstart != -2) {
#line 941
      if (valstart < hashp) {
#line 942
        valend = valstart;
        {
#line 943
        while (1) {
          while_continue___0: /* CIL Label */ ;
          {
#line 943
          tmp___9 = js_match_offset(alphanumeric, line___6, valend + 1);
          }
#line 943
          if (! (tmp___9 == valend + 1)) {
#line 943
            goto while_break___0;
          }
#line 944
          valend ++;
        }
        while_break___0: /* CIL Label */ ;
        }
      } else {
#line 941
        goto _L___2;
      }
    } else {
      _L___2: /* CIL Label */ 
      {
#line 948
      tempp = js_match_offset(cleftq, line___6, equalp);
      }
#line 949
      if (tempp != -2) {
        {
#line 950
        tmp___10 = js_match(crightq, line___6);
        }
#line 950
        if (tmp___10 != tempp + 1) {
          {
#line 951
          js_qstr2js(var___6, (char *)"ERROR");
#line 952
          js_qstr2js(value___6, (char *)"{ must be immediately followed by }");
          }
#line 953
          return (1);
        }
#line 955
        if (ret == 1) {
#line 956
          ret = 3;
        } else {
          {
#line 958
          js_qstr2js(var___6, (char *)"ERROR");
#line 959
          js_qstr2js(value___6, (char *)"Dictionary elements pointing to dictionaries unsupported");
          }
#line 961
          return (1);
        }
      } else {
        {
#line 965
        js_qstr2js(var___6, (char *)"ERROR");
#line 966
        js_qstr2js(value___6, (char *)"Something must follow =");
        }
#line 967
        return (1);
      }
    }
  }
  {
#line 973
  tmp___11 = js_match(bslashq, line___6);
  }
#line 973
  if (tmp___11 != -2) {
    {
#line 974
    js_qstr2js(var___6, (char *)"ERROR");
#line 975
    js_qstr2js(value___6, (char *)"Backslash not supported yet");
    }
#line 976
    return (1);
  }
#line 981
  if (varstart >= 0) {
#line 981
    if (varend >= varstart) {
#line 983
      if (equalp == -2) {
        {
#line 984
        js_qstr2js(var___6, (char *)"ERROR");
#line 985
        js_qstr2js(value___6, (char *)"Variable name needs an = sign");
        }
#line 986
        return (1);
      }
#line 989
      if (varstart > equalp) {
        {
#line 990
        js_qstr2js(var___6, (char *)"ERROR");
#line 991
        js_qstr2js(value___6, (char *)"Equals sign before variable name");
        }
#line 992
        return (1);
      }
      {
#line 994
      tmp___12 = js_substr(line___6, var___6, varstart, (varend - varstart) + 1);
      }
#line 994
      if (tmp___12 == -1) {
#line 995
        return (-1);
      }
    }
  }
#line 998
  if (valstart >= 0) {
#line 998
    if (valend >= valstart) {
#line 1000
      if (equalp > quote1) {
#line 1000
        if (equalp < quote2) {
          {
#line 1001
          js_qstr2js(var___6, (char *)"ERROR");
#line 1002
          js_qstr2js(value___6, (char *)"Quoted string not preceded by equals sign");
          }
#line 1003
          return (1);
        }
      }
#line 1006
      if (valstart < equalp) {
        {
#line 1007
        js_qstr2js(var___6, (char *)"ERROR");
#line 1008
        js_qstr2js(value___6, (char *)"Equals sign after variable value");
        }
#line 1009
        return (1);
      }
      {
#line 1011
      tmp___13 = js_substr(line___6, value___6, valstart, (valend - valstart) + 1);
      }
#line 1011
      if (tmp___13 == -1) {
#line 1012
        return (-1);
      }
    }
  }
  {
#line 1016
  js_space_chars(allq);
#line 1017
  js_append(quotes, allq);
#line 1018
  js_newline_chars(quotes);
#line 1019
  js_append(quotes, allq);
#line 1020
  tempp = js_notmatch_offset(allq, line___6, valend + 1);
  }
#line 1021
  if (tempp < hashp) {
#line 1021
    if (tempp != -2) {
      {
#line 1022
      js_qstr2js(var___6, (char *)"ERROR");
#line 1023
      js_qstr2js(value___6, (char *)"Unexpected character near end of line");
      }
#line 1024
      return (1);
    }
  }
#line 1027
  return (ret);
}
}
#line 1035 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int find_mararc(js_string *out ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 1038
  tmp = mara_goodjs(out);
  }
#line 1038
  if (tmp == -1) {
#line 1039
    return (-1);
  }
  {
#line 1042
  tmp___0 = js_qstr2js(out, (char *)"/etc/mararc");
  }
#line 1042
  return (tmp___0);
}
}
#line 1055
int read_mararc(js_string *fileloc , js_string *errorstr , int *errorret ) ;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file  =    (js_file *)0;
#line 1054 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
int read_mararc(js_string *fileloc , js_string *errorstr , int *errorret ) 
{ 
  int error ;
  int linenum ;
  int command ;
  int tnum ;
  int is_plus ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int result ;
  int tmp___3 ;
  int tmp___4 ;
  int result___0 ;
  int tmp___5 ;

  {
#line 1061
  error = 0;
#line 1062
  linenum = 1;
#line 1064
  is_plus = 0;
#line 1069
  *errorret = -1;
#line 1072
  if ((unsigned long )line == (unsigned long )((js_string *)0)) {
    {
#line 1073
    line = js_create(256U, 1U);
    }
#line 1073
    if ((unsigned long )line == (unsigned long )((js_string *)0)) {
      {
#line 1074
      js_qstr2js(errorstr, (char *)"Fatal error creating js_string");
      }
#line 1075
      return (-1);
    }
  }
#line 1077
  if ((unsigned long )var == (unsigned long )((js_string *)0)) {
    {
#line 1078
    var = js_create(256U, 1U);
    }
#line 1078
    if ((unsigned long )var == (unsigned long )((js_string *)0)) {
      {
#line 1079
      js_qstr2js(errorstr, (char *)"Fatal error creating js_string");
      }
#line 1080
      return (-1);
    }
  }
#line 1082
  if ((unsigned long )key == (unsigned long )((js_string *)0)) {
    {
#line 1083
    key = js_create(256U, 1U);
    }
#line 1083
    if ((unsigned long )key == (unsigned long )((js_string *)0)) {
      {
#line 1084
      js_qstr2js(errorstr, (char *)"Fatal error creating js_string");
      }
#line 1085
      return (-1);
    }
  }
#line 1087
  if ((unsigned long )value == (unsigned long )((js_string *)0)) {
    {
#line 1088
    value = js_create(256U, 1U);
    }
#line 1088
    if ((unsigned long )value == (unsigned long )((js_string *)0)) {
      {
#line 1089
      js_qstr2js(errorstr, (char *)"Fatal error creating js_string");
      }
#line 1090
      return (-1);
    }
  }
#line 1092
  if ((unsigned long )tstr == (unsigned long )((js_string *)0)) {
    {
#line 1093
    tstr = js_create(256U, 1U);
    }
#line 1093
    if ((unsigned long )tstr == (unsigned long )((js_string *)0)) {
      {
#line 1094
      js_qstr2js(errorstr, (char *)"Fatal error creating js_string");
      }
#line 1095
      return (-1);
    }
  }
#line 1097
  if ((unsigned long )file == (unsigned long )((js_file *)0)) {
    {
#line 1098
    tmp = js_alloc(1, (int )sizeof(js_file ));
#line 1098
    file = (js_file *)tmp;
    }
#line 1098
    if ((unsigned long )file == (unsigned long )((js_file *)0)) {
      {
#line 1099
      js_qstr2js(errorstr, (char *)"Fatal error creating file");
      }
#line 1100
      return (-1);
    }
  }
  {
#line 1104
  js_qstr2js(errorstr, (char *)"");
#line 1105
  js_set_encode(line, 3);
#line 1106
  js_set_encode(var, 3);
#line 1107
  js_set_encode(key, 3);
#line 1108
  js_set_encode(value, 3);
#line 1109
  js_set_encode(tstr, 3);
#line 1111
  init_dvars();
#line 1112
  init_kvars();
#line 1115
  tmp___0 = js_open_read(fileloc, file);
  }
#line 1115
  if (tmp___0 == -1) {
    {
#line 1116
    *errorret = -1;
#line 1117
    js_qstr2js(errorstr, (char *)"Could not open mararc file at ");
#line 1118
    js_append(fileloc, errorstr);
    }
#line 1119
    return (1);
  }
  {
#line 1121
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1121
    tmp___5 = js_buf_eof(file);
    }
#line 1121
    if (tmp___5) {
#line 1121
      goto while_break;
    }
    {
#line 1122
    tmp___1 = js_buf_getline(file, line);
    }
#line 1122
    if (tmp___1 <= -1) {
      {
#line 1123
      js_qstr2js(errorstr, (char *)"Fatal error calling js_buf_getline");
#line 1124
      js_close(file);
      }
#line 1125
      return (-1);
    }
    {
#line 1127
    command = parseline(line, var, key, value, & is_plus);
    }
#line 1127
    if (command == -1) {
      {
#line 1128
      js_qstr2js(errorstr, (char *)"Fatal error calling parseline");
#line 1129
      js_close(file);
      }
#line 1130
      return (-1);
    }
#line 1132
    if (command == 2) {
#line 1132
      if (! error) {
        {
#line 1134
        tnum = dkeyword2num(var);
        }
#line 1135
        if (tnum == -1) {
          {
#line 1136
          js_qstr2js(errorstr, (char *)"Fatal error calling keyword2num");
#line 1137
          js_close(file);
          }
#line 1138
          return (-1);
        }
#line 1140
        if (tnum == -2) {
          {
#line 1142
          js_qstr2js(tstr, (char *)"ERROR");
#line 1143
          tmp___2 = js_issame(tstr, var);
          }
#line 1143
          if (tmp___2) {
#line 1144
            if (! error) {
              {
#line 1145
              error = linenum;
#line 1146
              *errorret = error;
#line 1147
              js_copy(value, errorstr);
              }
            }
          }
        } else
#line 1151
        if (! error) {
          {
#line 1153
          result = write_dvar(var, key, value, is_plus);
          }
#line 1154
          if (result == -3) {
            {
#line 1156
            printf((char const   */* __restrict  */)"%s", "Fatal error: ");
#line 1157
            js_show_stdout(var);
#line 1158
            printf((char const   */* __restrict  */)"%s", "[\"");
#line 1159
            js_show_stdout(key);
#line 1160
            printf((char const   */* __restrict  */)"%s", "\"]");
#line 1161
            printf((char const   */* __restrict  */)"%s", " is declared more than once in mararc file.\nPlease remove or comment out this line:\n");
#line 1162
            js_show_stdout(var);
#line 1163
            printf((char const   */* __restrict  */)"%s", "[\"");
#line 1164
            js_show_stdout(key);
#line 1165
            printf((char const   */* __restrict  */)"%s", "\"] = \"");
#line 1166
            js_show_stdout(value);
#line 1167
            printf((char const   */* __restrict  */)"%s", "\"\n");
#line 1168
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1169
            exit(1);
            }
          } else
#line 1171
          if (result == -4) {
            {
#line 1172
            printf((char const   */* __restrict  */)"+= operator target must be previously ");
#line 1173
            printf((char const   */* __restrict  */)"defined with = operator\n");
#line 1174
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1175
            exit(1);
            }
          } else
#line 1177
          if (result == -5) {
            {
#line 1178
            printf((char const   */* __restrict  */)"+= operator target not supported for ");
#line 1179
            printf((char const   */* __restrict  */)"numeric values\n");
#line 1180
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1181
            exit(1);
            }
          } else
#line 1183
          if (result == -6) {
            {
#line 1184
            printf((char const   */* __restrict  */)"Trying to access unitizalized dictionary var.\n");
#line 1185
            printf((char const   */* __restrict  */)"Try adding this line to the beginning of the ");
#line 1186
            printf((char const   */* __restrict  */)"mararc file:\n\n");
#line 1187
            js_show_stdout(var);
#line 1188
            printf((char const   */* __restrict  */)" = {}\n");
#line 1189
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1190
            exit(1);
            }
          }
        }
      } else {
#line 1132
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 1194
    if (command == 1) {
#line 1194
      if (! error) {
        {
#line 1195
        tnum = keyword2num(var);
        }
#line 1196
        if (tnum == -2) {
          {
#line 1198
          js_qstr2js(tstr, (char *)"ERROR");
#line 1199
          tmp___3 = js_issame(tstr, var);
          }
#line 1199
          if (tmp___3) {
#line 1200
            if (! error) {
              {
#line 1201
              error = linenum;
#line 1202
              *errorret = error;
#line 1203
              js_copy(value, errorstr);
              }
            }
          }
        }
#line 1207
        if (tnum == -2) {
#line 1207
          if (var->unit_count > 0U) {
#line 1207
            if (! error) {
              {
#line 1208
              printf((char const   */* __restrict  */)"FATAL ERROR: Unknown mararc variable ");
#line 1209
              show_esc_stdout(var);
#line 1210
              printf((char const   */* __restrict  */)"\nPlease look for the uncommented string \"");
#line 1211
              show_esc_stdout(var);
#line 1212
              printf((char const   */* __restrict  */)"\"\nin your mararc file and remove this line.\n");
#line 1213
              printf((char const   */* __restrict  */)"\nThe line this error is on looks like this:\n");
              }
#line 1215
              if ((int )*((line->string + line->unit_count) - 1) == 10) {
#line 1215
                if (line->unit_count > 0U) {
#line 1217
                  (line->unit_count) --;
                }
              }
              {
#line 1219
              show_esc_stdout(line);
#line 1220
              printf((char const   */* __restrict  */)"\n");
#line 1221
              exit(10);
              }
            }
          }
        }
#line 1223
        if (tnum == -1) {
          {
#line 1224
          js_qstr2js(errorstr, (char *)"Fatal error calling keyword2num");
#line 1225
          js_close(file);
          }
#line 1226
          return (-1);
        }
#line 1228
        if (tnum == -2) {
          {
#line 1230
          js_qstr2js(tstr, (char *)"ERROR");
#line 1231
          tmp___4 = js_issame(tstr, var);
          }
#line 1231
          if (tmp___4) {
#line 1232
            if (! error) {
              {
#line 1233
              error = linenum;
#line 1234
              *errorret = error;
#line 1235
              js_copy(value, errorstr);
              }
            }
          }
        } else
#line 1239
        if (! error) {
          {
#line 1241
          result___0 = write_kvar(var, value, is_plus);
          }
#line 1242
          if (result___0 == -4) {
            {
#line 1243
            printf((char const   */* __restrict  */)"+= operator target must be previously ");
#line 1244
            printf((char const   */* __restrict  */)"defined with = operator\n");
#line 1245
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1246
            exit(1);
            }
          } else
#line 1248
          if (result___0 == -5) {
            {
#line 1249
            printf((char const   */* __restrict  */)"+= operator target not supported for ");
#line 1250
            printf((char const   */* __restrict  */)"numeric values\n");
#line 1251
            printf((char const   */* __restrict  */)"Error in line %d\n", linenum);
#line 1252
            exit(1);
            }
          }
        }
      } else {
#line 1194
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 1256
    if (command == 3) {
      {
#line 1257
      new_dvar(var);
      }
    }
#line 1258
    linenum ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1261
  if (! error) {
#line 1262
    *errorret = 0;
  }
  {
#line 1264
  js_close(file);
  }
#line 1300
  return (1);
}
}
#line 168 "/usr/include/stdio.h"
extern struct _IO_FILE *stdin ;
#line 399 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 50 "/usr/include/x86_64-linux-gnu/sys/file.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) flock)(int __fd ,
                                                                            int __operation ) ;
#line 334 "/usr/include/unistd.h"
extern  __attribute__((__nothrow__)) __off_t ( __attribute__((__leaf__)) lseek)(int __fd ,
                                                                                __off_t __offset ,
                                                                                int __whence ) ;
#line 366
extern ssize_t write(int __fd , void const   *__buf , size_t __n ) ;
#line 74 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.h"
int js_js2str(js_string *js , char *string , int max ) ;
#line 101
void js_open(js_string *filename , js_file *desc , int flags ) ;
#line 102
int js_open_write(js_string *filename , js_file *desc ) ;
#line 104
int js_read(js_file *desc , js_string *js , int count ) ;
#line 105
int js_write(js_file *desc , js_string *js ) ;
#line 108
int js_buf_read(js_file *desc ) ;
#line 115
int js_strnlen(char *s , uint32_t limit ) ;
#line 116
int js_tell_memory_allocated(void) ;
#line 118
int safe_esc_stdout(js_string *js ) ;
#line 57 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
void *js_alloc(int unit_count , int unit_size ) 
{ 
  void *data ;
  void *tmp ;

  {
#line 64
  if (unit_size == 0) {
#line 65
    return ((void *)0);
  } else
#line 64
  if (unit_count == 0) {
#line 65
    return ((void *)0);
  }
  {
#line 66
  tmp = malloc((size_t )(unit_count * unit_size));
#line 66
  data = tmp;
  }
#line 118
  if ((unsigned long )data == (unsigned long )((void *)0)) {
    {
#line 122
    printf((char const   */* __restrict  */)"Aieeeeee, can not allocate memory!");
#line 123
    exit(64);
    }
#line 124
    return ((void *)0);
  }
#line 126
  return (data);
}
}
#line 134 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
void *js_alloc_DEBUG(int unit_count , int unit_size , char *whence ) 
{ 
  void *data ;
  void *tmp ;

  {
  {
#line 141
  tmp = malloc((size_t )(unit_count * unit_size));
#line 141
  data = tmp;
  }
#line 200
  if ((unsigned long )data == (unsigned long )((void *)0)) {
    {
#line 204
    printf((char const   */* __restrict  */)"Aieeeeee, can not allocate memory!");
#line 205
    exit(64);
    }
#line 206
    return ((void *)0);
  }
#line 208
  return (data);
}
}
#line 215 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_dealloc(void *pointer ) 
{ 


  {
#line 220
  if ((unsigned long )pointer == (unsigned long )((void *)0)) {
#line 221
    return (1);
  }
  {
#line 284
  free(pointer);
  }
#line 285
  return (1);
}
}
#line 323 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_tell_memory_allocated(void) 
{ 


  {
#line 327
  return (0);
}
}
#line 335 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_show_stdout(js_string *js ) 
{ 
  int counter ;
  int tmp ;

  {
  {
#line 336
  counter = 0;
#line 338
  tmp = js_has_sanity(js);
  }
#line 338
  if (tmp < 0) {
#line 339
    return (-1);
  }
  {
#line 341
  while (1) {
    while_continue: /* CIL Label */ ;
#line 341
    if (! ((unsigned int )counter < js->unit_size * js->unit_count)) {
#line 341
      goto while_break;
    }
    {
#line 342
    _IO_putc((int )*(js->string + counter), stdout);
#line 343
    counter ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 346
  return (1);
}
}
#line 353 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int show_esc_stdout(js_string *js ) 
{ 
  int counter ;
  unsigned char this ;
  int tmp ;

  {
  {
#line 354
  counter = 0;
#line 357
  tmp = js_has_sanity(js);
  }
#line 357
  if (tmp < 0) {
#line 358
    return (-1);
  }
#line 360
  if (js->unit_size != 1U) {
#line 362
    return (-1);
  }
  {
#line 363
  while (1) {
    while_continue: /* CIL Label */ ;
#line 363
    if (! ((unsigned int )counter < js->unit_size * js->unit_count)) {
#line 363
      goto while_break;
    }
#line 364
    this = *(js->string + counter);
#line 365
    if ((int )this < 32) {
      {
#line 366
      printf((char const   */* __restrict  */)"\\%03o", (int )this);
      }
    } else
#line 365
    if ((int )this > 126) {
      {
#line 366
      printf((char const   */* __restrict  */)"\\%03o", (int )this);
      }
    } else
#line 368
    if ((int )this == 92) {
      {
#line 369
      printf((char const   */* __restrict  */)"\\%c", (int )this);
      }
    } else
#line 368
    if ((int )this == 37) {
      {
#line 369
      printf((char const   */* __restrict  */)"\\%c", (int )this);
      }
    } else {
      {
#line 372
      _IO_putc((int )*(js->string + counter), stdout);
      }
    }
#line 374
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 377
  return (1);
}
}
#line 386 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int safe_esc_stdout(js_string *js ) 
{ 
  int counter ;
  unsigned char this ;
  int tmp ;

  {
  {
#line 387
  counter = 0;
#line 390
  tmp = js_has_sanity(js);
  }
#line 390
  if (tmp < 0) {
#line 391
    return (-1);
  }
#line 393
  if (js->unit_size != 1U) {
#line 395
    return (-1);
  }
  {
#line 396
  while (1) {
    while_continue: /* CIL Label */ ;
#line 396
    if (! ((unsigned int )counter < js->unit_size * js->unit_count)) {
#line 396
      goto while_break;
    }
#line 397
    this = *(js->string + counter);
#line 400
    if ((int )this == 32) {
#line 400
      if (counter == 0) {
        {
#line 401
        printf((char const   */* __restrict  */)" ");
        }
      } else {
#line 400
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 403
    if ((int )this >= 65) {
#line 403
      if ((int )this <= 90) {
        {
#line 406
        printf((char const   */* __restrict  */)"%c", (int )this);
        }
      } else {
#line 403
        goto _L___1;
      }
    } else
    _L___1: /* CIL Label */ 
#line 403
    if ((int )this >= 97) {
#line 403
      if ((int )this <= 122) {
        {
#line 406
        printf((char const   */* __restrict  */)"%c", (int )this);
        }
      } else {
#line 403
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 403
    if ((int )this == 45) {
      {
#line 406
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    } else
#line 403
    if ((int )this == 95) {
      {
#line 406
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    } else
#line 403
    if ((int )this > 127) {
      {
#line 406
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    } else
#line 403
    if ((int )this == 46) {
      {
#line 406
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    } else
#line 403
    if ((int )this == 64) {
      {
#line 406
      printf((char const   */* __restrict  */)"%c", (int )this);
      }
    } else
#line 403
    if ((int )this >= 48) {
#line 403
      if ((int )this <= 57) {
        {
#line 406
        printf((char const   */* __restrict  */)"%c", (int )this);
        }
      } else {
#line 403
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 410
    if ((int )this == 42) {
#line 410
      if (counter == 0) {
#line 410
        if (js->unit_count > 2U) {
#line 410
          if ((int )*(js->string + 1) == 46) {
            {
#line 412
            printf((char const   */* __restrict  */)"%c", (int )this);
            }
          } else {
            {
#line 415
            printf((char const   */* __restrict  */)"\\x%02x", (int )this);
            }
          }
        } else {
          {
#line 415
          printf((char const   */* __restrict  */)"\\x%02x", (int )this);
          }
        }
      } else {
        {
#line 415
        printf((char const   */* __restrict  */)"\\x%02x", (int )this);
        }
      }
    } else {
      {
#line 415
      printf((char const   */* __restrict  */)"\\x%02x", (int )this);
      }
    }
#line 417
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 420
  return (1);
}
}
#line 427 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_getline_stdin(js_string *js ) 
{ 
  char *temp ;
  js_string *newlines ;
  js_string *append ;
  int counter ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 431
  counter = 0;
#line 432
  tmp = js_alloc((int )js->unit_size, 1);
#line 432
  temp = (char *)tmp;
#line 433
  newlines = js_create(256U, js->unit_size);
  }
#line 434
  if ((unsigned long )newlines == (unsigned long )((js_string *)0)) {
#line 435
    return (-1);
  }
  {
#line 436
  newlines->encoding = js->encoding;
#line 437
  append = js_create(256U, js->unit_size);
  }
#line 438
  if ((unsigned long )append == (unsigned long )((js_string *)0)) {
    {
#line 439
    js_destroy(newlines);
#line 440
    js_dealloc((void *)temp);
    }
#line 441
    return (-1);
  }
  {
#line 443
  js_newline_chars(newlines);
#line 444
  tmp___0 = js_has_sanity(js);
  }
#line 444
  if (tmp___0 == -1) {
#line 445
    goto error;
  }
#line 446
  if ((unsigned long )temp == (unsigned long )((char *)0)) {
    {
#line 447
    js_destroy(newlines);
#line 448
    js_destroy(append);
#line 449
    js_dealloc((void *)temp);
    }
#line 450
    return (-1);
  }
#line 453
  js->unit_count = 0U;
  {
#line 454
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 454
    tmp___3 = feof(stdin);
    }
#line 454
    if (tmp___3) {
#line 454
      goto while_break;
    } else {
      {
#line 454
      tmp___4 = js_match(newlines, js);
      }
#line 454
      if (! (tmp___4 == -2)) {
#line 454
        goto while_break;
      }
    }
    {
#line 455
    tmp___1 = _IO_getc(stdin);
#line 455
    *(temp + counter) = (char )tmp___1;
#line 456
    counter ++;
    }
#line 457
    if ((unsigned int )counter >= js->unit_size) {
      {
#line 458
      counter = 0;
#line 459
      js_str2js(append, temp, 1, (int )js->unit_size);
#line 460
      tmp___2 = js_append(append, js);
      }
#line 460
      if (tmp___2 == -1) {
#line 461
        goto error;
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 466
  js_destroy(append);
#line 467
  js_destroy(newlines);
#line 468
  js_dealloc((void *)temp);
  }
#line 469
  return (1);
  error: 
  {
#line 472
  js_destroy(append);
#line 473
  js_destroy(newlines);
#line 474
  js_dealloc((void *)temp);
  }
#line 475
  return (-1);
}
}
#line 481 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
void js_open(js_string *filename , js_file *desc , int flags ) 
{ 
  char temp[256] ;

  {
#line 486
  if (filename->unit_count * filename->unit_size > 255U) {
#line 487
    desc->filetype = -1;
#line 488
    return;
  }
  {
#line 494
  js_js2str(filename, temp, 255);
#line 496
  desc->filetype = 1;
#line 497
  desc->file_desc = open((char const   *)(temp), flags, 384);
#line 498
  desc->number = -1;
#line 499
  desc->eof = 0;
#line 500
  desc->buffer = (js_string *)0;
  }
#line 502
  if (desc->file_desc == -1) {
#line 503
    desc->filetype = -1;
#line 504
    return;
  }
#line 507
  return;
}
}
#line 514 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_open_append(js_string *filename , js_file *desc ) 
{ 


  {
  {
#line 515
  js_open(filename, desc, 1089);
  }
#line 516
  if (desc->filetype == -1) {
#line 517
    return (-1);
  } else {
#line 519
    return (1);
  }
}
}
#line 525 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_open_write(js_string *filename , js_file *desc ) 
{ 


  {
  {
#line 526
  js_open(filename, desc, 65);
  }
#line 527
  if (desc->filetype == -1) {
#line 528
    return (-1);
  } else {
#line 530
    return (1);
  }
}
}
#line 536 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_open_read(js_string *filename , js_file *desc ) 
{ 


  {
  {
#line 537
  js_open(filename, desc, 0);
  }
#line 538
  if (desc->filetype == -1) {
#line 539
    return (-1);
  } else {
#line 541
    return (1);
  }
}
}
#line 547 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_rewind(js_file *desc ) 
{ 
  __off_t tmp ;

  {
#line 549
  if ((unsigned long )desc == (unsigned long )((js_file *)0)) {
#line 550
    return (-1);
  }
#line 551
  if (desc->filetype != 1) {
#line 552
    return (-1);
  }
#line 555
  if ((unsigned long )desc->buffer != (unsigned long )((js_string *)0)) {
    {
#line 556
    js_destroy(desc->buffer);
    }
  }
  {
#line 557
  desc->number = -1;
#line 559
  tmp = lseek(desc->file_desc, (__off_t )0, 0);
  }
#line 559
  if (tmp == -1L) {
#line 560
    return (-1);
  }
#line 562
  return (1);
}
}
#line 570 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_read(js_file *desc , js_string *js , int count ) 
{ 
  ssize_t value___6 ;
  int ret ;
  int tmp ;

  {
  {
#line 576
  tmp = js_has_sanity(js);
  }
#line 576
  if (tmp == -1) {
#line 577
    return (-1);
  }
#line 578
  if (desc->filetype != 1) {
#line 579
    return (-1);
  }
#line 580
  if ((unsigned int )count % js->unit_size != 0U) {
#line 581
    return (-1);
  }
#line 583
  if (count < 0) {
#line 584
    return (-1);
  } else
#line 583
  if (count > 1048576) {
#line 584
    return (-1);
  }
#line 594
  if ((unsigned int )count > js->unit_size * js->max_count) {
#line 595
    return (-1);
  }
  {
#line 597
  value___6 = read(desc->file_desc, (void *)js->string, (size_t )count);
  }
#line 599
  if (value___6 == -1L) {
#line 600
    return (-1);
  }
#line 602
  ret = (int )value___6;
#line 604
  if ((unsigned int )ret % js->unit_size != 0U) {
#line 605
    js->unit_count = 0U;
#line 606
    return (-1);
  }
#line 609
  js->unit_count = (unsigned int )ret / js->unit_size;
#line 611
  return (ret);
}
}
#line 618 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_write(js_file *desc , js_string *js ) 
{ 
  ssize_t value___6 ;
  int to_write ;
  int written ;
  int tmp ;

  {
  {
#line 624
  tmp = js_has_sanity(js);
  }
#line 624
  if (tmp == -1) {
#line 625
    return (-1);
  }
#line 626
  if (desc->filetype != 1) {
#line 627
    return (-1);
  }
#line 629
  to_write = (int )(js->unit_size * js->unit_count);
#line 631
  if (to_write < 0) {
#line 632
    return (-1);
  } else
#line 631
  if (to_write > 1048576) {
#line 632
    return (-1);
  }
  {
#line 642
  value___6 = write(desc->file_desc, (void const   *)js->string, (size_t )to_write);
#line 644
  written = (int )value___6;
  }
#line 646
  if (written != to_write) {
#line 647
    return (-1);
  }
#line 649
  return (1);
}
}
#line 656 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_close(js_file *desc ) 
{ 
  int ret ;

  {
  {
#line 660
  ret = close(desc->file_desc);
  }
#line 663
  if ((unsigned long )desc->buffer != (unsigned long )((js_string *)0)) {
    {
#line 664
    js_destroy(desc->buffer);
    }
  }
#line 665
  desc->number = -1;
#line 667
  if (ret == -1) {
#line 668
    return (-1);
  }
#line 671
  desc->filetype = -1;
#line 673
  return (1);
}
}
#line 687 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_lock(js_file *desc ) 
{ 


  {
  {
#line 690
  flock(desc->file_desc, 2);
  }
#line 692
  return (1);
}
}
#line 699 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_unlock(js_file *desc ) 
{ 


  {
  {
#line 702
  flock(desc->file_desc, 8);
  }
#line 704
  return (1);
}
}
#line 713 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_buf_eof(js_file *desc ) 
{ 


  {
#line 714
  if (desc->eof) {
#line 714
    if ((unsigned int )desc->number >= (desc->buffer)->unit_count) {
#line 715
      return (1);
    }
  }
#line 716
  return (0);
}
}
#line 722 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_buf_read(js_file *desc ) 
{ 
  int bytes_read ;
  int tmp ;

  {
  {
#line 726
  tmp = js_has_sanity(desc->buffer);
  }
#line 726
  if (tmp == -1) {
#line 727
    return (-1);
  }
  {
#line 728
  bytes_read = js_read(desc, desc->buffer, (int )(1024U * (desc->buffer)->unit_size));
  }
#line 730
  if ((unsigned int )bytes_read != 1024U * (desc->buffer)->unit_size) {
#line 731
    desc->eof = 1;
  }
#line 732
  desc->number = 0;
#line 734
  return (1);
}
}
#line 744 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_buf_getline(js_file *desc , js_string *js ) 
{ 
  js_string *newlines ;
  js_string *temp ;
  int next_newln ;
  int overflowed ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 747
  overflowed = 0;
#line 750
  tmp = js_has_sanity(js);
  }
#line 750
  if (tmp == -1) {
#line 751
    return (-1);
  }
#line 755
  if (desc->number == -1) {
#line 756
    if ((unsigned long )desc->buffer == (unsigned long )((js_string *)0)) {
      {
#line 757
      desc->buffer = js_create(1034U, js->unit_size);
      }
    }
    {
#line 758
    js_buf_read(desc);
    }
  }
#line 762
  if (js->unit_size != (desc->buffer)->unit_size) {
#line 763
    return (-1);
  }
  {
#line 767
  newlines = js_create(js->max_count, js->unit_size);
#line 768
  js_copy(js, newlines);
#line 769
  js_newline_chars(newlines);
#line 772
  next_newln = js_match_offset(newlines, desc->buffer, desc->number);
  }
#line 775
  if (next_newln == -2) {
#line 775
    if (desc->eof == 0) {
#line 779
      if ((unsigned int )(1025 - desc->number) < js->max_count) {
#line 779
        if (overflowed == 0) {
          {
#line 780
          js_substr(desc->buffer, js, desc->number, 1024 - desc->number);
          }
        } else {
          {
#line 783
          js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 784
          overflowed = 1;
          }
        }
      } else {
        {
#line 783
        js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 784
        overflowed = 1;
        }
      }
      {
#line 787
      js_buf_read(desc);
      }
      {
#line 790
      while (1) {
        while_continue: /* CIL Label */ ;
        {
#line 790
        tmp___0 = js_match(newlines, desc->buffer);
        }
#line 790
        if (tmp___0 == -2) {
#line 790
          if (! (desc->eof == 0)) {
#line 790
            goto while_break;
          }
        } else {
#line 790
          goto while_break;
        }
#line 791
        if (js->unit_count + 1024U < js->max_count) {
#line 791
          if (overflowed == 0) {
            {
#line 792
            js_append(desc->buffer, js);
            }
          } else {
            {
#line 794
            js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 795
            overflowed = 1;
            }
          }
        } else {
          {
#line 794
          js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 795
          overflowed = 1;
          }
        }
        {
#line 797
        js_buf_read(desc);
        }
      }
      while_break: /* CIL Label */ ;
      }
      {
#line 799
      next_newln = js_match(newlines, desc->buffer);
#line 800
      temp = js_create(js->max_count, js->unit_size);
#line 801
      js_substr(desc->buffer, temp, 0, next_newln + 1);
#line 802
      js_append(temp, js);
#line 803
      js_destroy(temp);
      }
#line 804
      if (next_newln != -2) {
#line 805
        desc->number = next_newln + 1;
      }
#line 806
      if (desc->number >= 1024) {
        {
#line 807
        js_buf_read(desc);
        }
      }
      {
#line 808
      js_destroy(newlines);
      }
#line 809
      if (overflowed == 1) {
#line 810
        return (-2);
      }
#line 811
      return (1);
    } else {
#line 775
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 813
  if (next_newln == -2) {
#line 816
    if ((desc->buffer)->unit_count - (unsigned int )desc->number < js->max_count) {
#line 816
      if (overflowed == 0) {
        {
#line 818
        js_substr(desc->buffer, js, desc->number, (int )((desc->buffer)->unit_count - (unsigned int )desc->number));
        }
      } else {
        {
#line 821
        js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 822
        overflowed = 1;
        }
      }
    } else {
      {
#line 821
      js_str2js(js, (char *)"", 0, (int )js->unit_size);
#line 822
      overflowed = 1;
      }
    }
    {
#line 826
    desc->number = (int )((desc->buffer)->unit_count + 1U);
#line 828
    js_destroy(newlines);
    }
#line 829
    if (overflowed == 1) {
#line 830
      return (-2);
    }
#line 831
    return (1);
  }
#line 835
  if ((unsigned int )((next_newln + 1) - desc->number) < js->max_count) {
    {
#line 836
    js_substr(desc->buffer, js, desc->number, (next_newln + 1) - desc->number);
#line 837
    desc->number = next_newln + 1;
    }
#line 838
    if (desc->number >= 1024) {
      {
#line 839
      js_buf_read(desc);
      }
    }
  } else {
    {
#line 842
    js_str2js(js, (char *)"", 0, (int )js->unit_size);
    }
  }
  {
#line 844
  js_destroy(newlines);
  }
#line 846
  if (overflowed == 1) {
#line 847
    return (-2);
  }
#line 849
  return (1);
}
}
#line 857 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_qstr2js(js_string *js , char *string ) 
{ 
  size_t tmp ;
  int tmp___0 ;

  {
#line 858
  if ((unsigned long )js == (unsigned long )((js_string *)0)) {
#line 859
    return (-1);
  }
  {
#line 861
  tmp = strlen((char const   *)string);
#line 861
  tmp___0 = js_str2js(js, string, (int )tmp, (int )js->unit_size);
  }
#line 861
  return (tmp___0);
}
}
#line 871 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_adduint32(js_string *js , uint32_t number ) 
{ 
  int tmp ;

  {
  {
#line 874
  tmp = js_has_sanity(js);
  }
#line 874
  if (tmp == -1) {
#line 875
    return (-1);
  }
#line 876
  if (js->unit_size != 1U) {
#line 877
    return (-1);
  }
#line 879
  if (js->unit_count + 4U >= js->max_count) {
#line 880
    return (-1);
  }
#line 883
  *(js->string + js->unit_count) = (unsigned char )((number >> 24) & 255U);
#line 884
  *((js->string + js->unit_count) + 1) = (unsigned char )((number >> 16) & 255U);
#line 885
  *((js->string + js->unit_count) + 2) = (unsigned char )((number >> 8) & 255U);
#line 886
  *((js->string + js->unit_count) + 3) = (unsigned char )(number & 255U);
#line 887
  js->unit_count += 4U;
#line 889
  return (1);
}
}
#line 901 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
uint32_t js_readuint32(js_string *js , unsigned int offset ) 
{ 
  uint32_t ret ;
  int tmp ;

  {
  {
#line 905
  tmp = js_has_sanity(js);
  }
#line 905
  if (tmp == -1) {
#line 906
    return (4294967295U);
  }
#line 907
  if (js->unit_size != 1U) {
#line 908
    return (4294967295U);
  }
#line 909
  if (offset > js->unit_count - 4U) {
#line 910
    return (4294967295U);
  } else
#line 909
  if (offset < 0U) {
#line 910
    return (4294967295U);
  }
#line 912
  ret = ((((unsigned int )((int )*(js->string + offset) << 24) & 4278190080U) | (unsigned int )(((int )*((js->string + offset) + 1) << 16) & 16711680)) | (unsigned int )(((int )*((js->string + offset) + 2) << 8) & 65280)) | (unsigned int )((int )*((js->string + offset) + 3) & 255);
#line 918
  if (ret == 4294967295U) {
#line 919
    ret = 4294967294U;
  }
#line 921
  return (ret);
}
}
#line 929 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStrOS.c"
int js_strnlen(char *s , uint32_t limit ) 
{ 
  uint32_t len ;
  char *tmp ;

  {
#line 931
  if (limit > 2147483600U) {
#line 932
    return (-1);
  } else
#line 931
  if (limit < 0U) {
#line 932
    return (-1);
  }
#line 934
  if ((unsigned long )s == (unsigned long )((void *)0)) {
#line 935
    return (-1);
  }
#line 937
  len = (uint32_t )0;
  {
#line 938
  while (1) {
    while_continue: /* CIL Label */ ;
#line 938
    if (len < limit) {
#line 938
      tmp = s;
#line 938
      s ++;
#line 938
      if (! *tmp) {
#line 938
        goto while_break;
      }
    } else {
#line 938
      goto while_break;
    }
#line 939
    len ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 941
  return ((int )len);
}
}
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/functions_dns.h"
int hname_2rfc1035(js_string *hostname ) ;
#line 56
int hname_2rfc1035_starwhitis(js_string *hostname , int starwhitis ) ;
#line 64
int email_2rfc1035(js_string *hostname ) ;
#line 68
void init_header(q_header *header ) ;
#line 75
int make_hdr(q_header *header , js_string *js ) ;
#line 91
int read_hdr(js_string *js , q_header *header ) ;
#line 127
int read_rr_h(js_string *js , q_rr *hdr , int offset ) ;
#line 133
int read_soa(js_string *js , rr_soa *soa , int offset ) ;
#line 141
int hname_translate(js_string *hostname , int qtype ) ;
#line 148
int email_translate(js_string *hostname ) ;
#line 165
int make_question(q_question *question , js_string *js ) ;
#line 173
int read_question(js_string *js , q_question *question , int offset ) ;
#line 180
int read_ns(js_string *in , js_string *out , int offset ) ;
#line 187
int read_txt(js_string *in , js_string *out , int offset ) ;
#line 201
js_string *squeeze_to_fit(js_string *packet ) ;
#line 33 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int dlabel_length(js_string *raw , unsigned int offset ) 
{ 
  int length ;
  unsigned char toread ;
  int tmp ;

  {
  {
#line 39
  tmp = js_has_sanity(raw);
  }
#line 39
  if (tmp == -1) {
#line 40
    return (-1);
  }
#line 41
  if (raw->unit_size != 1U) {
#line 42
    return (-1);
  }
#line 44
  length = 0;
#line 45
  if (offset > raw->unit_count) {
#line 46
    return (-1);
  }
#line 47
  toread = *(raw->string + offset);
  {
#line 48
  while (1) {
    while_continue: /* CIL Label */ ;
#line 48
    if (length < 256) {
#line 48
      if ((int )toread > 0) {
#line 48
        if (! ((int )toread != 95)) {
#line 48
          goto while_break;
        }
      } else {
#line 48
        goto while_break;
      }
    } else {
#line 48
      goto while_break;
    }
#line 49
    if ((int )toread >= 192) {
#line 50
      if ((unsigned int )(length + 2) + offset <= raw->unit_count) {
#line 51
        return (length + 2);
      } else {
#line 53
        return (-1);
      }
    }
#line 55
    if ((int )toread > 63) {
#line 56
      return (-1);
    }
#line 57
    length += (int )toread + 1;
#line 59
    if ((unsigned int )length + offset > raw->unit_count) {
#line 60
      return (-1);
    }
#line 61
    toread = *((raw->string + length) + offset);
  }
  while_break: /* CIL Label */ ;
  }
#line 64
  if ((unsigned int )(length + 1) + offset <= raw->unit_count) {
#line 65
    return (length + 1);
  }
#line 67
  return (-1);
}
}
#line 74 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
void init_header(q_header *header ) 
{ 


  {
#line 75
  header->id = (uint16_t )0;
#line 76
  header->qr = 0;
#line 77
  header->opcode = 0;
#line 78
  header->aa = 0;
#line 79
  header->tc = 0;
#line 80
  header->rd = 0;
#line 81
  header->ra = 0;
#line 82
  header->z = 0;
#line 83
  header->rcode = 0;
#line 84
  header->qdcount = (uint16_t )0;
#line 85
  header->ancount = (uint16_t )0;
#line 86
  header->nscount = (uint16_t )0;
#line 87
  header->arcount = (uint16_t )0;
#line 88
  return;
}
}
#line 96 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int make_hdr(q_header *header , js_string *js ) 
{ 
  unsigned char *raw ;
  int tmp ;
  unsigned char tmp___0 ;

  {
  {
#line 100
  tmp = js_has_sanity(js);
  }
#line 100
  if (tmp == -1) {
#line 101
    return (-1);
  }
#line 102
  if (js->unit_size != 1U) {
#line 103
    return (-1);
  }
#line 104
  if (js->max_count < 14U) {
#line 105
    return (-1);
  }
#line 108
  raw = js->string;
#line 111
  *(raw + 0) = (unsigned char )(((int )header->id & 65280) >> 8);
#line 112
  *(raw + 1) = (unsigned char )((int )header->id & 255);
#line 114
  tmp___0 = (unsigned char)0;
#line 114
  *(raw + 3) = tmp___0;
#line 114
  *(raw + 2) = tmp___0;
#line 115
  if (header->qr == 1) {
#line 116
    *(raw + 2) = (unsigned char )((int )*(raw + 2) | 128);
  }
#line 117
  *(raw + 2) = (unsigned char )((int )*(raw + 2) | ((header->opcode & 15) << 3));
#line 118
  if (header->aa == 1) {
#line 119
    *(raw + 2) = (unsigned char )((int )*(raw + 2) | 4);
  }
#line 120
  if (header->tc == 1) {
#line 121
    *(raw + 2) = (unsigned char )((int )*(raw + 2) | 2);
  }
#line 122
  if (header->rd == 1) {
#line 123
    *(raw + 2) = (unsigned char )((int )*(raw + 2) | 1);
  }
#line 124
  if (header->ra == 1) {
#line 125
    *(raw + 3) = (unsigned char )((int )*(raw + 3) | 128);
  }
#line 126
  *(raw + 3) = (unsigned char )((int )*(raw + 3) | ((header->z & 7) << 4));
#line 127
  *(raw + 3) = (unsigned char )((int )*(raw + 3) | (header->rcode & 15));
#line 129
  *(raw + 4) = (unsigned char )(((int )header->qdcount & 65280) >> 8);
#line 130
  *(raw + 5) = (unsigned char )((int )header->qdcount & 255);
#line 131
  *(raw + 6) = (unsigned char )(((int )header->ancount & 65280) >> 8);
#line 132
  *(raw + 7) = (unsigned char )((int )header->ancount & 255);
#line 133
  *(raw + 8) = (unsigned char )(((int )header->nscount & 65280) >> 8);
#line 134
  *(raw + 9) = (unsigned char )((int )header->nscount & 255);
#line 135
  *(raw + 10) = (unsigned char )(((int )header->arcount & 65280) >> 8);
#line 136
  *(raw + 11) = (unsigned char )((int )header->arcount & 255);
#line 139
  if (js->max_count >= 12U) {
#line 140
    js->unit_count = 12U;
  }
#line 142
  return (1);
}
}
#line 152 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_hdr(js_string *js , q_header *header ) 
{ 
  unsigned char *raw ;
  int tmp ;

  {
  {
#line 156
  tmp = js_has_sanity(js);
  }
#line 156
  if (tmp == -1) {
#line 157
    return (-1);
  }
#line 158
  if (js->unit_size != 1U) {
#line 159
    return (-1);
  }
#line 160
  if (js->max_count < 14U) {
#line 161
    return (-1);
  }
#line 163
  raw = js->string;
#line 166
  header->id = (uint16_t )(((int )*(raw + 0) << 8) | (int )*(raw + 1));
#line 168
  if ((int )*(raw + 2) & 128) {
#line 169
    header->qr = 1;
  } else {
#line 171
    header->qr = 0;
  }
#line 172
  header->opcode = ((int )*(raw + 2) & 120) >> 3;
#line 173
  if ((int )*(raw + 2) & 4) {
#line 174
    header->aa = 1;
  } else {
#line 176
    header->aa = 0;
  }
#line 177
  if ((int )*(raw + 2) & 2) {
#line 178
    header->tc = 1;
  } else {
#line 180
    header->tc = 0;
  }
#line 181
  if ((int )*(raw + 2) & 1) {
#line 182
    header->rd = 1;
  } else {
#line 184
    header->rd = 0;
  }
#line 185
  if ((int )*(raw + 3) & 128) {
#line 186
    header->ra = 1;
  } else {
#line 188
    header->ra = 0;
  }
#line 189
  header->z = ((int )*(raw + 3) & 112) >> 4;
#line 190
  header->rcode = (int )*(raw + 3) & 15;
#line 192
  header->qdcount = (uint16_t )(((int )*(raw + 4) << 8) | (int )*(raw + 5));
#line 193
  header->ancount = (uint16_t )(((int )*(raw + 6) << 8) | (int )*(raw + 7));
#line 194
  header->nscount = (uint16_t )(((int )*(raw + 8) << 8) | (int )*(raw + 9));
#line 195
  header->arcount = (uint16_t )(((int )*(raw + 10) << 8) | (int )*(raw + 11));
#line 197
  return (1);
}
}
#line 206 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int make_question(q_question *question , js_string *js ) 
{ 
  int counter ;
  unsigned char toread ;
  unsigned char read___0 ;
  int offset ;
  unsigned char *raw ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 211
  offset = (int )js->unit_count;
#line 215
  toread = (unsigned char)0;
#line 215
  counter = (int )toread;
#line 218
  tmp = js_has_sanity(js);
  }
#line 218
  if (tmp == -1) {
#line 219
    return (-1);
  }
#line 220
  if (js->unit_size != 1U) {
#line 221
    return (-1);
  }
  {
#line 222
  tmp___0 = js_has_sanity(question->qname);
  }
#line 222
  if (tmp___0 == -1) {
#line 223
    return (-1);
  }
#line 224
  if ((question->qname)->unit_size != 1U) {
#line 225
    return (-1);
  }
#line 226
  if ((unsigned int )offset >= js->max_count) {
#line 227
    return (-1);
  }
#line 229
  raw = (question->qname)->string;
  {
#line 232
  while (1) {
    while_continue: /* CIL Label */ ;
#line 232
    if (! (counter < 256)) {
#line 232
      goto while_break;
    }
#line 233
    toread = *(raw + counter);
#line 234
    if ((int )toread > 63) {
#line 235
      return (-1);
    }
#line 236
    read___0 = (unsigned char)0;
#line 237
    if ((int )toread == 0) {
#line 238
      goto while_break;
    }
    {
#line 239
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 239
      if (! ((int )read___0 <= (int )toread)) {
#line 239
        goto while_break___0;
      }
#line 241
      if ((unsigned int )counter < (question->qname)->max_count) {
#line 241
        if ((unsigned int )(counter + offset) < js->max_count) {
#line 244
          *((js->string + offset) + counter) = *(raw + counter);
        } else {
#line 246
          return (-1);
        }
      } else {
#line 246
        return (-1);
      }
#line 247
      read___0 = (unsigned char )((int )read___0 + 1);
#line 248
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 253
  *((js->string + offset) + counter) = (unsigned char)0;
#line 254
  counter ++;
#line 257
  if ((unsigned int )((counter + offset) + 4) < js->max_count) {
#line 258
    raw = (js->string + counter) + offset;
#line 259
    *(raw + 0) = (unsigned char )(((int )question->qtype & 65280) >> 8);
#line 260
    *(raw + 1) = (unsigned char )((int )question->qtype & 255);
#line 261
    *(raw + 2) = (unsigned char )(((int )question->qclass & 65280) >> 8);
#line 262
    *(raw + 3) = (unsigned char )((int )question->qclass & 255);
  } else {
#line 265
    return (-1);
  }
#line 268
  if (js->max_count > (unsigned int )((counter + offset) + 4)) {
#line 269
    js->unit_count = (unsigned int )((counter + offset) + 4);
  }
#line 271
  return (1);
}
}
#line 281 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_question(js_string *js , q_question *question , int offset ) 
{ 
  int counter ;
  unsigned char toread ;
  unsigned char read___0 ;
  unsigned char *raw ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 288
  toread = (unsigned char)0;
#line 288
  counter = (int )toread;
#line 291
  tmp = js_has_sanity(js);
  }
#line 291
  if (tmp == -1) {
#line 292
    return (-1);
  }
#line 293
  if (js->unit_size != 1U) {
#line 294
    return (-1);
  }
  {
#line 295
  tmp___0 = js_has_sanity(question->qname);
  }
#line 295
  if (tmp___0 == -1) {
#line 296
    return (-1);
  }
#line 297
  if ((question->qname)->unit_size != 1U) {
#line 298
    return (-1);
  }
#line 299
  if ((unsigned int )offset >= js->unit_count) {
#line 300
    return (-1);
  }
#line 302
  raw = js->string + offset;
  {
#line 305
  while (1) {
    while_continue: /* CIL Label */ ;
#line 305
    if (! (counter < 256)) {
#line 305
      goto while_break;
    }
#line 306
    toread = *(raw + counter);
#line 307
    if ((int )toread > 63) {
#line 308
      return (-1);
    }
#line 309
    read___0 = (unsigned char)0;
#line 310
    if ((int )toread == 0) {
#line 311
      goto while_break;
    }
    {
#line 312
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 312
      if (! ((int )read___0 <= (int )toread)) {
#line 312
        goto while_break___0;
      }
#line 314
      if ((unsigned int )counter < (question->qname)->max_count) {
#line 314
        if ((unsigned int )(counter + offset) < js->unit_count) {
#line 317
          *((question->qname)->string + counter) = *(raw + counter);
        } else {
#line 319
          return (-1);
        }
      } else {
#line 319
        return (-1);
      }
#line 320
      read___0 = (unsigned char )((int )read___0 + 1);
#line 321
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 327
  *((question->qname)->string + counter) = (unsigned char)0;
#line 328
  counter ++;
#line 331
  if ((unsigned int )((counter + offset) + 4) <= js->unit_count) {
#line 332
    raw = (js->string + counter) + offset;
#line 333
    question->qtype = (uint16_t )((((int )*(raw + 0) << 8) & 65280) | ((int )*(raw + 1) & 255));
#line 334
    question->qclass = (uint16_t )((((int )*(raw + 2) << 8) & 65280) | ((int )*(raw + 3) & 255));
  } else {
#line 337
    return (-1);
  }
#line 340
  if ((unsigned int )counter < (question->qname)->max_count) {
#line 341
    (question->qname)->unit_count = (unsigned int )counter;
  } else {
#line 343
    return (-1);
  }
#line 345
  return (counter + 4);
}
}
#line 356 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int hname_translate(js_string *hostname , int qtype ) 
{ 
  int counter ;
  int special_root_case ;
  unsigned char toread ;
  unsigned char *raw ;
  int dotseen ;
  int tmp ;

  {
  {
#line 357
  counter = 0;
#line 357
  special_root_case = 0;
#line 358
  toread = (unsigned char)0;
#line 359
  raw = (unsigned char *)0;
#line 360
  dotseen = 0;
#line 363
  tmp = js_has_sanity(hostname);
  }
#line 363
  if (tmp == -1) {
#line 364
    return (-1);
  }
#line 365
  if (hostname->unit_size != 1U) {
#line 366
    return (-1);
  }
#line 367
  if (hostname->unit_count < 1U) {
#line 368
    return (-1);
  }
#line 371
  toread = *(hostname->string);
#line 374
  if (hostname->unit_count == 1U) {
#line 374
    if ((int )toread == 0) {
#line 375
      special_root_case = 1;
    }
  }
#line 378
  raw = hostname->string;
  {
#line 380
  if (qtype == 1) {
#line 380
    goto case_1;
  }
#line 383
  if (qtype == 2) {
#line 383
    goto case_2;
  }
#line 386
  if (qtype == 5) {
#line 386
    goto case_5;
  }
#line 389
  if (qtype == 6) {
#line 389
    goto case_6;
  }
#line 392
  if (qtype == 12) {
#line 392
    goto case_12;
  }
#line 395
  if (qtype == 15) {
#line 395
    goto case_15;
  }
#line 398
  if (qtype == 16) {
#line 398
    goto case_16;
  }
#line 401
  if (qtype == 255) {
#line 401
    goto case_255;
  }
#line 404
  if (qtype == -2) {
#line 404
    goto case_neg_2;
  }
#line 408
  if (qtype == -301) {
#line 408
    goto case_neg_301;
  }
#line 408
  if (qtype == -300) {
#line 408
    goto case_neg_301;
  }
#line 412
  goto switch_default;
  case_1: /* CIL Label */ 
#line 381
  *raw = (unsigned char )'A';
#line 382
  goto switch_break;
  case_2: /* CIL Label */ 
#line 384
  *raw = (unsigned char )'N';
#line 385
  goto switch_break;
  case_5: /* CIL Label */ 
#line 387
  *raw = (unsigned char )'C';
#line 388
  goto switch_break;
  case_6: /* CIL Label */ 
#line 390
  *raw = (unsigned char )'S';
#line 391
  goto switch_break;
  case_12: /* CIL Label */ 
#line 393
  *raw = (unsigned char )'P';
#line 394
  goto switch_break;
  case_15: /* CIL Label */ 
#line 396
  *raw = (unsigned char )'@';
#line 397
  goto switch_break;
  case_16: /* CIL Label */ 
#line 399
  *raw = (unsigned char )'T';
#line 400
  goto switch_break;
  case_255: /* CIL Label */ 
#line 402
  *raw = (unsigned char )'Z';
#line 403
  goto switch_break;
  case_neg_2: /* CIL Label */ 
#line 405
  *raw = (unsigned char )'|';
#line 406
  goto switch_break;
  case_neg_301: /* CIL Label */ 
  case_neg_300: /* CIL Label */ 
#line 410
  *raw = (unsigned char )' ';
#line 411
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 413
  *raw = (unsigned char )'U';
  switch_break: /* CIL Label */ ;
  }
#line 418
  if (special_root_case == 1) {
#line 419
    if (hostname->max_count < 2U) {
#line 420
      return (-1);
    }
#line 421
    hostname->unit_count = 2U;
#line 422
    raw ++;
#line 423
    *raw = (unsigned char )'.';
#line 424
    return (1);
  }
#line 428
  counter = 0;
#line 429
  dotseen = 0;
  {
#line 430
  while (1) {
    while_continue: /* CIL Label */ ;
#line 430
    if (counter < 256) {
#line 430
      if (! ((int )toread > 0)) {
#line 430
        goto while_break;
      }
    } else {
#line 430
      goto while_break;
    }
#line 431
    if ((int )toread > 63) {
#line 432
      return (-1);
    }
#line 433
    counter += (int )toread + 1;
#line 435
    if ((unsigned int )counter > hostname->unit_count) {
#line 436
      return (-1);
    }
#line 437
    toread = *(raw + counter);
#line 439
    if ((unsigned int )counter <= hostname->unit_count) {
#line 440
      if (qtype != -301) {
#line 441
        *(raw + counter) = (unsigned char )'.';
      } else
#line 440
      if (dotseen > 0) {
#line 441
        *(raw + counter) = (unsigned char )'.';
      } else {
#line 443
        *(raw + counter) = (unsigned char )'@';
#line 444
        dotseen = 1;
      }
    } else {
#line 447
      return (-1);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 451
  return (1);
}
}
#line 460 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int email_translate(js_string *hostname ) 
{ 
  int counter ;
  unsigned char toread ;
  int first ;
  unsigned char *raw ;
  int tmp ;

  {
  {
#line 463
  first = 1;
#line 467
  tmp = js_has_sanity(hostname);
  }
#line 467
  if (tmp == -1) {
#line 468
    return (-1);
  }
#line 469
  if (hostname->unit_size != 1U) {
#line 470
    return (-1);
  }
#line 471
  if (hostname->unit_count < 1U) {
#line 472
    return (-1);
  }
#line 475
  toread = *(hostname->string);
#line 478
  raw = hostname->string;
#line 479
  *raw = (unsigned char )'|';
#line 482
  counter = 0;
  {
#line 483
  while (1) {
    while_continue: /* CIL Label */ ;
#line 483
    if (counter < 256) {
#line 483
      if (! ((int )toread > 0)) {
#line 483
        goto while_break;
      }
    } else {
#line 483
      goto while_break;
    }
#line 484
    if ((int )toread > 63) {
#line 485
      return (-1);
    }
#line 486
    counter += (int )toread + 1;
#line 488
    if ((unsigned int )counter > hostname->unit_count) {
#line 489
      return (-1);
    }
#line 490
    toread = *(raw + counter);
#line 492
    if ((unsigned int )counter <= hostname->unit_count) {
#line 493
      if (first) {
#line 494
        *(raw + counter) = (unsigned char )'@';
#line 495
        first = 0;
      } else {
#line 498
        *(raw + counter) = (unsigned char )'.';
      }
    } else {
#line 502
      return (-1);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 505
  return (1);
}
}
#line 516 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int hname_2rfc1035(js_string *hostname ) 
{ 
  int tmp ;

  {
  {
#line 517
  tmp = hname_2rfc1035_starwhitis(hostname, 0);
  }
#line 517
  return (tmp);
}
}
#line 523 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int hname_2rfc1035_starwhitis(js_string *hostname , int starwhitis ) 
{ 
  int counter ;
  int seen ;
  unsigned char *raw ;
  unsigned char *towrite ;
  int ret ;
  int tmp ;

  {
  {
#line 526
  ret = -2;
#line 529
  tmp = js_has_sanity(hostname);
  }
#line 529
  if (tmp == -1) {
#line 530
    return (-1);
  }
#line 531
  if (hostname->unit_size != 1U) {
#line 532
    return (-1);
  }
#line 533
  if (hostname->unit_count < 1U) {
#line 534
    return (-1);
  }
#line 537
  towrite = hostname->string;
#line 537
  raw = towrite;
  {
#line 541
  if ((int )*raw == 65) {
#line 541
    goto case_65;
  }
#line 544
  if ((int )*raw == 78) {
#line 544
    goto case_78;
  }
#line 547
  if ((int )*raw == 67) {
#line 547
    goto case_67;
  }
#line 550
  if ((int )*raw == 83) {
#line 550
    goto case_83;
  }
#line 553
  if ((int )*raw == 80) {
#line 553
    goto case_80;
  }
#line 556
  if ((int )*raw == 64) {
#line 556
    goto case_64;
  }
#line 559
  if ((int )*raw == 84) {
#line 559
    goto case_84;
  }
#line 562
  if ((int )*raw == 85) {
#line 562
    goto case_85;
  }
#line 565
  if ((int )*raw == 90) {
#line 565
    goto case_90;
  }
#line 568
  goto switch_default;
  case_65: /* CIL Label */ 
#line 542
  ret = 1;
#line 543
  goto switch_break;
  case_78: /* CIL Label */ 
#line 545
  ret = 2;
#line 546
  goto switch_break;
  case_67: /* CIL Label */ 
#line 548
  ret = 5;
#line 549
  goto switch_break;
  case_83: /* CIL Label */ 
#line 551
  ret = 6;
#line 552
  goto switch_break;
  case_80: /* CIL Label */ 
#line 554
  ret = 12;
#line 555
  goto switch_break;
  case_64: /* CIL Label */ 
#line 557
  ret = 15;
#line 558
  goto switch_break;
  case_84: /* CIL Label */ 
#line 560
  ret = 16;
#line 561
  goto switch_break;
  case_85: /* CIL Label */ 
#line 563
  ret = -3;
#line 564
  goto switch_break;
  case_90: /* CIL Label */ 
#line 566
  ret = 255;
#line 567
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 569
  return (-2);
  switch_break: /* CIL Label */ ;
  }
#line 573
  if ((int )*(raw + 1) == 46) {
#line 573
    if (hostname->unit_count == 2U) {
#line 574
      *raw = (unsigned char)0;
#line 575
      hostname->unit_count = 1U;
#line 576
      return (ret);
    }
  }
#line 580
  if ((int )*(raw + 1) == 42) {
#line 580
    if (hostname->unit_count == 2U) {
#line 580
      if (starwhitis == 1) {
#line 582
        *raw = (unsigned char )'_';
#line 583
        hostname->unit_count = 1U;
#line 584
        return (ret);
      }
    }
  }
#line 588
  counter = 0;
#line 588
  seen = counter;
  {
#line 589
  while (1) {
    while_continue: /* CIL Label */ ;
#line 589
    if (counter < 256) {
#line 589
      if (! ((unsigned int )counter < hostname->unit_count)) {
#line 589
        goto while_break;
      }
    } else {
#line 589
      goto while_break;
    }
#line 590
    counter ++;
#line 591
    if ((unsigned int )counter > hostname->unit_count) {
#line 592
      return (-1);
    }
#line 593
    if ((int )*(raw + counter) == 46) {
#line 594
      if (seen < 1) {
#line 595
        return (-1);
      } else
#line 594
      if (seen > 63) {
#line 595
        return (-1);
      }
#line 596
      *towrite = (unsigned char )seen;
#line 597
      towrite = raw + counter;
#line 598
      seen = 0;
    } else {
#line 601
      seen ++;
    }
#line 602
    if ((unsigned int )counter == hostname->unit_count - 1U) {
#line 603
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 607
  if (counter < 256) {
#line 607
    if ((int )*(raw + counter) == 46) {
#line 608
      *(raw + counter) = (unsigned char)0;
    } else {
#line 607
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 610
  if (counter < 256) {
#line 610
    if (counter > 1) {
#line 610
      if ((int )*(raw + counter) == 42) {
#line 610
        if (hostname->unit_count > 1U) {
#line 610
          if (starwhitis == 1) {
#line 612
            *((raw + counter) - 1) = (unsigned char )'_';
#line 613
            (hostname->unit_count) --;
          } else {
#line 616
            return (-1);
          }
        } else {
#line 616
          return (-1);
        }
      } else {
#line 616
        return (-1);
      }
    } else {
#line 616
      return (-1);
    }
  } else {
#line 616
    return (-1);
  }
#line 619
  return (ret);
}
}
#line 629 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int email_2rfc1035(js_string *hostname ) 
{ 
  int counter ;
  int seen ;
  unsigned char *raw ;
  unsigned char *towrite ;
  int firstat ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 633
  firstat = 1;
#line 636
  tmp = js_has_sanity(hostname);
  }
#line 636
  if (tmp == -1) {
#line 637
    return (-1);
  }
#line 638
  if (hostname->unit_size != 1U) {
#line 639
    return (-1);
  }
#line 640
  if (hostname->unit_count < 1U) {
#line 641
    return (-1);
  }
#line 644
  towrite = hostname->string;
#line 644
  raw = towrite;
#line 647
  counter = 0;
#line 647
  seen = counter;
#line 649
  if (hostname->unit_count == 2U) {
#line 649
    if ((int )*(raw + 1) == 46) {
#line 650
      hostname->unit_count = 1U;
#line 651
      *(hostname->string) = (unsigned char )'\000';
#line 652
      return (1);
    }
  }
  {
#line 655
  while (1) {
    while_continue: /* CIL Label */ ;
#line 655
    if (counter < 256) {
#line 655
      if (! ((unsigned int )counter < hostname->unit_count)) {
#line 655
        goto while_break;
      }
    } else {
#line 655
      goto while_break;
    }
#line 656
    counter ++;
#line 657
    if ((unsigned int )counter > hostname->unit_count) {
#line 658
      return (-1);
    }
#line 659
    if (! firstat) {
#line 659
      if ((int )*(raw + counter) == 46) {
#line 659
        goto _L;
      } else {
#line 659
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 659
    if (firstat) {
#line 659
      if ((int )*(raw + counter) == 64) {
        _L: /* CIL Label */ 
#line 661
        firstat = 0;
#line 662
        if (seen < 1) {
#line 663
          return (-1);
        } else
#line 662
        if (seen > 63) {
#line 663
          return (-1);
        }
#line 664
        *towrite = (unsigned char )seen;
#line 665
        towrite = raw + counter;
#line 666
        seen = 0;
      } else {
#line 669
        seen ++;
      }
    } else {
#line 669
      seen ++;
    }
#line 670
    if ((unsigned int )counter == hostname->unit_count - 1U) {
#line 671
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 676
  if (firstat) {
    {
#line 677
    tmp___0 = hname_2rfc1035_starwhitis(hostname, 0);
    }
#line 677
    return (tmp___0);
  }
#line 681
  if (counter < 256) {
#line 681
    if ((int )*(raw + counter) == 46) {
#line 682
      *(raw + counter) = (unsigned char)0;
    } else {
#line 684
      return (-1);
    }
  } else {
#line 684
    return (-1);
  }
#line 686
  return (1);
}
}
#line 697 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_rr_h(js_string *js , q_rr *hdr , int offset ) 
{ 
  int counter ;
  unsigned char toread ;
  unsigned char read___0 ;
  unsigned char *raw ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 703
  toread = (unsigned char)0;
#line 703
  counter = (int )toread;
#line 706
  tmp = js_has_sanity(js);
  }
#line 706
  if (tmp == -1) {
#line 707
    return (-1);
  }
#line 708
  if (js->unit_size != 1U) {
#line 709
    return (-1);
  }
  {
#line 710
  tmp___0 = js_has_sanity(hdr->name);
  }
#line 710
  if (tmp___0 == -1) {
#line 711
    return (-1);
  }
#line 712
  if ((hdr->name)->unit_size != 1U) {
#line 713
    return (-1);
  }
#line 714
  if ((unsigned int )offset >= js->max_count) {
#line 715
    return (-1);
  }
#line 717
  raw = js->string + offset;
  {
#line 720
  while (1) {
    while_continue: /* CIL Label */ ;
#line 720
    if (! (counter < 256)) {
#line 720
      goto while_break;
    }
#line 721
    if ((unsigned int )(offset + counter) > js->unit_count) {
#line 722
      return (-1);
    }
#line 723
    toread = *(raw + counter);
#line 724
    if ((int )toread > 63) {
#line 725
      return (-1);
    }
#line 726
    read___0 = (unsigned char)0;
#line 727
    if ((int )toread == 0) {
#line 728
      goto while_break;
    }
    {
#line 729
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 729
      if (! ((int )read___0 <= (int )toread)) {
#line 729
        goto while_break___0;
      }
#line 731
      if ((unsigned int )counter < (hdr->name)->max_count) {
#line 731
        if ((unsigned int )(counter + offset) < js->unit_count) {
#line 734
          *((hdr->name)->string + counter) = *(raw + counter);
        } else {
#line 736
          return (-1);
        }
      } else {
#line 736
        return (-1);
      }
#line 737
      read___0 = (unsigned char )((int )read___0 + 1);
#line 738
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 744
  *((hdr->name)->string + counter) = *(raw + counter);
#line 746
  counter ++;
#line 749
  if ((unsigned int )((counter + offset) + 10) <= js->unit_count) {
#line 750
    raw = (js->string + counter) + offset;
#line 751
    hdr->type = (uint16_t )(((int )*(raw + 0) << 8) | (int )*(raw + 1));
#line 752
    hdr->class = (uint16_t )(((int )*(raw + 2) << 8) | (int )*(raw + 3));
#line 753
    hdr->ttl = (uint32_t )(((((int )*(raw + 4) << 24) | ((int )*(raw + 5) << 16)) | ((int )*(raw + 6) << 8)) | (int )*(raw + 7));
#line 754
    hdr->rdlength = (uint16_t )(((int )*(raw + 8) << 8) | (int )*(raw + 9));
  } else {
#line 757
    return (-1);
  }
#line 759
  if ((unsigned int )counter < (hdr->name)->max_count) {
#line 760
    (hdr->name)->unit_count = (unsigned int )counter;
  } else {
#line 762
    return (-1);
  }
#line 764
  return (counter + 10);
}
}
#line 773 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_soa(js_string *js , rr_soa *soa , int offset ) 
{ 
  int counter ;
  unsigned char read___0 ;
  unsigned char toread ;
  unsigned char *raw ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 780
  tmp = js_has_sanity(js);
  }
#line 780
  if (tmp == -1) {
#line 781
    return (-1);
  }
  {
#line 782
  tmp___0 = js_has_sanity(soa->mname);
  }
#line 782
  if (tmp___0 == -1) {
#line 783
    return (-1);
  }
  {
#line 784
  tmp___1 = js_has_sanity(soa->rname);
  }
#line 784
  if (tmp___1 == -1) {
#line 785
    return (-1);
  }
#line 786
  if (js->unit_size != 1U) {
#line 787
    return (-1);
  }
#line 788
  if ((soa->mname)->unit_size != 1U) {
#line 789
    return (-1);
  }
#line 790
  if ((soa->rname)->unit_size != 1U) {
#line 791
    return (-1);
  }
#line 792
  if (js->unit_count < (unsigned int )offset) {
#line 793
    return (-1);
  }
#line 795
  raw = js->string + offset;
#line 798
  counter = 0;
  {
#line 799
  while (1) {
    while_continue: /* CIL Label */ ;
#line 799
    if (! (counter < 256)) {
#line 799
      goto while_break;
    }
#line 800
    toread = *(raw + counter);
#line 801
    if ((int )toread > 63) {
#line 802
      return (-1);
    }
#line 803
    read___0 = (unsigned char)0;
#line 804
    if ((int )toread == 0) {
#line 805
      goto while_break;
    }
    {
#line 806
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 806
      if (! ((int )read___0 <= (int )toread)) {
#line 806
        goto while_break___0;
      }
#line 808
      if ((unsigned int )counter < (soa->mname)->max_count) {
#line 808
        if ((unsigned int )(counter + offset) < js->unit_count) {
#line 811
          *((soa->mname)->string + counter) = *(raw + counter);
        } else {
#line 813
          return (-1);
        }
      } else {
#line 813
        return (-1);
      }
#line 814
      read___0 = (unsigned char )((int )read___0 + 1);
#line 815
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 820
  *((soa->mname)->string + counter) = (unsigned char)0;
#line 821
  counter ++;
#line 822
  offset += counter;
#line 823
  if ((soa->mname)->max_count < (unsigned int )counter) {
#line 824
    return (-1);
  }
#line 825
  (soa->mname)->unit_count = (unsigned int )counter;
#line 827
  raw = js->string + offset;
#line 830
  counter = 0;
  {
#line 831
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 831
    if (! (counter < 256)) {
#line 831
      goto while_break___1;
    }
#line 832
    toread = *(raw + counter);
#line 833
    if ((int )toread > 63) {
#line 834
      return (-1);
    }
#line 835
    read___0 = (unsigned char)0;
#line 836
    if ((int )toread == 0) {
#line 837
      goto while_break___1;
    }
    {
#line 838
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 838
      if (! ((int )read___0 <= (int )toread)) {
#line 838
        goto while_break___2;
      }
#line 840
      if ((unsigned int )counter < (soa->rname)->max_count) {
#line 840
        if ((unsigned int )(counter + offset) < js->unit_count) {
#line 843
          *((soa->rname)->string + counter) = *(raw + counter);
        } else {
#line 845
          return (-1);
        }
      } else {
#line 845
        return (-1);
      }
#line 846
      read___0 = (unsigned char )((int )read___0 + 1);
#line 847
      counter ++;
    }
    while_break___2: /* CIL Label */ ;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
#line 852
  *((soa->rname)->string + counter) = (unsigned char)0;
#line 853
  counter ++;
#line 854
  if ((soa->rname)->max_count < (unsigned int )counter) {
#line 855
    return (-1);
  }
#line 856
  (soa->rname)->unit_count = (unsigned int )counter;
#line 858
  if ((unsigned int )((counter + offset) + 20) > js->unit_count) {
#line 859
    return (-1);
  }
#line 861
  raw = (js->string + counter) + offset;
#line 862
  soa->serial = (uint32_t )(((((int )*(raw + 0) << 24) | ((int )*(raw + 1) << 16)) | ((int )*(raw + 2) << 8)) | (int )*(raw + 3));
#line 863
  soa->refresh = ((((int )*(raw + 4) << 24) | ((int )*(raw + 5) << 16)) | ((int )*(raw + 6) << 8)) | (int )*(raw + 7);
#line 864
  soa->retry = ((((int )*(raw + 8) << 24) | ((int )*(raw + 9) << 16)) | ((int )*(raw + 10) << 8)) | (int )*(raw + 11);
#line 865
  soa->expire = ((((int )*(raw + 12) << 24) | ((int )*(raw + 13) << 16)) | ((int )*(raw + 14) << 8)) | (int )*(raw + 15);
#line 866
  soa->minimum = (uint32_t )(((((int )*(raw + 16) << 24) | ((int )*(raw + 17) << 16)) | ((int )*(raw + 18) << 8)) | (int )*(raw + 19));
#line 869
  return (counter + 20);
}
}
#line 879 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_ns(js_string *in , js_string *out , int offset ) 
{ 
  uint16_t toread ;
  uint16_t read___0 ;
  int counter ;
  unsigned char *raw ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 885
  tmp = js_has_sanity(in);
  }
#line 885
  if (tmp == -1) {
#line 886
    return (-1);
  }
  {
#line 887
  tmp___0 = js_has_sanity(out);
  }
#line 887
  if (tmp___0 == -1) {
#line 888
    return (-1);
  }
#line 889
  if (in->unit_size != 1U) {
#line 890
    return (-1);
  }
#line 891
  if (out->unit_size != 1U) {
#line 892
    return (-1);
  }
#line 893
  if (in->unit_count < (unsigned int )offset) {
#line 894
    return (-1);
  }
#line 896
  raw = in->string + offset;
#line 898
  counter = 0;
  {
#line 899
  while (1) {
    while_continue: /* CIL Label */ ;
#line 899
    if (! (counter < 256)) {
#line 899
      goto while_break;
    }
#line 900
    toread = (uint16_t )*(raw + counter);
#line 901
    if ((int )toread > 63) {
#line 902
      return (-1);
    }
#line 903
    read___0 = (uint16_t )0;
#line 904
    if ((int )toread == 0) {
#line 905
      goto while_break;
    }
    {
#line 906
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 906
      if (! ((int )read___0 <= (int )toread)) {
#line 906
        goto while_break___0;
      }
#line 908
      if ((unsigned int )counter < out->max_count) {
#line 908
        if ((unsigned int )(counter + offset) < in->unit_count) {
#line 911
          *(out->string + counter) = *(raw + counter);
        } else {
#line 913
          return (-1);
        }
      } else {
#line 913
        return (-1);
      }
#line 914
      read___0 = (uint16_t )((int )read___0 + 1);
#line 915
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 920
  *(out->string + counter) = (unsigned char)0;
#line 921
  counter ++;
#line 922
  offset += counter;
#line 923
  if (out->max_count < (unsigned int )counter) {
#line 924
    return (-1);
  }
#line 925
  out->unit_count = (unsigned int )counter;
#line 927
  return (counter);
}
}
#line 936 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
int read_txt(js_string *in , js_string *out , int offset ) 
{ 
  int counter ;
  unsigned char toread ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 940
  counter = 0;
#line 943
  tmp = js_has_sanity(in);
  }
#line 943
  if (tmp == -1) {
#line 944
    return (-1);
  }
  {
#line 945
  tmp___0 = js_has_sanity(out);
  }
#line 945
  if (tmp___0 == -1) {
#line 946
    return (-1);
  }
#line 947
  if (in->unit_size != 1U) {
#line 948
    return (-1);
  }
#line 949
  if (out->unit_size != 1U) {
#line 950
    return (-1);
  }
#line 951
  if (in->unit_count < (unsigned int )offset) {
#line 952
    return (-1);
  }
#line 955
  toread = *(in->string + offset);
#line 958
  if ((unsigned int )toread >= out->max_count) {
#line 959
    return (-1);
  } else
#line 958
  if ((unsigned int )(offset + (int )toread) >= in->unit_count) {
#line 959
    return (-1);
  }
#line 962
  offset ++;
#line 963
  counter = 0;
  {
#line 963
  while (1) {
    while_continue: /* CIL Label */ ;
#line 963
    if (! (counter < (int )toread)) {
#line 963
      goto while_break;
    }
#line 964
    *(out->string + counter) = *((in->string + offset) + counter);
#line 963
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 966
  out->unit_count = (unsigned int )toread;
#line 967
  return ((int )out->unit_count);
}
}
#line 982 "/home/wheatley/newnew/temp/maradns-2.0.09/dns/Queries.c"
js_string *squeeze_to_fit(js_string *packet ) 
{ 
  q_header hdr ;
  int qd ;
  int an ;
  int ns ;
  int ar ;
  int qc ;
  int count ;
  int offset ;
  int tmp ;
  int len ;
  int len___0 ;

  {
  {
#line 988
  tmp = read_hdr(packet, & hdr);
  }
#line 988
  if (tmp == -1) {
#line 989
    return ((js_string *)0);
  }
#line 992
  qd = (int )hdr.qdcount;
#line 993
  an = (int )hdr.ancount;
#line 994
  ns = (int )hdr.nscount;
#line 995
  ar = (int )hdr.arcount;
#line 1002
  if (hdr.tc == 1) {
#line 1002
    goto _L;
  } else
#line 1002
  if (ns == 0) {
#line 1002
    if (ar == 0) {
      _L: /* CIL Label */ 
      {
#line 1003
      hdr.tc = 1;
#line 1004
      hdr.arcount = (uint16_t )0;
#line 1004
      hdr.nscount = hdr.arcount;
#line 1004
      hdr.ancount = hdr.nscount;
#line 1004
      hdr.qdcount = hdr.ancount;
#line 1005
      make_hdr(& hdr, packet);
      }
#line 1006
      return (packet);
    }
  }
#line 1009
  qc = qd;
#line 1010
  count = (an + ns) + ar;
#line 1011
  offset = 12;
  {
#line 1013
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1013
    if (! (qc > 0)) {
#line 1013
      goto while_break;
    }
    {
#line 1015
    len = dlabel_length(packet, (unsigned int )offset);
    }
#line 1016
    if (len == -1) {
      {
#line 1017
      hdr.tc = 1;
#line 1018
      hdr.arcount = (uint16_t )0;
#line 1018
      hdr.nscount = hdr.arcount;
#line 1018
      hdr.ancount = hdr.nscount;
#line 1018
      hdr.qdcount = hdr.ancount;
#line 1020
      make_hdr(& hdr, packet);
      }
#line 1021
      return (packet);
    }
#line 1023
    len += 4;
#line 1024
    offset += len;
#line 1025
    if ((unsigned int )offset >= packet->unit_count) {
      {
#line 1026
      hdr.tc = 1;
#line 1027
      hdr.arcount = (uint16_t )0;
#line 1027
      hdr.nscount = hdr.arcount;
#line 1027
      hdr.ancount = hdr.nscount;
#line 1027
      hdr.qdcount = hdr.ancount;
#line 1029
      make_hdr(& hdr, packet);
      }
#line 1030
      return (packet);
    }
#line 1032
    qc --;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1036
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 1036
    if (! (count > 1)) {
#line 1036
      goto while_break___0;
    }
    {
#line 1038
    len___0 = dlabel_length(packet, (unsigned int )offset);
    }
#line 1039
    if (len___0 == -1) {
      {
#line 1040
      hdr.tc = 1;
#line 1041
      hdr.arcount = (uint16_t )0;
#line 1041
      hdr.nscount = hdr.arcount;
#line 1041
      hdr.ancount = hdr.nscount;
#line 1041
      hdr.qdcount = hdr.ancount;
#line 1043
      make_hdr(& hdr, packet);
      }
#line 1044
      return (packet);
    }
#line 1046
    len___0 += 8;
#line 1047
    offset += len___0;
#line 1048
    if ((unsigned int )(offset + 2) >= packet->unit_count) {
      {
#line 1049
      hdr.tc = 1;
#line 1050
      hdr.arcount = (uint16_t )0;
#line 1050
      hdr.nscount = hdr.arcount;
#line 1050
      hdr.ancount = hdr.nscount;
#line 1050
      hdr.qdcount = hdr.ancount;
#line 1052
      make_hdr(& hdr, packet);
      }
#line 1053
      return (packet);
    }
#line 1057
    len___0 = (((int )*(packet->string + offset) & 255) << 8) + (int )*((packet->string + offset) + 1);
#line 1059
    offset += len___0 + 2;
#line 1060
    if ((unsigned int )offset >= packet->unit_count) {
      {
#line 1061
      hdr.tc = 1;
#line 1062
      hdr.arcount = (uint16_t )0;
#line 1062
      hdr.nscount = hdr.arcount;
#line 1062
      hdr.ancount = hdr.nscount;
#line 1062
      hdr.qdcount = hdr.ancount;
#line 1064
      make_hdr(& hdr, packet);
      }
#line 1065
      return (packet);
    }
#line 1067
    count --;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1072
  if (ar > 0) {
#line 1073
    ar --;
#line 1074
    hdr.arcount = (uint16_t )ar;
  } else
#line 1075
  if (ns > 0) {
#line 1076
    ns --;
#line 1077
    hdr.nscount = (uint16_t )ns;
  } else {
    {
#line 1079
    hdr.tc = 1;
#line 1080
    hdr.arcount = (uint16_t )0;
#line 1080
    hdr.nscount = hdr.arcount;
#line 1080
    hdr.ancount = hdr.nscount;
#line 1080
    hdr.qdcount = hdr.ancount;
#line 1081
    make_hdr(& hdr, packet);
    }
#line 1082
    return (packet);
  }
  {
#line 1085
  hdr.tc = 0;
#line 1086
  make_hdr(& hdr, packet);
#line 1087
  packet->unit_count = (unsigned int )offset;
  }
#line 1088
  return (packet);
}
}
#line 57 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.h"
int rngKeySetupEnc(u32 *rk , u8 const   *cipherKey , int keyBits ) ;
#line 58
void rngEncrypt(u32 const   *rk , int Nr , u8 const   *pt , u8 *ct ) ;
#line 111 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.h"
int makeKey(keyInstance *key___6 , MARA_BYTE direction , int keyLen , char *keyMaterial ) ;
#line 113
int cipherInit(cipherInstance *cipher , MARA_BYTE mode , char *IV ) ;
#line 115
int blockEncrypt(cipherInstance *cipher , keyInstance *key___6 , MARA_BYTE *input ,
                 int inputLen , MARA_BYTE *outBuffer ) ;
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.c"
int makeKey(keyInstance *key___6 , MARA_BYTE direction , int keyLen , char *keyMaterial ) 
{ 
  int i ;
  char *keyMat ;
  u8 cipherKey[32] ;
  int v ;

  {
#line 72
  if ((unsigned long )key___6 == (unsigned long )((void *)0)) {
#line 73
    return (-3);
  }
#line 76
  if ((int )direction == 0) {
#line 77
    key___6->direction = direction;
  } else {
#line 79
    return (-1);
  }
#line 82
  if (keyLen == 128) {
#line 83
    key___6->keyLen = keyLen;
  } else {
#line 85
    return (-2);
  }
  {
#line 91
  memcpy((void */* __restrict  */)(key___6->keyMaterial), (void const   */* __restrict  */)keyMaterial,
         (size_t )(keyLen / 8));
#line 95
  keyMat = key___6->keyMaterial;
#line 96
  i = 0;
  }
  {
#line 96
  while (1) {
    while_continue: /* CIL Label */ ;
#line 96
    if (! (i < key___6->keyLen / 8)) {
#line 96
      goto while_break;
    }
#line 112
    v = (int )*keyMat;
#line 113
    keyMat ++;
#line 115
    cipherKey[i] = (u8 )v;
#line 96
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 117
  if ((int )direction == 0) {
    {
#line 118
    key___6->Nr = rngKeySetupEnc(key___6->rk, (u8 const   *)(cipherKey), keyLen);
    }
  } else {
#line 120
    return (-1);
  }
  {
#line 122
  rngKeySetupEnc(key___6->ek, (u8 const   *)(cipherKey), keyLen);
  }
#line 123
  return (1);
}
}
#line 126 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.c"
int cipherInit(cipherInstance *cipher , MARA_BYTE mode , char *IV ) 
{ 


  {
#line 127
  if ((int )mode == 1) {
#line 128
    cipher->mode = mode;
  } else {
#line 130
    return (-4);
  }
#line 132
  if ((unsigned long )IV != (unsigned long )((void *)0)) {
#line 133
    return (-4);
  } else {
    {
#line 135
    memset((void *)(cipher->IV), 0, (size_t )16);
    }
  }
#line 137
  return (1);
}
}
#line 140 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-api-fst.c"
int blockEncrypt(cipherInstance *cipher , keyInstance *key___6 , MARA_BYTE *input ,
                 int inputLen , MARA_BYTE *outBuffer ) 
{ 
  int i ;
  int numBlocks ;

  {
#line 144
  if ((unsigned long )cipher == (unsigned long )((void *)0)) {
#line 147
    return (-5);
  } else
#line 144
  if ((unsigned long )key___6 == (unsigned long )((void *)0)) {
#line 147
    return (-5);
  } else
#line 144
  if ((int )key___6->direction == 1) {
#line 147
    return (-5);
  }
#line 149
  if ((unsigned long )input == (unsigned long )((void *)0)) {
#line 150
    return (0);
  } else
#line 149
  if (inputLen <= 0) {
#line 150
    return (0);
  }
#line 153
  numBlocks = inputLen / 128;
  {
#line 156
  if ((int )cipher->mode == 1) {
#line 156
    goto case_1;
  }
#line 164
  goto switch_default;
  case_1: /* CIL Label */ 
#line 157
  i = numBlocks;
  {
#line 157
  while (1) {
    while_continue: /* CIL Label */ ;
#line 157
    if (! (i > 0)) {
#line 157
      goto while_break;
    }
    {
#line 158
    rngEncrypt((u32 const   *)(key___6->rk), key___6->Nr, (u8 const   *)input, (u8 *)outBuffer);
#line 159
    input += 16;
#line 160
    outBuffer += 16;
#line 157
    i --;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 162
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 165
  return (-5);
  switch_break: /* CIL Label */ ;
  }
#line 168
  return (128 * numBlocks);
}
}
#line 239 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) struct tm *( __attribute__((__leaf__)) gmtime)(time_t const   *__timer ) ;
#line 243
extern  __attribute__((__nothrow__)) struct tm *( __attribute__((__leaf__)) localtime)(time_t const   *__timer ) ;
#line 261
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) asctime)(struct tm  const  *__tp ) ;
#line 132 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strncpy)(char * __restrict  __dest ,
                                                                                                  char const   * __restrict  __src ,
                                                                                                  size_t __n ) ;
#line 29 "/home/wheatley/newnew/temp/maradns-2.0.09/server/timestamp.c"
int timestamp_type  =    0;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/server/timestamp.c"
int set_timestamp(int type ) 
{ 


  {
#line 45
  if (type >= 0) {
#line 45
    if (type <= 128) {
#line 46
      timestamp_type = type;
#line 47
      return (1);
    }
  }
#line 49
  return (-1);
}
}
#line 58 "/home/wheatley/newnew/temp/maradns-2.0.09/server/timestamp.c"
int show_timestamp(void) 
{ 
  time_t tmp ;
  time_t tmp___0 ;
  struct tm *htime ;
  time_t now ;
  char *dow[7] ;
  char *moy[12] ;
  char ct[256] ;
  int count ;
  time_t now___0 ;
  struct tm *tmp___1 ;
  char *tmp___2 ;
  struct tm *htime___0 ;
  time_t now___1 ;
  time_t tmp___3 ;

  {
  {
#line 59
  fflush(stdout);
  }
#line 60
  if (timestamp_type == 0) {
    {
#line 61
    tmp = time((time_t *)0);
#line 61
    printf((char const   */* __restrict  */)"%s%d ", "Timestamp: ", (int )tmp);
    }
  } else
#line 63
  if (timestamp_type == 1) {
    {
#line 64
    tmp___0 = time((time_t *)0);
#line 64
    printf((char const   */* __restrict  */)"%d ", (int )tmp___0);
    }
  } else
#line 66
  if (timestamp_type == 2) {
#line 66
    goto _L___0;
  } else
#line 66
  if (timestamp_type == 3) {
    _L___0: /* CIL Label */ 
    {
#line 70
    dow[0] = (char *)"Domingo";
#line 70
    dow[1] = (char *)"Lunes";
#line 70
    dow[2] = (char *)"Martes";
#line 70
    dow[3] = (char *)"Miercoles";
#line 70
    dow[4] = (char *)"Jueves";
#line 70
    dow[5] = (char *)"Viernes";
#line 70
    dow[6] = (char *)"Sabado";
#line 78
    moy[0] = (char *)"Enero";
#line 78
    moy[1] = (char *)"Febrero";
#line 78
    moy[2] = (char *)"Marzo";
#line 78
    moy[3] = (char *)"Abril";
#line 78
    moy[4] = (char *)"Mayo";
#line 78
    moy[5] = (char *)"Junio";
#line 78
    moy[6] = (char *)"Julio";
#line 78
    moy[7] = (char *)"Agosto";
#line 78
    moy[8] = (char *)"Septiembre";
#line 78
    moy[9] = (char *)"Octubre";
#line 78
    moy[10] = (char *)"Noviembre";
#line 78
    moy[11] = (char *)"Diciembre";
#line 91
    now = time((time_t *)0);
    }
#line 92
    if (timestamp_type == 2) {
      {
#line 93
      htime = gmtime((time_t const   *)(& now));
      }
    } else {
      {
#line 95
      htime = localtime((time_t const   *)(& now));
      }
    }
#line 98
    if (htime->tm_mon < 0) {
#line 99
      return (-1);
    } else
#line 98
    if (htime->tm_mon > 11) {
#line 99
      return (-1);
    }
#line 100
    if (htime->tm_wday < 0) {
#line 101
      return (-1);
    } else
#line 100
    if (htime->tm_wday > 6) {
#line 101
      return (-1);
    }
    {
#line 103
    printf((char const   */* __restrict  */)"%s, %d de %s, a %02d:%02d:%02d ", dow[htime->tm_wday],
           htime->tm_mday, moy[htime->tm_mon], htime->tm_hour, htime->tm_min, htime->tm_sec);
    }
#line 106
    if (timestamp_type == 2) {
      {
#line 107
      printf((char const   */* __restrict  */)"(UTC) ");
      }
    }
  } else
#line 109
  if (timestamp_type == 4) {
    {
#line 113
    now___0 = time((time_t *)0);
#line 114
    tmp___1 = gmtime((time_t const   *)(& now___0));
#line 114
    tmp___2 = asctime((struct tm  const  *)tmp___1);
#line 114
    strncpy((char */* __restrict  */)(ct), (char const   */* __restrict  */)tmp___2,
            (size_t )100);
#line 115
    count = 0;
    }
    {
#line 115
    while (1) {
      while_continue: /* CIL Label */ ;
#line 115
      if (! (count < 100)) {
#line 115
        goto while_break;
      }
#line 116
      if ((int )ct[count] < 32) {
#line 117
        ct[count] = (char)0;
#line 118
        goto while_break;
      }
#line 115
      count ++;
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 121
    printf((char const   */* __restrict  */)"%s GMT ", ct);
    }
  } else
#line 123
  if (! (timestamp_type == 5)) {
#line 125
    if (timestamp_type == 6) {
#line 125
      goto _L;
    } else
#line 125
    if (timestamp_type == 7) {
      _L: /* CIL Label */ 
      {
#line 128
      now___1 = time((time_t *)0);
      }
#line 129
      if (timestamp_type == 6) {
        {
#line 130
        htime___0 = gmtime((time_t const   *)(& now___1));
        }
      } else {
        {
#line 132
        htime___0 = localtime((time_t const   *)(& now___1));
        }
      }
      {
#line 134
      printf((char const   */* __restrict  */)"%d-%02d-%02d %02d:%02d:%02d ", htime___0->tm_year + 1900,
             htime___0->tm_mon + 1, htime___0->tm_mday, htime___0->tm_hour, htime___0->tm_min,
             htime___0->tm_sec);
      }
    } else {
      {
#line 143
      tmp___3 = time((time_t *)0);
#line 143
      printf((char const   */* __restrict  */)"%s%d ", "Timestamp: ", (int )tmp___3);
      }
    }
  }
#line 145
  return (1);
}
}
#line 68 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/../libs/JsStr.h"
int js_get_encode(js_string *js ) ;
#line 91
int js_addbyte(js_string *js , unsigned char byte ) ;
#line 94
int js_changebyte(js_string *js , unsigned char byte , int offset ) ;
#line 79 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/functions_parse.h"
int parse_csv1_line(js_string *line___6 , js_string *name , js_string *data , uint32_t *ttl ) ;
#line 90
int bs_process(js_string *in , js_string *out , js_string *sub ) ;
#line 110
int ddip_2_ip(js_string *ddip , js_string *ip , int offset ) ;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseCsv1.c"
int parse_csv1_line(js_string *line___6 , js_string *name , js_string *data , uint32_t *ttl ) 
{ 
  js_string *pipeq ;
  js_string *hashq___6 ;
  js_string *starq ;
  js_string *blankq___6 ;
  js_string *field ;
  js_string *tstr___6 ;
  uint16_t type ;
  uint16_t preference ;
  int tempp ;
  int pipep ;
  int opipep ;
  int counter ;
  uint32_t soanum ;
  char pipe ;
  char hash ;
  char star ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  unsigned int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  unsigned int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;
  int tmp___37 ;
  int tmp___38 ;
  int tmp___39 ;
  int tmp___40 ;
  int tmp___41 ;
  int tmp___42 ;
  int tmp___43 ;

  {
  {
#line 48
  pipeq = (js_string *)0;
#line 48
  hashq___6 = (js_string *)0;
#line 48
  starq = (js_string *)0;
#line 48
  blankq___6 = (js_string *)0;
#line 48
  field = (js_string *)0;
#line 58
  pipe = (char )'|';
#line 59
  hash = (char )'#';
#line 60
  star = (char )'*';
#line 63
  tmp = mara_goodjs(line___6);
  }
#line 63
  if (tmp == -1) {
#line 64
    return (-1);
  }
  {
#line 65
  tmp___0 = js_get_encode(line___6);
  }
#line 65
  if (tmp___0 != 2) {
    {
#line 65
    tmp___1 = js_get_encode(line___6);
    }
#line 65
    if (tmp___1 != 3) {
#line 67
      return (-1);
    }
  }
  {
#line 68
  tmp___2 = mara_goodjs(name);
  }
#line 68
  if (tmp___2 == -1) {
#line 69
    return (-1);
  }
  {
#line 70
  tmp___3 = mara_goodjs(data);
  }
#line 70
  if (tmp___3 == -1) {
#line 71
    return (-1);
  }
#line 72
  if ((unsigned long )ttl == (unsigned long )((uint32_t *)0)) {
#line 73
    return (-1);
  }
  {
#line 76
  pipeq = js_create(7U, 1U);
  }
#line 76
  if ((unsigned long )pipeq == (unsigned long )((js_string *)0)) {
#line 77
    return (-1);
  }
  {
#line 78
  hashq___6 = js_create(7U, 1U);
  }
#line 78
  if ((unsigned long )hashq___6 == (unsigned long )((js_string *)0)) {
    {
#line 79
    js_destroy(pipeq);
    }
#line 80
    return (-1);
  }
  {
#line 82
  starq = js_create(7U, 1U);
  }
#line 82
  if ((unsigned long )starq == (unsigned long )((js_string *)0)) {
    {
#line 83
    js_destroy(pipeq);
#line 83
    js_destroy(hashq___6);
    }
#line 84
    return (-1);
  }
  {
#line 86
  tmp___4 = js_set_encode(starq, 3);
  }
#line 86
  if (tmp___4 == -1) {
    {
#line 87
    js_destroy(pipeq);
#line 87
    js_destroy(hashq___6);
#line 87
    js_destroy(starq);
    }
#line 88
    return (-1);
  }
  {
#line 90
  blankq___6 = js_create(7U, 1U);
  }
#line 90
  if ((unsigned long )blankq___6 == (unsigned long )((js_string *)0)) {
    {
#line 91
    js_destroy(pipeq);
#line 91
    js_destroy(hashq___6);
#line 91
    js_destroy(starq);
    }
#line 92
    return (-1);
  }
  {
#line 94
  tmp___5 = js_set_encode(blankq___6, 3);
  }
#line 94
  if (tmp___5 == -1) {
    {
#line 95
    js_destroy(pipeq);
#line 95
    js_destroy(hashq___6);
#line 95
    js_destroy(starq);
#line 96
    js_destroy(blankq___6);
    }
#line 97
    return (-1);
  }
  {
#line 99
  field = js_create(256U, 1U);
  }
#line 99
  if ((unsigned long )field == (unsigned long )((js_string *)0)) {
    {
#line 100
    js_destroy(pipeq);
#line 100
    js_destroy(hashq___6);
#line 100
    js_destroy(starq);
#line 101
    js_destroy(blankq___6);
    }
#line 102
    return (-1);
  }
  {
#line 106
  tmp___6 = js_str2js(pipeq, & pipe, 1, 1);
  }
#line 106
  if (tmp___6 == -1) {
#line 107
    goto clean;
  }
  {
#line 108
  tmp___7 = js_str2js(hashq___6, & hash, 1, 1);
  }
#line 108
  if (tmp___7 == -1) {
#line 109
    goto clean;
  }
  {
#line 110
  tmp___8 = js_space_chars(blankq___6);
  }
#line 110
  if (tmp___8 == -1) {
#line 111
    goto clean;
  }
  {
#line 114
  tmp___9 = js_newline_chars(starq);
  }
#line 114
  if (tmp___9 == -1) {
#line 115
    goto clean;
  }
  {
#line 116
  tmp___10 = js_append(starq, blankq___6);
  }
#line 116
  if (tmp___10 == -1) {
#line 117
    goto clean;
  }
  {
#line 121
  tempp = js_match(starq, line___6);
  }
#line 122
  if (tempp == -1) {
#line 123
    goto clean;
  }
#line 124
  if (tempp == -2) {
    {
#line 125
    js_qstr2js(name, (char *)"ERROR");
#line 126
    js_qstr2js(data, (char *)"No newline found in line");
    }
#line 127
    goto error;
  }
  {
#line 131
  tmp___11 = js_str2js(starq, & star, 1, 1);
  }
#line 131
  if (tmp___11 == -1) {
#line 132
    goto clean;
  }
  {
#line 134
  tmp___12 = js_qstr2js(name, (char *)"");
  }
#line 134
  if (tmp___12 == -1) {
#line 135
    goto clean;
  }
  {
#line 136
  tmp___13 = js_qstr2js(data, (char *)"");
  }
#line 136
  if (tmp___13 == -1) {
#line 137
    goto clean;
  }
  {
#line 141
  tempp = js_match(hashq___6, line___6);
  }
#line 142
  if (tempp == -1) {
#line 143
    goto clean;
  }
#line 144
  if (tempp == 0) {
#line 145
    goto cero;
  }
  {
#line 149
  tempp = js_notmatch(blankq___6, line___6);
  }
#line 150
  if (tempp == -1) {
#line 151
    goto clean;
  }
#line 152
  if (tempp == -2) {
#line 153
    goto cero;
  }
  {
#line 157
  pipep = js_match(pipeq, line___6);
  }
#line 158
  if (pipep == -1) {
#line 159
    goto clean;
  }
#line 160
  if (tempp == -2) {
    {
#line 161
    js_qstr2js(name, (char *)"ERROR");
#line 162
    js_qstr2js(data, (char *)"No pipe found in line");
    }
#line 163
    goto error;
  }
  {
#line 168
  tmp___14 = js_substr(line___6, name, 0, pipep);
  }
#line 168
  if (tmp___14 == -1) {
#line 169
    goto clean;
  }
  {
#line 171
  tempp = hname_2rfc1035(name);
  }
#line 172
  if (tempp == -1) {
    {
#line 173
    js_qstr2js(name, (char *)"ERROR");
#line 174
    js_qstr2js(data, (char *)"Error in Query syntax.");
    }
#line 175
    goto error;
  }
#line 178
  if (tempp == -2) {
    {
#line 179
    js_qstr2js(name, (char *)"ERROR");
#line 180
    js_qstr2js(data, (char *)"The record type is not supported");
    }
#line 181
    goto error;
  } else
#line 178
  if (tempp > 65535) {
    {
#line 179
    js_qstr2js(name, (char *)"ERROR");
#line 180
    js_qstr2js(data, (char *)"The record type is not supported");
    }
#line 181
    goto error;
  }
  {
#line 184
  type = (uint16_t )tempp;
#line 187
  opipep = pipep;
#line 188
  pipep = js_match_offset(pipeq, line___6, pipep + 1);
  }
#line 189
  if (pipep == -1) {
#line 190
    goto clean;
  }
#line 191
  if (pipep <= opipep) {
    {
#line 192
    js_qstr2js(name, (char *)"ERROR");
#line 193
    js_qstr2js(data, (char *)"You must have at least three fields in the RR");
    }
#line 194
    goto error;
  }
  {
#line 196
  *ttl = js_atoi(line___6, opipep + 1);
  }
#line 197
  if (*ttl == 4294967295U) {
#line 198
    goto clean;
  }
  {
#line 202
  if (tempp == 1) {
#line 202
    goto case_1;
  }
#line 209
  if (tempp == 15) {
#line 209
    goto case_15;
  }
#line 255
  if (tempp == 2) {
#line 255
    goto case_2;
  }
#line 265
  if (tempp == 12) {
#line 265
    goto case_12;
  }
#line 265
  if (tempp == 5) {
#line 265
    goto case_12;
  }
#line 282
  if (tempp == 16) {
#line 282
    goto case_16;
  }
#line 293
  if (tempp == -3) {
#line 293
    goto case_neg_3;
  }
#line 319
  if (tempp == 6) {
#line 319
    goto case_6;
  }
#line 392
  goto switch_default;
  case_1: /* CIL Label */ 
  {
#line 203
  tmp___15 = ddip_2_ip(line___6, data, pipep + 1);
  }
#line 203
  if (tmp___15 == -1) {
    {
#line 204
    js_qstr2js(name, (char *)"ERROR");
#line 205
    js_qstr2js(data, (char *)"Malformed dotted decimal IP");
    }
#line 206
    goto error;
  }
#line 208
  goto switch_break;
  case_15: /* CIL Label */ 
  {
#line 211
  tmp___16 = js_atoi(line___6, pipep + 1);
#line 211
  tempp = (int )tmp___16;
  }
#line 212
  if (tempp < 0) {
    {
#line 213
    js_qstr2js(name, (char *)"ERROR");
#line 214
    js_qstr2js(data, (char *)"Bad MX type");
    }
#line 215
    goto error;
  } else
#line 212
  if (tempp > 65535) {
    {
#line 213
    js_qstr2js(name, (char *)"ERROR");
#line 214
    js_qstr2js(data, (char *)"Bad MX type");
    }
#line 215
    goto error;
  }
  {
#line 217
  preference = (uint16_t )tempp;
#line 218
  tmp___17 = js_addbyte(data, (unsigned char )(((int )preference >> 8) & 255));
  }
#line 218
  if (tmp___17 == -1) {
#line 219
    goto clean;
  }
  {
#line 220
  tmp___18 = js_addbyte(data, (unsigned char )((int )preference & 255));
  }
#line 220
  if (tmp___18 == -1) {
#line 221
    goto clean;
  }
  {
#line 222
  tempp = js_match_offset(pipeq, line___6, pipep + 1);
  }
#line 223
  if (tempp <= pipep) {
    {
#line 224
    js_qstr2js(name, (char *)"ERROR");
#line 225
    js_qstr2js(data, (char *)"There must be four fields in the MX");
    }
#line 226
    goto error;
  }
  {
#line 228
  pipep = tempp;
#line 230
  tstr___6 = js_create(512U, 1U);
  }
#line 230
  if ((unsigned long )tstr___6 == (unsigned long )((js_string *)0)) {
#line 231
    goto clean;
  }
  {
#line 232
  tmp___19 = js_length(line___6);
#line 232
  tmp___20 = js_substr(line___6, tstr___6, pipep, (tmp___19 - pipep) - 1);
  }
#line 232
  if (tmp___20 == -1) {
    {
#line 234
    js_destroy(tstr___6);
    }
#line 235
    goto clean;
  }
  {
#line 237
  tmp___21 = js_changebyte(tstr___6, (unsigned char )'A', 0);
  }
#line 237
  if (tmp___21 == -1) {
    {
#line 238
    js_destroy(tstr___6);
    }
#line 239
    goto clean;
  }
  {
#line 241
  tempp = hname_2rfc1035(tstr___6);
  }
#line 242
  if (tempp == -1) {
    {
#line 243
    js_qstr2js(name, (char *)"ERROR");
#line 244
    js_qstr2js(data, (char *)"Malformed domain email");
#line 245
    js_destroy(tstr___6);
    }
#line 246
    goto error;
  }
  {
#line 248
  tmp___22 = js_append(tstr___6, data);
  }
#line 248
  if (tmp___22 == -1) {
    {
#line 249
    js_destroy(tstr___6);
    }
#line 250
    goto clean;
  }
  {
#line 252
  tmp___23 = js_destroy(tstr___6);
  }
#line 252
  if (tmp___23 == -1) {
#line 253
    goto clean;
  }
#line 254
  goto switch_break;
  case_2: /* CIL Label */ 
#line 258
  if (name->unit_count > 2U) {
#line 258
    if ((int )*(name->string + 1) == 42) {
      {
#line 260
      js_qstr2js(name, (char *)"ERROR");
#line 261
      js_qstr2js(data, (char *)"Star records can not be CNAME nor NS RRs");
      }
#line 262
      goto error;
    }
  }
  case_12: /* CIL Label */ 
  case_5: /* CIL Label */ 
  {
#line 267
  tmp___24 = js_length(line___6);
#line 267
  tmp___25 = js_substr(line___6, data, pipep, (tmp___24 - pipep) - 1);
  }
#line 267
  if (tmp___25 == -1) {
#line 269
    goto clean;
  }
  {
#line 272
  tmp___26 = js_changebyte(data, (unsigned char )'A', 0);
  }
#line 272
  if (tmp___26 == -1) {
#line 273
    goto clean;
  }
  {
#line 274
  tempp = hname_2rfc1035(data);
  }
#line 275
  if (tempp == -1) {
    {
#line 276
    js_qstr2js(name, (char *)"ERROR");
#line 277
    js_qstr2js(data, (char *)"Malformed host/domain name");
    }
#line 278
    goto error;
  }
#line 280
  goto switch_break;
  case_16: /* CIL Label */ 
  {
#line 284
  tmp___27 = js_length(line___6);
#line 284
  tempp = (tmp___27 - pipep) - 2;
  }
#line 285
  if (tempp < 0) {
#line 286
    goto clean;
  } else
#line 285
  if (tempp > 255) {
#line 286
    goto clean;
  }
  {
#line 287
  tmp___28 = js_substr(line___6, data, pipep, tempp + 1);
  }
#line 287
  if (tmp___28 == -1) {
#line 289
    goto clean;
  }
  {
#line 290
  tmp___29 = js_changebyte(data, (unsigned char )tempp, 0);
  }
#line 290
  if (tmp___29 == -1) {
#line 291
    goto clean;
  }
#line 292
  goto switch_break;
  case_neg_3: /* CIL Label */ 
  {
#line 296
  tmp___30 = js_atoi(line___6, pipep + 1);
#line 296
  tempp = (int )tmp___30;
  }
#line 297
  if (tempp < 0) {
    {
#line 298
    js_qstr2js(name, (char *)"ERROR");
#line 299
    js_qstr2js(data, (char *)"Bad MX type");
    }
#line 300
    goto error;
  } else
#line 297
  if (tempp > 65535) {
    {
#line 298
    js_qstr2js(name, (char *)"ERROR");
#line 299
    js_qstr2js(data, (char *)"Bad MX type");
    }
#line 300
    goto error;
  }
  {
#line 302
  type = (uint16_t )tempp;
#line 304
  tempp = js_match_offset(pipeq, line___6, pipep + 1);
  }
#line 305
  if (tempp <= pipep) {
    {
#line 306
    js_qstr2js(name, (char *)"ERROR");
#line 307
    js_qstr2js(data, (char *)"There must be four fields in the MX");
    }
#line 308
    goto error;
  }
  {
#line 310
  pipep = tempp;
#line 312
  tmp___31 = js_length(line___6);
#line 312
  tempp = (tmp___31 - pipep) - 2;
  }
#line 313
  if (tempp < 0) {
#line 314
    goto clean;
  } else
#line 313
  if (tempp > 424) {
#line 314
    goto clean;
  }
  {
#line 315
  tmp___32 = js_substr(line___6, data, pipep + 1, tempp);
  }
#line 315
  if (tmp___32 == -1) {
#line 317
    goto clean;
  }
#line 318
  goto switch_break;
  case_6: /* CIL Label */ 
  {
#line 321
  opipep = pipep;
#line 322
  pipep = js_match_offset(pipeq, line___6, pipep + 1);
  }
#line 323
  if (pipep == -1) {
#line 324
    goto clean;
  }
#line 325
  if (pipep <= opipep) {
    {
#line 326
    js_qstr2js(name, (char *)"ERROR");
#line 327
    js_qstr2js(data, (char *)"You must have nine fields in the SOA");
    }
#line 328
    goto error;
  }
  {
#line 330
  tmp___33 = js_substr(line___6, data, opipep, pipep - opipep);
  }
#line 330
  if (tmp___33 == -1) {
#line 331
    goto clean;
  }
  {
#line 332
  tmp___34 = js_changebyte(data, (unsigned char )'A', 0);
  }
#line 332
  if (tmp___34 == -1) {
#line 333
    goto clean;
  }
  {
#line 334
  tempp = hname_2rfc1035(data);
  }
#line 335
  if (tempp == -1) {
    {
#line 336
    js_qstr2js(name, (char *)"ERROR");
#line 337
    js_qstr2js(data, (char *)"Malformed SOA origin");
    }
#line 338
    goto error;
  }
  {
#line 340
  opipep = pipep;
#line 341
  pipep = js_match_offset(pipeq, line___6, pipep + 1);
  }
#line 342
  if (pipep == -1) {
#line 343
    goto clean;
  }
#line 344
  if (pipep <= opipep) {
    {
#line 345
    js_qstr2js(name, (char *)"ERROR");
#line 346
    js_qstr2js(data, (char *)"You must have nine fields in the SOA");
    }
#line 347
    goto error;
  }
  {
#line 350
  tstr___6 = js_create(512U, 1U);
  }
#line 350
  if ((unsigned long )tstr___6 == (unsigned long )((js_string *)0)) {
#line 351
    goto clean;
  }
  {
#line 352
  tmp___35 = js_substr(line___6, tstr___6, opipep, pipep - opipep);
  }
#line 352
  if (tmp___35 == -1) {
    {
#line 353
    js_destroy(tstr___6);
    }
#line 354
    goto clean;
  }
  {
#line 356
  tempp = email_2rfc1035(tstr___6);
  }
#line 357
  if (tempp == -1) {
    {
#line 358
    js_qstr2js(name, (char *)"ERROR");
#line 359
    js_qstr2js(data, (char *)"Malformed domain email");
#line 360
    js_destroy(tstr___6);
    }
#line 361
    goto error;
  }
  {
#line 363
  tmp___36 = js_append(tstr___6, data);
  }
#line 363
  if (tmp___36 == -1) {
    {
#line 364
    js_destroy(tstr___6);
    }
#line 365
    goto clean;
  }
  {
#line 367
  tmp___37 = js_destroy(tstr___6);
  }
#line 367
  if (tmp___37 == -1) {
#line 368
    goto clean;
  }
#line 372
  counter = 0;
  {
#line 372
  while (1) {
    while_continue: /* CIL Label */ ;
#line 372
    if (! (counter < 5)) {
#line 372
      goto while_break;
    }
#line 373
    if (pipep == -2) {
      {
#line 374
      js_qstr2js(name, (char *)"ERROR");
#line 375
      js_qstr2js(data, (char *)"You must have nine fields in the SOA");
      }
#line 376
      goto error;
    }
    {
#line 378
    soanum = js_atoi(line___6, pipep + 1);
#line 379
    tmp___38 = js_addbyte(data, (unsigned char )(soanum >> 24));
    }
#line 379
    if (tmp___38 == -1) {
#line 380
      goto clean;
    }
    {
#line 381
    tmp___39 = js_addbyte(data, (unsigned char )((soanum >> 16) & 255U));
    }
#line 381
    if (tmp___39 == -1) {
#line 382
      goto clean;
    }
    {
#line 383
    tmp___40 = js_addbyte(data, (unsigned char )((soanum >> 8) & 255U));
    }
#line 383
    if (tmp___40 == -1) {
#line 384
      goto clean;
    }
    {
#line 385
    tmp___41 = js_addbyte(data, (unsigned char )(soanum & 255U));
    }
#line 385
    if (tmp___41 == -1) {
#line 386
      goto clean;
    }
    {
#line 387
    pipep = js_match_offset(pipeq, line___6, pipep + 1);
    }
#line 388
    if (pipep == -1) {
#line 389
      goto clean;
    }
#line 372
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 391
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 393
  goto clean;
  switch_break: /* CIL Label */ ;
  }
  {
#line 397
  tmp___42 = js_addbyte(name, (unsigned char )(((int )type & 65280) >> 16));
  }
#line 397
  if (tmp___42 == -1) {
#line 398
    goto clean;
  }
  {
#line 399
  tmp___43 = js_addbyte(name, (unsigned char )((int )type & 255));
  }
#line 399
  if (tmp___43 == -1) {
#line 400
    goto clean;
  }
  {
#line 402
  js_destroy(pipeq);
#line 402
  js_destroy(hashq___6);
#line 402
  js_destroy(starq);
#line 403
  js_destroy(blankq___6);
#line 403
  js_destroy(field);
  }
#line 404
  return ((int )type);
  clean: 
  {
#line 407
  js_destroy(pipeq);
#line 407
  js_destroy(hashq___6);
#line 407
  js_destroy(starq);
#line 408
  js_destroy(blankq___6);
#line 408
  js_destroy(field);
  }
#line 409
  return (-1);
  error: 
  {
#line 411
  js_destroy(pipeq);
#line 411
  js_destroy(hashq___6);
#line 411
  js_destroy(starq);
#line 412
  js_destroy(blankq___6);
#line 412
  js_destroy(field);
  }
#line 413
  return (-2);
  cero: 
  {
#line 415
  js_destroy(pipeq);
#line 415
  js_destroy(hashq___6);
#line 415
  js_destroy(starq);
#line 416
  js_destroy(blankq___6);
#line 416
  js_destroy(field);
  }
#line 417
  return (0);
}
}
#line 429 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseCsv1.c"
int ddip_2_ip(js_string *ddip , js_string *ip , int offset ) 
{ 
  int qr ;
  int counter ;
  int ret ;
  unsigned char ip_byte ;
  js_string *dotq___3 ;
  js_string *numdotq___3 ;
  char dot ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  js_string *tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  unsigned int tmp___6 ;
  int tmp___7 ;

  {
  {
#line 435
  dotq___3 = (js_string *)0;
#line 436
  numdotq___3 = (js_string *)0;
#line 438
  dot = (char )'.';
#line 441
  tmp = mara_goodjs(ddip);
  }
#line 441
  if (tmp == -1) {
#line 442
    return (-1);
  }
  {
#line 443
  tmp___0 = mara_goodjs(ip);
  }
#line 443
  if (tmp___0 == -1) {
#line 444
    return (-1);
  }
#line 447
  if ((unsigned long )dotq___3 == (unsigned long )((js_string *)0)) {
    {
#line 448
    dotq___3 = js_create(7U, 1U);
    }
#line 448
    if ((unsigned long )dotq___3 == (unsigned long )((js_string *)0)) {
#line 449
      return (-1);
    }
    {
#line 451
    tmp___1 = js_str2js(dotq___3, & dot, 1, 1);
    }
#line 451
    if (tmp___1 == -1) {
      {
#line 452
      js_destroy(dotq___3);
#line 453
      dotq___3 = (js_string *)0;
      }
#line 454
      return (-1);
    }
  }
#line 457
  if ((unsigned long )numdotq___3 == (unsigned long )((js_string *)0)) {
    {
#line 458
    numdotq___3 = js_create(211U, 1U);
    }
#line 458
    if ((unsigned long )numdotq___3 == (unsigned long )((js_string *)0)) {
      {
#line 459
      js_destroy(dotq___3);
      }
#line 460
      return (-1);
    }
    {
#line 462
    tmp___2 = js_set_encode(numdotq___3, 3);
    }
#line 462
    if (tmp___2 == -1) {
      {
#line 463
      js_destroy(numdotq___3);
#line 464
      js_destroy(dotq___3);
#line 465
      numdotq___3 = (js_string *)0;
      }
#line 466
      return (-1);
    }
    {
#line 469
    tmp___3 = js_numbers(numdotq___3);
    }
#line 469
    if ((unsigned long )tmp___3 == (unsigned long )((js_string *)0)) {
      {
#line 470
      js_destroy(numdotq___3);
#line 471
      js_destroy(dotq___3);
#line 472
      numdotq___3 = (js_string *)0;
      }
#line 473
      return (-1);
    }
    {
#line 476
    tmp___4 = js_append(dotq___3, numdotq___3);
    }
#line 476
    if (tmp___4 == -1) {
      {
#line 477
      js_destroy(numdotq___3);
#line 478
      js_destroy(dotq___3);
#line 479
      numdotq___3 = (js_string *)0;
      }
#line 480
      return (-1);
    }
  }
  {
#line 485
  ret = js_notmatch_offset(numdotq___3, ddip, offset);
  }
#line 486
  if (ret == -1) {
#line 487
    goto clean;
  }
  {
#line 490
  js_qstr2js(ip, (char *)"");
#line 493
  tmp___5 = js_length(ddip);
  }
#line 493
  if (tmp___5 < 1) {
#line 494
    goto clean;
  }
#line 496
  counter = 0;
  {
#line 496
  while (1) {
    while_continue: /* CIL Label */ ;
#line 496
    if (! (counter < 4)) {
#line 496
      goto while_break;
    }
#line 497
    if (offset == -2) {
#line 498
      goto clean;
    }
    {
#line 500
    tmp___6 = js_atoi(ddip, offset);
#line 500
    qr = (int )tmp___6;
    }
#line 502
    if (qr < 0) {
#line 503
      goto clean;
    } else
#line 502
    if (qr > 255) {
#line 503
      goto clean;
    }
    {
#line 505
    ip_byte = (unsigned char )qr;
#line 507
    tmp___7 = js_addbyte(ip, ip_byte);
    }
#line 507
    if (tmp___7 == -1) {
#line 508
      goto clean;
    }
    {
#line 510
    offset = js_match_offset(dotq___3, ddip, offset + 1);
    }
#line 511
    if (offset == -1) {
#line 512
      goto clean;
    }
#line 514
    offset ++;
#line 496
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 518
  if (ret < offset) {
#line 518
    if (offset != -1) {
#line 519
      goto clean;
    }
  }
  {
#line 522
  js_destroy(dotq___3);
#line 523
  js_destroy(numdotq___3);
  }
#line 526
  if (ret == -2) {
#line 527
    return (-2);
  }
#line 529
  return (ret);
  clean: 
  {
#line 532
  js_destroy(dotq___3);
#line 533
  js_destroy(numdotq___3);
  }
#line 534
  return (-1);
}
}
#line 546 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseCsv1.c"
int bs_process(js_string *in , js_string *out , js_string *sub ) 
{ 
  int value___6 ;
  int iplace ;
  int oplace ;
  int subq ;
  int inlabel ;
  unsigned char byte ;
  int firstchar ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 552
  tmp = mara_goodjs(in);
  }
#line 552
  if (tmp == -1) {
#line 553
    return (-1);
  }
  {
#line 554
  tmp___0 = mara_goodjs(out);
  }
#line 554
  if (tmp___0 == -1) {
#line 555
    return (-1);
  }
#line 556
  subq = 1;
#line 557
  if ((unsigned long )sub == (unsigned long )((js_string *)0)) {
#line 558
    subq = 0;
  } else {
    {
#line 559
    tmp___1 = mara_goodjs(sub);
    }
#line 559
    if (tmp___1 == -1) {
#line 560
      return (-1);
    }
  }
#line 562
  inlabel = 0;
#line 562
  oplace = inlabel;
#line 562
  iplace = oplace;
#line 563
  firstchar = 1;
  {
#line 564
  while (1) {
    while_continue: /* CIL Label */ ;
#line 564
    if (! ((unsigned int )iplace < in->unit_count)) {
#line 564
      goto while_break;
    }
#line 565
    byte = *(in->string + iplace);
#line 568
    if (inlabel) {
#line 568
      if ((int )byte >= 65) {
#line 568
        if ((int )byte <= 90) {
#line 569
          byte = (unsigned char )((int )byte + 32);
        }
      }
    }
#line 570
    if (firstchar == 1) {
#line 571
      inlabel = 1;
#line 572
      firstchar = 0;
    }
#line 574
    if ((int )byte == 35) {
#line 575
      inlabel = 0;
    } else
#line 574
    if ((int )byte == 124) {
#line 575
      inlabel = 0;
    }
#line 576
    if (subq) {
#line 576
      if ((int )byte == 37) {
#line 577
        if ((unsigned int )oplace >= out->max_count) {
#line 578
          return (-1);
        }
        {
#line 579
        out->unit_count = (unsigned int )oplace;
#line 580
        js_append(sub, out);
#line 581
        oplace = (int )out->unit_count;
#line 582
        iplace ++;
        }
#line 583
        goto while_continue;
      } else {
#line 576
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 585
    if ((int )byte == 92) {
#line 586
      iplace ++;
#line 587
      if ((unsigned int )iplace >= in->unit_count) {
#line 588
        return (-1);
      }
#line 589
      byte = *(in->string + iplace);
#line 590
      if ((int )byte >= 48) {
#line 590
        if ((int )byte <= 51) {
#line 591
          value___6 = ((int )byte - 48) * 64;
#line 593
          iplace ++;
#line 594
          if ((unsigned int )iplace >= in->unit_count) {
#line 595
            return (-1);
          }
#line 596
          byte = *(in->string + iplace);
#line 597
          if ((int )byte < 48) {
#line 598
            return (-1);
          } else
#line 597
          if ((int )byte > 57) {
#line 598
            return (-1);
          }
#line 599
          value___6 += ((int )byte - 48) * 8;
#line 601
          iplace ++;
#line 602
          if ((unsigned int )iplace >= in->unit_count) {
#line 603
            return (-1);
          }
#line 604
          byte = *(in->string + iplace);
#line 605
          if ((int )byte < 48) {
#line 606
            return (-1);
          } else
#line 605
          if ((int )byte > 57) {
#line 606
            return (-1);
          }
#line 607
          value___6 += (int )byte - 48;
#line 608
          byte = (unsigned char )value___6;
        } else {
#line 590
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 610
      if ((int )byte != 92) {
#line 610
        if ((int )byte != 37) {
#line 611
          return (-1);
        }
      }
    }
#line 614
    if ((unsigned int )oplace < out->max_count) {
#line 615
      *(out->string + oplace) = byte;
    } else {
#line 617
      return (-1);
    }
#line 619
    oplace ++;
#line 621
    iplace ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 625
  out->unit_count = (unsigned int )oplace;
#line 626
  return (1);
}
}
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te0[256]  = 
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
  {      (u32 const   )3017953435U,      (u32 const   )1672792582U,      (u32 const   )2246353620U,      (u32 const   )560743938U, 
        (u32 const   )980369320U,      (u32 const   )2786508149U,      (u32 const   )323814928U,      (u32 const   )1298184604U, 
        (u32 const   )392868941U,      (u32 const   )2135030158U,      (u32 const   )3799505551U,      (u32 const   )3454798025U, 
        (u32 const   )1510608337U,      (u32 const   )453212586U,      (u32 const   )2070301651U,      (u32 const   )2715875159U, 
        (u32 const   )4205140826U,      (u32 const   )3929646389U,      (u32 const   )3315758963U,      (u32 const   )2977696056U, 
        (u32 const   )539224030U,      (u32 const   )3564185792U,      (u32 const   )2089812465U,      (u32 const   )582860413U, 
        (u32 const   )3967831755U,      (u32 const   )3107092098U,      (u32 const   )3172320479U,      (u32 const   )3385571988U, 
        (u32 const   )2760434902U,      (u32 const   )21995996U,      (u32 const   )1617244793U,      (u32 const   )4269992199U, 
        (u32 const   )1960738379U,      (u32 const   )2833328433U,      (u32 const   )69710429U,      (u32 const   )3864029394U, 
        (u32 const   )2307747635U,      (u32 const   )2458785433U,      (u32 const   )302163916U,      (u32 const   )2049567247U, 
        (u32 const   )522505207U,      (u32 const   )1682079780U,      (u32 const   )3715167910U,      (u32 const   )3200531616U, 
        (u32 const   )755338213U,      (u32 const   )368373230U,      (u32 const   )1462526442U,      (u32 const   )485831560U, 
        (u32 const   )4185170725U,      (u32 const   )1078384039U,      (u32 const   )733765659U,      (u32 const   )3735097049U, 
        (u32 const   )1121487876U,      (u32 const   )2402583757U,      (u32 const   )1600265808U,      (u32 const   )2203928874U, 
        (u32 const   )4112346818U,      (u32 const   )798741062U,      (u32 const   )3213598076U,      (u32 const   )3994949480U, 
        (u32 const   )1812791198U,      (u32 const   )371529105U,      (u32 const   )927552403U,      (u32 const   )1555293743U, 
        (u32 const   )1057434665U,      (u32 const   )1272533602U,      (u32 const   )90706817U,      (u32 const   )2416987962U, 
        (u32 const   )64092287U,      (u32 const   )1380217451U,      (u32 const   )3577645340U,      (u32 const   )2596301091U, 
        (u32 const   )1368754708U,      (u32 const   )2438983398U,      (u32 const   )3756961541U,      (u32 const   )2046300784U, 
        (u32 const   )3536372542U,      (u32 const   )968804311U,      (u32 const   )1983916008U,      (u32 const   )1208527389U, 
        (u32 const   )3480375658U,      (u32 const   )647629856U,      (u32 const   )2872103246U,      (u32 const   )3260300625U, 
        (u32 const   )1997506100U,      (u32 const   )2695845515U,      (u32 const   )668315132U,      (u32 const   )1342103615U, 
        (u32 const   )3021216441U,      (u32 const   )2363849906U,      (u32 const   )720617927U,      (u32 const   )3687390552U, 
        (u32 const   )3606016355U,      (u32 const   )1020712022U,      (u32 const   )1531292685U,      (u32 const   )1044942325U, 
        (u32 const   )841039890U,      (u32 const   )3785761520U,      (u32 const   )2609891583U,      (u32 const   )1133981144U, 
        (u32 const   )3433277717U,      (u32 const   )678271076U,      (u32 const   )837859437U,      (u32 const   )882420716U, 
        (u32 const   )1932014697U,      (u32 const   )1876756449U,      (u32 const   )1747668419U,      (u32 const   )1725749639U, 
        (u32 const   )1449377846U,      (u32 const   )1660644314U,      (u32 const   )2507693243U,      (u32 const   )3877619982U, 
        (u32 const   )1919391157U,      (u32 const   )3411403575U,      (u32 const   )1576814579U,      (u32 const   )1895418902U, 
        (u32 const   )3062514458U,      (u32 const   )2177044617U,      (u32 const   )3838718321U,      (u32 const   )220621883U, 
        (u32 const   )2898697068U,      (u32 const   )2556309632U,      (u32 const   )3666263172U,      (u32 const   )1833131586U, 
        (u32 const   )1768221727U,      (u32 const   )112847870U,      (u32 const   )2225799944U,      (u32 const   )3135475453U, 
        (u32 const   )299065267U,      (u32 const   )0U,      (u32 const   )251106372U,      (u32 const   )4226480774U, 
        (u32 const   )3148623649U,      (u32 const   )1695359480U,      (u32 const   )2925052623U,      (u32 const   )2251643563U, 
        (u32 const   )1630180261U,      (u32 const   )4099067678U,      (u32 const   )1147234298U,      (u32 const   )2272983927U, 
        (u32 const   )4087645500U,      (u32 const   )2807635113U,      (u32 const   )2111807533U,      (u32 const   )1486115954U, 
        (u32 const   )2625209053U,      (u32 const   )3625510183U,      (u32 const   )862904782U,      (u32 const   )133581346U, 
        (u32 const   )2781299978U,      (u32 const   )2156704085U,      (u32 const   )3083199174U,      (u32 const   )4015109812U, 
        (u32 const   )906424911U,      (u32 const   )4291643611U,      (u32 const   )1437743177U,      (u32 const   )1811592636U, 
        (u32 const   )1320239587U,      (u32 const   )2390435089U,      (u32 const   )1790252128U,      (u32 const   )4250079608U, 
        (u32 const   )416448981U,      (u32 const   )3548865250U,      (u32 const   )4075496672U,      (u32 const   )3390718699U, 
        (u32 const   )3695138682U,      (u32 const   )2294468335U,      (u32 const   )2376785262U,      (u32 const   )43932067U, 
        (u32 const   )429727753U,      (u32 const   )2956175588U,      (u32 const   )151117414U,      (u32 const   )208260583U, 
        (u32 const   )263730584U,      (u32 const   )4152571745U,      (u32 const   )4140603069U,      (u32 const   )2025305004U, 
        (u32 const   )1972494231U,      (u32 const   )1229392833U,      (u32 const   )3850473645U,      (u32 const   )2548434200U, 
        (u32 const   )3617640639U,      (u32 const   )1251406782U,      (u32 const   )2678618786U,      (u32 const   )3924319562U, 
        (u32 const   )195004357U,      (u32 const   )1160693286U,      (u32 const   )3160040707U,      (u32 const   )3646375163U, 
        (u32 const   )2568065372U,      (u32 const   )2527700164U,      (u32 const   )1191132761U,      (u32 const   )1278154816U, 
        (u32 const   )2486697319U,      (u32 const   )3812129619U,      (u32 const   )1033467274U,      (u32 const   )3342610128U, 
        (u32 const   )743057977U,      (u32 const   )625734751U,      (u32 const   )603070369U,      (u32 const   )441243766U, 
        (u32 const   )3495336605U,      (u32 const   )3095254878U,      (u32 const   )498766420U,      (u32 const   )955344395U, 
        (u32 const   )2721124136U,      (u32 const   )1580056460U,      (u32 const   )1202757509U,      (u32 const   )347819058U, 
        (u32 const   )2846787821U,      (u32 const   )1356475336U,      (u32 const   )604263811U,      (u32 const   )3950380265U, 
        (u32 const   )3042687845U,      (u32 const   )510356011U,      (u32 const   )2182277366U,      (u32 const   )4047166623U, 
        (u32 const   )3234489586U,      (u32 const   )139362234U,      (u32 const   )2742988532U,      (u32 const   )903285296U, 
        (u32 const   )3989827351U,      (u32 const   )3773399852U,      (u32 const   )817830321U,      (u32 const   )2665995134U, 
        (u32 const   )3903323286U,      (u32 const   )2478946117U,      (u32 const   )4229738660U,      (u32 const   )2997743943U, 
        (u32 const   )278724207U,      (u32 const   )2911451824U,      (u32 const   )2937545491U,      (u32 const   )785675162U, 
        (u32 const   )1855104573U,      (u32 const   )2637570817U,      (u32 const   )4164616953U,      (u32 const   )3329462028U, 
        (u32 const   )3246769454U,      (u32 const   )3364100936U,      (u32 const   )1737717851U,      (u32 const   )2860478610U, 
        (u32 const   )1091138683U,      (u32 const   )3273366669U,      (u32 const   )1907781066U,      (u32 const   )2333292176U, 
        (u32 const   )3508091713U,      (u32 const   )1425906069U,      (u32 const   )3303921327U,      (u32 const   )2114869330U, 
        (u32 const   )991993460U,      (u32 const   )2321323852U,      (u32 const   )4034231619U,      (u32 const   )1507587502U, 
        (u32 const   )3460165814U,      (u32 const   )1393284023U,      (u32 const   )181413401U,      (u32 const   )690108856U};
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te1[256]  = 
#line 69
  {      (u32 const   )2612257360U,      (u32 const   )107197642U,      (u32 const   )3565544610U,      (u32 const   )35744838U, 
        (u32 const   )2822401855U,      (u32 const   )1973819069U,      (u32 const   )269700358U,      (u32 const   )2622316729U, 
        (u32 const   )1293380276U,      (u32 const   )2390704633U,      (u32 const   )2413983706U,      (u32 const   )3385715720U, 
        (u32 const   )3512338957U,      (u32 const   )2853897081U,      (u32 const   )3548079691U,      (u32 const   )1470226679U, 
        (u32 const   )1526375771U,      (u32 const   )904542629U,      (u32 const   )1942332023U,      (u32 const   )951155721U, 
        (u32 const   )3726648295U,      (u32 const   )3235148072U,      (u32 const   )4051472385U,      (u32 const   )2099428798U, 
        (u32 const   )3421274190U,      (u32 const   )2193175158U,      (u32 const   )3753711044U,      (u32 const   )2496252858U, 
        (u32 const   )3601107172U,      (u32 const   )3691073441U,      (u32 const   )2036360498U,      (u32 const   )134120169U, 
        (u32 const   )1265950334U,      (u32 const   )833151273U,      (u32 const   )1560553394U,      (u32 const   )3538309224U, 
        (u32 const   )864652655U,      (u32 const   )2576518678U,      (u32 const   )3423732391U,      (u32 const   )259664362U, 
        (u32 const   )4146013387U,      (u32 const   )610550400U,      (u32 const   )2799530230U,      (u32 const   )2696856636U, 
        (u32 const   )3844933003U,      (u32 const   )3994416365U,      (u32 const   )3931581537U,      (u32 const   )2283599155U, 
        (u32 const   )637105315U,      (u32 const   )2806007509U,      (u32 const   )455851104U,      (u32 const   )3655246094U, 
        (u32 const   )71489676U,      (u32 const   )3448714372U,      (u32 const   )1348428318U,      (u32 const   )713252169U, 
        (u32 const   )3270843758U,      (u32 const   )1177525202U,      (u32 const   )2092927901U,      (u32 const   )1760435735U, 
        (u32 const   )2657881343U,      (u32 const   )2434147605U,      (u32 const   )2469874003U,      (u32 const   )794604518U, 
        (u32 const   )691996460U,      (u32 const   )1649138002U,      (u32 const   )2164615187U,      (u32 const   )982519887U, 
        (u32 const   )2130956792U,      (u32 const   )1800553586U,      (u32 const   )483737225U,      (u32 const   )597344361U, 
        (u32 const   )340891018U,      (u32 const   )3868286958U,      (u32 const   )98561711U,      (u32 const   )1887041554U, 
        (u32 const   )1054001347U,      (u32 const   )3610885831U,      (u32 const   )3900063783U,      (u32 const   )491260074U, 
        (u32 const   )1791980113U,      (u32 const   )539400716U,      (u32 const   )1319842001U,      (u32 const   )1371690045U, 
        (u32 const   )880217990U,      (u32 const   )2342563670U,      (u32 const   )4230469037U,      (u32 const   )1062207200U, 
        (u32 const   )3115586586U,      (u32 const   )2995578236U,      (u32 const   )3341480897U,      (u32 const   )1490798877U, 
        (u32 const   )1675030385U,      (u32 const   )1446827732U,      (u32 const   )224085420U,      (u32 const   )4114499725U, 
        (u32 const   )305275200U,      (u32 const   )4041319970U,      (u32 const   )4288384968U,      (u32 const   )3628308269U, 
        (u32 const   )365732777U,      (u32 const   )1680371096U,      (u32 const   )1831989432U,      (u32 const   )3962869931U, 
        (u32 const   )1769154612U,      (u32 const   )3782204679U,      (u32 const   )3278383949U,      (u32 const   )2271665369U, 
        (u32 const   )911631296U,      (u32 const   )3663919979U,      (u32 const   )3147135068U,      (u32 const   )250027977U, 
        (u32 const   )3044173717U,      (u32 const   )936072675U,      (u32 const   )4083022919U,      (u32 const   )376502732U, 
        (u32 const   )448170563U,      (u32 const   )2306982672U,      (u32 const   )1910820401U,      (u32 const   )990717548U, 
        (u32 const   )1823262363U,      (u32 const   )2157469232U,      (u32 const   )2228913852U,      (u32 const   )1114456926U, 
        (u32 const   )527000812U,      (u32 const   )4261853675U,      (u32 const   )142912259U,      (u32 const   )4256883598U, 
        (u32 const   )3004289887U,      (u32 const   )0U,      (u32 const   )1141831572U,      (u32 const   )2264656634U, 
        (u32 const   )565947439U,      (u32 const   )4167372065U,      (u32 const   )3484309698U,      (u32 const   )2877699418U, 
        (u32 const   )2774608531U,      (u32 const   )519328463U,      (u32 const   )4198785383U,      (u32 const   )2005367547U, 
        (u32 const   )1022600325U,      (u32 const   )2846316828U,      (u32 const   )763223968U,      (u32 const   )1918407764U, 
        (u32 const   )3718019458U,      (u32 const   )668473573U,      (u32 const   )3459477217U,      (u32 const   )570947146U, 
        (u32 const   )178636613U,      (u32 const   )1434487985U,      (u32 const   )3333932514U,      (u32 const   )3035582902U, 
        (u32 const   )1328940786U,      (u32 const   )3690974536U,      (u32 const   )1230352952U,      (u32 const   )3161193141U, 
        (u32 const   )3813585217U,      (u32 const   )294550309U,      (u32 const   )1617605908U,      (u32 const   )2029867793U, 
        (u32 const   )3575173761U,      (u32 const   )3805513570U,      (u32 const   )3774016292U,      (u32 const   )3955890754U, 
        (u32 const   )2061254487U,      (u32 const   )4018717390U,      (u32 const   )1854778077U,      (u32 const   )2734857817U, 
        (u32 const   )152673568U,      (u32 const   )3836752808U,      (u32 const   )1711866334U,      (u32 const   )3876350413U, 
        (u32 const   )2551167029U,      (u32 const   )1643610935U,      (u32 const   )3187068054U,      (u32 const   )2893592499U, 
        (u32 const   )2541064671U,      (u32 const   )3242805003U,      (u32 const   )2917499280U,      (u32 const   )412608005U, 
        (u32 const   )3218579664U,      (u32 const   )3192559347U,      (u32 const   )2728372346U,      (u32 const   )1256843357U, 
        (u32 const   )3305873287U,      (u32 const   )642068166U,      (u32 const   )62675557U,      (u32 const   )4225324868U, 
        (u32 const   )1553535377U,      (u32 const   )3298208164U,      (u32 const   )1497825086U,      (u32 const   )1078734616U, 
        (u32 const   )1737766909U,      (u32 const   )1407400059U,      (u32 const   )2319292789U,      (u32 const   )3502717998U, 
        (u32 const   )959203882U,      (u32 const   )1596279796U,      (u32 const   )2703487519U,      (u32 const   )1981435096U, 
        (u32 const   )2647676570U,      (u32 const   )1589149143U,      (u32 const   )1411234450U,      (u32 const   )188281190U, 
        (u32 const   )681718031U,      (u32 const   )2354982335U,      (u32 const   )2236067999U,      (u32 const   )840219468U, 
        (u32 const   )3987320456U,      (u32 const   )3360741931U,      (u32 const   )2200175701U,      (u32 const   )3924522500U, 
        (u32 const   )1706384315U,      (u32 const   )723413866U,      (u32 const   )4135719656U,      (u32 const   )2683386588U, 
        (u32 const   )4072720996U,      (u32 const   )3121106559U,      (u32 const   )4104355502U,      (u32 const   )808834826U, 
        (u32 const   )401461231U,      (u32 const   )752937347U,      (u32 const   )2972761881U,      (u32 const   )2124343259U, 
        (u32 const   )2531829756U,      (u32 const   )1167311287U,      (u32 const   )2767985840U,      (u32 const   )1202892273U, 
        (u32 const   )1863359742U,      (u32 const   )2964162874U,      (u32 const   )330241891U,      (u32 const   )2586760307U, 
        (u32 const   )1030656678U,      (u32 const   )27080227U,      (u32 const   )4193794818U,      (u32 const   )214332303U, 
        (u32 const   )784434629U,      (u32 const   )1221100571U,      (u32 const   )1533514616U,      (u32 const   )2460647280U, 
        (u32 const   )2067859828U,      (u32 const   )2378374044U,      (u32 const   )3396449901U,      (u32 const   )2425033526U, 
        (u32 const   )1104222523U,      (u32 const   )2505375129U,      (u32 const   )2948918742U,      (u32 const   )1383992920U, 
        (u32 const   )1950032030U,      (u32 const   )1284136087U,      (u32 const   )1139832189U,      (u32 const   )2925124597U, 
        (u32 const   )3066969584U,      (u32 const   )3075673043U,      (u32 const   )420139046U,      (u32 const   )3089703481U};
#line 135 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te2[256]  = 
#line 135
  {      (u32 const   )1352381410U,      (u32 const   )3389416372U,      (u32 const   )2731836900U,      (u32 const   )1174544748U, 
        (u32 const   )1067989615U,      (u32 const   )3178604054U,      (u32 const   )101716813U,      (u32 const   )3114028384U, 
        (u32 const   )3024951146U,      (u32 const   )4186865473U,      (u32 const   )3666862711U,      (u32 const   )147443180U, 
        (u32 const   )231823882U,      (u32 const   )2041191171U,      (u32 const   )1272150886U,      (u32 const   )4149715424U, 
        (u32 const   )1532689061U,      (u32 const   )2771774009U,      (u32 const   )2004075938U,      (u32 const   )154710396U, 
        (u32 const   )3890094115U,      (u32 const   )683725937U,      (u32 const   )32603280U,      (u32 const   )3195871933U, 
        (u32 const   )1321987200U,      (u32 const   )1988278578U,      (u32 const   )3302997269U,      (u32 const   )3130313163U, 
        (u32 const   )3839272072U,      (u32 const   )2715550031U,      (u32 const   )846815333U,      (u32 const   )3909615234U, 
        (u32 const   )2118874334U,      (u32 const   )691120353U,      (u32 const   )2992440359U,      (u32 const   )1758651984U, 
        (u32 const   )1865648525U,      (u32 const   )379163278U,      (u32 const   )2815169026U,      (u32 const   )3926882857U, 
        (u32 const   )3421970212U,      (u32 const   )2149868610U,      (u32 const   )4138130800U,      (u32 const   )1017167556U, 
        (u32 const   )2347052293U,      (u32 const   )3991803380U,      (u32 const   )1642747692U,      (u32 const   )864558325U, 
        (u32 const   )2737174900U,      (u32 const   )3584507974U,      (u32 const   )1612393404U,      (u32 const   )249159329U, 
        (u32 const   )2349089496U,      (u32 const   )2228064052U,      (u32 const   )508583778U,      (u32 const   )1227522909U, 
        (u32 const   )1858270493U,      (u32 const   )3527815067U,      (u32 const   )2642198411U,      (u32 const   )392752670U, 
        (u32 const   )4288572428U,      (u32 const   )361829925U,      (u32 const   )1402156873U,      (u32 const   )3861863603U, 
        (u32 const   )740900615U,      (u32 const   )1382173657U,      (u32 const   )327222632U,      (u32 const   )1329238032U, 
        (u32 const   )4169073617U,      (u32 const   )1919636036U,      (u32 const   )2300368190U,      (u32 const   )1763941056U, 
        (u32 const   )2316587413U,      (u32 const   )4008087903U,      (u32 const   )2936397806U,      (u32 const   )309361144U, 
        (u32 const   )3275674312U,      (u32 const   )3352771006U,      (u32 const   )669546048U,      (u32 const   )2854045704U, 
        (u32 const   )1365954418U,      (u32 const   )203433626U,      (u32 const   )3511593776U,      (u32 const   )1028768340U, 
        (u32 const   )2251585295U,      (u32 const   )1451991215U,      (u32 const   )2918983637U,      (u32 const   )3762245630U, 
        (u32 const   )448377876U,      (u32 const   )2092076261U,      (u32 const   )3251055347U,      (u32 const   )492362697U, 
        (u32 const   )1902368495U,      (u32 const   )3562421462U,      (u32 const   )2886556485U,      (u32 const   )2381659720U, 
        (u32 const   )1074934305U,      (u32 const   )586211750U,      (u32 const   )3372194703U,      (u32 const   )769147799U, 
        (u32 const   )2836778147U,      (u32 const   )2556700781U,      (u32 const   )3094163952U,      (u32 const   )2884383896U, 
        (u32 const   )879325992U,      (u32 const   )132214749U,      (u32 const   )1304651819U,      (u32 const   )3649529564U, 
        (u32 const   )3224786531U,      (u32 const   )1809474299U,      (u32 const   )1555797368U,      (u32 const   )3373197087U, 
        (u32 const   )2511696487U,      (u32 const   )3812084565U,      (u32 const   )1207131644U,      (u32 const   )3424022777U, 
        (u32 const   )1125824138U,      (u32 const   )277447107U,      (u32 const   )829547726U,      (u32 const   )1815809318U, 
        (u32 const   )2607590598U,      (u32 const   )813733982U,      (u32 const   )3162823302U,      (u32 const   )1581411651U, 
        (u32 const   )3961481572U,      (u32 const   )3959293625U,      (u32 const   )50889899U,      (u32 const   )2398993123U, 
        (u32 const   )1605571027U,      (u32 const   )0U,      (u32 const   )2487488247U,      (u32 const   )4203150314U, 
        (u32 const   )790739884U,      (u32 const   )569926925U,      (u32 const   )3268390488U,      (u32 const   )1521190453U, 
        (u32 const   )2477089066U,      (u32 const   )3474912338U,      (u32 const   )1744454753U,      (u32 const   )4218914682U, 
        (u32 const   )2235364260U,      (u32 const   )480880473U,      (u32 const   )2687335903U,      (u32 const   )1416779924U, 
        (u32 const   )2195561593U,      (u32 const   )3844593688U,      (u32 const   )3788387182U,      (u32 const   )1243744246U, 
        (u32 const   )1158325703U,      (u32 const   )2975170700U,      (u32 const   )3804673989U,      (u32 const   )3065311057U, 
        (u32 const   )4065277446U,      (u32 const   )1222377421U,      (u32 const   )944330162U,      (u32 const   )3049024506U, 
        (u32 const   )1105415857U,      (u32 const   )621907579U,      (u32 const   )341863093U,      (u32 const   )293141843U, 
        (u32 const   )2178226386U,      (u32 const   )1659032455U,      (u32 const   )618722027U,      (u32 const   )1122748954U, 
        (u32 const   )1467669567U,      (u32 const   )3471804610U,      (u32 const   )3715009962U,      (u32 const   )1503855262U, 
        (u32 const   )537467293U,      (u32 const   )2833559603U,      (u32 const   )3731228929U,      (u32 const   )3454471273U, 
        (u32 const   )899157944U,      (u32 const   )929167235U,      (u32 const   )2529031884U,      (u32 const   )3014424759U, 
        (u32 const   )3751245201U,      (u32 const   )197216583U,      (u32 const   )2427315585U,      (u32 const   )85497830U, 
        (u32 const   )3502233504U,      (u32 const   )4089334422U,      (u32 const   )2057478056U,      (u32 const   )1565190632U, 
        (u32 const   )2277837727U,      (u32 const   )3324396846U,      (u32 const   )1694743642U,      (u32 const   )1157355863U, 
        (u32 const   )2438764817U,      (u32 const   )2764347049U,      (u32 const   )1046038271U,      (u32 const   )406866991U, 
        (u32 const   )4251423799U,      (u32 const   )2069095224U,      (u32 const   )1971994009U,      (u32 const   )785434428U, 
        (u32 const   )708389962U,      (u32 const   )4099876171U,      (u32 const   )530654194U,      (u32 const   )3631618636U, 
        (u32 const   )2594033750U,      (u32 const   )3613309053U,      (u32 const   )2454986170U,      (u32 const   )1712011505U, 
        (u32 const   )254321201U,      (u32 const   )3213647405U,      (u32 const   )2676311984U,      (u32 const   )1278350523U, 
        (u32 const   )2297276846U,      (u32 const   )734548186U,      (u32 const   )1434657796U,      (u32 const   )82439030U, 
        (u32 const   )3144004955U,      (u32 const   )1781210731U,      (u32 const   )3908469266U,      (u32 const   )3701469498U, 
        (u32 const   )1693630666U,      (u32 const   )2142898254U,      (u32 const   )2935268222U,      (u32 const   )170931671U, 
        (u32 const   )4011322831U,      (u32 const   )2200756457U,      (u32 const   )431042751U,      (u32 const   )3682508519U, 
        (u32 const   )4237748391U,      (u32 const   )3074790337U,      (u32 const   )2963602460U,      (u32 const   )4048007853U, 
        (u32 const   )4268691612U,      (u32 const   )984657289U,      (u32 const   )1662234391U,      (u32 const   )1939484372U, 
        (u32 const   )2789043858U,      (u32 const   )587308342U,      (u32 const   )49936443U,      (u32 const   )2399979123U, 
        (u32 const   )3308175749U,      (u32 const   )457754756U,      (u32 const   )2019256211U,      (u32 const   )1888660095U, 
        (u32 const   )1954234633U,      (u32 const   )2626536219U,      (u32 const   )1841983926U,      (u32 const   )915442451U, 
        (u32 const   )994169113U,      (u32 const   )2576700669U,      (u32 const   )3601843437U,      (u32 const   )1481801230U, 
        (u32 const   )2658417440U,      (u32 const   )2538375772U,      (u32 const   )2101604469U,      (u32 const   )4121844187U, 
        (u32 const   )4038512189U,      (u32 const   )3552006923U,      (u32 const   )639175376U,      (u32 const   )968370466U};
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te3[256]  = 
#line 201
  {      (u32 const   )3796933555U,      (u32 const   )3033138787U,      (u32 const   )3835876485U,      (u32 const   )1816527393U, 
        (u32 const   )1866442810U,      (u32 const   )381515174U,      (u32 const   )1292242963U,      (u32 const   )1622776909U, 
        (u32 const   )1790201111U,      (u32 const   )1106873983U,      (u32 const   )2010812386U,      (u32 const   )3959998925U, 
        (u32 const   )168677722U,      (u32 const   )58305051U,      (u32 const   )1716245371U,      (u32 const   )3774306209U, 
        (u32 const   )2774227706U,      (u32 const   )967128554U,      (u32 const   )2725737413U,      (u32 const   )2080979121U, 
        (u32 const   )602398240U,      (u32 const   )1898496212U,      (u32 const   )2416046460U,      (u32 const   )3183377698U, 
        (u32 const   )2152647660U,      (u32 const   )846627513U,      (u32 const   )365223869U,      (u32 const   )3418002633U, 
        (u32 const   )2296698532U,      (u32 const   )1336007681U,      (u32 const   )1697806688U,      (u32 const   )2196310014U, 
        (u32 const   )3732818804U,      (u32 const   )3777573288U,      (u32 const   )666000644U,      (u32 const   )1349047014U, 
        (u32 const   )2372875145U,      (u32 const   )2383845778U,      (u32 const   )44551186U,      (u32 const   )703205242U, 
        (u32 const   )617346847U,      (u32 const   )1115694180U,      (u32 const   )1895212765U,      (u32 const   )3292307646U, 
        (u32 const   )93054253U,      (u32 const   )4109233685U,      (u32 const   )744614487U,      (u32 const   )4113795100U, 
        (u32 const   )1956849145U,      (u32 const   )1188407104U,      (u32 const   )3160415019U,      (u32 const   )2702105054U, 
        (u32 const   )3633054786U,      (u32 const   )881118607U,      (u32 const   )1646153823U,      (u32 const   )1565076099U, 
        (u32 const   )493798133U,      (u32 const   )2614249007U,      (u32 const   )2342354111U,      (u32 const   )504850670U, 
        (u32 const   )218078828U,      (u32 const   )622170390U,      (u32 const   )1230213943U,      (u32 const   )3018207068U, 
        (u32 const   )120334655U,      (u32 const   )3646054987U,      (u32 const   )1746108677U,      (u32 const   )273627792U, 
        (u32 const   )3522723587U,      (u32 const   )1148349266U,      (u32 const   )1049173205U,      (u32 const   )3228115866U, 
        (u32 const   )2508854353U,      (u32 const   )1609492113U,      (u32 const   )4004447711U,      (u32 const   )4161958009U, 
        (u32 const   )3368238802U,      (u32 const   )3200767801U,      (u32 const   )1076357238U,      (u32 const   )145366344U, 
        (u32 const   )1917938383U,      (u32 const   )2584485926U,      (u32 const   )819023531U,      (u32 const   )1413304770U, 
        (u32 const   )260453495U,      (u32 const   )2941684640U,      (u32 const   )3584949287U,      (u32 const   )4276109135U, 
        (u32 const   )337295796U,      (u32 const   )3850154636U,      (u32 const   )4089562922U,      (u32 const   )3374143707U, 
        (u32 const   )4017185750U,      (u32 const   )3604239932U,      (u32 const   )1168903515U,      (u32 const   )1217262910U, 
        (u32 const   )557847090U,      (u32 const   )2787307745U,      (u32 const   )2412314523U,      (u32 const   )2536364099U, 
        (u32 const   )2745767372U,      (u32 const   )1838703656U,      (u32 const   )4038618417U,      (u32 const   )2561403956U, 
        (u32 const   )674523507U,      (u32 const   )3708281199U,      (u32 const   )726516584U,      (u32 const   )3705243494U, 
        (u32 const   )1673541206U,      (u32 const   )4218149474U,      (u32 const   )2019343253U,      (u32 const   )533270247U, 
        (u32 const   )1737864562U,      (u32 const   )1440954315U,      (u32 const   )4232573789U,      (u32 const   )4190901872U, 
        (u32 const   )2319653558U,      (u32 const   )3272640897U,      (u32 const   )3459346916U,      (u32 const   )644627213U, 
        (u32 const   )3332074668U,      (u32 const   )1580236952U,      (u32 const   )2260501722U,      (u32 const   )1130250861U, 
        (u32 const   )1693196137U,      (u32 const   )3119250950U,      (u32 const   )2869102724U,      (u32 const   )3817799098U, 
        (u32 const   )3546264337U,      (u32 const   )0U,      (u32 const   )4153689102U,      (u32 const   )3942287099U, 
        (u32 const   )2888769979U,      (u32 const   )220330085U,      (u32 const   )1489162158U,      (u32 const   )895134598U, 
        (u32 const   )714319201U,      (u32 const   )1389305588U,      (u32 const   )1634204228U,      (u32 const   )2063300487U, 
        (u32 const   )2760195315U,      (u32 const   )1495050663U,      (u32 const   )3751816573U,      (u32 const   )2488562264U, 
        (u32 const   )2038619548U,      (u32 const   )417671128U,      (u32 const   )1860292147U,      (u32 const   )4132053511U, 
        (u32 const   )3343190693U,      (u32 const   )2360432000U,      (u32 const   )3319973559U,      (u32 const   )1370928367U, 
        (u32 const   )116543286U,      (u32 const   )3444104191U,      (u32 const   )2990033237U,      (u32 const   )4206214251U, 
        (u32 const   )2973885262U,      (u32 const   )2066026894U,      (u32 const   )3038011498U,      (u32 const   )1393654013U, 
        (u32 const   )3531724056U,      (u32 const   )2271404755U,      (u32 const   )3945062642U,      (u32 const   )440593354U, 
        (u32 const   )1062697692U,      (u32 const   )3268341640U,      (u32 const   )2866638477U,      (u32 const   )2656674562U, 
        (u32 const   )2636122393U,      (u32 const   )866706608U,      (u32 const   )31352329U,      (u32 const   )1775101708U, 
        (u32 const   )3090520079U,      (u32 const   )2201444855U,      (u32 const   )3432431094U,      (u32 const   )3082005624U, 
        (u32 const   )2447349621U,      (u32 const   )1191952713U,      (u32 const   )2173742565U,      (u32 const   )3859093655U, 
        (u32 const   )2698035159U,      (u32 const   )2532556362U,      (u32 const   )2826609311U,      (u32 const   )3898428137U, 
        (u32 const   )2676475147U,      (u32 const   )784737861U,      (u32 const   )1516569532U,      (u32 const   )1464138713U, 
        (u32 const   )294739097U,      (u32 const   )2846147734U,      (u32 const   )4282276166U,      (u32 const   )790118476U, 
        (u32 const   )939354004U,      (u32 const   )947606499U,      (u32 const   )2574617149U,      (u32 const   )1009701063U, 
        (u32 const   )1244281132U,      (u32 const   )1274306341U,      (u32 const   )4062159139U,      (u32 const   )1289254426U, 
        (u32 const   )1452973520U,      (u32 const   )2111266488U,      (u32 const   )3130151965U,      (u32 const   )4049996600U, 
        (u32 const   )823077026U,      (u32 const   )767528030U,      (u32 const   )2963244359U,      (u32 const   )3142332948U, 
        (u32 const   )2928209321U,      (u32 const   )3660302416U,      (u32 const   )72712996U,      (u32 const   )1980033515U, 
        (u32 const   )1539007925U,      (u32 const   )1802119966U,      (u32 const   )317257346U,      (u32 const   )987537393U, 
        (u32 const   )3395613376U,      (u32 const   )1316993544U,      (u32 const   )2125395107U,      (u32 const   )3607769141U, 
        (u32 const   )3488552941U,      (u32 const   )3917688032U,      (u32 const   )3206132016U,      (u32 const   )3889921694U, 
        (u32 const   )2818348776U,      (u32 const   )3250013587U,      (u32 const   )481338620U,      (u32 const   )2918270898U, 
        (u32 const   )2633920272U,      (u32 const   )2302324909U,      (u32 const   )392369071U,      (u32 const   )3564345902U, 
        (u32 const   )2460368238U,      (u32 const   )908263837U,      (u32 const   )990050808U,      (u32 const   )1938754758U, 
        (u32 const   )2244292289U,      (u32 const   )2216380616U,      (u32 const   )2474138471U,      (u32 const   )2138084010U, 
        (u32 const   )158628673U,      (u32 const   )463244739U,      (u32 const   )3060648561U,      (u32 const   )322343051U, 
        (u32 const   )423313873U,      (u32 const   )4254700884U,      (u32 const   )3990269892U,      (u32 const   )240669310U, 
        (u32 const   )547255355U,      (u32 const   )1553419402U,      (u32 const   )1971143664U,      (u32 const   )3690311257U, 
        (u32 const   )1039185614U,      (u32 const   )198424403U,      (u32 const   )3492157706U,      (u32 const   )574208041U};
#line 267 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te4[256]  = 
#line 267
  {      (u32 const   )404232216U,      (u32 const   )589505315U,      (u32 const   )3334915782U,      (u32 const   )3907578088U, 
        (u32 const   )2273806215U,      (u32 const   )3099113656U,      (u32 const   )16843009U,      (u32 const   )1330597711U, 
        (u32 const   )909522486U,      (u32 const   )2795939494U,      (u32 const   )3537031890U,      (u32 const   )4126537205U, 
        (u32 const   )2038004089U,      (u32 const   )1869573999U,      (u32 const   )2442236305U,      (u32 const   )1381126738U, 
        (u32 const   )1616928864U,      (u32 const   )3166485692U,      (u32 const   )2610666395U,      (u32 const   )2391707278U, 
        (u32 const   )2745410467U,      (u32 const   )202116108U,      (u32 const   )2071690107U,      (u32 const   )892679477U, 
        (u32 const   )488447261U,      (u32 const   )3772834016U,      (u32 const   )3621246935U,      (u32 const   )3267543746U, 
        (u32 const   )774778414U,      (u32 const   )1263225675U,      (u32 const   )4278124286U,      (u32 const   )1465341783U, 
        (u32 const   )353703189U,      (u32 const   )2004318071U,      (u32 const   )926365495U,      (u32 const   )3857049061U, 
        (u32 const   )2678038431U,      (u32 const   )4042322160U,      (u32 const   )1246382666U,      (u32 const   )3671775962U, 
        (u32 const   )1482184792U,      (u32 const   )3385444809U,      (u32 const   )690563369U,      (u32 const   )168430090U, 
        (u32 const   )2981212593U,      (u32 const   )2694881440U,      (u32 const   )1802201963U,      (u32 const   )2240120197U, 
        (u32 const   )3183328701U,      (u32 const   )1566399837U,      (u32 const   )269488144U,      (u32 const   )4109694196U, 
        (u32 const   )3419130827U,      (u32 const   )1044266558U,      (u32 const   )84215045U,      (u32 const   )1734829927U, 
        (u32 const   )3840206052U,      (u32 const   )656877351U,      (u32 const   )1094795585U,      (u32 const   )2341178251U, 
        (u32 const   )2812782503U,      (u32 const   )2105376125U,      (u32 const   )2509608341U,      (u32 const   )3638089944U, 
        (u32 const   )4227595259U,      (u32 const   )4008636142U,      (u32 const   )2088533116U,      (u32 const   )1717986918U, 
        (u32 const   )3722304989U,      (u32 const   )387389207U,      (u32 const   )1195853639U,      (u32 const   )2661195422U, 
        (u32 const   )3402287818U,      (u32 const   )757935405U,      (u32 const   )3217014719U,      (u32 const   )117901063U, 
        (u32 const   )2913840557U,      (u32 const   )1515870810U,      (u32 const   )2206434179U,      (u32 const   )858993459U, 
        (u32 const   )1667457891U,      (u32 const   )33686018U,      (u32 const   )2863311530U,      (u32 const   )1903260017U, 
        (u32 const   )3368601800U,      (u32 const   )421075225U,      (u32 const   )1229539657U,      (u32 const   )3654932953U, 
        (u32 const   )4076008178U,      (u32 const   )3823363043U,      (u32 const   )1532713819U,      (u32 const   )2290649224U, 
        (u32 const   )2593823386U,      (u32 const   )640034342U,      (u32 const   )842150450U,      (u32 const   )2964369584U, 
        (u32 const   )3924421097U,      (u32 const   )252645135U,      (u32 const   )3587560917U,      (u32 const   )2155905152U, 
        (u32 const   )3200171710U,      (u32 const   )3452816845U,      (u32 const   )875836468U,      (u32 const   )1212696648U, 
        (u32 const   )4294967295U,      (u32 const   )2054847098U,      (u32 const   )2425393296U,      (u32 const   )1600085855U, 
        (u32 const   )538976288U,      (u32 const   )1751672936U,      (u32 const   )437918234U,      (u32 const   )2930683566U, 
        (u32 const   )3031741620U,      (u32 const   )1414812756U,      (u32 const   )2475922323U,      (u32 const   )572662306U, 
        (u32 const   )1684300900U,      (u32 const   )4059165169U,      (u32 const   )1936946035U,      (u32 const   )303174162U, 
        (u32 const   )1077952576U,      (u32 const   )134744072U,      (u32 const   )3284386755U,      (u32 const   )3974950124U, 
        (u32 const   )3688618971U,      (u32 const   )2711724449U,      (u32 const   )2374864269U,      (u32 const   )1027423549U, 
        (u32 const   )2543294359U,      (u32 const   )0U,      (u32 const   )3486502863U,      (u32 const   )724249387U, 
        (u32 const   )1987475062U,      (u32 const   )2189591170U,      (u32 const   )3604403926U,      (u32 const   )454761243U, 
        (u32 const   )3048584629U,      (u32 const   )2947526575U,      (u32 const   )1785358954U,      (u32 const   )1347440720U, 
        (u32 const   )1162167621U,      (u32 const   )4092851187U,      (u32 const   )808464432U,      (u32 const   )4025479151U, 
        (u32 const   )1061109567U,      (u32 const   )1431655765U,      (u32 const   )2728567458U,      (u32 const   )3941264106U, 
        (u32 const   )1701143909U,      (u32 const   )3132799674U,      (u32 const   )791621423U,      (u32 const   )3233857728U, 
        (u32 const   )3739147998U,      (u32 const   )471604252U,      (u32 const   )4261281277U,      (u32 const   )1296911693U, 
        (u32 const   )2459079314U,      (u32 const   )1970632053U,      (u32 const   )101058054U,      (u32 const   )2324335242U, 
        (u32 const   )2998055602U,      (u32 const   )3873892070U,      (u32 const   )235802126U,      (u32 const   )522133279U, 
        (u32 const   )1650614882U,      (u32 const   )3570717908U,      (u32 const   )2829625512U,      (u32 const   )2526451350U, 
        (u32 const   )4193909241U,      (u32 const   )3318072773U,      (u32 const   )623191333U,      (u32 const   )1499027801U, 
        (u32 const   )2223277188U,      (u32 const   )1920103026U,      (u32 const   )960051513U,      (u32 const   )1280068684U, 
        (u32 const   )1583242846U,      (u32 const   )2021161080U,      (u32 const   )943208504U,      (u32 const   )2358021260U, 
        (u32 const   )3520188881U,      (u32 const   )2779096485U,      (u32 const   )3806520034U,      (u32 const   )1633771873U, 
        (u32 const   )3014898611U,      (u32 const   )555819297U,      (u32 const   )2627509404U,      (u32 const   )505290270U, 
        (u32 const   )1128481603U,      (u32 const   )3351758791U,      (u32 const   )4244438268U,      (u32 const   )67372036U, 
        (u32 const   )1364283729U,      (u32 const   )2576980377U,      (u32 const   )1835887981U,      (u32 const   )218959117U, 
        (u32 const   )4210752250U,      (u32 const   )3755991007U,      (u32 const   )2122219134U,      (u32 const   )606348324U, 
        (u32 const   )993737531U,      (u32 const   )2880154539U,      (u32 const   )3469659854U,      (u32 const   )286331153U, 
        (u32 const   )2408550287U,      (u32 const   )1313754702U,      (u32 const   )3082270647U,      (u32 const   )3958107115U, 
        (u32 const   )1010580540U,      (u32 const   )2172748161U,      (u32 const   )2492765332U,      (u32 const   )4160223223U, 
        (u32 const   )3115956665U,      (u32 const   )320017171U,      (u32 const   )741092396U,      (u32 const   )3553874899U, 
        (u32 const   )3890735079U,      (u32 const   )1852730990U,      (u32 const   )3301229764U,      (u32 const   )50529027U, 
        (u32 const   )1448498774U,      (u32 const   )1145324612U,      (u32 const   )2139062143U,      (u32 const   )2846468521U, 
        (u32 const   )707406378U,      (u32 const   )3149642683U,      (u32 const   )3250700737U,      (u32 const   )1397969747U, 
        (u32 const   )3705461980U,      (u32 const   )185273099U,      (u32 const   )2644352413U,      (u32 const   )1819044972U, 
        (u32 const   )825307441U,      (u32 const   )1953789044U,      (u32 const   )4143380214U,      (u32 const   )1179010630U, 
        (u32 const   )2896997548U,      (u32 const   )2307492233U,      (u32 const   )336860180U,      (u32 const   )3789677025U, 
        (u32 const   )370546198U,      (u32 const   )976894522U,      (u32 const   )1768515945U,      (u32 const   )151587081U, 
        (u32 const   )1886417008U,      (u32 const   )3065427638U,      (u32 const   )3503345872U,      (u32 const   )3991793133U, 
        (u32 const   )3435973836U,      (u32 const   )1111638594U,      (u32 const   )2560137368U,      (u32 const   )2762253476U, 
        (u32 const   )673720360U,      (u32 const   )1549556828U,      (u32 const   )4177066232U,      (u32 const   )2256963206U};
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
static u32 const   rcon[10]  = 
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
  {      (u32 const   )16777216,      (u32 const   )33554432,      (u32 const   )67108864,      (u32 const   )134217728, 
        (u32 const   )268435456,      (u32 const   )536870912,      (u32 const   )1073741824,      (u32 const   )2147483648U, 
        (u32 const   )452984832,      (u32 const   )905969664};
#line 63 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
unsigned char Sc[256]  ;
#line 64 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
u32 STe0[256]  ;
#line 65 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
u32 STe1[256]  ;
#line 66 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
u32 STe2[256]  ;
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
u32 STe3[256]  ;
#line 68 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
u32 STe4[256]  ;
#line 86 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
int rngKeySetupEnc(u32 *rk , u8 const   *cipherKey , int keyBits ) 
{ 
  int i ;
  unsigned char rbytes[512] ;
  unsigned char u8_swap ;
  u32 u32_swap ;
  u32 temp ;
  u32 *rks ;
  int q ;
  unsigned char z ;
  unsigned char x ;
  unsigned char y ;

  {
#line 87
  i = 0;
#line 94
  rks = rk;
#line 96
  *(rk + 0) = ((((u32 )*(cipherKey + 0) << 24) ^ ((u32 )*(cipherKey + 1) << 16)) ^ ((u32 )*(cipherKey + 2) << 8)) ^ (u32 )*(cipherKey + 3);
#line 97
  *(rk + 1) = ((((u32 )*((cipherKey + 4) + 0) << 24) ^ ((u32 )*((cipherKey + 4) + 1) << 16)) ^ ((u32 )*((cipherKey + 4) + 2) << 8)) ^ (u32 )*((cipherKey + 4) + 3);
#line 98
  *(rk + 2) = ((((u32 )*((cipherKey + 8) + 0) << 24) ^ ((u32 )*((cipherKey + 8) + 1) << 16)) ^ ((u32 )*((cipherKey + 8) + 2) << 8)) ^ (u32 )*((cipherKey + 8) + 3);
#line 99
  *(rk + 3) = ((((u32 )*((cipherKey + 12) + 0) << 24) ^ ((u32 )*((cipherKey + 12) + 1) << 16)) ^ ((u32 )*((cipherKey + 12) + 2) << 8)) ^ (u32 )*((cipherKey + 12) + 3);
#line 100
  if (keyBits == 128) {
    {
#line 101
    while (1) {
      while_continue: /* CIL Label */ ;
#line 102
      temp = *(rk + 3);
#line 103
      *(rk + 4) = ((((*(rk + 0) ^ (unsigned int )(Te4[(temp >> 16) & 255U] & 4278190080U)) ^ (unsigned int )(Te4[(temp >> 8) & 255U] & 16711680U)) ^ (unsigned int )(Te4[temp & 255U] & 65280U)) ^ (unsigned int )(Te4[temp >> 24] & 255U)) ^ (unsigned int )rcon[i];
#line 109
      *(rk + 5) = *(rk + 1) ^ *(rk + 4);
#line 110
      *(rk + 6) = *(rk + 2) ^ *(rk + 5);
#line 111
      *(rk + 7) = *(rk + 3) ^ *(rk + 6);
#line 112
      i ++;
#line 112
      if (i == 10) {
#line 113
        goto while_break;
      }
#line 115
      rk += 4;
    }
    while_break: /* CIL Label */ ;
    }
  } else {
    {
#line 119
    printf((char const   */* __restrict  */)"Fatal error during rng setup\n");
#line 120
    exit(1);
    }
  }
#line 123
  i = 0;
  {
#line 123
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 123
    if (! (i < 256)) {
#line 123
      goto while_break___0;
    }
#line 124
    Sc[i] = (unsigned char )i;
#line 125
    STe0[i] = (u32 )Te0[i];
#line 126
    STe1[i] = (u32 )Te1[i];
#line 127
    STe2[i] = (u32 )Te2[i];
#line 128
    STe3[i] = (u32 )Te3[i];
#line 129
    STe4[i] = (u32 )Te4[i];
#line 123
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 133
  i = 0;
  {
#line 133
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 133
    if (! (i < 512)) {
#line 133
      goto while_break___1;
    }
#line 134
    rbytes[i] = (unsigned char )((i * 7) % 256);
#line 135
    if (i > 255) {
#line 135
      rbytes[i] = (unsigned char )((int )rbytes[i] ^ 255);
    }
#line 133
    i ++;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 140
  i = 0;
  {
#line 140
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 140
    if (! (i < 512)) {
#line 140
      goto while_break___2;
    }
    {
#line 142
    rngEncrypt((u32 const   *)rks, 10, (u8 const   *)(rbytes + i), (u8 *)(rbytes + i));
#line 143
    q = 0;
    }
    {
#line 143
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 143
      if (! (q < 16)) {
#line 143
        goto while_break___3;
      }
#line 145
      z = rbytes[i + q];
#line 150
      u8_swap = Sc[z];
#line 151
      Sc[z] = Sc[1];
#line 152
      Sc[1] = u8_swap;
#line 155
      x = Sc[z];
#line 156
      y = Sc[1];
#line 159
      u32_swap = STe0[x];
#line 160
      STe0[x] = STe0[y];
#line 161
      STe0[y] = u32_swap;
#line 163
      u32_swap = STe1[x];
#line 164
      STe1[x] = STe1[y];
#line 165
      STe1[y] = u32_swap;
#line 167
      u32_swap = STe2[x];
#line 168
      STe2[x] = STe2[y];
#line 169
      STe2[y] = u32_swap;
#line 171
      u32_swap = STe3[x];
#line 172
      STe3[x] = STe3[y];
#line 173
      STe3[y] = u32_swap;
#line 175
      u32_swap = STe4[x];
#line 176
      STe4[x] = STe4[y];
#line 177
      STe4[y] = u32_swap;
#line 143
      q ++;
    }
    while_break___3: /* CIL Label */ ;
    }
#line 140
    i += 16;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 182
  return (10);
}
}
#line 185 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
void rngEncrypt(u32 const   *rk , int Nr , u8 const   *pt , u8 *ct ) 
{ 
  u32 s0 ;
  u32 s1 ;
  u32 s2 ;
  u32 s3 ;
  u32 t0 ;
  u32 t1 ;
  u32 t2 ;
  u32 t3 ;
  int r ;

  {
#line 193
  s0 = (((((u32 )*(pt + 0) << 24) ^ ((u32 )*(pt + 1) << 16)) ^ ((u32 )*(pt + 2) << 8)) ^ (u32 )*(pt + 3)) ^ (unsigned int )*(rk + 0);
#line 194
  s1 = (((((u32 )*((pt + 4) + 0) << 24) ^ ((u32 )*((pt + 4) + 1) << 16)) ^ ((u32 )*((pt + 4) + 2) << 8)) ^ (u32 )*((pt + 4) + 3)) ^ (unsigned int )*(rk + 1);
#line 195
  s2 = (((((u32 )*((pt + 8) + 0) << 24) ^ ((u32 )*((pt + 8) + 1) << 16)) ^ ((u32 )*((pt + 8) + 2) << 8)) ^ (u32 )*((pt + 8) + 3)) ^ (unsigned int )*(rk + 2);
#line 196
  s3 = (((((u32 )*((pt + 12) + 0) << 24) ^ ((u32 )*((pt + 12) + 1) << 16)) ^ ((u32 )*((pt + 12) + 2) << 8)) ^ (u32 )*((pt + 12) + 3)) ^ (unsigned int )*(rk + 3);
#line 201
  t0 = (u32 )Sc[0];
#line 202
  t1 = (u32 )Sc[32];
#line 203
  t2 = (u32 )Sc[64];
#line 204
  t3 = (u32 )Sc[96];
#line 205
  t0 = (u32 )Sc[128];
#line 206
  t1 = (u32 )Sc[160];
#line 207
  t2 = (u32 )Sc[192];
#line 208
  t3 = (u32 )Sc[224];
#line 213
  r = Nr >> 1;
  {
#line 214
  while (1) {
    while_continue: /* CIL Label */ ;
#line 215
    t0 = (((STe0[Sc[s0 >> 24]] ^ STe1[Sc[(s1 >> 16) & 255U]]) ^ STe2[Sc[(s2 >> 8) & 255U]]) ^ STe3[Sc[s3 & 255U]]) ^ (unsigned int )*(rk + 4);
#line 221
    t1 = (((STe0[Sc[s1 >> 24]] ^ STe1[Sc[(s2 >> 16) & 255U]]) ^ STe2[Sc[(s3 >> 8) & 255U]]) ^ STe3[Sc[s0 & 255U]]) ^ (unsigned int )*(rk + 5);
#line 227
    t2 = (((STe0[Sc[s2 >> 24]] ^ STe1[Sc[(s3 >> 16) & 255U]]) ^ STe2[Sc[(s0 >> 8) & 255U]]) ^ STe3[Sc[s1 & 255U]]) ^ (unsigned int )*(rk + 6);
#line 233
    t3 = (((STe0[Sc[s3 >> 24]] ^ STe1[Sc[(s0 >> 16) & 255U]]) ^ STe2[Sc[(s1 >> 8) & 255U]]) ^ STe3[Sc[s2 & 255U]]) ^ (unsigned int )*(rk + 7);
#line 240
    rk += 8;
#line 241
    r --;
#line 241
    if (r == 0) {
#line 242
      goto while_break;
    }
#line 245
    s0 = (((STe0[Sc[t0 >> 24]] ^ STe1[Sc[(t1 >> 16) & 255U]]) ^ STe2[Sc[(t2 >> 8) & 255U]]) ^ STe3[Sc[t3 & 255U]]) ^ (unsigned int )*(rk + 0);
#line 251
    s1 = (((STe0[Sc[t1 >> 24]] ^ STe1[Sc[(t2 >> 16) & 255U]]) ^ STe2[Sc[(t3 >> 8) & 255U]]) ^ STe3[Sc[t0 & 255U]]) ^ (unsigned int )*(rk + 1);
#line 257
    s2 = (((STe0[Sc[t2 >> 24]] ^ STe1[Sc[(t3 >> 16) & 255U]]) ^ STe2[Sc[(t0 >> 8) & 255U]]) ^ STe3[Sc[t1 & 255U]]) ^ (unsigned int )*(rk + 2);
#line 263
    s3 = (((STe0[Sc[t3 >> 24]] ^ STe1[Sc[(t0 >> 16) & 255U]]) ^ STe2[Sc[(t1 >> 8) & 255U]]) ^ STe3[Sc[t2 & 255U]]) ^ (unsigned int )*(rk + 3);
  }
  while_break: /* CIL Label */ ;
  }
#line 274
  s0 = ((((STe4[Sc[t0 >> 24]] & 4278190080U) ^ (STe4[Sc[(t1 >> 16) & 255U]] & 16711680U)) ^ (STe4[Sc[(t2 >> 8) & 255U]] & 65280U)) ^ (STe4[Sc[t3 & 255U]] & 255U)) ^ (unsigned int )*(rk + 0);
#line 280
  *(ct + 0) = (u8 )(s0 >> 24);
#line 280
  *(ct + 1) = (u8 )(s0 >> 16);
#line 280
  *(ct + 2) = (u8 )(s0 >> 8);
#line 280
  *(ct + 3) = (u8 )s0;
#line 281
  s1 = ((((STe4[Sc[t1 >> 24]] & 4278190080U) ^ (STe4[Sc[(t2 >> 16) & 255U]] & 16711680U)) ^ (STe4[Sc[(t3 >> 8) & 255U]] & 65280U)) ^ (STe4[Sc[t0 & 255U]] & 255U)) ^ (unsigned int )*(rk + 1);
#line 287
  *((ct + 4) + 0) = (u8 )(s1 >> 24);
#line 287
  *((ct + 4) + 1) = (u8 )(s1 >> 16);
#line 287
  *((ct + 4) + 2) = (u8 )(s1 >> 8);
#line 287
  *((ct + 4) + 3) = (u8 )s1;
#line 288
  s2 = ((((STe4[Sc[t2 >> 24]] & 4278190080U) ^ (STe4[Sc[(t3 >> 16) & 255U]] & 16711680U)) ^ (STe4[Sc[(t0 >> 8) & 255U]] & 65280U)) ^ (STe4[Sc[t1 & 255U]] & 255U)) ^ (unsigned int )*(rk + 2);
#line 294
  *((ct + 8) + 0) = (u8 )(s2 >> 24);
#line 294
  *((ct + 8) + 1) = (u8 )(s2 >> 16);
#line 294
  *((ct + 8) + 2) = (u8 )(s2 >> 8);
#line 294
  *((ct + 8) + 3) = (u8 )s2;
#line 295
  s3 = ((((STe4[Sc[t3 >> 24]] & 4278190080U) ^ (STe4[Sc[(t0 >> 16) & 255U]] & 16711680U)) ^ (STe4[Sc[(t1 >> 8) & 255U]] & 65280U)) ^ (STe4[Sc[t2 & 255U]] & 255U)) ^ (unsigned int )*(rk + 3);
#line 301
  *((ct + 12) + 0) = (u8 )(s3 >> 24);
#line 301
  *((ct + 12) + 1) = (u8 )(s3 >> 16);
#line 301
  *((ct + 12) + 2) = (u8 )(s3 >> 8);
#line 301
  *((ct + 12) + 3) = (u8 )s3;
#line 302
  return;
}
}
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.h"
int js_set_chsize(js_string *js , int size ) ;
#line 71
int js_destroy_force(js_string *object ) ;
#line 76
int js_fgrep(js_string *exp , js_string *js ) ;
#line 77
int js_fgrep_offset(js_string *exp , js_string *js , int offset ) ;
#line 80
int js_insert(js_string *toinsert , js_string *target , int where ) ;
#line 86
int js_qappend(char *toappend , js_string *target ) ;
#line 87
int js_qprepend(char *toprepend , js_string *target ) ;
#line 88
int js_qfgrep(char *expression , js_string *target ) ;
#line 89
int js_val(js_string *js , int offset ) ;
#line 95
int js_qissame(char *expression , js_string *target ) ;
#line 12 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_octets(js_string *js ) 
{ 


  {
#line 13
  return ((int )(js->max_count * js->unit_size));
}
}
#line 20 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
js_string *js_create(unsigned int max_count , unsigned int unit_size ) 
{ 
  js_string *new ;
  void *tmp ;
  unsigned char *tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 23
  tmp = js_alloc(1, (int )sizeof(js_string ));
#line 23
  new = (js_string *)tmp;
  }
#line 23
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
#line 24
    return ((js_string *)0);
  }
  {
#line 27
  new->unit_size = unit_size;
#line 28
  new->unit_count = 0U;
#line 29
  new->max_count = max_count;
#line 30
  new->is_good = 3124;
#line 31
  new->encoding = 1;
#line 34
  tmp___1 = js_alloc((int )(max_count + 3U), (int )unit_size);
#line 34
  tmp___0 = (unsigned char *)tmp___1;
#line 34
  new->string = tmp___0;
  }
#line 34
  if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
    {
#line 35
    js_dealloc((void *)new);
    }
#line 36
    return ((js_string *)0);
  }
#line 39
  return (new);
}
}
#line 80 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_set_encode(js_string *js , int encoding ) 
{ 
  int tmp ;

  {
  {
#line 82
  tmp = js_has_sanity(js);
  }
#line 82
  if (tmp == -1) {
#line 83
    return (-1);
  }
#line 86
  if (encoding < 1) {
#line 87
    return (-1);
  } else
#line 86
  if (encoding > 3) {
#line 87
    return (-1);
  }
#line 89
  js->encoding = encoding;
#line 91
  return (0);
}
}
#line 98 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_get_encode(js_string *js ) 
{ 
  int tmp ;

  {
  {
#line 100
  tmp = js_has_sanity(js);
  }
#line 100
  if (tmp == -1) {
#line 101
    return (-1);
  }
#line 104
  if (js->encoding < 1) {
#line 105
    return (-1);
  } else
#line 104
  if (js->encoding > 3) {
#line 105
    return (-1);
  }
#line 107
  return (js->encoding);
#line 109
  return (0);
}
}
#line 115 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_length(js_string *js ) 
{ 
  int tmp ;

  {
  {
#line 117
  tmp = js_has_sanity(js);
  }
#line 117
  if (tmp == -1) {
#line 118
    return (-1);
  }
#line 120
  return ((int )js->unit_count);
}
}
#line 129 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_set_chsize(js_string *js , int size ) 
{ 
  int tmp ;

  {
  {
#line 131
  tmp = js_has_sanity(js);
  }
#line 131
  if (tmp == -1) {
#line 132
    return (-1);
  }
#line 135
  if (size < 1) {
#line 136
    return (-1);
  }
#line 140
  if (js->unit_count != 0U) {
#line 141
    return (-1);
  }
#line 164
  if ((js->max_count * js->unit_size) % (unsigned int )size != 0U) {
#line 165
    return (-1);
  }
#line 166
  js->max_count *= js->unit_size;
#line 167
  js->max_count /= (unsigned int )size;
#line 170
  js->unit_size = (unsigned int )size;
#line 172
  return (0);
}
}
#line 178 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_destroy(js_string *object ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 179
  tmp___0 = js_has_sanity(object);
  }
#line 179
  if (tmp___0 != -1) {
    {
#line 180
    tmp = js_destroy_force(object);
    }
#line 180
    return (tmp);
  } else {
#line 182
    return (-1);
  }
}
}
#line 188 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_destroy_force(js_string *object ) 
{ 


  {
  {
#line 190
  js_dealloc((void *)object->string);
#line 192
  js_dealloc((void *)object);
  }
#line 194
  return (1);
}
}
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_has_sanity(js_string *object ) 
{ 


  {
#line 204
  if ((unsigned long )object == (unsigned long )((js_string *)0)) {
#line 205
    return (-1);
  }
#line 208
  if (object->is_good != 3124) {
#line 209
    return (-1);
  }
#line 212
  if (object->unit_count > object->max_count) {
#line 213
    return (-1);
  }
#line 216
  if (object->encoding == 2) {
#line 216
    if (object->unit_size != 1U) {
#line 217
      return (-1);
    }
  }
#line 219
  return (1);
}
}
#line 226 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_str2js(js_string *js , char *string , int count , int size ) 
{ 
  int counter ;
  int max ;
  int tmp ;

  {
#line 227
  counter = 0;
#line 229
  max = count;
#line 232
  if ((unsigned int )count > js->max_count) {
#line 233
    return (-1);
  }
  {
#line 236
  tmp = js_has_sanity(js);
  }
#line 236
  if (tmp == -1) {
#line 237
    return (-1);
  }
#line 238
  if ((unsigned int )size != js->unit_size) {
#line 239
    return (-1);
  }
#line 240
  if ((unsigned long )string == (unsigned long )((char *)0)) {
#line 241
    return (-1);
  }
  {
#line 243
  while (1) {
    while_continue: /* CIL Label */ ;
#line 243
    if (! (counter < max * size)) {
#line 243
      goto while_break;
    }
#line 244
    *(js->string + counter) = (unsigned char )*(string + counter);
#line 245
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 249
  js->unit_count = (unsigned int )count;
#line 251
  return (1);
}
}
#line 258 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_js2str(js_string *js , char *string , int max ) 
{ 
  int counter ;
  int tmp ;

  {
  {
#line 259
  counter = 0;
#line 262
  tmp = js_has_sanity(js);
  }
#line 262
  if (tmp == -1) {
#line 263
    return (-1);
  }
#line 264
  if (js->unit_size * js->unit_count >= (unsigned int )max) {
#line 265
    return (-1);
  }
  {
#line 267
  while (1) {
    while_continue: /* CIL Label */ ;
#line 267
    if (! ((unsigned int )counter < js->unit_size * js->unit_count)) {
#line 267
      goto while_break;
    }
#line 268
    *(string + counter) = (char )*(js->string + counter);
#line 269
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 272
  *(string + counter) = (char)0;
#line 274
  return (1);
}
}
#line 280 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_issame(js_string *js1 , js_string *js2 ) 
{ 
  int counter ;
  int max ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 281
  counter = 0;
#line 285
  tmp = js_has_sanity(js1);
  }
#line 285
  if (tmp == -1) {
#line 286
    return (-1);
  }
  {
#line 287
  tmp___0 = js_has_sanity(js2);
  }
#line 287
  if (tmp___0 == -1) {
#line 288
    return (-1);
  }
#line 291
  if (js1->unit_size != js2->unit_size) {
#line 292
    return (0);
  }
#line 294
  if (js1->unit_count != js2->unit_count) {
#line 295
    return (0);
  }
#line 301
  max = (int )js1->unit_count;
  {
#line 304
  while (1) {
    while_continue: /* CIL Label */ ;
#line 304
    if (! ((unsigned int )counter < (unsigned int )max * js1->unit_size)) {
#line 304
      goto while_break;
    }
#line 305
    if ((int )*(js1->string + counter) != (int )*(js2->string + counter)) {
#line 306
      return (0);
    }
#line 307
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 311
  return (1);
}
}
#line 319 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_fgrep(js_string *exp , js_string *js ) 
{ 
  int tmp ;

  {
  {
#line 320
  tmp = js_fgrep_offset(exp, js, 0);
  }
#line 320
  return (tmp);
}
}
#line 330 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_fgrep_offset(js_string *exp , js_string *js , int offset ) 
{ 
  int counter ;
  int place ;
  int match ;
  int max ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 331
  counter = 0;
#line 332
  place = 0;
#line 333
  match = -2;
#line 337
  tmp = js_has_sanity(exp);
  }
#line 337
  if (tmp == -1) {
#line 338
    return (-1);
  }
  {
#line 339
  tmp___0 = js_has_sanity(js);
  }
#line 339
  if (tmp___0 == -1) {
#line 340
    return (-1);
  }
#line 343
  if ((unsigned int )offset > js->unit_count) {
#line 344
    return (-1);
  }
#line 347
  if (offset < 0) {
#line 348
    offset = (int )(js->unit_count + (unsigned int )offset);
  }
#line 351
  if (offset < 0) {
#line 352
    return (-1);
  }
#line 355
  if (exp->unit_size != js->unit_size) {
#line 356
    return (-2);
  }
#line 360
  if (exp->unit_count > js->unit_count) {
#line 361
    return (-2);
  }
#line 364
  if (exp->unit_count <= 0U) {
#line 365
    return (0);
  }
#line 369
  max = (int )(js->unit_count - exp->unit_count);
#line 371
  match = -2;
  {
#line 374
  while (1) {
    while_continue: /* CIL Label */ ;
#line 374
    if ((unsigned int )counter <= (unsigned int )max * js->unit_size) {
#line 374
      if (! (match == -2)) {
#line 374
        goto while_break;
      }
    } else {
#line 374
      goto while_break;
    }
#line 376
    if ((int )*(exp->string) == (int )*(js->string + counter)) {
#line 376
      if ((unsigned int )counter % js->unit_size == 0U) {
#line 376
        if ((unsigned int )counter >= (unsigned int )offset * js->unit_size) {
#line 379
          match = (int )((unsigned int )counter / js->unit_size);
#line 380
          place = 0;
          {
#line 381
          while (1) {
            while_continue___0: /* CIL Label */ ;
#line 381
            if ((unsigned int )place < exp->unit_count * exp->unit_size) {
#line 381
              if (! ((unsigned int )(place + counter) < js->unit_count * js->unit_size)) {
#line 381
                goto while_break___0;
              }
            } else {
#line 381
              goto while_break___0;
            }
#line 383
            if ((int )*(exp->string + place) != (int )*((js->string + place) + counter)) {
#line 385
              match = -2;
            }
#line 386
            place ++;
          }
          while_break___0: /* CIL Label */ ;
          }
        }
      }
    }
#line 389
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 393
  return (match);
}
}
#line 402 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_match(js_string *exp , js_string *js ) 
{ 
  int tmp ;

  {
  {
#line 403
  tmp = js_match_offset(exp, js, 0);
  }
#line 403
  return (tmp);
}
}
#line 412 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_match_offset(js_string *exp , js_string *js , int offset ) 
{ 
  int counter ;
  int place ;
  int pexp ;
  int match ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 413
  counter = 0;
#line 414
  place = 0;
#line 415
  pexp = 0;
#line 416
  match = -2;
#line 419
  tmp = js_has_sanity(exp);
  }
#line 419
  if (tmp == -1) {
#line 420
    return (-1);
  }
  {
#line 421
  tmp___0 = js_has_sanity(js);
  }
#line 421
  if (tmp___0 == -1) {
#line 422
    return (-1);
  }
#line 425
  if (offset < 0) {
#line 426
    offset = (int )(js->unit_count + (unsigned int )offset);
  }
#line 429
  if (offset < 0) {
#line 430
    return (-1);
  }
#line 433
  if (exp->unit_size != js->unit_size) {
#line 434
    return (-2);
  }
#line 437
  if (exp->unit_count <= 0U) {
#line 438
    return (-2);
  }
  {
#line 441
  while (1) {
    while_continue: /* CIL Label */ ;
#line 441
    if ((unsigned int )counter < js->unit_count * js->unit_size) {
#line 441
      if (! (match == -2)) {
#line 441
        goto while_break;
      }
    } else {
#line 441
      goto while_break;
    }
#line 443
    pexp = 0;
    {
#line 447
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 447
      if (counter >= offset) {
#line 447
        if ((unsigned int )pexp < exp->unit_count * exp->unit_size) {
#line 447
          if (! (match == -2)) {
#line 447
            goto while_break___0;
          }
        } else {
#line 447
          goto while_break___0;
        }
      } else {
#line 447
        goto while_break___0;
      }
#line 453
      if ((int )*(exp->string + pexp) == (int )*(js->string + counter)) {
#line 453
        if ((unsigned int )pexp % exp->unit_size == 0U) {
          {
#line 453
          tmp___3 = js_octets(exp);
          }
#line 453
          if (pexp < tmp___3) {
#line 456
            match = (int )((unsigned int )counter / exp->unit_size);
#line 457
            place = 1;
            {
#line 460
            while (1) {
              while_continue___1: /* CIL Label */ ;
#line 460
              if (! ((unsigned int )place < exp->unit_size)) {
#line 460
                goto while_break___1;
              }
#line 463
              if ((int )*((exp->string + pexp) + place) != (int )*((js->string + counter) + place)) {
                {
#line 463
                tmp___1 = js_octets(exp);
                }
#line 463
                if (pexp + place < tmp___1) {
                  {
#line 463
                  tmp___2 = js_octets(js);
                  }
#line 463
                  if (counter + place < tmp___2) {
#line 468
                    match = -2;
                  }
                }
              }
#line 469
              place ++;
            }
            while_break___1: /* CIL Label */ ;
            }
          }
        }
      }
#line 473
      pexp ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 477
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 481
  return (match);
}
}
#line 490 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_notmatch(js_string *exp , js_string *js ) 
{ 
  int tmp ;

  {
  {
#line 491
  tmp = js_notmatch_offset(exp, js, 0);
  }
#line 491
  return (tmp);
}
}
#line 500 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_notmatch_offset(js_string *exp , js_string *js , int offset ) 
{ 
  int counter ;
  int place ;
  int pexp ;
  int match ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 501
  counter = 0;
#line 502
  place = 0;
#line 503
  pexp = 0;
#line 504
  match = -2;
#line 507
  tmp = js_has_sanity(exp);
  }
#line 507
  if (tmp == -1) {
#line 508
    return (-1);
  }
  {
#line 509
  tmp___0 = js_has_sanity(js);
  }
#line 509
  if (tmp___0 == -1) {
#line 510
    return (-1);
  }
#line 513
  if (offset < 0) {
#line 514
    offset = (int )(js->unit_count + (unsigned int )offset);
  }
#line 517
  if (offset < 0) {
#line 518
    return (-1);
  }
#line 521
  if (exp->unit_size != js->unit_size) {
#line 522
    return (-2);
  }
#line 525
  if (exp->unit_count <= 0U) {
#line 526
    return (-2);
  }
  {
#line 529
  while (1) {
    while_continue: /* CIL Label */ ;
#line 529
    if ((unsigned int )counter < js->unit_count * js->unit_size) {
#line 529
      if (! (match == -2)) {
#line 529
        goto while_break;
      }
    } else {
#line 529
      goto while_break;
    }
#line 531
    pexp = 0;
    {
#line 535
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 535
      if (counter >= offset) {
#line 535
        if (! ((unsigned int )pexp < exp->unit_count * exp->unit_size)) {
#line 535
          goto while_break___0;
        }
      } else {
#line 535
        goto while_break___0;
      }
#line 536
      if ((unsigned int )pexp % exp->unit_size == 0U) {
#line 537
        match = (int )((unsigned int )counter / exp->unit_size);
      }
#line 542
      if ((int )*(exp->string + pexp) == (int )*(js->string + counter)) {
#line 542
        if ((unsigned int )pexp % exp->unit_size == 0U) {
          {
#line 542
          tmp___3 = js_octets(exp);
          }
#line 542
          if (pexp < tmp___3) {
#line 545
            match = -2;
#line 546
            place = 1;
            {
#line 549
            while (1) {
              while_continue___1: /* CIL Label */ ;
#line 549
              if (! ((unsigned int )place < exp->unit_size)) {
#line 549
                goto while_break___1;
              }
#line 552
              if ((int )*((exp->string + pexp) + place) != (int )*((js->string + counter) + place)) {
                {
#line 552
                tmp___1 = js_octets(exp);
                }
#line 552
                if (pexp + place < tmp___1) {
                  {
#line 552
                  tmp___2 = js_octets(js);
                  }
#line 552
                  if (counter + place < tmp___2) {
#line 557
                    match = (int )((unsigned int )counter / exp->unit_size);
                  }
                }
              }
#line 558
              place ++;
            }
            while_break___1: /* CIL Label */ ;
            }
#line 560
            if (match == -2) {
#line 561
              goto while_break___0;
            }
          }
        }
      }
#line 564
      pexp ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 568
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 572
  return (match);
}
}
#line 584 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_insert(js_string *toinsert , js_string *target , int where ) 
{ 
  int place ;
  int counter ;
  char *temp_str ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 585
  place = 0;
#line 590
  tmp = js_has_sanity(toinsert);
  }
#line 590
  if (tmp == -1) {
#line 591
    return (-1);
  }
  {
#line 592
  tmp___0 = js_has_sanity(target);
  }
#line 592
  if (tmp___0 == -1) {
#line 593
    return (-1);
  }
#line 595
  if (toinsert->unit_size != target->unit_size) {
#line 596
    return (-1);
  }
#line 598
  if ((unsigned int )where > target->unit_count) {
#line 599
    return (-1);
  }
#line 602
  if ((unsigned int )where == target->unit_count) {
    {
#line 603
    tmp___1 = js_append(toinsert, target);
    }
#line 603
    return (tmp___1);
  }
#line 607
  if (toinsert->unit_count + target->unit_count > target->max_count) {
#line 608
    return (-1);
  }
  {
#line 611
  tmp___2 = js_alloc((int )target->unit_size, (int )target->unit_count);
#line 611
  temp_str = (char *)tmp___2;
  }
#line 611
  if ((unsigned long )temp_str == (unsigned long )((void *)-1)) {
#line 613
    return (-1);
  }
  {
#line 616
  while (1) {
    while_continue: /* CIL Label */ ;
#line 616
    if (! ((unsigned int )place < target->unit_size * target->unit_count)) {
#line 616
      goto while_break;
    }
#line 617
    *(temp_str + place) = (char )*(target->string + place);
#line 618
    place ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 622
  if (where < 0) {
#line 623
    where = (int )(target->unit_count + (unsigned int )where);
  }
#line 626
  if (where < 0) {
    {
#line 627
    js_dealloc((void *)temp_str);
    }
#line 628
    return (-1);
  }
#line 632
  place = 0;
#line 633
  counter = 0;
  {
#line 634
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 634
    if (! ((unsigned int )place < target->unit_size * target->unit_count)) {
#line 634
      goto while_break___0;
    }
#line 636
    if ((unsigned int )place == (unsigned int )where * target->unit_size) {
      {
#line 637
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 637
        if (! ((unsigned int )counter < toinsert->unit_size * toinsert->unit_count)) {
#line 637
          goto while_break___1;
        }
#line 639
        if ((unsigned int )(place + counter) < target->unit_size * target->max_count) {
#line 641
          *((target->string + place) + counter) = *(toinsert->string + counter);
        }
#line 643
        counter ++;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 646
    if ((unsigned int )(place + counter) < target->unit_size * target->max_count) {
#line 648
      *((target->string + place) + counter) = (unsigned char )*(temp_str + place);
    }
#line 649
    place ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 653
  target->unit_count += toinsert->unit_count;
#line 656
  js_dealloc((void *)temp_str);
  }
#line 658
  return (0);
}
}
#line 667 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_append(js_string *toappend , js_string *target ) 
{ 
  int counter ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 668
  counter = 0;
#line 671
  tmp = js_has_sanity(toappend);
  }
#line 671
  if (tmp == -1) {
#line 672
    return (-1);
  }
  {
#line 673
  tmp___0 = js_has_sanity(target);
  }
#line 673
  if (tmp___0 == -1) {
#line 674
    return (-1);
  }
#line 676
  if (toappend->unit_size != target->unit_size) {
#line 677
    return (-1);
  }
#line 681
  if (toappend->unit_count + target->unit_count >= target->max_count) {
#line 682
    return (-1);
  }
  {
#line 685
  while (1) {
    while_continue: /* CIL Label */ ;
#line 685
    if (! ((unsigned int )counter < toappend->unit_size * toappend->unit_count)) {
#line 685
      goto while_break;
    }
#line 686
    *((target->string + target->unit_size * target->unit_count) + counter) = *(toappend->string + counter);
#line 688
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 692
  target->unit_count += toappend->unit_count;
#line 694
  return (0);
}
}
#line 702 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_substr(js_string *source , js_string *dest , int start , int count ) 
{ 
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 707
  tmp = js_has_sanity(source);
  }
#line 707
  if (tmp == -1) {
#line 708
    return (-1);
  }
  {
#line 709
  tmp___0 = js_has_sanity(dest);
  }
#line 709
  if (tmp___0 == -1) {
#line 710
    return (-1);
  }
#line 711
  if (source->unit_size != dest->unit_size) {
#line 712
    return (-1);
  }
#line 715
  if (count < 0) {
#line 716
    return (-1);
  }
#line 717
  if ((unsigned int )start >= source->unit_count) {
#line 718
    return (-1);
  } else
#line 717
  if ((unsigned int )start >= source->max_count) {
#line 718
    return (-1);
  }
#line 719
  if ((unsigned int )(start + count) > source->unit_count) {
#line 720
    return (-1);
  }
#line 721
  if ((unsigned int )(start + count) > source->max_count) {
#line 722
    return (-1);
  }
#line 723
  if ((unsigned int )count >= dest->max_count) {
#line 724
    return (-1);
  }
#line 727
  counter = 0;
  {
#line 728
  while (1) {
    while_continue: /* CIL Label */ ;
#line 728
    if ((unsigned int )counter < (unsigned int )count * source->unit_size) {
      {
#line 728
      tmp___1 = js_octets(dest);
      }
#line 728
      if (counter < tmp___1) {
        {
#line 728
        tmp___2 = js_octets(source);
        }
#line 728
        if (! ((unsigned int )counter + (unsigned int )start * source->unit_size < (unsigned int )tmp___2)) {
#line 728
          goto while_break;
        }
      } else {
#line 728
        goto while_break;
      }
    } else {
#line 728
      goto while_break;
    }
#line 730
    *(dest->string + counter) = *((source->string + counter) + (unsigned int )start * source->unit_size);
#line 732
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 735
  dest->unit_count = (unsigned int )count;
#line 737
  return (1);
}
}
#line 743 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_copy(js_string *src , js_string *dest ) 
{ 
  int counter ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 744
  counter = 0;
#line 747
  tmp = js_has_sanity(src);
  }
#line 747
  if (tmp == -1) {
#line 748
    return (-1);
  } else {
    {
#line 747
    tmp___0 = js_has_sanity(dest);
    }
#line 747
    if (tmp___0 == -1) {
#line 748
      return (-1);
    }
  }
#line 750
  if (src->unit_size != dest->unit_size) {
#line 751
    return (-1);
  }
  {
#line 753
  tmp___1 = js_octets(dest);
  }
#line 753
  if (src->unit_size * src->unit_count >= (unsigned int )tmp___1) {
#line 754
    return (-1);
  }
  {
#line 757
  while (1) {
    while_continue: /* CIL Label */ ;
#line 757
    if ((unsigned int )counter < src->unit_size * src->unit_count) {
      {
#line 757
      tmp___2 = js_octets(dest);
      }
#line 757
      if (counter < tmp___2) {
        {
#line 757
        tmp___3 = js_octets(src);
        }
#line 757
        if (! (counter < tmp___3)) {
#line 757
          goto while_break;
        }
      } else {
#line 757
        goto while_break;
      }
    } else {
#line 757
      goto while_break;
    }
#line 759
    *(dest->string + counter) = *(src->string + counter);
#line 760
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 764
  dest->unit_count = src->unit_count;
#line 765
  dest->encoding = src->encoding;
#line 767
  return (1);
}
}
#line 777 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_val(js_string *js , int offset ) 
{ 
  int value___6 ;
  int point ;
  int tmp ;

  {
  {
#line 782
  tmp = js_has_sanity(js);
  }
#line 782
  if (tmp == -1) {
#line 783
    return (-1);
  }
#line 784
  if ((unsigned int )offset >= js->unit_count) {
#line 785
    return (-1);
  }
#line 788
  if ((unsigned long )js->unit_size >= sizeof(int )) {
#line 789
    return (-1);
  }
#line 791
  point = 0;
#line 791
  value___6 = point;
  {
#line 793
  while (1) {
    while_continue: /* CIL Label */ ;
#line 793
    if (! ((unsigned int )point < js->unit_size)) {
#line 793
      goto while_break;
    }
#line 794
    value___6 *= 256;
#line 795
    value___6 += (int )*((js->string + (unsigned int )offset * js->unit_size) + point);
#line 796
    point ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return (value___6);
}
}
#line 808 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_qappend(char *toappend , js_string *target ) 
{ 
  js_string *temp ;
  int return_value ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 810
  temp = (js_string *)0;
#line 814
  tmp = js_has_sanity(target);
  }
#line 814
  if (tmp == -1) {
#line 815
    return (-1);
  }
#line 818
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
    {
#line 821
    temp = js_create(1024U, target->unit_size);
    }
#line 821
    if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 822
      return (-1);
    }
  }
  {
#line 824
  tmp___0 = js_qstr2js(temp, toappend);
  }
#line 824
  if (tmp___0 == -1) {
    {
#line 825
    js_destroy(temp);
    }
#line 826
    return (-1);
  }
  {
#line 829
  return_value = js_append(temp, target);
#line 831
  js_destroy(temp);
  }
#line 833
  return (return_value);
}
}
#line 843 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_qprepend(char *toprepend , js_string *target ) 
{ 
  js_string *temp ;
  int return_value ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 845
  temp = (js_string *)0;
#line 849
  tmp = js_has_sanity(target);
  }
#line 849
  if (tmp == -1) {
#line 850
    return (-1);
  }
#line 853
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
    {
#line 857
    temp = js_create(1024U, target->unit_size);
    }
#line 857
    if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 858
      return (-1);
    }
  }
  {
#line 860
  tmp___0 = js_qstr2js(temp, toprepend);
  }
#line 860
  if (tmp___0 == -1) {
    {
#line 861
    js_destroy(temp);
    }
#line 862
    return (-1);
  }
  {
#line 866
  temp->encoding = target->encoding;
#line 868
  tmp___1 = js_append(target, temp);
  }
#line 868
  if (tmp___1 == -1) {
    {
#line 869
    js_destroy(temp);
    }
#line 870
    return (-1);
  }
  {
#line 873
  return_value = js_copy(temp, target);
#line 875
  js_destroy(temp);
  }
#line 877
  return (return_value);
}
}
#line 886 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_qissame(char *expression , js_string *target ) 
{ 
  js_string *temp ;
  int return_value ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 888
  temp = (js_string *)0;
#line 892
  tmp = js_has_sanity(target);
  }
#line 892
  if (tmp == -1) {
#line 893
    return (-1);
  }
#line 896
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
    {
#line 899
    temp = js_create(1024U, target->unit_size);
    }
#line 899
    if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 900
      return (-1);
    }
  }
  {
#line 902
  tmp___0 = js_qstr2js(temp, expression);
  }
#line 902
  if (tmp___0 == -1) {
    {
#line 903
    js_destroy(temp);
    }
#line 904
    return (-1);
  }
  {
#line 907
  temp->unit_size = target->unit_size;
#line 908
  temp->encoding = target->encoding;
#line 909
  return_value = js_issame(temp, target);
#line 911
  js_destroy(temp);
  }
#line 913
  return (return_value);
}
}
#line 922 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_qfgrep(char *expression , js_string *target ) 
{ 
  js_string *temp ;
  int return_value ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 924
  temp = (js_string *)0;
#line 928
  tmp = js_has_sanity(target);
  }
#line 928
  if (tmp == -1) {
#line 929
    return (-1);
  }
#line 932
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
    {
#line 935
    temp = js_create(1024U, target->unit_size);
    }
#line 935
    if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 936
      return (-1);
    }
  }
  {
#line 938
  tmp___0 = js_qstr2js(temp, expression);
  }
#line 938
  if (tmp___0 == -1) {
    {
#line 939
    js_destroy(temp);
    }
#line 940
    return (-1);
  }
  {
#line 943
  return_value = js_fgrep(temp, target);
#line 945
  js_destroy(temp);
  }
#line 947
  return (return_value);
}
}
#line 957 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_addbyte(js_string *js , unsigned char byte ) 
{ 
  int tmp ;

  {
  {
#line 960
  tmp = js_has_sanity(js);
  }
#line 960
  if (tmp == -1) {
#line 961
    return (-1);
  }
#line 962
  if (js->unit_size != 1U) {
#line 963
    return (-1);
  }
#line 965
  if (js->unit_count + 1U >= js->max_count) {
#line 966
    return (-1);
  }
#line 969
  *(js->string + js->unit_count) = byte;
#line 970
  (js->unit_count) ++;
#line 972
  return (1);
}
}
#line 981 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_changebyte(js_string *js , unsigned char byte , int offset ) 
{ 
  int tmp ;

  {
  {
#line 984
  tmp = js_has_sanity(js);
  }
#line 984
  if (tmp == -1) {
#line 985
    return (-1);
  }
#line 986
  if (js->unit_size != 1U) {
#line 987
    return (-1);
  }
#line 989
  if ((unsigned int )offset >= js->unit_count) {
#line 990
    return (-1);
  }
#line 993
  *(js->string + offset) = byte;
#line 995
  return (1);
}
}
#line 1004 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_adduint16(js_string *js , int number ) 
{ 
  int tmp ;

  {
  {
#line 1007
  tmp = js_has_sanity(js);
  }
#line 1007
  if (tmp == -1) {
#line 1008
    return (-1);
  }
#line 1009
  if (js->unit_size != 1U) {
#line 1010
    return (-1);
  }
#line 1011
  if (number < 0) {
#line 1012
    return (-1);
  } else
#line 1011
  if (number > 65535) {
#line 1012
    return (-1);
  }
#line 1014
  if (js->unit_count + 2U >= js->max_count) {
#line 1015
    return (-1);
  }
#line 1018
  *(js->string + js->unit_count) = (unsigned char )((number >> 8) & 255);
#line 1019
  *((js->string + js->unit_count) + 1) = (unsigned char )(number & 255);
#line 1020
  js->unit_count += 2U;
#line 1022
  return (1);
}
}
#line 1031 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_readbyte(js_string *js , unsigned int offset ) 
{ 
  int tmp ;

  {
  {
#line 1034
  tmp = js_has_sanity(js);
  }
#line 1034
  if (tmp == -1) {
#line 1035
    return (-1);
  }
#line 1036
  if (js->unit_size != 1U) {
#line 1037
    return (-1);
  }
#line 1038
  if (offset > js->unit_count - 1U) {
#line 1039
    return (-1);
  } else
#line 1038
  if (offset < 0U) {
#line 1039
    return (-1);
  }
#line 1041
  return ((int )*(js->string + offset));
}
}
#line 1052 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_readuint16(js_string *js , unsigned int offset ) 
{ 
  int ret ;
  int tmp ;

  {
  {
#line 1056
  tmp = js_has_sanity(js);
  }
#line 1056
  if (tmp == -1) {
#line 1057
    return (-1);
  }
#line 1058
  if (js->unit_size != 1U) {
#line 1059
    return (-1);
  }
#line 1060
  if (offset > js->unit_count - 2U) {
#line 1061
    return (-1);
  } else
#line 1060
  if (offset < 0U) {
#line 1061
    return (-1);
  }
#line 1063
  ret = (((int )*(js->string + offset) << 8) & 65280) | ((int )*((js->string + offset) + 1) & 255);
#line 1066
  return (ret);
}
}
#line 1081 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/JsStr.c"
int js_substr_append(js_string *source , js_string *dest , int offset , int length ) 
{ 
  js_string *temp ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 1085
  temp = js_create((unsigned int )(length + 2), 1U);
  }
#line 1085
  if ((unsigned long )temp == (unsigned long )((js_string *)0)) {
#line 1086
    return (-1);
  }
#line 1089
  if (source->unit_count < (unsigned int )(offset + length)) {
    {
#line 1090
    js_destroy(temp);
    }
#line 1091
    return (-1);
  }
  {
#line 1094
  tmp = js_substr(source, temp, offset, length);
  }
#line 1094
  if (tmp != 1) {
    {
#line 1095
    js_destroy(temp);
    }
#line 1096
    return (-1);
  }
  {
#line 1099
  tmp___0 = js_append(temp, dest);
  }
#line 1099
  if (tmp___0 == -1) {
    {
#line 1100
    js_destroy(temp);
    }
#line 1101
    return (-1);
  }
  {
#line 1104
  js_destroy(temp);
  }
#line 1105
  return (1);
}
}
#line 59 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.h"
unsigned int mhash_js(js_string *tohash , int hash_bits ) ;
#line 61
int mhash_put(mhash *hash , js_string *key___6 , void *value___6 , int datatype ) ;
#line 62
mhash_e mhash_get(mhash *hash , js_string *key___6 ) ;
#line 65
int mhash_firstkey(mhash *hash , js_string *key___6 ) ;
#line 66
int mhash_nextkey(mhash *hash , js_string *key___6 ) ;
#line 69
mara_tuple *mtuple_new(int elements ) ;
#line 70
int mtuple_put(mara_tuple *tuple , js_string *js , int element ) ;
#line 71
js_string *mtuple_get(mara_tuple *tuple , int element ) ;
#line 73
js_string *mhash_get_immutable_key(mhash *hash , js_string *key___6 ) ;
#line 5 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/functions_MaraHash.h"
int mhash_undef_js(mhash *hash , js_string *key___6 ) ;
#line 13
int mhash_resize(mhash *hash , int new_bits ) ;
#line 43
int mhash_set_add_constant(char *filename ) ;
#line 39 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
unsigned int mhash_mask[31]  = 
#line 39 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
  {      1U,      1U,      3U,      7U, 
        15U,      31U,      63U,      127U, 
        255U,      511U,      1023U,      2047U, 
        4095U,      8191U,      16383U,      32767U, 
        65535U,      131071U,      262143U,      524287U, 
        1048575U,      2097151U,      4194303U,      8388607U, 
        16777215U,      33554431U,      67108863U,      134217727U, 
        268435455U,      536870911U,      1073741823U};
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
unsigned int mhash_secret_add_constant  =    7U;
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
mhash *mhash_create(int hash_bits ) 
{ 
  mhash *new ;
  int counter ;
  void *tmp ;
  mhash_spot **tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 58
  tmp = js_alloc(1, (int )sizeof(mhash ));
#line 58
  new = (mhash *)tmp;
  }
#line 58
  if ((unsigned long )new == (unsigned long )((mhash *)0)) {
#line 59
    return ((mhash *)0);
  }
  {
#line 61
  new->hash_bits = hash_bits;
#line 65
  tmp___1 = js_alloc((int )(mhash_mask[hash_bits] + 1U), (int )sizeof(mhash_spot *));
#line 65
  tmp___0 = (mhash_spot **)tmp___1;
#line 65
  new->hash_table = tmp___0;
  }
#line 65
  if ((unsigned long )tmp___0 == (unsigned long )((mhash_spot **)0)) {
    {
#line 67
    js_dealloc((void *)new);
    }
#line 68
    return ((mhash *)0);
  }
#line 72
  counter = 0;
  {
#line 72
  while (1) {
    while_continue: /* CIL Label */ ;
#line 72
    if (! ((unsigned int )counter <= mhash_mask[hash_bits])) {
#line 72
      goto while_break;
    }
#line 73
    *(new->hash_table + counter) = (mhash_spot *)0;
#line 72
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 76
  new->spots = 0U;
#line 79
  return (new);
}
}
#line 89 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
unsigned int mhash_js(js_string *tohash , int hash_bits ) 
{ 
  unsigned int ret ;
  unsigned char *point ;
  unsigned char *max ;
  int shift ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 91
  ret = 0U;
#line 94
  shift = 0;
#line 96
  tmp = js_has_sanity(tohash);
  }
#line 96
  if (tmp == -1) {
#line 97
    return (0U);
  }
  {
#line 98
  point = tohash->string;
#line 99
  max = point + tohash->unit_count * tohash->unit_size;
#line 100
  tmp___0 = js_octets(tohash);
  }
#line 100
  if ((unsigned long )max > (unsigned long )(point + tmp___0)) {
#line 101
    return (0U);
  }
  {
#line 104
  while (1) {
    while_continue: /* CIL Label */ ;
#line 104
    if (! ((unsigned long )point < (unsigned long )max)) {
#line 104
      goto while_break;
    }
#line 105
    ret += (unsigned int )((int )*point << shift);
#line 106
    ret += mhash_secret_add_constant;
#line 107
    ret *= 45737U;
#line 108
    shift += 7;
#line 109
    shift %= hash_bits;
#line 110
    point ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 114
  ret ^= ret >> 7;
#line 117
  ret &= mhash_mask[hash_bits];
#line 120
  if (ret == 0U) {
#line 121
    ret ++;
  }
#line 123
  return (ret);
}
}
#line 133 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_put(mhash *hash , js_string *key___6 , void *value___6 , int datatype ) 
{ 
  unsigned int first_found ;
  js_string *new_key ;
  mhash_spot *point ;
  mhash_spot *new ;
  int tmp ;
  int tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 141
  tmp = js_has_sanity(key___6);
  }
#line 141
  if (tmp == -1) {
#line 142
    return (-1);
  }
  {
#line 145
  first_found = mhash_js(key___6, hash->hash_bits);
  }
#line 146
  if (first_found == 0U) {
#line 147
    return (-1);
  }
  {
#line 151
  new_key = js_create(key___6->unit_count + 1U, key___6->unit_size);
  }
#line 151
  if ((unsigned long )new_key == (unsigned long )((js_string *)0)) {
    {
#line 152
    js_dealloc((void *)*(hash->hash_table + first_found));
    }
#line 153
    return (-1);
  }
  {
#line 155
  tmp___0 = js_copy(key___6, new_key);
  }
#line 155
  if (tmp___0 == -1) {
    {
#line 156
    js_dealloc((void *)*(hash->hash_table + first_found));
#line 157
    js_destroy(new_key);
    }
#line 158
    return (-1);
  }
  {
#line 162
  tmp___1 = js_alloc(1, (int )sizeof(mhash_spot ));
#line 162
  new = (mhash_spot *)tmp___1;
  }
#line 162
  if ((unsigned long )new == (unsigned long )((mhash_spot *)0)) {
#line 163
    return (-1);
  }
#line 166
  new->key = new_key;
#line 167
  new->value = value___6;
#line 168
  new->datatype = datatype;
#line 169
  new->next = (struct mhash_spot *)0;
#line 172
  point = *(hash->hash_table + first_found);
#line 174
  if ((unsigned long )point == (unsigned long )((mhash_spot *)0)) {
#line 175
    *(hash->hash_table + first_found) = new;
  } else {
    {
#line 180
    tmp___2 = js_issame(point->key, new_key);
    }
#line 180
    if (tmp___2) {
#line 181
      goto cleanup;
    }
    {
#line 182
    while (1) {
      while_continue: /* CIL Label */ ;
#line 182
      if (! ((unsigned long )point->next != (unsigned long )((struct mhash_spot *)0))) {
#line 182
        goto while_break;
      }
      {
#line 184
      tmp___3 = js_issame(point->key, new_key);
      }
#line 184
      if (tmp___3) {
#line 185
        goto cleanup;
      }
#line 186
      point = point->next;
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 189
    tmp___4 = js_issame(point->key, new_key);
    }
#line 189
    if (tmp___4) {
#line 190
      goto cleanup;
    }
#line 191
    point->next = new;
  }
#line 195
  (hash->spots) ++;
#line 197
  return (1);
  cleanup: 
  {
#line 200
  js_destroy(new_key);
#line 201
  js_dealloc((void *)new);
  }
#line 202
  return (-1);
}
}
#line 212 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
mhash_e mhash_get(mhash *hash , js_string *key___6 ) 
{ 
  unsigned int first_found ;
  mhash_spot *point ;
  mhash_e ret ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 218
  ret.point = (void **)0;
#line 219
  ret.value = (void *)0;
#line 220
  ret.datatype = -1;
#line 223
  tmp = js_has_sanity(key___6);
  }
#line 223
  if (tmp == -1) {
#line 224
    return (ret);
  }
  {
#line 227
  first_found = mhash_js(key___6, hash->hash_bits);
  }
#line 230
  if ((unsigned long )*(hash->hash_table + first_found) == (unsigned long )((mhash_spot *)0)) {
#line 231
    ret.value = (void *)0;
#line 232
    ret.datatype = 0;
#line 233
    ret.point = (void **)0;
#line 234
    return (ret);
  }
#line 237
  point = *(hash->hash_table + first_found);
  {
#line 240
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 240
    tmp___0 = js_issame(key___6, point->key);
    }
#line 240
    if (tmp___0) {
#line 240
      goto while_break;
    }
#line 242
    if ((unsigned long )point->next == (unsigned long )((struct mhash_spot *)0)) {
#line 243
      ret.value = (void *)0;
#line 244
      ret.datatype = 0;
#line 245
      ret.point = (void **)0;
#line 246
      return (ret);
    }
#line 248
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 252
  ret.point = & point->value;
#line 253
  ret.value = point->value;
#line 254
  ret.datatype = point->datatype;
#line 256
  return (ret);
}
}
#line 266 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
js_string *mhash_get_immutable_key(mhash *hash , js_string *key___6 ) 
{ 
  unsigned int first_found ;
  mhash_spot *point ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 272
  tmp = js_has_sanity(key___6);
  }
#line 272
  if (tmp == -1) {
#line 273
    return ((js_string *)0);
  }
  {
#line 276
  first_found = mhash_js(key___6, hash->hash_bits);
  }
#line 279
  if ((unsigned long )*(hash->hash_table + first_found) == (unsigned long )((mhash_spot *)0)) {
#line 280
    return ((js_string *)0);
  }
#line 282
  point = *(hash->hash_table + first_found);
  {
#line 285
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 285
    tmp___0 = js_issame(key___6, point->key);
    }
#line 285
    if (tmp___0) {
#line 285
      goto while_break;
    }
#line 287
    if ((unsigned long )point->next == (unsigned long )((struct mhash_spot *)0)) {
#line 288
      return ((js_string *)0);
    }
#line 289
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 294
  return (point->key);
}
}
#line 303 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
void *mhash_undef(mhash *hash , js_string *key___6 ) 
{ 
  unsigned int first_found ;
  mhash_spot *point ;
  mhash_spot *last ;
  void *ret ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 309
  first_found = mhash_js(key___6, hash->hash_bits);
  }
#line 310
  if (first_found == 0U) {
#line 311
    return ((void *)0);
  }
#line 315
  if ((unsigned long )*(hash->hash_table + first_found) == (unsigned long )((mhash_spot *)0)) {
#line 316
    return ((void *)0);
  }
#line 319
  point = *(hash->hash_table + first_found);
#line 320
  last = (mhash_spot *)0;
  {
#line 323
  while (1) {
    while_continue: /* CIL Label */ ;
#line 323
    if (! ((unsigned long )point != (unsigned long )((mhash_spot *)0))) {
#line 323
      goto while_break;
    }
    {
#line 325
    tmp = js_issame(key___6, point->key);
    }
#line 325
    if (tmp) {
#line 326
      goto while_break;
    }
#line 327
    last = point;
#line 328
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 332
  if ((unsigned long )point == (unsigned long )((mhash_spot *)0)) {
#line 333
    return ((void *)0);
  }
#line 336
  if ((unsigned long )last == (unsigned long )((mhash_spot *)0)) {
#line 337
    *(hash->hash_table + first_found) = point->next;
  } else {
#line 339
    last->next = point->next;
  }
  {
#line 342
  (hash->spots) --;
#line 345
  tmp___0 = js_destroy(point->key);
  }
#line 345
  if (tmp___0 == -1) {
#line 346
    return ((void *)0);
  }
  {
#line 350
  ret = point->value;
#line 353
  tmp___1 = js_dealloc((void *)point);
  }
#line 353
  if (tmp___1 == -1) {
#line 354
    return ((void *)0);
  }
#line 359
  return (ret);
}
}
#line 367 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_put_js(mhash *hash , js_string *key___6 , js_string *value___6 ) 
{ 
  js_string *new ;
  int ret ;
  int tmp ;

  {
  {
#line 376
  new = js_create(value___6->unit_count + 1U, value___6->unit_size);
  }
#line 376
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
#line 377
    return (-1);
  }
  {
#line 378
  tmp = js_copy(value___6, new);
  }
#line 378
  if (tmp == -1) {
    {
#line 379
    js_destroy(new);
    }
#line 380
    return (-1);
  }
  {
#line 383
  ret = mhash_put(hash, key___6, (void *)new, 1);
  }
#line 385
  if (ret == -1) {
    {
#line 386
    js_destroy(new);
    }
  }
#line 388
  return (ret);
}
}
#line 395 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
js_string *mhash_get_js(mhash *hash , js_string *key___6 ) 
{ 
  mhash_e info ;
  int tmp ;

  {
  {
#line 397
  info = mhash_get(hash, key___6);
  }
#line 398
  if ((unsigned long )info.value == (unsigned long )((void *)0)) {
#line 399
    return ((js_string *)0);
  }
#line 400
  if (info.datatype != 1) {
#line 401
    return ((js_string *)0);
  }
  {
#line 402
  tmp = js_has_sanity((js_string *)info.value);
  }
#line 402
  if (tmp == -1) {
#line 403
    return ((js_string *)0);
  }
#line 404
  return ((js_string *)info.value);
}
}
#line 411 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_undef_js(mhash *hash , js_string *key___6 ) 
{ 
  js_string *tonuke ;
  void *tmp ;
  int tmp___0 ;

  {
  {
#line 413
  tmp = mhash_undef(hash, key___6);
#line 413
  tonuke = (js_string *)tmp;
  }
#line 414
  if ((unsigned long )tonuke == (unsigned long )((js_string *)0)) {
    {
#line 415
    js_destroy(tonuke);
    }
#line 416
    return (-1);
  }
  {
#line 418
  tmp___0 = js_destroy(tonuke);
  }
#line 418
  return (tmp___0);
}
}
#line 427 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_resize(mhash *hash , int new_bits ) 
{ 
  unsigned int counter ;
  unsigned int old_tablesize ;
  mhash_spot **new_hash_table ;
  mhash_spot **old_hash_table ;
  mhash_spot *point ;
  mhash_spot *save ;
  void *tmp ;
  int tmp___0 ;

  {
#line 434
  if (new_bits < 1) {
#line 435
    return (-1);
  } else
#line 434
  if (new_bits > 29) {
#line 435
    return (-1);
  }
  {
#line 438
  tmp = js_alloc((int )(mhash_mask[new_bits] + 1U), (int )sizeof(mhash_spot *));
#line 438
  new_hash_table = (mhash_spot **)tmp;
  }
#line 438
  if ((unsigned long )new_hash_table == (unsigned long )((mhash_spot **)0)) {
#line 440
    return (-1);
  }
#line 443
  counter = 0U;
  {
#line 443
  while (1) {
    while_continue: /* CIL Label */ ;
#line 443
    if (! (counter <= mhash_mask[new_bits])) {
#line 443
      goto while_break;
    }
#line 444
    *(new_hash_table + counter) = (mhash_spot *)0;
#line 443
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 447
  old_hash_table = hash->hash_table;
#line 451
  old_tablesize = mhash_mask[hash->hash_bits];
#line 455
  hash->hash_table = new_hash_table;
#line 456
  hash->hash_bits = new_bits;
#line 459
  counter = 1U;
  {
#line 459
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 459
    if (! (counter <= old_tablesize)) {
#line 459
      goto while_break___0;
    }
#line 462
    if ((unsigned long )*(old_hash_table + counter) != (unsigned long )((mhash_spot *)0)) {
#line 463
      point = *(old_hash_table + counter);
      {
#line 466
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 466
        if (! ((unsigned long )point != (unsigned long )((mhash_spot *)0))) {
#line 466
          goto while_break___1;
        }
#line 468
        if ((unsigned long )point->key == (unsigned long )((js_string *)0)) {
#line 469
          goto while_continue___1;
        }
        {
#line 470
        tmp___0 = js_has_sanity(point->key);
        }
#line 470
        if (tmp___0 == -1) {
#line 471
          goto while_continue___1;
        }
        {
#line 474
        mhash_put(hash, point->key, point->value, point->datatype);
#line 478
        save = point->next;
#line 479
        js_dealloc((void *)point);
#line 480
        point = save;
        }
      }
      while_break___1: /* CIL Label */ ;
      }
    }
#line 459
    counter ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 486
  js_dealloc((void *)old_hash_table);
  }
#line 488
  return (1);
}
}
#line 497 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_autogrow(mhash *hash ) 
{ 
  int bits ;
  int tmp ;
  int tmp___0 ;

  {
#line 501
  bits = hash->hash_bits;
#line 502
  if (bits < 1) {
#line 503
    return (-1);
  } else
#line 502
  if (bits > 29) {
#line 503
    return (-1);
  }
#line 506
  if (bits < 4) {
    {
#line 507
    tmp = mhash_resize(hash, bits + 1);
    }
#line 507
    if (tmp == -1) {
#line 508
      return (-1);
    }
#line 509
    return (2);
  }
#line 516
  if (hash->spots >= mhash_mask[bits - 1]) {
    {
#line 517
    tmp___0 = mhash_resize(hash, bits + 1);
    }
#line 517
    if (tmp___0 == -1) {
#line 518
      return (-1);
    }
#line 519
    return (2);
  }
#line 523
  return (1);
}
}
#line 535 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_firstkey(mhash *hash , js_string *key___6 ) 
{ 
  unsigned int offset ;
  mhash_spot *point ;
  int tmp ;

  {
#line 536
  offset = 0U;
  {
#line 539
  while (1) {
    while_continue: /* CIL Label */ ;
#line 539
    if (! (offset < mhash_mask[hash->hash_bits] + 1U)) {
#line 539
      goto while_break;
    }
#line 542
    if ((unsigned long )*(hash->hash_table + offset) != (unsigned long )((mhash_spot *)0)) {
      {
#line 543
      point = *(hash->hash_table + offset);
#line 544
      tmp = js_copy(point->key, key___6);
      }
#line 544
      return (tmp);
    } else {
#line 547
      offset ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 552
  return (0);
}
}
#line 565 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_nextkey(mhash *hash , js_string *key___6 ) 
{ 
  mhash_spot *point ;
  unsigned int offset ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 570
  offset = mhash_js(key___6, hash->hash_bits);
  }
#line 573
  if (offset > mhash_mask[hash->hash_bits]) {
#line 574
    return (-1);
  } else
#line 573
  if (offset < 0U) {
#line 574
    return (-1);
  }
#line 578
  point = *(hash->hash_table + offset);
#line 581
  if ((unsigned long )point == (unsigned long )((mhash_spot *)0)) {
#line 582
    return (-1);
  }
  {
#line 585
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 585
    tmp = js_issame(key___6, point->key);
    }
#line 585
    if (tmp) {
#line 585
      goto while_break;
    }
#line 587
    if ((unsigned long )point->next == (unsigned long )((struct mhash_spot *)0)) {
#line 588
      return (-1);
    }
#line 590
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 598
  if ((unsigned long )point->next != (unsigned long )((struct mhash_spot *)0)) {
    {
#line 599
    tmp___0 = js_copy((point->next)->key, key___6);
    }
#line 599
    return (tmp___0);
  }
#line 604
  offset ++;
  {
#line 606
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 606
    if (! (offset < mhash_mask[hash->hash_bits] + 1U)) {
#line 606
      goto while_break___0;
    }
#line 609
    if ((unsigned long )*(hash->hash_table + offset) != (unsigned long )((mhash_spot *)0)) {
      {
#line 610
      point = *(hash->hash_table + offset);
#line 611
      tmp___1 = js_copy(point->key, key___6);
      }
#line 611
      return (tmp___1);
    } else {
#line 614
      offset ++;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 619
  return (0);
}
}
#line 626 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
mara_tuple *mtuple_new(int elements ) 
{ 
  mara_tuple *ret ;
  int counter ;
  void *tmp ;
  js_string **tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 630
  tmp = js_alloc(1, (int )sizeof(mara_tuple ));
#line 630
  ret = (mara_tuple *)tmp;
  }
#line 630
  if ((unsigned long )ret == (unsigned long )((mara_tuple *)0)) {
#line 631
    return ((mara_tuple *)0);
  }
  {
#line 633
  ret->elements = elements;
#line 634
  tmp___1 = js_alloc(elements, (int )sizeof(js_string *));
#line 634
  tmp___0 = (js_string **)tmp___1;
#line 634
  ret->tuple_list = tmp___0;
  }
#line 634
  if ((unsigned long )tmp___0 == (unsigned long )((js_string **)0)) {
    {
#line 635
    js_dealloc((void *)ret);
    }
#line 636
    return ((mara_tuple *)0);
  }
#line 640
  counter = 0;
  {
#line 640
  while (1) {
    while_continue: /* CIL Label */ ;
#line 640
    if (! (counter < elements)) {
#line 640
      goto while_break;
    }
#line 641
    *(ret->tuple_list + counter) = (js_string *)0;
#line 640
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 643
  return (ret);
}
}
#line 653 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mtuple_put(mara_tuple *tuple , js_string *js , int element ) 
{ 
  js_string *copy ;
  int tmp ;

  {
#line 659
  if (element >= tuple->elements) {
#line 660
    return (-1);
  } else
#line 659
  if (element < 0) {
#line 660
    return (-1);
  }
#line 661
  if ((unsigned long )*(tuple->tuple_list + element) != (unsigned long )((js_string *)0)) {
#line 662
    return (-1);
  }
  {
#line 667
  copy = js_create(js->unit_count + 1U, js->unit_size);
  }
#line 667
  if ((unsigned long )copy == (unsigned long )((js_string *)0)) {
#line 668
    return (-1);
  }
  {
#line 669
  tmp = js_copy(js, copy);
  }
#line 669
  if (tmp == -1) {
#line 670
    return (-1);
  }
#line 672
  *(tuple->tuple_list + element) = copy;
#line 674
  return (1);
}
}
#line 683 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
js_string *mtuple_get(mara_tuple *tuple , int element ) 
{ 


  {
#line 686
  if (element >= tuple->elements) {
#line 687
    return ((js_string *)0);
  } else
#line 686
  if (element < 0) {
#line 687
    return ((js_string *)0);
  }
#line 689
  return (*(tuple->tuple_list + element));
}
}
#line 693 "/home/wheatley/newnew/temp/maradns-2.0.09/libs/MaraHash.c"
int mhash_set_add_constant(char *filename ) 
{ 
  FILE *read___0 ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 694
  read___0 = (FILE *)0;
#line 696
  read___0 = fopen((char const   */* __restrict  */)filename, (char const   */* __restrict  */)"rb");
  }
#line 697
  if ((unsigned long )read___0 == (unsigned long )((void *)0)) {
#line 698
    return (-1);
  }
  {
#line 701
  tmp = _IO_getc(read___0);
#line 701
  mhash_secret_add_constant ^= (unsigned int )tmp;
#line 702
  mhash_secret_add_constant <<= 8;
#line 703
  tmp___0 = _IO_getc(read___0);
#line 703
  mhash_secret_add_constant ^= (unsigned int )tmp___0;
#line 704
  mhash_secret_add_constant <<= 8;
#line 705
  tmp___1 = _IO_getc(read___0);
#line 705
  mhash_secret_add_constant ^= (unsigned int )tmp___1;
#line 706
  mhash_secret_add_constant <<= 7;
#line 707
  tmp___2 = _IO_getc(read___0);
#line 707
  mhash_secret_add_constant ^= (unsigned int )tmp___2;
#line 708
  fclose(read___0);
  }
#line 709
  return (1);
}
}
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___0  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___0  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___0  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___0  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___0  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___0  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___0  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___0  =    (js_file *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___1  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___1  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___1  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___1  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___1  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___1  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___1  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___1  =    (js_file *)0;
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te0___0[256]  = 
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
  {      (u32 const   )3017953435U,      (u32 const   )1672792582U,      (u32 const   )2246353620U,      (u32 const   )560743938U, 
        (u32 const   )980369320U,      (u32 const   )2786508149U,      (u32 const   )323814928U,      (u32 const   )1298184604U, 
        (u32 const   )392868941U,      (u32 const   )2135030158U,      (u32 const   )3799505551U,      (u32 const   )3454798025U, 
        (u32 const   )1510608337U,      (u32 const   )453212586U,      (u32 const   )2070301651U,      (u32 const   )2715875159U, 
        (u32 const   )4205140826U,      (u32 const   )3929646389U,      (u32 const   )3315758963U,      (u32 const   )2977696056U, 
        (u32 const   )539224030U,      (u32 const   )3564185792U,      (u32 const   )2089812465U,      (u32 const   )582860413U, 
        (u32 const   )3967831755U,      (u32 const   )3107092098U,      (u32 const   )3172320479U,      (u32 const   )3385571988U, 
        (u32 const   )2760434902U,      (u32 const   )21995996U,      (u32 const   )1617244793U,      (u32 const   )4269992199U, 
        (u32 const   )1960738379U,      (u32 const   )2833328433U,      (u32 const   )69710429U,      (u32 const   )3864029394U, 
        (u32 const   )2307747635U,      (u32 const   )2458785433U,      (u32 const   )302163916U,      (u32 const   )2049567247U, 
        (u32 const   )522505207U,      (u32 const   )1682079780U,      (u32 const   )3715167910U,      (u32 const   )3200531616U, 
        (u32 const   )755338213U,      (u32 const   )368373230U,      (u32 const   )1462526442U,      (u32 const   )485831560U, 
        (u32 const   )4185170725U,      (u32 const   )1078384039U,      (u32 const   )733765659U,      (u32 const   )3735097049U, 
        (u32 const   )1121487876U,      (u32 const   )2402583757U,      (u32 const   )1600265808U,      (u32 const   )2203928874U, 
        (u32 const   )4112346818U,      (u32 const   )798741062U,      (u32 const   )3213598076U,      (u32 const   )3994949480U, 
        (u32 const   )1812791198U,      (u32 const   )371529105U,      (u32 const   )927552403U,      (u32 const   )1555293743U, 
        (u32 const   )1057434665U,      (u32 const   )1272533602U,      (u32 const   )90706817U,      (u32 const   )2416987962U, 
        (u32 const   )64092287U,      (u32 const   )1380217451U,      (u32 const   )3577645340U,      (u32 const   )2596301091U, 
        (u32 const   )1368754708U,      (u32 const   )2438983398U,      (u32 const   )3756961541U,      (u32 const   )2046300784U, 
        (u32 const   )3536372542U,      (u32 const   )968804311U,      (u32 const   )1983916008U,      (u32 const   )1208527389U, 
        (u32 const   )3480375658U,      (u32 const   )647629856U,      (u32 const   )2872103246U,      (u32 const   )3260300625U, 
        (u32 const   )1997506100U,      (u32 const   )2695845515U,      (u32 const   )668315132U,      (u32 const   )1342103615U, 
        (u32 const   )3021216441U,      (u32 const   )2363849906U,      (u32 const   )720617927U,      (u32 const   )3687390552U, 
        (u32 const   )3606016355U,      (u32 const   )1020712022U,      (u32 const   )1531292685U,      (u32 const   )1044942325U, 
        (u32 const   )841039890U,      (u32 const   )3785761520U,      (u32 const   )2609891583U,      (u32 const   )1133981144U, 
        (u32 const   )3433277717U,      (u32 const   )678271076U,      (u32 const   )837859437U,      (u32 const   )882420716U, 
        (u32 const   )1932014697U,      (u32 const   )1876756449U,      (u32 const   )1747668419U,      (u32 const   )1725749639U, 
        (u32 const   )1449377846U,      (u32 const   )1660644314U,      (u32 const   )2507693243U,      (u32 const   )3877619982U, 
        (u32 const   )1919391157U,      (u32 const   )3411403575U,      (u32 const   )1576814579U,      (u32 const   )1895418902U, 
        (u32 const   )3062514458U,      (u32 const   )2177044617U,      (u32 const   )3838718321U,      (u32 const   )220621883U, 
        (u32 const   )2898697068U,      (u32 const   )2556309632U,      (u32 const   )3666263172U,      (u32 const   )1833131586U, 
        (u32 const   )1768221727U,      (u32 const   )112847870U,      (u32 const   )2225799944U,      (u32 const   )3135475453U, 
        (u32 const   )299065267U,      (u32 const   )0U,      (u32 const   )251106372U,      (u32 const   )4226480774U, 
        (u32 const   )3148623649U,      (u32 const   )1695359480U,      (u32 const   )2925052623U,      (u32 const   )2251643563U, 
        (u32 const   )1630180261U,      (u32 const   )4099067678U,      (u32 const   )1147234298U,      (u32 const   )2272983927U, 
        (u32 const   )4087645500U,      (u32 const   )2807635113U,      (u32 const   )2111807533U,      (u32 const   )1486115954U, 
        (u32 const   )2625209053U,      (u32 const   )3625510183U,      (u32 const   )862904782U,      (u32 const   )133581346U, 
        (u32 const   )2781299978U,      (u32 const   )2156704085U,      (u32 const   )3083199174U,      (u32 const   )4015109812U, 
        (u32 const   )906424911U,      (u32 const   )4291643611U,      (u32 const   )1437743177U,      (u32 const   )1811592636U, 
        (u32 const   )1320239587U,      (u32 const   )2390435089U,      (u32 const   )1790252128U,      (u32 const   )4250079608U, 
        (u32 const   )416448981U,      (u32 const   )3548865250U,      (u32 const   )4075496672U,      (u32 const   )3390718699U, 
        (u32 const   )3695138682U,      (u32 const   )2294468335U,      (u32 const   )2376785262U,      (u32 const   )43932067U, 
        (u32 const   )429727753U,      (u32 const   )2956175588U,      (u32 const   )151117414U,      (u32 const   )208260583U, 
        (u32 const   )263730584U,      (u32 const   )4152571745U,      (u32 const   )4140603069U,      (u32 const   )2025305004U, 
        (u32 const   )1972494231U,      (u32 const   )1229392833U,      (u32 const   )3850473645U,      (u32 const   )2548434200U, 
        (u32 const   )3617640639U,      (u32 const   )1251406782U,      (u32 const   )2678618786U,      (u32 const   )3924319562U, 
        (u32 const   )195004357U,      (u32 const   )1160693286U,      (u32 const   )3160040707U,      (u32 const   )3646375163U, 
        (u32 const   )2568065372U,      (u32 const   )2527700164U,      (u32 const   )1191132761U,      (u32 const   )1278154816U, 
        (u32 const   )2486697319U,      (u32 const   )3812129619U,      (u32 const   )1033467274U,      (u32 const   )3342610128U, 
        (u32 const   )743057977U,      (u32 const   )625734751U,      (u32 const   )603070369U,      (u32 const   )441243766U, 
        (u32 const   )3495336605U,      (u32 const   )3095254878U,      (u32 const   )498766420U,      (u32 const   )955344395U, 
        (u32 const   )2721124136U,      (u32 const   )1580056460U,      (u32 const   )1202757509U,      (u32 const   )347819058U, 
        (u32 const   )2846787821U,      (u32 const   )1356475336U,      (u32 const   )604263811U,      (u32 const   )3950380265U, 
        (u32 const   )3042687845U,      (u32 const   )510356011U,      (u32 const   )2182277366U,      (u32 const   )4047166623U, 
        (u32 const   )3234489586U,      (u32 const   )139362234U,      (u32 const   )2742988532U,      (u32 const   )903285296U, 
        (u32 const   )3989827351U,      (u32 const   )3773399852U,      (u32 const   )817830321U,      (u32 const   )2665995134U, 
        (u32 const   )3903323286U,      (u32 const   )2478946117U,      (u32 const   )4229738660U,      (u32 const   )2997743943U, 
        (u32 const   )278724207U,      (u32 const   )2911451824U,      (u32 const   )2937545491U,      (u32 const   )785675162U, 
        (u32 const   )1855104573U,      (u32 const   )2637570817U,      (u32 const   )4164616953U,      (u32 const   )3329462028U, 
        (u32 const   )3246769454U,      (u32 const   )3364100936U,      (u32 const   )1737717851U,      (u32 const   )2860478610U, 
        (u32 const   )1091138683U,      (u32 const   )3273366669U,      (u32 const   )1907781066U,      (u32 const   )2333292176U, 
        (u32 const   )3508091713U,      (u32 const   )1425906069U,      (u32 const   )3303921327U,      (u32 const   )2114869330U, 
        (u32 const   )991993460U,      (u32 const   )2321323852U,      (u32 const   )4034231619U,      (u32 const   )1507587502U, 
        (u32 const   )3460165814U,      (u32 const   )1393284023U,      (u32 const   )181413401U,      (u32 const   )690108856U};
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te1___0[256]  = 
#line 69
  {      (u32 const   )2612257360U,      (u32 const   )107197642U,      (u32 const   )3565544610U,      (u32 const   )35744838U, 
        (u32 const   )2822401855U,      (u32 const   )1973819069U,      (u32 const   )269700358U,      (u32 const   )2622316729U, 
        (u32 const   )1293380276U,      (u32 const   )2390704633U,      (u32 const   )2413983706U,      (u32 const   )3385715720U, 
        (u32 const   )3512338957U,      (u32 const   )2853897081U,      (u32 const   )3548079691U,      (u32 const   )1470226679U, 
        (u32 const   )1526375771U,      (u32 const   )904542629U,      (u32 const   )1942332023U,      (u32 const   )951155721U, 
        (u32 const   )3726648295U,      (u32 const   )3235148072U,      (u32 const   )4051472385U,      (u32 const   )2099428798U, 
        (u32 const   )3421274190U,      (u32 const   )2193175158U,      (u32 const   )3753711044U,      (u32 const   )2496252858U, 
        (u32 const   )3601107172U,      (u32 const   )3691073441U,      (u32 const   )2036360498U,      (u32 const   )134120169U, 
        (u32 const   )1265950334U,      (u32 const   )833151273U,      (u32 const   )1560553394U,      (u32 const   )3538309224U, 
        (u32 const   )864652655U,      (u32 const   )2576518678U,      (u32 const   )3423732391U,      (u32 const   )259664362U, 
        (u32 const   )4146013387U,      (u32 const   )610550400U,      (u32 const   )2799530230U,      (u32 const   )2696856636U, 
        (u32 const   )3844933003U,      (u32 const   )3994416365U,      (u32 const   )3931581537U,      (u32 const   )2283599155U, 
        (u32 const   )637105315U,      (u32 const   )2806007509U,      (u32 const   )455851104U,      (u32 const   )3655246094U, 
        (u32 const   )71489676U,      (u32 const   )3448714372U,      (u32 const   )1348428318U,      (u32 const   )713252169U, 
        (u32 const   )3270843758U,      (u32 const   )1177525202U,      (u32 const   )2092927901U,      (u32 const   )1760435735U, 
        (u32 const   )2657881343U,      (u32 const   )2434147605U,      (u32 const   )2469874003U,      (u32 const   )794604518U, 
        (u32 const   )691996460U,      (u32 const   )1649138002U,      (u32 const   )2164615187U,      (u32 const   )982519887U, 
        (u32 const   )2130956792U,      (u32 const   )1800553586U,      (u32 const   )483737225U,      (u32 const   )597344361U, 
        (u32 const   )340891018U,      (u32 const   )3868286958U,      (u32 const   )98561711U,      (u32 const   )1887041554U, 
        (u32 const   )1054001347U,      (u32 const   )3610885831U,      (u32 const   )3900063783U,      (u32 const   )491260074U, 
        (u32 const   )1791980113U,      (u32 const   )539400716U,      (u32 const   )1319842001U,      (u32 const   )1371690045U, 
        (u32 const   )880217990U,      (u32 const   )2342563670U,      (u32 const   )4230469037U,      (u32 const   )1062207200U, 
        (u32 const   )3115586586U,      (u32 const   )2995578236U,      (u32 const   )3341480897U,      (u32 const   )1490798877U, 
        (u32 const   )1675030385U,      (u32 const   )1446827732U,      (u32 const   )224085420U,      (u32 const   )4114499725U, 
        (u32 const   )305275200U,      (u32 const   )4041319970U,      (u32 const   )4288384968U,      (u32 const   )3628308269U, 
        (u32 const   )365732777U,      (u32 const   )1680371096U,      (u32 const   )1831989432U,      (u32 const   )3962869931U, 
        (u32 const   )1769154612U,      (u32 const   )3782204679U,      (u32 const   )3278383949U,      (u32 const   )2271665369U, 
        (u32 const   )911631296U,      (u32 const   )3663919979U,      (u32 const   )3147135068U,      (u32 const   )250027977U, 
        (u32 const   )3044173717U,      (u32 const   )936072675U,      (u32 const   )4083022919U,      (u32 const   )376502732U, 
        (u32 const   )448170563U,      (u32 const   )2306982672U,      (u32 const   )1910820401U,      (u32 const   )990717548U, 
        (u32 const   )1823262363U,      (u32 const   )2157469232U,      (u32 const   )2228913852U,      (u32 const   )1114456926U, 
        (u32 const   )527000812U,      (u32 const   )4261853675U,      (u32 const   )142912259U,      (u32 const   )4256883598U, 
        (u32 const   )3004289887U,      (u32 const   )0U,      (u32 const   )1141831572U,      (u32 const   )2264656634U, 
        (u32 const   )565947439U,      (u32 const   )4167372065U,      (u32 const   )3484309698U,      (u32 const   )2877699418U, 
        (u32 const   )2774608531U,      (u32 const   )519328463U,      (u32 const   )4198785383U,      (u32 const   )2005367547U, 
        (u32 const   )1022600325U,      (u32 const   )2846316828U,      (u32 const   )763223968U,      (u32 const   )1918407764U, 
        (u32 const   )3718019458U,      (u32 const   )668473573U,      (u32 const   )3459477217U,      (u32 const   )570947146U, 
        (u32 const   )178636613U,      (u32 const   )1434487985U,      (u32 const   )3333932514U,      (u32 const   )3035582902U, 
        (u32 const   )1328940786U,      (u32 const   )3690974536U,      (u32 const   )1230352952U,      (u32 const   )3161193141U, 
        (u32 const   )3813585217U,      (u32 const   )294550309U,      (u32 const   )1617605908U,      (u32 const   )2029867793U, 
        (u32 const   )3575173761U,      (u32 const   )3805513570U,      (u32 const   )3774016292U,      (u32 const   )3955890754U, 
        (u32 const   )2061254487U,      (u32 const   )4018717390U,      (u32 const   )1854778077U,      (u32 const   )2734857817U, 
        (u32 const   )152673568U,      (u32 const   )3836752808U,      (u32 const   )1711866334U,      (u32 const   )3876350413U, 
        (u32 const   )2551167029U,      (u32 const   )1643610935U,      (u32 const   )3187068054U,      (u32 const   )2893592499U, 
        (u32 const   )2541064671U,      (u32 const   )3242805003U,      (u32 const   )2917499280U,      (u32 const   )412608005U, 
        (u32 const   )3218579664U,      (u32 const   )3192559347U,      (u32 const   )2728372346U,      (u32 const   )1256843357U, 
        (u32 const   )3305873287U,      (u32 const   )642068166U,      (u32 const   )62675557U,      (u32 const   )4225324868U, 
        (u32 const   )1553535377U,      (u32 const   )3298208164U,      (u32 const   )1497825086U,      (u32 const   )1078734616U, 
        (u32 const   )1737766909U,      (u32 const   )1407400059U,      (u32 const   )2319292789U,      (u32 const   )3502717998U, 
        (u32 const   )959203882U,      (u32 const   )1596279796U,      (u32 const   )2703487519U,      (u32 const   )1981435096U, 
        (u32 const   )2647676570U,      (u32 const   )1589149143U,      (u32 const   )1411234450U,      (u32 const   )188281190U, 
        (u32 const   )681718031U,      (u32 const   )2354982335U,      (u32 const   )2236067999U,      (u32 const   )840219468U, 
        (u32 const   )3987320456U,      (u32 const   )3360741931U,      (u32 const   )2200175701U,      (u32 const   )3924522500U, 
        (u32 const   )1706384315U,      (u32 const   )723413866U,      (u32 const   )4135719656U,      (u32 const   )2683386588U, 
        (u32 const   )4072720996U,      (u32 const   )3121106559U,      (u32 const   )4104355502U,      (u32 const   )808834826U, 
        (u32 const   )401461231U,      (u32 const   )752937347U,      (u32 const   )2972761881U,      (u32 const   )2124343259U, 
        (u32 const   )2531829756U,      (u32 const   )1167311287U,      (u32 const   )2767985840U,      (u32 const   )1202892273U, 
        (u32 const   )1863359742U,      (u32 const   )2964162874U,      (u32 const   )330241891U,      (u32 const   )2586760307U, 
        (u32 const   )1030656678U,      (u32 const   )27080227U,      (u32 const   )4193794818U,      (u32 const   )214332303U, 
        (u32 const   )784434629U,      (u32 const   )1221100571U,      (u32 const   )1533514616U,      (u32 const   )2460647280U, 
        (u32 const   )2067859828U,      (u32 const   )2378374044U,      (u32 const   )3396449901U,      (u32 const   )2425033526U, 
        (u32 const   )1104222523U,      (u32 const   )2505375129U,      (u32 const   )2948918742U,      (u32 const   )1383992920U, 
        (u32 const   )1950032030U,      (u32 const   )1284136087U,      (u32 const   )1139832189U,      (u32 const   )2925124597U, 
        (u32 const   )3066969584U,      (u32 const   )3075673043U,      (u32 const   )420139046U,      (u32 const   )3089703481U};
#line 135 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te2___0[256]  = 
#line 135
  {      (u32 const   )1352381410U,      (u32 const   )3389416372U,      (u32 const   )2731836900U,      (u32 const   )1174544748U, 
        (u32 const   )1067989615U,      (u32 const   )3178604054U,      (u32 const   )101716813U,      (u32 const   )3114028384U, 
        (u32 const   )3024951146U,      (u32 const   )4186865473U,      (u32 const   )3666862711U,      (u32 const   )147443180U, 
        (u32 const   )231823882U,      (u32 const   )2041191171U,      (u32 const   )1272150886U,      (u32 const   )4149715424U, 
        (u32 const   )1532689061U,      (u32 const   )2771774009U,      (u32 const   )2004075938U,      (u32 const   )154710396U, 
        (u32 const   )3890094115U,      (u32 const   )683725937U,      (u32 const   )32603280U,      (u32 const   )3195871933U, 
        (u32 const   )1321987200U,      (u32 const   )1988278578U,      (u32 const   )3302997269U,      (u32 const   )3130313163U, 
        (u32 const   )3839272072U,      (u32 const   )2715550031U,      (u32 const   )846815333U,      (u32 const   )3909615234U, 
        (u32 const   )2118874334U,      (u32 const   )691120353U,      (u32 const   )2992440359U,      (u32 const   )1758651984U, 
        (u32 const   )1865648525U,      (u32 const   )379163278U,      (u32 const   )2815169026U,      (u32 const   )3926882857U, 
        (u32 const   )3421970212U,      (u32 const   )2149868610U,      (u32 const   )4138130800U,      (u32 const   )1017167556U, 
        (u32 const   )2347052293U,      (u32 const   )3991803380U,      (u32 const   )1642747692U,      (u32 const   )864558325U, 
        (u32 const   )2737174900U,      (u32 const   )3584507974U,      (u32 const   )1612393404U,      (u32 const   )249159329U, 
        (u32 const   )2349089496U,      (u32 const   )2228064052U,      (u32 const   )508583778U,      (u32 const   )1227522909U, 
        (u32 const   )1858270493U,      (u32 const   )3527815067U,      (u32 const   )2642198411U,      (u32 const   )392752670U, 
        (u32 const   )4288572428U,      (u32 const   )361829925U,      (u32 const   )1402156873U,      (u32 const   )3861863603U, 
        (u32 const   )740900615U,      (u32 const   )1382173657U,      (u32 const   )327222632U,      (u32 const   )1329238032U, 
        (u32 const   )4169073617U,      (u32 const   )1919636036U,      (u32 const   )2300368190U,      (u32 const   )1763941056U, 
        (u32 const   )2316587413U,      (u32 const   )4008087903U,      (u32 const   )2936397806U,      (u32 const   )309361144U, 
        (u32 const   )3275674312U,      (u32 const   )3352771006U,      (u32 const   )669546048U,      (u32 const   )2854045704U, 
        (u32 const   )1365954418U,      (u32 const   )203433626U,      (u32 const   )3511593776U,      (u32 const   )1028768340U, 
        (u32 const   )2251585295U,      (u32 const   )1451991215U,      (u32 const   )2918983637U,      (u32 const   )3762245630U, 
        (u32 const   )448377876U,      (u32 const   )2092076261U,      (u32 const   )3251055347U,      (u32 const   )492362697U, 
        (u32 const   )1902368495U,      (u32 const   )3562421462U,      (u32 const   )2886556485U,      (u32 const   )2381659720U, 
        (u32 const   )1074934305U,      (u32 const   )586211750U,      (u32 const   )3372194703U,      (u32 const   )769147799U, 
        (u32 const   )2836778147U,      (u32 const   )2556700781U,      (u32 const   )3094163952U,      (u32 const   )2884383896U, 
        (u32 const   )879325992U,      (u32 const   )132214749U,      (u32 const   )1304651819U,      (u32 const   )3649529564U, 
        (u32 const   )3224786531U,      (u32 const   )1809474299U,      (u32 const   )1555797368U,      (u32 const   )3373197087U, 
        (u32 const   )2511696487U,      (u32 const   )3812084565U,      (u32 const   )1207131644U,      (u32 const   )3424022777U, 
        (u32 const   )1125824138U,      (u32 const   )277447107U,      (u32 const   )829547726U,      (u32 const   )1815809318U, 
        (u32 const   )2607590598U,      (u32 const   )813733982U,      (u32 const   )3162823302U,      (u32 const   )1581411651U, 
        (u32 const   )3961481572U,      (u32 const   )3959293625U,      (u32 const   )50889899U,      (u32 const   )2398993123U, 
        (u32 const   )1605571027U,      (u32 const   )0U,      (u32 const   )2487488247U,      (u32 const   )4203150314U, 
        (u32 const   )790739884U,      (u32 const   )569926925U,      (u32 const   )3268390488U,      (u32 const   )1521190453U, 
        (u32 const   )2477089066U,      (u32 const   )3474912338U,      (u32 const   )1744454753U,      (u32 const   )4218914682U, 
        (u32 const   )2235364260U,      (u32 const   )480880473U,      (u32 const   )2687335903U,      (u32 const   )1416779924U, 
        (u32 const   )2195561593U,      (u32 const   )3844593688U,      (u32 const   )3788387182U,      (u32 const   )1243744246U, 
        (u32 const   )1158325703U,      (u32 const   )2975170700U,      (u32 const   )3804673989U,      (u32 const   )3065311057U, 
        (u32 const   )4065277446U,      (u32 const   )1222377421U,      (u32 const   )944330162U,      (u32 const   )3049024506U, 
        (u32 const   )1105415857U,      (u32 const   )621907579U,      (u32 const   )341863093U,      (u32 const   )293141843U, 
        (u32 const   )2178226386U,      (u32 const   )1659032455U,      (u32 const   )618722027U,      (u32 const   )1122748954U, 
        (u32 const   )1467669567U,      (u32 const   )3471804610U,      (u32 const   )3715009962U,      (u32 const   )1503855262U, 
        (u32 const   )537467293U,      (u32 const   )2833559603U,      (u32 const   )3731228929U,      (u32 const   )3454471273U, 
        (u32 const   )899157944U,      (u32 const   )929167235U,      (u32 const   )2529031884U,      (u32 const   )3014424759U, 
        (u32 const   )3751245201U,      (u32 const   )197216583U,      (u32 const   )2427315585U,      (u32 const   )85497830U, 
        (u32 const   )3502233504U,      (u32 const   )4089334422U,      (u32 const   )2057478056U,      (u32 const   )1565190632U, 
        (u32 const   )2277837727U,      (u32 const   )3324396846U,      (u32 const   )1694743642U,      (u32 const   )1157355863U, 
        (u32 const   )2438764817U,      (u32 const   )2764347049U,      (u32 const   )1046038271U,      (u32 const   )406866991U, 
        (u32 const   )4251423799U,      (u32 const   )2069095224U,      (u32 const   )1971994009U,      (u32 const   )785434428U, 
        (u32 const   )708389962U,      (u32 const   )4099876171U,      (u32 const   )530654194U,      (u32 const   )3631618636U, 
        (u32 const   )2594033750U,      (u32 const   )3613309053U,      (u32 const   )2454986170U,      (u32 const   )1712011505U, 
        (u32 const   )254321201U,      (u32 const   )3213647405U,      (u32 const   )2676311984U,      (u32 const   )1278350523U, 
        (u32 const   )2297276846U,      (u32 const   )734548186U,      (u32 const   )1434657796U,      (u32 const   )82439030U, 
        (u32 const   )3144004955U,      (u32 const   )1781210731U,      (u32 const   )3908469266U,      (u32 const   )3701469498U, 
        (u32 const   )1693630666U,      (u32 const   )2142898254U,      (u32 const   )2935268222U,      (u32 const   )170931671U, 
        (u32 const   )4011322831U,      (u32 const   )2200756457U,      (u32 const   )431042751U,      (u32 const   )3682508519U, 
        (u32 const   )4237748391U,      (u32 const   )3074790337U,      (u32 const   )2963602460U,      (u32 const   )4048007853U, 
        (u32 const   )4268691612U,      (u32 const   )984657289U,      (u32 const   )1662234391U,      (u32 const   )1939484372U, 
        (u32 const   )2789043858U,      (u32 const   )587308342U,      (u32 const   )49936443U,      (u32 const   )2399979123U, 
        (u32 const   )3308175749U,      (u32 const   )457754756U,      (u32 const   )2019256211U,      (u32 const   )1888660095U, 
        (u32 const   )1954234633U,      (u32 const   )2626536219U,      (u32 const   )1841983926U,      (u32 const   )915442451U, 
        (u32 const   )994169113U,      (u32 const   )2576700669U,      (u32 const   )3601843437U,      (u32 const   )1481801230U, 
        (u32 const   )2658417440U,      (u32 const   )2538375772U,      (u32 const   )2101604469U,      (u32 const   )4121844187U, 
        (u32 const   )4038512189U,      (u32 const   )3552006923U,      (u32 const   )639175376U,      (u32 const   )968370466U};
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te3___0[256]  = 
#line 201
  {      (u32 const   )3796933555U,      (u32 const   )3033138787U,      (u32 const   )3835876485U,      (u32 const   )1816527393U, 
        (u32 const   )1866442810U,      (u32 const   )381515174U,      (u32 const   )1292242963U,      (u32 const   )1622776909U, 
        (u32 const   )1790201111U,      (u32 const   )1106873983U,      (u32 const   )2010812386U,      (u32 const   )3959998925U, 
        (u32 const   )168677722U,      (u32 const   )58305051U,      (u32 const   )1716245371U,      (u32 const   )3774306209U, 
        (u32 const   )2774227706U,      (u32 const   )967128554U,      (u32 const   )2725737413U,      (u32 const   )2080979121U, 
        (u32 const   )602398240U,      (u32 const   )1898496212U,      (u32 const   )2416046460U,      (u32 const   )3183377698U, 
        (u32 const   )2152647660U,      (u32 const   )846627513U,      (u32 const   )365223869U,      (u32 const   )3418002633U, 
        (u32 const   )2296698532U,      (u32 const   )1336007681U,      (u32 const   )1697806688U,      (u32 const   )2196310014U, 
        (u32 const   )3732818804U,      (u32 const   )3777573288U,      (u32 const   )666000644U,      (u32 const   )1349047014U, 
        (u32 const   )2372875145U,      (u32 const   )2383845778U,      (u32 const   )44551186U,      (u32 const   )703205242U, 
        (u32 const   )617346847U,      (u32 const   )1115694180U,      (u32 const   )1895212765U,      (u32 const   )3292307646U, 
        (u32 const   )93054253U,      (u32 const   )4109233685U,      (u32 const   )744614487U,      (u32 const   )4113795100U, 
        (u32 const   )1956849145U,      (u32 const   )1188407104U,      (u32 const   )3160415019U,      (u32 const   )2702105054U, 
        (u32 const   )3633054786U,      (u32 const   )881118607U,      (u32 const   )1646153823U,      (u32 const   )1565076099U, 
        (u32 const   )493798133U,      (u32 const   )2614249007U,      (u32 const   )2342354111U,      (u32 const   )504850670U, 
        (u32 const   )218078828U,      (u32 const   )622170390U,      (u32 const   )1230213943U,      (u32 const   )3018207068U, 
        (u32 const   )120334655U,      (u32 const   )3646054987U,      (u32 const   )1746108677U,      (u32 const   )273627792U, 
        (u32 const   )3522723587U,      (u32 const   )1148349266U,      (u32 const   )1049173205U,      (u32 const   )3228115866U, 
        (u32 const   )2508854353U,      (u32 const   )1609492113U,      (u32 const   )4004447711U,      (u32 const   )4161958009U, 
        (u32 const   )3368238802U,      (u32 const   )3200767801U,      (u32 const   )1076357238U,      (u32 const   )145366344U, 
        (u32 const   )1917938383U,      (u32 const   )2584485926U,      (u32 const   )819023531U,      (u32 const   )1413304770U, 
        (u32 const   )260453495U,      (u32 const   )2941684640U,      (u32 const   )3584949287U,      (u32 const   )4276109135U, 
        (u32 const   )337295796U,      (u32 const   )3850154636U,      (u32 const   )4089562922U,      (u32 const   )3374143707U, 
        (u32 const   )4017185750U,      (u32 const   )3604239932U,      (u32 const   )1168903515U,      (u32 const   )1217262910U, 
        (u32 const   )557847090U,      (u32 const   )2787307745U,      (u32 const   )2412314523U,      (u32 const   )2536364099U, 
        (u32 const   )2745767372U,      (u32 const   )1838703656U,      (u32 const   )4038618417U,      (u32 const   )2561403956U, 
        (u32 const   )674523507U,      (u32 const   )3708281199U,      (u32 const   )726516584U,      (u32 const   )3705243494U, 
        (u32 const   )1673541206U,      (u32 const   )4218149474U,      (u32 const   )2019343253U,      (u32 const   )533270247U, 
        (u32 const   )1737864562U,      (u32 const   )1440954315U,      (u32 const   )4232573789U,      (u32 const   )4190901872U, 
        (u32 const   )2319653558U,      (u32 const   )3272640897U,      (u32 const   )3459346916U,      (u32 const   )644627213U, 
        (u32 const   )3332074668U,      (u32 const   )1580236952U,      (u32 const   )2260501722U,      (u32 const   )1130250861U, 
        (u32 const   )1693196137U,      (u32 const   )3119250950U,      (u32 const   )2869102724U,      (u32 const   )3817799098U, 
        (u32 const   )3546264337U,      (u32 const   )0U,      (u32 const   )4153689102U,      (u32 const   )3942287099U, 
        (u32 const   )2888769979U,      (u32 const   )220330085U,      (u32 const   )1489162158U,      (u32 const   )895134598U, 
        (u32 const   )714319201U,      (u32 const   )1389305588U,      (u32 const   )1634204228U,      (u32 const   )2063300487U, 
        (u32 const   )2760195315U,      (u32 const   )1495050663U,      (u32 const   )3751816573U,      (u32 const   )2488562264U, 
        (u32 const   )2038619548U,      (u32 const   )417671128U,      (u32 const   )1860292147U,      (u32 const   )4132053511U, 
        (u32 const   )3343190693U,      (u32 const   )2360432000U,      (u32 const   )3319973559U,      (u32 const   )1370928367U, 
        (u32 const   )116543286U,      (u32 const   )3444104191U,      (u32 const   )2990033237U,      (u32 const   )4206214251U, 
        (u32 const   )2973885262U,      (u32 const   )2066026894U,      (u32 const   )3038011498U,      (u32 const   )1393654013U, 
        (u32 const   )3531724056U,      (u32 const   )2271404755U,      (u32 const   )3945062642U,      (u32 const   )440593354U, 
        (u32 const   )1062697692U,      (u32 const   )3268341640U,      (u32 const   )2866638477U,      (u32 const   )2656674562U, 
        (u32 const   )2636122393U,      (u32 const   )866706608U,      (u32 const   )31352329U,      (u32 const   )1775101708U, 
        (u32 const   )3090520079U,      (u32 const   )2201444855U,      (u32 const   )3432431094U,      (u32 const   )3082005624U, 
        (u32 const   )2447349621U,      (u32 const   )1191952713U,      (u32 const   )2173742565U,      (u32 const   )3859093655U, 
        (u32 const   )2698035159U,      (u32 const   )2532556362U,      (u32 const   )2826609311U,      (u32 const   )3898428137U, 
        (u32 const   )2676475147U,      (u32 const   )784737861U,      (u32 const   )1516569532U,      (u32 const   )1464138713U, 
        (u32 const   )294739097U,      (u32 const   )2846147734U,      (u32 const   )4282276166U,      (u32 const   )790118476U, 
        (u32 const   )939354004U,      (u32 const   )947606499U,      (u32 const   )2574617149U,      (u32 const   )1009701063U, 
        (u32 const   )1244281132U,      (u32 const   )1274306341U,      (u32 const   )4062159139U,      (u32 const   )1289254426U, 
        (u32 const   )1452973520U,      (u32 const   )2111266488U,      (u32 const   )3130151965U,      (u32 const   )4049996600U, 
        (u32 const   )823077026U,      (u32 const   )767528030U,      (u32 const   )2963244359U,      (u32 const   )3142332948U, 
        (u32 const   )2928209321U,      (u32 const   )3660302416U,      (u32 const   )72712996U,      (u32 const   )1980033515U, 
        (u32 const   )1539007925U,      (u32 const   )1802119966U,      (u32 const   )317257346U,      (u32 const   )987537393U, 
        (u32 const   )3395613376U,      (u32 const   )1316993544U,      (u32 const   )2125395107U,      (u32 const   )3607769141U, 
        (u32 const   )3488552941U,      (u32 const   )3917688032U,      (u32 const   )3206132016U,      (u32 const   )3889921694U, 
        (u32 const   )2818348776U,      (u32 const   )3250013587U,      (u32 const   )481338620U,      (u32 const   )2918270898U, 
        (u32 const   )2633920272U,      (u32 const   )2302324909U,      (u32 const   )392369071U,      (u32 const   )3564345902U, 
        (u32 const   )2460368238U,      (u32 const   )908263837U,      (u32 const   )990050808U,      (u32 const   )1938754758U, 
        (u32 const   )2244292289U,      (u32 const   )2216380616U,      (u32 const   )2474138471U,      (u32 const   )2138084010U, 
        (u32 const   )158628673U,      (u32 const   )463244739U,      (u32 const   )3060648561U,      (u32 const   )322343051U, 
        (u32 const   )423313873U,      (u32 const   )4254700884U,      (u32 const   )3990269892U,      (u32 const   )240669310U, 
        (u32 const   )547255355U,      (u32 const   )1553419402U,      (u32 const   )1971143664U,      (u32 const   )3690311257U, 
        (u32 const   )1039185614U,      (u32 const   )198424403U,      (u32 const   )3492157706U,      (u32 const   )574208041U};
#line 267 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te4___0[256]  = 
#line 267
  {      (u32 const   )404232216U,      (u32 const   )589505315U,      (u32 const   )3334915782U,      (u32 const   )3907578088U, 
        (u32 const   )2273806215U,      (u32 const   )3099113656U,      (u32 const   )16843009U,      (u32 const   )1330597711U, 
        (u32 const   )909522486U,      (u32 const   )2795939494U,      (u32 const   )3537031890U,      (u32 const   )4126537205U, 
        (u32 const   )2038004089U,      (u32 const   )1869573999U,      (u32 const   )2442236305U,      (u32 const   )1381126738U, 
        (u32 const   )1616928864U,      (u32 const   )3166485692U,      (u32 const   )2610666395U,      (u32 const   )2391707278U, 
        (u32 const   )2745410467U,      (u32 const   )202116108U,      (u32 const   )2071690107U,      (u32 const   )892679477U, 
        (u32 const   )488447261U,      (u32 const   )3772834016U,      (u32 const   )3621246935U,      (u32 const   )3267543746U, 
        (u32 const   )774778414U,      (u32 const   )1263225675U,      (u32 const   )4278124286U,      (u32 const   )1465341783U, 
        (u32 const   )353703189U,      (u32 const   )2004318071U,      (u32 const   )926365495U,      (u32 const   )3857049061U, 
        (u32 const   )2678038431U,      (u32 const   )4042322160U,      (u32 const   )1246382666U,      (u32 const   )3671775962U, 
        (u32 const   )1482184792U,      (u32 const   )3385444809U,      (u32 const   )690563369U,      (u32 const   )168430090U, 
        (u32 const   )2981212593U,      (u32 const   )2694881440U,      (u32 const   )1802201963U,      (u32 const   )2240120197U, 
        (u32 const   )3183328701U,      (u32 const   )1566399837U,      (u32 const   )269488144U,      (u32 const   )4109694196U, 
        (u32 const   )3419130827U,      (u32 const   )1044266558U,      (u32 const   )84215045U,      (u32 const   )1734829927U, 
        (u32 const   )3840206052U,      (u32 const   )656877351U,      (u32 const   )1094795585U,      (u32 const   )2341178251U, 
        (u32 const   )2812782503U,      (u32 const   )2105376125U,      (u32 const   )2509608341U,      (u32 const   )3638089944U, 
        (u32 const   )4227595259U,      (u32 const   )4008636142U,      (u32 const   )2088533116U,      (u32 const   )1717986918U, 
        (u32 const   )3722304989U,      (u32 const   )387389207U,      (u32 const   )1195853639U,      (u32 const   )2661195422U, 
        (u32 const   )3402287818U,      (u32 const   )757935405U,      (u32 const   )3217014719U,      (u32 const   )117901063U, 
        (u32 const   )2913840557U,      (u32 const   )1515870810U,      (u32 const   )2206434179U,      (u32 const   )858993459U, 
        (u32 const   )1667457891U,      (u32 const   )33686018U,      (u32 const   )2863311530U,      (u32 const   )1903260017U, 
        (u32 const   )3368601800U,      (u32 const   )421075225U,      (u32 const   )1229539657U,      (u32 const   )3654932953U, 
        (u32 const   )4076008178U,      (u32 const   )3823363043U,      (u32 const   )1532713819U,      (u32 const   )2290649224U, 
        (u32 const   )2593823386U,      (u32 const   )640034342U,      (u32 const   )842150450U,      (u32 const   )2964369584U, 
        (u32 const   )3924421097U,      (u32 const   )252645135U,      (u32 const   )3587560917U,      (u32 const   )2155905152U, 
        (u32 const   )3200171710U,      (u32 const   )3452816845U,      (u32 const   )875836468U,      (u32 const   )1212696648U, 
        (u32 const   )4294967295U,      (u32 const   )2054847098U,      (u32 const   )2425393296U,      (u32 const   )1600085855U, 
        (u32 const   )538976288U,      (u32 const   )1751672936U,      (u32 const   )437918234U,      (u32 const   )2930683566U, 
        (u32 const   )3031741620U,      (u32 const   )1414812756U,      (u32 const   )2475922323U,      (u32 const   )572662306U, 
        (u32 const   )1684300900U,      (u32 const   )4059165169U,      (u32 const   )1936946035U,      (u32 const   )303174162U, 
        (u32 const   )1077952576U,      (u32 const   )134744072U,      (u32 const   )3284386755U,      (u32 const   )3974950124U, 
        (u32 const   )3688618971U,      (u32 const   )2711724449U,      (u32 const   )2374864269U,      (u32 const   )1027423549U, 
        (u32 const   )2543294359U,      (u32 const   )0U,      (u32 const   )3486502863U,      (u32 const   )724249387U, 
        (u32 const   )1987475062U,      (u32 const   )2189591170U,      (u32 const   )3604403926U,      (u32 const   )454761243U, 
        (u32 const   )3048584629U,      (u32 const   )2947526575U,      (u32 const   )1785358954U,      (u32 const   )1347440720U, 
        (u32 const   )1162167621U,      (u32 const   )4092851187U,      (u32 const   )808464432U,      (u32 const   )4025479151U, 
        (u32 const   )1061109567U,      (u32 const   )1431655765U,      (u32 const   )2728567458U,      (u32 const   )3941264106U, 
        (u32 const   )1701143909U,      (u32 const   )3132799674U,      (u32 const   )791621423U,      (u32 const   )3233857728U, 
        (u32 const   )3739147998U,      (u32 const   )471604252U,      (u32 const   )4261281277U,      (u32 const   )1296911693U, 
        (u32 const   )2459079314U,      (u32 const   )1970632053U,      (u32 const   )101058054U,      (u32 const   )2324335242U, 
        (u32 const   )2998055602U,      (u32 const   )3873892070U,      (u32 const   )235802126U,      (u32 const   )522133279U, 
        (u32 const   )1650614882U,      (u32 const   )3570717908U,      (u32 const   )2829625512U,      (u32 const   )2526451350U, 
        (u32 const   )4193909241U,      (u32 const   )3318072773U,      (u32 const   )623191333U,      (u32 const   )1499027801U, 
        (u32 const   )2223277188U,      (u32 const   )1920103026U,      (u32 const   )960051513U,      (u32 const   )1280068684U, 
        (u32 const   )1583242846U,      (u32 const   )2021161080U,      (u32 const   )943208504U,      (u32 const   )2358021260U, 
        (u32 const   )3520188881U,      (u32 const   )2779096485U,      (u32 const   )3806520034U,      (u32 const   )1633771873U, 
        (u32 const   )3014898611U,      (u32 const   )555819297U,      (u32 const   )2627509404U,      (u32 const   )505290270U, 
        (u32 const   )1128481603U,      (u32 const   )3351758791U,      (u32 const   )4244438268U,      (u32 const   )67372036U, 
        (u32 const   )1364283729U,      (u32 const   )2576980377U,      (u32 const   )1835887981U,      (u32 const   )218959117U, 
        (u32 const   )4210752250U,      (u32 const   )3755991007U,      (u32 const   )2122219134U,      (u32 const   )606348324U, 
        (u32 const   )993737531U,      (u32 const   )2880154539U,      (u32 const   )3469659854U,      (u32 const   )286331153U, 
        (u32 const   )2408550287U,      (u32 const   )1313754702U,      (u32 const   )3082270647U,      (u32 const   )3958107115U, 
        (u32 const   )1010580540U,      (u32 const   )2172748161U,      (u32 const   )2492765332U,      (u32 const   )4160223223U, 
        (u32 const   )3115956665U,      (u32 const   )320017171U,      (u32 const   )741092396U,      (u32 const   )3553874899U, 
        (u32 const   )3890735079U,      (u32 const   )1852730990U,      (u32 const   )3301229764U,      (u32 const   )50529027U, 
        (u32 const   )1448498774U,      (u32 const   )1145324612U,      (u32 const   )2139062143U,      (u32 const   )2846468521U, 
        (u32 const   )707406378U,      (u32 const   )3149642683U,      (u32 const   )3250700737U,      (u32 const   )1397969747U, 
        (u32 const   )3705461980U,      (u32 const   )185273099U,      (u32 const   )2644352413U,      (u32 const   )1819044972U, 
        (u32 const   )825307441U,      (u32 const   )1953789044U,      (u32 const   )4143380214U,      (u32 const   )1179010630U, 
        (u32 const   )2896997548U,      (u32 const   )2307492233U,      (u32 const   )336860180U,      (u32 const   )3789677025U, 
        (u32 const   )370546198U,      (u32 const   )976894522U,      (u32 const   )1768515945U,      (u32 const   )151587081U, 
        (u32 const   )1886417008U,      (u32 const   )3065427638U,      (u32 const   )3503345872U,      (u32 const   )3991793133U, 
        (u32 const   )3435973836U,      (u32 const   )1111638594U,      (u32 const   )2560137368U,      (u32 const   )2762253476U, 
        (u32 const   )673720360U,      (u32 const   )1549556828U,      (u32 const   )4177066232U,      (u32 const   )2256963206U};
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
static u32 const   rcon___0[10]  = 
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
  {      (u32 const   )16777216,      (u32 const   )33554432,      (u32 const   )67108864,      (u32 const   )134217728, 
        (u32 const   )268435456,      (u32 const   )536870912,      (u32 const   )1073741824,      (u32 const   )2147483648U, 
        (u32 const   )452984832,      (u32 const   )905969664};
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___2  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___2  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___2  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___2  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___2  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___2  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___2  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___2  =    (js_file *)0;
#line 86 "/home/wheatley/newnew/temp/maradns-2.0.09/server/functions_server.h"
int change_rtype(js_string *js , int newtype ) ;
#line 138
int get_rtype(js_string *js ) ;
#line 251
int any_add_rr(mhash *hash , js_string *query , rr *data ) ;
#line 258
int any_zap_rr(mhash *hash , js_string *query , rr *data ) ;
#line 264
extern void harderror(char *why ) ;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraAnyChain.c"
int any_add_rr(mhash *hash , js_string *query , rr *data ) 
{ 
  int rrtype ;
  int a ;
  js_string *copy ;
  rr_list *point ;
  rr_list *new ;
  mhash_e get ;
  int tmp ;
  int tmp___0 ;
  void *tmp___1 ;

  {
  {
#line 43
  rrtype = get_rtype(query);
  }
#line 45
  if (rrtype == -1) {
#line 46
    return (-1);
  }
#line 48
  if (rrtype < 0) {
#line 49
    return (-1);
  } else
#line 48
  if (rrtype > 65535) {
#line 49
    return (-1);
  }
  {
#line 54
  copy = js_create(256U, 1U);
  }
#line 54
  if ((unsigned long )copy == (unsigned long )((js_string *)0)) {
#line 55
    return (-1);
  }
  {
#line 57
  tmp = js_copy(query, copy);
  }
#line 57
  if (tmp == -1) {
    {
#line 58
    js_destroy(copy);
    }
#line 59
    return (-1);
  }
  {
#line 61
  tmp___0 = change_rtype(copy, 255);
  }
#line 61
  if (tmp___0 == -1) {
    {
#line 62
    js_destroy(copy);
    }
#line 63
    return (-1);
  }
  {
#line 67
  tmp___1 = js_alloc(1, (int )sizeof(rr_list ));
#line 67
  new = (rr_list *)tmp___1;
  }
#line 68
  if ((unsigned long )new == (unsigned long )((rr_list *)0)) {
    {
#line 69
    js_destroy(copy);
    }
#line 70
    return (-1);
  }
  {
#line 73
  new->rr_type = (uint16_t )rrtype;
#line 74
  new->data = data;
#line 75
  new->next = (struct rr_list *)0;
#line 78
  get = mhash_get(hash, copy);
  }
#line 82
  if ((unsigned long )get.value == (unsigned long )((void *)0)) {
#line 82
    if (get.datatype == 0) {
      {
#line 83
      mhash_put(hash, copy, (void *)new, 6);
#line 84
      js_destroy(copy);
      }
#line 85
      return (1);
    }
  }
  {
#line 88
  js_destroy(copy);
  }
#line 92
  if (get.datatype != 6) {
    {
#line 93
    harderror((char *)"Data not MARA_DNS_LIST in ANY query in bighash");
    }
  }
#line 96
  point = (rr_list *)get.value;
#line 97
  if ((unsigned long )point == (unsigned long )((rr_list *)0)) {
#line 98
    return (-1);
  }
#line 102
  a = 0;
  {
#line 102
  while (1) {
    while_continue: /* CIL Label */ ;
#line 102
    if (! (a < 65000)) {
#line 102
      goto while_break;
    }
#line 104
    if ((unsigned long )point->next == (unsigned long )((struct rr_list *)0)) {
#line 105
      goto while_break;
    }
#line 107
    point = point->next;
#line 102
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 110
  if ((unsigned long )point->next != (unsigned long )((struct rr_list *)0)) {
#line 111
    return (-1);
  }
#line 115
  point->next = new;
#line 116
  new->next = (struct rr_list *)0;
#line 117
  new->data = data;
#line 118
  return (1);
}
}
#line 123 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraAnyChain.c"
int any_add_c_rr(mhash *hash , js_string *query , rr *data ) 
{ 
  int rrtype ;
  int tmp ;

  {
  {
#line 125
  rrtype = get_rtype(query);
  }
#line 126
  if (rrtype == 5) {
#line 127
    return (-1);
  }
  {
#line 129
  tmp = any_add_rr(hash, query, data);
  }
#line 129
  return (tmp);
}
}
#line 138 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraAnyChain.c"
int any_zap_rr(mhash *hash , js_string *query , rr *data ) 
{ 
  int a ;
  js_string *copy ;
  mhash_e get ;
  rr_list *point ;
  rr_list *last ;
  int tmp ;
  int tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
  {
#line 147
  copy = js_create(256U, 1U);
  }
#line 147
  if ((unsigned long )copy == (unsigned long )((js_string *)0)) {
#line 148
    return (-1);
  }
  {
#line 150
  tmp = js_copy(query, copy);
  }
#line 150
  if (tmp == -1) {
    {
#line 151
    js_destroy(copy);
    }
#line 152
    return (-1);
  }
  {
#line 154
  tmp___0 = change_rtype(copy, 255);
  }
#line 154
  if (tmp___0 == -1) {
    {
#line 155
    js_destroy(copy);
    }
#line 156
    return (-1);
  }
  {
#line 160
  get = mhash_get(hash, copy);
  }
#line 162
  if ((unsigned long )get.value == (unsigned long )((void *)0)) {
    {
#line 163
    js_destroy(copy);
    }
#line 164
    return (1);
  } else
#line 162
  if (get.datatype == 0) {
    {
#line 163
    js_destroy(copy);
    }
#line 164
    return (1);
  }
#line 167
  point = (rr_list *)get.value;
#line 168
  last = (rr_list *)0;
#line 171
  if ((unsigned long )point->data == (unsigned long )data) {
#line 171
    if ((unsigned long )point->next == (unsigned long )((struct rr_list *)0)) {
      {
#line 172
      tmp___1 = mhash_undef(hash, copy);
#line 172
      last = (rr_list *)tmp___1;
      }
#line 173
      if ((unsigned long )last != (unsigned long )point) {
        {
#line 174
        harderror((char *)"Line 166; mail the mailing list");
        }
      }
      {
#line 176
      js_dealloc((void *)last);
#line 177
      js_destroy(copy);
      }
#line 178
      return (1);
    }
  }
#line 182
  if ((unsigned long )point->data == (unsigned long )data) {
#line 182
    if ((unsigned long )point->next != (unsigned long )((struct rr_list *)0)) {
      {
#line 183
      tmp___2 = mhash_undef(hash, copy);
#line 183
      last = (rr_list *)tmp___2;
      }
#line 184
      if ((unsigned long )last != (unsigned long )point) {
        {
#line 185
        harderror((char *)"Line 177; mail the mailing list");
        }
      }
      {
#line 187
      point = point->next;
#line 188
      js_dealloc((void *)last);
#line 189
      mhash_put(hash, copy, (void *)point, 6);
#line 190
      js_destroy(copy);
      }
#line 191
      return (1);
    }
  }
  {
#line 194
  js_destroy(copy);
#line 197
  a = 0;
  }
  {
#line 197
  while (1) {
    while_continue: /* CIL Label */ ;
#line 197
    if (! (a < 65000)) {
#line 197
      goto while_break;
    }
#line 198
    if ((unsigned long )point->next == (unsigned long )((struct rr_list *)0)) {
#line 199
      return (-2);
    }
#line 201
    last = point;
#line 202
    point = point->next;
#line 204
    if ((unsigned long )point->data == (unsigned long )data) {
      {
#line 205
      last->next = point->next;
#line 206
      js_dealloc((void *)point);
      }
#line 207
      return (1);
    }
#line 197
    a ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 211
  return (-1);
}
}
#line 23 "/home/wheatley/newnew/temp/maradns-2.0.09/server/../parse/Csv2_functions.h"
int starrecord_to_meta(js_string *rr___0 , int recursive ) ;
#line 24
int add_rr_to_bighash(mhash *bighash , js_string *query , js_string *data , uint32_t ttl ,
                      js_string *zone , uint16_t perms ) ;
#line 202
int csv2_parse_main_bighash(mhash *main_table , int32_t starwhitis ) ;
#line 37 "/home/wheatley/newnew/temp/maradns-2.0.09/server/functions_server.h"
void init_rr(rr *data ) ;
#line 62
int populate_main(mhash *maintable , js_string *error , int recursive ) ;
#line 122
int add_an(mhash *bighash , js_string *error ) ;
#line 131
int answer_ip_query(int qtype , js_string *qu , js_string *ar ) ;
#line 224
int mhash_add_rr(mhash *hash , js_string *query , js_string *value___6 , uint32_t ttl ,
                 uint32_t authoritative , uint32_t expire , uint16_t perms ) ;
#line 235
int mhash_add_ptr(mhash *hash , js_string *query , js_string *value___6 ) ;
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int log_level ;
#line 50
extern int no_cname_warnings ;
#line 51
extern int dns_records_served ;
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int cname_warnings_shown  =    0;
#line 60 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int warning(js_string *msg , int line___6 ) 
{ 


  {
#line 61
  if (log_level == 0) {
#line 62
    return (1);
  }
  {
#line 63
  printf((char const   */* __restrict  */)"%s", "Warning: ");
#line 64
  js_show_stdout(msg);
  }
#line 65
  if (line___6 != -1) {
    {
#line 66
    printf((char const   */* __restrict  */)"%s%d", " on line ", line___6);
    }
  }
  {
#line 67
  printf((char const   */* __restrict  */)"%s", "\n");
  }
#line 68
  return (1);
}
}
#line 80 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int starrecord_to_meta(js_string *rr___0 , int recursive ) 
{ 
  int counter ;
  int tmp ;

  {
  {
#line 83
  tmp = js_has_sanity(rr___0);
  }
#line 83
  if (tmp == -1) {
#line 84
    return (-1);
  }
#line 85
  if (rr___0->unit_size != 1U) {
#line 86
    return (-1);
  }
#line 89
  if (rr___0->unit_count < 2U) {
#line 90
    return (1);
  }
#line 93
  if ((int )*(rr___0->string) == 1) {
#line 93
    if ((int )*(rr___0->string + 1) == 42) {
#line 94
      *(rr___0->string) = (unsigned char )'_';
#line 95
      if (rr___0->unit_count > rr___0->max_count) {
#line 96
        return (-1);
      }
#line 97
      counter = 1;
      {
#line 97
      while (1) {
        while_continue: /* CIL Label */ ;
#line 97
        if (! ((unsigned int )counter < rr___0->unit_count)) {
#line 97
          goto while_break;
        }
#line 98
        *(rr___0->string + counter) = *((rr___0->string + counter) + 1);
#line 97
        counter ++;
      }
      while_break: /* CIL Label */ ;
      }
#line 99
      (rr___0->unit_count) --;
    }
  }
  {
#line 105
  counter = dlabel_length(rr___0, 0U);
#line 106
  counter -= 3;
  }
#line 107
  if (counter < 0) {
#line 108
    return (1);
  }
#line 109
  if ((int )*(rr___0->string + counter) == 1) {
#line 109
    if ((int )*((rr___0->string + counter) + 1) == 42) {
#line 110
      *(rr___0->string + counter) = (unsigned char )'_';
#line 111
      counter ++;
      {
#line 112
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 112
        if (! ((unsigned int )counter < rr___0->unit_count)) {
#line 112
          goto while_break___0;
        }
#line 113
        *(rr___0->string + counter) = *((rr___0->string + counter) + 2);
#line 112
        counter ++;
      }
      while_break___0: /* CIL Label */ ;
      }
#line 114
      rr___0->unit_count -= 2U;
#line 115
      if (recursive == 1) {
        {
#line 116
        show_timestamp();
#line 117
        printf((char const   */* __restrict  */)"Warning: star labels at the end can not be used when recursion is enabled\n");
        }
      }
    }
  }
#line 122
  return (1);
}
}
#line 131 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int get_rtype(js_string *js ) 
{ 
  int rtype ;
  int tmp ;

  {
  {
#line 136
  tmp = js_has_sanity(js);
  }
#line 136
  if (tmp == -1) {
#line 137
    return (-1);
  }
#line 138
  if (js->unit_count < 3U) {
#line 139
    return (-1);
  }
#line 142
  rtype = ((int )*((js->string + js->unit_count) - 1) & 255) | (((int )*((js->string + js->unit_count) - 2) & 255) << 8);
#line 145
  return (rtype);
}
}
#line 154 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int change_rtype(js_string *js , int newtype ) 
{ 
  int tmp ;

  {
  {
#line 157
  tmp = js_has_sanity(js);
  }
#line 157
  if (tmp == -1) {
#line 158
    return (-1);
  }
#line 159
  if (js->unit_count < 3U) {
#line 160
    return (-1);
  }
#line 161
  if (newtype < 0) {
#line 162
    return (-1);
  } else
#line 161
  if (newtype > 65535) {
#line 162
    return (-1);
  }
#line 165
  *((js->string + js->unit_count) - 1) = (unsigned char )(newtype & 255);
#line 166
  *((js->string + js->unit_count) - 2) = (unsigned char )((newtype & 65280) >> 8);
#line 168
  return (1);
}
}
#line 176 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
void init_rr(rr *data ) 
{ 
  uint32_t tmp ;
  uint32_t tmp___0 ;
  uint16_t tmp___1 ;
  struct rr *tmp___2 ;
  js_string *tmp___3 ;
  uint32_t tmp___4 ;
  uint32_t tmp___5 ;

  {
#line 177
  tmp___1 = (uint16_t )0;
#line 177
  data->rr_type = tmp___1;
#line 177
  tmp___0 = (uint32_t )tmp___1;
#line 177
  data->authoritative = tmp___0;
#line 177
  tmp = tmp___0;
#line 177
  data->ttl = tmp;
#line 177
  data->expire = (int64_t )tmp;
#line 178
  tmp___2 = (struct rr *)0;
#line 178
  data->ip = tmp___2;
#line 178
  data->next = tmp___2;
#line 180
  data->ip6 = (struct rr *)0;
#line 182
  tmp___3 = (js_string *)0;
#line 182
  data->data = tmp___3;
#line 182
  data->query = tmp___3;
#line 183
  data->ptr = (js_string *)0;
#line 184
  data->seen = (char)0;
#line 185
  data->zap = (fila *)0;
#line 186
  tmp___5 = (uint32_t )0;
#line 186
  data->authoritative = tmp___5;
#line 186
  tmp___4 = tmp___5;
#line 186
  data->ttl = tmp___4;
#line 186
  data->expire = (int64_t )tmp___4;
#line 187
  data->perms = (uint16_t )0;
#line 188
  data->list = (struct rr_list *)0;
#line 189
  data->rcode = (char)0;
#line 190
  return;
}
}
#line 199 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int mhash_put_rr(mhash *hash , js_string *query , js_string *value___6 , uint32_t ttl ,
                 uint32_t authoritative , uint32_t expire , uint16_t perms ) 
{ 
  rr *data ;
  js_string *new ;
  int ret ;
  int rrtype ;
  void *tmp ;
  int tmp___0 ;
  struct rr *tmp___1 ;
  int tmp___2 ;

  {
  {
#line 202
  data = (rr *)0;
#line 203
  new = (js_string *)0;
#line 206
  tmp = js_alloc(1, (int )sizeof(rr ));
#line 206
  data = (rr *)tmp;
  }
#line 206
  if ((unsigned long )data == (unsigned long )((rr *)0)) {
#line 207
    return (-1);
  }
  {
#line 210
  init_rr(data);
#line 213
  data->expire = (int64_t )0;
#line 214
  data->ttl = ttl;
#line 215
  data->authoritative = authoritative;
#line 216
  data->perms = perms;
#line 218
  rrtype = get_rtype(query);
  }
#line 219
  if (rrtype == -1) {
    {
#line 220
    js_dealloc((void *)data);
    }
#line 221
    return (-1);
  }
#line 223
  if (rrtype < 0) {
    {
#line 224
    js_dealloc((void *)data);
    }
#line 225
    return (-1);
  } else
#line 223
  if (rrtype > 65535) {
    {
#line 224
    js_dealloc((void *)data);
    }
#line 225
    return (-1);
  }
  {
#line 227
  data->rr_type = (uint16_t )rrtype;
#line 230
  new = js_create(value___6->unit_count + 1U, value___6->unit_size);
  }
#line 230
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
    {
#line 231
    js_dealloc((void *)data);
    }
#line 232
    return (-1);
  }
  {
#line 234
  tmp___0 = js_copy(value___6, new);
  }
#line 234
  if (tmp___0 == -1) {
    {
#line 235
    js_dealloc((void *)data);
#line 236
    js_destroy(new);
    }
#line 237
    return (-1);
  }
  {
#line 240
  data->data = new;
#line 243
  tmp___1 = (struct rr *)0;
#line 243
  data->next = tmp___1;
#line 243
  data->ip = tmp___1;
#line 246
  ret = mhash_put(hash, query, (void *)data, 3);
#line 249
  tmp___2 = any_add_rr(hash, query, data);
  }
#line 249
  if (tmp___2 == -1) {
#line 250
    return (-1);
  }
  {
#line 254
  mhash_autogrow(hash);
#line 262
  data->query = mhash_get_immutable_key(hash, query);
  }
#line 264
  if (ret == -1) {
    {
#line 265
    js_dealloc((void *)data);
#line 266
    js_destroy(new);
    }
#line 267
    return (-1);
  }
#line 270
  return (1);
}
}
#line 279 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int mhash_add_rr(mhash *hash , js_string *query , js_string *value___6 , uint32_t ttl ,
                 uint32_t authoritative , uint32_t expire , uint16_t perms ) 
{ 
  rr *data ;
  rr *point ;
  js_string *new ;
  mhash_e spot_data ;
  int rrtype ;
  void *tmp ;
  int tmp___0 ;

  {
  {
#line 288
  tmp = js_alloc(1, (int )sizeof(rr ));
#line 288
  data = (rr *)tmp;
  }
#line 288
  if ((unsigned long )data == (unsigned long )((rr *)0)) {
#line 289
    return (-1);
  }
  {
#line 292
  init_rr(data);
#line 295
  data->expire = (int64_t )0;
#line 296
  data->ttl = ttl;
#line 297
  data->authoritative = authoritative;
#line 298
  data->perms = perms;
#line 301
  rrtype = get_rtype(query);
  }
#line 302
  if (rrtype == -1) {
    {
#line 303
    js_dealloc((void *)data);
    }
#line 304
    return (-1);
  }
#line 306
  if (rrtype < 0) {
    {
#line 307
    js_dealloc((void *)data);
    }
#line 308
    return (-1);
  } else
#line 306
  if (rrtype > 65535) {
    {
#line 307
    js_dealloc((void *)data);
    }
#line 308
    return (-1);
  }
  {
#line 310
  data->rr_type = (uint16_t )rrtype;
#line 313
  new = js_create(value___6->unit_count + 1U, value___6->unit_size);
  }
#line 313
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
    {
#line 314
    js_dealloc((void *)data);
    }
#line 315
    return (-1);
  }
  {
#line 317
  tmp___0 = js_copy(value___6, new);
  }
#line 317
  if (tmp___0 == -1) {
    {
#line 318
    js_dealloc((void *)data);
#line 319
    js_destroy(new);
    }
#line 320
    return (-1);
  }
  {
#line 323
  data->data = new;
#line 326
  spot_data = mhash_get(hash, query);
  }
#line 327
  if ((unsigned long )spot_data.value == (unsigned long )((void *)0)) {
    {
#line 328
    js_dealloc((void *)data);
#line 329
    js_destroy(new);
    }
#line 330
    return (-1);
  }
#line 334
  if (spot_data.datatype != 3) {
    {
#line 335
    js_dealloc((void *)data);
#line 336
    js_destroy(new);
    }
#line 337
    return (-1);
  }
#line 344
  point = (rr *)spot_data.value;
#line 349
  data->query = point->query;
  {
#line 352
  while (1) {
    while_continue: /* CIL Label */ ;
#line 352
    if ((unsigned long )point->next != (unsigned long )((struct rr *)0)) {
#line 352
      if (! ((int )(point->next)->rr_type != 2)) {
#line 352
        goto while_break;
      }
    } else {
#line 352
      goto while_break;
    }
#line 353
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 355
  data->next = point->next;
#line 356
  point->next = data;
#line 358
  return (1);
}
}
#line 371 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int mhash_add_ptr(mhash *hash , js_string *query , js_string *value___6 ) 
{ 
  rr *point ;
  js_string *new ;
  mhash_e spot_data ;
  int tmp ;

  {
  {
#line 378
  new = js_create(value___6->unit_count + 1U, value___6->unit_size);
  }
#line 378
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
#line 382
    return (-1);
  }
  {
#line 384
  tmp = js_copy(value___6, new);
  }
#line 384
  if (tmp == -1) {
    {
#line 385
    js_destroy(new);
    }
#line 386
    return (-1);
  }
  {
#line 391
  spot_data = mhash_get(hash, query);
  }
#line 392
  if ((unsigned long )spot_data.value == (unsigned long )((void *)0)) {
    {
#line 393
    js_destroy(new);
    }
#line 394
    return (-1);
  }
#line 398
  if (spot_data.datatype != 3) {
    {
#line 399
    js_destroy(new);
    }
#line 400
    return (-1);
  }
#line 406
  point = (rr *)spot_data.value;
#line 409
  if ((unsigned long )point->ptr != (unsigned long )((js_string *)0)) {
    {
#line 410
    js_destroy(new);
    }
#line 411
    return (1);
  }
#line 414
  point->ptr = new;
#line 415
  return (1);
}
}
#line 429 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int mhash_add_ip(mhash *hash , js_string *query , js_string *value___6 ) 
{ 
  rr *data ;
  rr *point ;
  js_string *new ;
  js_string *new_query ;
  mhash_e spot_data ;
  int rrtype ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 431
  data = (rr *)0;
#line 431
  point = (rr *)0;
#line 432
  new = (js_string *)0;
#line 432
  new_query = (js_string *)0;
#line 437
  tmp = js_alloc(1, (int )sizeof(rr ));
#line 437
  data = (rr *)tmp;
  }
#line 437
  if ((unsigned long )data == (unsigned long )((rr *)0)) {
#line 438
    return (-1);
  }
  {
#line 441
  init_rr(data);
#line 444
  rrtype = 1;
#line 445
  data->rr_type = (uint16_t )rrtype;
#line 448
  new = js_create(value___6->unit_count + 1U, value___6->unit_size);
  }
#line 448
  if ((unsigned long )new == (unsigned long )((js_string *)0)) {
    {
#line 449
    js_dealloc((void *)data);
    }
#line 453
    return (-1);
  }
  {
#line 455
  tmp___0 = js_copy(value___6, new);
  }
#line 455
  if (tmp___0 == -1) {
    {
#line 456
    js_dealloc((void *)data);
#line 457
    js_destroy(new);
    }
#line 458
    return (-1);
  }
  {
#line 461
  data->data = new;
#line 464
  spot_data = mhash_get(hash, query);
  }
#line 465
  if ((unsigned long )spot_data.value == (unsigned long )((void *)0)) {
    {
#line 466
    js_dealloc((void *)data);
#line 467
    js_destroy(new);
    }
#line 468
    return (-1);
  }
#line 472
  if (spot_data.datatype != 3) {
    {
#line 473
    js_dealloc((void *)data);
#line 474
    js_destroy(new);
    }
#line 475
    return (-1);
  }
#line 482
  point = (rr *)spot_data.value;
#line 486
  if ((unsigned long )point->ip != (unsigned long )((struct rr *)0)) {
    {
#line 487
    js_dealloc((void *)data);
#line 488
    js_destroy(new);
    }
#line 489
    return (-1);
  }
  {
#line 494
  new_query = js_create((point->data)->unit_count + 3U, 1U);
  }
#line 494
  if ((unsigned long )new_query == (unsigned long )((js_string *)0)) {
    {
#line 495
    js_dealloc((void *)data);
#line 496
    js_destroy(new);
    }
#line 501
    return (-1);
  }
  {
#line 503
  tmp___1 = js_copy(point->data, new_query);
  }
#line 503
  if (tmp___1 == -1) {
    {
#line 504
    js_dealloc((void *)data);
#line 505
    js_destroy(new);
#line 506
    js_destroy(new_query);
    }
#line 507
    return (-1);
  }
  {
#line 509
  tmp___2 = js_adduint16(new_query, 1);
  }
#line 509
  if (tmp___2 == -1) {
    {
#line 510
    js_dealloc((void *)data);
#line 511
    js_destroy(new);
#line 512
    js_destroy(new_query);
    }
#line 513
    return (-1);
  }
#line 518
  data->query = new_query;
#line 521
  data->next = (struct rr *)0;
#line 522
  point->ip = data;
#line 524
  data->expire = point->expire;
#line 525
  data->ttl = point->ttl;
#line 526
  data->authoritative = point->authoritative;
#line 528
  return (1);
}
}
#line 537 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int mhash_add_ns(mhash *hash , js_string *query , js_string *ns ) 
{ 
  rr *point ;
  rr *ns_rr ;
  mhash_e spot_data ;
  int rrtype ;

  {
  {
#line 544
  rrtype = get_rtype(query);
  }
#line 545
  if (rrtype == -1) {
#line 546
    return (-1);
  }
#line 548
  if (rrtype < 0) {
#line 549
    return (-1);
  } else
#line 548
  if (rrtype > 65535) {
#line 549
    return (-1);
  }
#line 553
  if (rrtype == 2) {
#line 554
    return (1);
  }
  {
#line 557
  rrtype = get_rtype(ns);
  }
#line 558
  if (rrtype == -1) {
#line 559
    return (-1);
  }
#line 561
  if (rrtype < 0) {
#line 562
    return (-1);
  } else
#line 561
  if (rrtype > 65535) {
#line 562
    return (-1);
  }
#line 566
  if (rrtype != 2) {
#line 567
    return (1);
  }
  {
#line 570
  spot_data = mhash_get(hash, query);
  }
#line 571
  if ((unsigned long )spot_data.value == (unsigned long )((void *)0)) {
#line 572
    return (-1);
  }
#line 575
  if (spot_data.datatype != 3) {
#line 576
    return (-1);
  }
  {
#line 579
  point = (rr *)spot_data.value;
#line 582
  spot_data = mhash_get(hash, ns);
  }
#line 583
  if ((unsigned long )spot_data.value == (unsigned long )((void *)0)) {
#line 584
    return (1);
  }
#line 588
  if (spot_data.datatype != 3) {
#line 589
    return (-1);
  }
#line 592
  ns_rr = (rr *)spot_data.value;
  {
#line 597
  while (1) {
    while_continue: /* CIL Label */ ;
#line 597
    if (! ((unsigned long )point->next != (unsigned long )((struct rr *)0))) {
#line 597
      goto while_break;
    }
#line 598
    point = point->next;
  }
  while_break: /* CIL Label */ ;
  }
#line 600
  point->next = ns_rr;
#line 602
  return (1);
}
}
#line 616 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int parse_csv1s(mhash *maintable , js_string *error , int recursive ) 
{ 
  mhash *csvs ;
  js_string *zone ;
  js_string *udpzone ;
  js_string *filename ;
  js_string *line___6 ;
  js_string *soaline ;
  js_string *pline ;
  js_string *query ;
  js_string *data ;
  js_file *desc ;
  uint32_t ttl ;
  int rr_type ;
  int linenum ;
  int rrnum ;
  int in_ns ;
  int result ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  void *tmp___3 ;
  int tmp___4 ;
  mhash *tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  js_string *tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;

  {
  {
#line 623
  linenum = 0;
#line 623
  rrnum = 0;
#line 623
  in_ns = 1;
#line 627
  tmp = js_has_sanity(error);
  }
#line 627
  if (tmp == -1) {
#line 628
    return (-1);
  }
  {
#line 631
  js_qstr2js(error, (char *)"");
#line 635
  udpzone = js_create(128U, 1U);
  }
#line 635
  if ((unsigned long )udpzone == (unsigned long )((js_string *)0)) {
#line 636
    return (-1);
  }
  {
#line 638
  filename = js_create(256U, 1U);
  }
#line 638
  if ((unsigned long )filename == (unsigned long )((js_string *)0)) {
    {
#line 639
    js_destroy(udpzone);
    }
#line 640
    return (-1);
  }
  {
#line 642
  line___6 = js_create(428U, 1U);
  }
#line 642
  if ((unsigned long )line___6 == (unsigned long )((js_string *)0)) {
    {
#line 643
    js_destroy(filename);
#line 644
    js_destroy(udpzone);
    }
#line 645
    return (-1);
  }
  {
#line 647
  tmp___0 = js_set_encode(line___6, 3);
  }
#line 647
  if (tmp___0 == -1) {
    {
#line 648
    js_destroy(line___6);
#line 649
    js_destroy(filename);
#line 650
    js_destroy(udpzone);
    }
#line 651
    return (-1);
  }
  {
#line 653
  pline = js_create(428U, 1U);
  }
#line 653
  if ((unsigned long )pline == (unsigned long )((js_string *)0)) {
    {
#line 654
    js_destroy(line___6);
#line 655
    js_destroy(filename);
#line 656
    js_destroy(udpzone);
    }
#line 657
    return (-1);
  }
  {
#line 659
  tmp___1 = js_set_encode(pline, 3);
  }
#line 659
  if (tmp___1 == -1) {
    {
#line 660
    js_destroy(pline);
#line 661
    js_destroy(line___6);
#line 662
    js_destroy(filename);
#line 663
    js_destroy(udpzone);
    }
#line 664
    return (-1);
  }
  {
#line 666
  soaline = js_create(256U, 1U);
  }
#line 666
  if ((unsigned long )soaline == (unsigned long )((js_string *)0)) {
    {
#line 667
    js_destroy(pline);
#line 668
    js_destroy(line___6);
#line 669
    js_destroy(filename);
#line 670
    js_destroy(udpzone);
    }
#line 671
    return (-1);
  }
  {
#line 673
  tmp___2 = js_set_encode(soaline, 3);
  }
#line 673
  if (tmp___2 == -1) {
    {
#line 674
    js_destroy(soaline);
#line 675
    js_destroy(pline);
#line 676
    js_destroy(line___6);
#line 677
    js_destroy(filename);
#line 678
    js_destroy(udpzone);
    }
#line 679
    return (-1);
  }
  {
#line 681
  query = js_create(256U, 1U);
  }
#line 681
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
    {
#line 682
    js_destroy(soaline);
#line 683
    js_destroy(pline);
#line 684
    js_destroy(line___6);
#line 685
    js_destroy(filename);
#line 686
    js_destroy(udpzone);
    }
#line 687
    return (-1);
  }
  {
#line 689
  data = js_create(428U, 1U);
  }
#line 689
  if ((unsigned long )data == (unsigned long )((js_string *)0)) {
    {
#line 690
    js_destroy(query);
#line 691
    js_destroy(soaline);
#line 692
    js_destroy(pline);
#line 693
    js_destroy(line___6);
#line 694
    js_destroy(filename);
#line 695
    js_destroy(udpzone);
    }
#line 696
    return (-1);
  }
  {
#line 698
  zone = js_create(256U, 1U);
  }
#line 698
  if ((unsigned long )zone == (unsigned long )((js_string *)0)) {
    {
#line 699
    js_destroy(data);
#line 700
    js_destroy(query);
#line 701
    js_destroy(soaline);
#line 702
    js_destroy(pline);
#line 703
    js_destroy(line___6);
#line 704
    js_destroy(filename);
#line 705
    js_destroy(udpzone);
    }
#line 706
    return (-1);
  }
  {
#line 708
  tmp___3 = js_alloc(1, (int )sizeof(js_file ));
#line 708
  desc = (js_file *)tmp___3;
  }
#line 708
  if ((unsigned long )desc == (unsigned long )((js_file *)0)) {
    {
#line 709
    js_destroy(zone);
#line 710
    js_destroy(data);
#line 711
    js_destroy(query);
#line 712
    js_destroy(soaline);
#line 713
    js_destroy(pline);
#line 714
    js_destroy(line___6);
#line 715
    js_destroy(filename);
#line 716
    js_destroy(udpzone);
    }
#line 717
    return (-1);
  }
  {
#line 723
  tmp___4 = dq_keyword2n((char *)"csv1");
#line 723
  tmp___5 = dvar_raw(tmp___4);
#line 723
  csvs = tmp___5;
  }
#line 725
  if ((unsigned long )csvs == (unsigned long )((mhash *)0)) {
    {
#line 728
    js_destroy(udpzone);
#line 728
    js_destroy(filename);
#line 728
    js_destroy(line___6);
#line 729
    js_destroy(pline);
#line 729
    js_destroy(soaline);
#line 729
    js_destroy(query);
#line 730
    js_destroy(data);
#line 730
    js_destroy(zone);
#line 730
    js_dealloc((void *)desc);
    }
#line 731
    return (0);
  }
  {
#line 737
  tmp___6 = mhash_firstkey(csvs, zone);
  }
#line 737
  if (tmp___6 == 0) {
    {
#line 740
    js_destroy(udpzone);
#line 740
    js_destroy(filename);
#line 740
    js_destroy(line___6);
#line 741
    js_destroy(pline);
#line 741
    js_destroy(soaline);
#line 741
    js_destroy(query);
#line 742
    js_destroy(data);
#line 742
    js_destroy(zone);
#line 742
    js_dealloc((void *)desc);
    }
#line 743
    return (0);
  }
  {
#line 745
  while (1) {
    while_continue: /* CIL Label */ ;
#line 748
    if ((unsigned long )zone != (unsigned long )((js_string *)0)) {
      {
#line 751
      tmp___7 = js_qstr2js(udpzone, (char *)"A");
      }
#line 751
      if (tmp___7 == -1) {
        {
#line 752
        js_destroy(udpzone);
#line 752
        js_destroy(filename);
#line 752
        js_destroy(line___6);
#line 753
        js_destroy(pline);
#line 753
        js_destroy(soaline);
#line 753
        js_destroy(query);
#line 754
        js_destroy(data);
#line 754
        js_destroy(zone);
#line 754
        js_dealloc((void *)desc);
        }
#line 755
        return (-1);
      }
      {
#line 757
      tmp___8 = js_append(zone, udpzone);
      }
#line 757
      if (tmp___8 == -1) {
        {
#line 758
        js_destroy(udpzone);
#line 758
        js_destroy(filename);
#line 758
        js_destroy(line___6);
#line 759
        js_destroy(pline);
#line 759
        js_destroy(soaline);
#line 759
        js_destroy(query);
#line 760
        js_destroy(data);
#line 760
        js_destroy(zone);
#line 760
        js_dealloc((void *)desc);
        }
#line 761
        return (-1);
      }
      {
#line 763
      tmp___10 = hname_2rfc1035(udpzone);
      }
#line 763
      if (tmp___10 == -1) {
        {
#line 764
        js_qstr2js(error, (char *)"A zone file is incorrectly named.  All zone files must end with a dot, e.g.\ncsv1[\"example.com.\"] = \"filename\".\nHere is the line in the mararc with the problem: ");
#line 765
        js_qappend((char *)"\ncsv1[\"", error);
#line 766
        js_append(zone, error);
#line 767
        js_qappend((char *)"\"] = \"", error);
#line 768
        tmp___9 = mhash_get_js(csvs, zone);
#line 768
        js_append(tmp___9, error);
#line 769
        js_qappend((char *)"\"\n", error);
#line 770
        js_destroy(udpzone);
#line 770
        js_destroy(filename);
#line 770
        js_destroy(line___6);
#line 771
        js_destroy(pline);
#line 771
        js_destroy(soaline);
#line 771
        js_destroy(query);
#line 772
        js_destroy(data);
#line 772
        js_destroy(zone);
#line 772
        js_dealloc((void *)desc);
        }
#line 773
        return (-2);
      }
      {
#line 777
      tmp___11 = js_addbyte(udpzone, (unsigned char)0);
      }
#line 777
      if (tmp___11 == -1) {
        {
#line 778
        js_destroy(udpzone);
#line 778
        js_destroy(filename);
#line 778
        js_destroy(line___6);
#line 779
        js_destroy(pline);
#line 779
        js_destroy(soaline);
#line 779
        js_destroy(query);
#line 780
        js_destroy(data);
#line 780
        js_destroy(zone);
#line 780
        js_dealloc((void *)desc);
        }
#line 781
        return (-1);
      }
      {
#line 783
      tmp___12 = js_addbyte(udpzone, (unsigned char)2);
      }
#line 783
      if (tmp___12 == -1) {
        {
#line 784
        js_destroy(udpzone);
#line 784
        js_destroy(filename);
#line 784
        js_destroy(line___6);
#line 785
        js_destroy(pline);
#line 785
        js_destroy(soaline);
#line 785
        js_destroy(query);
#line 786
        js_destroy(data);
#line 786
        js_destroy(zone);
#line 786
        js_dealloc((void *)desc);
        }
#line 787
        return (-1);
      }
      {
#line 791
      js_destroy(filename);
#line 792
      filename = mhash_get_js(csvs, zone);
#line 794
      tmp___13 = js_open_read(filename, desc);
      }
#line 794
      if (tmp___13 == -1) {
        {
#line 795
        js_qstr2js(error, (char *)"Can not open zone file for zone ");
#line 796
        js_append(zone, error);
#line 797
        warning(error, -1);
        }
#line 798
        goto __Cont;
      }
#line 802
      rrnum = 0;
#line 802
      linenum = rrnum;
#line 803
      in_ns = 1;
      {
#line 806
      while (1) {
        while_continue___0: /* CIL Label */ ;
        {
#line 806
        tmp___22 = js_buf_eof(desc);
        }
#line 806
        if (tmp___22) {
#line 806
          goto while_break___0;
        }
        {
#line 809
        result = js_buf_getline(desc, line___6);
        }
#line 810
        if (result == -1) {
          {
#line 811
          js_destroy(udpzone);
#line 811
          js_destroy(filename);
#line 812
          js_destroy(line___6);
#line 813
          js_destroy(pline);
#line 813
          js_destroy(soaline);
#line 813
          js_destroy(query);
#line 814
          js_destroy(data);
#line 814
          js_destroy(zone);
#line 814
          js_dealloc((void *)desc);
          }
#line 815
          return (-1);
        } else
#line 817
        if (result == -2) {
          {
#line 818
          printf((char const   */* __restrict  */)"%s%d%s", "Line number ", linenum + 1,
                 " is too long in file ");
#line 819
          show_esc_stdout(filename);
#line 820
          printf((char const   */* __restrict  */)"\n");
#line 822
          js_destroy(udpzone);
#line 822
          js_destroy(filename);
#line 823
          js_destroy(line___6);
#line 824
          js_destroy(pline);
#line 824
          js_destroy(soaline);
#line 824
          js_destroy(query);
#line 825
          js_destroy(data);
#line 825
          js_destroy(zone);
#line 825
          js_dealloc((void *)desc);
          }
#line 826
          return (-1);
        }
        {
#line 830
        linenum ++;
#line 834
        tmp___16 = js_buf_eof(desc);
        }
#line 834
        if (tmp___16) {
#line 834
          if (in_ns) {
#line 834
            if (line___6->unit_count == 0U) {
              {
#line 837
              tmp___14 = js_length(soaline);
              }
#line 837
              if (tmp___14 == 0) {
#line 838
                goto while_continue___0;
              }
              {
#line 841
              tmp___15 = parse_csv1_line(soaline, query, data, & ttl);
              }
#line 841
              if (tmp___15 != 6) {
                {
#line 843
                js_destroy(udpzone);
#line 843
                js_destroy(filename);
#line 844
                js_destroy(line___6);
#line 845
                js_destroy(pline);
#line 845
                js_destroy(soaline);
#line 846
                js_destroy(query);
#line 847
                js_destroy(data);
#line 847
                js_destroy(zone);
#line 847
                js_dealloc((void *)desc);
                }
#line 848
                return (-1);
              }
              {
#line 850
              add_rr_to_bighash(maintable, query, data, ttl, udpzone, (uint16_t )0);
              }
#line 851
              goto while_break___0;
            }
          }
        }
        {
#line 855
        tmp___17 = js_buf_eof(desc);
        }
#line 855
        if (tmp___17) {
#line 855
          if (line___6->unit_count == 0U) {
#line 856
            goto while_break___0;
          }
        }
        {
#line 859
        tmp___18 = bs_process(line___6, pline, zone);
        }
#line 859
        if (tmp___18 == -1) {
          {
#line 860
          js_destroy(udpzone);
#line 860
          js_destroy(filename);
#line 861
          js_destroy(line___6);
#line 862
          js_destroy(pline);
#line 862
          js_destroy(soaline);
#line 862
          js_destroy(query);
#line 863
          js_destroy(data);
#line 863
          js_destroy(zone);
#line 863
          js_dealloc((void *)desc);
          }
#line 864
          return (-1);
        }
        {
#line 868
        rr_type = parse_csv1_line(pline, query, data, & ttl);
#line 872
        starrecord_to_meta(query, recursive);
        }
#line 875
        if (rr_type == -1) {
          {
#line 876
          js_qstr2js(error, (char *)"Fatal error in zone file ");
#line 877
          js_append(zone, error);
#line 878
          js_qappend((char *)" (aborting this zone file)", error);
#line 879
          warning(error, linenum);
          }
#line 881
          goto while_break___0;
        }
#line 883
        if (rr_type == -2) {
          {
#line 884
          js_qstr2js(error, (char *)"Syntax error in zone file ");
#line 885
          js_append(zone, error);
#line 886
          js_qappend((char *)" (", error);
#line 887
          js_append(data, error);
#line 888
          js_qappend((char *)")", error);
#line 889
          warning(error, linenum);
          }
#line 890
          goto while_continue___0;
        }
#line 893
        if (rr_type > 0) {
#line 894
          rrnum ++;
#line 896
          if (rrnum == 1) {
#line 896
            if (rr_type != 6) {
              {
#line 897
              js_qstr2js(error, (char *)"First record in csv1 zone file must be SOA record.");
#line 899
              js_qappend((char *)"Zone: ", error);
#line 900
              js_append(zone, error);
#line 901
              warning(error, 1);
              }
#line 902
              goto while_break___0;
            } else {
#line 896
              goto _L___1;
            }
          } else
          _L___1: /* CIL Label */ 
#line 908
          if (rrnum == 1) {
            {
#line 909
            tmp___19 = js_copy(pline, soaline);
            }
#line 909
            if (tmp___19 == -1) {
              {
#line 910
              js_destroy(udpzone);
#line 910
              js_destroy(filename);
#line 911
              js_destroy(line___6);
#line 912
              js_destroy(pline);
#line 912
              js_destroy(soaline);
#line 913
              js_destroy(query);
#line 914
              js_destroy(data);
#line 914
              js_destroy(zone);
#line 915
              js_dealloc((void *)desc);
              }
#line 916
              return (-1);
            }
          } else
#line 920
          if (rrnum != 1) {
#line 920
            if (rr_type == 6) {
              {
#line 921
              js_qstr2js(error, (char *)"Second SOA in zone file ");
#line 922
              js_append(zone, error);
#line 923
              warning(error, linenum);
              }
#line 924
              goto while_continue___0;
            } else {
#line 920
              goto _L___0;
            }
          } else
          _L___0: /* CIL Label */ 
#line 931
          if (rr_type != 2) {
#line 931
            goto _L;
          } else {
            {
#line 931
            tmp___21 = js_issame(query, udpzone);
            }
#line 931
            if (tmp___21) {
              {
#line 969
              add_rr_to_bighash(maintable, query, data, ttl, udpzone, (uint16_t )0);
              }
            } else
            _L: /* CIL Label */ 
#line 931
            if (in_ns) {
              {
#line 934
              tmp___20 = parse_csv1_line(soaline, query, data, & ttl);
              }
#line 934
              if (tmp___20 != 6) {
                {
#line 936
                js_destroy(udpzone);
#line 936
                js_destroy(filename);
#line 937
                js_destroy(line___6);
#line 938
                js_destroy(pline);
#line 938
                js_destroy(soaline);
#line 939
                js_destroy(query);
#line 940
                js_destroy(data);
#line 940
                js_destroy(zone);
#line 941
                js_dealloc((void *)desc);
                }
#line 942
                return (-1);
              }
              {
#line 944
              add_rr_to_bighash(maintable, query, data, ttl, udpzone, (uint16_t )0);
#line 947
              rr_type = parse_csv1_line(pline, query, data, & ttl);
              }
#line 948
              if (rr_type == -1) {
                {
#line 949
                js_qstr2js(error, (char *)"Fatal error in zone file ");
#line 950
                js_append(zone, error);
#line 951
                js_qappend((char *)" (aborting zone file)", error);
#line 952
                warning(error, linenum);
                }
#line 954
                goto while_break___0;
              } else
#line 956
              if (rr_type == -2) {
                {
#line 957
                js_qstr2js(error, (char *)"Syntax error in zone file ");
#line 958
                js_append(zone, error);
#line 959
                js_qappend((char *)" (", error);
#line 960
                js_append(data, error);
#line 961
                js_qappend((char *)")", error);
#line 962
                warning(error, linenum);
                }
#line 963
                goto while_continue___0;
              }
              {
#line 965
              add_rr_to_bighash(maintable, query, data, ttl, udpzone, (uint16_t )0);
#line 966
              in_ns = 0;
              }
            } else {
              {
#line 969
              add_rr_to_bighash(maintable, query, data, ttl, udpzone, (uint16_t )0);
              }
            }
          }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
      {
#line 972
      js_close(desc);
      }
    }
    __Cont: /* CIL Label */ 
    {
#line 745
    tmp___23 = mhash_nextkey(csvs, zone);
    }
#line 745
    if (! (tmp___23 != 0)) {
#line 745
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 975
  js_destroy(udpzone);
#line 975
  js_destroy(filename);
#line 975
  js_destroy(line___6);
#line 976
  js_destroy(pline);
#line 976
  js_destroy(soaline);
#line 976
  js_destroy(query);
#line 977
  js_destroy(data);
#line 977
  js_destroy(zone);
#line 977
  js_dealloc((void *)desc);
  }
#line 978
  return (1);
}
}
#line 983 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int populate_main(mhash *maintable , js_string *error , int recursive ) 
{ 
  int tmp ;

  {
  {
#line 985
  parse_csv1s(maintable, error, recursive);
#line 986
  csv2_parse_main_bighash(maintable, 0);
#line 989
  tmp = add_an(maintable, error);
  }
#line 989
  return (tmp);
}
}
#line 997 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int warn_ddip(js_string *query ) 
{ 
  int a ;
  int l ;
  char c ;

  {
#line 998
  a = 0;
#line 998
  l = 0;
#line 999
  if (log_level == 0) {
#line 1000
    return (1);
  } else
#line 999
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
#line 1000
    return (1);
  } else
#line 999
  if ((unsigned long )query->string == (unsigned long )((unsigned char *)0)) {
#line 1000
    return (1);
  }
  {
#line 1002
  printf((char const   */* __restrict  */)"%s%s", "Dotted decimal IP for NS, CNAME, or MX does not work with some DNS servers",
         "\n");
#line 1003
  printf((char const   */* __restrict  */)"Hostname of record with problem: ");
#line 1004
  a = 0;
  }
  {
#line 1004
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1004
    if (! ((unsigned int )a < query->unit_count)) {
#line 1004
      goto while_break;
    }
#line 1005
    l = (int )*(query->string + a);
#line 1006
    if (l < 1) {
      {
#line 1007
      printf((char const   */* __restrict  */)"\n");
      }
#line 1008
      return (1);
    } else
#line 1006
    if (l > 64) {
      {
#line 1007
      printf((char const   */* __restrict  */)"\n");
      }
#line 1008
      return (1);
    }
    {
#line 1010
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1010
      if (! (l > 0)) {
#line 1010
        goto while_break___0;
      }
#line 1012
      a ++;
#line 1013
      c = (char )*(query->string + a);
#line 1014
      if ((int )c > 32) {
#line 1014
        if ((int )c < 126) {
          {
#line 1015
          printf((char const   */* __restrict  */)"%c", (int )c);
          }
        } else {
          {
#line 1017
          printf((char const   */* __restrict  */)"~");
          }
        }
      } else {
        {
#line 1017
        printf((char const   */* __restrict  */)"~");
        }
      }
#line 1010
      l --;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 1020
    printf((char const   */* __restrict  */)".");
#line 1004
    a ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1022
  printf((char const   */* __restrict  */)"\n");
  }
#line 1023
  return (1);
}
}
#line 1034 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int make_ddip(mhash *bighash , js_string *query ) 
{ 
  unsigned char ip[4] ;
  unsigned char length ;
  unsigned char val ;
  int critter ;
  int counter ;
  int lenl ;
  int value___6 ;
  js_string *js_ip ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 1040
  if (query->unit_size != 1U) {
#line 1041
    return (-1);
  }
#line 1042
  if (query->unit_count >= query->max_count) {
#line 1043
    return (-1);
  }
  {
#line 1047
  tmp = get_rtype(query);
  }
#line 1047
  if (tmp != 1) {
#line 1048
    return (0);
  }
#line 1050
  if (query->unit_count < 9U) {
#line 1052
    return (0);
  }
#line 1055
  lenl = 0;
#line 1056
  counter = 0;
  {
#line 1056
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1056
    if (! (counter < 4)) {
#line 1056
      goto while_break;
    }
#line 1057
    length = *(query->string + lenl);
#line 1058
    if ((int )length < 1) {
#line 1059
      return (0);
    } else
#line 1058
    if ((int )length > 3) {
#line 1059
      return (0);
    }
#line 1060
    critter = lenl + 1;
#line 1061
    lenl += (int )length + 1;
#line 1062
    if ((unsigned int )lenl > query->unit_count) {
#line 1063
      return (-1);
    }
#line 1064
    value___6 = 0;
    {
#line 1064
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1064
      if (! (critter < lenl)) {
#line 1064
        goto while_break___0;
      }
#line 1065
      val = *(query->string + critter);
#line 1066
      if ((int )val > 57) {
#line 1067
        return (0);
      } else
#line 1066
      if ((int )val < 48) {
#line 1067
        return (0);
      }
#line 1068
      value___6 *= 10;
#line 1069
      value___6 += (int )val - 48;
#line 1064
      critter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 1071
    if (value___6 < 0) {
#line 1072
      return (0);
    } else
#line 1071
    if (value___6 > 255) {
#line 1072
      return (0);
    }
#line 1073
    ip[counter] = (unsigned char )value___6;
#line 1056
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1076
  if ((int )*(query->string + lenl) != 0) {
#line 1077
    return (0);
  }
  {
#line 1081
  js_ip = js_create(5U, 1U);
  }
#line 1081
  if ((unsigned long )js_ip == (unsigned long )((js_string *)0)) {
#line 1082
    return (-1);
  }
  {
#line 1084
  tmp___0 = js_str2js(js_ip, (char *)(ip), 4, 1);
  }
#line 1084
  if (tmp___0 == -1) {
    {
#line 1085
    js_destroy(js_ip);
    }
#line 1086
    return (-1);
  }
  {
#line 1089
  tmp___1 = mhash_put_rr(bighash, query, js_ip, (uint32_t )8675309, (uint32_t )1,
                         (uint32_t )0, (uint16_t )0);
  }
#line 1089
  if (tmp___1 == -1) {
    {
#line 1090
    js_destroy(js_ip);
    }
#line 1091
    return (-1);
  } else {
    {
#line 1094
    js_destroy(js_ip);
    }
#line 1095
    return (1);
  }
}
}
#line 1109 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int add_an(mhash *bighash , js_string *error ) 
{ 
  js_string *query ;
  js_string *a_query ;
  mhash_e qdata ;
  mhash_e adata ;
  rr *record ;
  int qtype ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
  {
#line 1112
  qdata.point = (void **)0;
#line 1112
  qdata.value = (void *)0;
#line 1112
  qdata.datatype = 0;
#line 1112
  adata.point = (void **)0;
#line 1112
  adata.value = (void *)0;
#line 1112
  adata.datatype = 0;
#line 1116
  a_query = js_create(256U, 1U);
  }
#line 1116
  if ((unsigned long )a_query == (unsigned long )((js_string *)0)) {
#line 1117
    return (-1);
  }
  {
#line 1118
  query = js_create(256U, 1U);
  }
#line 1118
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
    {
#line 1119
    js_destroy(a_query);
    }
#line 1120
    return (-1);
  }
  {
#line 1125
  tmp = mhash_firstkey(bighash, query);
  }
#line 1125
  if (tmp <= 0) {
    {
#line 1126
    js_destroy(a_query);
#line 1127
    js_destroy(query);
    }
#line 1128
    return (0);
  }
  {
#line 1131
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1133
    qtype = get_rtype(query);
    }
#line 1134
    if (qtype == -1) {
#line 1135
      goto __Cont;
    }
    {
#line 1136
    qdata = mhash_get(bighash, query);
    }
#line 1139
    if (qtype == 15) {
#line 1139
      goto _L___1;
    } else
#line 1139
    if (qtype == 2) {
      _L___1: /* CIL Label */ 
#line 1140
      if (qdata.datatype == 3) {
#line 1143
        record = (rr *)qdata.value;
        {
#line 1144
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 1145
          if ((unsigned long )record != (unsigned long )((rr *)0)) {
            {
#line 1145
            tmp___0 = answer_ip_query(qtype, record->data, a_query);
            }
#line 1145
            if (tmp___0 == -1) {
#line 1147
              goto __Cont___0;
            }
          }
          {
#line 1148
          tmp___1 = change_rtype(a_query, 1);
          }
#line 1148
          if (tmp___1 == -1) {
#line 1149
            goto __Cont___0;
          }
          {
#line 1150
          adata = mhash_get(bighash, a_query);
          }
#line 1152
          if (adata.datatype == 3) {
#line 1153
            if ((unsigned long )record != (unsigned long )((rr *)0)) {
#line 1153
              if ((unsigned long )adata.value != (unsigned long )((void *)0)) {
#line 1154
                record->ip = (struct rr *)adata.value;
              }
            }
          } else {
            {
#line 1157
            tmp___2 = make_ddip(bighash, a_query);
            }
#line 1157
            if (tmp___2 == 1) {
              {
#line 1158
              warn_ddip(query);
#line 1159
              adata = mhash_get(bighash, a_query);
              }
#line 1160
              if (adata.datatype == 3) {
#line 1161
                if ((unsigned long )record != (unsigned long )((rr *)0)) {
#line 1161
                  if ((unsigned long )adata.value != (unsigned long )((void *)0)) {
#line 1162
                    record->ip = (struct rr *)adata.value;
                  }
                }
              }
            }
          }
          {
#line 1167
          tmp___3 = change_rtype(a_query, 28);
          }
#line 1167
          if (tmp___3 == -1) {
#line 1168
            goto __Cont___0;
          }
          {
#line 1169
          adata = mhash_get(bighash, a_query);
          }
#line 1171
          if (adata.datatype == 3) {
#line 1172
            if ((unsigned long )record != (unsigned long )((rr *)0)) {
#line 1172
              if ((unsigned long )adata.value != (unsigned long )((void *)0)) {
#line 1173
                record->ip6 = (struct rr *)adata.value;
              } else {
#line 1172
                goto _L;
              }
            } else
            _L: /* CIL Label */ 
#line 1175
            if ((unsigned long )record != (unsigned long )((rr *)0)) {
#line 1175
              record->ip6 = (struct rr *)0;
            }
          }
          __Cont___0: /* CIL Label */ 
#line 1144
          record = record->next;
#line 1144
          if (! ((unsigned long )record != (unsigned long )((rr *)0))) {
#line 1144
            goto while_break___0;
          }
        }
        while_break___0: /* CIL Label */ ;
        }
      }
    } else
#line 1182
    if (qtype == 5) {
#line 1185
      record = (rr *)qdata.value;
      {
#line 1186
      while (1) {
        while_continue___1: /* CIL Label */ ;
        {
#line 1187
        tmp___4 = answer_ip_query(qtype, record->data, a_query);
        }
#line 1187
        if (tmp___4 == -1) {
#line 1188
          goto __Cont___1;
        }
#line 1189
        if ((int )record->rr_type != 5) {
#line 1190
          goto while_break___1;
        }
        {
#line 1191
        tmp___5 = change_rtype(a_query, 255);
        }
#line 1191
        if (tmp___5 == -1) {
#line 1192
          goto __Cont___1;
        }
        {
#line 1193
        adata = mhash_get(bighash, a_query);
        }
#line 1195
        if (adata.datatype == 6) {
#line 1196
          if ((unsigned long )record != (unsigned long )((rr *)0)) {
#line 1196
            if ((unsigned long )adata.value != (unsigned long )((void *)0)) {
#line 1197
              record->list = (struct rr_list *)adata.value;
            }
          }
        } else
#line 1199
        if (no_cname_warnings == 0) {
#line 1199
          if (cname_warnings_shown < 10) {
            {
#line 1201
            printf((char const   */* __restrict  */)"Warning: The CNAME record ");
#line 1202
            human_readable_dns_query(query, 1);
#line 1203
            printf((char const   */* __restrict  */)" is a dangling CNAME record.\nPlease read the FAQ entry about FAQ entry about dangling CNAME records.\n");
#line 1205
            cname_warnings_shown ++;
            }
          } else {
#line 1199
            goto _L___0;
          }
        } else
        _L___0: /* CIL Label */ 
#line 1207
        if (no_cname_warnings == 0) {
#line 1207
          if (cname_warnings_shown == 10) {
            {
#line 1209
            printf((char const   */* __restrict  */)"Warning: More dangling CNAME records exist.\n");
#line 1210
            cname_warnings_shown ++;
            }
          }
        }
        __Cont___1: /* CIL Label */ 
#line 1186
        record = record->next;
#line 1186
        if (! ((unsigned long )record != (unsigned long )((rr *)0))) {
#line 1186
          goto while_break___1;
        }
      }
      while_break___1: /* CIL Label */ ;
      }
    }
    __Cont: /* CIL Label */ 
    {
#line 1131
    tmp___6 = mhash_nextkey(bighash, query);
    }
#line 1131
    if (! (tmp___6 != 0)) {
#line 1131
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1215
  js_destroy(a_query);
#line 1216
  js_destroy(query);
  }
#line 1217
  return (1);
}
}
#line 1228 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int answer_ip_query(int qtype , js_string *qu , js_string *ar ) 
{ 
  int start ;
  int length ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 1232
  tmp = js_has_sanity(qu);
  }
#line 1232
  if (tmp == -1) {
#line 1233
    return (-1);
  }
#line 1234
  if (qu->unit_size != 1U) {
#line 1235
    return (-1);
  }
  {
#line 1236
  tmp___0 = js_has_sanity(ar);
  }
#line 1236
  if (tmp___0 == -1) {
#line 1237
    return (-1);
  }
#line 1238
  if (ar->unit_size != 1U) {
#line 1239
    return (-1);
  }
#line 1242
  ar->unit_count = 0U;
  {
#line 1249
  if (qtype == 5) {
#line 1249
    goto case_5;
  }
#line 1249
  if (qtype == 2) {
#line 1249
    goto case_5;
  }
#line 1254
  if (qtype == 15) {
#line 1254
    goto case_15;
  }
#line 1260
  goto switch_default;
  case_5: /* CIL Label */ 
  case_2: /* CIL Label */ 
#line 1250
  start = 0;
#line 1252
  length = (int )(qu->unit_count - (unsigned int )start);
#line 1253
  goto switch_break;
  case_15: /* CIL Label */ 
#line 1255
  start = 2;
#line 1257
  length = (int )(qu->unit_count - (unsigned int )start);
#line 1258
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 1261
  return (1);
  switch_break: /* CIL Label */ ;
  }
  {
#line 1265
  tmp___1 = js_substr(qu, ar, start, length);
  }
#line 1265
  if (tmp___1 == -1) {
#line 1266
    return (-1);
  }
  {
#line 1270
  tmp___2 = js_addbyte(ar, (unsigned char)0);
  }
#line 1270
  if (tmp___2 == -1) {
#line 1271
    return (-1);
  }
  {
#line 1272
  tmp___3 = js_addbyte(ar, (unsigned char)1);
  }
#line 1272
  if (tmp___3 == -1) {
#line 1273
    return (-1);
  }
#line 1275
  return (1);
}
}
#line 1306 "/home/wheatley/newnew/temp/maradns-2.0.09/server/MaraBigHash.c"
int add_rr_to_bighash(mhash *bighash , js_string *query , js_string *data , uint32_t ttl ,
                      js_string *zone , uint16_t perms ) 
{ 
  int label_len ;
  int has_authority ;
  int qtype ;
  mhash_e hash_spot ;
  rr *nukeme ;
  rr *point ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;

  {
  {
#line 1310
  has_authority = 0;
#line 1315
  tmp = js_has_sanity(query);
  }
#line 1315
  if (tmp == -1) {
#line 1317
    return (-1);
  } else {
    {
#line 1315
    tmp___0 = js_has_sanity(data);
    }
#line 1315
    if (tmp___0 == -1) {
#line 1317
      return (-1);
    } else {
      {
#line 1315
      tmp___1 = js_has_sanity(query);
      }
#line 1315
      if (tmp___1 == -1) {
#line 1317
        return (-1);
      }
    }
  }
#line 1318
  if (query->unit_count < 3U) {
#line 1319
    return (-1);
  } else
#line 1318
  if (zone->unit_count < 3U) {
#line 1319
    return (-1);
  }
  {
#line 1322
  qtype = get_rtype(query);
  }
#line 1322
  if (qtype == -1) {
#line 1323
    return (-1);
  }
#line 1326
  if (qtype == 255) {
#line 1327
    return (-1);
  }
#line 1330
  if (qtype == 251) {
#line 1331
    return (-1);
  } else
#line 1330
  if (qtype == 252) {
#line 1331
    return (-1);
  }
  {
#line 1334
  dns_records_served ++;
#line 1338
  tmp___2 = change_rtype(zone, qtype);
  }
#line 1338
  if (tmp___2 == -1) {
    {
#line 1339
    change_rtype(zone, 2);
    }
#line 1340
    return (-1);
  }
  {
#line 1344
  tmp___5 = js_issame(zone, query);
  }
#line 1344
  if (tmp___5) {
#line 1345
    has_authority = 1;
  } else {
    {
#line 1351
    tmp___4 = get_rtype(query);
    }
#line 1351
    if (tmp___4 != 2) {
#line 1353
      label_len = -1;
#line 1355
      if ((int )*(query->string) != 95) {
#line 1355
        if ((int )*(query->string) < 64) {
#line 1356
          label_len = (int )*(query->string) + 1;
        } else {
#line 1355
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 1357
      if ((int )*(query->string) == 95) {
#line 1358
        label_len = 1;
      } else {
        {
#line 1360
        change_rtype(zone, 2);
        }
#line 1361
        return (-1);
      }
#line 1365
      if (zone->unit_count == query->unit_count - (unsigned int )label_len) {
        {
#line 1365
        tmp___3 = js_fgrep(zone, query);
        }
#line 1365
        if (tmp___3 == label_len) {
#line 1367
          has_authority = 1;
        }
      }
    }
  }
  {
#line 1375
  change_rtype(zone, 2);
#line 1377
  hash_spot = mhash_get(bighash, query);
  }
#line 1380
  if ((unsigned long )hash_spot.value == (unsigned long )((void *)0)) {
    {
#line 1382
    tmp___6 = mhash_put_rr(bighash, query, data, ttl, (uint32_t )has_authority, (uint32_t )0,
                           perms);
    }
#line 1382
    if (tmp___6 == -1) {
#line 1384
      return (-1);
    }
    {
#line 1385
    tmp___7 = mhash_add_ns(bighash, query, zone);
    }
#line 1385
    if (tmp___7 == -1) {
#line 1386
      return (-1);
    }
#line 1387
    return (1);
  }
#line 1391
  if (hash_spot.datatype != 3) {
#line 1392
    return (-1);
  }
#line 1394
  point = (rr *)hash_spot.value;
#line 1402
  if (point->authoritative == 1U) {
#line 1402
    if (has_authority == 1) {
#line 1402
      goto _L___0;
    } else {
#line 1402
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 1402
  if (point->authoritative == 0U) {
#line 1402
    if (has_authority == 0) {
      _L___0: /* CIL Label */ 
      {
#line 1404
      tmp___8 = mhash_add_rr(bighash, query, data, ttl, (uint32_t )has_authority,
                             (uint32_t )0, perms);
      }
#line 1404
      if (tmp___8 == -1) {
#line 1406
        return (-1);
      }
#line 1407
      return (1);
    }
  }
#line 1413
  if (point->authoritative == 0U) {
#line 1413
    if (has_authority == 1) {
      {
#line 1418
      tmp___9 = mhash_undef(bighash, query);
#line 1418
      nukeme = (rr *)tmp___9;
      }
#line 1419
      if ((unsigned long )nukeme == (unsigned long )((rr *)0)) {
#line 1420
        return (-1);
      }
      {
#line 1423
      tmp___10 = any_zap_rr(bighash, query, nukeme);
      }
#line 1423
      if (tmp___10 == -1) {
#line 1424
        return (-1);
      }
      {
#line 1427
      tmp___11 = js_dealloc((void *)nukeme);
      }
#line 1427
      if (tmp___11 == -1) {
#line 1428
        return (-1);
      }
      {
#line 1431
      tmp___12 = mhash_put_rr(bighash, query, data, ttl, (uint32_t )has_authority,
                              (uint32_t )0, perms);
      }
#line 1431
      if (tmp___12 == -1) {
#line 1433
        return (-1);
      }
      {
#line 1434
      tmp___13 = mhash_add_ns(bighash, query, zone);
      }
#line 1434
      if (tmp___13 == -1) {
#line 1435
        return (-1);
      }
#line 1436
      return (1);
    }
  }
#line 1442
  if (point->authoritative == 1U) {
#line 1442
    if (has_authority == 0) {
#line 1443
      return (1);
    }
  }
#line 1446
  return (-1);
}
}
#line 176 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_add_rr(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                js_string *data ) ;
#line 188
js_string *csv2_get_txt(csv2_read *stream , int numchunks ) ;
#line 193
js_string *csv2_get_raw(csv2_read *stream ) ;
#line 220
js_string *process_1stchar(csv2_read *stream , int (*is_ok)(int32_t in ) , char *pre ) ;
#line 226
int csv2_see_char(int32_t in , char *list ) ;
#line 227
int csv2_is_number(int32_t in ) ;
#line 228
int csv2_is_upper(int32_t in ) ;
#line 229
int csv2_is_lower(int32_t in ) ;
#line 230
int csv2_is_hibit(int32_t in ) ;
#line 231
int csv2_is_delimiter(int in ) ;
#line 232
int32_t csv2_get_utf8(csv2_read *stream ) ;
#line 233
int32_t csv2_read_unicode(csv2_read *stream ) ;
#line 234
int csv2_append_utf8(js_string *toappend , int32_t in ) ;
#line 235
int csv2_get_1st(csv2_read *stream , int (*is_ok)(int32_t in ) , int options ) ;
#line 236
int csv2_is_alpha(int32_t in ) ;
#line 237
int csv2_is_alphanum(int32_t in ) ;
#line 238
int csv2_is_text(int32_t in ) ;
#line 239
int csv2_is_dchar(int32_t in ) ;
#line 240
int csv2_is_starwhitis(int32_t in ) ;
#line 241
int csv2_numeric_rtype(js_string *text_rtype ) ;
#line 242
int32_t csv2_get_rtype(csv2_read *stream ) ;
#line 243
int32_t csv2_get_num(csv2_read *stream ) ;
#line 244
int csv2_read_rr(csv2_add_state *state , csv2_read *stream , int32_t starwhitis ) ;
#line 245
void process_comment(csv2_read *stream ) ;
#line 246
js_string *process_something(csv2_read *stream , int (*is_ok)(int32_t in ) ) ;
#line 247
js_string *process_number(csv2_read *stream ) ;
#line 248
js_string *process_textlabel(csv2_read *stream ) ;
#line 249
js_string *process_dname(csv2_read *stream , int starwhitis ) ;
#line 250
js_string *js_append_dname(js_string *o , csv2_read *stream , int starwhitis ) ;
#line 251
js_string *csv2_get_hostname(csv2_read *stream , js_string *zonename , int starwhitis ) ;
#line 253
js_string *csv2_get_dname(csv2_read *stream ) ;
#line 254
js_string *csv2_get_soa(csv2_read *stream , js_string *zone , csv2_add_state *state ) ;
#line 256
js_string *csv2_convert_percent(js_string *in , js_string *psub ) ;
#line 258
int csv2_readchar(csv2_read *file___6 ) ;
#line 259
int csv2_justread(csv2_read *file___6 ) ;
#line 260
int csv2_error(csv2_read *file___6 , char *why ) ;
#line 261
int32_t csv2_get_unicode(csv2_read *file___6 ) ;
#line 262
int csv2_set_unicode(csv2_read *file___6 , int32_t in ) ;
#line 269
js_string *csv2_get_a(csv2_read *stream ) ;
#line 275
js_string *csv2_get_aaaa(csv2_read *stream ) ;
#line 282
js_string *csv2_get_wks(csv2_read *stream ) ;
#line 283
js_string *csv2_get_mbox(csv2_read *stream , js_string *zone , int count ) ;
#line 284
js_string *csv2_get_hex(csv2_read *stream ) ;
#line 285
js_string *csv2_get_loc(csv2_read *stream ) ;
#line 286
js_string *csv2_get_naptr(csv2_read *stream ) ;
#line 289
int csv2_push_file(csv2_read *file___6 , js_string *filename ) ;
#line 291
void csv2_allow_tilde(csv2_read *file___6 ) ;
#line 292
void csv2_forbid_tilde(csv2_read *file___6 ) ;
#line 295
int csv2_tilde_seen(csv2_read *file___6 ) ;
#line 296
void csv2_reset_tilde_seen(csv2_read *file___6 ) ;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_see_char(int32_t in , char *list ) 
{ 
  int counter ;

  {
#line 45
  counter = 0;
#line 46
  if ((unsigned long )list == (unsigned long )((char *)0)) {
#line 47
    return (0);
  }
  {
#line 49
  while (1) {
    while_continue: /* CIL Label */ ;
#line 49
    if ((int )*list != 0) {
#line 49
      counter ++;
#line 49
      if (! (counter < 128)) {
#line 49
        goto while_break;
      }
    } else {
#line 49
      goto while_break;
    }
#line 50
    if ((int )*list == in) {
#line 51
      return (1);
    }
#line 53
    list ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 55
  return (0);
}
}
#line 62 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_number(int32_t in ) 
{ 
  int tmp ;

  {
#line 63
  if (in >= 48) {
#line 63
    if (in <= 57) {
#line 63
      tmp = 1;
    } else {
#line 63
      tmp = 0;
    }
  } else {
#line 63
    tmp = 0;
  }
#line 63
  return (tmp);
}
}
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_number_orslash(int32_t in ) 
{ 
  int tmp ;

  {
#line 70
  if (in >= 48) {
#line 70
    if (in <= 57) {
#line 70
      tmp = 1;
    } else {
#line 70
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 70
  if (in == 47) {
#line 70
    tmp = 1;
  } else {
#line 70
    tmp = 0;
  }
#line 70
  return (tmp);
}
}
#line 76 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_upper(int32_t in ) 
{ 
  int tmp ;

  {
#line 77
  if (in >= 65) {
#line 77
    if (in <= 90) {
#line 77
      tmp = 1;
    } else {
#line 77
      tmp = 0;
    }
  } else {
#line 77
    tmp = 0;
  }
#line 77
  return (tmp);
}
}
#line 83 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_lower(int32_t in ) 
{ 
  int tmp ;

  {
#line 84
  if (in >= 97) {
#line 84
    if (in <= 122) {
#line 84
      tmp = 1;
    } else {
#line 84
      tmp = 0;
    }
  } else {
#line 84
    tmp = 0;
  }
#line 84
  return (tmp);
}
}
#line 90 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_hibit(int32_t in ) 
{ 
  int tmp ;

  {
#line 91
  if (in >= 128) {
#line 91
    if (in <= 253) {
#line 91
      tmp = 1;
    } else {
#line 91
      tmp = 0;
    }
  } else {
#line 91
    tmp = 0;
  }
#line 91
  return (tmp);
}
}
#line 97 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_delimiter(int in ) 
{ 
  int tmp ;

  {
#line 98
  if (in == 13) {
#line 98
    tmp = 1;
  } else
#line 98
  if (in == 10) {
#line 98
    tmp = 1;
  } else
#line 98
  if (in == 9) {
#line 98
    tmp = 1;
  } else
#line 98
  if (in == 32) {
#line 98
    tmp = 1;
  } else
#line 98
  if (in == 124) {
#line 98
    tmp = 1;
  } else {
#line 98
    tmp = 0;
  }
#line 98
  return (tmp);
}
}
#line 104 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_isnt_delimiter(int in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 105
  tmp = csv2_is_delimiter(in);
  }
#line 105
  if (tmp) {
#line 105
    tmp___0 = 0;
  } else {
#line 105
    tmp___0 = 1;
  }
#line 105
  return (tmp___0);
}
}
#line 115 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_utf8_length(int in ) 
{ 


  {
#line 116
  if (in >= 254) {
#line 117
    return (-2);
  }
#line 119
  if (in < 0) {
#line 120
    return (-1);
  }
#line 122
  if (in < 128) {
#line 122
    if (in > 0) {
#line 123
      return (0);
    }
  }
#line 125
  if (in >= 128) {
#line 125
    if (in < 192) {
#line 126
      return (1);
    }
  }
#line 128
  if (in >= 192) {
#line 128
    if (in < 224) {
#line 129
      return (2);
    }
  }
#line 131
  if (in >= 224) {
#line 131
    if (in < 240) {
#line 132
      return (3);
    }
  }
#line 134
  if (in >= 240) {
#line 134
    if (in < 248) {
#line 135
      return (4);
    }
  }
#line 137
  if (in >= 248) {
#line 137
    if (in < 252) {
#line 138
      return (5);
    }
  }
#line 140
  if (in >= 252) {
#line 140
    if (in < 254) {
#line 141
      return (6);
    }
  }
#line 143
  return (-1);
}
}
#line 155 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int32_t csv2_get_utf8(csv2_read *stream ) 
{ 
  int32_t in ;
  int32_t out ;
  int len ;
  int count ;

  {
  {
#line 158
  in = csv2_justread(stream);
#line 159
  len = csv2_utf8_length(in);
  }
#line 162
  if (len < 2) {
    {
#line 163
    csv2_error(stream, (char *)"Invalid UTF-8 sequence");
    }
#line 164
    return (-164);
  }
#line 169
  out = in;
#line 170
  if (len == 2) {
#line 171
    out &= 31;
  } else
#line 172
  if (len == 3) {
#line 173
    out &= 15;
  } else
#line 174
  if (len == 4) {
#line 175
    out &= 7;
  } else
#line 176
  if (len == 5) {
#line 177
    out &= 3;
  } else
#line 178
  if (len == 6) {
#line 179
    out &= 1;
  } else {
    {
#line 181
    csv2_error(stream, (char *)"Fatal error parsing UTF-8");
    }
#line 182
    return (-164);
  }
#line 185
  count = len;
  {
#line 187
  while (1) {
    while_continue: /* CIL Label */ ;
#line 187
    if (! (len > 1)) {
#line 187
      goto while_break;
    }
    {
#line 188
    out <<= 6;
#line 189
    in = csv2_readchar(stream);
    }
#line 190
    if (in == -2) {
      {
#line 191
      csv2_error(stream, (char *)"EOF in middle of UTF-8 sequence");
      }
#line 192
      return (-164);
    }
#line 194
    if (in < 128) {
      {
#line 195
      csv2_error(stream, (char *)"Invalid char in UTF-8 sequence");
      }
#line 196
      return (-164);
    } else
#line 194
    if (in >= 192) {
      {
#line 195
      csv2_error(stream, (char *)"Invalid char in UTF-8 sequence");
      }
#line 196
      return (-164);
    }
#line 198
    in &= 63;
#line 199
    out |= in;
#line 200
    len --;
  }
  while_break: /* CIL Label */ ;
  }
#line 205
  if (out < 128) {
    {
#line 206
    csv2_error(stream, (char *)"UTF-8 sequence too long");
    }
#line 207
    return (-164);
  }
#line 209
  if (out < 2048) {
#line 209
    if (count > 2) {
      {
#line 210
      csv2_error(stream, (char *)"UTF-8 sequence too long");
      }
#line 211
      return (-164);
    }
  }
#line 213
  if (out < 65536) {
#line 213
    if (count > 3) {
      {
#line 214
      csv2_error(stream, (char *)"UTF-8 sequence too long");
      }
#line 215
      return (-164);
    }
  }
#line 217
  if (out < 2097152) {
#line 217
    if (count > 4) {
      {
#line 218
      csv2_error(stream, (char *)"UTF-8 sequence too long");
      }
#line 219
      return (-164);
    }
  }
#line 221
  if (out < 67108864) {
#line 221
    if (count > 5) {
      {
#line 222
      csv2_error(stream, (char *)"UTF-8 sequence too long");
      }
#line 223
      return (-164);
    }
  }
  {
#line 226
  csv2_set_unicode(stream, out);
  }
#line 227
  return (out);
}
}
#line 239 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int32_t csv2_read_unicode(csv2_read *stream ) 
{ 
  int32_t out ;
  int32_t tmp ;

  {
  {
#line 241
  out = csv2_readchar(stream);
  }
#line 242
  if (out < 0) {
#line 243
    return (out);
  }
#line 245
  if (out > 127) {
    {
#line 246
    tmp = csv2_get_utf8(stream);
    }
#line 246
    return (tmp);
  }
#line 248
  return (out);
}
}
#line 261 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_append_utf8(js_string *toappend , int32_t in ) 
{ 
  int tmp ;
  int temp[6] ;
  int counter ;
  int place ;
  int32_t shift ;

  {
  {
#line 262
  tmp = js_has_sanity(toappend);
  }
#line 262
  if (tmp == -1) {
#line 263
    return (-1);
  }
#line 266
  if (toappend->unit_size != 1U) {
#line 267
    return (-1);
  }
#line 270
  if (in < 0) {
#line 271
    return (-1);
  }
#line 275
  if (in < 128) {
#line 276
    if (toappend->unit_count + 1U > toappend->max_count) {
#line 277
      return (-1);
    }
#line 279
    *(toappend->string + toappend->unit_count) = (unsigned char )in;
#line 280
    (toappend->unit_count) ++;
#line 281
    return (1);
  } else {
#line 289
    shift = in;
#line 290
    counter = 5;
    {
#line 291
    while (1) {
      while_continue: /* CIL Label */ ;
#line 291
      if (counter >= 0) {
#line 291
        if (! (shift > 0)) {
#line 291
          goto while_break;
        }
      } else {
#line 291
        goto while_break;
      }
#line 292
      temp[counter] = shift & 63;
#line 293
      shift >>= 6;
#line 294
      counter --;
    }
    while_break: /* CIL Label */ ;
    }
#line 296
    counter ++;
#line 297
    place = counter;
#line 298
    if (counter == 0) {
#line 299
      temp[counter] |= 252;
    } else
#line 300
    if (counter == 1) {
#line 301
      temp[counter] |= 248;
    } else
#line 302
    if (counter == 2) {
#line 303
      temp[counter] |= 240;
    } else
#line 304
    if (counter == 3) {
#line 305
      temp[counter] |= 224;
    } else
#line 306
    if (counter == 4) {
#line 307
      temp[counter] |= 192;
    } else {
#line 309
      return (-1);
    }
#line 310
    counter ++;
    {
#line 310
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 310
      if (! (counter < 6)) {
#line 310
        goto while_break___0;
      }
#line 311
      temp[counter] |= 128;
#line 310
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 312
    counter = place;
    {
#line 313
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 313
      if (! (counter < 6)) {
#line 313
        goto while_break___1;
      }
#line 314
      if (toappend->unit_count + 1U > toappend->max_count) {
#line 315
        return (-1);
      }
#line 317
      *(toappend->string + toappend->unit_count) = (unsigned char )temp[counter];
#line 319
      (toappend->unit_count) ++;
#line 320
      counter ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 323
  return (1);
}
}
#line 327 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
void process_comment(csv2_read *stream ) 
{ 
  int in ;
  int q ;
  int z ;

  {
  {
#line 329
  q = 1;
#line 331
  z = (int )stream->chars_allowed;
#line 332
  csv2_allow_tilde(stream);
  }
  {
#line 333
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 334
    in = csv2_readchar(stream);
    }
#line 336
    if (in == 126) {
#line 337
      stream->tilde_seen = (char )((int )stream->tilde_seen - 1);
    }
#line 339
    q ++;
#line 340
    if (q > 5000) {
      {
#line 341
      csv2_error(stream, (char *)"Comment too long");
      }
#line 342
      return;
    }
#line 333
    if (in != 10) {
#line 333
      if (in != 13) {
#line 333
        if (! (in != -2)) {
#line 333
          goto while_break;
        }
      } else {
#line 333
        goto while_break;
      }
    } else {
#line 333
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 345
  stream->chars_allowed = (char )z;
#line 346
  return;
}
}
#line 350 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_tilde_processing(csv2_read *stream ) 
{ 
  int permitted ;
  int seen ;

  {
  {
#line 354
  permitted = 0;
#line 359
  seen = csv2_tilde_seen(stream);
  }
#line 361
  if ((int )stream->tilde_handling > 100) {
    {
#line 363
    if ((int )stream->tilde_handling == 101) {
#line 363
      goto case_101;
    }
#line 366
    if ((int )stream->tilde_handling == 102) {
#line 366
      goto case_102;
    }
#line 369
    if ((int )stream->tilde_handling == 103) {
#line 369
      goto case_103;
    }
#line 362
    goto switch_break;
    case_101: /* CIL Label */ 
#line 364
    permitted = 0;
#line 365
    goto switch_break;
    case_102: /* CIL Label */ 
#line 367
    permitted = -2;
#line 368
    goto switch_break;
    case_103: /* CIL Label */ 
#line 370
    permitted = 1;
#line 371
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 373
    if (seen > 1) {
      {
#line 374
      csv2_error(stream, (char *)"A maximum of one tilde is allowed between records.\nIf you need tildes, set csv2_tilde_handling to 0");
      }
#line 377
      return (-1);
    }
#line 379
    if (permitted != -2) {
#line 379
      if (seen != permitted) {
#line 380
        if (permitted == 0) {
          {
#line 381
          csv2_error(stream, (char *)"No tildes allowed between RRs");
          }
        } else
#line 383
        if (permitted == 1) {
          {
#line 384
          csv2_error(stream, (char *)"You must have one tilde (~) between RRs");
          }
        }
#line 387
        return (-1);
      }
    }
#line 389
    if (permitted == -2) {
#line 390
      if (seen == 1) {
#line 391
        stream->tilde_handling = (char)103;
      } else {
#line 393
        stream->tilde_handling = (char)101;
      }
    }
    {
#line 397
    csv2_forbid_tilde(stream);
    }
  } else
#line 404
  if ((int )stream->tilde_handling > 0) {
#line 404
    if ((int )stream->tilde_handling < 20) {
#line 405
      stream->tilde_handling = (char )((int )stream->tilde_handling + 100);
    }
  }
#line 407
  return (1);
}
}
#line 420 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_get_1st(csv2_read *stream , int (*is_ok)(int32_t in ) , int options ) 
{ 
  int32_t in ;
  int x ;
  int lastin ;
  int pipe_already_seen ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;

  {
  {
#line 423
  lastin = 0;
#line 424
  pipe_already_seen = 0;
#line 426
  in = csv2_justread(stream);
  }
#line 427
  if (in > 127) {
    {
#line 428
    in = csv2_get_unicode(stream);
    }
  }
#line 430
  if (in > 127) {
    {
#line 431
    in = csv2_get_unicode(stream);
    }
  }
#line 435
  if (options != 1) {
    {
#line 435
    tmp = (*is_ok)(in);
    }
#line 435
    if (tmp) {
#line 436
      return (1);
    }
  }
#line 440
  if (options == 1) {
#line 440
    if (in == -328) {
      {
#line 440
      tmp___1 = (*is_ok)(in);
      }
#line 440
      if (tmp___1) {
        {
#line 441
        tmp___0 = csv2_tilde_processing(stream);
        }
#line 441
        return (tmp___0);
      }
    }
  }
#line 444
  if (options == 2) {
    {
#line 444
    tmp___2 = (*is_ok)(in);
    }
#line 444
    if (tmp___2) {
      {
#line 445
      csv2_error(stream, (char *)"At least one whitespace character or | must be before this field");
      }
#line 447
      return (-164);
    }
  }
#line 451
  if (options == 1) {
#line 451
    if (in == 46) {
      {
#line 452
      tmp___3 = csv2_tilde_processing(stream);
      }
#line 452
      return (tmp___3);
    }
  }
#line 458
  if (in != -328) {
    {
#line 458
    tmp___4 = csv2_is_delimiter(in);
    }
#line 458
    if (! tmp___4) {
#line 458
      if (in == 126) {
#line 458
        if (! ((int )stream->tilde_handling == 103)) {
          {
#line 460
          csv2_error(stream, (char *)"Unexpected character");
          }
#line 461
          return (-164);
        }
      } else {
        {
#line 460
        csv2_error(stream, (char *)"Unexpected character");
        }
#line 461
        return (-164);
      }
    }
  }
#line 464
  if (in == 124) {
#line 465
    pipe_already_seen = 1;
  }
#line 470
  if (options == 1) {
    {
#line 472
    if ((int )stream->tilde_handling == 101) {
#line 472
      goto case_101;
    }
#line 476
    if ((int )stream->tilde_handling == 103) {
#line 476
      goto case_103;
    }
#line 476
    if ((int )stream->tilde_handling == 102) {
#line 476
      goto case_103;
    }
#line 471
    goto switch_break;
    case_101: /* CIL Label */ 
    {
#line 473
    csv2_forbid_tilde(stream);
    }
#line 474
    goto switch_break;
    case_103: /* CIL Label */ 
    case_102: /* CIL Label */ 
    {
#line 477
    csv2_allow_tilde(stream);
    }
#line 478
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
    {
#line 481
    csv2_reset_tilde_seen(stream);
    }
#line 483
    if (in == 126) {
#line 484
      stream->tilde_seen = (char )((int )stream->tilde_seen + 1);
    }
  }
#line 488
  x = 0;
  {
#line 488
  while (1) {
    while_continue: /* CIL Label */ ;
#line 488
    if (! (x < 10000)) {
#line 488
      goto while_break;
    }
    {
#line 489
    lastin = in;
#line 490
    in = csv2_read_unicode(stream);
    }
#line 491
    if (in == -164) {
#line 492
      return (-1);
    }
#line 494
    if (in == -2) {
#line 495
      return (-2);
    }
#line 498
    if (in == 35) {
      {
#line 499
      process_comment(stream);
#line 500
      in = '\n';
      }
    } else
#line 502
    if (options != 1) {
      {
#line 502
      tmp___10 = (*is_ok)(in);
      }
#line 502
      if (tmp___10) {
#line 503
        return (1);
      } else {
#line 502
        goto _L___6;
      }
    } else
    _L___6: /* CIL Label */ 
#line 505
    if (options == 1) {
#line 505
      if (lastin == 13) {
#line 505
        goto _L___5;
      } else
#line 505
      if (lastin == 10) {
#line 505
        goto _L___5;
      } else
#line 505
      if (lastin == -328) {
        _L___5: /* CIL Label */ 
        {
#line 505
        tmp___9 = (*is_ok)(in);
        }
#line 505
        if (tmp___9) {
          {
#line 508
          tmp___5 = csv2_tilde_processing(stream);
          }
#line 508
          return (tmp___5);
        } else {
#line 505
          goto _L___4;
        }
      } else {
#line 505
        goto _L___4;
      }
    } else
    _L___4: /* CIL Label */ 
#line 510
    if (options == 1) {
      {
#line 510
      tmp___8 = (*is_ok)(in);
      }
#line 510
      if (tmp___8) {
        {
#line 511
        csv2_error(stream, (char *)"Host name must be at the beginning of a line");
        }
#line 513
        return (-164);
      } else {
#line 510
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 516
    if (options == 1) {
#line 516
      if (in == 46) {
        {
#line 517
        tmp___6 = csv2_tilde_processing(stream);
        }
#line 517
        return (tmp___6);
      } else {
#line 516
        goto _L___1;
      }
    } else
    _L___1: /* CIL Label */ 
#line 519
    if (in == 124) {
#line 520
      if (pipe_already_seen == 1) {
        {
#line 521
        csv2_error(stream, (char *)"Only one pipe (|) character is allowed between fields");
        }
#line 523
        return (-164);
      } else {
#line 525
        pipe_already_seen = 1;
      }
    } else
#line 529
    if (in == 126) {
#line 529
      if (options == 1) {
#line 529
        if ((int )stream->tilde_handling > 100) {
#line 531
          goto __Cont;
        } else {
#line 529
          goto _L___0;
        }
      } else {
#line 529
        goto _L___0;
      }
    } else {
      _L___0: /* CIL Label */ 
      {
#line 534
      tmp___7 = csv2_is_delimiter(in);
      }
#line 534
      if (! tmp___7) {
        {
#line 535
        csv2_error(stream, (char *)"Unexpected character");
        }
#line 536
        return (-164);
      }
    }
#line 538
    if (in == -2) {
#line 539
      if (options == 1) {
        {
#line 540
        tmp___11 = csv2_tilde_processing(stream);
        }
#line 540
        return (tmp___11);
      }
#line 542
      return (1);
    }
    __Cont: /* CIL Label */ 
#line 488
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 545
  return (-1);
}
}
#line 553 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *process_1stchar(csv2_read *stream , int (*is_ok)(int32_t in ) , char *pre ) 
{ 
  js_string *o ;
  int32_t look ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 559
  look = csv2_justread(stream);
  }
#line 560
  if (look >= 192) {
#line 560
    if (look < 254) {
      {
#line 561
      look = csv2_get_utf8(stream);
      }
    } else {
#line 560
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 563
  if (look >= 128) {
    {
#line 564
    look = csv2_get_unicode(stream);
    }
  }
#line 567
  if (look == -164) {
#line 568
    return ((js_string *)0);
  }
  {
#line 570
  tmp = (*is_ok)(look);
  }
#line 570
  if (! tmp) {
    {
#line 571
    csv2_error(stream, (char *)"Unexpected character");
    }
#line 572
    return ((js_string *)0);
  }
  {
#line 577
  o = js_create(256U, 1U);
  }
#line 578
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 579
    return ((js_string *)0);
  }
  {
#line 581
  tmp___0 = js_set_encode(o, 2);
  }
#line 581
  if (tmp___0 == -1) {
    {
#line 582
    js_destroy(o);
    }
#line 583
    return ((js_string *)0);
  }
#line 587
  if ((unsigned long )pre != (unsigned long )((char *)0)) {
    {
#line 587
    tmp___1 = js_qstr2js(o, pre);
    }
#line 587
    if (tmp___1 != 1) {
      {
#line 588
      csv2_error(stream, (char *)"Error prepending pre");
#line 589
      js_destroy(o);
      }
#line 590
      return ((js_string *)0);
    }
  }
  {
#line 594
  tmp___2 = csv2_append_utf8(o, look);
  }
#line 594
  if (tmp___2 < 0) {
    {
#line 595
    csv2_error(stream, (char *)"Error appending character");
#line 596
    js_destroy(o);
    }
#line 597
    return ((js_string *)0);
  }
#line 600
  return (o);
}
}
#line 608 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *process_something(csv2_read *stream , int (*is_ok)(int32_t in ) ) 
{ 
  js_string *o ;
  int32_t look ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 614
  o = process_1stchar(stream, is_ok, (char *)0);
  }
#line 615
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 616
    return ((js_string *)0);
  }
  {
#line 619
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 620
    look = csv2_read_unicode(stream);
    }
#line 621
    if (look == -164) {
      {
#line 622
      js_destroy(o);
      }
#line 623
      return ((js_string *)0);
    }
#line 625
    if (look == 35) {
      {
#line 626
      process_comment(stream);
      }
#line 627
      return (o);
    }
    {
#line 629
    tmp = (*is_ok)(look);
    }
#line 629
    if (! tmp) {
      {
#line 629
      tmp___0 = csv2_is_delimiter(look);
      }
#line 629
      if (! tmp___0) {
        {
#line 630
        csv2_error(stream, (char *)"Unexpected character");
#line 631
        js_destroy(o);
        }
#line 632
        return ((js_string *)0);
      }
    }
    {
#line 634
    tmp___1 = (*is_ok)(look);
    }
#line 634
    if (tmp___1) {
      {
#line 634
      tmp___2 = csv2_append_utf8(o, look);
      }
#line 634
      if (tmp___2 < 0) {
        {
#line 635
        csv2_error(stream, (char *)"Error appending character");
#line 636
        js_destroy(o);
        }
#line 637
        return ((js_string *)0);
      }
    }
    {
#line 619
    tmp___3 = (*is_ok)(look);
    }
#line 619
    if (! tmp___3) {
#line 619
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 641
  return (o);
}
}
#line 645 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_alpha(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 646
  tmp = csv2_is_lower(in);
  }
#line 646
  if (tmp) {
#line 646
    tmp___1 = 1;
  } else {
    {
#line 646
    tmp___0 = csv2_is_upper(in);
    }
#line 646
    if (tmp___0) {
#line 646
      tmp___1 = 1;
    } else {
#line 646
      tmp___1 = 0;
    }
  }
#line 646
  return (tmp___1);
}
}
#line 650 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_alphanum(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 651
  tmp = csv2_is_alpha(in);
  }
#line 651
  if (tmp) {
#line 651
    tmp___1 = 1;
  } else {
    {
#line 651
    tmp___0 = csv2_is_number(in);
    }
#line 651
    if (tmp___0) {
#line 651
      tmp___1 = 1;
    } else
#line 651
    if (in == 45) {
#line 651
      tmp___1 = 1;
    } else
#line 651
    if (in == 95) {
#line 651
      tmp___1 = 1;
    } else {
#line 651
      tmp___1 = 0;
    }
  }
#line 651
  return (tmp___1);
}
}
#line 656 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_alphanum_orplus(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 657
  tmp = csv2_is_alphanum(in);
  }
#line 657
  if (tmp) {
#line 657
    tmp___0 = 1;
  } else
#line 657
  if (in == 43) {
#line 657
    tmp___0 = 1;
  } else {
#line 657
    tmp___0 = 0;
  }
#line 657
  return (tmp___0);
}
}
#line 661 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_text(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 662
  tmp = csv2_is_alphanum(in);
  }
#line 662
  if (tmp) {
#line 662
    tmp___0 = 1;
  } else
#line 662
  if (in > 127) {
#line 662
    tmp___0 = 1;
  } else {
#line 662
    tmp___0 = 0;
  }
#line 662
  return (tmp___0);
}
}
#line 666 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_dname(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 667
  tmp = csv2_is_alphanum(in);
  }
#line 667
  if (tmp) {
#line 667
    tmp___0 = 1;
  } else
#line 667
  if (in == 47) {
#line 667
    tmp___0 = 1;
  } else
#line 667
  if (in > 127) {
#line 667
    tmp___0 = 1;
  } else {
#line 667
    tmp___0 = 0;
  }
#line 667
  return (tmp___0);
}
}
#line 671 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_dchar(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 672
  tmp = csv2_is_text(in);
  }
#line 672
  if (tmp) {
#line 672
    tmp___0 = 1;
  } else
#line 672
  if (in == 37) {
#line 672
    tmp___0 = 1;
  } else {
#line 672
    tmp___0 = 0;
  }
#line 672
  return (tmp___0);
}
}
#line 676 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_fchar(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 677
  tmp = csv2_is_text(in);
  }
#line 677
  if (tmp) {
#line 677
    tmp___0 = 1;
  } else
#line 677
  if (in == 46) {
#line 677
    tmp___0 = 1;
  } else {
#line 677
    tmp___0 = 0;
  }
#line 677
  return (tmp___0);
}
}
#line 681 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_starwhitis(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 682
  tmp = csv2_is_text(in);
  }
#line 682
  if (tmp) {
#line 682
    tmp___0 = 1;
  } else
#line 682
  if (in == 42) {
#line 682
    tmp___0 = 1;
  } else
#line 682
  if (in == 37) {
#line 682
    tmp___0 = 1;
  } else {
#line 682
    tmp___0 = 0;
  }
#line 682
  return (tmp___0);
}
}
#line 686 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_starwhitis_orslash(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 687
  tmp = csv2_is_text(in);
  }
#line 687
  if (tmp) {
#line 687
    tmp___0 = 1;
  } else
#line 687
  if (in == 42) {
#line 687
    tmp___0 = 1;
  } else
#line 687
  if (in == 37) {
#line 687
    tmp___0 = 1;
  } else
#line 687
  if (in == 47) {
#line 687
    tmp___0 = 1;
  } else {
#line 687
    tmp___0 = 0;
  }
#line 687
  return (tmp___0);
}
}
#line 691 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_is_starwhitis_ordot(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 692
  tmp = csv2_is_text(in);
  }
#line 692
  if (tmp) {
#line 692
    tmp___0 = 1;
  } else
#line 692
  if (in == 42) {
#line 692
    tmp___0 = 1;
  } else
#line 692
  if (in == 37) {
#line 692
    tmp___0 = 1;
  } else
#line 692
  if (in == 46) {
#line 692
    tmp___0 = 1;
  } else {
#line 692
    tmp___0 = 0;
  }
#line 692
  return (tmp___0);
}
}
#line 701 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *process_number(csv2_read *stream ) 
{ 
  js_string *tmp ;

  {
  {
#line 702
  tmp = process_something(stream, & csv2_is_number);
  }
#line 702
  return (tmp);
}
}
#line 709 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *process_textlabel(csv2_read *stream ) 
{ 
  js_string *tmp ;

  {
  {
#line 710
  tmp = process_something(stream, & csv2_is_text);
  }
#line 710
  return (tmp);
}
}
#line 724 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *process_dname(csv2_read *stream , int starwhitis ) 
{ 
  js_string *o ;
  js_string *ret ;

  {
  {
#line 730
  o = process_1stchar(stream, & csv2_is_starwhitis_ordot, (char *)"Z");
  }
#line 731
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 732
    return ((js_string *)0);
  } else
#line 731
  if ((unsigned long )o->string == (unsigned long )((unsigned char *)0)) {
#line 732
    return ((js_string *)0);
  }
  {
#line 735
  ret = js_append_dname(o, stream, starwhitis);
  }
#line 736
  if ((unsigned long )ret == (unsigned long )((js_string *)0)) {
#line 737
    return ((js_string *)0);
  }
#line 740
  if (o->unit_count > 1U) {
#line 740
    if ((int )*(o->string + 1) == 46) {
#line 740
      if (o->unit_count != 2U) {
        {
#line 741
        csv2_error(stream, (char *)"Dot can only be at beginning of hostname for root (\'.\') hostname");
        }
#line 743
        return ((js_string *)0);
      }
    }
  }
#line 746
  if (o->unit_count == 2U) {
#line 746
    if ((int )*(o->string + 1) == 46) {
#line 747
      return (o);
    }
  }
#line 749
  return (ret);
}
}
#line 766 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *js_append_dname(js_string *o , csv2_read *stream , int starwhitis ) 
{ 
  int x ;
  int32_t look ;
  int state ;
  int32_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int32_t tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;

  {
  {
#line 769
  state = 1;
#line 770
  look = csv2_justread(stream);
  }
#line 773
  if (look == 37) {
#line 773
    if (starwhitis != 4) {
#line 773
      if (starwhitis != 5) {
#line 773
        goto _L;
      } else {
#line 773
        goto _L___1;
      }
    } else {
#line 773
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 773
  if (look == 46) {
    _L: /* CIL Label */ 
    {
#line 775
    tmp = csv2_read_unicode(stream);
    }
#line 775
    if (tmp == -164) {
      {
#line 776
      js_destroy(o);
      }
#line 777
      return ((js_string *)0);
    }
#line 779
    return (o);
  } else
#line 780
  if (look == 37) {
#line 780
    if (starwhitis == 4) {
      {
#line 781
      csv2_error(stream, (char *)"\'%\' character not allowed");
#line 782
      js_destroy(o);
      }
#line 783
      return ((js_string *)0);
    } else
#line 780
    if (starwhitis == 5) {
      {
#line 781
      csv2_error(stream, (char *)"\'%\' character not allowed");
#line 782
      js_destroy(o);
      }
#line 783
      return ((js_string *)0);
    }
  }
#line 791
  if (starwhitis != 0) {
#line 791
    if (starwhitis != 5) {
      {
#line 792
      tmp___0 = csv2_is_dname(look);
      }
#line 792
      if (tmp___0) {
#line 793
        state = 1;
      } else
#line 795
      if (look == 42) {
#line 796
        if (starwhitis == 0) {
          {
#line 798
          csv2_error(stream, (char *)"\'*\' character not allowed");
#line 799
          js_destroy(o);
          }
#line 800
          return ((js_string *)0);
        } else
#line 796
        if (starwhitis == 3) {
          {
#line 798
          csv2_error(stream, (char *)"\'*\' character not allowed");
#line 799
          js_destroy(o);
          }
#line 800
          return ((js_string *)0);
        } else
#line 796
        if (starwhitis == 4) {
          {
#line 798
          csv2_error(stream, (char *)"\'*\' character not allowed");
#line 799
          js_destroy(o);
          }
#line 800
          return ((js_string *)0);
        } else
#line 796
        if (starwhitis == 5) {
          {
#line 798
          csv2_error(stream, (char *)"\'*\' character not allowed");
#line 799
          js_destroy(o);
          }
#line 800
          return ((js_string *)0);
        }
#line 802
        state = 2;
      } else {
        {
#line 805
        csv2_error(stream, (char *)"Unexpected character");
#line 806
        js_destroy(o);
        }
#line 807
        return ((js_string *)0);
      }
    } else {
#line 810
      state = 0;
    }
  } else {
#line 810
    state = 0;
  }
#line 814
  x = 0;
  {
#line 814
  while (1) {
    while_continue: /* CIL Label */ ;
#line 814
    if (! (x < 10000)) {
#line 814
      goto while_break;
    }
    {
#line 815
    look = csv2_read_unicode(stream);
    }
#line 816
    if (look == -164) {
      {
#line 817
      js_destroy(o);
      }
#line 818
      return ((js_string *)0);
    }
#line 824
    if (look == 46) {
#line 824
      if (state == 1) {
        {
#line 825
        state = 0;
#line 829
        tmp___1 = csv2_append_utf8(o, '.');
        }
#line 829
        if (tmp___1 < 0) {
          {
#line 830
          csv2_error(stream, (char *)"Error appending character");
#line 831
          js_destroy(o);
          }
#line 832
          return ((js_string *)0);
        }
      } else {
#line 824
        goto _L___17;
      }
    } else
    _L___17: /* CIL Label */ 
#line 835
    if (state == 1) {
      {
#line 835
      tmp___13 = csv2_is_dname(look);
      }
#line 835
      if (tmp___13) {
        {
#line 836
        tmp___2 = csv2_append_utf8(o, look);
        }
#line 836
        if (tmp___2 < 0) {
          {
#line 837
          csv2_error(stream, (char *)"Error appending character");
#line 838
          js_destroy(o);
          }
#line 839
          return ((js_string *)0);
        }
      } else {
#line 835
        goto _L___16;
      }
    } else
    _L___16: /* CIL Label */ 
#line 847
    if (look == 35) {
#line 847
      if (state == 0) {
#line 847
        if (x > 0) {
          {
#line 848
          process_comment(stream);
          }
#line 849
          return (o);
        } else {
#line 847
          goto _L___15;
        }
      } else {
#line 847
        goto _L___15;
      }
    } else
    _L___15: /* CIL Label */ 
#line 852
    if (state == 0) {
#line 852
      if (look == 37) {
#line 852
        if (starwhitis != 4) {
#line 852
          if (starwhitis != 5) {
            {
#line 854
            tmp___3 = csv2_append_utf8(o, look);
            }
#line 854
            if (tmp___3 < 0) {
              {
#line 855
              csv2_error(stream, (char *)"Error appending character");
#line 856
              js_destroy(o);
              }
#line 857
              return ((js_string *)0);
            }
            {
#line 863
            tmp___4 = csv2_read_unicode(stream);
            }
#line 863
            if (tmp___4 == -164) {
              {
#line 864
              js_destroy(o);
              }
#line 865
              return ((js_string *)0);
            }
#line 867
            return (o);
          } else {
#line 852
            goto _L___13;
          }
        } else {
#line 852
          goto _L___13;
        }
      } else {
#line 852
        goto _L___13;
      }
    } else
    _L___13: /* CIL Label */ 
#line 872
    if (state == 0) {
      {
#line 872
      tmp___12 = csv2_is_dname(look);
      }
#line 872
      if (tmp___12) {
        {
#line 873
        state = 1;
#line 874
        tmp___5 = csv2_append_utf8(o, look);
        }
#line 874
        if (tmp___5 < 0) {
          {
#line 875
          csv2_error(stream, (char *)"Error appending character");
#line 876
          js_destroy(o);
          }
#line 877
          return ((js_string *)0);
        }
      } else {
#line 872
        goto _L___10;
      }
    } else
    _L___10: /* CIL Label */ 
#line 883
    if (state == 0) {
#line 883
      if (starwhitis == 2) {
#line 883
        if (look == 42) {
          {
#line 885
          state = 3;
#line 886
          tmp___6 = csv2_append_utf8(o, look);
          }
#line 886
          if (tmp___6 < 0) {
            {
#line 887
            csv2_error(stream, (char *)"Error appending character");
#line 888
            js_destroy(o);
            }
#line 889
            return ((js_string *)0);
          }
        } else {
#line 883
          goto _L___9;
        }
      } else {
#line 883
        goto _L___9;
      }
    } else
    _L___9: /* CIL Label */ 
#line 893
    if (state == 0) {
      {
#line 893
      tmp___11 = csv2_is_delimiter(look);
      }
#line 893
      if (tmp___11) {
#line 894
        return (o);
      } else {
#line 893
        goto _L___7;
      }
    } else
    _L___7: /* CIL Label */ 
#line 900
    if (state == 2) {
#line 900
      if (look == 46) {
        {
#line 901
        state = 0;
#line 902
        tmp___7 = csv2_append_utf8(o, look);
        }
#line 902
        if (tmp___7 < 0) {
          {
#line 903
          csv2_error(stream, (char *)"Error appending character");
#line 904
          js_destroy(o);
          }
#line 905
          return ((js_string *)0);
        }
      } else {
#line 900
        goto _L___6;
      }
    } else
    _L___6: /* CIL Label */ 
#line 909
    if (state == 2) {
      {
#line 909
      tmp___10 = csv2_is_delimiter(look);
      }
#line 909
      if (tmp___10) {
#line 909
        if (starwhitis == 2) {
#line 911
          return (o);
        } else {
#line 909
          goto _L___5;
        }
      } else {
#line 909
        goto _L___5;
      }
    } else
    _L___5: /* CIL Label */ 
#line 917
    if (state == 3) {
      {
#line 917
      tmp___9 = csv2_is_delimiter(look);
      }
#line 917
      if (tmp___9) {
#line 919
        return (o);
      } else {
#line 917
        goto _L___3;
      }
    } else
    _L___3: /* CIL Label */ 
#line 922
    if (look == 35) {
#line 922
      if (state == 3) {
        {
#line 923
        process_comment(stream);
        }
#line 924
        return (o);
      } else {
#line 922
        goto _L___2;
      }
    } else {
      _L___2: /* CIL Label */ 
      {
#line 926
      tmp___8 = csv2_is_delimiter(look);
      }
#line 926
      if (tmp___8) {
        {
#line 927
        csv2_error(stream, (char *)"Improper termination of label\nLabel must end with \'.\' or \'%\' (A \'*\' is allowed in csv2_default_zonefile)");
#line 929
        js_destroy(o);
        }
#line 930
        return ((js_string *)0);
      } else {
        {
#line 933
        csv2_error(stream, (char *)"Unexpected character");
#line 934
        js_destroy(o);
        }
#line 935
        return ((js_string *)0);
      }
    }
#line 814
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 938
  js_destroy(o);
  }
#line 939
  return ((js_string *)0);
}
}
#line 944 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_convert_percent(js_string *in , js_string *psub ) 
{ 
  int tmp ;

  {
#line 946
  if (in->unit_size != 1U) {
#line 947
    return ((js_string *)0);
  }
#line 951
  if (in->unit_count >= 1U) {
#line 951
    if ((int )*((in->string + in->unit_count) - 1) == 37) {
      {
#line 953
      (in->unit_count) --;
#line 954
      tmp = js_append(psub, in);
      }
#line 954
      if (tmp == -1) {
#line 955
        return ((js_string *)0);
      }
    }
  }
#line 959
  return (in);
}
}
#line 972 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_hostname(csv2_read *stream , js_string *zonename , int starwhitis ) 
{ 
  js_string *out ;
  js_string *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 975
  out = process_dname(stream, starwhitis);
  }
#line 975
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 976
    return ((js_string *)0);
  }
  {
#line 980
  tmp = csv2_convert_percent(out, zonename);
  }
#line 980
  if ((unsigned long )tmp == (unsigned long )((js_string *)0)) {
    {
#line 981
    js_destroy(out);
    }
#line 982
    return ((js_string *)0);
  }
#line 986
  if (starwhitis == 2) {
    {
#line 987
    tmp___0 = hname_2rfc1035_starwhitis(out, 1);
    }
#line 987
    if (tmp___0 < 0) {
      {
#line 988
      js_destroy(out);
      }
#line 989
      return ((js_string *)0);
    }
  } else {
    {
#line 992
    tmp___1 = hname_2rfc1035_starwhitis(out, 0);
    }
#line 992
    if (tmp___1 < 0) {
      {
#line 993
      js_destroy(out);
      }
#line 994
      return ((js_string *)0);
    }
  }
  {
#line 1001
  tmp___2 = starrecord_to_meta(out, 0);
  }
#line 1001
  if (tmp___2 == -1) {
    {
#line 1002
    js_destroy(out);
    }
#line 1003
    return ((js_string *)0);
  }
#line 1006
  return (out);
}
}
#line 1014 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_numeric_rtype(js_string *text_rtype ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;

  {
  {
#line 1017
  js_set_encode(text_rtype, 2);
#line 1018
  tmp = js_tolower(text_rtype);
  }
#line 1018
  if (tmp == -1) {
#line 1019
    return (-1);
  }
  {
#line 1022
  tmp___0 = js_qissame((char *)"in", text_rtype);
  }
#line 1022
  if (tmp___0 == 1) {
#line 1023
    return (-2);
  }
  {
#line 1025
  tmp___1 = js_qissame((char *)"raw", text_rtype);
  }
#line 1025
  if (tmp___1 == 1) {
#line 1026
    return (-3);
  }
  {
#line 1028
  tmp___2 = js_qissame((char *)"a", text_rtype);
  }
#line 1028
  if (tmp___2 == 1) {
#line 1029
    return (1);
  }
  {
#line 1031
  tmp___3 = js_qissame((char *)"ns", text_rtype);
  }
#line 1031
  if (tmp___3 == 1) {
#line 1032
    return (2);
  }
  {
#line 1034
  tmp___4 = js_qissame((char *)"cname", text_rtype);
  }
#line 1034
  if (tmp___4 == 1) {
#line 1035
    return (5);
  }
  {
#line 1037
  tmp___5 = js_qissame((char *)"soa", text_rtype);
  }
#line 1037
  if (tmp___5 == 1) {
#line 1038
    return (6);
  }
  {
#line 1040
  tmp___6 = js_qissame((char *)"ptr", text_rtype);
  }
#line 1040
  if (tmp___6 == 1) {
#line 1041
    return (12);
  }
  {
#line 1043
  tmp___7 = js_qissame((char *)"mx", text_rtype);
  }
#line 1043
  if (tmp___7 == 1) {
#line 1044
    return (15);
  }
  {
#line 1046
  tmp___8 = js_qissame((char *)"aaaa", text_rtype);
  }
#line 1046
  if (tmp___8 == 1) {
#line 1047
    return (28);
  }
  {
#line 1049
  tmp___9 = js_qissame((char *)"srv", text_rtype);
  }
#line 1049
  if (tmp___9 == 1) {
#line 1050
    return (33);
  }
  {
#line 1052
  tmp___10 = js_qissame((char *)"txt", text_rtype);
  }
#line 1052
  if (tmp___10 == 1) {
#line 1053
    return (16);
  }
  {
#line 1055
  tmp___11 = js_qissame((char *)"spf", text_rtype);
  }
#line 1055
  if (tmp___11 == 1) {
#line 1056
    return (99);
  }
  {
#line 1058
  tmp___12 = js_qissame((char *)"fqdn4", text_rtype);
  }
#line 1058
  if (tmp___12 == 1) {
#line 1059
    return (65765);
  }
  {
#line 1062
  tmp___13 = js_qissame((char *)"fqdn6", text_rtype);
  }
#line 1062
  if (tmp___13 == 1) {
#line 1063
    return (65766);
  }
  {
#line 1068
  tmp___14 = js_qissame((char *)"hinfo", text_rtype);
  }
#line 1068
  if (tmp___14 == 1) {
#line 1069
    return (13);
  }
  {
#line 1071
  tmp___15 = js_qissame((char *)"wks", text_rtype);
  }
#line 1071
  if (tmp___15 == 1) {
#line 1072
    return (11);
  }
  {
#line 1074
  tmp___16 = js_qissame((char *)"mb", text_rtype);
  }
#line 1074
  if (tmp___16 == 1) {
#line 1075
    return (7);
  }
  {
#line 1077
  tmp___17 = js_qissame((char *)"md", text_rtype);
  }
#line 1077
  if (tmp___17 == 1) {
#line 1078
    return (3);
  }
  {
#line 1080
  tmp___18 = js_qissame((char *)"mf", text_rtype);
  }
#line 1080
  if (tmp___18 == 1) {
#line 1081
    return (4);
  }
  {
#line 1083
  tmp___19 = js_qissame((char *)"mg", text_rtype);
  }
#line 1083
  if (tmp___19 == 1) {
#line 1084
    return (8);
  }
  {
#line 1086
  tmp___20 = js_qissame((char *)"mr", text_rtype);
  }
#line 1086
  if (tmp___20 == 1) {
#line 1087
    return (9);
  }
  {
#line 1089
  tmp___21 = js_qissame((char *)"minfo", text_rtype);
  }
#line 1089
  if (tmp___21 == 1) {
#line 1090
    return (14);
  }
  {
#line 1093
  tmp___22 = js_qissame((char *)"afsdb", text_rtype);
  }
#line 1093
  if (tmp___22 == 1) {
#line 1094
    return (18);
  }
  {
#line 1096
  tmp___23 = js_qissame((char *)"rp", text_rtype);
  }
#line 1096
  if (tmp___23 == 1) {
#line 1097
    return (17);
  }
  {
#line 1099
  tmp___24 = js_qissame((char *)"x25", text_rtype);
  }
#line 1099
  if (tmp___24 == 1) {
#line 1100
    return (19);
  }
  {
#line 1102
  tmp___25 = js_qissame((char *)"isdn", text_rtype);
  }
#line 1102
  if (tmp___25 == 1) {
#line 1103
    return (20);
  }
  {
#line 1105
  tmp___26 = js_qissame((char *)"rt", text_rtype);
  }
#line 1105
  if (tmp___26 == 1) {
#line 1106
    return (21);
  }
  {
#line 1109
  tmp___27 = js_qissame((char *)"nsap", text_rtype);
  }
#line 1109
  if (tmp___27 == 1) {
#line 1110
    return (22);
  }
  {
#line 1112
  tmp___28 = js_qissame((char *)"nsap-ptr", text_rtype);
  }
#line 1112
  if (tmp___28 == 1) {
#line 1113
    return (23);
  }
  {
#line 1116
  tmp___29 = js_qissame((char *)"px", text_rtype);
  }
#line 1116
  if (tmp___29 == 1) {
#line 1117
    return (26);
  }
  {
#line 1120
  tmp___30 = js_qissame((char *)"gpos", text_rtype);
  }
#line 1120
  if (tmp___30 == 1) {
#line 1121
    return (27);
  }
  {
#line 1124
  tmp___31 = js_qissame((char *)"loc", text_rtype);
  }
#line 1124
  if (tmp___31 == 1) {
#line 1125
    return (29);
  }
  {
#line 1128
  tmp___32 = js_qissame((char *)"naptr", text_rtype);
  }
#line 1128
  if (tmp___32 == 1) {
#line 1129
    return (35);
  }
#line 1131
  return (-1);
}
}
#line 1135 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int32_t csv2_get_rtype(csv2_read *stream ) 
{ 
  js_string *r ;
  int32_t ret ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 1139
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1140
    tmp = csv2_get_1st(stream, & csv2_is_alpha, 0);
    }
#line 1140
    if (tmp != 1) {
#line 1141
      return (-1);
    }
    {
#line 1143
    r = process_textlabel(stream);
    }
#line 1143
    if ((unsigned long )r == (unsigned long )((js_string *)0)) {
#line 1144
      return (-1);
    }
    {
#line 1146
    ret = csv2_numeric_rtype(r);
#line 1147
    js_destroy(r);
    }
#line 1149
    if (ret == -3) {
      {
#line 1150
      tmp___0 = csv2_get_1st(stream, & csv2_is_number, 0);
      }
#line 1150
      if (tmp___0 < 0) {
        {
#line 1151
        csv2_error(stream, (char *)"RAW rr not followed by number");
        }
#line 1153
        return (-1);
      }
      {
#line 1155
      ret = csv2_get_num(stream);
      }
#line 1156
      if (ret < 0) {
#line 1157
        return (-1);
      }
#line 1159
      ret += 100000;
#line 1160
      return (ret);
    }
#line 1162
    if (ret == -1) {
#line 1163
      return (-1);
    } else
#line 1162
    if (ret == 0) {
#line 1163
      return (-1);
    }
#line 1139
    if (ret <= -2) {
#line 1139
      if (! (ret >= -11)) {
#line 1139
        goto while_break;
      }
    } else {
#line 1139
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1168
  return (ret);
}
}
#line 1173 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int32_t csv2_get_num(csv2_read *stream ) 
{ 
  js_string *num ;
  int32_t ret ;
  int tmp ;
  int32_t tmp___0 ;
  int32_t tmp___1 ;
  int32_t tmp___2 ;
  int32_t tmp___3 ;
  int32_t tmp___4 ;
  int32_t tmp___5 ;
  int32_t tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  unsigned int tmp___9 ;

  {
  {
#line 1177
  tmp = csv2_get_1st(stream, & csv2_is_number_orslash, 0);
  }
#line 1177
  if (tmp != 1) {
#line 1178
    return (-1);
  }
  {
#line 1182
  tmp___8 = csv2_justread(stream);
  }
#line 1182
  if (tmp___8 == 47) {
    {
#line 1183
    tmp___0 = csv2_read_unicode(stream);
    }
#line 1183
    if (tmp___0 != 115) {
#line 1184
      return (-1);
    }
    {
#line 1186
    tmp___1 = csv2_read_unicode(stream);
    }
#line 1186
    if (tmp___1 != 101) {
#line 1187
      return (-1);
    }
    {
#line 1189
    tmp___2 = csv2_read_unicode(stream);
    }
#line 1189
    if (tmp___2 != 114) {
#line 1190
      return (-1);
    }
    {
#line 1192
    tmp___3 = csv2_read_unicode(stream);
    }
#line 1192
    if (tmp___3 != 105) {
#line 1193
      return (-1);
    }
    {
#line 1195
    tmp___4 = csv2_read_unicode(stream);
    }
#line 1195
    if (tmp___4 != 97) {
#line 1196
      return (-1);
    }
    {
#line 1198
    tmp___5 = csv2_read_unicode(stream);
    }
#line 1198
    if (tmp___5 != 108) {
#line 1199
      return (-1);
    }
    {
#line 1201
    tmp___6 = csv2_read_unicode(stream);
#line 1201
    tmp___7 = csv2_is_delimiter(tmp___6);
    }
#line 1201
    if (! tmp___7) {
#line 1202
      return (-1);
    }
#line 1204
    return (-2);
  }
  {
#line 1207
  num = process_number(stream);
  }
#line 1207
  if ((unsigned long )num == (unsigned long )((js_string *)0)) {
#line 1208
    return (-1);
  }
#line 1211
  if ((int )*(num->string) == 48) {
#line 1211
    if (num->unit_count == 1U) {
      {
#line 1212
      js_destroy(num);
      }
#line 1213
      return (0);
    }
  }
  {
#line 1215
  tmp___9 = js_atoi(num, 0);
#line 1215
  ret = (int32_t )tmp___9;
  }
#line 1215
  if (ret == 0) {
    {
#line 1216
    js_destroy(num);
    }
#line 1217
    return (-1);
  }
  {
#line 1219
  js_destroy(num);
  }
#line 1220
  return (ret);
}
}
#line 1229 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_something(csv2_read *stream , int (*is_ok)(int32_t in ) ) 
{ 
  js_string *o ;
  int tmp ;

  {
  {
#line 1232
  tmp = csv2_get_1st(stream, is_ok, 0);
  }
#line 1232
  if (tmp != 1) {
#line 1233
    return ((js_string *)0);
  }
  {
#line 1236
  o = process_something(stream, is_ok);
  }
#line 1236
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 1237
    return ((js_string *)0);
  }
#line 1240
  return (o);
}
}
#line 1244 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_filename(csv2_read *stream ) 
{ 
  js_string *tmp ;

  {
  {
#line 1245
  tmp = csv2_get_something(stream, & csv2_is_fchar);
  }
#line 1245
  return (tmp);
}
}
#line 1252 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_dname(csv2_read *stream ) 
{ 
  int tmp ;
  js_string *tmp___0 ;

  {
  {
#line 1256
  tmp = csv2_get_1st(stream, & csv2_is_text, 0);
  }
#line 1256
  if (tmp != 1) {
#line 1257
    return ((js_string *)0);
  }
  {
#line 1260
  tmp___0 = csv2_get_hostname(stream, (js_string *)0, 1);
  }
#line 1260
  return (tmp___0);
}
}
#line 1269 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_mx(csv2_read *stream , js_string *zone , int pref ) 
{ 
  js_string *out ;
  int num ;
  int hlabels ;
  int tmp ;
  js_string *name ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 1272
  hlabels = 1;
#line 1275
  if (pref < 0) {
    {
#line 1276
    num = csv2_get_num(stream);
    }
#line 1276
    if (num < 0) {
#line 1277
      return ((js_string *)0);
    }
  } else {
#line 1280
    num = pref;
  }
  {
#line 1282
  out = js_create(256U, 1U);
  }
#line 1282
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 1283
    return ((js_string *)0);
  }
  {
#line 1285
  tmp = js_adduint16(out, num);
  }
#line 1285
  if (tmp == -1) {
    {
#line 1286
    js_destroy(out);
    }
#line 1287
    return ((js_string *)0);
  }
#line 1290
  if (pref == -2) {
#line 1291
    hlabels = 2;
  }
  {
#line 1295
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1295
    if (! (hlabels > 0)) {
#line 1295
      goto while_break;
    }
    {
#line 1297
    tmp___0 = csv2_get_1st(stream, & csv2_is_dchar, 0);
    }
#line 1297
    if (tmp___0 != 1) {
      {
#line 1298
      js_destroy(out);
      }
#line 1299
      return ((js_string *)0);
    }
    {
#line 1301
    name = csv2_get_hostname(stream, zone, 3);
    }
#line 1301
    if ((unsigned long )name == (unsigned long )((js_string *)0)) {
      {
#line 1302
      js_destroy(out);
      }
#line 1303
      return ((js_string *)0);
    }
    {
#line 1305
    tmp___1 = js_append(name, out);
    }
#line 1305
    if (tmp___1 == -1) {
      {
#line 1306
      js_destroy(name);
#line 1307
      js_destroy(out);
      }
#line 1308
      return ((js_string *)0);
    }
    {
#line 1310
    js_destroy(name);
#line 1311
    hlabels --;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1314
  return (out);
}
}
#line 1320 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
js_string *csv2_get_srv(csv2_read *stream , js_string *zone ) 
{ 
  js_string *out ;
  js_string *name ;
  int num ;
  int c ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 1325
  out = js_create(256U, 1U);
  }
#line 1325
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 1326
    return ((js_string *)0);
  }
#line 1330
  c = 1;
  {
#line 1330
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1330
    if (! (c <= 3)) {
#line 1330
      goto while_break;
    }
    {
#line 1331
    num = csv2_get_num(stream);
    }
#line 1331
    if (num < 0) {
      {
#line 1332
      js_destroy(out);
      }
#line 1333
      return ((js_string *)0);
    }
    {
#line 1335
    tmp = js_adduint16(out, num);
    }
#line 1335
    if (tmp == -1) {
      {
#line 1336
      js_destroy(out);
      }
#line 1337
      return ((js_string *)0);
    }
#line 1330
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1342
  tmp___0 = csv2_get_1st(stream, & csv2_is_dchar, 0);
  }
#line 1342
  if (tmp___0 != 1) {
    {
#line 1343
    js_destroy(out);
    }
#line 1344
    return ((js_string *)0);
  }
  {
#line 1346
  name = csv2_get_hostname(stream, zone, 3);
  }
#line 1346
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
    {
#line 1347
    js_destroy(out);
    }
#line 1348
    return ((js_string *)0);
  }
  {
#line 1350
  tmp___1 = js_append(name, out);
  }
#line 1350
  if (tmp___1 == -1) {
    {
#line 1351
    js_destroy(name);
#line 1352
    js_destroy(out);
    }
#line 1353
    return ((js_string *)0);
  }
  {
#line 1356
  js_destroy(name);
  }
#line 1357
  return (out);
}
}
#line 1366 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_parse.c"
int csv2_read_rr(csv2_add_state *state , csv2_read *stream , int32_t starwhitis ) 
{ 
  js_string *name ;
  js_string *rddata ;
  js_string *zone ;
  int32_t ttl ;
  int32_t rtype ;
  int q ;
  int slash_command ;
  int32_t look ;
  int32_t cmd ;
  int newttl ;
  js_string *n ;
  int32_t tmp ;
  int32_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  js_string *tmp___3 ;
  js_string *n___0 ;
  csv2_origin *c ;
  csv2_origin *o ;
  int32_t tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  js_string *tmp___7 ;
  void *tmp___8 ;
  csv2_origin *o___0 ;
  int tmp___9 ;
  js_string *filename ;
  int rc ;
  int fc ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int32_t tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;

  {
#line 1367
  name = (js_string *)0;
#line 1367
  rddata = (js_string *)0;
#line 1368
  zone = (js_string *)0;
#line 1369
  ttl = 86400;
#line 1372
  slash_command = 0;
#line 1375
  if ((unsigned long )state->bighash == (unsigned long )((mhash *)0)) {
#line 1375
    if (state->add_method == 1) {
#line 1376
      return (-1);
    }
  }
#line 1378
  if ((unsigned long )state->zone == (unsigned long )((js_string *)0)) {
#line 1379
    return (-1);
  }
#line 1381
  if ((unsigned long )state->origin == (unsigned long )((js_string *)0)) {
#line 1382
    return (-1);
  }
#line 1385
  zone = state->origin;
  {
#line 1392
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1393
    slash_command = 0;
#line 1397
    q = csv2_get_1st(stream, & csv2_is_starwhitis_orslash, 1);
    }
#line 1399
    if (q == -2) {
#line 1400
      return (-2);
    }
#line 1403
    if (q == -1) {
#line 1404
      return (-1);
    }
    {
#line 1409
    tmp___12 = csv2_justread(stream);
    }
#line 1409
    if (tmp___12 == 47) {
      {
#line 1411
      slash_command = 1;
#line 1412
      look = csv2_read_unicode(stream);
      }
#line 1413
      if (look == 116) {
#line 1414
        cmd = 1;
      } else
#line 1415
      if (look == 111) {
#line 1416
        cmd = 2;
      } else
#line 1417
      if (look == 114) {
#line 1418
        cmd = 5;
      } else {
        {
#line 1420
        csv2_error(stream, (char *)"Invalid slash command");
        }
#line 1421
        return (-1);
      }
      {
#line 1424
      look = csv2_read_unicode(stream);
      }
#line 1425
      if (cmd == 2) {
#line 1425
        if (look == 112) {
#line 1426
          cmd = 3;
        } else {
#line 1425
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 1427
      if (cmd == 1) {
#line 1427
        if (look != 116) {
          {
#line 1429
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1430
          return (-1);
        } else {
#line 1427
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 1427
      if (cmd == 2) {
#line 1427
        if (look != 114) {
          {
#line 1429
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1430
          return (-1);
        } else {
#line 1427
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 1427
      if (cmd == 5) {
#line 1427
        if (look != 101) {
          {
#line 1429
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1430
          return (-1);
        }
      }
      {
#line 1433
      look = csv2_read_unicode(stream);
      }
#line 1434
      if (cmd == 3) {
#line 1434
        if (look == 111) {
#line 1435
          cmd = 4;
        } else {
#line 1434
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 1436
      if (cmd == 1) {
#line 1436
        if (look != 108) {
          {
#line 1439
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1440
          return (-1);
        } else {
#line 1436
          goto _L___4;
        }
      } else
      _L___4: /* CIL Label */ 
#line 1436
      if (cmd == 2) {
#line 1436
        if (look != 105) {
          {
#line 1439
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1440
          return (-1);
        } else {
#line 1436
          goto _L___3;
        }
      } else
      _L___3: /* CIL Label */ 
#line 1436
      if (cmd == 3) {
#line 1436
        if (look != 117) {
          {
#line 1439
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1440
          return (-1);
        } else {
#line 1436
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 1436
      if (cmd == 5) {
#line 1436
        if (look != 97) {
          {
#line 1439
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1440
          return (-1);
        }
      }
      {
#line 1443
      look = csv2_read_unicode(stream);
      }
#line 1444
      if (cmd == 1) {
        {
#line 1444
        tmp___11 = csv2_is_delimiter(look);
        }
#line 1444
        if (tmp___11) {
          {
#line 1446
          newttl = csv2_get_num(stream);
          }
#line 1447
          if (newttl < 0) {
            {
#line 1448
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1450
            return (-1);
          }
#line 1452
          state->default_ttl = newttl;
        } else {
#line 1444
          goto _L___9;
        }
      } else
      _L___9: /* CIL Label */ 
#line 1453
      if (cmd == 2) {
#line 1453
        if (look == 103) {
          {
#line 1455
          tmp = csv2_read_unicode(stream);
          }
#line 1455
          if (tmp != 105) {
            {
#line 1456
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1458
            return (-1);
          }
          {
#line 1460
          tmp___0 = csv2_read_unicode(stream);
          }
#line 1460
          if (tmp___0 != 110) {
            {
#line 1461
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1463
            return (-1);
          }
          {
#line 1465
          look = csv2_read_unicode(stream);
#line 1466
          tmp___1 = csv2_is_delimiter(look);
          }
#line 1466
          if (! tmp___1) {
            {
#line 1467
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1469
            return (-1);
          }
          {
#line 1471
          tmp___2 = csv2_get_1st(stream, & csv2_is_dchar, 0);
          }
#line 1471
          if (tmp___2 != 1) {
            {
#line 1473
            csv2_error(stream, (char *)"Invalid argument for /origin");
            }
#line 1475
            return (-1);
          }
          {
#line 1477
          n = process_1stchar(stream, & csv2_is_starwhitis, (char *)0);
          }
#line 1479
          if ((unsigned long )n == (unsigned long )((js_string *)0)) {
            {
#line 1480
            csv2_error(stream, (char *)"Error processing /origin");
            }
#line 1482
            return (-1);
          }
          {
#line 1484
          n = js_append_dname(n, stream, 3);
          }
#line 1485
          if ((unsigned long )n == (unsigned long )((js_string *)0)) {
            {
#line 1486
            csv2_error(stream, (char *)"Invalid argument for /origin");
            }
#line 1488
            return (-1);
          }
          {
#line 1490
          tmp___3 = csv2_convert_percent(n, state->origin);
          }
#line 1490
          if ((unsigned long )tmp___3 == (unsigned long )((js_string *)0)) {
            {
#line 1492
            csv2_error(stream, (char *)"Problem running convert_percent");
            }
#line 1494
            return (-1);
          }
          {
#line 1496
          js_destroy(state->origin);
#line 1497
          state->origin = n;
#line 1498
          zone = n;
          }
        } else {
#line 1453
          goto _L___8;
        }
      } else
      _L___8: /* CIL Label */ 
#line 1499
      if (cmd == 3) {
#line 1499
        if (look == 115) {
          {
#line 1502
          tmp___4 = csv2_read_unicode(stream);
          }
#line 1502
          if (tmp___4 != 104) {
            {
#line 1503
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1505
            return (-1);
          }
          {
#line 1507
          look = csv2_read_unicode(stream);
#line 1508
          tmp___5 = csv2_is_delimiter(look);
          }
#line 1508
          if (! tmp___5) {
            {
#line 1509
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1511
            return (-1);
          }
          {
#line 1513
          tmp___6 = csv2_get_1st(stream, & csv2_is_dchar, 0);
          }
#line 1513
          if (tmp___6 != 1) {
            {
#line 1515
            csv2_error(stream, (char *)"Invalid argument for /opush");
            }
#line 1517
            return (-1);
          }
          {
#line 1519
          n___0 = process_1stchar(stream, & csv2_is_starwhitis, (char *)0);
          }
#line 1521
          if ((unsigned long )n___0 == (unsigned long )((js_string *)0)) {
            {
#line 1522
            csv2_error(stream, (char *)"Error processing /opush");
            }
#line 1524
            return (-1);
          }
          {
#line 1526
          n___0 = js_append_dname(n___0, stream, 3);
          }
#line 1527
          if ((unsigned long )n___0 == (unsigned long )((js_string *)0)) {
            {
#line 1528
            csv2_error(stream, (char *)"Invalid argument for /opush");
            }
#line 1530
            return (-1);
          }
          {
#line 1532
          tmp___7 = csv2_convert_percent(n___0, state->origin);
          }
#line 1532
          if ((unsigned long )tmp___7 == (unsigned long )((js_string *)0)) {
            {
#line 1534
            csv2_error(stream, (char *)"Problem running convert_percent");
            }
#line 1536
            return (-1);
          }
#line 1539
          if (state->ostack_height > 7) {
            {
#line 1541
            csv2_error(stream, (char *)"origin stack too high");
            }
#line 1543
            return (-1);
          } else
#line 1539
          if (state->ostack_height < 0) {
            {
#line 1541
            csv2_error(stream, (char *)"origin stack too high");
            }
#line 1543
            return (-1);
          }
          {
#line 1548
          (state->ostack_height) ++;
#line 1549
          o = state->ostack;
#line 1550
          tmp___8 = js_alloc(1, (int )sizeof(csv2_origin ));
#line 1550
          c = (csv2_origin *)tmp___8;
          }
#line 1551
          if ((unsigned long )c == (unsigned long )((csv2_origin *)0)) {
            {
#line 1552
            csv2_error(stream, (char *)"js_alloc error");
            }
#line 1554
            return (-1);
          }
#line 1556
          c->origin = state->origin;
#line 1557
          c->next = o;
#line 1558
          state->ostack = c;
#line 1559
          state->origin = n___0;
#line 1560
          zone = state->origin;
        } else {
#line 1499
          goto _L___7;
        }
      } else
      _L___7: /* CIL Label */ 
#line 1561
      if (cmd == 4) {
#line 1561
        if (look == 112) {
          {
#line 1563
          look = csv2_read_unicode(stream);
#line 1564
          tmp___9 = csv2_is_delimiter(look);
          }
#line 1564
          if (! tmp___9) {
            {
#line 1565
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1567
            return (-1);
          }
#line 1569
          if (state->ostack_height < 1) {
            {
#line 1571
            csv2_error(stream, (char *)"origin stack too low");
            }
#line 1573
            return (-1);
          } else
#line 1569
          if (state->ostack_height > 8) {
            {
#line 1571
            csv2_error(stream, (char *)"origin stack too low");
            }
#line 1573
            return (-1);
          }
#line 1575
          if ((unsigned long )state->ostack == (unsigned long )((csv2_origin *)0)) {
            {
#line 1576
            csv2_error(stream, (char *)"origin stack empty");
            }
#line 1578
            return (-1);
          }
          {
#line 1582
          o___0 = state->ostack;
#line 1583
          js_destroy(state->origin);
#line 1584
          state->ostack = o___0->next;
#line 1585
          state->origin = o___0->origin;
#line 1586
          zone = state->origin;
#line 1587
          js_dealloc((void *)o___0);
          }
        } else {
#line 1561
          goto _L___6;
        }
      } else
      _L___6: /* CIL Label */ 
#line 1588
      if (cmd == 5) {
#line 1588
        if (look == 100) {
          {
#line 1590
          rc = 0;
#line 1590
          fc = 0;
#line 1591
          look = csv2_read_unicode(stream);
#line 1592
          tmp___10 = csv2_is_delimiter(look);
          }
#line 1592
          if (! tmp___10) {
            {
#line 1593
            csv2_error(stream, (char *)"Invalid slash command");
            }
#line 1595
            return (-1);
          }
          {
#line 1597
          filename = csv2_get_filename(stream);
#line 1600
          csv2_allow_tilde(stream);
#line 1601
          rc = 0;
          }
          {
#line 1601
          while (1) {
            while_continue___0: /* CIL Label */ ;
#line 1601
            if (! (rc < 10000)) {
#line 1601
              goto while_break___0;
            }
            {
#line 1602
            fc = csv2_readchar(stream);
            }
#line 1603
            if (fc == 126) {
#line 1604
              goto while_break___0;
            } else
#line 1603
            if (fc == 10) {
#line 1604
              goto while_break___0;
            }
#line 1601
            rc ++;
          }
          while_break___0: /* CIL Label */ ;
          }
          {
#line 1607
          csv2_push_file(stream, filename);
#line 1608
          js_destroy(filename);
          }
        } else {
          {
#line 1610
          csv2_error(stream, (char *)"Invalid slash command");
          }
#line 1611
          return (-1);
        }
      } else {
        {
#line 1610
        csv2_error(stream, (char *)"Invalid slash command");
        }
#line 1611
        return (-1);
      }
    }
#line 1392
    if (! (slash_command == 1)) {
#line 1392
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 1622
  if (starwhitis == 0) {
    {
#line 1623
    name = csv2_get_hostname(stream, zone, 1);
    }
#line 1623
    if ((unsigned long )name == (unsigned long )((js_string *)0)) {
      {
#line 1624
      csv2_error(stream, (char *)"Problem getting hostname");
      }
#line 1625
      return (-1);
    }
  } else
#line 1627
  if (starwhitis == 1) {
    {
#line 1628
    name = csv2_get_hostname(stream, zone, 2);
    }
#line 1628
    if ((unsigned long )name == (unsigned long )((js_string *)0)) {
      {
#line 1629
      csv2_error(stream, (char *)"Problem getting hostname");
      }
#line 1630
      return (-1);
    }
  } else {
    {
#line 1633
    csv2_error(stream, (char *)"Bad starwhitis value passed to csv2_read_rr");
    }
#line 1635
    return (-1);
  }
  {
#line 1640
  tmp___13 = csv2_get_1st(stream, & csv2_is_alphanum_orplus, 0);
  }
#line 1640
  if (tmp___13 < 0) {
    {
#line 1641
    js_destroy(name);
#line 1642
    csv2_error(stream, (char *)"Unexpected character");
    }
#line 1643
    return (-1);
  }
  {
#line 1646
  ttl = state->default_ttl;
#line 1648
  tmp___16 = csv2_justread(stream);
  }
#line 1648
  if (tmp___16 == 43) {
    {
#line 1649
    tmp___14 = csv2_read_unicode(stream);
    }
#line 1649
    if (tmp___14 < 0) {
      {
#line 1650
      js_destroy(name);
#line 1651
      csv2_error(stream, (char *)"Unexpected char around +");
      }
#line 1652
      return (-1);
    }
    {
#line 1654
    ttl = csv2_get_num(stream);
    }
#line 1654
    if (ttl < 0) {
      {
#line 1655
      js_destroy(name);
#line 1656
      csv2_error(stream, (char *)"Problem getting TTL");
      }
#line 1657
      return (-1);
    }
    {
#line 1660
    tmp___15 = csv2_get_1st(stream, & csv2_is_alphanum, 0);
    }
#line 1660
    if (tmp___15 < 0) {
      {
#line 1661
      js_destroy(name);
#line 1662
      csv2_error(stream, (char *)"Unexpected character");
      }
#line 1663
      return (-1);
    }
  }
  {
#line 1670
  tmp___19 = csv2_justread(stream);
#line 1670
  tmp___20 = csv2_is_alpha(tmp___19);
  }
#line 1670
  if (tmp___20) {
    {
#line 1671
    rtype = csv2_get_rtype(stream);
    }
#line 1671
    if (rtype == -1) {
      {
#line 1672
      js_destroy(name);
#line 1673
      csv2_error(stream, (char *)"Unknown Rtype");
      }
#line 1674
      return (-1);
    }
  } else {
    {
#line 1679
    tmp___17 = csv2_justread(stream);
#line 1679
    tmp___18 = csv2_is_number(tmp___17);
    }
#line 1679
    if (tmp___18) {
      {
#line 1680
      rtype = 1;
#line 1681
      rddata = csv2_get_a(stream);
#line 1683
      csv2_add_rr(state, name, rtype, ttl, rddata);
#line 1685
      js_destroy(name);
#line 1686
      js_destroy(rddata);
      }
#line 1687
      return (1);
    } else {
      {
#line 1690
      js_destroy(name);
#line 1691
      csv2_error(stream, (char *)"Unexpected char (shouldn\'t get here)");
      }
#line 1692
      return (-1);
    }
  }
  {
#line 1699
  if (rtype == 1) {
#line 1699
    goto case_1;
  }
#line 1702
  if (rtype == 28) {
#line 1702
    goto case_28;
  }
#line 1705
  if (rtype == 6) {
#line 1705
    goto case_6;
  }
#line 1710
  if (rtype == 21) {
#line 1710
    goto case_21;
  }
#line 1710
  if (rtype == 18) {
#line 1710
    goto case_21;
  }
#line 1710
  if (rtype == 15) {
#line 1710
    goto case_21;
  }
#line 1713
  if (rtype == 33) {
#line 1713
    goto case_33;
  }
#line 1719
  if (rtype == 99) {
#line 1719
    goto case_99;
  }
#line 1719
  if (rtype == 20) {
#line 1719
    goto case_99;
  }
#line 1719
  if (rtype == 19) {
#line 1719
    goto case_99;
  }
#line 1719
  if (rtype == 16) {
#line 1719
    goto case_99;
  }
#line 1730
  if (rtype == 9) {
#line 1730
    goto case_9;
  }
#line 1730
  if (rtype == 8) {
#line 1730
    goto case_9;
  }
#line 1734
  if (rtype == 17) {
#line 1734
    goto case_17;
  }
#line 1734
  if (rtype == 14) {
#line 1734
    goto case_17;
  }
#line 1741
  if (rtype == 7) {
#line 1741
    goto case_7;
  }
#line 1741
  if (rtype == 23) {
#line 1741
    goto case_7;
  }
#line 1741
  if (rtype == 12) {
#line 1741
    goto case_7;
  }
#line 1741
  if (rtype == 5) {
#line 1741
    goto case_7;
  }
#line 1741
  if (rtype == 2) {
#line 1741
    goto case_7;
  }
#line 1748
  if (rtype == 65765) {
#line 1748
    goto case_65765;
  }
#line 1754
  if (rtype == 65766) {
#line 1754
    goto case_65766;
  }
#line 1761
  if (rtype == 13) {
#line 1761
    goto case_13;
  }
#line 1764
  if (rtype == 11) {
#line 1764
    goto case_11;
  }
#line 1774
  if (rtype == 3) {
#line 1774
    goto case_3;
  }
#line 1780
  if (rtype == 4) {
#line 1780
    goto case_4;
  }
#line 1786
  if (rtype == 22) {
#line 1786
    goto case_22;
  }
#line 1789
  if (rtype == 26) {
#line 1789
    goto case_26;
  }
#line 1792
  if (rtype == 27) {
#line 1792
    goto case_27;
  }
#line 1795
  if (rtype == 29) {
#line 1795
    goto case_29;
  }
#line 1805
  if (rtype == 35) {
#line 1805
    goto case_35;
  }
#line 1808
  goto switch_default;
  case_1: /* CIL Label */ 
  {
#line 1700
  rddata = csv2_get_a(stream);
  }
#line 1701
  goto switch_break;
  case_28: /* CIL Label */ 
  {
#line 1703
  rddata = csv2_get_aaaa(stream);
  }
#line 1704
  goto switch_break;
  case_6: /* CIL Label */ 
  {
#line 1706
  rddata = csv2_get_soa(stream, zone, state);
  }
#line 1707
  goto switch_break;
  case_21: /* CIL Label */ 
  case_18: /* CIL Label */ 
  case_15: /* CIL Label */ 
  {
#line 1711
  rddata = csv2_get_mx(stream, zone, -1);
  }
#line 1712
  goto switch_break;
  case_33: /* CIL Label */ 
  {
#line 1714
  rddata = csv2_get_srv(stream, zone);
  }
#line 1715
  goto switch_break;
  case_99: /* CIL Label */ 
  case_20: /* CIL Label */ 
  case_19: /* CIL Label */ 
  case_16: /* CIL Label */ 
#line 1720
  if ((int )stream->tilde_handling == 2) {
    {
#line 1722
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1725
    goto switch_break;
  } else
#line 1720
  if ((int )stream->tilde_handling == 102) {
    {
#line 1722
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1725
    goto switch_break;
  }
  {
#line 1727
  rddata = csv2_get_txt(stream, 0);
  }
#line 1728
  goto switch_break;
  case_9: /* CIL Label */ 
  case_8: /* CIL Label */ 
  {
#line 1731
  rddata = csv2_get_mbox(stream, zone, 1);
  }
#line 1732
  goto switch_break;
  case_17: /* CIL Label */ 
  case_14: /* CIL Label */ 
  {
#line 1735
  rddata = csv2_get_mbox(stream, zone, 2);
  }
#line 1736
  goto switch_break;
  case_7: /* CIL Label */ 
  case_23: /* CIL Label */ 
  case_12: /* CIL Label */ 
  case_5: /* CIL Label */ 
  case_2: /* CIL Label */ 
  {
#line 1742
  tmp___21 = csv2_get_1st(stream, & csv2_is_dchar, 0);
  }
#line 1742
  if (tmp___21 != 1) {
#line 1744
    return (-1);
  }
  {
#line 1746
  rddata = csv2_get_hostname(stream, zone, 3);
  }
#line 1747
  goto switch_break;
  case_65765: /* CIL Label */ 
  {
#line 1751
  rddata = csv2_get_a(stream);
  }
#line 1752
  goto switch_break;
  case_65766: /* CIL Label */ 
  {
#line 1757
  rddata = csv2_get_aaaa(stream);
  }
#line 1758
  goto switch_break;
  case_13: /* CIL Label */ 
  {
#line 1762
  rddata = csv2_get_txt(stream, 2);
  }
#line 1763
  goto switch_break;
  case_11: /* CIL Label */ 
#line 1765
  if ((int )stream->tilde_handling == 2) {
    {
#line 1767
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1770
    goto switch_break;
  } else
#line 1765
  if ((int )stream->tilde_handling == 102) {
    {
#line 1767
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1770
    goto switch_break;
  }
  {
#line 1772
  rddata = csv2_get_wks(stream);
  }
#line 1773
  goto switch_break;
  case_3: /* CIL Label */ 
  {
#line 1777
  rddata = csv2_get_mx(stream, zone, 0);
#line 1778
  rtype = 15;
  }
#line 1779
  goto switch_break;
  case_4: /* CIL Label */ 
  {
#line 1783
  rddata = csv2_get_mx(stream, zone, 10);
#line 1784
  rtype = 15;
  }
#line 1785
  goto switch_break;
  case_22: /* CIL Label */ 
  {
#line 1787
  rddata = csv2_get_hex(stream);
  }
#line 1788
  goto switch_break;
  case_26: /* CIL Label */ 
  {
#line 1790
  rddata = csv2_get_mx(stream, zone, -2);
  }
#line 1791
  goto switch_break;
  case_27: /* CIL Label */ 
  {
#line 1793
  rddata = csv2_get_txt(stream, 3);
  }
#line 1794
  goto switch_break;
  case_29: /* CIL Label */ 
#line 1796
  if ((int )stream->tilde_handling == 2) {
    {
#line 1798
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1801
    goto switch_break;
  } else
#line 1796
  if ((int )stream->tilde_handling == 102) {
    {
#line 1798
    csv2_error(stream, (char *)"I\'m sorry, that record can not be the first record unless csv2_tilde_handling is set.");
    }
#line 1801
    goto switch_break;
  }
  {
#line 1803
  rddata = csv2_get_loc(stream);
  }
#line 1804
  goto switch_break;
  case_35: /* CIL Label */ 
  {
#line 1806
  rddata = csv2_get_naptr(stream);
  }
#line 1807
  goto switch_break;
  switch_default: /* CIL Label */ 
#line 1810
  if (rtype >= 100000) {
#line 1810
    if (rtype <= 165535) {
#line 1811
      rtype -= 100000;
#line 1812
      if (rtype == 255) {
        {
#line 1813
        csv2_error(stream, (char *)"ANY (255) record type isn\'t for data");
        }
      } else
#line 1815
      if (rtype == 251) {
        {
#line 1816
        csv2_error(stream, (char *)"IXFR (251) record type isn\'t for data");
        }
      } else
#line 1818
      if (rtype == 252) {
        {
#line 1819
        csv2_error(stream, (char *)"AXFR (252) record type isn\'t for data");
        }
      } else
#line 1821
      if (rtype == 253) {
        {
#line 1822
        csv2_error(stream, (char *)"MAILB record type isn\'t for data");
        }
      } else
#line 1824
      if (rtype == 254) {
        {
#line 1825
        csv2_error(stream, (char *)"MAILA record type isn\'t for data");
        }
      } else
#line 1827
      if (rtype == 38) {
        {
#line 1828
        csv2_error(stream, (char *)"MaraDNS doesn\'t allow A6 records");
        }
      } else
#line 1830
      if (rtype == 39) {
        {
#line 1831
        csv2_error(stream, (char *)"MaraDNS doesn\'t allow DNAME records");
        }
      } else
#line 1833
      if (rtype == 41) {
        {
#line 1834
        csv2_error(stream, (char *)"OPT record type isn\'t for zone files");
        }
      } else {
        {
#line 1837
        rddata = csv2_get_raw(stream);
        }
      }
    } else {
      {
#line 1840
      csv2_error(stream, (char *)"Unsupported RTYPE");
      }
    }
  } else {
    {
#line 1840
    csv2_error(stream, (char *)"Unsupported RTYPE");
    }
  }
  switch_break: /* CIL Label */ ;
  }
#line 1844
  if ((unsigned long )rddata == (unsigned long )((js_string *)0)) {
    {
#line 1845
    csv2_error(stream, (char *)"Problem getting rddata");
#line 1846
    js_destroy(name);
    }
#line 1847
    return (-1);
  }
  {
#line 1850
  csv2_add_rr(state, name, rtype, ttl, rddata);
#line 1852
  js_destroy(name);
#line 1853
  js_destroy(rddata);
  }
#line 1854
  return (1);
}
}
#line 270 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_b4_at(int32_t in ) ;
#line 271
js_string *process_mbox(csv2_read *stream ) ;
#line 281
int csv2_is_alphanum_ordot(int32_t in ) ;
#line 36 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_soa.c"
int csv2_b4_at(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 38
  tmp = csv2_is_alphanum(in);
  }
#line 38
  if (tmp) {
#line 38
    tmp___0 = 1;
  } else
#line 38
  if (in == 43) {
#line 38
    tmp___0 = 1;
  } else
#line 38
  if (in == 37) {
#line 38
    tmp___0 = 1;
  } else
#line 38
  if (in == 33) {
#line 38
    tmp___0 = 1;
  } else
#line 38
  if (in == 94) {
#line 38
    tmp___0 = 1;
  } else
#line 38
  if (in == 61) {
#line 38
    tmp___0 = 1;
  } else {
#line 38
    tmp___0 = 0;
  }
#line 38
  return (tmp___0);
}
}
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_soa.c"
js_string *process_mbox(csv2_read *stream ) 
{ 
  js_string *o ;
  int32_t look ;
  int x ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  js_string *tmp___6 ;

  {
  {
#line 50
  o = process_1stchar(stream, & csv2_is_alphanum_ordot, (char *)"Z");
  }
#line 51
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 52
    return ((js_string *)0);
  }
#line 56
  x = 0;
  {
#line 56
  while (1) {
    while_continue: /* CIL Label */ ;
#line 56
    if (! (x < 10000)) {
#line 56
      goto while_break;
    }
    {
#line 57
    look = csv2_read_unicode(stream);
    }
#line 60
    if (x == 0) {
#line 60
      if (o->unit_count >= 2U) {
#line 60
        if ((int )*(o->string + 1) == 46) {
          {
#line 61
          tmp = csv2_is_delimiter(look);
          }
#line 61
          if (tmp) {
#line 62
            return (o);
          }
          {
#line 64
          csv2_error(stream, (char *)". can only be at start of label that is just a . by itself");
#line 66
          js_destroy(o);
          }
#line 67
          return ((js_string *)0);
        }
      }
    }
#line 69
    if (look == -164) {
      {
#line 70
      js_destroy(o);
      }
#line 71
      return ((js_string *)0);
    }
#line 73
    if (look == 64) {
#line 73
      goto _L;
    } else
#line 73
    if (look == 46) {
      _L: /* CIL Label */ 
      {
#line 74
      tmp___0 = csv2_append_utf8(o, look);
      }
#line 74
      if (tmp___0 < 0) {
        {
#line 75
        csv2_error(stream, (char *)"Error appending character");
#line 76
        js_destroy(o);
        }
#line 77
        return ((js_string *)0);
      }
#line 79
      if (look == 46) {
        {
#line 80
        look = csv2_read_unicode(stream);
#line 81
        tmp___2 = csv2_is_text(look);
        }
#line 81
        if (tmp___2) {
          {
#line 82
          tmp___1 = csv2_append_utf8(o, look);
          }
#line 82
          if (tmp___1 < 0) {
            {
#line 83
            csv2_error(stream, (char *)"Error appending character");
#line 85
            js_destroy(o);
            }
#line 86
            return ((js_string *)0);
          }
        } else {
          {
#line 89
          csv2_error(stream, (char *)"Strange character after dot");
#line 91
          js_destroy(o);
          }
#line 92
          return ((js_string *)0);
        }
      }
#line 95
      goto while_break;
    }
#line 97
    if (look == 92) {
      {
#line 98
      look = csv2_read_unicode(stream);
      }
#line 99
      if (look != 46) {
        {
#line 100
        csv2_error(stream, (char *)"Illegal character after \\");
#line 102
        js_destroy(o);
        }
#line 103
        return ((js_string *)0);
      }
      {
#line 105
      tmp___3 = csv2_append_utf8(o, '.');
      }
#line 105
      if (tmp___3 < 0) {
        {
#line 106
        csv2_error(stream, (char *)"Error appending dot");
#line 107
        js_destroy(o);
        }
#line 108
        return ((js_string *)0);
      }
      {
#line 110
      look = csv2_read_unicode(stream);
      }
    }
    {
#line 112
    tmp___5 = csv2_b4_at(look);
    }
#line 112
    if (tmp___5) {
      {
#line 113
      tmp___4 = csv2_append_utf8(o, look);
      }
#line 113
      if (tmp___4 < 0) {
        {
#line 114
        csv2_error(stream, (char *)"Error appending character");
#line 115
        js_destroy(o);
        }
#line 116
        return ((js_string *)0);
      }
    } else {
      {
#line 120
      csv2_error(stream, (char *)"Unexpected character before @ in mbox Yes, I know RFC2822 3.4 probably allows the character in question to be there. This is MaraDNS, not some platonic ideal.");
#line 125
      js_destroy(o);
      }
#line 126
      return ((js_string *)0);
    }
#line 56
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 132
  tmp___6 = js_append_dname(o, stream, 0);
  }
#line 132
  return (tmp___6);
}
}
#line 139 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_soa.c"
js_string *csv2_get_soa(csv2_read *stream , js_string *zone , csv2_add_state *state ) 
{ 
  js_string *name ;
  js_string *out ;
  int c ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int32_t num ;
  int tmp___2 ;
  int tmp___3 ;

  {
  {
#line 145
  out = js_create(512U, 1U);
  }
#line 145
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 146
    return ((js_string *)0);
  }
  {
#line 150
  tmp = csv2_get_1st(stream, & csv2_is_dchar, 0);
  }
#line 150
  if (tmp != 1) {
#line 151
    return ((js_string *)0);
  }
  {
#line 153
  name = csv2_get_hostname(stream, zone, 3);
  }
#line 153
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
    {
#line 154
    js_destroy(out);
    }
#line 155
    return ((js_string *)0);
  }
  {
#line 157
  tmp___0 = js_append(name, out);
  }
#line 157
  if (tmp___0 == -1) {
    {
#line 158
    js_destroy(name);
#line 159
    js_destroy(out);
    }
#line 160
    return ((js_string *)0);
  }
  {
#line 162
  js_destroy(name);
#line 165
  name = csv2_get_mbox(stream, zone, 1);
#line 166
  tmp___1 = js_append(name, out);
  }
#line 166
  if (tmp___1 == -1) {
    {
#line 167
    js_destroy(name);
#line 168
    js_destroy(out);
    }
#line 169
    return ((js_string *)0);
  }
  {
#line 171
  js_destroy(name);
#line 174
  c = 0;
  }
  {
#line 174
  while (1) {
    while_continue: /* CIL Label */ ;
#line 174
    if (! (c < 5)) {
#line 174
      goto while_break;
    }
    {
#line 176
    num = csv2_get_num(stream);
    }
#line 179
    if (num == -2) {
#line 179
      if (c == 0) {
        {
#line 180
        tmp___2 = js_adduint32(out, (uint32_t )state->soa_serial);
        }
#line 180
        if (tmp___2 == -1) {
          {
#line 181
          js_destroy(out);
          }
#line 182
          return ((js_string *)0);
        }
      } else {
#line 179
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 184
    if (num < 0) {
      {
#line 185
      js_destroy(out);
      }
#line 186
      return ((js_string *)0);
    } else {
      {
#line 187
      tmp___3 = js_adduint32(out, (uint32_t )num);
      }
#line 187
      if (tmp___3 == -1) {
        {
#line 188
        js_destroy(out);
        }
#line 189
        return ((js_string *)0);
      }
    }
#line 174
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 192
  return (out);
}
}
#line 196 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_is_hash(int32_t in ) ;
#line 267
int csv2_is_number_or_dot(int32_t in ) ;
#line 268
js_string *process_ipv4_ddip(csv2_read *stream ) ;
#line 276
js_string *csv2_get_string(csv2_read *stream , int numchunks , int post_txt ) ;
#line 280
int csv2_is_wks(int32_t in ) ;
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
int csv2_is_wks(int32_t in ) 
{ 
  int tmp ;

  {
#line 41
  if (in == 44) {
#line 41
    tmp = 1;
  } else
#line 41
  if (in == 9) {
#line 41
    tmp = 1;
  } else
#line 41
  if (in == 32) {
#line 41
    tmp = 1;
  } else {
#line 41
    tmp = 0;
  }
#line 41
  return (tmp);
}
}
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
int csv2_is_alphanum_ordot(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 46
  tmp = csv2_is_alphanum(in);
  }
#line 46
  if (tmp) {
#line 46
    tmp___0 = 1;
  } else
#line 46
  if (in == 46) {
#line 46
    tmp___0 = 1;
  } else {
#line 46
    tmp___0 = 0;
  }
#line 46
  return (tmp___0);
}
}
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
int csv2_is_signed_num(int32_t in ) 
{ 
  int tmp ;

  {
#line 51
  if (in >= 48) {
#line 51
    if (in <= 57) {
#line 51
      tmp = 1;
    } else {
#line 51
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 51
  if (in == 45) {
#line 51
    tmp = 1;
  } else {
#line 51
    tmp = 0;
  }
#line 51
  return (tmp);
}
}
#line 56 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
js_string *csv2_get_wks(csv2_read *stream ) 
{ 
  js_string *ddip ;
  js_string *out ;
  int protocol ;
  int ports[13] ;
  int portindex ;
  int hiport ;
  int32_t look ;
  int x ;
  int num ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int pn ;
  int q ;
  int mask ;

  {
  {
#line 61
  portindex = 0;
#line 62
  hiport = 0;
#line 66
  tmp = csv2_get_1st(stream, & csv2_is_number, 0);
  }
#line 66
  if (tmp != 1) {
#line 67
    return ((js_string *)0);
  }
  {
#line 71
  ddip = process_ipv4_ddip(stream);
  }
#line 71
  if ((unsigned long )ddip == (unsigned long )((js_string *)0)) {
#line 72
    return ((js_string *)0);
  }
  {
#line 76
  protocol = csv2_get_num(stream);
  }
#line 77
  if (protocol < 0) {
    {
#line 78
    js_destroy(ddip);
    }
#line 79
    return ((js_string *)0);
  }
  {
#line 82
  tmp___0 = csv2_get_1st(stream, & csv2_is_number, 0);
  }
#line 82
  if (tmp___0 != 1) {
    {
#line 83
    js_destroy(ddip);
    }
#line 84
    return ((js_string *)0);
  }
#line 90
  if ((int )stream->tilde_handling == 103) {
    {
#line 91
    csv2_allow_tilde(stream);
    }
  }
  {
#line 93
  look = csv2_justread(stream);
#line 94
  num = 0;
#line 95
  x = 0;
  }
  {
#line 95
  while (1) {
    while_continue: /* CIL Label */ ;
#line 95
    if (! (x < 1000)) {
#line 95
      goto while_break;
    }
#line 96
    if ((int )stream->tilde_handling != 103) {
#line 100
      if (look == -2) {
#line 101
        goto while_break;
      } else
#line 100
      if (look == 10) {
#line 101
        goto while_break;
      } else
#line 100
      if (look == 13) {
#line 101
        goto while_break;
      } else {
        {
#line 104
        tmp___1 = csv2_is_hash(look);
        }
#line 104
        if (tmp___1) {
          {
#line 105
          process_comment(stream);
          }
#line 106
          goto while_break;
        }
      }
    } else
#line 111
    if (look == 126) {
#line 112
      goto while_break;
    } else {
      {
#line 113
      tmp___2 = csv2_is_hash(look);
      }
#line 113
      if (tmp___2) {
        {
#line 114
        process_comment(stream);
#line 115
        look = csv2_read_unicode(stream);
        }
#line 116
        goto __Cont;
      }
    }
    {
#line 120
    tmp___4 = csv2_is_number(look);
    }
#line 120
    if (tmp___4) {
#line 121
      num *= 10;
#line 122
      num += look - 48;
#line 127
      if (num > 100000) {
        {
#line 128
        js_destroy(ddip);
        }
#line 129
        return ((js_string *)0);
      }
    } else {
      {
#line 134
      tmp___3 = csv2_is_wks(look);
      }
#line 134
      if (tmp___3) {
#line 134
        goto _L___0;
      } else
#line 134
      if ((int )stream->tilde_handling == 103) {
#line 134
        if (look == 13) {
#line 134
          goto _L___0;
        } else
#line 134
        if (look == 10) {
          _L___0: /* CIL Label */ 
#line 138
          if (portindex >= 10) {
            {
#line 139
            js_destroy(ddip);
            }
#line 140
            return ((js_string *)0);
          }
#line 142
          ports[portindex] = num;
#line 143
          portindex ++;
#line 144
          if (num > hiport) {
#line 145
            hiport = num;
          }
#line 147
          if (num > 1024) {
            {
#line 148
            js_destroy(ddip);
            }
#line 149
            return ((js_string *)0);
          }
#line 151
          num = 0;
        } else {
          {
#line 155
          js_destroy(ddip);
          }
#line 156
          return ((js_string *)0);
        }
      } else {
        {
#line 155
        js_destroy(ddip);
        }
#line 156
        return ((js_string *)0);
      }
    }
    {
#line 158
    look = csv2_read_unicode(stream);
    }
    __Cont: /* CIL Label */ 
#line 95
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 166
  if (num > 0) {
#line 166
    if (num < 1024) {
#line 167
      if (portindex >= 10) {
        {
#line 168
        js_destroy(ddip);
        }
#line 169
        return ((js_string *)0);
      }
#line 171
      ports[portindex] = num;
#line 172
      if (num > hiport) {
#line 173
        hiport = num;
      }
    }
  }
  {
#line 178
  out = js_create((unsigned int )((hiport >> 3) + 6), 1U);
  }
#line 178
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
    {
#line 179
    js_destroy(ddip);
    }
#line 180
    return ((js_string *)0);
  }
#line 184
  x = 0;
  {
#line 184
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 184
    if (! (x < (hiport >> 3) + 6)) {
#line 184
      goto while_break___0;
    }
#line 185
    *(out->string + x) = (unsigned char)0;
#line 184
    x ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 190
  tmp___5 = ddip_2_ip(ddip, out, 0);
  }
#line 190
  if (tmp___5 == -1) {
    {
#line 191
    js_destroy(ddip);
#line 192
    js_destroy(out);
    }
#line 193
    return ((js_string *)0);
  }
#line 197
  out->unit_count = (unsigned int )(6 + (hiport >> 3));
#line 200
  if (out->max_count < out->unit_count) {
    {
#line 201
    js_destroy(ddip);
#line 202
    js_destroy(out);
    }
#line 203
    return ((js_string *)0);
  }
#line 207
  *(out->string + 4) = (unsigned char )(protocol & 255);
#line 210
  x = 0;
  {
#line 210
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 210
    if (! (x < portindex)) {
#line 210
      goto while_break___1;
    }
#line 212
    pn = ports[x];
#line 213
    q = pn >> 3;
#line 214
    mask = 128 >> pn % 8;
#line 215
    if ((unsigned int )q >= out->unit_count) {
      {
#line 216
      js_destroy(ddip);
#line 217
      js_destroy(out);
      }
#line 218
      return ((js_string *)0);
    }
#line 220
    *((out->string + q) + 5) = (unsigned char )((int )*((out->string + q) + 5) | mask);
#line 210
    x ++;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
#line 223
  js_destroy(ddip);
  }
#line 224
  return (out);
}
}
#line 230 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
js_string *csv2_get_mbox(csv2_read *stream , js_string *zone , int count ) 
{ 
  js_string *name ;
  js_string *out ;
  int c ;
  int tmp ;
  js_string *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 235
  out = js_create(512U, 1U);
  }
#line 235
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 236
    return ((js_string *)0);
  }
#line 239
  c = 0;
  {
#line 239
  while (1) {
    while_continue: /* CIL Label */ ;
#line 239
    if (! (c < count)) {
#line 239
      goto while_break;
    }
    {
#line 241
    tmp = csv2_get_1st(stream, & csv2_is_alphanum_ordot, 0);
    }
#line 241
    if (tmp != 1) {
      {
#line 243
      js_destroy(out);
      }
#line 244
      return ((js_string *)0);
    }
    {
#line 246
    name = process_mbox(stream);
    }
#line 246
    if ((unsigned long )name == (unsigned long )((js_string *)0)) {
      {
#line 247
      js_destroy(out);
      }
#line 248
      return ((js_string *)0);
    }
    {
#line 250
    tmp___0 = csv2_convert_percent(name, zone);
    }
#line 250
    if ((unsigned long )tmp___0 == (unsigned long )((js_string *)0)) {
      {
#line 251
      js_destroy(name);
#line 252
      js_destroy(out);
      }
#line 253
      return ((js_string *)0);
    }
    {
#line 255
    tmp___1 = email_2rfc1035(name);
    }
#line 255
    if (tmp___1 == -1) {
      {
#line 256
      js_destroy(name);
#line 257
      js_destroy(out);
      }
#line 258
      return ((js_string *)0);
    }
    {
#line 260
    tmp___2 = js_append(name, out);
    }
#line 260
    if (tmp___2 == -1) {
      {
#line 261
      js_destroy(name);
#line 262
      js_destroy(out);
      }
#line 263
      return ((js_string *)0);
    }
    {
#line 265
    js_destroy(name);
#line 239
    c ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 267
  return (out);
}
}
#line 272 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
js_string *csv2_get_hex(csv2_read *stream ) 
{ 
  js_string *out ;
  int32_t look ;
  int place ;
  int tmp ;
  int tmp___0 ;
  int32_t tmp___1 ;
  int lnybble ;
  int rnybble ;
  int chr ;
  int x ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 279
  tmp = csv2_get_1st(stream, & csv2_is_number, 0);
  }
#line 279
  if (tmp != 1) {
#line 280
    return ((js_string *)0);
  }
  {
#line 282
  tmp___0 = csv2_justread(stream);
  }
#line 282
  if (tmp___0 != 48) {
#line 283
    return ((js_string *)0);
  }
  {
#line 285
  tmp___1 = csv2_read_unicode(stream);
  }
#line 285
  if (tmp___1 != 120) {
#line 286
    return ((js_string *)0);
  }
  {
#line 289
  look = -1;
#line 290
  place = 0;
#line 292
  out = js_create(256U, 1U);
  }
#line 293
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 294
    return ((js_string *)0);
  }
  {
#line 297
  while (1) {
    while_continue: /* CIL Label */ ;
#line 297
    if (look != -2) {
      {
#line 297
      tmp___4 = csv2_is_delimiter(look);
      }
#line 297
      if (tmp___4) {
#line 297
        goto while_break;
      }
    } else {
#line 297
      goto while_break;
    }
    {
#line 301
    look = csv2_read_unicode(stream);
#line 302
    x = 0;
    }
    {
#line 304
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 304
      if (look == 46) {
#line 304
        if (! (x < 10000)) {
#line 304
          goto while_break___0;
        }
      } else {
#line 304
        goto while_break___0;
      }
      {
#line 305
      look = csv2_read_unicode(stream);
#line 306
      x ++;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
#line 308
    if (look >= 48) {
#line 308
      if (look <= 57) {
#line 309
        lnybble = look - 48;
      } else {
#line 308
        goto _L___1;
      }
    } else
    _L___1: /* CIL Label */ 
#line 311
    if (look >= 97) {
#line 311
      if (look <= 102) {
#line 312
        lnybble = look - 97;
      } else {
#line 311
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 314
    if (look >= 65) {
#line 314
      if (look <= 70) {
#line 315
        lnybble = look - 65;
      } else {
#line 314
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 317
    if (look == -2) {
#line 318
      goto while_break;
    } else {
      {
#line 317
      tmp___2 = csv2_is_delimiter(look);
      }
#line 317
      if (tmp___2) {
#line 318
        goto while_break;
      } else {
        {
#line 321
        csv2_error(stream, (char *)"Unexpected char");
#line 322
        js_destroy(out);
        }
#line 323
        return ((js_string *)0);
      }
    }
    {
#line 325
    look = csv2_read_unicode(stream);
    }
#line 327
    if (look == 46) {
      {
#line 328
      csv2_error(stream, (char *)"Dot not at byte boundary");
#line 329
      js_destroy(out);
      }
#line 330
      return ((js_string *)0);
    }
#line 332
    if (look >= 48) {
#line 332
      if (look <= 57) {
#line 333
        rnybble = look - 48;
      } else {
#line 332
        goto _L___4;
      }
    } else
    _L___4: /* CIL Label */ 
#line 335
    if (look >= 97) {
#line 335
      if (look <= 102) {
#line 336
        rnybble = look - 97;
      } else {
#line 335
        goto _L___3;
      }
    } else
    _L___3: /* CIL Label */ 
#line 338
    if (look >= 65) {
#line 338
      if (look <= 70) {
#line 339
        rnybble = look - 65;
      } else {
#line 338
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 341
    if (look == -2) {
      {
#line 342
      csv2_error(stream, (char *)"Record must end on byte boundary");
#line 343
      js_destroy(out);
      }
#line 344
      return ((js_string *)0);
    } else {
      {
#line 341
      tmp___3 = csv2_is_delimiter(look);
      }
#line 341
      if (tmp___3) {
        {
#line 342
        csv2_error(stream, (char *)"Record must end on byte boundary");
#line 343
        js_destroy(out);
        }
#line 344
        return ((js_string *)0);
      } else {
        {
#line 347
        csv2_error(stream, (char *)"Unexpected char");
#line 348
        js_destroy(out);
        }
#line 349
        return ((js_string *)0);
      }
    }
#line 351
    chr = (((lnybble & 15) << 4) | (rnybble & 15)) & 255;
#line 352
    if ((unsigned int )(place + 7) > out->max_count) {
      {
#line 353
      js_destroy(out);
      }
#line 354
      return ((js_string *)0);
    }
#line 356
    out->unit_count = (unsigned int )(place + 1);
#line 357
    *(out->string + place) = (unsigned char )chr;
#line 358
    place ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 361
  return (out);
}
}
#line 370 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
int32_t csv2_get_int(csv2_read *stream , int mulfactor ) 
{ 
  int out ;
  int32_t look ;
  int x ;
  int decimal ;
  int sign ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 371
  out = 0;
#line 374
  decimal = 0;
#line 375
  sign = 1;
#line 377
  if (mulfactor == 3) {
#line 378
    mulfactor = 1000;
  } else
#line 379
  if (mulfactor == 2) {
#line 380
    mulfactor = 100;
  } else
#line 381
  if (mulfactor == 1) {
#line 382
    mulfactor = 10;
  } else
#line 383
  if (mulfactor == 0) {
#line 384
    mulfactor = 1;
  } else {
#line 386
    return (0);
  }
  {
#line 389
  look = csv2_justread(stream);
  }
#line 390
  if (look == 45) {
    {
#line 391
    sign = -1;
#line 392
    look = csv2_read_unicode(stream);
    }
  }
#line 395
  x = 0;
  {
#line 395
  while (1) {
    while_continue: /* CIL Label */ ;
#line 395
    if (! (x < 100)) {
#line 395
      goto while_break;
    }
    {
#line 396
    tmp___1 = csv2_is_number_or_dot(look);
    }
#line 396
    if (tmp___1) {
      {
#line 399
      tmp___0 = csv2_is_number(look);
      }
#line 399
      if (tmp___0) {
#line 400
        out *= 10;
#line 401
        out += look - 48;
      } else
#line 403
      if (look == 46) {
        {
#line 404
        decimal = 0;
#line 405
        out *= mulfactor;
#line 406
        look = csv2_read_unicode(stream);
        }
        {
#line 407
        while (1) {
          while_continue___0: /* CIL Label */ ;
          {
#line 407
          tmp = csv2_is_number(look);
          }
#line 407
          if (tmp) {
#line 407
            if (! (mulfactor > 1)) {
#line 407
              goto while_break___0;
            }
          } else {
#line 407
            goto while_break___0;
          }
          {
#line 408
          mulfactor /= 10;
#line 409
          decimal += (look - 48) * mulfactor;
#line 410
          look = csv2_read_unicode(stream);
          }
        }
        while_break___0: /* CIL Label */ ;
        }
#line 412
        return ((out + decimal) * sign);
      }
    } else {
#line 397
      return ((out * mulfactor) * sign);
    }
    {
#line 414
    look = csv2_read_unicode(stream);
#line 395
    x ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 416
  return (0);
}
}
#line 421 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
uint32_t csv2_get_lon_lat(csv2_read *stream , char r1 , char r2 , char r3 , char r4 ) 
{ 
  uint32_t out ;
  int degrees ;
  int mins ;
  int secs ;
  int32_t look ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
  {
#line 424
  degrees = 0;
#line 425
  mins = 0;
#line 426
  secs = 0;
#line 429
  tmp = csv2_get_1st(stream, & csv2_is_number, 0);
  }
#line 429
  if (tmp != 1) {
#line 430
    return ((uint32_t )0);
  }
  {
#line 433
  degrees = csv2_get_int(stream, 0);
#line 435
  tmp___0 = csv2_get_1st(stream, & csv2_is_alphanum, 0);
  }
#line 435
  if (tmp___0 != 1) {
#line 436
    return ((uint32_t )0);
  }
  {
#line 439
  look = csv2_justread(stream);
  }
#line 440
  if (look == (int32_t )r1) {
#line 441
    goto process;
  } else
#line 440
  if (look == (int32_t )r2) {
#line 441
    goto process;
  } else
#line 440
  if (look == (int32_t )r3) {
#line 441
    goto process;
  } else
#line 440
  if (look == (int32_t )r4) {
#line 441
    goto process;
  } else {
    {
#line 442
    tmp___1 = csv2_is_number(look);
    }
#line 442
    if (tmp___1) {
      {
#line 443
      mins = csv2_get_int(stream, 0);
      }
    } else {
#line 445
      return ((uint32_t )0);
    }
  }
  {
#line 448
  tmp___2 = csv2_get_1st(stream, & csv2_is_alphanum, 0);
  }
#line 448
  if (tmp___2 != 1) {
#line 449
    return ((uint32_t )0);
  }
  {
#line 452
  look = csv2_justread(stream);
  }
#line 453
  if (look == (int32_t )r1) {
#line 454
    goto process;
  } else
#line 453
  if (look == (int32_t )r2) {
#line 454
    goto process;
  } else
#line 453
  if (look == (int32_t )r3) {
#line 454
    goto process;
  } else
#line 453
  if (look == (int32_t )r4) {
#line 454
    goto process;
  } else {
    {
#line 455
    tmp___3 = csv2_is_number(look);
    }
#line 455
    if (tmp___3) {
      {
#line 456
      secs = csv2_get_int(stream, 3);
      }
    } else {
#line 458
      return ((uint32_t )0);
    }
  }
  {
#line 461
  tmp___4 = csv2_get_1st(stream, & csv2_is_alphanum, 0);
  }
#line 461
  if (tmp___4 != 1) {
#line 462
    return ((uint32_t )0);
  }
  {
#line 464
  look = csv2_justread(stream);
  }
  process: 
#line 468
  if (look != (int32_t )r1) {
#line 468
    if (look != (int32_t )r2) {
#line 468
      if (look != (int32_t )r3) {
#line 468
        if (look != (int32_t )r4) {
#line 469
          return ((uint32_t )0);
        }
      }
    }
  }
#line 472
  out = 2147483648U;
#line 474
  if (look == (int32_t )r1) {
#line 475
    out += (uint32_t )((degrees * 3600000 + mins * 60000) + secs);
  } else
#line 474
  if (look == (int32_t )r2) {
#line 475
    out += (uint32_t )((degrees * 3600000 + mins * 60000) + secs);
  } else {
#line 477
    out -= (uint32_t )((degrees * 3600000 + mins * 60000) + secs);
  }
  {
#line 482
  csv2_read_unicode(stream);
  }
#line 484
  return (out);
}
}
#line 489 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
js_string *csv2_get_loc(csv2_read *stream ) 
{ 
  uint32_t lat ;
  uint32_t lon ;
  uint32_t alt ;
  int size ;
  int hpre ;
  int vpre ;
  int32_t look ;
  int32_t get ;
  int x ;
  js_string *out ;
  int tmp ;
  int q ;
  int v ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
  {
#line 490
  lat = (uint32_t )0;
#line 491
  lon = (uint32_t )0;
#line 492
  alt = (uint32_t )0;
#line 493
  size = -1;
#line 494
  hpre = -1;
#line 495
  vpre = -1;
#line 503
  lat = csv2_get_lon_lat(stream, (char )'N', (char )'n', (char )'S', (char )'s');
#line 504
  lon = csv2_get_lon_lat(stream, (char )'E', (char )'e', (char )'W', (char )'w');
#line 507
  tmp = csv2_get_1st(stream, & csv2_is_signed_num, 0);
  }
#line 507
  if (tmp == 0) {
#line 508
    return ((js_string *)0);
  }
  {
#line 510
  get = csv2_get_int(stream, 2);
#line 511
  get += 10000000;
  }
#line 512
  if (get < 0) {
#line 513
    return ((js_string *)0);
  }
  {
#line 515
  alt = (uint32_t )get;
#line 516
  look = csv2_read_unicode(stream);
  }
#line 517
  if (look == 109) {
    {
#line 518
    look = csv2_read_unicode(stream);
    }
  }
#line 523
  get = -2;
#line 526
  if ((int )stream->tilde_handling == 103) {
    {
#line 527
    csv2_allow_tilde(stream);
    }
  }
#line 530
  x = 0;
  {
#line 530
  while (1) {
    while_continue: /* CIL Label */ ;
#line 530
    if (! (x < 1000)) {
#line 530
      goto while_break;
    }
    {
#line 531
    tmp___0 = csv2_is_wks(look);
    }
#line 531
    if (tmp___0) {
#line 531
      goto _L;
    } else
#line 531
    if (look == 13) {
#line 531
      goto _L;
    } else
#line 531
    if (look == 10) {
#line 531
      goto _L;
    } else
#line 531
    if (look == -2) {
#line 531
      goto _L;
    } else {
      {
#line 531
      tmp___1 = csv2_is_hash(look);
      }
#line 531
      if (tmp___1) {
        _L: /* CIL Label */ 
#line 533
        q = 1;
#line 534
        v = 0;
#line 535
        if (get != -2) {
#line 536
          if (get == -1) {
#line 537
            get = 1;
          }
          {
#line 539
          while (1) {
            while_continue___0: /* CIL Label */ ;
#line 539
            if (get >= 10) {
#line 539
              if (! (q < 10)) {
#line 539
                goto while_break___0;
              }
            } else {
#line 539
              goto while_break___0;
            }
#line 540
            q ++;
#line 541
            get /= 10;
          }
          while_break___0: /* CIL Label */ ;
          }
#line 543
          q ++;
#line 544
          v = (get & 15) << 4;
#line 545
          v |= q & 15;
#line 546
          if (size == -1) {
#line 547
            size = v;
          } else
#line 549
          if (hpre == -1) {
#line 550
            hpre = v;
          } else
#line 552
          if (vpre == -1) {
#line 553
            vpre = v;
          } else {
            {
#line 556
            printf((char const   */* __restrict  */)"here\n");
            }
#line 557
            return ((js_string *)0);
          }
#line 559
          get = -2;
        }
      }
    }
#line 563
    if ((int )stream->tilde_handling != 103) {
#line 564
      if (look == -2) {
#line 565
        goto while_break;
      } else
#line 564
      if (look == 10) {
#line 565
        goto while_break;
      } else
#line 564
      if (look == 13) {
#line 565
        goto while_break;
      } else {
        {
#line 567
        tmp___2 = csv2_is_hash(look);
        }
#line 567
        if (tmp___2) {
          {
#line 568
          process_comment(stream);
          }
#line 569
          goto while_break;
        }
      }
    } else
#line 574
    if (look == 126) {
#line 575
      goto while_break;
    } else {
      {
#line 576
      tmp___3 = csv2_is_hash(look);
      }
#line 576
      if (tmp___3) {
        {
#line 577
        process_comment(stream);
#line 578
        look = csv2_read_unicode(stream);
        }
#line 579
        goto __Cont;
      }
    }
    {
#line 583
    tmp___5 = csv2_is_number(look);
    }
#line 583
    if (tmp___5) {
#line 584
      if (get < 0) {
#line 585
        get = 0;
      }
#line 587
      get *= 10;
#line 588
      get += look - 48;
    } else {
      {
#line 592
      tmp___4 = csv2_is_wks(look);
      }
#line 592
      if (! tmp___4) {
#line 592
        if (look != 109) {
#line 592
          if ((int )stream->tilde_handling == 103) {
#line 592
            if (! (look == 13)) {
#line 592
              if (! (look == 10)) {
#line 595
                return ((js_string *)0);
              }
            }
          } else {
#line 595
            return ((js_string *)0);
          }
        }
      }
    }
    {
#line 597
    look = csv2_read_unicode(stream);
    }
    __Cont: /* CIL Label */ 
#line 530
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 600
  if (size == -1) {
#line 601
    size = 18;
  }
#line 603
  if (hpre == -1) {
#line 604
    hpre = 22;
  }
#line 606
  if (vpre == -1) {
#line 607
    vpre = 19;
  }
  {
#line 610
  out = js_create(18U, 1U);
  }
#line 610
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 611
    return ((js_string *)0);
  }
#line 613
  *(out->string) = (unsigned char)0;
#line 615
  *(out->string + 1) = (unsigned char )(size & 255);
#line 616
  *(out->string + 2) = (unsigned char )(hpre & 255);
#line 617
  *(out->string + 3) = (unsigned char )(vpre & 255);
#line 619
  *(out->string + 4) = (unsigned char )((lat >> 24) & 255U);
#line 620
  *(out->string + 5) = (unsigned char )((lat >> 16) & 255U);
#line 621
  *(out->string + 6) = (unsigned char )((lat >> 8) & 255U);
#line 622
  *(out->string + 7) = (unsigned char )(lat & 255U);
#line 624
  *(out->string + 8) = (unsigned char )((lon >> 24) & 255U);
#line 625
  *(out->string + 9) = (unsigned char )((lon >> 16) & 255U);
#line 626
  *(out->string + 10) = (unsigned char )((lon >> 8) & 255U);
#line 627
  *(out->string + 11) = (unsigned char )(lon & 255U);
#line 629
  *(out->string + 12) = (unsigned char )((alt >> 24) & 255U);
#line 630
  *(out->string + 13) = (unsigned char )((alt >> 16) & 255U);
#line 631
  *(out->string + 14) = (unsigned char )((alt >> 8) & 255U);
#line 632
  *(out->string + 15) = (unsigned char )(alt & 255U);
#line 633
  out->unit_count = 16U;
#line 634
  return (out);
}
}
#line 640 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_wks.c"
js_string *csv2_get_naptr(csv2_read *stream ) 
{ 
  js_string *out ;
  js_string *name ;
  js_string *zone ;
  int num ;
  int c ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 643
  out = (js_string *)0;
#line 644
  name = (js_string *)0;
#line 645
  zone = (js_string *)0;
#line 646
  num = 0;
#line 647
  c = 0;
#line 649
  out = js_create(256U, 1U);
  }
#line 650
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 651
    return ((js_string *)0);
  }
#line 656
  c = 1;
  {
#line 656
  while (1) {
    while_continue: /* CIL Label */ ;
#line 656
    if (! (c <= 2)) {
#line 656
      goto while_break;
    }
    {
#line 657
    num = csv2_get_num(stream);
    }
#line 657
    if (num < 0) {
      {
#line 658
      js_destroy(out);
      }
#line 659
      return ((js_string *)0);
    }
    {
#line 661
    tmp = js_adduint16(out, num);
    }
#line 661
    if (tmp == -1) {
      {
#line 662
      js_destroy(out);
      }
#line 663
      return ((js_string *)0);
    }
#line 656
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 668
  name = csv2_get_string(stream, 3, 1);
  }
#line 669
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
    {
#line 670
    js_destroy(out);
    }
#line 671
    return ((js_string *)0);
  }
  {
#line 675
  tmp___0 = js_append(name, out);
  }
#line 675
  if (tmp___0 == -1) {
    {
#line 676
    js_destroy(name);
#line 677
    js_destroy(out);
    }
#line 678
    return ((js_string *)0);
  }
  {
#line 681
  js_destroy(name);
#line 684
  tmp___1 = csv2_get_1st(stream, & csv2_is_dchar, 0);
  }
#line 684
  if (tmp___1 != 1) {
    {
#line 685
    js_destroy(out);
    }
#line 686
    return ((js_string *)0);
  }
  {
#line 689
  zone = js_create(256U, 1U);
  }
#line 692
  if ((unsigned long )zone == (unsigned long )((js_string *)0)) {
    {
#line 693
    js_destroy(out);
    }
#line 694
    return ((js_string *)0);
  }
  {
#line 697
  name = csv2_get_hostname(stream, zone, 3);
#line 699
  js_destroy(zone);
  }
#line 701
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
    {
#line 702
    js_destroy(out);
    }
#line 703
    return ((js_string *)0);
  }
  {
#line 707
  tmp___2 = js_append(name, out);
  }
#line 707
  if (tmp___2 == -1) {
    {
#line 708
    js_destroy(name);
#line 709
    js_destroy(out);
    }
#line 710
    return ((js_string *)0);
  }
  {
#line 713
  js_destroy(name);
  }
#line 714
  return (out);
}
}
#line 34 "/home/wheatley/newnew/temp/maradns-2.0.09/qual/qual_timestamp.c"
int num_tries  =    0;
#line 47 "/home/wheatley/newnew/temp/maradns-2.0.09/qual/qual_timestamp.c"
int64_t qual_get_time(void) 
{ 
  int64_t ttime ;

  {
#line 52
  ttime = the_time;
#line 56
  return (ttime);
}
}
#line 64 "/home/wheatley/newnew/temp/maradns-2.0.09/qual/qual_timestamp.c"
int qual_set_time(void) 
{ 
  time_t sys_time ;
  int64_t ttime ;

  {
  {
#line 68
  sys_time = time((time_t *)0);
  }
#line 70
  if (sizeof(sys_time) > 4UL) {
#line 71
    if (sys_time == -1L) {
#line 72
      return (-1);
    }
#line 74
    ttime = sys_time - 290805600L;
  } else
#line 82
  if (sys_time == -1L) {
#line 82
    if (num_tries < 3) {
#line 83
      num_tries ++;
#line 84
      return (1);
    } else {
#line 82
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 86
  if (sys_time == -1L) {
#line 87
    return (-1);
  } else
#line 99
  if (sys_time < 290805600L) {
#line 101
    ttime = sys_time + 4004161696L;
#line 102
    num_tries = 0;
  } else {
#line 105
    ttime = sys_time - 290805600L;
#line 106
    num_tries = 0;
  }
#line 112
  the_time = ttime;
#line 116
  return (1);
}
}
#line 45 "/home/wheatley/newnew/temp/maradns-2.0.09/server/read_kvars.c"
int read_numeric_kvar(char *name , int default_value ) 
{ 
  js_string *kvar_name ;
  js_string *kvar_value ;
  int ret ;
  int status ;
  int tmp ;
  unsigned int tmp___0 ;

  {
  {
#line 50
  kvar_name = js_create(64U, 1U);
  }
#line 50
  if ((unsigned long )kvar_name == (unsigned long )((js_string *)0)) {
    {
#line 51
    printf((char const   */* __restrict  */)"Aieeeeeee!\n");
#line 52
    exit(1);
    }
#line 53
    return (-1);
  }
  {
#line 56
  kvar_value = js_create(256U, 1U);
  }
#line 56
  if ((unsigned long )kvar_value == (unsigned long )((js_string *)0)) {
    {
#line 57
    printf((char const   */* __restrict  */)"Aieeeeeeee!\n");
#line 58
    exit(1);
#line 59
    js_destroy(kvar_name);
    }
#line 60
    return (-1);
  }
  {
#line 63
  js_set_encode(kvar_name, 3);
#line 64
  js_set_encode(kvar_value, 3);
#line 66
  tmp = js_qstr2js(kvar_name, name);
  }
#line 66
  if (tmp == -1) {
    {
#line 67
    js_destroy(kvar_name);
#line 68
    js_destroy(kvar_value);
#line 69
    harderror((char *)"Could not create kvar_query");
    }
  }
  {
#line 72
  status = read_kvar(kvar_name, kvar_value);
  }
#line 74
  if (status == -1) {
    {
#line 75
    js_destroy(kvar_name);
#line 76
    js_destroy(kvar_value);
#line 77
    show_timestamp();
#line 78
    printf((char const   */* __restrict  */)"%s%s\n", "Error processing value for ",
           name);
    }
#line 79
    return (default_value);
  }
#line 82
  if (status == 0) {
    {
#line 83
    js_destroy(kvar_name);
#line 84
    js_destroy(kvar_value);
    }
#line 85
    return (default_value);
  }
  {
#line 88
  tmp___0 = js_atoi(kvar_value, 0);
#line 88
  ret = (int )tmp___0;
#line 90
  js_destroy(kvar_name);
#line 91
  js_destroy(kvar_value);
  }
#line 92
  return (ret);
}
}
#line 107 "/home/wheatley/newnew/temp/maradns-2.0.09/server/read_kvars.c"
js_string *read_string_kvar(char *name ) 
{ 
  js_string *kvar_name ;
  js_string *kvar_value ;
  int status ;
  int tmp ;

  {
  {
#line 112
  kvar_name = js_create(64U, 1U);
  }
#line 112
  if ((unsigned long )kvar_name == (unsigned long )((js_string *)0)) {
    {
#line 113
    printf((char const   */* __restrict  */)"Aiiieeeeeee!\n");
#line 114
    exit(1);
    }
#line 115
    return ((js_string *)0);
  }
  {
#line 118
  kvar_value = js_create(256U, 1U);
  }
#line 118
  if ((unsigned long )kvar_value == (unsigned long )((js_string *)0)) {
    {
#line 119
    printf((char const   */* __restrict  */)"Aiiieeeeeeeeee!\n");
#line 120
    exit(1);
#line 121
    js_destroy(kvar_name);
    }
#line 122
    return ((js_string *)0);
  }
  {
#line 125
  js_set_encode(kvar_name, 3);
#line 126
  js_set_encode(kvar_value, 3);
#line 128
  tmp = js_qstr2js(kvar_name, name);
  }
#line 128
  if (tmp == -1) {
    {
#line 129
    js_destroy(kvar_name);
#line 130
    js_destroy(kvar_value);
#line 131
    harderror((char *)"Could not create kvar_query");
    }
  }
  {
#line 134
  status = read_kvar(kvar_name, kvar_value);
  }
#line 136
  if (status == -1) {
    {
#line 137
    js_destroy(kvar_name);
#line 138
    js_destroy(kvar_value);
#line 139
    show_timestamp();
#line 140
    printf((char const   */* __restrict  */)"%s%s\n", "Error processing value for ",
           name);
    }
#line 141
    return ((js_string *)0);
  }
#line 144
  if (status == 0) {
    {
#line 145
    js_destroy(kvar_name);
#line 146
    js_destroy(kvar_value);
    }
#line 147
    return ((js_string *)0);
  }
  {
#line 150
  js_destroy(kvar_name);
  }
#line 151
  return (kvar_value);
}
}
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
csv2_add_state *csv2_init_add_state(js_string *zone ) ;
#line 53
void csv2_zap_add_state(csv2_add_state *x ) ;
#line 58
int csv2_set_bighash(csv2_add_state *state , mhash *bighash ) ;
#line 63
int csv2_set_add_method(csv2_add_state *state , int method ) ;
#line 67
int csv2_close_state(csv2_add_state *state ) ;
#line 72
int csv2_set_soa_serial(csv2_add_state *state , js_string *filename ) ;
#line 77
js_string *csv2_zone_to_udpzone(js_string *zone ) ;
#line 86
int csv2_add_rr_debug(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                      js_string *data ) ;
#line 95
int csv2_add_rr_bighash(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                        js_string *data , int32_t starwhitis ) ;
#line 104
int csv2_add_rr_zoneserver(csv2_add_state *state , js_string *query , int rtype ,
                           int32_t ttl , js_string *data ) ;
#line 111
js_string *csv2_synth_query(csv2_add_state *state ) ;
#line 114
int csv2_synthesize_soa(csv2_add_state *state ) ;
#line 121
js_string *csv2_synth_ip(csv2_add_state *state , uint32_t ip , int actually_make_record ) ;
#line 125
int csv2_make_synth_ns(csv2_add_state *state , uint32_t ip ) ;
#line 130
int csv2_is_private_ip(uint32_t ip ) ;
#line 135
int csv2_is_localhost_ip(uint32_t ip ) ;
#line 139
int csv2_synthesize_ns(csv2_add_state *state ) ;
#line 143
csv2_rr *copy_csv2_rr(csv2_rr *source ) ;
#line 148
int csv2_push_buffer(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                     js_string *data ) ;
#line 155
int csv2_set_soa(csv2_add_state *state , js_string *query , js_string *data , int32_t ttl ) ;
#line 160
int csv2_is_zonetop(csv2_add_state *state , js_string *query ) ;
#line 164
int csv2_pop_buffer(csv2_add_state *state ) ;
#line 167
int csv2_add_soa(csv2_add_state *state ) ;
#line 171
js_string *csv2_copy_js(js_string *s ) ;
#line 180
int csv2_add_rr_w(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                  js_string *data ) ;
#line 249 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) struct tm *( __attribute__((__leaf__)) gmtime_r)(time_t const   * __restrict  __timer ,
                                                                                      struct tm * __restrict  __tp ) ;
#line 44 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
ipv4pair *get_synthip_list(void) ;
#line 45
js_string *show_synth_soa_origin(void) ;
#line 46
int show_synth_soa_serial(void) ;
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
csv2_add_state *csv2_init_add_state(js_string *zone ) 
{ 
  js_string *nzone ;
  js_string *norigin ;
  csv2_add_state *new ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 70
  if (zone->unit_size != 1U) {
#line 71
    return ((csv2_add_state *)0);
  }
  {
#line 73
  tmp = js_alloc(1, (int )sizeof(csv2_add_state ));
#line 73
  new = (csv2_add_state *)tmp;
  }
#line 73
  if ((unsigned long )new == (unsigned long )((csv2_add_state *)0)) {
#line 74
    return ((csv2_add_state *)0);
  }
  {
#line 76
  nzone = js_create(zone->unit_count + 1U, 1U);
  }
#line 76
  if ((unsigned long )nzone == (unsigned long )((js_string *)0)) {
    {
#line 77
    js_dealloc((void *)new);
    }
#line 78
    return ((csv2_add_state *)0);
  }
  {
#line 80
  norigin = js_create(zone->unit_count + 1U, 1U);
  }
#line 80
  if ((unsigned long )norigin == (unsigned long )((js_string *)0)) {
    {
#line 81
    js_dealloc((void *)new);
    }
#line 82
    return ((csv2_add_state *)0);
  }
  {
#line 84
  tmp___0 = js_copy(zone, nzone);
  }
#line 84
  if (tmp___0 == -1) {
    {
#line 85
    js_destroy(nzone);
#line 86
    js_dealloc((void *)new);
    }
#line 87
    return ((csv2_add_state *)0);
  }
  {
#line 89
  tmp___1 = js_copy(zone, norigin);
  }
#line 89
  if (tmp___1 == -1) {
    {
#line 90
    js_destroy(nzone);
#line 91
    js_dealloc((void *)new);
    }
#line 92
    return ((csv2_add_state *)0);
  }
#line 94
  new->buffer = (csv2_rr *)0;
#line 95
  new->zone = nzone;
#line 96
  new->origin = norigin;
#line 97
  new->ostack = (csv2_origin *)0;
#line 99
  new->ostack_height = 0;
#line 100
  new->rrnum = 0;
#line 101
  new->bighash = (mhash *)0;
#line 102
  new->add_method = 0;
#line 103
  new->soa_serial = 1;
#line 104
  new->default_ttl = 86400;
#line 105
  new->in_ns = 1;
#line 106
  new->zone_nses_added = 0;
#line 107
  return (new);
}
}
#line 110 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
void csv2_zap_add_state(csv2_add_state *x ) 
{ 
  int a ;
  csv2_origin *v ;
  csv2_origin *q ;
  csv2_rr *y ;
  csv2_rr *z ;

  {
#line 111
  a = 0;
#line 116
  v = x->ostack;
  {
#line 117
  while (1) {
    while_continue: /* CIL Label */ ;
#line 117
    if ((unsigned long )v != (unsigned long )((csv2_origin *)0)) {
#line 117
      if (! (a < 10000)) {
#line 117
        goto while_break;
      }
    } else {
#line 117
      goto while_break;
    }
    {
#line 118
    js_destroy(v->origin);
#line 119
    q = v->next;
#line 120
    js_dealloc((void *)v);
#line 121
    v = q;
#line 122
    a ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 124
  a = 0;
#line 127
  y = x->buffer;
  {
#line 128
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 128
    if ((unsigned long )y != (unsigned long )((csv2_rr *)0)) {
#line 128
      if (! (a < 10000)) {
#line 128
        goto while_break___0;
      }
    } else {
#line 128
      goto while_break___0;
    }
    {
#line 129
    js_destroy(y->query);
#line 130
    js_destroy(y->data);
#line 131
    z = y->next;
#line 132
    js_dealloc((void *)y);
#line 133
    y = z;
#line 134
    a ++;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
#line 136
  a = 0;
#line 139
  if ((unsigned long )x->zone != (unsigned long )((js_string *)0)) {
    {
#line 140
    js_destroy(x->zone);
#line 141
    x->zone = (js_string *)0;
    }
  }
#line 144
  if ((unsigned long )x->origin != (unsigned long )((js_string *)0)) {
    {
#line 145
    js_destroy(x->origin);
#line 146
    x->origin = (js_string *)0;
    }
  }
  {
#line 150
  js_dealloc((void *)x);
  }
#line 151
  return;
}
}
#line 160 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_set_bighash(csv2_add_state *state , mhash *bighash ) 
{ 


  {
#line 161
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 162
    return (-1);
  }
#line 164
  state->bighash = bighash;
#line 165
  return (1);
}
}
#line 171 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_set_add_method(csv2_add_state *state , int method ) 
{ 


  {
#line 172
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 173
    return (-1);
  }
#line 175
  state->add_method = method;
#line 176
  return (1);
}
}
#line 181 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_close_state(csv2_add_state *state ) 
{ 


  {
  {
#line 182
  csv2_zap_add_state(state);
  }
#line 183
  return (1);
}
}
#line 189 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_set_soa_serial(csv2_add_state *state , js_string *filename ) 
{ 
  char name[256] ;
  struct stat buf ;
  time_t t ;
  int64_t q ;
  int tmp ;
  int tmp___0 ;
  struct tm bd ;
  struct tm *tmp___1 ;
  int tmp___2 ;

  {
  {
#line 194
  tmp = js_js2str(filename, name, 200);
  }
#line 194
  if (tmp == -1) {
#line 195
    return (-1);
  }
  {
#line 197
  tmp___0 = stat((char const   */* __restrict  */)(name), (struct stat */* __restrict  */)(& buf));
  }
#line 197
  if (tmp___0 == -1) {
#line 198
    return (-1);
  }
#line 200
  t = buf.st_mtim.tv_sec;
#line 202
  if (t < 290805600L) {
#line 203
    t += 2147483648L;
  }
  {
#line 205
  tmp___2 = show_synth_soa_serial();
  }
#line 205
  if (tmp___2 != 2) {
#line 206
    q = t;
#line 207
    q -= 290805600L;
#line 208
    q /= 6L;
  } else {
    {
#line 214
    tmp___1 = gmtime_r((time_t const   */* __restrict  */)(& t), (struct tm */* __restrict  */)(& bd));
    }
#line 214
    if ((unsigned long )tmp___1 == (unsigned long )((void *)0)) {
#line 215
      return (1979032815);
    }
#line 220
    q = (int64_t )(bd.tm_year + 1900);
#line 221
    q *= 100L;
#line 222
    q += (int64_t )(bd.tm_mon + 1);
#line 223
    q *= 100L;
#line 224
    q += (int64_t )bd.tm_mday;
#line 225
    q *= 100L;
#line 226
    q += (int64_t )bd.tm_hour;
  }
#line 228
  state->soa_serial = (int32_t )q;
#line 229
  return (1);
}
}
#line 235 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_zone_to_udpzone(js_string *zone ) 
{ 
  js_string *udpzone ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 240
  udpzone = js_create(128U, 1U);
  }
#line 240
  if ((unsigned long )udpzone == (unsigned long )((js_string *)0)) {
#line 241
    return ((js_string *)0);
  }
  {
#line 243
  tmp = js_qstr2js(udpzone, (char *)"A");
  }
#line 243
  if (tmp == -1) {
    {
#line 244
    js_destroy(udpzone);
    }
#line 245
    return ((js_string *)0);
  }
  {
#line 247
  tmp___0 = js_append(zone, udpzone);
  }
#line 247
  if (tmp___0 == -1) {
    {
#line 248
    js_destroy(udpzone);
    }
#line 249
    return ((js_string *)0);
  }
  {
#line 251
  tmp___1 = hname_2rfc1035_starwhitis(udpzone, 1);
  }
#line 251
  if (tmp___1 == -1) {
    {
#line 252
    js_destroy(udpzone);
    }
#line 256
    return ((js_string *)0);
  }
#line 258
  return (udpzone);
}
}
#line 268 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_rr_debug(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                      js_string *data ) 
{ 


  {
#line 270
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 271
    return (-1);
  }
  {
#line 273
  printf((char const   */* __restrict  */)"Name: ");
#line 274
  show_esc_stdout(query);
#line 275
  printf((char const   */* __restrict  */)"\nrtype: %d\nttl %d\n", rtype, ttl);
#line 276
  printf((char const   */* __restrict  */)"rddata: ");
#line 276
  show_esc_stdout(data);
#line 276
  printf((char const   */* __restrict  */)"\n\n");
  }
#line 277
  return (1);
}
}
#line 286 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_rr_bighash(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                        js_string *data , int32_t starwhitis ) 
{ 
  js_string *cquery ;
  js_string *udpzone ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 292
  if ((unsigned long )state->bighash == (unsigned long )((mhash *)0)) {
#line 293
    return (-1);
  }
#line 295
  if ((unsigned long )state->zone == (unsigned long )((js_string *)0)) {
#line 296
    return (-1);
  }
#line 298
  if ((unsigned long )state->origin == (unsigned long )((js_string *)0)) {
#line 299
    return (-1);
  }
  {
#line 301
  tmp = js_has_sanity(query);
  }
#line 301
  if (tmp == -1) {
#line 302
    return (-1);
  }
#line 304
  if (query->unit_size != 1U) {
#line 305
    return (-1);
  }
  {
#line 307
  tmp___0 = js_has_sanity(data);
  }
#line 307
  if (tmp___0 == -1) {
#line 308
    return (-1);
  }
#line 310
  if (data->unit_size != 1U) {
#line 311
    return (-1);
  }
#line 314
  if (ttl < 60) {
#line 315
    ttl = 60;
  }
#line 317
  if (ttl > 63072000) {
#line 318
    ttl = 63072000;
  }
  {
#line 323
  cquery = js_create(query->unit_count + 3U, 1U);
  }
#line 323
  if ((unsigned long )cquery == (unsigned long )((js_string *)0)) {
#line 324
    return (-1);
  }
  {
#line 326
  tmp___1 = js_copy(query, cquery);
  }
#line 326
  if (tmp___1 == -1) {
    {
#line 327
    js_destroy(cquery);
    }
#line 328
    return (-1);
  }
  {
#line 330
  tmp___2 = js_adduint16(cquery, rtype);
  }
#line 330
  if (tmp___2 == -1) {
    {
#line 331
    js_destroy(cquery);
    }
#line 332
    return (-1);
  }
  {
#line 335
  udpzone = csv2_zone_to_udpzone(state->zone);
  }
#line 335
  if ((unsigned long )udpzone == (unsigned long )((js_string *)0)) {
    {
#line 336
    js_destroy(cquery);
    }
#line 337
    return (-1);
  }
  {
#line 341
  tmp___3 = js_adduint16(udpzone, 2);
  }
#line 341
  if (tmp___3 == -1) {
    {
#line 342
    js_destroy(cquery);
#line 343
    js_destroy(udpzone);
    }
#line 344
    return (-1);
  }
  {
#line 348
  add_rr_to_bighash(state->bighash, cquery, data, (uint32_t )ttl, udpzone, (uint16_t )0);
#line 349
  js_destroy(udpzone);
#line 350
  js_destroy(cquery);
  }
#line 351
  return (1);
}
}
#line 360 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_rr_zoneserver(csv2_add_state *state , js_string *query , int rtype ,
                           int32_t ttl , js_string *data ) 
{ 
  int ret ;
  js_string *cquery ;
  int tmp ;
  int tmp___0 ;

  {
#line 368
  if (rtype == 6) {
#line 369
    return (1);
  }
#line 375
  if (query->unit_count >= 1U) {
#line 375
    if ((int )*(query->string) == 95) {
      {
#line 376
      cquery = js_create(query->unit_count + 2U, 1U);
      }
#line 376
      if ((unsigned long )cquery == (unsigned long )((js_string *)0)) {
#line 377
        return (-1);
      }
      {
#line 381
      tmp = js_qstr2js(cquery, (char *)"\001");
      }
#line 381
      if (tmp == -1) {
        {
#line 382
        js_destroy(cquery);
        }
#line 383
        return (-1);
      }
      {
#line 387
      tmp___0 = js_append(query, cquery);
      }
#line 387
      if (tmp___0 == -1) {
        {
#line 388
        js_destroy(cquery);
        }
#line 389
        return (-1);
      }
#line 393
      if (cquery->unit_count < 2U) {
        {
#line 394
        js_destroy(cquery);
        }
#line 395
        return (-1);
      }
      {
#line 397
      *(cquery->string + 1) = (unsigned char )'*';
#line 399
      ret = csv2_push_buffer(state, cquery, rtype, ttl, data);
#line 400
      js_destroy(cquery);
      }
    } else {
      {
#line 402
      ret = csv2_push_buffer(state, query, rtype, ttl, data);
      }
    }
  } else {
    {
#line 402
    ret = csv2_push_buffer(state, query, rtype, ttl, data);
    }
  }
#line 404
  return (ret);
}
}
#line 411 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_synth_query(csv2_add_state *state ) 
{ 
  js_string *query ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 416
  query = js_create(256U, 1U);
  }
#line 416
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
#line 417
    return ((js_string *)0);
  }
  {
#line 419
  tmp = js_qstr2js(query, (char *)"Z");
  }
#line 419
  if (tmp == -1) {
    {
#line 420
    js_destroy(query);
    }
#line 421
    return ((js_string *)0);
  }
  {
#line 423
  tmp___0 = js_append(state->zone, query);
  }
#line 423
  if (tmp___0 == -1) {
    {
#line 424
    js_destroy(query);
    }
#line 425
    return ((js_string *)0);
  }
  {
#line 427
  tmp___1 = hname_2rfc1035(query);
  }
#line 427
  if (tmp___1 == -1) {
    {
#line 428
    js_destroy(query);
    }
#line 429
    return ((js_string *)0);
  }
#line 431
  return (query);
}
}
#line 435 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_synthesize_soa(csv2_add_state *state ) 
{ 
  js_string *query ;
  js_string *email ;
  js_string *data ;
  int ret ;
  int tmp ;
  js_string *tmp___0 ;
  int tmp___1 ;
  js_string *tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;

  {
  {
#line 440
  query = csv2_synth_query(state);
  }
#line 440
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
#line 441
    return (-1);
  }
  {
#line 447
  data = js_create(256U, 1U);
  }
#line 447
  if ((unsigned long )data == (unsigned long )((js_string *)0)) {
    {
#line 448
    js_destroy(query);
    }
#line 449
    return (-1);
  }
  {
#line 451
  tmp___2 = show_synth_soa_origin();
  }
#line 451
  if ((unsigned long )tmp___2 == (unsigned long )((js_string *)0)) {
    {
#line 453
    tmp = js_copy(query, data);
    }
#line 453
    if (tmp == -1) {
      {
#line 454
      js_destroy(query);
#line 455
      js_destroy(data);
      }
#line 456
      return (-1);
    }
  } else {
    {
#line 459
    tmp___0 = show_synth_soa_origin();
#line 459
    tmp___1 = js_copy(tmp___0, data);
    }
#line 459
    if (tmp___1 == -1) {
      {
#line 460
      js_destroy(query);
#line 461
      js_destroy(data);
      }
#line 462
      return (-1);
    }
  }
  {
#line 468
  email = js_create(256U, 1U);
  }
#line 468
  if ((unsigned long )email == (unsigned long )((js_string *)0)) {
    {
#line 469
    js_destroy(query);
#line 470
    js_destroy(data);
    }
#line 471
    return (-1);
  }
  {
#line 473
  tmp___3 = js_qappend((char *)"Zhostmaster.", email);
  }
#line 473
  if (tmp___3 == -1) {
    {
#line 474
    js_destroy(query);
#line 475
    js_destroy(data);
#line 476
    js_destroy(email);
    }
#line 477
    return (-1);
  }
  {
#line 479
  tmp___4 = js_append(state->zone, email);
  }
#line 479
  if (tmp___4 == -1) {
    {
#line 480
    js_destroy(query);
#line 481
    js_destroy(data);
#line 482
    js_destroy(email);
    }
#line 483
    return (-1);
  }
  {
#line 485
  tmp___5 = hname_2rfc1035(email);
  }
#line 485
  if (tmp___5 == -1) {
    {
#line 486
    js_destroy(query);
#line 487
    js_destroy(data);
#line 488
    js_destroy(email);
    }
#line 489
    return (-1);
  }
  {
#line 491
  tmp___6 = js_append(email, data);
  }
#line 491
  if (tmp___6 == -1) {
    {
#line 492
    js_destroy(query);
#line 493
    js_destroy(data);
#line 494
    js_destroy(email);
    }
#line 495
    return (-1);
  }
  {
#line 497
  js_destroy(email);
#line 500
  tmp___7 = js_adduint32(data, (uint32_t )state->soa_serial);
  }
#line 500
  if (tmp___7 == -1) {
    {
#line 501
    js_destroy(query);
#line 502
    js_destroy(data);
    }
#line 503
    return (-1);
  }
  {
#line 507
  tmp___8 = js_adduint32(data, (uint32_t )7200);
  }
#line 507
  if (tmp___8 == -1) {
    {
#line 508
    js_destroy(query);
#line 509
    js_destroy(data);
    }
#line 510
    return (-1);
  }
  {
#line 514
  tmp___9 = js_adduint32(data, (uint32_t )3600);
  }
#line 514
  if (tmp___9 == -1) {
    {
#line 515
    js_destroy(query);
#line 516
    js_destroy(data);
    }
#line 517
    return (-1);
  }
  {
#line 521
  tmp___10 = js_adduint32(data, (uint32_t )604800);
  }
#line 521
  if (tmp___10 == -1) {
    {
#line 522
    js_destroy(query);
#line 523
    js_destroy(data);
    }
#line 524
    return (-1);
  }
  {
#line 528
  tmp___11 = js_adduint32(data, (uint32_t )3600);
  }
#line 528
  if (tmp___11 == -1) {
    {
#line 529
    js_destroy(query);
#line 530
    js_destroy(data);
    }
#line 531
    return (-1);
  }
  {
#line 534
  ret = csv2_set_soa(state, query, data, 86400);
#line 535
  js_destroy(query);
#line 536
  js_destroy(data);
  }
#line 537
  return (ret);
}
}
#line 545 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_synth_ip(csv2_add_state *state , uint32_t ip , int actually_make_record ) 
{ 
  js_string *name ;
  js_string *rddata ;
  int c ;
  int32_t q ;
  int tmp ;
  int32_t x ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
  {
#line 554
  name = js_create(20U + (state->zone)->unit_count, 1U);
  }
#line 554
  if ((unsigned long )name == (unsigned long )((js_string *)0)) {
#line 555
    return ((js_string *)0);
  }
  {
#line 557
  tmp = js_qstr2js(name, (char *)"Zsynth-ip-");
  }
#line 557
  if (tmp == 0) {
    {
#line 558
    js_destroy(name);
    }
#line 559
    return ((js_string *)0);
  }
#line 561
  q = (int32_t )ip;
#line 562
  c = 0;
  {
#line 562
  while (1) {
    while_continue: /* CIL Label */ ;
#line 562
    if (! (c < 8)) {
#line 562
      goto while_break;
    }
#line 564
    x = q;
#line 565
    x >>= 28;
#line 566
    x &= 15;
#line 567
    if (x < 10) {
      {
#line 568
      tmp___0 = js_addbyte(name, (unsigned char )(48 + x));
      }
#line 568
      if (tmp___0 == -1) {
        {
#line 569
        js_destroy(name);
        }
#line 570
        return ((js_string *)0);
      }
    } else {
      {
#line 573
      tmp___1 = js_addbyte(name, (unsigned char )(97 + (x - 10)));
      }
#line 573
      if (tmp___1 == -1) {
        {
#line 574
        js_destroy(name);
        }
#line 575
        return ((js_string *)0);
      }
    }
#line 578
    q <<= 4;
#line 562
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 580
  tmp___2 = js_qappend((char *)".", name);
  }
#line 580
  if (tmp___2 == -1) {
    {
#line 581
    js_destroy(name);
    }
#line 582
    return ((js_string *)0);
  }
  {
#line 584
  tmp___3 = js_append(state->zone, name);
  }
#line 584
  if (tmp___3 == -1) {
    {
#line 585
    js_destroy(name);
    }
#line 586
    return ((js_string *)0);
  }
  {
#line 588
  tmp___4 = hname_2rfc1035(name);
  }
#line 588
  if (tmp___4 == -1) {
    {
#line 589
    js_destroy(name);
    }
#line 590
    return ((js_string *)0);
  }
#line 595
  if (actually_make_record != 1) {
#line 596
    return (name);
  }
  {
#line 602
  rddata = js_create(5U, 1U);
  }
#line 602
  if ((unsigned long )rddata == (unsigned long )((js_string *)0)) {
    {
#line 603
    js_destroy(name);
    }
#line 604
    return ((js_string *)0);
  }
#line 606
  c = 3;
  {
#line 606
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 606
    if (! (c >= 0)) {
#line 606
      goto while_break___0;
    }
#line 607
    *(rddata->string + c) = (unsigned char )(ip & 255U);
#line 608
    ip >>= 8;
#line 606
    c --;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 610
  rddata->unit_count = 4U;
#line 611
  tmp___5 = csv2_add_rr_w(state, name, 1, 86400, rddata);
  }
#line 611
  if (tmp___5 == -1) {
    {
#line 612
    js_destroy(name);
#line 613
    js_destroy(rddata);
    }
#line 614
    return ((js_string *)0);
  }
  {
#line 616
  js_destroy(rddata);
  }
#line 618
  return (name);
}
}
#line 623 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_make_synth_ns(csv2_add_state *state , uint32_t ip ) 
{ 
  js_string *query ;
  js_string *data ;

  {
  {
#line 631
  query = csv2_synth_query(state);
  }
#line 631
  if ((unsigned long )query == (unsigned long )((js_string *)0)) {
#line 632
    return (-1);
  }
  {
#line 636
  data = csv2_synth_ip(state, ip, 0);
  }
#line 636
  if ((unsigned long )data == (unsigned long )((js_string *)0)) {
    {
#line 637
    js_destroy(query);
    }
#line 638
    return (-1);
  }
  {
#line 642
  csv2_add_rr_w(state, query, 2, 86400, data);
#line 643
  js_destroy(query);
#line 644
  js_destroy(data);
  }
#line 645
  return (1);
}
}
#line 651 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_is_private_ip(uint32_t ip ) 
{ 
  int tmp ;

  {
#line 652
  if ((ip & 4278190080U) == 2130706432U) {
#line 652
    tmp = 1;
  } else
#line 652
  if ((ip & 4278190080U) == 167772160U) {
#line 652
    tmp = 1;
  } else
#line 652
  if ((ip & 4293918720U) == 2886729728U) {
#line 652
    tmp = 1;
  } else
#line 652
  if ((ip & 4294901760U) == 3232235520U) {
#line 652
    tmp = 1;
  } else {
#line 652
    tmp = 0;
  }
#line 652
  return (tmp);
}
}
#line 661 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_is_localhost_ip(uint32_t ip ) 
{ 


  {
#line 662
  return ((ip & 4278190080U) == 2130706432U);
}
}
#line 667 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_synthesize_ns(csv2_add_state *state ) 
{ 
  ipv4pair *iplist ;
  int c ;
  int public_ips ;
  int non_localhost_ips ;
  js_string *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
  {
#line 671
  public_ips = 0;
#line 672
  non_localhost_ips = 0;
#line 675
  iplist = get_synthip_list();
#line 680
  c = 0;
  }
  {
#line 680
  while (1) {
    while_continue: /* CIL Label */ ;
#line 680
    if (! (c < 500)) {
#line 680
      goto while_break;
    }
#line 681
    if ((iplist + c)->ip == 4294967295U) {
#line 682
      goto while_break;
    }
#line 684
    if ((iplist + c)->ip == 0U) {
      {
#line 685
      printf((char const   */* __restrict  */)"Warning: No NS records can be syntesized\n");
      }
#line 686
      return (-1);
    }
#line 680
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 691
  c = 0;
  {
#line 691
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 691
    if (! (c < 500)) {
#line 691
      goto while_break___0;
    }
#line 692
    if ((iplist + c)->ip == 4294967295U) {
#line 693
      goto while_break___0;
    }
    {
#line 695
    tmp___0 = csv2_is_private_ip((iplist + c)->ip);
    }
#line 695
    if (! tmp___0) {
#line 696
      public_ips = 1;
#line 697
      non_localhost_ips = 1;
    }
#line 691
    c ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 702
  if (public_ips != 1) {
#line 703
    c = 0;
    {
#line 703
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 703
      if (! (c < 500)) {
#line 703
        goto while_break___1;
      }
#line 704
      if ((iplist + c)->ip == 4294967295U) {
#line 705
        goto while_break___1;
      }
      {
#line 707
      tmp___1 = csv2_is_localhost_ip((iplist + c)->ip);
      }
#line 707
      if (! tmp___1) {
#line 708
        non_localhost_ips = 1;
      }
#line 703
      c ++;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
#line 714
  if (public_ips == 1) {
#line 716
    c = 0;
    {
#line 716
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 716
      if (! (c < 500)) {
#line 716
        goto while_break___2;
      }
#line 717
      if ((iplist + c)->ip == 4294967295U) {
#line 718
        goto while_break___2;
      }
      {
#line 720
      tmp___2 = csv2_is_private_ip((iplist + c)->ip);
      }
#line 720
      if (! tmp___2) {
        {
#line 721
        csv2_make_synth_ns(state, (iplist + c)->ip);
        }
      }
#line 716
      c ++;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 725
    c = 0;
    {
#line 725
    while (1) {
      while_continue___3: /* CIL Label */ ;
#line 725
      if (! (c < 500)) {
#line 725
        goto while_break___3;
      }
#line 726
      if ((iplist + c)->ip == 4294967295U) {
#line 727
        goto while_break___3;
      }
      {
#line 729
      tmp___3 = csv2_is_private_ip((iplist + c)->ip);
      }
#line 729
      if (! tmp___3) {
        {
#line 730
        tmp = csv2_synth_ip(state, (iplist + c)->ip, 1);
#line 731
        js_destroy(tmp);
        }
      }
#line 725
      c ++;
    }
    while_break___3: /* CIL Label */ ;
    }
  } else
#line 735
  if (non_localhost_ips == 1) {
#line 737
    c = 0;
    {
#line 737
    while (1) {
      while_continue___4: /* CIL Label */ ;
#line 737
      if (! (c < 500)) {
#line 737
        goto while_break___4;
      }
#line 738
      if ((iplist + c)->ip == 4294967295U) {
#line 739
        goto while_break___4;
      }
      {
#line 741
      tmp___4 = csv2_is_localhost_ip((iplist + c)->ip);
      }
#line 741
      if (! tmp___4) {
        {
#line 742
        csv2_make_synth_ns(state, (iplist + c)->ip);
        }
      }
#line 737
      c ++;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 746
    c = 0;
    {
#line 746
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 746
      if (! (c < 500)) {
#line 746
        goto while_break___5;
      }
#line 747
      if ((iplist + c)->ip == 4294967295U) {
#line 748
        goto while_break___5;
      }
      {
#line 750
      tmp___5 = csv2_is_localhost_ip((iplist + c)->ip);
      }
#line 750
      if (! tmp___5) {
        {
#line 751
        tmp = csv2_synth_ip(state, (iplist + c)->ip, 1);
#line 752
        js_destroy(tmp);
        }
      }
#line 746
      c ++;
    }
    while_break___5: /* CIL Label */ ;
    }
  } else {
#line 758
    c = 0;
    {
#line 758
    while (1) {
      while_continue___6: /* CIL Label */ ;
#line 758
      if (! (c < 500)) {
#line 758
        goto while_break___6;
      }
#line 759
      if ((iplist + c)->ip == 4294967295U) {
#line 760
        goto while_break___6;
      }
      {
#line 762
      csv2_make_synth_ns(state, (iplist + c)->ip);
#line 758
      c ++;
      }
    }
    while_break___6: /* CIL Label */ ;
    }
#line 765
    c = 0;
    {
#line 765
    while (1) {
      while_continue___7: /* CIL Label */ ;
#line 765
      if (! (c < 500)) {
#line 765
        goto while_break___7;
      }
#line 766
      if ((iplist + c)->ip == 4294967295U) {
#line 767
        goto while_break___7;
      }
      {
#line 769
      tmp = csv2_synth_ip(state, (iplist + c)->ip, 1);
#line 770
      js_destroy(tmp);
#line 765
      c ++;
      }
    }
    while_break___7: /* CIL Label */ ;
    }
  }
#line 774
  return (1);
}
}
#line 779 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
csv2_rr *copy_csv2_rr(csv2_rr *source ) 
{ 
  csv2_rr *new ;
  js_string *q ;
  js_string *d ;
  void *tmp ;

  {
  {
#line 783
  q = csv2_copy_js(source->query);
  }
#line 783
  if ((unsigned long )q == (unsigned long )((js_string *)0)) {
#line 784
    return ((csv2_rr *)0);
  }
  {
#line 786
  d = csv2_copy_js(source->data);
  }
#line 786
  if ((unsigned long )d == (unsigned long )((js_string *)0)) {
    {
#line 787
    js_destroy(q);
    }
#line 788
    return ((csv2_rr *)0);
  }
  {
#line 792
  tmp = js_alloc((int )sizeof(csv2_rr ), 1);
#line 792
  new = (csv2_rr *)tmp;
  }
#line 792
  if ((unsigned long )new == (unsigned long )((csv2_rr *)0)) {
    {
#line 793
    js_destroy(q);
#line 794
    js_destroy(d);
    }
#line 795
    return ((csv2_rr *)0);
  }
#line 797
  new->query = q;
#line 798
  new->data = d;
#line 799
  new->rtype = source->rtype;
#line 800
  new->ttl = source->ttl;
#line 801
  new->next = (struct csv2_rr *)0;
#line 803
  return (new);
}
}
#line 809 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_push_buffer(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                     js_string *data ) 
{ 
  js_string *q ;
  js_string *d ;
  csv2_rr *new ;
  csv2_rr *point ;
  int x ;
  void *tmp ;

  {
  {
#line 816
  q = csv2_copy_js(query);
  }
#line 816
  if ((unsigned long )q == (unsigned long )((js_string *)0)) {
#line 817
    return (-1);
  }
  {
#line 819
  d = csv2_copy_js(data);
  }
#line 819
  if ((unsigned long )d == (unsigned long )((js_string *)0)) {
    {
#line 820
    js_destroy(q);
    }
#line 821
    return (-1);
  }
  {
#line 825
  tmp = js_alloc((int )sizeof(csv2_rr ), 1);
#line 825
  new = (csv2_rr *)tmp;
  }
#line 825
  if ((unsigned long )new == (unsigned long )((csv2_rr *)0)) {
    {
#line 826
    js_destroy(q);
#line 827
    js_destroy(d);
    }
#line 828
    return (-1);
  }
#line 830
  new->query = q;
#line 831
  new->data = d;
#line 832
  new->rtype = rtype;
#line 833
  new->ttl = ttl;
#line 834
  new->next = (struct csv2_rr *)0;
#line 838
  if ((unsigned long )state->buffer == (unsigned long )((csv2_rr *)0)) {
#line 839
    state->buffer = new;
  }
#line 841
  point = state->buffer;
#line 845
  if ((unsigned long )state->buffer != (unsigned long )new) {
#line 846
    x = 0;
    {
#line 846
    while (1) {
      while_continue: /* CIL Label */ ;
#line 846
      if (! (x < 64)) {
#line 846
        goto while_break;
      }
#line 847
      if ((unsigned long )point->next == (unsigned long )((struct csv2_rr *)0)) {
#line 848
        goto while_break;
      }
#line 850
      point = point->next;
#line 846
      x ++;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 855
  if ((unsigned long )state->buffer != (unsigned long )new) {
#line 855
    if ((unsigned long )point->next != (unsigned long )((struct csv2_rr *)0)) {
      {
#line 856
      js_destroy(q);
#line 857
      js_destroy(d);
#line 858
      js_dealloc((void *)new);
      }
#line 859
      return (-1);
    }
  }
#line 862
  if ((unsigned long )state->buffer != (unsigned long )new) {
#line 863
    point->next = new;
  }
#line 865
  return (1);
}
}
#line 873 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_set_soa(csv2_add_state *state , js_string *query , js_string *data , int32_t ttl ) 
{ 
  int tmp ;

  {
  {
#line 876
  tmp = csv2_push_buffer(state, query, 6, ttl, data);
  }
#line 876
  return (tmp);
}
}
#line 882 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_is_zonetop(csv2_add_state *state , js_string *query ) 
{ 
  js_string *q ;
  int tmp ;

  {
  {
#line 885
  q = csv2_zone_to_udpzone(state->zone);
  }
#line 885
  if ((unsigned long )q == (unsigned long )((js_string *)0)) {
#line 886
    return (0);
  }
  {
#line 888
  tmp = js_issame(q, query);
  }
#line 888
  if (tmp == 1) {
    {
#line 889
    js_destroy(q);
    }
#line 890
    return (1);
  }
  {
#line 892
  js_destroy(q);
  }
#line 893
  return (0);
}
}
#line 898 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_pop_buffer(csv2_add_state *state ) 
{ 
  csv2_rr *save ;
  int ret ;

  {
#line 901
  if ((unsigned long )state->buffer == (unsigned long )((csv2_rr *)0)) {
#line 902
    return (0);
  }
#line 905
  save = (state->buffer)->next;
#line 909
  if (state->add_method != 2) {
    {
#line 910
    ret = csv2_add_rr_w(state, (state->buffer)->query, (state->buffer)->rtype, (state->buffer)->ttl,
                        (state->buffer)->data);
    }
  } else {
#line 914
    ret = 1;
  }
#line 916
  if (ret != -1) {
    {
#line 917
    js_destroy((state->buffer)->query);
#line 919
    js_destroy((state->buffer)->data);
#line 921
    js_dealloc((void *)state->buffer);
#line 922
    state->buffer = save;
    }
  }
#line 924
  return (ret);
}
}
#line 928 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_soa(csv2_add_state *state ) 
{ 
  int tmp ;

  {
#line 929
  if (state->in_ns != 1) {
#line 930
    return (-1);
  }
#line 932
  if ((unsigned long )state->buffer == (unsigned long )((csv2_rr *)0)) {
#line 933
    return (-1);
  } else
#line 932
  if ((state->buffer)->rtype != 6) {
#line 933
    return (-1);
  }
  {
#line 935
  state->in_ns = 0;
#line 936
  tmp = csv2_pop_buffer(state);
  }
#line 936
  return (tmp);
}
}
#line 941 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_copy_js(js_string *s ) 
{ 
  js_string *c ;
  int tmp ;

  {
#line 943
  if (s->unit_size != 1U) {
#line 944
    return ((js_string *)0);
  }
  {
#line 946
  c = js_create(s->unit_count + 1U, 1U);
  }
#line 946
  if ((unsigned long )c == (unsigned long )((js_string *)0)) {
#line 947
    return ((js_string *)0);
  }
  {
#line 949
  tmp = js_copy(s, c);
  }
#line 949
  if (tmp == -1) {
    {
#line 950
    js_destroy(c);
    }
#line 951
    return ((js_string *)0);
  }
#line 953
  return (c);
}
}
#line 959 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_rr(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                js_string *data ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 963
  (state->rrnum) ++;
#line 964
  if (state->rrnum == 1) {
#line 964
    if (rtype != 6) {
#line 964
      if (state->add_method != 3) {
        {
#line 966
        csv2_synthesize_soa(state);
        }
      } else {
#line 964
        goto _L___2;
      }
    } else {
#line 964
      goto _L___2;
    }
  } else
  _L___2: /* CIL Label */ 
#line 968
  if (state->rrnum == 1) {
#line 968
    if (rtype != 6) {
#line 968
      if (state->add_method == 3) {
        {
#line 970
        printf((char const   */* __restrict  */)"Please put an SOA record in the default zone file\n");
        }
#line 971
        return (-1);
      } else {
#line 968
        goto _L___0;
      }
    } else {
#line 968
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 973
  if (state->rrnum == 1) {
    {
#line 974
    tmp = csv2_set_soa(state, query, data, ttl);
    }
#line 974
    return (tmp);
  } else
#line 976
  if (rtype == 6) {
    {
#line 979
    printf((char const   */* __restrict  */)"Warning: Only one SOA per zone file.\nThis SOA must be the first record in the zone.\nOther SOA records are ignored\n");
    }
#line 982
    return (-1);
  }
#line 989
  if (state->zone_nses_added == 0) {
#line 989
    if (state->in_ns == 1) {
#line 989
      if (rtype == 2) {
        {
#line 989
        tmp___0 = csv2_is_zonetop(state, query);
        }
#line 989
        if (tmp___0) {
#line 991
          state->zone_nses_added = 1;
        }
      }
    }
  }
#line 996
  if (state->in_ns == 0) {
#line 996
    if (rtype == 2) {
      {
#line 996
      tmp___1 = csv2_is_zonetop(state, query);
      }
#line 996
      if (tmp___1) {
        {
#line 998
        printf((char const   */* __restrict  */)"Warning: Authoritative NSes must be immediately after SOA\nOr the first records in the zone\nOtherwise, the record is ignored\n");
        }
#line 1002
        return (-1);
      } else {
#line 996
        goto _L___6;
      }
    } else {
#line 996
      goto _L___6;
    }
  } else
  _L___6: /* CIL Label */ 
#line 1005
  if (state->in_ns == 0) {
#line 1005
    if (rtype == 2) {
#line 1005
      if (state->add_method == 3) {
        {
#line 1006
        printf((char const   */* __restrict  */)"Warning: Delegation NS records are not permitted in\nthe default zonefile.  This record is ignored\n");
        }
#line 1008
        return (-1);
      } else {
#line 1005
        goto _L___4;
      }
    } else {
#line 1005
      goto _L___4;
    }
  } else
  _L___4: /* CIL Label */ 
#line 1011
  if (rtype == 5) {
#line 1011
    if (state->add_method == 3) {
      {
#line 1012
      printf((char const   */* __restrict  */)"Warning: CNAME records are not permitted in the\ndefault zonefile.  This record is ignored\n");
      }
#line 1014
      return (-1);
    }
  }
#line 1022
  if (state->in_ns == 1) {
#line 1022
    if (rtype != 2) {
#line 1022
      goto _L___7;
    } else {
      {
#line 1022
      tmp___2 = csv2_is_zonetop(state, query);
      }
#line 1022
      if (! tmp___2) {
        _L___7: /* CIL Label */ 
#line 1027
        if (state->zone_nses_added == 0) {
#line 1027
          if (state->add_method != 3) {
            {
#line 1029
            csv2_synthesize_ns(state);
            }
          }
        }
#line 1031
        if (state->zone_nses_added == 0) {
#line 1031
          if (state->add_method == 3) {
            {
#line 1033
            printf((char const   */* __restrict  */)"Please include NS records in a default zone file\n");
            }
#line 1035
            return (-1);
          }
        }
#line 1037
        if (state->add_method != 2) {
          {
#line 1038
          csv2_add_soa(state);
          }
        }
#line 1040
        state->in_ns = 0;
      }
    }
  }
  {
#line 1043
  tmp___3 = csv2_add_rr_w(state, query, rtype, ttl, data);
  }
#line 1043
  return (tmp___3);
}
}
#line 1052 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_make_ptr_query(js_string *binary_ip ) 
{ 
  js_string *ptr_label ;
  int len ;
  int counter ;
  int tmp ;
  char a ;
  int b ;
  int c ;
  int d ;

  {
  {
#line 1054
  len = 0;
#line 1055
  counter = 0;
#line 1058
  tmp = js_length(binary_ip);
  }
#line 1058
  if (tmp != 4) {
#line 1059
    return ((js_string *)0);
  }
  {
#line 1061
  ptr_label = js_create(31U, 1U);
  }
#line 1062
  if ((unsigned long )ptr_label == (unsigned long )((js_string *)0)) {
#line 1063
    return ((js_string *)0);
  }
#line 1068
  counter = 3;
  {
#line 1068
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1068
    if (! (counter >= 0)) {
#line 1068
      goto while_break;
    }
#line 1071
    c = 1;
#line 1073
    a = (char )*(binary_ip->string + counter);
#line 1077
    b = (int )a;
#line 1078
    b &= 255;
#line 1080
    if (b < 0) {
#line 1081
      b += 128;
    }
#line 1083
    if (b > 99) {
#line 1084
      c ++;
    }
#line 1086
    if (b > 9) {
#line 1087
      c ++;
    }
#line 1089
    if (len <= 30) {
#line 1090
      *(ptr_label->string + len) = (unsigned char )c;
    }
#line 1091
    d = c;
    {
#line 1092
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 1092
      if (! (c > 0)) {
#line 1092
        goto while_break___0;
      }
#line 1093
      if (len + c <= 30) {
#line 1094
        *((ptr_label->string + len) + c) = (unsigned char )(48 + b % 10);
      }
#line 1095
      b /= 10;
#line 1096
      c --;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 1098
    len ++;
#line 1099
    len += d;
#line 1068
    counter --;
  }
  while_break: /* CIL Label */ ;
  }
#line 1103
  if ((unsigned int )len < ptr_label->max_count) {
#line 1104
    ptr_label->unit_count = (unsigned int )len;
  }
  {
#line 1107
  js_qappend((char *)".in-addr.arpa.", ptr_label);
  }
#line 1108
  if (len <= 30) {
#line 1109
    *(ptr_label->string + len) = (unsigned char)7;
  }
#line 1111
  len += 8;
#line 1112
  if (len <= 30) {
#line 1113
    *(ptr_label->string + len) = (unsigned char)4;
  }
#line 1115
  len += 5;
#line 1116
  if (len <= 30) {
#line 1117
    *(ptr_label->string + len) = (unsigned char)0;
  }
#line 1120
  return (ptr_label);
}
}
#line 1129 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
js_string *csv2_make_ptr6_query(js_string *binary_ip ) 
{ 
  js_string *ptr_label ;
  int len ;
  int counter ;
  int tmp ;
  char a ;
  int b ;

  {
  {
#line 1131
  len = 0;
#line 1132
  counter = 0;
#line 1135
  tmp = js_length(binary_ip);
  }
#line 1135
  if (tmp != 16) {
#line 1136
    return ((js_string *)0);
  }
  {
#line 1138
  ptr_label = js_create(256U, 1U);
  }
#line 1139
  if ((unsigned long )ptr_label == (unsigned long )((js_string *)0)) {
#line 1140
    return ((js_string *)0);
  }
#line 1143
  counter = 15;
  {
#line 1143
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1143
    if (! (counter >= 0)) {
#line 1143
      goto while_break;
    }
#line 1147
    a = (char )*(binary_ip->string + counter);
#line 1150
    *(ptr_label->string + len) = (unsigned char)1;
#line 1151
    len ++;
#line 1152
    b = (int )a & 15;
#line 1153
    if (b > 9) {
#line 1153
      b += 87;
    } else {
#line 1154
      b += 48;
    }
#line 1155
    *(ptr_label->string + len) = (unsigned char )b;
#line 1156
    len ++;
#line 1159
    *(ptr_label->string + len) = (unsigned char)1;
#line 1160
    len ++;
#line 1161
    b = ((int )a >> 4) & 15;
#line 1162
    if (b > 9) {
#line 1162
      b += 87;
    } else {
#line 1163
      b += 48;
    }
#line 1164
    *(ptr_label->string + len) = (unsigned char )b;
#line 1165
    len ++;
#line 1143
    counter --;
  }
  while_break: /* CIL Label */ ;
  }
#line 1168
  if (len <= 250) {
#line 1169
    *(ptr_label->string + len) = (unsigned char)3;
#line 1170
    *((ptr_label->string + len) + 1) = (unsigned char )'i';
#line 1171
    *((ptr_label->string + len) + 2) = (unsigned char )'p';
#line 1172
    *((ptr_label->string + len) + 3) = (unsigned char )'6';
#line 1173
    len += 4;
  }
#line 1176
  if (len <= 250) {
#line 1177
    *(ptr_label->string + len) = (unsigned char)4;
#line 1178
    *((ptr_label->string + len) + 1) = (unsigned char )'a';
#line 1179
    *((ptr_label->string + len) + 2) = (unsigned char )'r';
#line 1180
    *((ptr_label->string + len) + 3) = (unsigned char )'p';
#line 1181
    *((ptr_label->string + len) + 4) = (unsigned char )'a';
#line 1182
    len += 5;
  }
#line 1184
  if (len <= 255) {
#line 1185
    *(ptr_label->string + len) = (unsigned char)0;
#line 1186
    len ++;
  }
#line 1188
  ptr_label->unit_size = 1U;
#line 1189
  ptr_label->unit_count = (unsigned int )len;
#line 1190
  return (ptr_label);
}
}
#line 1196 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_database.c"
int csv2_add_rr_w(csv2_add_state *state , js_string *query , int rtype , int32_t ttl ,
                  js_string *data ) 
{ 
  js_string *cquery ;
  int ret ;
  int counter ;
  int tmp ;
  js_string *pq ;
  js_string *pq___0 ;

  {
#line 1199
  ret = -1;
#line 1199
  counter = -1;
#line 1200
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 1201
    return (-1);
  }
  {
#line 1205
  cquery = js_create(query->unit_count + 1U, 1U);
  }
#line 1205
  if ((unsigned long )cquery == (unsigned long )((js_string *)0)) {
#line 1206
    return (-1);
  }
  {
#line 1208
  tmp = js_copy(query, cquery);
  }
#line 1208
  if (tmp == -1) {
    {
#line 1209
    js_destroy(cquery);
    }
#line 1210
    return (-1);
  }
#line 1214
  counter = 0;
#line 1215
  if (cquery->unit_count < 0U) {
    {
#line 1216
    js_destroy(cquery);
    }
#line 1217
    return (-1);
  }
  {
#line 1221
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1221
    if (! ((unsigned int )counter < cquery->unit_count)) {
#line 1221
      goto while_break;
    }
#line 1222
    if ((int )*(cquery->string + counter) >= 65) {
#line 1222
      if ((int )*(cquery->string + counter) <= 90) {
#line 1224
        *(cquery->string + counter) = (unsigned char )((int )*(cquery->string + counter) + 32);
      }
    }
#line 1226
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1232
  if (rtype == 65765) {
#line 1232
    if (state->add_method != 3) {
      {
#line 1234
      rtype = 1;
#line 1235
      pq = csv2_make_ptr_query(data);
#line 1238
      csv2_add_rr_w(state, pq, 12, ttl, cquery);
#line 1239
      js_destroy(pq);
      }
    } else {
#line 1232
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 1240
  if (rtype == 65765) {
#line 1240
    if (state->add_method == 3) {
      {
#line 1241
      printf((char const   */* __restrict  */)"Warning: FQDN4 records are not permitted in the\ndefault zonefile.  This record is ignored.\n");
#line 1243
      js_destroy(cquery);
      }
#line 1244
      return (-1);
    }
  }
#line 1247
  if (rtype == 65766) {
#line 1247
    if (state->add_method != 3) {
      {
#line 1249
      rtype = 28;
#line 1250
      pq___0 = csv2_make_ptr6_query(data);
#line 1253
      csv2_add_rr_w(state, pq___0, 12, ttl, cquery);
#line 1254
      js_destroy(pq___0);
      }
    } else {
#line 1247
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 1255
  if (rtype == 65766) {
#line 1255
    if (state->add_method == 3) {
      {
#line 1256
      printf((char const   */* __restrict  */)"Warning: FQDN6 records are not permitted in the\ndefault zonefile.  This record is ignored.\n");
#line 1258
      js_destroy(cquery);
      }
#line 1259
      return (-1);
    }
  }
#line 1262
  ret = -1;
  {
#line 1264
  if (state->add_method == 1) {
#line 1264
    goto case_1;
  }
#line 1268
  if (state->add_method == 2) {
#line 1268
    goto case_2;
  }
#line 1272
  if (state->add_method == 3) {
#line 1272
    goto case_3;
  }
#line 1279
  goto switch_default;
  case_1: /* CIL Label */ 
  {
#line 1265
  ret = csv2_add_rr_bighash(state, cquery, rtype, ttl, data, 0);
  }
#line 1267
  goto switch_break;
  case_2: /* CIL Label */ 
  {
#line 1269
  ret = csv2_add_rr_zoneserver(state, cquery, rtype, ttl, data);
  }
#line 1271
  goto switch_break;
  case_3: /* CIL Label */ 
  {
#line 1276
  ret = csv2_add_rr_bighash(state, cquery, rtype, ttl, data, 1);
  }
#line 1278
  goto switch_break;
  switch_default: /* CIL Label */ 
  {
#line 1280
  ret = csv2_add_rr_debug(state, cquery, rtype, ttl, data);
  }
  switch_break: /* CIL Label */ ;
  }
  {
#line 1283
  js_destroy(cquery);
  }
#line 1284
  return (ret);
}
}
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/functions_parse.h"
int make_ip_acl(js_string *in , ipv4pair *out , int max , int depth ) ;
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
int ddip_ip_mask(js_string *ddip , ipv4pair *ips , int offset ) ;
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *dotq  =    (js_string *)0;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *numdotq  =    (js_string *)0;
#line 51 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *slashq  =    (js_string *)0;
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static uint32_t masks[33]  = 
#line 52
  {      (uint32_t )0,      2147483648U,      3221225472U,      3758096384U, 
        4026531840U,      4160749568U,      4227858432U,      4261412864U, 
        4278190080U,      4286578688U,      4290772992U,      4292870144U, 
        4293918720U,      4294443008U,      4294705152U,      4294836224U, 
        4294901760U,      4294934528U,      4294950912U,      4294959104U, 
        4294963200U,      4294965248U,      4294966272U,      4294966784U, 
        4294967040U,      4294967168U,      4294967232U,      4294967264U, 
        4294967280U,      4294967288U,      4294967292U,      4294967294U, 
        4294967295U};
#line 43 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
int ddip_ip_mask(js_string *ddip , ipv4pair *ips , int offset ) 
{ 
  int qr ;
  int counter ;
  int firstoffset ;
  int slashp ;
  int ret ;
  unsigned char ip_byte ;
  char dot ;
  char slash ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  js_string *tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  unsigned int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  unsigned int tmp___9 ;
  unsigned int tmp___10 ;
  int tmp___11 ;

  {
  {
#line 87
  dot = (char )'.';
#line 88
  slash = (char )'/';
#line 91
  tmp = mara_goodjs(ddip);
  }
#line 91
  if (tmp == -1) {
#line 92
    return (-1);
  }
#line 93
  if ((unsigned long )ips == (unsigned long )((ipv4pair *)0)) {
#line 94
    return (-1);
  }
#line 97
  if ((unsigned long )dotq == (unsigned long )((js_string *)0)) {
    {
#line 98
    dotq = js_create(7U, 1U);
    }
#line 98
    if ((unsigned long )dotq == (unsigned long )((js_string *)0)) {
#line 99
      return (-1);
    }
    {
#line 101
    tmp___0 = js_str2js(dotq, & dot, 1, 1);
    }
#line 101
    if (tmp___0 == -1) {
      {
#line 102
      js_destroy(dotq);
#line 103
      dotq = (js_string *)0;
      }
#line 104
      return (-1);
    }
  }
#line 107
  if ((unsigned long )numdotq == (unsigned long )((js_string *)0)) {
    {
#line 108
    numdotq = js_create(211U, 1U);
    }
#line 108
    if ((unsigned long )numdotq == (unsigned long )((js_string *)0)) {
#line 109
      return (-1);
    }
    {
#line 110
    tmp___1 = js_set_encode(numdotq, 3);
    }
#line 110
    if (tmp___1 == -1) {
      {
#line 111
      js_destroy(numdotq);
#line 112
      numdotq = (js_string *)0;
      }
#line 113
      return (-1);
    }
    {
#line 116
    tmp___2 = js_numbers(numdotq);
    }
#line 116
    if ((unsigned long )tmp___2 == (unsigned long )((js_string *)0)) {
      {
#line 117
      js_destroy(numdotq);
#line 118
      numdotq = (js_string *)0;
      }
#line 119
      return (-1);
    }
    {
#line 122
    tmp___3 = js_append(dotq, numdotq);
    }
#line 122
    if (tmp___3 == -1) {
      {
#line 123
      js_destroy(numdotq);
#line 124
      numdotq = (js_string *)0;
      }
#line 125
      return (-1);
    }
  }
#line 128
  if ((unsigned long )slashq == (unsigned long )((js_string *)0)) {
    {
#line 129
    slashq = js_create(7U, 1U);
    }
#line 129
    if ((unsigned long )slashq == (unsigned long )((js_string *)0)) {
#line 130
      return (-1);
    }
    {
#line 132
    tmp___4 = js_str2js(slashq, & slash, 1, 1);
    }
#line 132
    if (tmp___4 == -1) {
      {
#line 133
      js_destroy(slashq);
#line 134
      slashq = (js_string *)0;
      }
#line 135
      return (-1);
    }
  }
  {
#line 140
  firstoffset = offset;
#line 143
  ret = js_notmatch_offset(numdotq, ddip, offset);
  }
#line 146
  if (ret == -1) {
#line 147
    return (-1);
  } else
#line 146
  if (ret == offset) {
#line 147
    return (-1);
  }
  {
#line 150
  tmp___5 = js_length(ddip);
  }
#line 150
  if (tmp___5 < offset + 1) {
#line 151
    return (-1);
  }
#line 153
  ips->ip = (uint32_t )0;
#line 155
  counter = 0;
  {
#line 155
  while (1) {
    while_continue: /* CIL Label */ ;
#line 155
    if (! (counter < 4)) {
#line 155
      goto while_break;
    }
#line 156
    if (offset == -2) {
#line 157
      return (-1);
    }
    {
#line 159
    tmp___6 = js_atoi(ddip, offset);
#line 159
    qr = (int )tmp___6;
    }
#line 161
    if (qr < 0) {
#line 162
      return (-1);
    } else
#line 161
    if (qr > 255) {
#line 162
      return (-1);
    }
#line 164
    ip_byte = (unsigned char )qr;
#line 167
    ips->ip |= (unsigned int )(((int )ip_byte & 255) << (24 - 8 * counter));
#line 170
    if (counter == 4) {
#line 170
      if (ret < offset) {
#line 171
        return (-1);
      }
    }
    {
#line 173
    offset = js_match_offset(dotq, ddip, offset + 1);
    }
#line 174
    if (offset == -1) {
#line 175
      return (-1);
    }
#line 177
    offset ++;
#line 155
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 181
  tmp___7 = js_match_offset(slashq, ddip, firstoffset);
  }
#line 181
  if (tmp___7 != ret) {
#line 183
    ips->mask = 4294967295U;
#line 184
    return (ret);
  } else {
    {
#line 181
    tmp___8 = js_match_offset(slashq, ddip, firstoffset);
    }
#line 181
    if (tmp___8 == -2) {
#line 183
      ips->mask = 4294967295U;
#line 184
      return (ret);
    }
  }
  {
#line 186
  slashp = ret;
#line 190
  ret = js_match_offset(dotq, ddip, slashp + 1);
  }
#line 191
  if (ret == -1) {
#line 192
    return (-1);
  }
  {
#line 193
  offset = js_notmatch_offset(numdotq, ddip, slashp + 1);
  }
#line 194
  if (offset == -1) {
#line 195
    return (-1);
  }
#line 197
  if (ret == -2) {
#line 197
    goto _L;
  } else
#line 197
  if (offset < ret) {
#line 197
    if (offset != -2) {
      _L: /* CIL Label */ 
      {
#line 198
      tmp___9 = js_atoi(ddip, slashp + 1);
#line 198
      ret = (int )tmp___9;
      }
#line 199
      if (ret < 0) {
#line 200
        return (-1);
      } else
#line 199
      if (ret > 32) {
#line 200
        return (-1);
      }
#line 201
      ips->mask = masks[ret];
#line 202
      if ((unsigned int )(offset + 1) < ddip->unit_count) {
#line 203
        return (offset + 1);
      } else {
#line 205
        return (-2);
      }
    } else {
#line 197
      goto _L___0;
    }
  } else {
    _L___0: /* CIL Label */ 
#line 208
    offset = slashp + 1;
#line 209
    ips->mask = (uint32_t )0;
#line 210
    counter = 0;
    {
#line 210
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 210
      if (! (counter < 4)) {
#line 210
        goto while_break___0;
      }
#line 211
      if (offset == -2) {
#line 212
        return (-1);
      }
      {
#line 214
      tmp___10 = js_atoi(ddip, offset);
#line 214
      qr = (int )tmp___10;
      }
#line 216
      if (qr < 0) {
#line 217
        return (-1);
      } else
#line 216
      if (qr > 255) {
#line 217
        return (-1);
      }
#line 219
      ip_byte = (unsigned char )qr;
#line 222
      ips->mask |= (unsigned int )(((int )ip_byte & 255) << (24 - 8 * counter));
#line 224
      if (counter != 3) {
        {
#line 225
        offset = js_match_offset(dotq, ddip, offset + 1);
        }
#line 226
        if (offset == -1) {
#line 227
          return (-1);
        }
      } else {
        {
#line 230
        tmp___11 = js_notmatch_offset(numdotq, ddip, offset + 1);
        }
#line 230
        return (tmp___11);
      }
#line 232
      offset ++;
#line 210
      counter ++;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 234
    return (-1);
  }
#line 237
  return (-1);
}
}
#line 258 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
int make_ip_acl(js_string *in , ipv4pair *out , int max , int depth ) 
{ 
  js_string *sub ;
  js_string *delimq ;
  js_string *value___6 ;
  int start ;
  int next ;
  int index ;
  char delim ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int nx ;
  int tmp___3 ;
  int nx___0 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;

  {
#line 260
  sub = (js_string *)0;
#line 260
  delimq = (js_string *)0;
#line 260
  value___6 = (js_string *)0;
#line 261
  index = 0;
#line 262
  delim = (char )',';
#line 265
  if (depth > 32) {
#line 266
    return (-1);
  }
  {
#line 267
  tmp = js_has_sanity(in);
  }
#line 267
  if (tmp == -1) {
#line 268
    return (-1);
  }
#line 269
  if (in->unit_size != 1U) {
#line 270
    return (-1);
  }
#line 271
  if ((unsigned long )out == (unsigned long )((ipv4pair *)0)) {
#line 272
    return (-1);
  }
  {
#line 275
  sub = js_create(256U, 1U);
  }
#line 275
  if ((unsigned long )sub == (unsigned long )((js_string *)0)) {
#line 276
    return (-1);
  }
  {
#line 277
  tmp___0 = js_set_encode(sub, 3);
  }
#line 277
  if (tmp___0 == -1) {
#line 278
    return (-1);
  }
  {
#line 279
  value___6 = js_create(512U, 1U);
  }
#line 279
  if ((unsigned long )value___6 == (unsigned long )((js_string *)0)) {
#line 280
    return (-1);
  }
  {
#line 281
  tmp___1 = js_set_encode(value___6, 3);
  }
#line 281
  if (tmp___1 == -1) {
#line 282
    return (-1);
  }
  {
#line 283
  delimq = js_create(7U, 1U);
  }
#line 283
  if ((unsigned long )delimq == (unsigned long )((js_string *)0)) {
    {
#line 284
    js_destroy(sub);
    }
#line 285
    return (-1);
  }
  {
#line 287
  tmp___2 = js_str2js(delimq, & delim, 1, 1);
  }
#line 287
  if (tmp___2 == -1) {
    {
#line 288
    js_destroy(sub);
#line 288
    js_destroy(value___6);
#line 288
    js_destroy(delimq);
    }
#line 289
    return (-1);
  }
#line 292
  next = -1;
  {
#line 293
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 294
    start = next + 1;
#line 296
    next = js_match_offset(delimq, in, start);
    }
#line 297
    if (next == -1) {
      {
#line 298
      js_destroy(sub);
#line 298
      js_destroy(delimq);
#line 298
      js_destroy(value___6);
      }
#line 299
      return (-1);
    }
#line 302
    if (next == -2) {
#line 303
      nx = (int )(in->unit_count - 1U);
      {
#line 305
      while (1) {
        while_continue___0: /* CIL Label */ ;
#line 305
        if (start < nx) {
#line 305
          if (! ((int )*(in->string + start) == 32)) {
#line 305
            goto while_break___0;
          }
        } else {
#line 305
          goto while_break___0;
        }
#line 306
        start ++;
      }
      while_break___0: /* CIL Label */ ;
      }
      {
#line 309
      while (1) {
        while_continue___1: /* CIL Label */ ;
#line 309
        if (nx > start) {
#line 309
          if (! ((int )*(in->string + nx) == 32)) {
#line 309
            if (! ((int )*(in->string + start) == 9)) {
#line 309
              goto while_break___1;
            }
          }
        } else {
#line 309
          goto while_break___1;
        }
#line 311
        if (nx >= 0) {
#line 312
          nx --;
        } else {
          {
#line 315
          js_destroy(sub);
#line 315
          js_destroy(delimq);
#line 315
          js_destroy(value___6);
          }
#line 316
          return (-1);
        }
      }
      while_break___1: /* CIL Label */ ;
      }
      {
#line 320
      tmp___3 = js_substr(in, sub, start, (nx + 1) - start);
      }
#line 320
      if (tmp___3 == -1) {
        {
#line 321
        js_destroy(sub);
#line 321
        js_destroy(delimq);
#line 321
        js_destroy(value___6);
        }
#line 322
        return (-1);
      }
    } else {
#line 326
      nx___0 = next;
      {
#line 328
      while (1) {
        while_continue___2: /* CIL Label */ ;
#line 328
        if (start < nx___0) {
#line 328
          if (! ((int )*(in->string + start) == 32)) {
#line 328
            if (! ((int )*(in->string + start) == 9)) {
#line 328
              goto while_break___2;
            }
          }
        } else {
#line 328
          goto while_break___2;
        }
#line 330
        start ++;
      }
      while_break___2: /* CIL Label */ ;
      }
      {
#line 333
      while (1) {
        while_continue___3: /* CIL Label */ ;
#line 333
        if (nx___0 > start) {
#line 333
          if (! ((int )*(in->string + nx___0) == 32)) {
#line 333
            if (! ((int )*(in->string + start) == 9)) {
#line 333
              if (! ((int )*(in->string + nx___0) == 44)) {
#line 333
                goto while_break___3;
              }
            }
          }
        } else {
#line 333
          goto while_break___3;
        }
#line 336
        if (nx___0 >= 0) {
#line 337
          nx___0 --;
        } else {
          {
#line 340
          js_destroy(sub);
#line 340
          js_destroy(delimq);
#line 340
          js_destroy(value___6);
          }
#line 341
          return (-1);
        }
      }
      while_break___3: /* CIL Label */ ;
      }
      {
#line 345
      tmp___4 = js_substr(in, sub, start, (nx___0 + 1) - start);
      }
#line 345
      if (tmp___4 == -1) {
        {
#line 346
        js_destroy(sub);
#line 346
        js_destroy(delimq);
#line 346
        js_destroy(value___6);
        }
#line 347
        return (-1);
      }
    }
    {
#line 351
    tmp___5 = js_qstr2js(value___6, (char *)"ipv4_alias");
    }
#line 351
    if (tmp___5 == -1) {
      {
#line 352
      js_destroy(sub);
#line 352
      js_destroy(delimq);
#line 352
      js_destroy(value___6);
      }
#line 353
      return (-1);
    }
    {
#line 356
    tmp___8 = read_dvar(value___6, sub, value___6);
    }
#line 356
    if (tmp___8 != -1) {
      {
#line 357
      tmp___6 = make_ip_acl(value___6, out, max, depth + 1);
      }
#line 357
      if (tmp___6 == -1) {
        {
#line 358
        js_destroy(sub);
#line 358
        js_destroy(delimq);
#line 358
        js_destroy(value___6);
        }
#line 359
        return (-1);
      }
    } else {
      {
#line 365
      while (1) {
        while_continue___4: /* CIL Label */ ;
#line 365
        if (index < max) {
#line 365
          if (! ((out + index)->ip != 4294967295U)) {
#line 365
            goto while_break___4;
          }
        } else {
#line 365
          goto while_break___4;
        }
#line 366
        index ++;
      }
      while_break___4: /* CIL Label */ ;
      }
#line 368
      if (index >= max) {
        {
#line 369
        js_destroy(sub);
#line 369
        js_destroy(delimq);
#line 369
        js_destroy(value___6);
        }
#line 370
        return (-1);
      }
      {
#line 373
      tmp___7 = ddip_ip_mask(sub, out + index, 0);
      }
#line 373
      if (tmp___7 == -1) {
        {
#line 374
        js_destroy(sub);
#line 374
        js_destroy(delimq);
#line 374
        js_destroy(value___6);
        }
#line 375
        return (-1);
      }
    }
#line 293
    if (! (next != -2)) {
#line 293
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 380
  js_destroy(sub);
#line 381
  js_destroy(delimq);
#line 382
  js_destroy(value___6);
  }
#line 383
  return (1);
}
}
#line 374 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint32_t ( __attribute__((__leaf__)) ntohl)(uint32_t __netlong )  __attribute__((__const__)) ;
#line 23 "/home/wheatley/newnew/temp/maradns-2.0.09/server/functions_server.h"
extern int check_ipv4_acl(uint32_t ip , ipv4pair *list ) ;
#line 328
extern uint32_t determine_ttl(int64_t expire , uint32_t ttl ) ;
#line 334
extern int mara_send(conn *ect , int sock , js_string *reply ) ;
#line 348
extern int udperror(int sock , js_string *raw , struct sockaddr_in *from , js_string *question ,
                    int error , char *why , int min_log_level , int rd_val , conn *ect ,
                    int log_msg ) ;
#line 367
int udpsuccess(rr *where , int id , int sock , struct sockaddr_in *client , js_string *query ,
               void **rotate_point , int show_cname_a , int rd_val , conn *ect , int force_authoritative ,
               int ra_value ) ;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/server/udpsuccess.c"
extern int total_count ;
#line 36
extern int max_ar_chain ;
#line 37
extern int max_chain ;
#line 38
extern int max_total ;
#line 39
extern rr *seenlist[256] ;
#line 40
extern int seenlist_where ;
#line 41
extern ipv4pair long_packet[512] ;
#line 42
extern int calc_ra_value() ;
#line 61 "/home/wheatley/newnew/temp/maradns-2.0.09/server/udpsuccess.c"
int udpsuccess(rr *where , int id , int sock , struct sockaddr_in *client , js_string *query ,
               void **rotate_point , int show_cname_a , int rd_val , conn *ect , int force_authoritative ,
               int ra_value ) 
{ 
  js_string *most ;
  js_string *ar ;
  uint16_t first_rr_type ;
  int in_ns ;
  int ns_delegation ;
  int length_save ;
  int len_inet ;
  rr *ipwhere ;
  rr *rotate_1st ;
  rr *rotate_2nd ;
  rr *rotate_last ;
  int a_count ;
  int an_count ;
  fila *zap_point ;
  int seen_ptr_record ;
  rr *top ;
  int is_auth ;
  int compress_error_happened ;
  q_header header ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  uint32_t tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  uint32_t tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  uint32_t tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  uint32_t tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  uint32_t tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;
  struct rr_list *any_list ;
  uint16_t this_rr_type ;
  int counter ;
  rr *answer ;
  int counter___0 ;
  int tmp___37 ;
  int tmp___38 ;
  uint32_t tmp___39 ;
  int tmp___40 ;
  int tmp___41 ;
  int tmp___42 ;
  int tmp___43 ;
  int tmp___44 ;
  int x ;
  struct sockaddr_in *dq ;
  uint32_t ip_test ;
  int tmp___45 ;
  js_string *tmp___46 ;
  int tmp___47 ;
  int tmp___48 ;

  {
  {
#line 64
  most = (js_string *)0;
#line 65
  ar = (js_string *)0;
#line 68
  in_ns = 0;
#line 69
  ns_delegation = 0;
#line 71
  len_inet = (int )sizeof(struct sockaddr );
#line 72
  ipwhere = (rr *)0;
#line 74
  rotate_1st = (rr *)0;
#line 74
  rotate_2nd = (rr *)0;
#line 74
  rotate_last = (rr *)0;
#line 77
  a_count = 0;
#line 77
  an_count = 0;
#line 80
  seen_ptr_record = 0;
#line 81
  top = where;
#line 82
  is_auth = 0;
#line 83
  compress_error_happened = 0;
#line 88
  total_count = 0;
#line 90
  most = js_create(1024U, 1U);
  }
#line 90
  if ((unsigned long )most == (unsigned long )((js_string *)0)) {
#line 91
    return (-1);
  }
  {
#line 93
  ar = js_create(5000U, 1U);
  }
#line 93
  if ((unsigned long )ar == (unsigned long )((js_string *)0)) {
    {
#line 94
    js_destroy(most);
    }
#line 95
    return (-1);
  }
  {
#line 105
  init_header(& header);
#line 106
  header.id = (uint16_t )id;
#line 107
  tmp = make_hdr(& header, most);
  }
#line 107
  if (tmp == -1) {
#line 108
    goto giveerror;
  }
#line 111
  if ((unsigned long )where == (unsigned long )((rr *)0)) {
#line 112
    goto giveerror;
  }
#line 114
  if ((unsigned long )where->query == (unsigned long )((js_string *)0)) {
#line 115
    goto giveerror;
  }
  {
#line 117
  tmp___0 = js_has_sanity(where->query);
  }
#line 117
  if (tmp___0 == -1) {
#line 118
    goto giveerror;
  }
#line 120
  if ((unsigned long )where->data == (unsigned long )((js_string *)0)) {
#line 121
    goto giveerror;
  }
  {
#line 123
  tmp___1 = js_has_sanity(where->data);
  }
#line 123
  if (tmp___1 == -1) {
#line 124
    goto giveerror;
  }
  {
#line 126
  tmp___2 = js_has_sanity(query);
  }
#line 126
  if (tmp___2 == -1) {
#line 127
    goto giveerror;
  }
  {
#line 129
  tmp___3 = get_rtype(query);
#line 129
  first_rr_type = (uint16_t )tmp___3;
#line 132
  ns_delegation = 0;
  }
#line 133
  if ((int )first_rr_type != 2) {
#line 133
    if ((int )where->rr_type == 2) {
#line 134
      ns_delegation = 1;
    }
  }
#line 142
  if (force_authoritative != 1) {
#line 143
    header.aa = (int )where->authoritative;
  } else {
#line 146
    header.aa = 1;
  }
#line 148
  is_auth = (int )where->authoritative;
#line 152
  if ((where->data)->unit_count < 0U) {
#line 153
    goto giveerror;
  } else
#line 152
  if ((where->data)->unit_count > 65535U) {
#line 153
    goto giveerror;
  }
  {
#line 157
  tmp___4 = js_append(query, most);
  }
#line 157
  if (tmp___4 == -1) {
#line 158
    goto giveerror;
  }
  {
#line 162
  tmp___5 = js_adduint16(most, 1);
  }
#line 162
  if (tmp___5 == -1) {
#line 163
    goto giveerror;
  }
#line 167
  header.ancount = (uint16_t )0;
#line 168
  header.nscount = (uint16_t )0;
#line 169
  header.arcount = (uint16_t )0;
#line 172
  rotate_1st = where;
#line 173
  rotate_2nd = where->next;
#line 175
  if ((unsigned long )rotate_2nd != (unsigned long )((rr *)0)) {
#line 175
    if ((int )first_rr_type != 2) {
#line 175
      if ((int )rotate_2nd->rr_type == 2) {
#line 177
        rotate_2nd = (rr *)0;
      }
    }
  }
  {
#line 180
  while (1) {
    while_continue: /* CIL Label */ ;
#line 180
    if (! ((unsigned long )where != (unsigned long )((rr *)0))) {
#line 180
      goto while_break;
    }
#line 182
    if ((int )first_rr_type != 2) {
#line 182
      if ((int )where->rr_type == 2) {
#line 182
        if (in_ns == 0) {
#line 187
          if ((unsigned long )rotate_2nd != (unsigned long )((rr *)0)) {
#line 187
            if (max_ar_chain == 1) {
#line 187
              if ((unsigned long )rotate_last != (unsigned long )((rr *)0)) {
#line 187
                if ((int )first_rr_type != 2) {
#line 195
                  rotate_1st->next = where;
#line 196
                  rotate_last->next = rotate_1st;
#line 197
                  *rotate_point = (void *)rotate_2nd;
#line 198
                  rotate_2nd = (rr *)0;
                }
              }
            }
          }
#line 200
          in_ns = 1;
#line 201
          a_count = 0;
        }
      }
    }
#line 207
    if (a_count < max_chain) {
#line 207
      if (total_count < max_total) {
#line 207
        if (in_ns == 0) {
#line 207
          goto _L___6;
        } else
#line 207
        if (is_auth == 1) {
#line 207
          goto _L___6;
        } else
#line 207
        if (ns_delegation == 1) {
          _L___6: /* CIL Label */ 
#line 209
          a_count ++;
#line 210
          total_count ++;
#line 211
          if (! in_ns) {
#line 212
            header.ancount = (uint16_t )((int )header.ancount + 1);
          } else {
#line 215
            header.nscount = (uint16_t )((int )header.nscount + 1);
          }
          {
#line 218
          tmp___6 = js_append(where->query, most);
          }
#line 218
          if (tmp___6 == -1) {
#line 219
            goto giveerror;
          }
          {
#line 221
          tmp___7 = js_adduint16(most, 1);
          }
#line 221
          if (tmp___7 == -1) {
#line 222
            goto giveerror;
          }
          {
#line 224
          tmp___8 = determine_ttl(where->expire, where->ttl);
#line 224
          tmp___9 = js_adduint32(most, tmp___8);
          }
#line 224
          if (tmp___9 == -1) {
#line 226
            goto giveerror;
          }
          {
#line 228
          tmp___10 = js_adduint16(most, (int )(where->data)->unit_count);
          }
#line 228
          if (tmp___10 == -1) {
#line 229
            goto giveerror;
          }
          {
#line 231
          tmp___11 = js_append(where->data, most);
          }
#line 231
          if (tmp___11 == -1) {
#line 232
            goto giveerror;
          }
#line 235
          if ((unsigned long )where->ip != (unsigned long )((struct rr *)0)) {
#line 235
            if ((int )where->rr_type != 5) {
#line 237
              an_count = 0;
#line 238
              ipwhere = where->ip;
              {
#line 239
              while (1) {
                while_continue___0: /* CIL Label */ ;
#line 239
                if ((unsigned long )ipwhere != (unsigned long )((rr *)0)) {
#line 239
                  if (! ((int )ipwhere->rr_type != 2)) {
#line 239
                    goto while_break___0;
                  }
                } else {
#line 239
                  goto while_break___0;
                }
#line 241
                if ((int )ipwhere->seen == 1) {
#line 244
                  ipwhere = ipwhere->next;
#line 245
                  goto while_continue___0;
                }
#line 248
                if (an_count >= max_ar_chain) {
#line 249
                  goto while_break___0;
                } else
#line 248
                if (total_count >= max_total) {
#line 249
                  goto while_break___0;
                }
                {
#line 250
                an_count ++;
#line 251
                total_count ++;
#line 253
                header.arcount = (uint16_t )((int )header.arcount + 1);
#line 255
                tmp___12 = js_append(ipwhere->query, ar);
                }
#line 255
                if (tmp___12 == -1) {
#line 256
                  goto giveerror;
                }
                {
#line 258
                tmp___13 = js_adduint16(ar, 1);
                }
#line 258
                if (tmp___13 == -1) {
#line 259
                  goto giveerror;
                }
                {
#line 261
                tmp___14 = determine_ttl(ipwhere->expire, ipwhere->ttl);
#line 261
                tmp___15 = js_adduint32(ar, tmp___14);
                }
#line 261
                if (tmp___15 == -1) {
#line 263
                  goto giveerror;
                }
                {
#line 265
                tmp___16 = js_adduint16(ar, (int )(ipwhere->data)->unit_count);
                }
#line 265
                if (tmp___16 == -1) {
#line 266
                  goto giveerror;
                }
                {
#line 268
                tmp___17 = js_append(ipwhere->data, ar);
                }
#line 268
                if (tmp___17 == -1) {
#line 269
                  goto giveerror;
                }
#line 271
                if (seenlist_where < 250) {
#line 272
                  ipwhere->seen = (char)1;
#line 273
                  seenlist[seenlist_where] = ipwhere;
#line 274
                  seenlist_where ++;
                }
#line 277
                ipwhere = ipwhere->next;
              }
              while_break___0: /* CIL Label */ ;
              }
            }
          }
#line 281
          if ((unsigned long )where->ip6 != (unsigned long )((struct rr *)0)) {
#line 281
            if ((int )where->rr_type != 5) {
#line 283
              an_count = 0;
#line 284
              ipwhere = where->ip6;
              {
#line 285
              while (1) {
                while_continue___1: /* CIL Label */ ;
#line 285
                if ((unsigned long )ipwhere != (unsigned long )((rr *)0)) {
#line 285
                  if (! ((int )ipwhere->rr_type != 2)) {
#line 285
                    goto while_break___1;
                  }
                } else {
#line 285
                  goto while_break___1;
                }
#line 287
                if ((int )ipwhere->seen == 1) {
#line 290
                  ipwhere = ipwhere->next;
#line 291
                  goto while_continue___1;
                }
#line 294
                if (an_count >= max_ar_chain) {
#line 295
                  goto while_break___1;
                } else
#line 294
                if (total_count >= max_total) {
#line 295
                  goto while_break___1;
                }
                {
#line 296
                an_count ++;
#line 297
                total_count ++;
#line 299
                header.arcount = (uint16_t )((int )header.arcount + 1);
#line 301
                tmp___18 = js_append(ipwhere->query, ar);
                }
#line 301
                if (tmp___18 == -1) {
#line 302
                  goto giveerror;
                }
                {
#line 304
                tmp___19 = js_adduint16(ar, 1);
                }
#line 304
                if (tmp___19 == -1) {
#line 305
                  goto giveerror;
                }
                {
#line 307
                tmp___20 = determine_ttl(ipwhere->expire, ipwhere->ttl);
#line 307
                tmp___21 = js_adduint32(ar, tmp___20);
                }
#line 307
                if (tmp___21 == -1) {
#line 309
                  goto giveerror;
                }
                {
#line 311
                tmp___22 = js_adduint16(ar, (int )(ipwhere->data)->unit_count);
                }
#line 311
                if (tmp___22 == -1) {
#line 312
                  goto giveerror;
                }
                {
#line 314
                tmp___23 = js_append(ipwhere->data, ar);
                }
#line 314
                if (tmp___23 == -1) {
#line 315
                  goto giveerror;
                }
#line 317
                if (seenlist_where < 250) {
#line 318
                  ipwhere->seen = (char)1;
#line 319
                  seenlist[seenlist_where] = ipwhere;
#line 320
                  seenlist_where ++;
                }
#line 323
                ipwhere = ipwhere->next;
              }
              while_break___1: /* CIL Label */ ;
              }
            }
          }
#line 333
          if ((unsigned long )where->ip != (unsigned long )((struct rr *)0)) {
#line 333
            if ((int )where->rr_type == 5) {
#line 333
              if (show_cname_a == 1) {
#line 333
                if ((unsigned long )where->list == (unsigned long )((struct rr_list *)0)) {
#line 336
                  an_count = 0;
#line 337
                  ipwhere = where->ip;
                  {
#line 338
                  while (1) {
                    while_continue___2: /* CIL Label */ ;
#line 338
                    if ((unsigned long )ipwhere != (unsigned long )((rr *)0)) {
#line 338
                      if (! ((int )ipwhere->rr_type != 2)) {
#line 338
                        goto while_break___2;
                      }
                    } else {
#line 338
                      goto while_break___2;
                    }
#line 340
                    if ((int )ipwhere->seen == 1) {
#line 343
                      ipwhere = ipwhere->next;
#line 344
                      goto while_continue___2;
                    }
#line 348
                    if ((int )ipwhere->rr_type == 1) {
#line 348
                      if ((ipwhere->data)->unit_count == 4U) {
#line 348
                        if ((int )*((ipwhere->data)->string) == 255) {
#line 348
                          if ((int )*((ipwhere->data)->string + 1) == 255) {
#line 348
                            if ((int )*((ipwhere->data)->string + 2) == 255) {
#line 348
                              if ((int )*((ipwhere->data)->string + 3) == 255) {
#line 354
                                ipwhere = ipwhere->next;
#line 355
                                goto while_continue___2;
                              }
                            }
                          }
                        }
                      }
                    }
#line 358
                    if (an_count >= max_ar_chain) {
#line 359
                      goto while_break___2;
                    } else
#line 358
                    if (total_count >= max_total) {
#line 359
                      goto while_break___2;
                    }
                    {
#line 360
                    an_count ++;
#line 361
                    total_count ++;
#line 363
                    header.ancount = (uint16_t )((int )header.ancount + 1);
#line 365
                    tmp___24 = js_append(ipwhere->query, most);
                    }
#line 365
                    if (tmp___24 == -1) {
#line 366
                      goto giveerror;
                    }
                    {
#line 368
                    tmp___25 = js_adduint16(most, 1);
                    }
#line 368
                    if (tmp___25 == -1) {
#line 369
                      goto giveerror;
                    }
                    {
#line 371
                    tmp___26 = determine_ttl(ipwhere->expire, ipwhere->ttl);
#line 371
                    tmp___27 = js_adduint32(most, tmp___26);
                    }
#line 371
                    if (tmp___27 == -1) {
#line 373
                      goto giveerror;
                    }
                    {
#line 375
                    tmp___28 = js_adduint16(most, (int )(ipwhere->data)->unit_count);
                    }
#line 375
                    if (tmp___28 == -1) {
#line 377
                      goto giveerror;
                    }
                    {
#line 379
                    tmp___29 = js_append(ipwhere->data, most);
                    }
#line 379
                    if (tmp___29 == -1) {
#line 380
                      goto giveerror;
                    }
#line 382
                    if (seenlist_where < 250) {
#line 383
                      ipwhere->seen = (char)1;
#line 384
                      seenlist[seenlist_where] = ipwhere;
#line 385
                      seenlist_where ++;
                    }
#line 388
                    ipwhere = ipwhere->next;
                  }
                  while_break___2: /* CIL Label */ ;
                  }
                } else {
#line 333
                  goto _L___5;
                }
              } else {
#line 333
                goto _L___5;
              }
            } else {
#line 333
              goto _L___5;
            }
          } else
          _L___5: /* CIL Label */ 
#line 398
          if ((unsigned long )top->ptr != (unsigned long )((js_string *)0)) {
#line 398
            if ((int )top->rr_type == 5) {
#line 398
              if (show_cname_a == 12) {
#line 398
                if (seen_ptr_record == 0) {
#line 398
                  if ((unsigned long )where->list == (unsigned long )((struct rr_list *)0)) {
                    {
#line 402
                    seen_ptr_record = 1;
#line 404
                    total_count ++;
#line 406
                    header.ancount = (uint16_t )((int )header.ancount + 1);
#line 408
                    tmp___30 = js_append(top->data, most);
                    }
#line 408
                    if (tmp___30 == -1) {
#line 409
                      goto giveerror;
                    }
                    {
#line 411
                    tmp___31 = js_adduint16(most, 12);
                    }
#line 411
                    if (tmp___31 == -1) {
#line 412
                      goto giveerror;
                    }
                    {
#line 414
                    tmp___32 = js_adduint16(most, 1);
                    }
#line 414
                    if (tmp___32 == -1) {
#line 415
                      goto giveerror;
                    }
                    {
#line 417
                    tmp___33 = determine_ttl(top->expire, top->ttl);
#line 417
                    tmp___34 = js_adduint32(most, tmp___33);
                    }
#line 417
                    if (tmp___34 == -1) {
#line 419
                      goto giveerror;
                    }
                    {
#line 421
                    tmp___35 = js_adduint16(most, (int )(top->ptr)->unit_count);
                    }
#line 421
                    if (tmp___35 == -1) {
#line 423
                      goto giveerror;
                    }
                    {
#line 425
                    tmp___36 = js_append(top->ptr, most);
                    }
#line 425
                    if (tmp___36 == -1) {
#line 426
                      goto giveerror;
                    }
                  } else {
#line 398
                    goto _L___2;
                  }
                } else {
#line 398
                  goto _L___2;
                }
              } else {
#line 398
                goto _L___2;
              }
            } else {
#line 398
              goto _L___2;
            }
          } else
          _L___2: /* CIL Label */ 
#line 433
          if ((int )where->rr_type == 5) {
#line 433
            if ((unsigned long )where->list != (unsigned long )((struct rr_list *)0)) {
#line 434
              any_list = (struct rr_list *)0;
#line 435
              this_rr_type = (uint16_t )0;
#line 436
              counter = 0;
#line 438
              any_list = where->list;
#line 439
              this_rr_type = first_rr_type;
#line 441
              counter = 0;
              {
#line 441
              while (1) {
                while_continue___3: /* CIL Label */ ;
#line 441
                if (! (counter < 1000)) {
#line 441
                  goto while_break___3;
                }
#line 442
                if ((int )any_list->rr_type == (int )this_rr_type) {
#line 443
                  goto while_break___3;
                }
#line 445
                if ((unsigned long )any_list->next == (unsigned long )((struct rr_list *)0)) {
#line 446
                  goto while_break___3;
                }
#line 448
                any_list = any_list->next;
#line 441
                counter ++;
              }
              while_break___3: /* CIL Label */ ;
              }
#line 451
              if ((int )any_list->rr_type == (int )this_rr_type) {
#line 451
                if ((unsigned long )any_list->data != (unsigned long )((rr *)0)) {
#line 453
                  counter___0 = 0;
#line 454
                  answer = any_list->data;
                  {
#line 455
                  while (1) {
                    while_continue___4: /* CIL Label */ ;
#line 455
                    if ((unsigned long )answer != (unsigned long )((rr *)0)) {
#line 455
                      if ((int )answer->rr_type == (int )this_rr_type) {
#line 455
                        if (! (counter___0 < 100)) {
#line 455
                          goto while_break___4;
                        }
                      } else {
#line 455
                        goto while_break___4;
                      }
                    } else {
#line 455
                      goto while_break___4;
                    }
                    {
#line 460
                    header.ancount = (uint16_t )((int )header.ancount + 1);
#line 463
                    tmp___37 = js_append(answer->query, most);
                    }
#line 463
                    if (tmp___37 == -1) {
#line 464
                      goto giveerror;
                    }
                    {
#line 466
                    tmp___38 = js_adduint16(most, 1);
                    }
#line 466
                    if (tmp___38 == -1) {
#line 467
                      goto giveerror;
                    }
                    {
#line 474
                    tmp___39 = determine_ttl(answer->expire, answer->ttl);
#line 474
                    tmp___40 = js_adduint32(most, tmp___39);
                    }
#line 474
                    if (tmp___40 == -1) {
#line 476
                      goto giveerror;
                    }
#line 478
                    if ((unsigned long )answer->data == (unsigned long )((js_string *)0)) {
#line 479
                      goto giveerror;
                    }
#line 480
                    if ((answer->data)->unit_count < 0U) {
#line 482
                      goto giveerror;
                    } else
#line 480
                    if ((answer->data)->unit_count > 65535U) {
#line 482
                      goto giveerror;
                    }
                    {
#line 483
                    tmp___41 = js_adduint16(most, (int )(answer->data)->unit_count);
                    }
#line 483
                    if (tmp___41 == -1) {
#line 485
                      goto giveerror;
                    }
                    {
#line 487
                    tmp___42 = js_append(answer->data, most);
                    }
#line 487
                    if (tmp___42 == -1) {
#line 488
                      goto giveerror;
                    }
#line 489
                    counter___0 ++;
#line 490
                    answer = answer->next;
                  }
                  while_break___4: /* CIL Label */ ;
                  }
                }
              }
            }
          }
        }
      }
    }
#line 496
    rotate_last = where;
#line 497
    where = where->next;
#line 499
    if ((unsigned long )where == (unsigned long )((rr *)0)) {
#line 499
      if ((unsigned long )rotate_2nd != (unsigned long )((rr *)0)) {
#line 499
        if (max_ar_chain == 1) {
#line 499
          if ((int )first_rr_type != 2) {
#line 504
            if ((unsigned long )rotate_1st->zap != (unsigned long )((fila *)0)) {
#line 505
              zap_point = rotate_1st->zap;
#line 506
              rotate_1st->zap = (fila *)0;
#line 507
              rotate_2nd->zap = zap_point;
#line 508
              zap_point->record = (void *)rotate_2nd;
            }
#line 510
            rotate_1st->next = (struct rr *)0;
#line 511
            rotate_last->next = rotate_1st;
#line 512
            *rotate_point = (void *)rotate_2nd;
#line 513
            rotate_2nd = (rr *)0;
          }
        }
      }
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 519
  header.qr = 1;
#line 520
  header.opcode = 0;
#line 521
  header.tc = 0;
#line 522
  header.rd = rd_val;
#line 523
  header.ra = calc_ra_value(ra_value);
#line 524
  header.z = 0;
#line 525
  header.rcode = 0;
#line 526
  header.qdcount = (uint16_t )1;
#line 530
  length_save = (int )most->unit_count;
#line 531
  make_hdr(& header, most);
#line 532
  most->unit_count = (unsigned int )length_save;
#line 535
  tmp___43 = js_append(ar, most);
  }
#line 535
  if (tmp___43 == -1) {
#line 536
    goto giveerror;
  }
  {
#line 539
  compress_error_happened = 0;
#line 540
  tmp___44 = compress_data(most, ar);
  }
#line 540
  if (tmp___44 == -1) {
#line 541
    compress_error_happened = 1;
  }
#line 546
  if (ar->unit_count > 512U) {
#line 546
    goto _L___7;
  } else
#line 546
  if (compress_error_happened == 1) {
    _L___7: /* CIL Label */ 
#line 551
    if ((int )ect->type == 4) {
#line 551
      if (compress_error_happened == 0) {
        {
#line 554
        dq = (struct sockaddr_in *)ect->d;
#line 555
        ip_test = ntohl(dq->sin_addr.s_addr);
#line 558
        tmp___45 = check_ipv4_acl(ip_test, long_packet);
        }
#line 558
        if (tmp___45 == 1) {
#line 559
          if (ar->unit_count < 4096U) {
#line 560
            goto long_packet_ok;
          }
        }
      }
    }
#line 566
    x = 0;
    {
#line 566
    while (1) {
      while_continue___5: /* CIL Label */ ;
#line 566
      if (! (x < 20)) {
#line 566
        goto while_break___5;
      }
      {
#line 567
      compress_error_happened = 0;
#line 569
      tmp___46 = squeeze_to_fit(most);
      }
#line 569
      if ((unsigned long )tmp___46 == (unsigned long )((js_string *)0)) {
#line 570
        goto giveerror;
      }
#line 572
      if (most->unit_count > 12U) {
        {
#line 573
        tmp___47 = compress_data(most, ar);
        }
#line 573
        if (tmp___47 == -1) {
#line 574
          compress_error_happened = 1;
        }
#line 576
        if (ar->unit_count <= 512U) {
#line 576
          if (compress_error_happened == 0) {
#line 578
            goto while_break___5;
          }
        }
      } else
#line 580
      if (most->unit_count == 12U) {
        {
#line 581
        tmp___48 = js_copy(most, ar);
        }
#line 581
        if (tmp___48 == -1) {
#line 582
          goto giveerror;
        }
      } else {
#line 585
        goto giveerror;
      }
#line 566
      x ++;
    }
    while_break___5: /* CIL Label */ ;
    }
  }
  long_packet_ok: 
#line 594
  if (compress_error_happened == 1) {
#line 595
    goto giveerror;
  }
#line 599
  if ((unsigned long )ect == (unsigned long )((conn *)0)) {
    {
#line 600
    sendto(sock, (void const   *)ar->string, (size_t )ar->unit_count, 0, (struct sockaddr  const  *)((struct sockaddr *)client),
           (socklen_t )len_inet);
    }
  } else {
    {
#line 603
    mara_send(ect, sock, ar);
    }
  }
  {
#line 606
  js_destroy(most);
#line 607
  js_destroy(ar);
  }
  {
#line 610
  while (1) {
    while_continue___6: /* CIL Label */ ;
#line 610
    if (! (seenlist_where > 0)) {
#line 610
      goto while_break___6;
    }
#line 611
    seenlist_where --;
#line 612
    if ((unsigned long )seenlist[seenlist_where] != (unsigned long )((rr *)0)) {
#line 613
      (seenlist[seenlist_where])->seen = (char)0;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
#line 616
  return (1);
  giveerror: 
  {
#line 620
  js_destroy(ar);
#line 621
  udperror(sock, most, client, (js_string *)0, 2, (char *)"giveerror in udpsuccess",
           2, rd_val, ect, 1);
#line 623
  js_destroy(most);
  }
  {
#line 626
  while (1) {
    while_continue___7: /* CIL Label */ ;
#line 626
    if (! (seenlist_where > 0)) {
#line 626
      goto while_break___7;
    }
#line 627
    seenlist_where --;
#line 628
    if ((unsigned long )seenlist[seenlist_where] != (unsigned long )((rr *)0)) {
#line 629
      (seenlist[seenlist_where])->seen = (char)0;
    }
  }
  while_break___7: /* CIL Label */ ;
  }
#line 631
  return (-1);
}
}
#line 31 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_a.c"
int csv2_is_number_or_dot(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 32
  tmp = csv2_is_number(in);
  }
#line 32
  if (tmp) {
#line 32
    tmp___0 = 1;
  } else
#line 32
  if (in == 46) {
#line 32
    tmp___0 = 1;
  } else {
#line 32
    tmp___0 = 0;
  }
#line 32
  return (tmp___0);
}
}
#line 38 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_a.c"
js_string *process_ipv4_ddip(csv2_read *stream ) 
{ 
  js_string *o ;
  int32_t look ;
  int num_nums ;
  int x ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 41
  num_nums = 1;
#line 44
  o = process_1stchar(stream, & csv2_is_number, (char *)0);
  }
#line 45
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 46
    return ((js_string *)0);
  }
#line 49
  x = 0;
  {
#line 49
  while (1) {
    while_continue: /* CIL Label */ ;
#line 49
    if (! (x < 10000)) {
#line 49
      goto while_break;
    }
    {
#line 50
    look = csv2_read_unicode(stream);
    }
#line 51
    if (look == -164) {
      {
#line 52
      js_destroy(o);
      }
#line 53
      return ((js_string *)0);
    }
#line 55
    if (look == 35) {
#line 55
      if (num_nums == 4) {
        {
#line 56
        process_comment(stream);
        }
#line 57
        return (o);
      } else {
#line 55
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 59
    if (look == 46) {
#line 59
      if (num_nums < 4) {
        {
#line 60
        num_nums ++;
#line 61
        tmp = csv2_append_utf8(o, '.');
        }
#line 61
        if (tmp < 0) {
          {
#line 62
          csv2_error(stream, (char *)"Error appending character");
#line 63
          js_destroy(o);
          }
#line 64
          return ((js_string *)0);
        }
      } else {
#line 59
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 67
    if (look == 46) {
      {
#line 68
      csv2_error(stream, (char *)"Too many numbers in ipv4 ddip");
#line 69
      js_destroy(o);
      }
#line 70
      return ((js_string *)0);
    } else {
      {
#line 72
      tmp___2 = csv2_is_number(look);
      }
#line 72
      if (tmp___2) {
        {
#line 73
        tmp___0 = csv2_append_utf8(o, look);
        }
#line 73
        if (tmp___0 < 0) {
          {
#line 74
          csv2_error(stream, (char *)"Error appending character");
#line 75
          js_destroy(o);
          }
#line 76
          return ((js_string *)0);
        }
      } else {
        {
#line 79
        tmp___1 = csv2_is_delimiter(look);
        }
#line 79
        if (tmp___1) {
#line 79
          if (num_nums == 4) {
#line 80
            return (o);
          } else {
            {
#line 83
            csv2_error(stream, (char *)"Unexpected character in ddip");
#line 84
            js_destroy(o);
            }
#line 85
            return ((js_string *)0);
          }
        } else {
          {
#line 83
          csv2_error(stream, (char *)"Unexpected character in ddip");
#line 84
          js_destroy(o);
          }
#line 85
          return ((js_string *)0);
        }
      }
    }
#line 49
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 89
  js_destroy(o);
  }
#line 90
  return ((js_string *)0);
}
}
#line 95 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_a.c"
js_string *csv2_get_a(csv2_read *stream ) 
{ 
  js_string *ddip ;
  js_string *out ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 99
  tmp = csv2_get_1st(stream, & csv2_is_number, 0);
  }
#line 99
  if (tmp != 1) {
#line 100
    return ((js_string *)0);
  }
  {
#line 103
  ddip = process_ipv4_ddip(stream);
  }
#line 103
  if ((unsigned long )ddip == (unsigned long )((js_string *)0)) {
#line 104
    return ((js_string *)0);
  }
  {
#line 107
  out = js_create(7U, 1U);
  }
#line 107
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
    {
#line 108
    js_destroy(ddip);
    }
#line 109
    return ((js_string *)0);
  }
  {
#line 112
  tmp___0 = ddip_2_ip(ddip, out, 0);
  }
#line 112
  if (tmp___0 == -1) {
    {
#line 113
    js_destroy(ddip);
#line 114
    js_destroy(out);
    }
#line 115
    return ((js_string *)0);
  }
  {
#line 118
  js_destroy(ddip);
  }
#line 119
  return (out);
}
}
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int set_nybble(unsigned int nybble , unsigned char *istring , int point , int length ) 
{ 
  char temp ;
  int place ;

  {
#line 39
  if (nybble < 0U) {
#line 40
    return (-1);
  } else
#line 39
  if (nybble > 15U) {
#line 40
    return (-1);
  }
#line 42
  if (length < 0) {
#line 43
    return (-1);
  }
#line 45
  if (length * 2 < point) {
#line 46
    return (-1);
  }
#line 48
  place = point >> 1;
#line 49
  temp = (char )*(istring + place);
#line 50
  if ((point & 1) == 0) {
#line 51
    nybble <<= 4;
#line 52
    temp = (char )((int )temp & 15);
#line 53
    temp = (char )((unsigned int )temp | nybble);
  } else {
#line 56
    temp = (char )((int )temp & 240);
#line 57
    temp = (char )((unsigned int )temp | nybble);
  }
#line 59
  *(istring + place) = (unsigned char )temp;
#line 60
  return (1);
}
}
#line 67 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int hchar_to_nybble(char i ) 
{ 


  {
#line 68
  if ((int )i >= 48) {
#line 68
    if ((int )i <= 57) {
#line 69
      return ((int )i - 48);
    }
  }
#line 70
  if ((int )i >= 97) {
#line 70
    if ((int )i <= 102) {
#line 71
      return (((int )i + 10) - 97);
    }
  }
#line 72
  if ((int )i >= 65) {
#line 72
    if ((int )i <= 70) {
#line 73
      return (((int )i + 10) - 65);
    }
  }
#line 74
  if ((int )i == 58) {
#line 75
    return (-2);
  }
#line 76
  return (-1);
}
}
#line 87 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int set_nybble_char(char nybble , unsigned char *istring , int point , int length ) 
{ 
  int n ;
  int tmp ;

  {
  {
#line 89
  n = hchar_to_nybble(nybble);
  }
#line 90
  if (n == -1) {
#line 91
    return (-1);
  }
#line 92
  if (n == -2) {
#line 93
    return (-2);
  }
  {
#line 94
  tmp = set_nybble((unsigned int )n, istring, point, length);
  }
#line 94
  return (tmp);
}
}
#line 102 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int set_nybble_js(js_string *i , int i_offset , js_string *o , int o_offset ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;

  {
  {
#line 103
  tmp = js_has_sanity(i);
  }
#line 103
  if (tmp != 1) {
#line 104
    return (-1);
  }
  {
#line 105
  tmp___0 = js_has_sanity(o);
  }
#line 105
  if (tmp___0 != 1) {
#line 106
    return (-1);
  }
#line 107
  if (i->unit_size != 1U) {
#line 108
    return (-1);
  }
#line 109
  if (o->unit_size != 1U) {
#line 110
    return (-1);
  }
#line 111
  if ((unsigned int )i_offset > i->unit_count) {
#line 112
    return (-1);
  }
#line 113
  if ((unsigned int )o_offset > o->unit_count * 2U) {
#line 114
    return (-1);
  }
  {
#line 115
  tmp___1 = set_nybble_char((char )*(i->string + i_offset), o->string, o_offset, (int )o->unit_count);
  }
#line 115
  return (tmp___1);
}
}
#line 126 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int is_hex_digit(char c ) 
{ 
  int tmp ;

  {
#line 127
  if ((int )c >= 48) {
#line 127
    if ((int )c <= 57) {
#line 127
      tmp = 1;
    } else {
#line 127
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 127
  if ((int )c >= 65) {
#line 127
    if ((int )c <= 70) {
#line 127
      tmp = 1;
    } else {
#line 127
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 127
  if ((int )c >= 97) {
#line 127
    if ((int )c <= 102) {
#line 127
      tmp = 1;
    } else {
#line 127
      tmp = 0;
    }
  } else {
#line 127
    tmp = 0;
  }
#line 127
  return (tmp);
}
}
#line 138 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int is_colon(char c ) 
{ 


  {
#line 139
  return ((int )c == 58);
}
}
#line 149 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int count_thingys(js_string *i , int offset , int (*is_thingy)(char in ) ) 
{ 
  int count ;
  int tmp ;

  {
#line 151
  if (i->unit_size != 1U) {
#line 152
    return (-1);
  }
#line 154
  if (i->unit_count >= i->max_count) {
#line 155
    return (-1);
  }
#line 157
  if ((unsigned int )offset > i->unit_count) {
#line 158
    return (-1);
  }
#line 160
  count = 0;
  {
#line 161
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 161
    tmp = (*is_thingy)((char )*(i->string + offset));
    }
#line 161
    if (! tmp) {
#line 161
      goto while_break;
    }
#line 162
    count ++;
#line 163
    offset ++;
#line 164
    if ((unsigned int )offset == i->unit_count) {
#line 165
      return (count);
    }
#line 167
    if ((unsigned int )offset > i->unit_count) {
#line 168
      return (-1);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 171
  return (count);
}
}
#line 184 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int count_digits(js_string *i , int offset ) 
{ 
  int tmp ;

  {
  {
#line 185
  tmp = count_thingys(i, offset, & is_hex_digit);
  }
#line 185
  return (tmp);
}
}
#line 190 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int see_double_colon(js_string *i , int offset ) 
{ 
  int tmp ;

  {
  {
#line 191
  tmp = count_thingys(i, offset, & is_colon);
  }
#line 191
  return (tmp);
}
}
#line 206 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int count_thingys_all(js_string *i , int offset , int (*is_thingy)(char in ) ) 
{ 
  int count ;
  int tmp ;

  {
#line 208
  if (i->unit_size != 1U) {
#line 209
    return (-1);
  }
#line 211
  if (i->unit_count >= i->max_count) {
#line 212
    return (-1);
  }
#line 214
  if ((unsigned int )offset > i->unit_count) {
#line 215
    return (-1);
  }
#line 217
  count = 0;
  {
#line 218
  while (1) {
    while_continue: /* CIL Label */ ;
#line 218
    if (! ((unsigned int )offset < i->unit_count)) {
#line 218
      goto while_break;
    }
    {
#line 219
    tmp = (*is_thingy)((char )*(i->string + offset));
    }
#line 219
    if (tmp) {
#line 220
      count ++;
    }
#line 222
    offset ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 224
  return (count);
}
}
#line 234 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
int count_colons(js_string *i , int offset ) 
{ 
  int tmp ;

  {
  {
#line 235
  tmp = count_thingys_all(i, offset, & is_colon);
  }
#line 235
  return (tmp);
}
}
#line 245 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Parse_ipv6.c"
js_string *ip6_to_raw(js_string *i ) 
{ 
  js_string *o ;
  int input_point ;
  int output_point ;
  int counter ;
  int w ;
  int l ;
  int c ;
  int skipped ;
  int init_colon ;
  int tmp ;
  int q ;
  int n ;
  int tmp___0 ;
  int cc ;

  {
  {
#line 249
  skipped = 0;
#line 250
  init_colon = 1;
#line 253
  tmp = js_has_sanity(i);
  }
#line 253
  if (tmp != 1) {
#line 254
    return ((js_string *)0);
  }
#line 256
  if (i->unit_size != 1U) {
#line 257
    return ((js_string *)0);
  }
  {
#line 261
  o = js_create(16U, 1U);
  }
#line 261
  if ((unsigned long )o == (unsigned long )((js_string *)0)) {
#line 262
    return ((js_string *)0);
  }
#line 266
  counter = 0;
  {
#line 266
  while (1) {
    while_continue: /* CIL Label */ ;
#line 266
    if (! (counter < 16)) {
#line 266
      goto while_break;
    }
#line 267
    *(o->string + counter) = (unsigned char)0;
#line 266
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 269
  o->unit_count = 16U;
#line 271
  output_point = 0;
#line 271
  input_point = output_point;
#line 273
  w = 1;
#line 275
  l = js_length(i);
#line 277
  c = 0;
  }
  {
#line 279
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 279
    if (output_point < 32) {
#line 279
      if (! (input_point < l)) {
#line 279
        goto while_break___0;
      }
    } else {
#line 279
      goto while_break___0;
    }
    {
#line 284
    n = count_digits(i, input_point);
    }
#line 285
    if (init_colon == 1) {
#line 285
      if (n == 0) {
#line 286
        goto zeros;
      }
    }
#line 288
    init_colon = 0;
#line 289
    if (n > 4) {
      {
#line 290
      show_esc_stdout(o);
#line 290
      printf((char const   */* __restrict  */)"\n");
#line 291
      js_dealloc((void *)o);
      }
#line 292
      return ((js_string *)0);
    } else
#line 289
    if (n < 1) {
      {
#line 290
      show_esc_stdout(o);
#line 290
      printf((char const   */* __restrict  */)"\n");
#line 291
      js_dealloc((void *)o);
      }
#line 292
      return ((js_string *)0);
    }
#line 295
    counter = 0;
    {
#line 295
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 295
      if (! (counter < 4 - n)) {
#line 295
        goto while_break___1;
      }
      {
#line 296
      set_nybble(0U, o->string, output_point, (int )o->unit_count);
#line 297
      output_point ++;
#line 295
      counter ++;
      }
    }
    while_break___1: /* CIL Label */ ;
    }
#line 299
    counter = 4 - n;
    {
#line 299
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 299
      if (! (counter < 4)) {
#line 299
        goto while_break___2;
      }
      {
#line 300
      tmp___0 = set_nybble_js(i, input_point, o, output_point);
      }
#line 300
      if (tmp___0 != 1) {
        {
#line 302
        js_dealloc((void *)o);
        }
#line 303
        return ((js_string *)0);
      }
#line 305
      input_point ++;
#line 306
      output_point ++;
#line 299
      counter ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    zeros: 
#line 311
    if ((unsigned int )input_point < i->unit_count) {
      {
#line 312
      q = see_double_colon(i, input_point);
      }
    } else
#line 313
    if ((unsigned int )input_point == i->unit_count) {
#line 314
      q = 0;
    } else {
      {
#line 316
      js_dealloc((void *)o);
      }
#line 317
      return ((js_string *)0);
    }
#line 319
    if (q == -1) {
      {
#line 320
      js_dealloc((void *)o);
      }
#line 321
      return ((js_string *)0);
    }
#line 323
    if (q == 2) {
#line 325
      if (skipped != 0) {
        {
#line 329
        js_dealloc((void *)o);
        }
#line 330
        return ((js_string *)0);
      }
      {
#line 332
      skipped = 1;
#line 333
      input_point ++;
#line 342
      cc = count_colons(i, input_point);
      }
#line 343
      if (cc == -1) {
        {
#line 344
        js_dealloc((void *)o);
        }
#line 345
        return ((js_string *)0);
      }
#line 347
      if (init_colon == 1) {
#line 348
        cc --;
      }
#line 350
      output_point += 4 * ((8 - (c + 1)) - cc);
#line 351
      input_point ++;
    } else
#line 353
    if (q == 1) {
#line 354
      input_point ++;
    } else
#line 356
    if (q == 0) {
#line 356
      if ((unsigned int )input_point == i->unit_count) {
#line 357
        return (o);
      } else {
        {
#line 360
        js_dealloc((void *)o);
        }
#line 361
        return ((js_string *)0);
      }
    } else {
      {
#line 360
      js_dealloc((void *)o);
      }
#line 361
      return ((js_string *)0);
    }
#line 363
    init_colon = 0;
#line 364
    c ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 366
  if (input_point < l) {
    {
#line 367
    js_dealloc((void *)o);
    }
#line 368
    return ((js_string *)0);
  }
#line 370
  return (o);
}
}
#line 257 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_close(csv2_read *file___6 ) ;
#line 263
csv2_read *csv2_open(js_string *filename ) ;
#line 290
int csv2_pop_file(csv2_read *file___6 ) ;
#line 293
void csv2_allow_leftbrace(csv2_read *file___6 ) ;
#line 294
void csv2_forbid_leftbrace(csv2_read *file___6 ) ;
#line 37 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
extern int csv2_tilde_handling ;
#line 36 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
csv2_read *csv2_open(js_string *filename ) 
{ 
  csv2_read *out ;
  int c ;
  void *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  FILE *tmp___3 ;

  {
#line 41
  if (filename->unit_size != 1U) {
#line 42
    return ((csv2_read *)0);
  }
  {
#line 45
  tmp = js_alloc((int )sizeof(csv2_read ), 1);
#line 45
  out = (csv2_read *)tmp;
  }
#line 45
  if ((unsigned long )out == (unsigned long )((csv2_read *)0)) {
#line 46
    return ((csv2_read *)0);
  }
  {
#line 49
  tmp___1 = js_alloc((int )(filename->unit_count + 3U), 1);
#line 49
  tmp___0 = (char *)tmp___1;
#line 49
  out->filename = tmp___0;
  }
#line 49
  if ((unsigned long )tmp___0 == (unsigned long )((char *)0)) {
    {
#line 50
    js_dealloc((void *)out);
    }
#line 51
    return ((csv2_read *)0);
  }
  {
#line 54
  tmp___2 = js_js2str(filename, out->filename, (int )(filename->unit_count + 1U));
  }
#line 54
  if (tmp___2 == -1) {
    {
#line 56
    js_dealloc((void *)out);
    }
#line 57
    return ((csv2_read *)0);
  }
#line 61
  out->stack = (csv2_file *)0;
#line 62
  out->stack_height = 0;
#line 63
  out->mnum = 0;
#line 64
  out->mplace = 0;
#line 65
  out->cplace = 0;
#line 66
  c = 0;
  {
#line 66
  while (1) {
    while_continue: /* CIL Label */ ;
#line 66
    if (! (c < 19)) {
#line 66
      goto while_break;
    }
#line 67
    out->context[c] = (char)0;
#line 66
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 69
  out->tilde_seen = (char)0;
#line 70
  out->tilde_handling = (char )csv2_tilde_handling;
#line 71
  if (csv2_tilde_handling == 0) {
#line 72
    out->chars_allowed = (char)1;
  } else {
#line 75
    out->chars_allowed = (char)0;
  }
  {
#line 78
  out->linenum = 1;
#line 79
  out->justread = -328;
#line 81
  out->unicode = -1;
#line 82
  out->ok_to_read = 1;
#line 83
  out->seen_bug_msg = (char)0;
#line 85
  tmp___3 = fopen((char const   */* __restrict  */)out->filename, (char const   */* __restrict  */)"rb");
#line 85
  out->reading = tmp___3;
  }
#line 85
  if ((unsigned long )tmp___3 == (unsigned long )((FILE *)0)) {
    {
#line 86
    js_dealloc((void *)out);
    }
#line 87
    return ((csv2_read *)0);
  }
#line 90
  return (out);
}
}
#line 100 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_close(csv2_read *file___6 ) 
{ 
  csv2_file *v ;
  csv2_file *w ;
  int a ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 102
  a = 0;
#line 103
  tmp = fclose(file___6->reading);
  }
#line 103
  if (tmp != 0) {
#line 104
    return (-1);
  }
#line 107
  v = file___6->stack;
  {
#line 108
  while (1) {
    while_continue: /* CIL Label */ ;
#line 108
    if ((unsigned long )v != (unsigned long )((csv2_file *)0)) {
#line 108
      if (! (a < 1000)) {
#line 108
        goto while_break;
      }
    } else {
#line 108
      goto while_break;
    }
    {
#line 109
    w = v->next;
#line 110
    fclose(v->reading);
#line 111
    js_dealloc((void *)v->filename);
#line 112
    js_dealloc((void *)v);
#line 113
    v = w;
#line 114
    a ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 117
  js_dealloc((void *)file___6->filename);
#line 119
  tmp___0 = js_dealloc((void *)file___6);
  }
#line 119
  if (tmp___0 != 1) {
#line 120
    return (-1);
  }
#line 123
  return (1);
}
}
#line 132 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_readchar(csv2_read *file___6 ) 
{ 
  int out ;
  char *mstrn ;
  int tmp ;

  {
#line 133
  out = -2;
#line 134
  mstrn = (char *)"NO MACROS YET**";
#line 137
  if (file___6->ok_to_read != 1) {
#line 138
    if ((int )file___6->seen_bug_msg == 0) {
      {
#line 139
      printf((char const   */* __restrict  */)"BUG: The code shouln\'t be trying to read from");
#line 140
      printf((char const   */* __restrict  */)" a closed stream!\n");
#line 141
      file___6->seen_bug_msg = (char )((int )file___6->seen_bug_msg + 1);
      }
    }
#line 143
    return (-2);
  }
#line 149
  if (file___6->mnum == -1) {
#line 150
    if (file___6->mplace < 0) {
#line 151
      file___6->mplace = 0;
#line 152
      file___6->mnum = 0;
    } else
#line 150
    if (file___6->mplace >= 14) {
#line 151
      file___6->mplace = 0;
#line 152
      file___6->mnum = 0;
    } else {
#line 155
      out = (int )*(mstrn + file___6->mplace);
#line 156
      if (out == 0) {
#line 157
        file___6->mplace = 0;
#line 158
        file___6->mnum = 0;
      } else {
#line 161
        (file___6->mplace) ++;
#line 162
        file___6->justread = out;
#line 163
        return (out);
      }
    }
  } else
#line 166
  if (file___6->mnum == 2) {
#line 167
    file___6->justread = '\n';
#line 168
    file___6->mnum = 0;
#line 169
    return ('\n');
  }
#line 173
  if (file___6->mnum == 0) {
    read_char: 
    {
#line 175
    out = _IO_getc(file___6->reading);
    }
#line 181
    if (out < 32) {
#line 181
      if (out >= 0) {
#line 181
        if (out != 9) {
#line 181
          if (out != 13) {
#line 181
            if (out != 10) {
              {
#line 183
              printf((char const   */* __restrict  */)"Warning: Unprintable character in zone file: %02x\n",
                     out);
              }
            }
          }
        }
      }
    }
#line 186
    tmp = file___6->cplace;
#line 186
    (file___6->cplace) ++;
#line 186
    file___6->context[tmp] = (char )out;
#line 187
    if (file___6->cplace == 19) {
#line 187
      file___6->cplace = 0;
    }
#line 188
    if (out == 10) {
#line 189
      (file___6->linenum) ++;
    }
#line 191
    if (out == -1) {
#line 192
      if ((unsigned long )file___6->stack != (unsigned long )((csv2_file *)0)) {
        {
#line 193
        csv2_pop_file(file___6);
        }
#line 194
        goto read_char;
      }
#line 196
      return (-2);
    }
#line 199
    if (out == 126) {
#line 199
      if ((int )file___6->tilde_seen < 10) {
#line 200
        file___6->tilde_seen = (char )((int )file___6->tilde_seen + 1);
      }
    }
#line 203
    if (out == 123) {
#line 203
      if (((int )file___6->chars_allowed & 2) != 2) {
        {
#line 206
        csv2_error(file___6, (char *)"The \'{\' character is currently not allowed there in zone files.\nPlease use an unquoted \\x7b if you need this character in a txt or raw record.\nSee the csv2_txt man page for more information.");
        }
      } else {
#line 203
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 213
    if (out == 126) {
#line 213
      if (((int )file___6->chars_allowed & 1) != 1) {
        {
#line 215
        csv2_error(file___6, (char *)"The \'~\' character is currently not allowed there in zone files.\nPlease use an unquoted \\x7e if you need this character in a txt or raw record.\nSee the csv2_txt man page for more information.");
        }
      } else {
#line 222
        file___6->justread = out;
#line 223
        return (out);
      }
    } else {
#line 222
      file___6->justread = out;
#line 223
      return (out);
    }
  }
#line 226
  return (out);
}
}
#line 234 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_justread(csv2_read *file___6 ) 
{ 


  {
#line 235
  if (file___6->ok_to_read != 1) {
    {
#line 236
    printf((char const   */* __restrict  */)"BUG: Don\'t run csv2_justread on a closed file!\n");
    }
#line 237
    return (-1);
  }
#line 239
  return (file___6->justread);
}
}
#line 243 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_error(csv2_read *file___6 , char *why ) 
{ 
  int c ;
  int lastcr ;

  {
  {
#line 245
  printf((char const   */* __restrict  */)"Error: ");
#line 246
  printf((char const   */* __restrict  */)"%s\n", why);
#line 247
  printf((char const   */* __restrict  */)"Error is on line ");
  }
#line 251
  if (file___6->justread == 10) {
#line 252
    (file___6->linenum) --;
#line 253
    file___6->justread = '\000';
  }
  {
#line 255
  printf((char const   */* __restrict  */)"%d", file___6->linenum);
#line 256
  printf((char const   */* __restrict  */)" in file ");
#line 257
  printf((char const   */* __restrict  */)"%s\n", file___6->filename);
#line 260
  printf((char const   */* __restrict  */)"context of error: ");
#line 262
  c = file___6->cplace;
#line 267
  lastcr = -1;
  }
  {
#line 268
  while (1) {
    while_continue: /* CIL Label */ ;
#line 269
    c ++;
#line 270
    c %= 19;
#line 271
    if ((int )file___6->context[c] == 10) {
#line 271
      if (c != file___6->cplace) {
#line 272
        lastcr = c;
      }
    }
#line 268
    if (! (c != file___6->cplace)) {
#line 268
      goto while_break;
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 275
  if (lastcr != -1) {
#line 276
    c = lastcr + 1;
#line 277
    c %= 19;
  }
#line 281
  if (file___6->cplace == (c + 1) % 19) {
    {
#line 285
    printf((char const   */* __restrict  */)"<near beginning of line> ");
    }
  } else
#line 281
  if (file___6->cplace == (c + 2) % 19) {
    {
#line 285
    printf((char const   */* __restrict  */)"<near beginning of line> ");
    }
  } else
#line 281
  if (file___6->cplace == (c + 3) % 19) {
    {
#line 285
    printf((char const   */* __restrict  */)"<near beginning of line> ");
    }
  } else
#line 281
  if (file___6->cplace == (c + 4) % 19) {
    {
#line 285
    printf((char const   */* __restrict  */)"<near beginning of line> ");
    }
  }
  {
#line 289
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 290
    if ((int )file___6->context[c] >= 32) {
      {
#line 291
      printf((char const   */* __restrict  */)"%c", (int )file___6->context[c]);
      }
    } else
#line 293
    if ((int )file___6->context[c] == 9) {
      {
#line 294
      printf((char const   */* __restrict  */)"   ");
      }
    } else
#line 295
    if ((int )file___6->context[c] > 0) {
      {
#line 296
      printf((char const   */* __restrict  */)"~");
      }
    }
#line 298
    c ++;
#line 299
    c %= 19;
#line 289
    if (! (c != file___6->cplace)) {
#line 289
      goto while_break___0;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 302
  printf((char const   */* __restrict  */)" (closing this file)\n");
#line 304
  file___6->ok_to_read = 0;
  }
#line 305
  return (1);
}
}
#line 312 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_push_file(csv2_read *file___6 , js_string *filename ) 
{ 
  csv2_file *o ;
  char *nf ;
  FILE *nfd ;
  void *tmp ;
  int tmp___0 ;
  void *tmp___1 ;

  {
#line 317
  if (file___6->stack_height > 7) {
#line 318
    return (0);
  }
#line 321
  if ((unsigned long )filename == (unsigned long )((js_string *)0)) {
#line 322
    return (0);
  }
#line 325
  if (filename->unit_size != 1U) {
#line 326
    return (0);
  }
  {
#line 329
  tmp = js_alloc((int )(filename->unit_count + 3U), 1);
#line 329
  nf = (char *)tmp;
  }
#line 329
  if ((unsigned long )nf == (unsigned long )((char *)0)) {
#line 330
    return (0);
  }
  {
#line 333
  tmp___0 = js_js2str(filename, nf, (int )(filename->unit_count + 1U));
  }
#line 333
  if (tmp___0 == -1) {
    {
#line 335
    js_dealloc((void *)nf);
    }
#line 336
    return (0);
  }
  {
#line 339
  nfd = fopen((char const   */* __restrict  */)nf, (char const   */* __restrict  */)"rb");
  }
#line 339
  if ((unsigned long )nfd == (unsigned long )((FILE *)0)) {
    {
#line 340
    js_dealloc((void *)nf);
    }
#line 341
    return (0);
  }
  {
#line 344
  tmp___1 = js_alloc(1, (int )(sizeof(csv2_file ) + 1UL));
#line 344
  o = (csv2_file *)tmp___1;
  }
#line 344
  if ((unsigned long )o == (unsigned long )((csv2_file *)0)) {
    {
#line 345
    js_dealloc((void *)nf);
#line 346
    fclose(nfd);
    }
#line 347
    return (0);
  }
#line 350
  o->filename = file___6->filename;
#line 351
  o->reading = file___6->reading;
#line 352
  o->next = file___6->stack;
#line 353
  file___6->stack = o;
#line 354
  file___6->filename = nf;
#line 355
  file___6->reading = nfd;
#line 356
  (file___6->stack_height) ++;
#line 357
  file___6->mnum = 2;
#line 359
  return (1);
}
}
#line 367 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_pop_file(csv2_read *file___6 ) 
{ 
  csv2_file *v ;

  {
  {
#line 369
  fclose(file___6->reading);
#line 371
  js_dealloc((void *)file___6->filename);
#line 372
  v = file___6->stack;
  }
#line 374
  if ((unsigned long )v == (unsigned long )((csv2_file *)0)) {
    {
#line 375
    csv2_error(file___6, (char *)"Trying to pop from empty stack");
    }
#line 376
    return (0);
  }
#line 379
  file___6->reading = v->reading;
#line 380
  file___6->filename = v->filename;
#line 381
  file___6->stack = v->next;
#line 382
  (file___6->stack_height) --;
#line 383
  if (file___6->stack_height < 0) {
    {
#line 384
    csv2_error(file___6, (char *)"Trying to pop from empty stack");
    }
#line 385
    return (0);
  }
  {
#line 387
  js_dealloc((void *)v);
  }
#line 389
  return (1);
}
}
#line 394 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_set_unicode(csv2_read *file___6 , int32_t in ) 
{ 


  {
#line 395
  if (file___6->ok_to_read != 1) {
    {
#line 396
    printf((char const   */* __restrict  */)"BUG: Don\'t run csv2_set_unicode on a closed file!\n");
    }
#line 397
    return (-1);
  }
#line 399
  file___6->unicode = in;
#line 400
  return (0);
}
}
#line 404 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int32_t csv2_get_unicode(csv2_read *file___6 ) 
{ 


  {
#line 405
  if (file___6->ok_to_read != 1) {
    {
#line 406
    printf((char const   */* __restrict  */)"BUG: Don\'t run csv2_get_unicode on a closed file!\n");
    }
#line 407
    return (-1);
  }
#line 409
  return (file___6->unicode);
}
}
#line 413 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
void csv2_allow_tilde(csv2_read *file___6 ) 
{ 


  {
#line 414
  file___6->chars_allowed = (char )((int )file___6->chars_allowed | 1);
#line 415
  return;
}
}
#line 418 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
void csv2_forbid_tilde(csv2_read *file___6 ) 
{ 


  {
#line 419
  file___6->chars_allowed = (char )((int )file___6->chars_allowed & 126);
#line 420
  return;
}
}
#line 423 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
void csv2_allow_leftbrace(csv2_read *file___6 ) 
{ 


  {
#line 424
  file___6->chars_allowed = (char )((int )file___6->chars_allowed | 2);
#line 425
  return;
}
}
#line 428 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
void csv2_forbid_leftbrace(csv2_read *file___6 ) 
{ 


  {
#line 429
  file___6->chars_allowed = (char )((int )file___6->chars_allowed & 125);
#line 430
  return;
}
}
#line 433 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
int csv2_tilde_seen(csv2_read *file___6 ) 
{ 


  {
#line 434
  return ((int )file___6->tilde_seen);
}
}
#line 438 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_read.c"
void csv2_reset_tilde_seen(csv2_read *file___6 ) 
{ 


  {
#line 439
  file___6->tilde_seen = (char)0;
#line 440
  return;
}
}
#line 264 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_is_hex(int32_t in ) ;
#line 70 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_txtchar(int32_t in ) 
{ 
  int tmp ;

  {
#line 71
  if (in >= 48) {
#line 71
    if (in <= 57) {
#line 71
      tmp = 1;
    } else {
#line 71
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 71
  if (in >= 97) {
#line 71
    if (in <= 122) {
#line 71
      tmp = 1;
    } else {
#line 71
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 71
  if (in >= 65) {
#line 71
    if (in <= 90) {
#line 71
      tmp = 1;
    } else {
#line 71
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 71
  if (in == 45) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 95) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 43) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 37) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 33) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 94) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 61) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 59) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 92) {
#line 71
    tmp = 1;
  } else
#line 71
  if (in == 39) {
#line 71
    tmp = 1;
  } else {
#line 71
    tmp = 0;
  }
#line 71
  return (tmp);
}
}
#line 87 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_txt_bchar(int32_t in ) 
{ 
  int tmp ;

  {
#line 88
  if (in >= 48) {
#line 88
    if (in <= 57) {
#line 88
      tmp = 1;
    } else {
#line 88
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 88
  if (in >= 97) {
#line 88
    if (in <= 122) {
#line 88
      tmp = 1;
    } else {
#line 88
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 88
  if (in >= 65) {
#line 88
    if (in <= 90) {
#line 88
      tmp = 1;
    } else {
#line 88
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 88
  if (in == 45) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 95) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 43) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 37) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 33) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 94) {
#line 88
    tmp = 1;
  } else
#line 88
  if (in == 61) {
#line 88
    tmp = 1;
  } else {
#line 88
    tmp = 0;
  }
#line 88
  return (tmp);
}
}
#line 101 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_isnt_quote(int32_t in ) 
{ 


  {
#line 102
  return (in != 39);
}
}
#line 106 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_quote(int32_t in ) 
{ 


  {
#line 107
  return (in == 39);
}
}
#line 111 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_pipe(int32_t in ) 
{ 


  {
#line 112
  return (in == 124);
}
}
#line 116 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_0123(int32_t in ) 
{ 
  int tmp ;

  {
#line 117
  if (in >= 48) {
#line 117
    if (in <= 51) {
#line 117
      tmp = 1;
    } else {
#line 117
      tmp = 0;
    }
  } else {
#line 117
    tmp = 0;
  }
#line 117
  return (tmp);
}
}
#line 121 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_x(int32_t in ) 
{ 


  {
#line 122
  return (in == 120);
}
}
#line 126 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_hash(int32_t in ) 
{ 


  {
#line 127
  return (in == 35);
}
}
#line 131 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_octal(int32_t in ) 
{ 
  int tmp ;

  {
#line 132
  if (in >= 48) {
#line 132
    if (in <= 55) {
#line 132
      tmp = 1;
    } else {
#line 132
      tmp = 0;
    }
  } else {
#line 132
    tmp = 0;
  }
#line 132
  return (tmp);
}
}
#line 136 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_bslash(int32_t in ) 
{ 


  {
#line 137
  return (in == 92);
}
}
#line 141 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_is_semicolon(int32_t in ) 
{ 


  {
#line 142
  return (in == 59);
}
}
#line 148 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
js_string *csv2_get_txt(csv2_read *stream , int numchunks ) 
{ 
  js_string *tmp ;

  {
  {
#line 149
  tmp = csv2_get_string(stream, numchunks, 0);
  }
#line 149
  return (tmp);
}
}
#line 155 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
js_string *csv2_get_raw(csv2_read *stream ) 
{ 
  js_string *tmp ;

  {
  {
#line 156
  tmp = csv2_get_string(stream, -1, 0);
  }
#line 156
  return (tmp);
}
}
#line 166 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
int csv2_txt_append(js_string *out , int32_t chr , int *len ) 
{ 
  int tmp ;

  {
  {
#line 167
  tmp = csv2_append_utf8(out, chr);
  }
#line 167
  if (tmp == -1) {
    {
#line 168
    js_destroy(out);
    }
#line 169
    return (0);
  }
#line 171
  if (chr < 128) {
#line 173
    (*len) ++;
  } else
#line 174
  if (chr < 2048) {
#line 175
    *len += 2;
  } else
#line 176
  if (chr < 65536) {
#line 177
    *len += 3;
  } else
#line 178
  if (chr < 2097152) {
#line 179
    *len += 4;
  } else {
    {
#line 180
    printf((char const   */* __restrict  */)"Whoo!  Unicode is huge!\n");
#line 180
    exit(1);
    }
  }
#line 181
  return (1);
}
}
#line 187 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
js_string *csv2_finalize_txt(csv2_read *stream , int numchunks , int chunkcount ,
                             int txt_len_place , int txt_len , js_string *out ) 
{ 


  {
#line 192
  if (numchunks != -1) {
#line 193
    if (txt_len_place < 0) {
      {
#line 194
      js_destroy(out);
      }
#line 195
      return ((js_string *)0);
    } else
#line 193
    if ((unsigned int )txt_len_place > out->max_count) {
      {
#line 194
      js_destroy(out);
      }
#line 195
      return ((js_string *)0);
    }
#line 197
    if (txt_len > 255) {
      {
#line 198
      csv2_error(stream, (char *)"Single TXT chunk too long");
#line 199
      js_destroy(out);
      }
#line 200
      return ((js_string *)0);
    }
#line 202
    *(out->string + txt_len_place) = (unsigned char )txt_len;
#line 203
    chunkcount ++;
  }
#line 206
  if (numchunks > 0) {
#line 206
    if (chunkcount != numchunks) {
      {
#line 207
      csv2_error(stream, (char *)"Incorrect number of chunks for this RR");
#line 208
      js_destroy(out);
      }
#line 209
      return ((js_string *)0);
    }
  }
#line 212
  return (out);
}
}
#line 221 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_txt.c"
js_string *csv2_get_string(csv2_read *stream , int numchunks , int post_txt ) 
{ 
  int state ;
  int out_num ;
  int txt_len_place ;
  int txt_len ;
  int chunkcount ;
  int x ;
  int32_t look ;
  js_string *out ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  js_string *tmp___10 ;
  int tmp___11 ;
  js_string *tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  int tmp___31 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;
  int tmp___37 ;
  int tmp___38 ;
  int tmp___39 ;
  int tmp___40 ;
  int tmp___41 ;
  int tmp___42 ;
  int tmp___43 ;
  int tmp___44 ;
  int tmp___45 ;
  int tmp___46 ;
  int tmp___47 ;
  int tmp___48 ;
  int tmp___49 ;
  js_string *tmp___50 ;
  int tmp___51 ;
  int tmp___52 ;
  int tmp___53 ;

  {
#line 223
  out_num = 0;
#line 224
  txt_len_place = -1;
#line 226
  chunkcount = 0;
#line 231
  if ((int )stream->tilde_handling == 103) {
    {
#line 232
    csv2_allow_tilde(stream);
    }
  }
  {
#line 235
  tmp = csv2_get_1st(stream, & csv2_is_txtchar, 0);
  }
#line 235
  if (tmp != 1) {
#line 236
    return ((js_string *)0);
  }
  {
#line 239
  look = csv2_justread(stream);
  }
#line 240
  if (look >= 192) {
#line 240
    if (look < 254) {
      {
#line 241
      look = csv2_get_utf8(stream);
      }
    } else {
#line 240
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 243
  if (look >= 128) {
    {
#line 244
    look = csv2_get_unicode(stream);
    }
  }
#line 247
  if (look == -164) {
#line 248
    return ((js_string *)0);
  }
  {
#line 252
  out = js_create(1513U, 1U);
  }
#line 252
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
#line 253
    return ((js_string *)0);
  }
  {
#line 256
  tmp___0 = js_set_encode(out, 2);
  }
#line 256
  if (tmp___0 == -1) {
    {
#line 257
    js_destroy(out);
    }
#line 258
    return ((js_string *)0);
  }
#line 263
  if (numchunks != -1) {
    {
#line 264
    txt_len_place = (int )out->unit_count;
#line 265
    txt_len = 0;
#line 266
    chunkcount = 0;
#line 267
    tmp___1 = csv2_append_utf8(out, 0);
    }
#line 267
    if (tmp___1 == -1) {
      {
#line 268
      js_destroy(out);
      }
#line 269
      return ((js_string *)0);
    }
  }
  {
#line 275
  tmp___8 = csv2_is_txt_bchar(look);
  }
#line 275
  if (tmp___8) {
    {
#line 277
    tmp___2 = csv2_txt_append(out, look, & txt_len);
    }
#line 277
    if (tmp___2 != 1) {
      {
#line 278
      csv2_error(stream, (char *)"Error appending character");
      }
#line 279
      return ((js_string *)0);
    }
#line 281
    state = 1;
  } else {
    {
#line 285
    tmp___7 = csv2_is_bslash(look);
    }
#line 285
    if (tmp___7) {
#line 286
      state = 3;
    } else {
      {
#line 290
      tmp___6 = csv2_is_quote(look);
      }
#line 290
      if (tmp___6) {
#line 291
        state = 2;
      } else {
        {
#line 295
        tmp___5 = csv2_is_semicolon(look);
        }
#line 295
        if (tmp___5) {
#line 295
          if (numchunks != -1) {
#line 296
            if (txt_len_place < 0) {
              {
#line 297
              js_destroy(out);
              }
#line 298
              return ((js_string *)0);
            } else
#line 296
            if ((unsigned int )txt_len_place > out->max_count) {
              {
#line 297
              js_destroy(out);
              }
#line 298
              return ((js_string *)0);
            }
#line 300
            if (txt_len > 255) {
              {
#line 301
              csv2_error(stream, (char *)"Single TXT chunk too long");
#line 302
              js_destroy(out);
              }
#line 303
              return ((js_string *)0);
            }
            {
#line 305
            *(out->string + txt_len_place) = (unsigned char )txt_len;
#line 306
            txt_len_place = (int )out->unit_count;
#line 307
            txt_len = 0;
#line 308
            chunkcount ++;
#line 309
            tmp___3 = csv2_append_utf8(out, 0);
            }
#line 309
            if (tmp___3 == -1) {
              {
#line 310
              js_destroy(out);
              }
#line 311
              return ((js_string *)0);
            }
#line 313
            state = 1;
          } else {
#line 295
            goto _L___0;
          }
        } else {
          _L___0: /* CIL Label */ 
          {
#line 314
          tmp___4 = csv2_is_semicolon(look);
          }
#line 314
          if (tmp___4) {
            {
#line 315
            csv2_error(stream, (char *)"No non-quoted ; in non-TXT records");
#line 316
            js_destroy(out);
            }
#line 317
            return ((js_string *)0);
          } else {
            {
#line 320
            csv2_error(stream, (char *)"Unexpected char at beginning of rdata");
#line 321
            js_destroy(out);
            }
#line 322
            return ((js_string *)0);
          }
        }
      }
    }
  }
#line 325
  x = 0;
  {
#line 325
  while (1) {
    while_continue: /* CIL Label */ ;
#line 325
    if (! (x < 10000)) {
#line 325
      goto while_break;
    }
    {
#line 326
    look = csv2_read_unicode(stream);
    }
#line 329
    if (look == -2) {
#line 329
      if (state != 1) {
#line 329
        if (state != 10) {
          {
#line 331
          csv2_error(stream, (char *)"Unterminated RR");
#line 332
          js_destroy(out);
          }
#line 333
          return ((js_string *)0);
        }
      }
    }
#line 336
    if (state == 1) {
      {
#line 338
      tmp___20 = csv2_is_txt_bchar(look);
      }
#line 338
      if (tmp___20) {
        {
#line 339
        tmp___9 = csv2_txt_append(out, look, & txt_len);
        }
#line 339
        if (tmp___9 != 1) {
#line 340
          return ((js_string *)0);
        }
      } else {
        {
#line 343
        tmp___17 = csv2_is_delimiter(look);
        }
#line 343
        if (tmp___17) {
#line 343
          if ((int )stream->tilde_handling != 103) {
            {
#line 351
            tmp___10 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                         txt_len, out);
            }
#line 351
            return (tmp___10);
          } else {
#line 343
            goto _L___8;
          }
        } else
        _L___8: /* CIL Label */ 
#line 343
        if (look == 126) {
#line 343
          if ((int )stream->tilde_handling == 103) {
#line 343
            if (post_txt == 0) {
              {
#line 351
              tmp___10 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                           txt_len, out);
              }
#line 351
              return (tmp___10);
            } else {
#line 343
              goto _L___7;
            }
          } else {
#line 343
            goto _L___7;
          }
        } else {
          _L___7: /* CIL Label */ 
          {
#line 343
          tmp___18 = csv2_is_delimiter(look);
          }
#line 343
          if (tmp___18) {
#line 343
            if (numchunks == -1) {
              {
#line 351
              tmp___10 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                           txt_len, out);
              }
#line 351
              return (tmp___10);
            } else {
#line 343
              goto _L___5;
            }
          } else {
            _L___5: /* CIL Label */ 
            {
#line 343
            tmp___19 = csv2_is_delimiter(look);
            }
#line 343
            if (tmp___19) {
#line 343
              if (post_txt == 1) {
                {
#line 351
                tmp___10 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                             txt_len, out);
                }
#line 351
                return (tmp___10);
              } else {
#line 343
                goto _L___4;
              }
            } else
            _L___4: /* CIL Label */ 
#line 343
            if (look == -2) {
              {
#line 351
              tmp___10 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                           txt_len, out);
              }
#line 351
              return (tmp___10);
            } else {
              {
#line 355
              tmp___16 = csv2_is_bslash(look);
              }
#line 355
              if (tmp___16) {
#line 356
                state = 3;
              } else {
                {
#line 359
                tmp___15 = csv2_is_quote(look);
                }
#line 359
                if (tmp___15) {
#line 360
                  state = 2;
                } else
#line 363
                if (look == 59) {
#line 363
                  if (numchunks != -1) {
#line 364
                    if (txt_len_place < 0) {
                      {
#line 366
                      js_destroy(out);
                      }
#line 367
                      return ((js_string *)0);
                    } else
#line 364
                    if ((unsigned int )txt_len_place > out->max_count) {
                      {
#line 366
                      js_destroy(out);
                      }
#line 367
                      return ((js_string *)0);
                    }
#line 369
                    if (txt_len > 255) {
                      {
#line 370
                      csv2_error(stream, (char *)"Single TXT chunk too long");
#line 372
                      js_destroy(out);
                      }
#line 373
                      return ((js_string *)0);
                    }
                    {
#line 375
                    *(out->string + txt_len_place) = (unsigned char )txt_len;
#line 376
                    chunkcount ++;
#line 377
                    txt_len_place = (int )out->unit_count;
#line 378
                    txt_len = 0;
#line 379
                    tmp___11 = csv2_append_utf8(out, 0);
                    }
#line 379
                    if (tmp___11 == -1) {
                      {
#line 380
                      js_destroy(out);
                      }
#line 381
                      return ((js_string *)0);
                    }
#line 383
                    state = 1;
                  } else {
#line 363
                    goto _L___3;
                  }
                } else
                _L___3: /* CIL Label */ 
#line 385
                if ((int )stream->tilde_handling == 103) {
                  {
#line 385
                  tmp___14 = csv2_is_delimiter(look);
                  }
#line 385
                  if (tmp___14) {
#line 385
                    if (look != 124) {
#line 387
                      state = 10;
                    } else {
#line 385
                      goto _L___2;
                    }
                  } else {
#line 385
                    goto _L___2;
                  }
                } else {
                  _L___2: /* CIL Label */ 
                  {
#line 390
                  tmp___13 = csv2_is_hash(look);
                  }
#line 390
                  if (tmp___13) {
                    {
#line 391
                    process_comment(stream);
                    }
#line 392
                    if ((int )stream->tilde_handling != 103) {
                      {
#line 393
                      tmp___12 = csv2_finalize_txt(stream, numchunks, chunkcount,
                                                   txt_len_place, txt_len, out);
                      }
#line 393
                      return (tmp___12);
                    }
                  } else
#line 399
                  if (numchunks != -1) {
                    {
#line 400
                    csv2_error(stream, (char *)"Syntax error in TXT/SPF RR");
#line 402
                    js_destroy(out);
                    }
#line 403
                    return ((js_string *)0);
                  } else
#line 405
                  if (numchunks == -1) {
                    {
#line 406
                    csv2_error(stream, (char *)"Syntax error in RAW");
#line 408
                    js_destroy(out);
                    }
#line 409
                    return ((js_string *)0);
                  } else {
                    {
#line 412
                    csv2_error(stream, (char *)"Something weird in csv2_rr_txt");
#line 414
                    js_destroy(out);
                    }
#line 415
                    return ((js_string *)0);
                  }
                }
              }
            }
          }
        }
      }
    } else
#line 419
    if (state == 2) {
      {
#line 422
      tmp___23 = csv2_is_quote(look);
      }
#line 422
      if (tmp___23) {
#line 423
        state = 1;
      } else
#line 424
      if ((int )stream->tilde_handling == 103) {
#line 425
        if (look == 35) {
          {
#line 426
          csv2_error(stream, (char *)"The # character is not allowed in TXT records\nPlease use the \'\\x23\' escape sequence instead.\nman csv2_txt for more information");
          }
#line 430
          return ((js_string *)0);
        } else
#line 431
        if (look == 124) {
          {
#line 432
          csv2_error(stream, (char *)"The | character is not allowed in TXT records\nPlease use the \'\\x7c\' escape sequence instead.\nman csv2_txt for more information");
          }
#line 436
          return ((js_string *)0);
        } else
#line 437
        if (look == 126) {
          {
#line 438
          csv2_error(stream, (char *)"The ~ character is not allowed in TXT records\nPlease use the \'\\x7e\' escape sequence instead.\nman csv2_txt for more information");
          }
#line 442
          return ((js_string *)0);
        } else
#line 443
        if (look == 127) {
          {
#line 444
          csv2_error(stream, (char *)"The DEL character is not allowed in TXT records\nPlease use the \'\\x7f\' escape sequence instead.\nman csv2_txt for more information");
          }
        } else
#line 448
        if (look < 32) {
          {
#line 449
          csv2_error(stream, (char *)"Control characters (including newlines) are not allowed in TXT records\nPlease use the appropriate escape sequence instead.\nman csv2_txt for more information");
          }
#line 453
          return ((js_string *)0);
        } else {
          {
#line 454
          tmp___21 = csv2_txt_append(out, look, & txt_len);
          }
#line 454
          if (tmp___21 != 1) {
#line 456
            return ((js_string *)0);
          }
        }
      } else {
        {
#line 459
        tmp___22 = csv2_txt_append(out, look, & txt_len);
        }
#line 459
        if (tmp___22 != 1) {
#line 460
          return ((js_string *)0);
        }
      }
    } else
#line 464
    if (state == 3) {
      {
#line 466
      tmp___30 = csv2_is_quote(look);
      }
#line 466
      if (tmp___30) {
        {
#line 467
        tmp___24 = csv2_txt_append(out, look, & txt_len);
        }
#line 467
        if (tmp___24 != 1) {
#line 468
          return ((js_string *)0);
        }
#line 470
        state = 1;
      } else {
        {
#line 473
        tmp___29 = csv2_is_pipe(look);
        }
#line 473
        if (tmp___29) {
          {
#line 474
          csv2_error(stream, (char *)"Please don\'t backslash | characters");
#line 476
          js_destroy(out);
          }
#line 477
          return ((js_string *)0);
        } else {
          {
#line 480
          tmp___28 = csv2_is_hash(look);
          }
#line 480
          if (tmp___28) {
            {
#line 484
            process_comment(stream);
#line 485
            state = 4;
            }
          } else {
            {
#line 488
            tmp___27 = csv2_is_delimiter(look);
            }
#line 488
            if (tmp___27) {
#line 489
              state = 4;
            } else {
              {
#line 492
              tmp___26 = csv2_is_0123(look);
              }
#line 492
              if (tmp___26) {
#line 493
                state = 5;
#line 494
                out_num = look - 48;
              } else {
                {
#line 497
                tmp___25 = csv2_is_x(look);
                }
#line 497
                if (tmp___25) {
#line 498
                  state = 7;
#line 499
                  out_num = 0;
                } else {
                  {
#line 502
                  csv2_error(stream, (char *)"Invalid character after backslash");
#line 504
                  js_destroy(out);
                  }
#line 505
                  return ((js_string *)0);
                }
              }
            }
          }
        }
      }
    } else
#line 508
    if (state == 4) {
      {
#line 510
      tmp___37 = csv2_is_txt_bchar(look);
      }
#line 510
      if (tmp___37) {
        {
#line 511
        tmp___31 = csv2_txt_append(out, look, & txt_len);
        }
#line 511
        if (tmp___31 != 1) {
          {
#line 512
          js_destroy(out);
          }
#line 513
          return ((js_string *)0);
        }
#line 515
        state = 1;
      } else {
        {
#line 518
        tmp___36 = csv2_is_quote(look);
        }
#line 518
        if (tmp___36) {
#line 519
          state = 2;
        } else {
          {
#line 522
          tmp___35 = csv2_is_pipe(look);
          }
#line 522
          if (tmp___35) {
            {
#line 523
            csv2_error(stream, (char *)"Please don\'t have a pipe be after a backslash and whitespace");
#line 525
            js_destroy(out);
            }
#line 526
            return ((js_string *)0);
          } else {
            {
#line 529
            tmp___34 = csv2_is_hash(look);
            }
#line 529
            if (tmp___34) {
              {
#line 530
              process_comment(stream);
              }
            } else {
              {
#line 541
              tmp___33 = csv2_is_delimiter(look);
              }
#line 541
              if (tmp___33) {
#line 542
                state = 4;
              } else {
                {
#line 544
                tmp___32 = csv2_is_bslash(look);
                }
#line 544
                if (tmp___32) {
#line 545
                  state = 3;
                } else {
                  {
#line 548
                  csv2_error(stream, (char *)"Invalid character after backslash and white space");
#line 550
                  js_destroy(out);
                  }
#line 551
                  return ((js_string *)0);
                }
              }
            }
          }
        }
      }
    } else
#line 554
    if (state == 5) {
      {
#line 555
      tmp___38 = csv2_is_octal(look);
      }
#line 555
      if (tmp___38) {
#line 556
        out_num *= 8;
#line 557
        out_num += look - 48;
#line 558
        state = 6;
      } else {
        {
#line 561
        csv2_error(stream, (char *)"Invalid octal digit");
#line 562
        js_destroy(out);
        }
#line 563
        return ((js_string *)0);
      }
    } else
#line 566
    if (state == 6) {
      {
#line 567
      tmp___40 = csv2_is_octal(look);
      }
#line 567
      if (tmp___40) {
        {
#line 568
        out_num *= 8;
#line 569
        out_num += look - 48;
#line 570
        tmp___39 = js_addbyte(out, (unsigned char )out_num);
        }
#line 570
        if (tmp___39 == -1) {
          {
#line 571
          js_destroy(out);
          }
#line 572
          return ((js_string *)0);
        }
#line 574
        txt_len ++;
#line 575
        out_num = 0;
#line 576
        state = 1;
      } else {
        {
#line 579
        csv2_error(stream, (char *)"Invalid octal digit");
#line 580
        js_destroy(out);
        }
#line 581
        return ((js_string *)0);
      }
    } else
#line 584
    if (state == 7) {
      {
#line 585
      tmp___44 = csv2_is_hex(look);
      }
#line 585
      if (tmp___44) {
        {
#line 586
        out_num = 0;
#line 587
        tmp___43 = csv2_is_number(look);
        }
#line 587
        if (tmp___43) {
#line 588
          out_num += look - 48;
        } else {
          {
#line 590
          tmp___42 = csv2_is_upper(look);
          }
#line 590
          if (tmp___42) {
#line 591
            out_num += (look + 10) - 65;
          } else {
            {
#line 593
            tmp___41 = csv2_is_lower(look);
            }
#line 593
            if (tmp___41) {
#line 594
              out_num += (look + 10) - 97;
            }
          }
        }
#line 596
        state = 8;
      } else {
        {
#line 599
        csv2_error(stream, (char *)"Invalid hex digit");
#line 600
        js_destroy(out);
        }
#line 601
        return ((js_string *)0);
      }
    } else
#line 604
    if (state == 8) {
      {
#line 605
      tmp___49 = csv2_is_hex(look);
      }
#line 605
      if (tmp___49) {
        {
#line 606
        out_num *= 16;
#line 607
        tmp___47 = csv2_is_number(look);
        }
#line 607
        if (tmp___47) {
#line 608
          out_num += look - 48;
        } else {
          {
#line 610
          tmp___46 = csv2_is_upper(look);
          }
#line 610
          if (tmp___46) {
#line 611
            out_num += (look + 10) - 65;
          } else {
            {
#line 613
            tmp___45 = csv2_is_lower(look);
            }
#line 613
            if (tmp___45) {
#line 614
              out_num += (look + 10) - 97;
            }
          }
        }
        {
#line 616
        tmp___48 = js_addbyte(out, (unsigned char )out_num);
        }
#line 616
        if (tmp___48 == -1) {
          {
#line 617
          js_destroy(out);
          }
#line 618
          return ((js_string *)0);
        }
#line 620
        txt_len ++;
#line 621
        out_num = 0;
#line 622
        state = 1;
      } else {
        {
#line 625
        csv2_error(stream, (char *)"Invalid hex digit");
#line 626
        js_destroy(out);
        }
#line 627
        return ((js_string *)0);
      }
    } else
#line 630
    if (state == 10) {
      {
#line 632
      tmp___53 = csv2_is_hash(look);
      }
#line 632
      if (tmp___53) {
        {
#line 633
        process_comment(stream);
        }
      } else
#line 635
      if (look == 126) {
        {
#line 636
        tmp___50 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                     txt_len, out);
        }
#line 636
        return (tmp___50);
      } else
#line 635
      if (look == -2) {
        {
#line 636
        tmp___50 = csv2_finalize_txt(stream, numchunks, chunkcount, txt_len_place,
                                     txt_len, out);
        }
#line 636
        return (tmp___50);
      } else
#line 639
      if (look == 39) {
#line 639
        goto _L___9;
      } else
#line 639
      if (look == 92) {
        _L___9: /* CIL Label */ 
#line 640
        if (txt_len_place < 0) {
          {
#line 642
          js_destroy(out);
          }
#line 643
          return ((js_string *)0);
        } else
#line 640
        if ((unsigned int )txt_len_place > out->max_count) {
          {
#line 642
          js_destroy(out);
          }
#line 643
          return ((js_string *)0);
        }
#line 645
        if (txt_len > 255) {
          {
#line 646
          csv2_error(stream, (char *)"Single TXT chunk too long");
#line 648
          js_destroy(out);
          }
#line 649
          return ((js_string *)0);
        }
        {
#line 651
        *(out->string + txt_len_place) = (unsigned char )txt_len;
#line 652
        chunkcount ++;
#line 653
        txt_len_place = (int )out->unit_count;
#line 654
        txt_len = 0;
#line 655
        tmp___51 = csv2_append_utf8(out, 0);
        }
#line 655
        if (tmp___51 == -1) {
          {
#line 656
          js_destroy(out);
          }
#line 657
          return ((js_string *)0);
        }
#line 659
        if (look == 39) {
#line 660
          state = 2;
        } else
#line 661
        if (look == 92) {
#line 662
          state = 3;
        } else {
          {
#line 664
          printf((char const   */* __restrict  */)"Fatal error in BETWEEN_CHUNK state!\n");
#line 666
          exit(1);
          }
        }
      } else
#line 669
      if (look == 124) {
        {
#line 670
        csv2_error(stream, (char *)"Pipes are not allowed between TXT chunks");
#line 672
        js_destroy(out);
        }
#line 673
        return ((js_string *)0);
      } else {
        {
#line 674
        tmp___52 = csv2_is_delimiter(look);
        }
#line 674
        if (! tmp___52) {
          {
#line 675
          csv2_error(stream, (char *)"Invalid character between chunks; this might be caused by a TXT RR not\nterminated by a ~ character");
#line 678
          js_destroy(out);
          }
#line 679
          return ((js_string *)0);
        }
      }
    }
#line 325
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 686
  csv2_error(stream, (char *)"RR too long");
#line 687
  js_destroy(out);
  }
#line 688
  return ((js_string *)0);
}
}
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te0___1[256]  = 
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
  {      (u32 const   )3017953435U,      (u32 const   )1672792582U,      (u32 const   )2246353620U,      (u32 const   )560743938U, 
        (u32 const   )980369320U,      (u32 const   )2786508149U,      (u32 const   )323814928U,      (u32 const   )1298184604U, 
        (u32 const   )392868941U,      (u32 const   )2135030158U,      (u32 const   )3799505551U,      (u32 const   )3454798025U, 
        (u32 const   )1510608337U,      (u32 const   )453212586U,      (u32 const   )2070301651U,      (u32 const   )2715875159U, 
        (u32 const   )4205140826U,      (u32 const   )3929646389U,      (u32 const   )3315758963U,      (u32 const   )2977696056U, 
        (u32 const   )539224030U,      (u32 const   )3564185792U,      (u32 const   )2089812465U,      (u32 const   )582860413U, 
        (u32 const   )3967831755U,      (u32 const   )3107092098U,      (u32 const   )3172320479U,      (u32 const   )3385571988U, 
        (u32 const   )2760434902U,      (u32 const   )21995996U,      (u32 const   )1617244793U,      (u32 const   )4269992199U, 
        (u32 const   )1960738379U,      (u32 const   )2833328433U,      (u32 const   )69710429U,      (u32 const   )3864029394U, 
        (u32 const   )2307747635U,      (u32 const   )2458785433U,      (u32 const   )302163916U,      (u32 const   )2049567247U, 
        (u32 const   )522505207U,      (u32 const   )1682079780U,      (u32 const   )3715167910U,      (u32 const   )3200531616U, 
        (u32 const   )755338213U,      (u32 const   )368373230U,      (u32 const   )1462526442U,      (u32 const   )485831560U, 
        (u32 const   )4185170725U,      (u32 const   )1078384039U,      (u32 const   )733765659U,      (u32 const   )3735097049U, 
        (u32 const   )1121487876U,      (u32 const   )2402583757U,      (u32 const   )1600265808U,      (u32 const   )2203928874U, 
        (u32 const   )4112346818U,      (u32 const   )798741062U,      (u32 const   )3213598076U,      (u32 const   )3994949480U, 
        (u32 const   )1812791198U,      (u32 const   )371529105U,      (u32 const   )927552403U,      (u32 const   )1555293743U, 
        (u32 const   )1057434665U,      (u32 const   )1272533602U,      (u32 const   )90706817U,      (u32 const   )2416987962U, 
        (u32 const   )64092287U,      (u32 const   )1380217451U,      (u32 const   )3577645340U,      (u32 const   )2596301091U, 
        (u32 const   )1368754708U,      (u32 const   )2438983398U,      (u32 const   )3756961541U,      (u32 const   )2046300784U, 
        (u32 const   )3536372542U,      (u32 const   )968804311U,      (u32 const   )1983916008U,      (u32 const   )1208527389U, 
        (u32 const   )3480375658U,      (u32 const   )647629856U,      (u32 const   )2872103246U,      (u32 const   )3260300625U, 
        (u32 const   )1997506100U,      (u32 const   )2695845515U,      (u32 const   )668315132U,      (u32 const   )1342103615U, 
        (u32 const   )3021216441U,      (u32 const   )2363849906U,      (u32 const   )720617927U,      (u32 const   )3687390552U, 
        (u32 const   )3606016355U,      (u32 const   )1020712022U,      (u32 const   )1531292685U,      (u32 const   )1044942325U, 
        (u32 const   )841039890U,      (u32 const   )3785761520U,      (u32 const   )2609891583U,      (u32 const   )1133981144U, 
        (u32 const   )3433277717U,      (u32 const   )678271076U,      (u32 const   )837859437U,      (u32 const   )882420716U, 
        (u32 const   )1932014697U,      (u32 const   )1876756449U,      (u32 const   )1747668419U,      (u32 const   )1725749639U, 
        (u32 const   )1449377846U,      (u32 const   )1660644314U,      (u32 const   )2507693243U,      (u32 const   )3877619982U, 
        (u32 const   )1919391157U,      (u32 const   )3411403575U,      (u32 const   )1576814579U,      (u32 const   )1895418902U, 
        (u32 const   )3062514458U,      (u32 const   )2177044617U,      (u32 const   )3838718321U,      (u32 const   )220621883U, 
        (u32 const   )2898697068U,      (u32 const   )2556309632U,      (u32 const   )3666263172U,      (u32 const   )1833131586U, 
        (u32 const   )1768221727U,      (u32 const   )112847870U,      (u32 const   )2225799944U,      (u32 const   )3135475453U, 
        (u32 const   )299065267U,      (u32 const   )0U,      (u32 const   )251106372U,      (u32 const   )4226480774U, 
        (u32 const   )3148623649U,      (u32 const   )1695359480U,      (u32 const   )2925052623U,      (u32 const   )2251643563U, 
        (u32 const   )1630180261U,      (u32 const   )4099067678U,      (u32 const   )1147234298U,      (u32 const   )2272983927U, 
        (u32 const   )4087645500U,      (u32 const   )2807635113U,      (u32 const   )2111807533U,      (u32 const   )1486115954U, 
        (u32 const   )2625209053U,      (u32 const   )3625510183U,      (u32 const   )862904782U,      (u32 const   )133581346U, 
        (u32 const   )2781299978U,      (u32 const   )2156704085U,      (u32 const   )3083199174U,      (u32 const   )4015109812U, 
        (u32 const   )906424911U,      (u32 const   )4291643611U,      (u32 const   )1437743177U,      (u32 const   )1811592636U, 
        (u32 const   )1320239587U,      (u32 const   )2390435089U,      (u32 const   )1790252128U,      (u32 const   )4250079608U, 
        (u32 const   )416448981U,      (u32 const   )3548865250U,      (u32 const   )4075496672U,      (u32 const   )3390718699U, 
        (u32 const   )3695138682U,      (u32 const   )2294468335U,      (u32 const   )2376785262U,      (u32 const   )43932067U, 
        (u32 const   )429727753U,      (u32 const   )2956175588U,      (u32 const   )151117414U,      (u32 const   )208260583U, 
        (u32 const   )263730584U,      (u32 const   )4152571745U,      (u32 const   )4140603069U,      (u32 const   )2025305004U, 
        (u32 const   )1972494231U,      (u32 const   )1229392833U,      (u32 const   )3850473645U,      (u32 const   )2548434200U, 
        (u32 const   )3617640639U,      (u32 const   )1251406782U,      (u32 const   )2678618786U,      (u32 const   )3924319562U, 
        (u32 const   )195004357U,      (u32 const   )1160693286U,      (u32 const   )3160040707U,      (u32 const   )3646375163U, 
        (u32 const   )2568065372U,      (u32 const   )2527700164U,      (u32 const   )1191132761U,      (u32 const   )1278154816U, 
        (u32 const   )2486697319U,      (u32 const   )3812129619U,      (u32 const   )1033467274U,      (u32 const   )3342610128U, 
        (u32 const   )743057977U,      (u32 const   )625734751U,      (u32 const   )603070369U,      (u32 const   )441243766U, 
        (u32 const   )3495336605U,      (u32 const   )3095254878U,      (u32 const   )498766420U,      (u32 const   )955344395U, 
        (u32 const   )2721124136U,      (u32 const   )1580056460U,      (u32 const   )1202757509U,      (u32 const   )347819058U, 
        (u32 const   )2846787821U,      (u32 const   )1356475336U,      (u32 const   )604263811U,      (u32 const   )3950380265U, 
        (u32 const   )3042687845U,      (u32 const   )510356011U,      (u32 const   )2182277366U,      (u32 const   )4047166623U, 
        (u32 const   )3234489586U,      (u32 const   )139362234U,      (u32 const   )2742988532U,      (u32 const   )903285296U, 
        (u32 const   )3989827351U,      (u32 const   )3773399852U,      (u32 const   )817830321U,      (u32 const   )2665995134U, 
        (u32 const   )3903323286U,      (u32 const   )2478946117U,      (u32 const   )4229738660U,      (u32 const   )2997743943U, 
        (u32 const   )278724207U,      (u32 const   )2911451824U,      (u32 const   )2937545491U,      (u32 const   )785675162U, 
        (u32 const   )1855104573U,      (u32 const   )2637570817U,      (u32 const   )4164616953U,      (u32 const   )3329462028U, 
        (u32 const   )3246769454U,      (u32 const   )3364100936U,      (u32 const   )1737717851U,      (u32 const   )2860478610U, 
        (u32 const   )1091138683U,      (u32 const   )3273366669U,      (u32 const   )1907781066U,      (u32 const   )2333292176U, 
        (u32 const   )3508091713U,      (u32 const   )1425906069U,      (u32 const   )3303921327U,      (u32 const   )2114869330U, 
        (u32 const   )991993460U,      (u32 const   )2321323852U,      (u32 const   )4034231619U,      (u32 const   )1507587502U, 
        (u32 const   )3460165814U,      (u32 const   )1393284023U,      (u32 const   )181413401U,      (u32 const   )690108856U};
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te1___1[256]  = 
#line 69
  {      (u32 const   )2612257360U,      (u32 const   )107197642U,      (u32 const   )3565544610U,      (u32 const   )35744838U, 
        (u32 const   )2822401855U,      (u32 const   )1973819069U,      (u32 const   )269700358U,      (u32 const   )2622316729U, 
        (u32 const   )1293380276U,      (u32 const   )2390704633U,      (u32 const   )2413983706U,      (u32 const   )3385715720U, 
        (u32 const   )3512338957U,      (u32 const   )2853897081U,      (u32 const   )3548079691U,      (u32 const   )1470226679U, 
        (u32 const   )1526375771U,      (u32 const   )904542629U,      (u32 const   )1942332023U,      (u32 const   )951155721U, 
        (u32 const   )3726648295U,      (u32 const   )3235148072U,      (u32 const   )4051472385U,      (u32 const   )2099428798U, 
        (u32 const   )3421274190U,      (u32 const   )2193175158U,      (u32 const   )3753711044U,      (u32 const   )2496252858U, 
        (u32 const   )3601107172U,      (u32 const   )3691073441U,      (u32 const   )2036360498U,      (u32 const   )134120169U, 
        (u32 const   )1265950334U,      (u32 const   )833151273U,      (u32 const   )1560553394U,      (u32 const   )3538309224U, 
        (u32 const   )864652655U,      (u32 const   )2576518678U,      (u32 const   )3423732391U,      (u32 const   )259664362U, 
        (u32 const   )4146013387U,      (u32 const   )610550400U,      (u32 const   )2799530230U,      (u32 const   )2696856636U, 
        (u32 const   )3844933003U,      (u32 const   )3994416365U,      (u32 const   )3931581537U,      (u32 const   )2283599155U, 
        (u32 const   )637105315U,      (u32 const   )2806007509U,      (u32 const   )455851104U,      (u32 const   )3655246094U, 
        (u32 const   )71489676U,      (u32 const   )3448714372U,      (u32 const   )1348428318U,      (u32 const   )713252169U, 
        (u32 const   )3270843758U,      (u32 const   )1177525202U,      (u32 const   )2092927901U,      (u32 const   )1760435735U, 
        (u32 const   )2657881343U,      (u32 const   )2434147605U,      (u32 const   )2469874003U,      (u32 const   )794604518U, 
        (u32 const   )691996460U,      (u32 const   )1649138002U,      (u32 const   )2164615187U,      (u32 const   )982519887U, 
        (u32 const   )2130956792U,      (u32 const   )1800553586U,      (u32 const   )483737225U,      (u32 const   )597344361U, 
        (u32 const   )340891018U,      (u32 const   )3868286958U,      (u32 const   )98561711U,      (u32 const   )1887041554U, 
        (u32 const   )1054001347U,      (u32 const   )3610885831U,      (u32 const   )3900063783U,      (u32 const   )491260074U, 
        (u32 const   )1791980113U,      (u32 const   )539400716U,      (u32 const   )1319842001U,      (u32 const   )1371690045U, 
        (u32 const   )880217990U,      (u32 const   )2342563670U,      (u32 const   )4230469037U,      (u32 const   )1062207200U, 
        (u32 const   )3115586586U,      (u32 const   )2995578236U,      (u32 const   )3341480897U,      (u32 const   )1490798877U, 
        (u32 const   )1675030385U,      (u32 const   )1446827732U,      (u32 const   )224085420U,      (u32 const   )4114499725U, 
        (u32 const   )305275200U,      (u32 const   )4041319970U,      (u32 const   )4288384968U,      (u32 const   )3628308269U, 
        (u32 const   )365732777U,      (u32 const   )1680371096U,      (u32 const   )1831989432U,      (u32 const   )3962869931U, 
        (u32 const   )1769154612U,      (u32 const   )3782204679U,      (u32 const   )3278383949U,      (u32 const   )2271665369U, 
        (u32 const   )911631296U,      (u32 const   )3663919979U,      (u32 const   )3147135068U,      (u32 const   )250027977U, 
        (u32 const   )3044173717U,      (u32 const   )936072675U,      (u32 const   )4083022919U,      (u32 const   )376502732U, 
        (u32 const   )448170563U,      (u32 const   )2306982672U,      (u32 const   )1910820401U,      (u32 const   )990717548U, 
        (u32 const   )1823262363U,      (u32 const   )2157469232U,      (u32 const   )2228913852U,      (u32 const   )1114456926U, 
        (u32 const   )527000812U,      (u32 const   )4261853675U,      (u32 const   )142912259U,      (u32 const   )4256883598U, 
        (u32 const   )3004289887U,      (u32 const   )0U,      (u32 const   )1141831572U,      (u32 const   )2264656634U, 
        (u32 const   )565947439U,      (u32 const   )4167372065U,      (u32 const   )3484309698U,      (u32 const   )2877699418U, 
        (u32 const   )2774608531U,      (u32 const   )519328463U,      (u32 const   )4198785383U,      (u32 const   )2005367547U, 
        (u32 const   )1022600325U,      (u32 const   )2846316828U,      (u32 const   )763223968U,      (u32 const   )1918407764U, 
        (u32 const   )3718019458U,      (u32 const   )668473573U,      (u32 const   )3459477217U,      (u32 const   )570947146U, 
        (u32 const   )178636613U,      (u32 const   )1434487985U,      (u32 const   )3333932514U,      (u32 const   )3035582902U, 
        (u32 const   )1328940786U,      (u32 const   )3690974536U,      (u32 const   )1230352952U,      (u32 const   )3161193141U, 
        (u32 const   )3813585217U,      (u32 const   )294550309U,      (u32 const   )1617605908U,      (u32 const   )2029867793U, 
        (u32 const   )3575173761U,      (u32 const   )3805513570U,      (u32 const   )3774016292U,      (u32 const   )3955890754U, 
        (u32 const   )2061254487U,      (u32 const   )4018717390U,      (u32 const   )1854778077U,      (u32 const   )2734857817U, 
        (u32 const   )152673568U,      (u32 const   )3836752808U,      (u32 const   )1711866334U,      (u32 const   )3876350413U, 
        (u32 const   )2551167029U,      (u32 const   )1643610935U,      (u32 const   )3187068054U,      (u32 const   )2893592499U, 
        (u32 const   )2541064671U,      (u32 const   )3242805003U,      (u32 const   )2917499280U,      (u32 const   )412608005U, 
        (u32 const   )3218579664U,      (u32 const   )3192559347U,      (u32 const   )2728372346U,      (u32 const   )1256843357U, 
        (u32 const   )3305873287U,      (u32 const   )642068166U,      (u32 const   )62675557U,      (u32 const   )4225324868U, 
        (u32 const   )1553535377U,      (u32 const   )3298208164U,      (u32 const   )1497825086U,      (u32 const   )1078734616U, 
        (u32 const   )1737766909U,      (u32 const   )1407400059U,      (u32 const   )2319292789U,      (u32 const   )3502717998U, 
        (u32 const   )959203882U,      (u32 const   )1596279796U,      (u32 const   )2703487519U,      (u32 const   )1981435096U, 
        (u32 const   )2647676570U,      (u32 const   )1589149143U,      (u32 const   )1411234450U,      (u32 const   )188281190U, 
        (u32 const   )681718031U,      (u32 const   )2354982335U,      (u32 const   )2236067999U,      (u32 const   )840219468U, 
        (u32 const   )3987320456U,      (u32 const   )3360741931U,      (u32 const   )2200175701U,      (u32 const   )3924522500U, 
        (u32 const   )1706384315U,      (u32 const   )723413866U,      (u32 const   )4135719656U,      (u32 const   )2683386588U, 
        (u32 const   )4072720996U,      (u32 const   )3121106559U,      (u32 const   )4104355502U,      (u32 const   )808834826U, 
        (u32 const   )401461231U,      (u32 const   )752937347U,      (u32 const   )2972761881U,      (u32 const   )2124343259U, 
        (u32 const   )2531829756U,      (u32 const   )1167311287U,      (u32 const   )2767985840U,      (u32 const   )1202892273U, 
        (u32 const   )1863359742U,      (u32 const   )2964162874U,      (u32 const   )330241891U,      (u32 const   )2586760307U, 
        (u32 const   )1030656678U,      (u32 const   )27080227U,      (u32 const   )4193794818U,      (u32 const   )214332303U, 
        (u32 const   )784434629U,      (u32 const   )1221100571U,      (u32 const   )1533514616U,      (u32 const   )2460647280U, 
        (u32 const   )2067859828U,      (u32 const   )2378374044U,      (u32 const   )3396449901U,      (u32 const   )2425033526U, 
        (u32 const   )1104222523U,      (u32 const   )2505375129U,      (u32 const   )2948918742U,      (u32 const   )1383992920U, 
        (u32 const   )1950032030U,      (u32 const   )1284136087U,      (u32 const   )1139832189U,      (u32 const   )2925124597U, 
        (u32 const   )3066969584U,      (u32 const   )3075673043U,      (u32 const   )420139046U,      (u32 const   )3089703481U};
#line 135 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te2___1[256]  = 
#line 135
  {      (u32 const   )1352381410U,      (u32 const   )3389416372U,      (u32 const   )2731836900U,      (u32 const   )1174544748U, 
        (u32 const   )1067989615U,      (u32 const   )3178604054U,      (u32 const   )101716813U,      (u32 const   )3114028384U, 
        (u32 const   )3024951146U,      (u32 const   )4186865473U,      (u32 const   )3666862711U,      (u32 const   )147443180U, 
        (u32 const   )231823882U,      (u32 const   )2041191171U,      (u32 const   )1272150886U,      (u32 const   )4149715424U, 
        (u32 const   )1532689061U,      (u32 const   )2771774009U,      (u32 const   )2004075938U,      (u32 const   )154710396U, 
        (u32 const   )3890094115U,      (u32 const   )683725937U,      (u32 const   )32603280U,      (u32 const   )3195871933U, 
        (u32 const   )1321987200U,      (u32 const   )1988278578U,      (u32 const   )3302997269U,      (u32 const   )3130313163U, 
        (u32 const   )3839272072U,      (u32 const   )2715550031U,      (u32 const   )846815333U,      (u32 const   )3909615234U, 
        (u32 const   )2118874334U,      (u32 const   )691120353U,      (u32 const   )2992440359U,      (u32 const   )1758651984U, 
        (u32 const   )1865648525U,      (u32 const   )379163278U,      (u32 const   )2815169026U,      (u32 const   )3926882857U, 
        (u32 const   )3421970212U,      (u32 const   )2149868610U,      (u32 const   )4138130800U,      (u32 const   )1017167556U, 
        (u32 const   )2347052293U,      (u32 const   )3991803380U,      (u32 const   )1642747692U,      (u32 const   )864558325U, 
        (u32 const   )2737174900U,      (u32 const   )3584507974U,      (u32 const   )1612393404U,      (u32 const   )249159329U, 
        (u32 const   )2349089496U,      (u32 const   )2228064052U,      (u32 const   )508583778U,      (u32 const   )1227522909U, 
        (u32 const   )1858270493U,      (u32 const   )3527815067U,      (u32 const   )2642198411U,      (u32 const   )392752670U, 
        (u32 const   )4288572428U,      (u32 const   )361829925U,      (u32 const   )1402156873U,      (u32 const   )3861863603U, 
        (u32 const   )740900615U,      (u32 const   )1382173657U,      (u32 const   )327222632U,      (u32 const   )1329238032U, 
        (u32 const   )4169073617U,      (u32 const   )1919636036U,      (u32 const   )2300368190U,      (u32 const   )1763941056U, 
        (u32 const   )2316587413U,      (u32 const   )4008087903U,      (u32 const   )2936397806U,      (u32 const   )309361144U, 
        (u32 const   )3275674312U,      (u32 const   )3352771006U,      (u32 const   )669546048U,      (u32 const   )2854045704U, 
        (u32 const   )1365954418U,      (u32 const   )203433626U,      (u32 const   )3511593776U,      (u32 const   )1028768340U, 
        (u32 const   )2251585295U,      (u32 const   )1451991215U,      (u32 const   )2918983637U,      (u32 const   )3762245630U, 
        (u32 const   )448377876U,      (u32 const   )2092076261U,      (u32 const   )3251055347U,      (u32 const   )492362697U, 
        (u32 const   )1902368495U,      (u32 const   )3562421462U,      (u32 const   )2886556485U,      (u32 const   )2381659720U, 
        (u32 const   )1074934305U,      (u32 const   )586211750U,      (u32 const   )3372194703U,      (u32 const   )769147799U, 
        (u32 const   )2836778147U,      (u32 const   )2556700781U,      (u32 const   )3094163952U,      (u32 const   )2884383896U, 
        (u32 const   )879325992U,      (u32 const   )132214749U,      (u32 const   )1304651819U,      (u32 const   )3649529564U, 
        (u32 const   )3224786531U,      (u32 const   )1809474299U,      (u32 const   )1555797368U,      (u32 const   )3373197087U, 
        (u32 const   )2511696487U,      (u32 const   )3812084565U,      (u32 const   )1207131644U,      (u32 const   )3424022777U, 
        (u32 const   )1125824138U,      (u32 const   )277447107U,      (u32 const   )829547726U,      (u32 const   )1815809318U, 
        (u32 const   )2607590598U,      (u32 const   )813733982U,      (u32 const   )3162823302U,      (u32 const   )1581411651U, 
        (u32 const   )3961481572U,      (u32 const   )3959293625U,      (u32 const   )50889899U,      (u32 const   )2398993123U, 
        (u32 const   )1605571027U,      (u32 const   )0U,      (u32 const   )2487488247U,      (u32 const   )4203150314U, 
        (u32 const   )790739884U,      (u32 const   )569926925U,      (u32 const   )3268390488U,      (u32 const   )1521190453U, 
        (u32 const   )2477089066U,      (u32 const   )3474912338U,      (u32 const   )1744454753U,      (u32 const   )4218914682U, 
        (u32 const   )2235364260U,      (u32 const   )480880473U,      (u32 const   )2687335903U,      (u32 const   )1416779924U, 
        (u32 const   )2195561593U,      (u32 const   )3844593688U,      (u32 const   )3788387182U,      (u32 const   )1243744246U, 
        (u32 const   )1158325703U,      (u32 const   )2975170700U,      (u32 const   )3804673989U,      (u32 const   )3065311057U, 
        (u32 const   )4065277446U,      (u32 const   )1222377421U,      (u32 const   )944330162U,      (u32 const   )3049024506U, 
        (u32 const   )1105415857U,      (u32 const   )621907579U,      (u32 const   )341863093U,      (u32 const   )293141843U, 
        (u32 const   )2178226386U,      (u32 const   )1659032455U,      (u32 const   )618722027U,      (u32 const   )1122748954U, 
        (u32 const   )1467669567U,      (u32 const   )3471804610U,      (u32 const   )3715009962U,      (u32 const   )1503855262U, 
        (u32 const   )537467293U,      (u32 const   )2833559603U,      (u32 const   )3731228929U,      (u32 const   )3454471273U, 
        (u32 const   )899157944U,      (u32 const   )929167235U,      (u32 const   )2529031884U,      (u32 const   )3014424759U, 
        (u32 const   )3751245201U,      (u32 const   )197216583U,      (u32 const   )2427315585U,      (u32 const   )85497830U, 
        (u32 const   )3502233504U,      (u32 const   )4089334422U,      (u32 const   )2057478056U,      (u32 const   )1565190632U, 
        (u32 const   )2277837727U,      (u32 const   )3324396846U,      (u32 const   )1694743642U,      (u32 const   )1157355863U, 
        (u32 const   )2438764817U,      (u32 const   )2764347049U,      (u32 const   )1046038271U,      (u32 const   )406866991U, 
        (u32 const   )4251423799U,      (u32 const   )2069095224U,      (u32 const   )1971994009U,      (u32 const   )785434428U, 
        (u32 const   )708389962U,      (u32 const   )4099876171U,      (u32 const   )530654194U,      (u32 const   )3631618636U, 
        (u32 const   )2594033750U,      (u32 const   )3613309053U,      (u32 const   )2454986170U,      (u32 const   )1712011505U, 
        (u32 const   )254321201U,      (u32 const   )3213647405U,      (u32 const   )2676311984U,      (u32 const   )1278350523U, 
        (u32 const   )2297276846U,      (u32 const   )734548186U,      (u32 const   )1434657796U,      (u32 const   )82439030U, 
        (u32 const   )3144004955U,      (u32 const   )1781210731U,      (u32 const   )3908469266U,      (u32 const   )3701469498U, 
        (u32 const   )1693630666U,      (u32 const   )2142898254U,      (u32 const   )2935268222U,      (u32 const   )170931671U, 
        (u32 const   )4011322831U,      (u32 const   )2200756457U,      (u32 const   )431042751U,      (u32 const   )3682508519U, 
        (u32 const   )4237748391U,      (u32 const   )3074790337U,      (u32 const   )2963602460U,      (u32 const   )4048007853U, 
        (u32 const   )4268691612U,      (u32 const   )984657289U,      (u32 const   )1662234391U,      (u32 const   )1939484372U, 
        (u32 const   )2789043858U,      (u32 const   )587308342U,      (u32 const   )49936443U,      (u32 const   )2399979123U, 
        (u32 const   )3308175749U,      (u32 const   )457754756U,      (u32 const   )2019256211U,      (u32 const   )1888660095U, 
        (u32 const   )1954234633U,      (u32 const   )2626536219U,      (u32 const   )1841983926U,      (u32 const   )915442451U, 
        (u32 const   )994169113U,      (u32 const   )2576700669U,      (u32 const   )3601843437U,      (u32 const   )1481801230U, 
        (u32 const   )2658417440U,      (u32 const   )2538375772U,      (u32 const   )2101604469U,      (u32 const   )4121844187U, 
        (u32 const   )4038512189U,      (u32 const   )3552006923U,      (u32 const   )639175376U,      (u32 const   )968370466U};
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te3___1[256]  = 
#line 201
  {      (u32 const   )3796933555U,      (u32 const   )3033138787U,      (u32 const   )3835876485U,      (u32 const   )1816527393U, 
        (u32 const   )1866442810U,      (u32 const   )381515174U,      (u32 const   )1292242963U,      (u32 const   )1622776909U, 
        (u32 const   )1790201111U,      (u32 const   )1106873983U,      (u32 const   )2010812386U,      (u32 const   )3959998925U, 
        (u32 const   )168677722U,      (u32 const   )58305051U,      (u32 const   )1716245371U,      (u32 const   )3774306209U, 
        (u32 const   )2774227706U,      (u32 const   )967128554U,      (u32 const   )2725737413U,      (u32 const   )2080979121U, 
        (u32 const   )602398240U,      (u32 const   )1898496212U,      (u32 const   )2416046460U,      (u32 const   )3183377698U, 
        (u32 const   )2152647660U,      (u32 const   )846627513U,      (u32 const   )365223869U,      (u32 const   )3418002633U, 
        (u32 const   )2296698532U,      (u32 const   )1336007681U,      (u32 const   )1697806688U,      (u32 const   )2196310014U, 
        (u32 const   )3732818804U,      (u32 const   )3777573288U,      (u32 const   )666000644U,      (u32 const   )1349047014U, 
        (u32 const   )2372875145U,      (u32 const   )2383845778U,      (u32 const   )44551186U,      (u32 const   )703205242U, 
        (u32 const   )617346847U,      (u32 const   )1115694180U,      (u32 const   )1895212765U,      (u32 const   )3292307646U, 
        (u32 const   )93054253U,      (u32 const   )4109233685U,      (u32 const   )744614487U,      (u32 const   )4113795100U, 
        (u32 const   )1956849145U,      (u32 const   )1188407104U,      (u32 const   )3160415019U,      (u32 const   )2702105054U, 
        (u32 const   )3633054786U,      (u32 const   )881118607U,      (u32 const   )1646153823U,      (u32 const   )1565076099U, 
        (u32 const   )493798133U,      (u32 const   )2614249007U,      (u32 const   )2342354111U,      (u32 const   )504850670U, 
        (u32 const   )218078828U,      (u32 const   )622170390U,      (u32 const   )1230213943U,      (u32 const   )3018207068U, 
        (u32 const   )120334655U,      (u32 const   )3646054987U,      (u32 const   )1746108677U,      (u32 const   )273627792U, 
        (u32 const   )3522723587U,      (u32 const   )1148349266U,      (u32 const   )1049173205U,      (u32 const   )3228115866U, 
        (u32 const   )2508854353U,      (u32 const   )1609492113U,      (u32 const   )4004447711U,      (u32 const   )4161958009U, 
        (u32 const   )3368238802U,      (u32 const   )3200767801U,      (u32 const   )1076357238U,      (u32 const   )145366344U, 
        (u32 const   )1917938383U,      (u32 const   )2584485926U,      (u32 const   )819023531U,      (u32 const   )1413304770U, 
        (u32 const   )260453495U,      (u32 const   )2941684640U,      (u32 const   )3584949287U,      (u32 const   )4276109135U, 
        (u32 const   )337295796U,      (u32 const   )3850154636U,      (u32 const   )4089562922U,      (u32 const   )3374143707U, 
        (u32 const   )4017185750U,      (u32 const   )3604239932U,      (u32 const   )1168903515U,      (u32 const   )1217262910U, 
        (u32 const   )557847090U,      (u32 const   )2787307745U,      (u32 const   )2412314523U,      (u32 const   )2536364099U, 
        (u32 const   )2745767372U,      (u32 const   )1838703656U,      (u32 const   )4038618417U,      (u32 const   )2561403956U, 
        (u32 const   )674523507U,      (u32 const   )3708281199U,      (u32 const   )726516584U,      (u32 const   )3705243494U, 
        (u32 const   )1673541206U,      (u32 const   )4218149474U,      (u32 const   )2019343253U,      (u32 const   )533270247U, 
        (u32 const   )1737864562U,      (u32 const   )1440954315U,      (u32 const   )4232573789U,      (u32 const   )4190901872U, 
        (u32 const   )2319653558U,      (u32 const   )3272640897U,      (u32 const   )3459346916U,      (u32 const   )644627213U, 
        (u32 const   )3332074668U,      (u32 const   )1580236952U,      (u32 const   )2260501722U,      (u32 const   )1130250861U, 
        (u32 const   )1693196137U,      (u32 const   )3119250950U,      (u32 const   )2869102724U,      (u32 const   )3817799098U, 
        (u32 const   )3546264337U,      (u32 const   )0U,      (u32 const   )4153689102U,      (u32 const   )3942287099U, 
        (u32 const   )2888769979U,      (u32 const   )220330085U,      (u32 const   )1489162158U,      (u32 const   )895134598U, 
        (u32 const   )714319201U,      (u32 const   )1389305588U,      (u32 const   )1634204228U,      (u32 const   )2063300487U, 
        (u32 const   )2760195315U,      (u32 const   )1495050663U,      (u32 const   )3751816573U,      (u32 const   )2488562264U, 
        (u32 const   )2038619548U,      (u32 const   )417671128U,      (u32 const   )1860292147U,      (u32 const   )4132053511U, 
        (u32 const   )3343190693U,      (u32 const   )2360432000U,      (u32 const   )3319973559U,      (u32 const   )1370928367U, 
        (u32 const   )116543286U,      (u32 const   )3444104191U,      (u32 const   )2990033237U,      (u32 const   )4206214251U, 
        (u32 const   )2973885262U,      (u32 const   )2066026894U,      (u32 const   )3038011498U,      (u32 const   )1393654013U, 
        (u32 const   )3531724056U,      (u32 const   )2271404755U,      (u32 const   )3945062642U,      (u32 const   )440593354U, 
        (u32 const   )1062697692U,      (u32 const   )3268341640U,      (u32 const   )2866638477U,      (u32 const   )2656674562U, 
        (u32 const   )2636122393U,      (u32 const   )866706608U,      (u32 const   )31352329U,      (u32 const   )1775101708U, 
        (u32 const   )3090520079U,      (u32 const   )2201444855U,      (u32 const   )3432431094U,      (u32 const   )3082005624U, 
        (u32 const   )2447349621U,      (u32 const   )1191952713U,      (u32 const   )2173742565U,      (u32 const   )3859093655U, 
        (u32 const   )2698035159U,      (u32 const   )2532556362U,      (u32 const   )2826609311U,      (u32 const   )3898428137U, 
        (u32 const   )2676475147U,      (u32 const   )784737861U,      (u32 const   )1516569532U,      (u32 const   )1464138713U, 
        (u32 const   )294739097U,      (u32 const   )2846147734U,      (u32 const   )4282276166U,      (u32 const   )790118476U, 
        (u32 const   )939354004U,      (u32 const   )947606499U,      (u32 const   )2574617149U,      (u32 const   )1009701063U, 
        (u32 const   )1244281132U,      (u32 const   )1274306341U,      (u32 const   )4062159139U,      (u32 const   )1289254426U, 
        (u32 const   )1452973520U,      (u32 const   )2111266488U,      (u32 const   )3130151965U,      (u32 const   )4049996600U, 
        (u32 const   )823077026U,      (u32 const   )767528030U,      (u32 const   )2963244359U,      (u32 const   )3142332948U, 
        (u32 const   )2928209321U,      (u32 const   )3660302416U,      (u32 const   )72712996U,      (u32 const   )1980033515U, 
        (u32 const   )1539007925U,      (u32 const   )1802119966U,      (u32 const   )317257346U,      (u32 const   )987537393U, 
        (u32 const   )3395613376U,      (u32 const   )1316993544U,      (u32 const   )2125395107U,      (u32 const   )3607769141U, 
        (u32 const   )3488552941U,      (u32 const   )3917688032U,      (u32 const   )3206132016U,      (u32 const   )3889921694U, 
        (u32 const   )2818348776U,      (u32 const   )3250013587U,      (u32 const   )481338620U,      (u32 const   )2918270898U, 
        (u32 const   )2633920272U,      (u32 const   )2302324909U,      (u32 const   )392369071U,      (u32 const   )3564345902U, 
        (u32 const   )2460368238U,      (u32 const   )908263837U,      (u32 const   )990050808U,      (u32 const   )1938754758U, 
        (u32 const   )2244292289U,      (u32 const   )2216380616U,      (u32 const   )2474138471U,      (u32 const   )2138084010U, 
        (u32 const   )158628673U,      (u32 const   )463244739U,      (u32 const   )3060648561U,      (u32 const   )322343051U, 
        (u32 const   )423313873U,      (u32 const   )4254700884U,      (u32 const   )3990269892U,      (u32 const   )240669310U, 
        (u32 const   )547255355U,      (u32 const   )1553419402U,      (u32 const   )1971143664U,      (u32 const   )3690311257U, 
        (u32 const   )1039185614U,      (u32 const   )198424403U,      (u32 const   )3492157706U,      (u32 const   )574208041U};
#line 267 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te4___1[256]  = 
#line 267
  {      (u32 const   )404232216U,      (u32 const   )589505315U,      (u32 const   )3334915782U,      (u32 const   )3907578088U, 
        (u32 const   )2273806215U,      (u32 const   )3099113656U,      (u32 const   )16843009U,      (u32 const   )1330597711U, 
        (u32 const   )909522486U,      (u32 const   )2795939494U,      (u32 const   )3537031890U,      (u32 const   )4126537205U, 
        (u32 const   )2038004089U,      (u32 const   )1869573999U,      (u32 const   )2442236305U,      (u32 const   )1381126738U, 
        (u32 const   )1616928864U,      (u32 const   )3166485692U,      (u32 const   )2610666395U,      (u32 const   )2391707278U, 
        (u32 const   )2745410467U,      (u32 const   )202116108U,      (u32 const   )2071690107U,      (u32 const   )892679477U, 
        (u32 const   )488447261U,      (u32 const   )3772834016U,      (u32 const   )3621246935U,      (u32 const   )3267543746U, 
        (u32 const   )774778414U,      (u32 const   )1263225675U,      (u32 const   )4278124286U,      (u32 const   )1465341783U, 
        (u32 const   )353703189U,      (u32 const   )2004318071U,      (u32 const   )926365495U,      (u32 const   )3857049061U, 
        (u32 const   )2678038431U,      (u32 const   )4042322160U,      (u32 const   )1246382666U,      (u32 const   )3671775962U, 
        (u32 const   )1482184792U,      (u32 const   )3385444809U,      (u32 const   )690563369U,      (u32 const   )168430090U, 
        (u32 const   )2981212593U,      (u32 const   )2694881440U,      (u32 const   )1802201963U,      (u32 const   )2240120197U, 
        (u32 const   )3183328701U,      (u32 const   )1566399837U,      (u32 const   )269488144U,      (u32 const   )4109694196U, 
        (u32 const   )3419130827U,      (u32 const   )1044266558U,      (u32 const   )84215045U,      (u32 const   )1734829927U, 
        (u32 const   )3840206052U,      (u32 const   )656877351U,      (u32 const   )1094795585U,      (u32 const   )2341178251U, 
        (u32 const   )2812782503U,      (u32 const   )2105376125U,      (u32 const   )2509608341U,      (u32 const   )3638089944U, 
        (u32 const   )4227595259U,      (u32 const   )4008636142U,      (u32 const   )2088533116U,      (u32 const   )1717986918U, 
        (u32 const   )3722304989U,      (u32 const   )387389207U,      (u32 const   )1195853639U,      (u32 const   )2661195422U, 
        (u32 const   )3402287818U,      (u32 const   )757935405U,      (u32 const   )3217014719U,      (u32 const   )117901063U, 
        (u32 const   )2913840557U,      (u32 const   )1515870810U,      (u32 const   )2206434179U,      (u32 const   )858993459U, 
        (u32 const   )1667457891U,      (u32 const   )33686018U,      (u32 const   )2863311530U,      (u32 const   )1903260017U, 
        (u32 const   )3368601800U,      (u32 const   )421075225U,      (u32 const   )1229539657U,      (u32 const   )3654932953U, 
        (u32 const   )4076008178U,      (u32 const   )3823363043U,      (u32 const   )1532713819U,      (u32 const   )2290649224U, 
        (u32 const   )2593823386U,      (u32 const   )640034342U,      (u32 const   )842150450U,      (u32 const   )2964369584U, 
        (u32 const   )3924421097U,      (u32 const   )252645135U,      (u32 const   )3587560917U,      (u32 const   )2155905152U, 
        (u32 const   )3200171710U,      (u32 const   )3452816845U,      (u32 const   )875836468U,      (u32 const   )1212696648U, 
        (u32 const   )4294967295U,      (u32 const   )2054847098U,      (u32 const   )2425393296U,      (u32 const   )1600085855U, 
        (u32 const   )538976288U,      (u32 const   )1751672936U,      (u32 const   )437918234U,      (u32 const   )2930683566U, 
        (u32 const   )3031741620U,      (u32 const   )1414812756U,      (u32 const   )2475922323U,      (u32 const   )572662306U, 
        (u32 const   )1684300900U,      (u32 const   )4059165169U,      (u32 const   )1936946035U,      (u32 const   )303174162U, 
        (u32 const   )1077952576U,      (u32 const   )134744072U,      (u32 const   )3284386755U,      (u32 const   )3974950124U, 
        (u32 const   )3688618971U,      (u32 const   )2711724449U,      (u32 const   )2374864269U,      (u32 const   )1027423549U, 
        (u32 const   )2543294359U,      (u32 const   )0U,      (u32 const   )3486502863U,      (u32 const   )724249387U, 
        (u32 const   )1987475062U,      (u32 const   )2189591170U,      (u32 const   )3604403926U,      (u32 const   )454761243U, 
        (u32 const   )3048584629U,      (u32 const   )2947526575U,      (u32 const   )1785358954U,      (u32 const   )1347440720U, 
        (u32 const   )1162167621U,      (u32 const   )4092851187U,      (u32 const   )808464432U,      (u32 const   )4025479151U, 
        (u32 const   )1061109567U,      (u32 const   )1431655765U,      (u32 const   )2728567458U,      (u32 const   )3941264106U, 
        (u32 const   )1701143909U,      (u32 const   )3132799674U,      (u32 const   )791621423U,      (u32 const   )3233857728U, 
        (u32 const   )3739147998U,      (u32 const   )471604252U,      (u32 const   )4261281277U,      (u32 const   )1296911693U, 
        (u32 const   )2459079314U,      (u32 const   )1970632053U,      (u32 const   )101058054U,      (u32 const   )2324335242U, 
        (u32 const   )2998055602U,      (u32 const   )3873892070U,      (u32 const   )235802126U,      (u32 const   )522133279U, 
        (u32 const   )1650614882U,      (u32 const   )3570717908U,      (u32 const   )2829625512U,      (u32 const   )2526451350U, 
        (u32 const   )4193909241U,      (u32 const   )3318072773U,      (u32 const   )623191333U,      (u32 const   )1499027801U, 
        (u32 const   )2223277188U,      (u32 const   )1920103026U,      (u32 const   )960051513U,      (u32 const   )1280068684U, 
        (u32 const   )1583242846U,      (u32 const   )2021161080U,      (u32 const   )943208504U,      (u32 const   )2358021260U, 
        (u32 const   )3520188881U,      (u32 const   )2779096485U,      (u32 const   )3806520034U,      (u32 const   )1633771873U, 
        (u32 const   )3014898611U,      (u32 const   )555819297U,      (u32 const   )2627509404U,      (u32 const   )505290270U, 
        (u32 const   )1128481603U,      (u32 const   )3351758791U,      (u32 const   )4244438268U,      (u32 const   )67372036U, 
        (u32 const   )1364283729U,      (u32 const   )2576980377U,      (u32 const   )1835887981U,      (u32 const   )218959117U, 
        (u32 const   )4210752250U,      (u32 const   )3755991007U,      (u32 const   )2122219134U,      (u32 const   )606348324U, 
        (u32 const   )993737531U,      (u32 const   )2880154539U,      (u32 const   )3469659854U,      (u32 const   )286331153U, 
        (u32 const   )2408550287U,      (u32 const   )1313754702U,      (u32 const   )3082270647U,      (u32 const   )3958107115U, 
        (u32 const   )1010580540U,      (u32 const   )2172748161U,      (u32 const   )2492765332U,      (u32 const   )4160223223U, 
        (u32 const   )3115956665U,      (u32 const   )320017171U,      (u32 const   )741092396U,      (u32 const   )3553874899U, 
        (u32 const   )3890735079U,      (u32 const   )1852730990U,      (u32 const   )3301229764U,      (u32 const   )50529027U, 
        (u32 const   )1448498774U,      (u32 const   )1145324612U,      (u32 const   )2139062143U,      (u32 const   )2846468521U, 
        (u32 const   )707406378U,      (u32 const   )3149642683U,      (u32 const   )3250700737U,      (u32 const   )1397969747U, 
        (u32 const   )3705461980U,      (u32 const   )185273099U,      (u32 const   )2644352413U,      (u32 const   )1819044972U, 
        (u32 const   )825307441U,      (u32 const   )1953789044U,      (u32 const   )4143380214U,      (u32 const   )1179010630U, 
        (u32 const   )2896997548U,      (u32 const   )2307492233U,      (u32 const   )336860180U,      (u32 const   )3789677025U, 
        (u32 const   )370546198U,      (u32 const   )976894522U,      (u32 const   )1768515945U,      (u32 const   )151587081U, 
        (u32 const   )1886417008U,      (u32 const   )3065427638U,      (u32 const   )3503345872U,      (u32 const   )3991793133U, 
        (u32 const   )3435973836U,      (u32 const   )1111638594U,      (u32 const   )2560137368U,      (u32 const   )2762253476U, 
        (u32 const   )673720360U,      (u32 const   )1549556828U,      (u32 const   )4177066232U,      (u32 const   )2256963206U};
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
static u32 const   rcon___1[10]  = 
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
  {      (u32 const   )16777216,      (u32 const   )33554432,      (u32 const   )67108864,      (u32 const   )134217728, 
        (u32 const   )268435456,      (u32 const   )536870912,      (u32 const   )1073741824,      (u32 const   )2147483648U, 
        (u32 const   )452984832,      (u32 const   )905969664};
#line 215 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_parse_zone_zoneserver(js_string *zone , int connect___0 , int soa_q , q_header *header ) ;
#line 222
int csv2_parse_zone_bighash(js_string *zone , js_string *filename , mhash *bighash ,
                            int32_t starwhitis ) ;
#line 224
int csv2_parse_zone(js_string *filename , csv2_add_state *state , int32_t starwhitis ) ;
#line 43 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_parse_main_bighash(mhash *main_table , int32_t starwhitis ) 
{ 
  mhash *csv2s ;
  js_string *zone ;
  js_string *filename ;
  ipv4pair *iplist ;
  int x ;
  int tmp ;
  mhash *tmp___0 ;
  int tmp___1 ;
  js_string *t ;
  int tmp___2 ;

  {
  {
#line 51
  tmp = dq_keyword2n((char *)"csv2");
#line 51
  tmp___0 = dvar_raw(tmp);
#line 51
  csv2s = tmp___0;
  }
#line 54
  if ((unsigned long )csv2s == (unsigned long )((mhash *)0)) {
#line 55
    return (0);
  }
  {
#line 60
  iplist = get_synthip_list();
#line 61
  x = 0;
  }
  {
#line 61
  while (1) {
    while_continue: /* CIL Label */ ;
#line 61
    if (! (x < 500)) {
#line 61
      goto while_break;
    }
#line 62
    if ((iplist + x)->ip == 4294967295U) {
#line 63
      goto while_break;
    }
#line 65
    if ((iplist + x)->ip == 0U) {
      {
#line 66
      printf((char const   */* __restrict  */)"You can not have both csv2 zone files and have MaraDNS bind to 0.0.0.0\nMaraDNS now supports binding to multiple IPs; please use this feature.\n");
#line 71
      exit(1);
      }
    }
#line 61
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 76
  zone = js_create(256U, 1U);
  }
#line 76
  if ((unsigned long )zone == (unsigned long )((js_string *)0)) {
#line 77
    return (-1);
  }
  {
#line 83
  tmp___1 = mhash_firstkey(csv2s, zone);
  }
#line 83
  if (tmp___1 == 0) {
    {
#line 84
    js_destroy(zone);
    }
#line 85
    return (0);
  }
  {
#line 89
  while (1) {
    while_continue___0: /* CIL Label */ ;
    {
#line 90
    filename = mhash_get_js(csv2s, zone);
    }
#line 91
    if ((unsigned long )zone != (unsigned long )((js_string *)0)) {
      {
#line 94
      t = csv2_zone_to_udpzone(zone);
      }
#line 94
      if ((unsigned long )t != (unsigned long )((js_string *)0)) {
        {
#line 95
        csv2_parse_zone_bighash(zone, filename, main_table, starwhitis);
#line 97
        js_destroy(t);
        }
      } else {
        {
#line 99
        printf((char const   */* __restrict  */)"Bad zone name ");
#line 100
        show_esc_stdout(zone);
#line 101
        printf((char const   */* __restrict  */)" (don\'t forget the trailing dot!)\n");
        }
      }
    }
    {
#line 89
    tmp___2 = mhash_nextkey(csv2s, zone);
    }
#line 89
    if (! (tmp___2 != 0)) {
#line 89
      goto while_break___0;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 106
  js_destroy(zone);
  }
#line 107
  return (0);
}
}
#line 113 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
q_header *csv2_copy_header(q_header *in ) 
{ 
  q_header *out ;
  void *tmp ;
  void *tmp___0 ;

  {
  {
#line 115
  tmp = js_alloc((int )sizeof(q_header ), 1);
#line 115
  out = (q_header *)tmp;
  }
#line 115
  if ((unsigned long )out == (unsigned long )((q_header *)0)) {
#line 116
    return ((q_header *)0);
  }
  {
#line 120
  tmp___0 = memcpy((void */* __restrict  */)out, (void const   */* __restrict  */)in,
                   sizeof(q_header ));
  }
#line 120
  if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
    {
#line 121
    js_dealloc((void *)out);
    }
#line 122
    return ((q_header *)0);
  }
#line 124
  return (out);
}
}
#line 131 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
js_string *csv2_alabel_to_blabel(js_string *alabel ) 
{ 
  js_string *tmp ;

  {
  {
#line 132
  tmp = csv2_zone_to_udpzone(alabel);
  }
#line 132
  return (tmp);
}
}
#line 139 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_append_rr(js_string *reply , csv2_rr *point ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 140
  if ((unsigned long )point == (unsigned long )((csv2_rr *)0)) {
#line 141
    return (-1);
  }
  {
#line 143
  tmp = js_append(point->query, reply);
  }
#line 143
  if (tmp == -1) {
#line 144
    return (-1);
  }
  {
#line 146
  tmp___0 = js_adduint16(reply, point->rtype);
  }
#line 146
  if (tmp___0 == -1) {
#line 147
    return (-1);
  }
  {
#line 150
  tmp___1 = js_adduint16(reply, 1);
  }
#line 150
  if (tmp___1 == -1) {
#line 151
    return (-1);
  }
  {
#line 154
  js_adduint32(reply, (uint32_t )point->ttl);
#line 155
  tmp___2 = js_adduint16(reply, (int )(point->data)->unit_count);
  }
#line 155
  if (tmp___2 == -1) {
#line 156
    return (-1);
  }
  {
#line 158
  tmp___3 = js_append(point->data, reply);
  }
#line 158
  if (tmp___3 == -1) {
#line 159
    return (-1);
  }
#line 161
  return (1);
}
}
#line 172 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_tcp_spit_data(csv2_add_state *state , int connect___0 , q_header *header ,
                       js_string *zone , int type , csv2_rr *soa ) 
{ 
  q_header *h_copy ;
  unsigned char len[3] ;
  js_string *reply ;
  js_string *zone_name ;
  csv2_rr *point ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  csv2_rr *point___0 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  ssize_t tmp___7 ;
  ssize_t tmp___8 ;

  {
  {
#line 179
  h_copy = csv2_copy_header(header);
#line 184
  h_copy->qr = 1;
#line 186
  h_copy->aa = 1;
#line 188
  h_copy->tc = 0;
#line 195
  h_copy->ra = 0;
#line 199
  h_copy->z = 0;
#line 200
  h_copy->rcode = 0;
#line 201
  h_copy->qdcount = (uint16_t )1;
#line 204
  h_copy->ancount = (uint16_t )1;
#line 205
  h_copy->nscount = (uint16_t )0;
#line 207
  h_copy->arcount = (uint16_t )0;
#line 211
  point = state->buffer;
  }
#line 213
  if ((unsigned long )point == (unsigned long )((csv2_rr *)0)) {
#line 213
    if (type != 3) {
      {
#line 214
      js_dealloc((void *)h_copy);
      }
#line 215
      return (-1);
    }
  }
#line 218
  if (type != 3) {
#line 219
    point = point->next;
  }
#line 222
  if (type == 1) {
    {
#line 223
    while (1) {
      while_continue: /* CIL Label */ ;
#line 223
      if (! ((unsigned long )point != (unsigned long )((csv2_rr *)0))) {
#line 223
        goto while_break;
      }
#line 224
      if (point->rtype != 2) {
#line 227
        goto while_break;
      }
#line 228
      h_copy->nscount = (uint16_t )((int )h_copy->nscount + 1);
#line 229
      if ((int )h_copy->nscount > 1000) {
        {
#line 230
        js_dealloc((void *)h_copy);
        }
#line 231
        return (-1);
      }
#line 233
      point = point->next;
    }
    while_break: /* CIL Label */ ;
    }
  }
  {
#line 238
  reply = js_create(2048U, 1U);
  }
#line 238
  if ((unsigned long )reply == (unsigned long )((js_string *)0)) {
    {
#line 239
    js_dealloc((void *)h_copy);
    }
#line 240
    return (-1);
  }
  {
#line 244
  tmp = make_hdr(h_copy, reply);
  }
#line 244
  if (tmp == -1) {
    {
#line 245
    js_dealloc((void *)h_copy);
#line 246
    js_destroy(reply);
    }
#line 247
    return (-1);
  }
#line 251
  if (type == 1) {
    {
#line 253
    zone_name = csv2_alabel_to_blabel(zone);
    }
#line 253
    if ((unsigned long )zone_name == (unsigned long )((js_string *)0)) {
      {
#line 254
      js_dealloc((void *)h_copy);
#line 255
      js_destroy(reply);
      }
#line 256
      return (-1);
    }
    {
#line 258
    tmp___0 = js_append(zone_name, reply);
    }
#line 258
    if (tmp___0 == -1) {
      {
#line 259
      js_dealloc((void *)h_copy);
#line 260
      js_destroy(reply);
      }
#line 261
      return (-1);
    }
    {
#line 263
    tmp___1 = js_adduint16(reply, 6);
    }
#line 263
    if (tmp___1 == -1) {
      {
#line 264
      js_dealloc((void *)h_copy);
#line 265
      js_destroy(reply);
      }
#line 266
      return (-1);
    }
    {
#line 268
    js_destroy(zone_name);
    }
  } else
#line 269
  if (type == 2) {
#line 269
    goto _L;
  } else
#line 269
  if (type == 3) {
    _L: /* CIL Label */ 
#line 271
    if (type == 2) {
#line 272
      point___0 = state->buffer;
    } else {
#line 275
      point___0 = soa;
    }
    {
#line 277
    tmp___2 = js_append(point___0->query, reply);
    }
#line 277
    if (tmp___2 == -1) {
      {
#line 278
      js_dealloc((void *)h_copy);
#line 279
      js_destroy(reply);
      }
#line 280
      return (-1);
    }
    {
#line 282
    tmp___3 = js_adduint16(reply, point___0->rtype);
    }
#line 282
    if (tmp___3 == -1) {
      {
#line 283
      js_dealloc((void *)h_copy);
#line 284
      js_destroy(reply);
      }
#line 285
      return (-1);
    }
  } else {
    {
#line 288
    js_dealloc((void *)h_copy);
#line 289
    js_destroy(reply);
    }
#line 290
    return (-1);
  }
  {
#line 294
  tmp___4 = js_adduint16(reply, 1);
  }
#line 294
  if (tmp___4 == -1) {
    {
#line 295
    js_dealloc((void *)h_copy);
#line 296
    js_destroy(reply);
    }
#line 297
    return (-1);
  }
#line 301
  if (type == 1) {
#line 302
    point = state->buffer;
  } else
#line 301
  if (type == 2) {
#line 302
    point = state->buffer;
  } else
#line 304
  if (type == 3) {
#line 305
    point = soa;
  }
  {
#line 307
  tmp___5 = csv2_append_rr(reply, point);
  }
#line 307
  if (tmp___5 == -1) {
    {
#line 308
    js_dealloc((void *)h_copy);
#line 309
    js_destroy(reply);
    }
#line 310
    return (-1);
  }
#line 314
  if (type == 1) {
#line 315
    point = point->next;
    {
#line 316
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 316
      if (! ((unsigned long )point != (unsigned long )((csv2_rr *)0))) {
#line 316
        goto while_break___0;
      }
#line 317
      if (point->rtype != 2) {
#line 320
        goto while_break___0;
      }
      {
#line 322
      tmp___6 = csv2_append_rr(reply, point);
      }
#line 322
      if (tmp___6 == -1) {
        {
#line 323
        js_dealloc((void *)h_copy);
#line 324
        js_destroy(reply);
        }
#line 325
        return (-1);
      }
#line 327
      point = point->next;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  {
#line 332
  len[0] = (unsigned char )((reply->unit_count & 65280U) >> 8);
#line 333
  len[1] = (unsigned char )(reply->unit_count & 255U);
#line 337
  tmp___7 = write(connect___0, (void const   *)(len), (size_t )2);
  }
#line 337
  if (tmp___7 == -1L) {
    {
#line 338
    js_dealloc((void *)h_copy);
#line 339
    js_destroy(reply);
    }
#line 340
    return (-1);
  }
  {
#line 342
  tmp___8 = write(connect___0, (void const   *)reply->string, (size_t )reply->unit_count);
  }
#line 342
  if (tmp___8 == -1L) {
    {
#line 343
    js_dealloc((void *)h_copy);
#line 344
    js_destroy(reply);
    }
#line 345
    return (-1);
  }
  {
#line 348
  js_dealloc((void *)h_copy);
#line 349
  js_destroy(reply);
  }
#line 350
  return (1);
}
}
#line 355 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_tcp_spit_soa(csv2_add_state *state , int connect___0 , q_header *header ,
                      js_string *zone ) 
{ 
  int tmp ;

  {
  {
#line 357
  tmp = csv2_tcp_spit_data(state, connect___0, header, zone, 1, (csv2_rr *)0);
  }
#line 357
  return (tmp);
}
}
#line 362 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_tcp_spit_buffer(csv2_add_state *state , int connect___0 , q_header *header ,
                         js_string *zone ) 
{ 
  int tmp ;

  {
#line 364
  if (state->add_method != 2) {
#line 365
    return (-1);
  }
  {
#line 367
  while (1) {
    while_continue: /* CIL Label */ ;
#line 367
    if (! ((unsigned long )state->buffer != (unsigned long )((csv2_rr *)0))) {
#line 367
      goto while_break;
    }
    {
#line 368
    tmp = csv2_tcp_spit_data(state, connect___0, header, zone, 2, (csv2_rr *)0);
    }
#line 368
    if (tmp == -1) {
#line 370
      return (-1);
    }
    {
#line 372
    csv2_pop_buffer(state);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 374
  return (1);
}
}
#line 389 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_parse_zone_zoneserver(js_string *zone , int connect___0 , int soa_q , q_header *header ) 
{ 
  csv2_add_state *state ;
  int x ;
  csv2_read *stream ;
  csv2_rr *soa_save ;
  js_string *dvar_name ;
  js_string *filename ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int length ;
  unsigned char get[3] ;
  int tmp___4 ;
  ssize_t tmp___5 ;
  ssize_t tmp___6 ;
  ssize_t tmp___7 ;
  ssize_t tmp___8 ;
  int tmp___9 ;
  int c ;
  int q ;
  int tmp___10 ;
  int tmp___11 ;

  {
  {
#line 399
  state = csv2_init_add_state(zone);
  }
#line 399
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 400
    return (0);
  }
  {
#line 404
  tmp = csv2_set_add_method(state, 2);
  }
#line 404
  if (tmp == -1) {
    {
#line 405
    csv2_close_state(state);
    }
#line 406
    return (0);
  }
  {
#line 411
  filename = js_create(256U, 1U);
  }
#line 411
  if ((unsigned long )filename == (unsigned long )((js_string *)0)) {
    {
#line 412
    csv2_close_state(state);
    }
#line 413
    return (0);
  }
  {
#line 415
  dvar_name = js_create(6U, 1U);
  }
#line 415
  if ((unsigned long )dvar_name == (unsigned long )((js_string *)0)) {
    {
#line 416
    js_destroy(filename);
#line 417
    csv2_close_state(state);
    }
#line 418
    return (0);
  }
  {
#line 420
  tmp___0 = js_qstr2js(dvar_name, (char *)"csv2");
  }
#line 420
  if (tmp___0 == -1) {
    {
#line 421
    js_destroy(filename);
#line 422
    js_destroy(dvar_name);
#line 423
    csv2_close_state(state);
    }
#line 424
    return (0);
  }
  {
#line 426
  tmp___1 = read_dvar(dvar_name, zone, filename);
  }
#line 426
  if (tmp___1 == -1) {
    {
#line 427
    js_destroy(filename);
#line 428
    js_destroy(dvar_name);
#line 429
    csv2_close_state(state);
    }
#line 430
    return (0);
  }
  {
#line 436
  tmp___2 = csv2_set_soa_serial(state, filename);
  }
#line 436
  if (tmp___2 == -1) {
    {
#line 437
    printf((char const   */* __restrict  */)"Error running stat() on ");
#line 438
    show_esc_stdout(filename);
#line 439
    printf((char const   */* __restrict  */)"\n");
    }
  }
  {
#line 443
  stream = csv2_open(filename);
  }
#line 444
  if ((unsigned long )stream == (unsigned long )((csv2_read *)0)) {
    {
#line 445
    printf((char const   */* __restrict  */)"Error opening ");
#line 446
    show_esc_stdout(filename);
#line 447
    printf((char const   */* __restrict  */)"\n");
#line 448
    csv2_zap_add_state(state);
    }
#line 449
    return (0);
  }
#line 455
  x = 0;
  {
#line 455
  while (1) {
    while_continue: /* CIL Label */ ;
#line 455
    if (! (x < 29)) {
#line 455
      goto while_break;
    }
#line 456
    if (state->in_ns != 1) {
#line 457
      goto while_break;
    }
    {
#line 459
    tmp___3 = csv2_read_rr(state, stream, 0);
    }
#line 459
    if (tmp___3 < 0) {
#line 460
      goto while_break;
    }
#line 455
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 466
  if (soa_q == 1) {
    {
#line 469
    tmp___4 = csv2_tcp_spit_soa(state, connect___0, header, zone);
    }
#line 469
    if (tmp___4 == -1) {
      {
#line 471
      csv2_zap_add_state(state);
      }
#line 472
      return (-1);
    }
#line 475
    if (connect___0 == 1) {
      {
#line 476
      tmp___5 = read(0, (void *)(get), (size_t )2);
      }
#line 476
      if (tmp___5 != 1L) {
        {
#line 477
        csv2_zap_add_state(state);
        }
#line 478
        return (-1);
      }
    } else {
      {
#line 481
      tmp___6 = recv(connect___0, (void *)(get), (size_t )2, 0);
      }
#line 481
      if (tmp___6 != 2L) {
        {
#line 482
        csv2_zap_add_state(state);
        }
#line 483
        return (-1);
      }
    }
#line 486
    length = (((int )get[0] & 255) << 8) | ((int )get[1] & 255);
    {
#line 488
    while (1) {
      while_continue___0: /* CIL Label */ ;
#line 488
      if (! (length > 0)) {
#line 488
        goto while_break___0;
      }
#line 489
      if (connect___0 == 1) {
        {
#line 490
        tmp___7 = read(0, (void *)(get), (size_t )1);
        }
#line 490
        if (tmp___7 != 1L) {
          {
#line 491
          csv2_zap_add_state(state);
          }
#line 492
          return (-1);
        }
      } else {
        {
#line 495
        tmp___8 = recv(connect___0, (void *)(get), (size_t )1, 256);
        }
#line 495
        if (tmp___8 != 1L) {
          {
#line 496
          csv2_zap_add_state(state);
          }
#line 497
          return (-1);
        }
      }
#line 500
      length --;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  {
#line 509
  soa_save = copy_csv2_rr(state->buffer);
#line 512
  tmp___9 = csv2_tcp_spit_buffer(state, connect___0, header, zone);
  }
#line 512
  if (tmp___9 == -1) {
    {
#line 513
    js_dealloc((void *)soa_save);
#line 514
    csv2_zap_add_state(state);
    }
#line 515
    return (-1);
  }
#line 519
  x = 0;
  {
#line 519
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 519
    if (! (x < 100000)) {
#line 519
      goto while_break___1;
    }
#line 522
    q = 0;
#line 523
    c = 0;
    {
#line 523
    while (1) {
      while_continue___2: /* CIL Label */ ;
#line 523
      if (! (c < 20)) {
#line 523
        goto while_break___2;
      }
      {
#line 524
      q = csv2_read_rr(state, stream, 0);
      }
#line 525
      if (q < 0) {
#line 526
        goto while_break___2;
      }
#line 523
      c ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    {
#line 530
    tmp___10 = csv2_tcp_spit_buffer(state, connect___0, header, zone);
    }
#line 530
    if (tmp___10 == -1) {
      {
#line 532
      js_dealloc((void *)soa_save);
#line 533
      csv2_zap_add_state(state);
      }
#line 534
      return (-1);
    }
#line 537
    if (q < 0) {
#line 538
      goto while_break___1;
    }
#line 519
    x ++;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
#line 544
  tmp___11 = csv2_tcp_spit_data(state, connect___0, header, zone, 3, soa_save);
  }
#line 544
  if (tmp___11 == -1) {
    {
#line 546
    js_dealloc((void *)soa_save);
#line 547
    csv2_zap_add_state(state);
    }
#line 548
    return (-1);
  }
  {
#line 550
  csv2_zap_add_state(state);
  }
#line 551
  return (1);
}
}
#line 556 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_parse_zone_bighash(js_string *zone , js_string *filename , mhash *bighash ,
                            int32_t starwhitis ) 
{ 
  csv2_add_state *state ;
  int nostar ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 563
  nostar = 0;
  {
#line 563
  while (1) {
    while_continue: /* CIL Label */ ;
#line 563
    if (! ((unsigned int )nostar < zone->unit_size * zone->unit_count)) {
#line 563
      goto while_break;
    }
#line 565
    if ((int )*(zone->string + nostar) == 42) {
#line 565
      if (zone->unit_count > 1U) {
        {
#line 566
        printf((char const   */* __restrict  */)"Illegal zone name: ");
#line 567
        nostar = 0;
        }
        {
#line 567
        while (1) {
          while_continue___0: /* CIL Label */ ;
#line 567
          if (! ((unsigned int )nostar < zone->unit_size * zone->unit_count)) {
#line 567
            goto while_break___0;
          }
          {
#line 569
          printf((char const   */* __restrict  */)"%c", (int )*(zone->string + nostar));
#line 567
          nostar ++;
          }
        }
        while_break___0: /* CIL Label */ ;
        }
        {
#line 571
        printf((char const   */* __restrict  */)"\nThis is a fatal error.\n");
#line 572
        exit(1);
        }
      }
    }
#line 563
    nostar ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 576
  state = csv2_init_add_state(zone);
  }
#line 576
  if ((unsigned long )state == (unsigned long )((csv2_add_state *)0)) {
#line 577
    return (0);
  }
  {
#line 579
  tmp = csv2_set_bighash(state, bighash);
  }
#line 579
  if (tmp == -1) {
    {
#line 580
    csv2_close_state(state);
    }
#line 581
    return (0);
  }
#line 583
  if (starwhitis == 0) {
    {
#line 584
    tmp___0 = csv2_set_add_method(state, 1);
    }
#line 584
    if (tmp___0 == -1) {
      {
#line 585
      csv2_close_state(state);
      }
#line 586
      return (0);
    }
  } else
#line 588
  if (starwhitis == 1) {
    {
#line 589
    tmp___1 = csv2_set_add_method(state, 3);
    }
#line 589
    if (tmp___1 == -1) {
      {
#line 590
      csv2_close_state(state);
      }
#line 591
      return (0);
    }
  } else {
    {
#line 594
    printf((char const   */* __restrict  */)"FATAL: Illegal value %d for starwhitis\n",
           starwhitis);
#line 595
    exit(1);
    }
  }
  {
#line 598
  tmp___2 = csv2_parse_zone(filename, state, starwhitis);
  }
#line 598
  return (tmp___2);
}
}
#line 602 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_main.c"
int csv2_parse_zone(js_string *filename , csv2_add_state *state , int32_t starwhitis ) 
{ 
  csv2_read *stream ;
  int x ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 607
  printf((char const   */* __restrict  */)"Processing zone ");
#line 608
  show_esc_stdout(state->zone);
#line 609
  printf((char const   */* __restrict  */)" right now.\n");
#line 610
  printf((char const   */* __restrict  */)"Filename: ");
#line 611
  show_esc_stdout(filename);
#line 612
  printf((char const   */* __restrict  */)"\n");
#line 617
  tmp = csv2_set_soa_serial(state, filename);
  }
#line 617
  if (tmp == -1) {
    {
#line 618
    printf((char const   */* __restrict  */)"Error running stat() on ");
#line 619
    show_esc_stdout(filename);
#line 620
    printf((char const   */* __restrict  */)"\n");
    }
  }
  {
#line 623
  stream = csv2_open(filename);
  }
#line 624
  if ((unsigned long )stream == (unsigned long )((csv2_read *)0)) {
    {
#line 625
    printf((char const   */* __restrict  */)"Error opening ");
#line 626
    show_esc_stdout(filename);
#line 627
    printf((char const   */* __restrict  */)"\n");
#line 628
    csv2_zap_add_state(state);
    }
#line 629
    return (0);
  }
#line 634
  x = 0;
  {
#line 634
  while (1) {
    while_continue: /* CIL Label */ ;
#line 634
    if (! (x < 100000)) {
#line 634
      goto while_break;
    }
    {
#line 635
    tmp___0 = csv2_read_rr(state, stream, starwhitis);
    }
#line 635
    if (tmp___0 < 0) {
#line 636
      goto while_break;
    }
#line 634
    x ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 639
  csv2_close(stream);
  }
#line 642
  if (state->in_ns == 1) {
    {
#line 643
    csv2_add_soa(state);
    }
  }
  {
#line 645
  csv2_zap_add_state(state);
  }
#line 646
  return (0);
}
}
#line 265 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_functions.h"
int csv2_is_hex_or_colon(int32_t in ) ;
#line 266
js_string *process_aaaa(csv2_read *stream ) ;
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_aaaa.c"
int csv2_is_hex(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 31
  tmp = csv2_is_number(in);
  }
#line 31
  if (tmp) {
#line 31
    tmp___0 = 1;
  } else
#line 31
  if (in >= 97) {
#line 31
    if (in <= 102) {
#line 31
      tmp___0 = 1;
    } else {
#line 31
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 31
  if (in >= 65) {
#line 31
    if (in <= 70) {
#line 31
      tmp___0 = 1;
    } else {
#line 31
      tmp___0 = 0;
    }
  } else {
#line 31
    tmp___0 = 0;
  }
#line 31
  return (tmp___0);
}
}
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_aaaa.c"
int csv2_is_hex_or_colon(int32_t in ) 
{ 
  int tmp ;
  int tmp___0 ;

  {
  {
#line 36
  tmp = csv2_is_hex(in);
  }
#line 36
  if (tmp) {
#line 36
    tmp___0 = 1;
  } else
#line 36
  if (in == 58) {
#line 36
    tmp___0 = 1;
  } else {
#line 36
    tmp___0 = 0;
  }
#line 36
  return (tmp___0);
}
}
#line 42 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_aaaa.c"
js_string *process_aaaa(csv2_read *stream ) 
{ 
  js_string *tmp ;

  {
  {
#line 43
  tmp = process_something(stream, & csv2_is_hex_or_colon);
  }
#line 43
  return (tmp);
}
}
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/Csv2_rr_aaaa.c"
js_string *csv2_get_aaaa(csv2_read *stream ) 
{ 
  js_string *ip6hex ;
  js_string *out ;
  int tmp ;

  {
  {
#line 54
  tmp = csv2_get_1st(stream, & csv2_is_hex_or_colon, 0);
  }
#line 54
  if (tmp != 1) {
#line 55
    return ((js_string *)0);
  }
  {
#line 58
  ip6hex = process_aaaa(stream);
  }
#line 58
  if ((unsigned long )ip6hex == (unsigned long )((js_string *)0)) {
#line 59
    return ((js_string *)0);
  }
  {
#line 62
  out = ip6_to_raw(ip6hex);
  }
#line 62
  if ((unsigned long )out == (unsigned long )((js_string *)0)) {
    {
#line 63
    js_destroy(ip6hex);
#line 64
    csv2_error(stream, (char *)"Invalid IPv6 address");
    }
#line 65
    return ((js_string *)0);
  }
  {
#line 68
  js_destroy(ip6hex);
  }
#line 69
  return (out);
}
}
#line 27 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
int log_level  =    1;
#line 29 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
ipv4pair *bind_addr_list  =    (ipv4pair *)0;
#line 30 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
ipv4pair *synthip_addr_list  =    (ipv4pair *)0;
#line 34 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
js_string *synth_soa_origin  =    (js_string *)0;
#line 35 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
int synth_soa_serial  =    1;
#line 37 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
js_string *show_synth_soa_origin(void) 
{ 


  {
#line 38
  return (synth_soa_origin);
}
}
#line 40 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
int show_synth_soa_serial(void) 
{ 


  {
#line 41
  return (synth_soa_serial);
}
}
#line 46 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
void set_soa_origin(js_string *in ) 
{ 


  {
#line 47
  synth_soa_origin = in;
#line 48
  return;
}
}
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
void set_soa_serial(int in ) 
{ 


  {
#line 50
  synth_soa_serial = in;
#line 51
  return;
}
}
#line 58 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
ipv4pair *libtcp_bind_address(int type ) 
{ 
  js_string *bind_address___0 ;
  js_string *ipv4_bind_address ;
  js_string *synthip ;
  js_string *q ;
  ipv4pair *out ;
  int c ;
  void *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 59
  bind_address___0 = (js_string *)0;
#line 59
  ipv4_bind_address = (js_string *)0;
#line 59
  synthip = (js_string *)0;
#line 59
  q = (js_string *)0;
#line 62
  out = (ipv4pair *)0;
#line 66
  bind_address___0 = read_string_kvar((char *)"bind_address");
#line 67
  ipv4_bind_address = read_string_kvar((char *)"ipv4_bind_addresses");
  }
#line 68
  if (type == 2) {
    {
#line 69
    synthip = read_string_kvar((char *)"csv2_synthip_list");
    }
  }
  {
#line 71
  tmp = js_alloc((int )sizeof(ipv4pair ), 512);
#line 71
  out = (ipv4pair *)tmp;
  }
#line 71
  if ((unsigned long )out == (unsigned long )((ipv4pair *)0)) {
    {
#line 72
    js_destroy(bind_address___0);
#line 73
    js_destroy(ipv4_bind_address);
#line 74
    js_destroy(synthip);
    }
#line 75
    return ((ipv4pair *)0);
  }
#line 78
  c = 0;
  {
#line 78
  while (1) {
    while_continue: /* CIL Label */ ;
#line 78
    if (! (c < 512)) {
#line 78
      goto while_break;
    }
#line 79
    (out + c)->ip = 4294967295U;
#line 78
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 82
  q = bind_address___0;
#line 84
  tmp___0 = js_length(ipv4_bind_address);
  }
#line 84
  if (tmp___0 > 0) {
#line 85
    q = ipv4_bind_address;
  }
#line 87
  if (type == 2) {
    {
#line 87
    tmp___1 = js_length(synthip);
    }
#line 87
    if (tmp___1 > 0) {
#line 88
      q = synthip;
    }
  }
  {
#line 91
  tmp___2 = make_ip_acl(q, out, 500, 0);
  }
#line 91
  if (tmp___2 == -1) {
    {
#line 92
    js_destroy(bind_address___0);
#line 93
    js_destroy(ipv4_bind_address);
#line 94
    js_destroy(synthip);
#line 95
    js_dealloc((void *)out);
    }
#line 96
    return ((ipv4pair *)0);
  }
  {
#line 99
  js_destroy(bind_address___0);
#line 100
  js_destroy(ipv4_bind_address);
#line 101
  js_destroy(synthip);
  }
#line 102
  return (out);
}
}
#line 110 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
int libtcp_create_bind_addrs(void) 
{ 


  {
  {
#line 111
  bind_addr_list = libtcp_bind_address(1);
#line 112
  synthip_addr_list = libtcp_bind_address(2);
  }
#line 113
  if ((unsigned long )bind_addr_list == (unsigned long )((ipv4pair *)0)) {
#line 114
    return (-1);
  }
#line 116
  if ((unsigned long )synthip_addr_list == (unsigned long )((ipv4pair *)0)) {
#line 117
    return (-1);
  }
#line 119
  return (1);
}
}
#line 129 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
ipv4pair *get_bind_addr_list(void) 
{ 


  {
#line 130
  return (bind_addr_list);
}
}
#line 133 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
ipv4pair *get_synthip_list(void) 
{ 


  {
#line 134
  return (synthip_addr_list);
}
}
#line 144 "/home/wheatley/newnew/temp/maradns-2.0.09/tcp/libtcp.c"
int fold_case(js_string *js ) 
{ 
  int counter ;
  int ret ;

  {
#line 145
  counter = 0;
#line 146
  ret = 0;
#line 148
  if (js->max_count <= js->unit_count) {
#line 149
    return (-1);
  }
#line 151
  if (js->unit_size != 1U) {
#line 152
    return (-1);
  }
#line 154
  if (js->unit_count < 2U) {
#line 155
    return (-1);
  }
  {
#line 157
  while (1) {
    while_continue: /* CIL Label */ ;
#line 157
    if (! ((unsigned int )(counter + 2) < js->unit_count)) {
#line 157
      goto while_break;
    }
#line 160
    if ((int )*(js->string + counter) >= 65) {
#line 160
      if ((int )*(js->string + counter) <= 90) {
#line 162
        *(js->string + counter) = (unsigned char )((int )*(js->string + counter) + 32);
#line 163
        ret = 1;
      }
    }
#line 165
    counter ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 168
  return (ret);
}
}
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *dotq___0  =    (js_string *)0;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *numdotq___0  =    (js_string *)0;
#line 51 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *slashq___0  =    (js_string *)0;
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static uint32_t masks___0[33]  = 
#line 52
  {      (uint32_t )0,      2147483648U,      3221225472U,      3758096384U, 
        4026531840U,      4160749568U,      4227858432U,      4261412864U, 
        4278190080U,      4286578688U,      4290772992U,      4292870144U, 
        4293918720U,      4294443008U,      4294705152U,      4294836224U, 
        4294901760U,      4294934528U,      4294950912U,      4294959104U, 
        4294963200U,      4294965248U,      4294966272U,      4294966784U, 
        4294967040U,      4294967168U,      4294967232U,      4294967264U, 
        4294967280U,      4294967288U,      4294967292U,      4294967294U, 
        4294967295U};
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___3  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___3  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___3  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___3  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___3  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___3  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___3  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___3  =    (js_file *)0;
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *dotq___1  =    (js_string *)0;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *numdotq___1  =    (js_string *)0;
#line 51 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *slashq___1  =    (js_string *)0;
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static uint32_t masks___1[33]  = 
#line 52
  {      (uint32_t )0,      2147483648U,      3221225472U,      3758096384U, 
        4026531840U,      4160749568U,      4227858432U,      4261412864U, 
        4278190080U,      4286578688U,      4290772992U,      4292870144U, 
        4293918720U,      4294443008U,      4294705152U,      4294836224U, 
        4294901760U,      4294934528U,      4294950912U,      4294959104U, 
        4294963200U,      4294965248U,      4294966272U,      4294966784U, 
        4294967040U,      4294967168U,      4294967232U,      4294967264U, 
        4294967280U,      4294967288U,      4294967292U,      4294967294U, 
        4294967295U};
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te0___2[256]  = 
#line 3 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
  {      (u32 const   )3017953435U,      (u32 const   )1672792582U,      (u32 const   )2246353620U,      (u32 const   )560743938U, 
        (u32 const   )980369320U,      (u32 const   )2786508149U,      (u32 const   )323814928U,      (u32 const   )1298184604U, 
        (u32 const   )392868941U,      (u32 const   )2135030158U,      (u32 const   )3799505551U,      (u32 const   )3454798025U, 
        (u32 const   )1510608337U,      (u32 const   )453212586U,      (u32 const   )2070301651U,      (u32 const   )2715875159U, 
        (u32 const   )4205140826U,      (u32 const   )3929646389U,      (u32 const   )3315758963U,      (u32 const   )2977696056U, 
        (u32 const   )539224030U,      (u32 const   )3564185792U,      (u32 const   )2089812465U,      (u32 const   )582860413U, 
        (u32 const   )3967831755U,      (u32 const   )3107092098U,      (u32 const   )3172320479U,      (u32 const   )3385571988U, 
        (u32 const   )2760434902U,      (u32 const   )21995996U,      (u32 const   )1617244793U,      (u32 const   )4269992199U, 
        (u32 const   )1960738379U,      (u32 const   )2833328433U,      (u32 const   )69710429U,      (u32 const   )3864029394U, 
        (u32 const   )2307747635U,      (u32 const   )2458785433U,      (u32 const   )302163916U,      (u32 const   )2049567247U, 
        (u32 const   )522505207U,      (u32 const   )1682079780U,      (u32 const   )3715167910U,      (u32 const   )3200531616U, 
        (u32 const   )755338213U,      (u32 const   )368373230U,      (u32 const   )1462526442U,      (u32 const   )485831560U, 
        (u32 const   )4185170725U,      (u32 const   )1078384039U,      (u32 const   )733765659U,      (u32 const   )3735097049U, 
        (u32 const   )1121487876U,      (u32 const   )2402583757U,      (u32 const   )1600265808U,      (u32 const   )2203928874U, 
        (u32 const   )4112346818U,      (u32 const   )798741062U,      (u32 const   )3213598076U,      (u32 const   )3994949480U, 
        (u32 const   )1812791198U,      (u32 const   )371529105U,      (u32 const   )927552403U,      (u32 const   )1555293743U, 
        (u32 const   )1057434665U,      (u32 const   )1272533602U,      (u32 const   )90706817U,      (u32 const   )2416987962U, 
        (u32 const   )64092287U,      (u32 const   )1380217451U,      (u32 const   )3577645340U,      (u32 const   )2596301091U, 
        (u32 const   )1368754708U,      (u32 const   )2438983398U,      (u32 const   )3756961541U,      (u32 const   )2046300784U, 
        (u32 const   )3536372542U,      (u32 const   )968804311U,      (u32 const   )1983916008U,      (u32 const   )1208527389U, 
        (u32 const   )3480375658U,      (u32 const   )647629856U,      (u32 const   )2872103246U,      (u32 const   )3260300625U, 
        (u32 const   )1997506100U,      (u32 const   )2695845515U,      (u32 const   )668315132U,      (u32 const   )1342103615U, 
        (u32 const   )3021216441U,      (u32 const   )2363849906U,      (u32 const   )720617927U,      (u32 const   )3687390552U, 
        (u32 const   )3606016355U,      (u32 const   )1020712022U,      (u32 const   )1531292685U,      (u32 const   )1044942325U, 
        (u32 const   )841039890U,      (u32 const   )3785761520U,      (u32 const   )2609891583U,      (u32 const   )1133981144U, 
        (u32 const   )3433277717U,      (u32 const   )678271076U,      (u32 const   )837859437U,      (u32 const   )882420716U, 
        (u32 const   )1932014697U,      (u32 const   )1876756449U,      (u32 const   )1747668419U,      (u32 const   )1725749639U, 
        (u32 const   )1449377846U,      (u32 const   )1660644314U,      (u32 const   )2507693243U,      (u32 const   )3877619982U, 
        (u32 const   )1919391157U,      (u32 const   )3411403575U,      (u32 const   )1576814579U,      (u32 const   )1895418902U, 
        (u32 const   )3062514458U,      (u32 const   )2177044617U,      (u32 const   )3838718321U,      (u32 const   )220621883U, 
        (u32 const   )2898697068U,      (u32 const   )2556309632U,      (u32 const   )3666263172U,      (u32 const   )1833131586U, 
        (u32 const   )1768221727U,      (u32 const   )112847870U,      (u32 const   )2225799944U,      (u32 const   )3135475453U, 
        (u32 const   )299065267U,      (u32 const   )0U,      (u32 const   )251106372U,      (u32 const   )4226480774U, 
        (u32 const   )3148623649U,      (u32 const   )1695359480U,      (u32 const   )2925052623U,      (u32 const   )2251643563U, 
        (u32 const   )1630180261U,      (u32 const   )4099067678U,      (u32 const   )1147234298U,      (u32 const   )2272983927U, 
        (u32 const   )4087645500U,      (u32 const   )2807635113U,      (u32 const   )2111807533U,      (u32 const   )1486115954U, 
        (u32 const   )2625209053U,      (u32 const   )3625510183U,      (u32 const   )862904782U,      (u32 const   )133581346U, 
        (u32 const   )2781299978U,      (u32 const   )2156704085U,      (u32 const   )3083199174U,      (u32 const   )4015109812U, 
        (u32 const   )906424911U,      (u32 const   )4291643611U,      (u32 const   )1437743177U,      (u32 const   )1811592636U, 
        (u32 const   )1320239587U,      (u32 const   )2390435089U,      (u32 const   )1790252128U,      (u32 const   )4250079608U, 
        (u32 const   )416448981U,      (u32 const   )3548865250U,      (u32 const   )4075496672U,      (u32 const   )3390718699U, 
        (u32 const   )3695138682U,      (u32 const   )2294468335U,      (u32 const   )2376785262U,      (u32 const   )43932067U, 
        (u32 const   )429727753U,      (u32 const   )2956175588U,      (u32 const   )151117414U,      (u32 const   )208260583U, 
        (u32 const   )263730584U,      (u32 const   )4152571745U,      (u32 const   )4140603069U,      (u32 const   )2025305004U, 
        (u32 const   )1972494231U,      (u32 const   )1229392833U,      (u32 const   )3850473645U,      (u32 const   )2548434200U, 
        (u32 const   )3617640639U,      (u32 const   )1251406782U,      (u32 const   )2678618786U,      (u32 const   )3924319562U, 
        (u32 const   )195004357U,      (u32 const   )1160693286U,      (u32 const   )3160040707U,      (u32 const   )3646375163U, 
        (u32 const   )2568065372U,      (u32 const   )2527700164U,      (u32 const   )1191132761U,      (u32 const   )1278154816U, 
        (u32 const   )2486697319U,      (u32 const   )3812129619U,      (u32 const   )1033467274U,      (u32 const   )3342610128U, 
        (u32 const   )743057977U,      (u32 const   )625734751U,      (u32 const   )603070369U,      (u32 const   )441243766U, 
        (u32 const   )3495336605U,      (u32 const   )3095254878U,      (u32 const   )498766420U,      (u32 const   )955344395U, 
        (u32 const   )2721124136U,      (u32 const   )1580056460U,      (u32 const   )1202757509U,      (u32 const   )347819058U, 
        (u32 const   )2846787821U,      (u32 const   )1356475336U,      (u32 const   )604263811U,      (u32 const   )3950380265U, 
        (u32 const   )3042687845U,      (u32 const   )510356011U,      (u32 const   )2182277366U,      (u32 const   )4047166623U, 
        (u32 const   )3234489586U,      (u32 const   )139362234U,      (u32 const   )2742988532U,      (u32 const   )903285296U, 
        (u32 const   )3989827351U,      (u32 const   )3773399852U,      (u32 const   )817830321U,      (u32 const   )2665995134U, 
        (u32 const   )3903323286U,      (u32 const   )2478946117U,      (u32 const   )4229738660U,      (u32 const   )2997743943U, 
        (u32 const   )278724207U,      (u32 const   )2911451824U,      (u32 const   )2937545491U,      (u32 const   )785675162U, 
        (u32 const   )1855104573U,      (u32 const   )2637570817U,      (u32 const   )4164616953U,      (u32 const   )3329462028U, 
        (u32 const   )3246769454U,      (u32 const   )3364100936U,      (u32 const   )1737717851U,      (u32 const   )2860478610U, 
        (u32 const   )1091138683U,      (u32 const   )3273366669U,      (u32 const   )1907781066U,      (u32 const   )2333292176U, 
        (u32 const   )3508091713U,      (u32 const   )1425906069U,      (u32 const   )3303921327U,      (u32 const   )2114869330U, 
        (u32 const   )991993460U,      (u32 const   )2321323852U,      (u32 const   )4034231619U,      (u32 const   )1507587502U, 
        (u32 const   )3460165814U,      (u32 const   )1393284023U,      (u32 const   )181413401U,      (u32 const   )690108856U};
#line 69 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te1___2[256]  = 
#line 69
  {      (u32 const   )2612257360U,      (u32 const   )107197642U,      (u32 const   )3565544610U,      (u32 const   )35744838U, 
        (u32 const   )2822401855U,      (u32 const   )1973819069U,      (u32 const   )269700358U,      (u32 const   )2622316729U, 
        (u32 const   )1293380276U,      (u32 const   )2390704633U,      (u32 const   )2413983706U,      (u32 const   )3385715720U, 
        (u32 const   )3512338957U,      (u32 const   )2853897081U,      (u32 const   )3548079691U,      (u32 const   )1470226679U, 
        (u32 const   )1526375771U,      (u32 const   )904542629U,      (u32 const   )1942332023U,      (u32 const   )951155721U, 
        (u32 const   )3726648295U,      (u32 const   )3235148072U,      (u32 const   )4051472385U,      (u32 const   )2099428798U, 
        (u32 const   )3421274190U,      (u32 const   )2193175158U,      (u32 const   )3753711044U,      (u32 const   )2496252858U, 
        (u32 const   )3601107172U,      (u32 const   )3691073441U,      (u32 const   )2036360498U,      (u32 const   )134120169U, 
        (u32 const   )1265950334U,      (u32 const   )833151273U,      (u32 const   )1560553394U,      (u32 const   )3538309224U, 
        (u32 const   )864652655U,      (u32 const   )2576518678U,      (u32 const   )3423732391U,      (u32 const   )259664362U, 
        (u32 const   )4146013387U,      (u32 const   )610550400U,      (u32 const   )2799530230U,      (u32 const   )2696856636U, 
        (u32 const   )3844933003U,      (u32 const   )3994416365U,      (u32 const   )3931581537U,      (u32 const   )2283599155U, 
        (u32 const   )637105315U,      (u32 const   )2806007509U,      (u32 const   )455851104U,      (u32 const   )3655246094U, 
        (u32 const   )71489676U,      (u32 const   )3448714372U,      (u32 const   )1348428318U,      (u32 const   )713252169U, 
        (u32 const   )3270843758U,      (u32 const   )1177525202U,      (u32 const   )2092927901U,      (u32 const   )1760435735U, 
        (u32 const   )2657881343U,      (u32 const   )2434147605U,      (u32 const   )2469874003U,      (u32 const   )794604518U, 
        (u32 const   )691996460U,      (u32 const   )1649138002U,      (u32 const   )2164615187U,      (u32 const   )982519887U, 
        (u32 const   )2130956792U,      (u32 const   )1800553586U,      (u32 const   )483737225U,      (u32 const   )597344361U, 
        (u32 const   )340891018U,      (u32 const   )3868286958U,      (u32 const   )98561711U,      (u32 const   )1887041554U, 
        (u32 const   )1054001347U,      (u32 const   )3610885831U,      (u32 const   )3900063783U,      (u32 const   )491260074U, 
        (u32 const   )1791980113U,      (u32 const   )539400716U,      (u32 const   )1319842001U,      (u32 const   )1371690045U, 
        (u32 const   )880217990U,      (u32 const   )2342563670U,      (u32 const   )4230469037U,      (u32 const   )1062207200U, 
        (u32 const   )3115586586U,      (u32 const   )2995578236U,      (u32 const   )3341480897U,      (u32 const   )1490798877U, 
        (u32 const   )1675030385U,      (u32 const   )1446827732U,      (u32 const   )224085420U,      (u32 const   )4114499725U, 
        (u32 const   )305275200U,      (u32 const   )4041319970U,      (u32 const   )4288384968U,      (u32 const   )3628308269U, 
        (u32 const   )365732777U,      (u32 const   )1680371096U,      (u32 const   )1831989432U,      (u32 const   )3962869931U, 
        (u32 const   )1769154612U,      (u32 const   )3782204679U,      (u32 const   )3278383949U,      (u32 const   )2271665369U, 
        (u32 const   )911631296U,      (u32 const   )3663919979U,      (u32 const   )3147135068U,      (u32 const   )250027977U, 
        (u32 const   )3044173717U,      (u32 const   )936072675U,      (u32 const   )4083022919U,      (u32 const   )376502732U, 
        (u32 const   )448170563U,      (u32 const   )2306982672U,      (u32 const   )1910820401U,      (u32 const   )990717548U, 
        (u32 const   )1823262363U,      (u32 const   )2157469232U,      (u32 const   )2228913852U,      (u32 const   )1114456926U, 
        (u32 const   )527000812U,      (u32 const   )4261853675U,      (u32 const   )142912259U,      (u32 const   )4256883598U, 
        (u32 const   )3004289887U,      (u32 const   )0U,      (u32 const   )1141831572U,      (u32 const   )2264656634U, 
        (u32 const   )565947439U,      (u32 const   )4167372065U,      (u32 const   )3484309698U,      (u32 const   )2877699418U, 
        (u32 const   )2774608531U,      (u32 const   )519328463U,      (u32 const   )4198785383U,      (u32 const   )2005367547U, 
        (u32 const   )1022600325U,      (u32 const   )2846316828U,      (u32 const   )763223968U,      (u32 const   )1918407764U, 
        (u32 const   )3718019458U,      (u32 const   )668473573U,      (u32 const   )3459477217U,      (u32 const   )570947146U, 
        (u32 const   )178636613U,      (u32 const   )1434487985U,      (u32 const   )3333932514U,      (u32 const   )3035582902U, 
        (u32 const   )1328940786U,      (u32 const   )3690974536U,      (u32 const   )1230352952U,      (u32 const   )3161193141U, 
        (u32 const   )3813585217U,      (u32 const   )294550309U,      (u32 const   )1617605908U,      (u32 const   )2029867793U, 
        (u32 const   )3575173761U,      (u32 const   )3805513570U,      (u32 const   )3774016292U,      (u32 const   )3955890754U, 
        (u32 const   )2061254487U,      (u32 const   )4018717390U,      (u32 const   )1854778077U,      (u32 const   )2734857817U, 
        (u32 const   )152673568U,      (u32 const   )3836752808U,      (u32 const   )1711866334U,      (u32 const   )3876350413U, 
        (u32 const   )2551167029U,      (u32 const   )1643610935U,      (u32 const   )3187068054U,      (u32 const   )2893592499U, 
        (u32 const   )2541064671U,      (u32 const   )3242805003U,      (u32 const   )2917499280U,      (u32 const   )412608005U, 
        (u32 const   )3218579664U,      (u32 const   )3192559347U,      (u32 const   )2728372346U,      (u32 const   )1256843357U, 
        (u32 const   )3305873287U,      (u32 const   )642068166U,      (u32 const   )62675557U,      (u32 const   )4225324868U, 
        (u32 const   )1553535377U,      (u32 const   )3298208164U,      (u32 const   )1497825086U,      (u32 const   )1078734616U, 
        (u32 const   )1737766909U,      (u32 const   )1407400059U,      (u32 const   )2319292789U,      (u32 const   )3502717998U, 
        (u32 const   )959203882U,      (u32 const   )1596279796U,      (u32 const   )2703487519U,      (u32 const   )1981435096U, 
        (u32 const   )2647676570U,      (u32 const   )1589149143U,      (u32 const   )1411234450U,      (u32 const   )188281190U, 
        (u32 const   )681718031U,      (u32 const   )2354982335U,      (u32 const   )2236067999U,      (u32 const   )840219468U, 
        (u32 const   )3987320456U,      (u32 const   )3360741931U,      (u32 const   )2200175701U,      (u32 const   )3924522500U, 
        (u32 const   )1706384315U,      (u32 const   )723413866U,      (u32 const   )4135719656U,      (u32 const   )2683386588U, 
        (u32 const   )4072720996U,      (u32 const   )3121106559U,      (u32 const   )4104355502U,      (u32 const   )808834826U, 
        (u32 const   )401461231U,      (u32 const   )752937347U,      (u32 const   )2972761881U,      (u32 const   )2124343259U, 
        (u32 const   )2531829756U,      (u32 const   )1167311287U,      (u32 const   )2767985840U,      (u32 const   )1202892273U, 
        (u32 const   )1863359742U,      (u32 const   )2964162874U,      (u32 const   )330241891U,      (u32 const   )2586760307U, 
        (u32 const   )1030656678U,      (u32 const   )27080227U,      (u32 const   )4193794818U,      (u32 const   )214332303U, 
        (u32 const   )784434629U,      (u32 const   )1221100571U,      (u32 const   )1533514616U,      (u32 const   )2460647280U, 
        (u32 const   )2067859828U,      (u32 const   )2378374044U,      (u32 const   )3396449901U,      (u32 const   )2425033526U, 
        (u32 const   )1104222523U,      (u32 const   )2505375129U,      (u32 const   )2948918742U,      (u32 const   )1383992920U, 
        (u32 const   )1950032030U,      (u32 const   )1284136087U,      (u32 const   )1139832189U,      (u32 const   )2925124597U, 
        (u32 const   )3066969584U,      (u32 const   )3075673043U,      (u32 const   )420139046U,      (u32 const   )3089703481U};
#line 135 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te2___2[256]  = 
#line 135
  {      (u32 const   )1352381410U,      (u32 const   )3389416372U,      (u32 const   )2731836900U,      (u32 const   )1174544748U, 
        (u32 const   )1067989615U,      (u32 const   )3178604054U,      (u32 const   )101716813U,      (u32 const   )3114028384U, 
        (u32 const   )3024951146U,      (u32 const   )4186865473U,      (u32 const   )3666862711U,      (u32 const   )147443180U, 
        (u32 const   )231823882U,      (u32 const   )2041191171U,      (u32 const   )1272150886U,      (u32 const   )4149715424U, 
        (u32 const   )1532689061U,      (u32 const   )2771774009U,      (u32 const   )2004075938U,      (u32 const   )154710396U, 
        (u32 const   )3890094115U,      (u32 const   )683725937U,      (u32 const   )32603280U,      (u32 const   )3195871933U, 
        (u32 const   )1321987200U,      (u32 const   )1988278578U,      (u32 const   )3302997269U,      (u32 const   )3130313163U, 
        (u32 const   )3839272072U,      (u32 const   )2715550031U,      (u32 const   )846815333U,      (u32 const   )3909615234U, 
        (u32 const   )2118874334U,      (u32 const   )691120353U,      (u32 const   )2992440359U,      (u32 const   )1758651984U, 
        (u32 const   )1865648525U,      (u32 const   )379163278U,      (u32 const   )2815169026U,      (u32 const   )3926882857U, 
        (u32 const   )3421970212U,      (u32 const   )2149868610U,      (u32 const   )4138130800U,      (u32 const   )1017167556U, 
        (u32 const   )2347052293U,      (u32 const   )3991803380U,      (u32 const   )1642747692U,      (u32 const   )864558325U, 
        (u32 const   )2737174900U,      (u32 const   )3584507974U,      (u32 const   )1612393404U,      (u32 const   )249159329U, 
        (u32 const   )2349089496U,      (u32 const   )2228064052U,      (u32 const   )508583778U,      (u32 const   )1227522909U, 
        (u32 const   )1858270493U,      (u32 const   )3527815067U,      (u32 const   )2642198411U,      (u32 const   )392752670U, 
        (u32 const   )4288572428U,      (u32 const   )361829925U,      (u32 const   )1402156873U,      (u32 const   )3861863603U, 
        (u32 const   )740900615U,      (u32 const   )1382173657U,      (u32 const   )327222632U,      (u32 const   )1329238032U, 
        (u32 const   )4169073617U,      (u32 const   )1919636036U,      (u32 const   )2300368190U,      (u32 const   )1763941056U, 
        (u32 const   )2316587413U,      (u32 const   )4008087903U,      (u32 const   )2936397806U,      (u32 const   )309361144U, 
        (u32 const   )3275674312U,      (u32 const   )3352771006U,      (u32 const   )669546048U,      (u32 const   )2854045704U, 
        (u32 const   )1365954418U,      (u32 const   )203433626U,      (u32 const   )3511593776U,      (u32 const   )1028768340U, 
        (u32 const   )2251585295U,      (u32 const   )1451991215U,      (u32 const   )2918983637U,      (u32 const   )3762245630U, 
        (u32 const   )448377876U,      (u32 const   )2092076261U,      (u32 const   )3251055347U,      (u32 const   )492362697U, 
        (u32 const   )1902368495U,      (u32 const   )3562421462U,      (u32 const   )2886556485U,      (u32 const   )2381659720U, 
        (u32 const   )1074934305U,      (u32 const   )586211750U,      (u32 const   )3372194703U,      (u32 const   )769147799U, 
        (u32 const   )2836778147U,      (u32 const   )2556700781U,      (u32 const   )3094163952U,      (u32 const   )2884383896U, 
        (u32 const   )879325992U,      (u32 const   )132214749U,      (u32 const   )1304651819U,      (u32 const   )3649529564U, 
        (u32 const   )3224786531U,      (u32 const   )1809474299U,      (u32 const   )1555797368U,      (u32 const   )3373197087U, 
        (u32 const   )2511696487U,      (u32 const   )3812084565U,      (u32 const   )1207131644U,      (u32 const   )3424022777U, 
        (u32 const   )1125824138U,      (u32 const   )277447107U,      (u32 const   )829547726U,      (u32 const   )1815809318U, 
        (u32 const   )2607590598U,      (u32 const   )813733982U,      (u32 const   )3162823302U,      (u32 const   )1581411651U, 
        (u32 const   )3961481572U,      (u32 const   )3959293625U,      (u32 const   )50889899U,      (u32 const   )2398993123U, 
        (u32 const   )1605571027U,      (u32 const   )0U,      (u32 const   )2487488247U,      (u32 const   )4203150314U, 
        (u32 const   )790739884U,      (u32 const   )569926925U,      (u32 const   )3268390488U,      (u32 const   )1521190453U, 
        (u32 const   )2477089066U,      (u32 const   )3474912338U,      (u32 const   )1744454753U,      (u32 const   )4218914682U, 
        (u32 const   )2235364260U,      (u32 const   )480880473U,      (u32 const   )2687335903U,      (u32 const   )1416779924U, 
        (u32 const   )2195561593U,      (u32 const   )3844593688U,      (u32 const   )3788387182U,      (u32 const   )1243744246U, 
        (u32 const   )1158325703U,      (u32 const   )2975170700U,      (u32 const   )3804673989U,      (u32 const   )3065311057U, 
        (u32 const   )4065277446U,      (u32 const   )1222377421U,      (u32 const   )944330162U,      (u32 const   )3049024506U, 
        (u32 const   )1105415857U,      (u32 const   )621907579U,      (u32 const   )341863093U,      (u32 const   )293141843U, 
        (u32 const   )2178226386U,      (u32 const   )1659032455U,      (u32 const   )618722027U,      (u32 const   )1122748954U, 
        (u32 const   )1467669567U,      (u32 const   )3471804610U,      (u32 const   )3715009962U,      (u32 const   )1503855262U, 
        (u32 const   )537467293U,      (u32 const   )2833559603U,      (u32 const   )3731228929U,      (u32 const   )3454471273U, 
        (u32 const   )899157944U,      (u32 const   )929167235U,      (u32 const   )2529031884U,      (u32 const   )3014424759U, 
        (u32 const   )3751245201U,      (u32 const   )197216583U,      (u32 const   )2427315585U,      (u32 const   )85497830U, 
        (u32 const   )3502233504U,      (u32 const   )4089334422U,      (u32 const   )2057478056U,      (u32 const   )1565190632U, 
        (u32 const   )2277837727U,      (u32 const   )3324396846U,      (u32 const   )1694743642U,      (u32 const   )1157355863U, 
        (u32 const   )2438764817U,      (u32 const   )2764347049U,      (u32 const   )1046038271U,      (u32 const   )406866991U, 
        (u32 const   )4251423799U,      (u32 const   )2069095224U,      (u32 const   )1971994009U,      (u32 const   )785434428U, 
        (u32 const   )708389962U,      (u32 const   )4099876171U,      (u32 const   )530654194U,      (u32 const   )3631618636U, 
        (u32 const   )2594033750U,      (u32 const   )3613309053U,      (u32 const   )2454986170U,      (u32 const   )1712011505U, 
        (u32 const   )254321201U,      (u32 const   )3213647405U,      (u32 const   )2676311984U,      (u32 const   )1278350523U, 
        (u32 const   )2297276846U,      (u32 const   )734548186U,      (u32 const   )1434657796U,      (u32 const   )82439030U, 
        (u32 const   )3144004955U,      (u32 const   )1781210731U,      (u32 const   )3908469266U,      (u32 const   )3701469498U, 
        (u32 const   )1693630666U,      (u32 const   )2142898254U,      (u32 const   )2935268222U,      (u32 const   )170931671U, 
        (u32 const   )4011322831U,      (u32 const   )2200756457U,      (u32 const   )431042751U,      (u32 const   )3682508519U, 
        (u32 const   )4237748391U,      (u32 const   )3074790337U,      (u32 const   )2963602460U,      (u32 const   )4048007853U, 
        (u32 const   )4268691612U,      (u32 const   )984657289U,      (u32 const   )1662234391U,      (u32 const   )1939484372U, 
        (u32 const   )2789043858U,      (u32 const   )587308342U,      (u32 const   )49936443U,      (u32 const   )2399979123U, 
        (u32 const   )3308175749U,      (u32 const   )457754756U,      (u32 const   )2019256211U,      (u32 const   )1888660095U, 
        (u32 const   )1954234633U,      (u32 const   )2626536219U,      (u32 const   )1841983926U,      (u32 const   )915442451U, 
        (u32 const   )994169113U,      (u32 const   )2576700669U,      (u32 const   )3601843437U,      (u32 const   )1481801230U, 
        (u32 const   )2658417440U,      (u32 const   )2538375772U,      (u32 const   )2101604469U,      (u32 const   )4121844187U, 
        (u32 const   )4038512189U,      (u32 const   )3552006923U,      (u32 const   )639175376U,      (u32 const   )968370466U};
#line 201 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te3___2[256]  = 
#line 201
  {      (u32 const   )3796933555U,      (u32 const   )3033138787U,      (u32 const   )3835876485U,      (u32 const   )1816527393U, 
        (u32 const   )1866442810U,      (u32 const   )381515174U,      (u32 const   )1292242963U,      (u32 const   )1622776909U, 
        (u32 const   )1790201111U,      (u32 const   )1106873983U,      (u32 const   )2010812386U,      (u32 const   )3959998925U, 
        (u32 const   )168677722U,      (u32 const   )58305051U,      (u32 const   )1716245371U,      (u32 const   )3774306209U, 
        (u32 const   )2774227706U,      (u32 const   )967128554U,      (u32 const   )2725737413U,      (u32 const   )2080979121U, 
        (u32 const   )602398240U,      (u32 const   )1898496212U,      (u32 const   )2416046460U,      (u32 const   )3183377698U, 
        (u32 const   )2152647660U,      (u32 const   )846627513U,      (u32 const   )365223869U,      (u32 const   )3418002633U, 
        (u32 const   )2296698532U,      (u32 const   )1336007681U,      (u32 const   )1697806688U,      (u32 const   )2196310014U, 
        (u32 const   )3732818804U,      (u32 const   )3777573288U,      (u32 const   )666000644U,      (u32 const   )1349047014U, 
        (u32 const   )2372875145U,      (u32 const   )2383845778U,      (u32 const   )44551186U,      (u32 const   )703205242U, 
        (u32 const   )617346847U,      (u32 const   )1115694180U,      (u32 const   )1895212765U,      (u32 const   )3292307646U, 
        (u32 const   )93054253U,      (u32 const   )4109233685U,      (u32 const   )744614487U,      (u32 const   )4113795100U, 
        (u32 const   )1956849145U,      (u32 const   )1188407104U,      (u32 const   )3160415019U,      (u32 const   )2702105054U, 
        (u32 const   )3633054786U,      (u32 const   )881118607U,      (u32 const   )1646153823U,      (u32 const   )1565076099U, 
        (u32 const   )493798133U,      (u32 const   )2614249007U,      (u32 const   )2342354111U,      (u32 const   )504850670U, 
        (u32 const   )218078828U,      (u32 const   )622170390U,      (u32 const   )1230213943U,      (u32 const   )3018207068U, 
        (u32 const   )120334655U,      (u32 const   )3646054987U,      (u32 const   )1746108677U,      (u32 const   )273627792U, 
        (u32 const   )3522723587U,      (u32 const   )1148349266U,      (u32 const   )1049173205U,      (u32 const   )3228115866U, 
        (u32 const   )2508854353U,      (u32 const   )1609492113U,      (u32 const   )4004447711U,      (u32 const   )4161958009U, 
        (u32 const   )3368238802U,      (u32 const   )3200767801U,      (u32 const   )1076357238U,      (u32 const   )145366344U, 
        (u32 const   )1917938383U,      (u32 const   )2584485926U,      (u32 const   )819023531U,      (u32 const   )1413304770U, 
        (u32 const   )260453495U,      (u32 const   )2941684640U,      (u32 const   )3584949287U,      (u32 const   )4276109135U, 
        (u32 const   )337295796U,      (u32 const   )3850154636U,      (u32 const   )4089562922U,      (u32 const   )3374143707U, 
        (u32 const   )4017185750U,      (u32 const   )3604239932U,      (u32 const   )1168903515U,      (u32 const   )1217262910U, 
        (u32 const   )557847090U,      (u32 const   )2787307745U,      (u32 const   )2412314523U,      (u32 const   )2536364099U, 
        (u32 const   )2745767372U,      (u32 const   )1838703656U,      (u32 const   )4038618417U,      (u32 const   )2561403956U, 
        (u32 const   )674523507U,      (u32 const   )3708281199U,      (u32 const   )726516584U,      (u32 const   )3705243494U, 
        (u32 const   )1673541206U,      (u32 const   )4218149474U,      (u32 const   )2019343253U,      (u32 const   )533270247U, 
        (u32 const   )1737864562U,      (u32 const   )1440954315U,      (u32 const   )4232573789U,      (u32 const   )4190901872U, 
        (u32 const   )2319653558U,      (u32 const   )3272640897U,      (u32 const   )3459346916U,      (u32 const   )644627213U, 
        (u32 const   )3332074668U,      (u32 const   )1580236952U,      (u32 const   )2260501722U,      (u32 const   )1130250861U, 
        (u32 const   )1693196137U,      (u32 const   )3119250950U,      (u32 const   )2869102724U,      (u32 const   )3817799098U, 
        (u32 const   )3546264337U,      (u32 const   )0U,      (u32 const   )4153689102U,      (u32 const   )3942287099U, 
        (u32 const   )2888769979U,      (u32 const   )220330085U,      (u32 const   )1489162158U,      (u32 const   )895134598U, 
        (u32 const   )714319201U,      (u32 const   )1389305588U,      (u32 const   )1634204228U,      (u32 const   )2063300487U, 
        (u32 const   )2760195315U,      (u32 const   )1495050663U,      (u32 const   )3751816573U,      (u32 const   )2488562264U, 
        (u32 const   )2038619548U,      (u32 const   )417671128U,      (u32 const   )1860292147U,      (u32 const   )4132053511U, 
        (u32 const   )3343190693U,      (u32 const   )2360432000U,      (u32 const   )3319973559U,      (u32 const   )1370928367U, 
        (u32 const   )116543286U,      (u32 const   )3444104191U,      (u32 const   )2990033237U,      (u32 const   )4206214251U, 
        (u32 const   )2973885262U,      (u32 const   )2066026894U,      (u32 const   )3038011498U,      (u32 const   )1393654013U, 
        (u32 const   )3531724056U,      (u32 const   )2271404755U,      (u32 const   )3945062642U,      (u32 const   )440593354U, 
        (u32 const   )1062697692U,      (u32 const   )3268341640U,      (u32 const   )2866638477U,      (u32 const   )2656674562U, 
        (u32 const   )2636122393U,      (u32 const   )866706608U,      (u32 const   )31352329U,      (u32 const   )1775101708U, 
        (u32 const   )3090520079U,      (u32 const   )2201444855U,      (u32 const   )3432431094U,      (u32 const   )3082005624U, 
        (u32 const   )2447349621U,      (u32 const   )1191952713U,      (u32 const   )2173742565U,      (u32 const   )3859093655U, 
        (u32 const   )2698035159U,      (u32 const   )2532556362U,      (u32 const   )2826609311U,      (u32 const   )3898428137U, 
        (u32 const   )2676475147U,      (u32 const   )784737861U,      (u32 const   )1516569532U,      (u32 const   )1464138713U, 
        (u32 const   )294739097U,      (u32 const   )2846147734U,      (u32 const   )4282276166U,      (u32 const   )790118476U, 
        (u32 const   )939354004U,      (u32 const   )947606499U,      (u32 const   )2574617149U,      (u32 const   )1009701063U, 
        (u32 const   )1244281132U,      (u32 const   )1274306341U,      (u32 const   )4062159139U,      (u32 const   )1289254426U, 
        (u32 const   )1452973520U,      (u32 const   )2111266488U,      (u32 const   )3130151965U,      (u32 const   )4049996600U, 
        (u32 const   )823077026U,      (u32 const   )767528030U,      (u32 const   )2963244359U,      (u32 const   )3142332948U, 
        (u32 const   )2928209321U,      (u32 const   )3660302416U,      (u32 const   )72712996U,      (u32 const   )1980033515U, 
        (u32 const   )1539007925U,      (u32 const   )1802119966U,      (u32 const   )317257346U,      (u32 const   )987537393U, 
        (u32 const   )3395613376U,      (u32 const   )1316993544U,      (u32 const   )2125395107U,      (u32 const   )3607769141U, 
        (u32 const   )3488552941U,      (u32 const   )3917688032U,      (u32 const   )3206132016U,      (u32 const   )3889921694U, 
        (u32 const   )2818348776U,      (u32 const   )3250013587U,      (u32 const   )481338620U,      (u32 const   )2918270898U, 
        (u32 const   )2633920272U,      (u32 const   )2302324909U,      (u32 const   )392369071U,      (u32 const   )3564345902U, 
        (u32 const   )2460368238U,      (u32 const   )908263837U,      (u32 const   )990050808U,      (u32 const   )1938754758U, 
        (u32 const   )2244292289U,      (u32 const   )2216380616U,      (u32 const   )2474138471U,      (u32 const   )2138084010U, 
        (u32 const   )158628673U,      (u32 const   )463244739U,      (u32 const   )3060648561U,      (u32 const   )322343051U, 
        (u32 const   )423313873U,      (u32 const   )4254700884U,      (u32 const   )3990269892U,      (u32 const   )240669310U, 
        (u32 const   )547255355U,      (u32 const   )1553419402U,      (u32 const   )1971143664U,      (u32 const   )3690311257U, 
        (u32 const   )1039185614U,      (u32 const   )198424403U,      (u32 const   )3492157706U,      (u32 const   )574208041U};
#line 267 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-32bit-tables.h"
static u32 const   Te4___2[256]  = 
#line 267
  {      (u32 const   )404232216U,      (u32 const   )589505315U,      (u32 const   )3334915782U,      (u32 const   )3907578088U, 
        (u32 const   )2273806215U,      (u32 const   )3099113656U,      (u32 const   )16843009U,      (u32 const   )1330597711U, 
        (u32 const   )909522486U,      (u32 const   )2795939494U,      (u32 const   )3537031890U,      (u32 const   )4126537205U, 
        (u32 const   )2038004089U,      (u32 const   )1869573999U,      (u32 const   )2442236305U,      (u32 const   )1381126738U, 
        (u32 const   )1616928864U,      (u32 const   )3166485692U,      (u32 const   )2610666395U,      (u32 const   )2391707278U, 
        (u32 const   )2745410467U,      (u32 const   )202116108U,      (u32 const   )2071690107U,      (u32 const   )892679477U, 
        (u32 const   )488447261U,      (u32 const   )3772834016U,      (u32 const   )3621246935U,      (u32 const   )3267543746U, 
        (u32 const   )774778414U,      (u32 const   )1263225675U,      (u32 const   )4278124286U,      (u32 const   )1465341783U, 
        (u32 const   )353703189U,      (u32 const   )2004318071U,      (u32 const   )926365495U,      (u32 const   )3857049061U, 
        (u32 const   )2678038431U,      (u32 const   )4042322160U,      (u32 const   )1246382666U,      (u32 const   )3671775962U, 
        (u32 const   )1482184792U,      (u32 const   )3385444809U,      (u32 const   )690563369U,      (u32 const   )168430090U, 
        (u32 const   )2981212593U,      (u32 const   )2694881440U,      (u32 const   )1802201963U,      (u32 const   )2240120197U, 
        (u32 const   )3183328701U,      (u32 const   )1566399837U,      (u32 const   )269488144U,      (u32 const   )4109694196U, 
        (u32 const   )3419130827U,      (u32 const   )1044266558U,      (u32 const   )84215045U,      (u32 const   )1734829927U, 
        (u32 const   )3840206052U,      (u32 const   )656877351U,      (u32 const   )1094795585U,      (u32 const   )2341178251U, 
        (u32 const   )2812782503U,      (u32 const   )2105376125U,      (u32 const   )2509608341U,      (u32 const   )3638089944U, 
        (u32 const   )4227595259U,      (u32 const   )4008636142U,      (u32 const   )2088533116U,      (u32 const   )1717986918U, 
        (u32 const   )3722304989U,      (u32 const   )387389207U,      (u32 const   )1195853639U,      (u32 const   )2661195422U, 
        (u32 const   )3402287818U,      (u32 const   )757935405U,      (u32 const   )3217014719U,      (u32 const   )117901063U, 
        (u32 const   )2913840557U,      (u32 const   )1515870810U,      (u32 const   )2206434179U,      (u32 const   )858993459U, 
        (u32 const   )1667457891U,      (u32 const   )33686018U,      (u32 const   )2863311530U,      (u32 const   )1903260017U, 
        (u32 const   )3368601800U,      (u32 const   )421075225U,      (u32 const   )1229539657U,      (u32 const   )3654932953U, 
        (u32 const   )4076008178U,      (u32 const   )3823363043U,      (u32 const   )1532713819U,      (u32 const   )2290649224U, 
        (u32 const   )2593823386U,      (u32 const   )640034342U,      (u32 const   )842150450U,      (u32 const   )2964369584U, 
        (u32 const   )3924421097U,      (u32 const   )252645135U,      (u32 const   )3587560917U,      (u32 const   )2155905152U, 
        (u32 const   )3200171710U,      (u32 const   )3452816845U,      (u32 const   )875836468U,      (u32 const   )1212696648U, 
        (u32 const   )4294967295U,      (u32 const   )2054847098U,      (u32 const   )2425393296U,      (u32 const   )1600085855U, 
        (u32 const   )538976288U,      (u32 const   )1751672936U,      (u32 const   )437918234U,      (u32 const   )2930683566U, 
        (u32 const   )3031741620U,      (u32 const   )1414812756U,      (u32 const   )2475922323U,      (u32 const   )572662306U, 
        (u32 const   )1684300900U,      (u32 const   )4059165169U,      (u32 const   )1936946035U,      (u32 const   )303174162U, 
        (u32 const   )1077952576U,      (u32 const   )134744072U,      (u32 const   )3284386755U,      (u32 const   )3974950124U, 
        (u32 const   )3688618971U,      (u32 const   )2711724449U,      (u32 const   )2374864269U,      (u32 const   )1027423549U, 
        (u32 const   )2543294359U,      (u32 const   )0U,      (u32 const   )3486502863U,      (u32 const   )724249387U, 
        (u32 const   )1987475062U,      (u32 const   )2189591170U,      (u32 const   )3604403926U,      (u32 const   )454761243U, 
        (u32 const   )3048584629U,      (u32 const   )2947526575U,      (u32 const   )1785358954U,      (u32 const   )1347440720U, 
        (u32 const   )1162167621U,      (u32 const   )4092851187U,      (u32 const   )808464432U,      (u32 const   )4025479151U, 
        (u32 const   )1061109567U,      (u32 const   )1431655765U,      (u32 const   )2728567458U,      (u32 const   )3941264106U, 
        (u32 const   )1701143909U,      (u32 const   )3132799674U,      (u32 const   )791621423U,      (u32 const   )3233857728U, 
        (u32 const   )3739147998U,      (u32 const   )471604252U,      (u32 const   )4261281277U,      (u32 const   )1296911693U, 
        (u32 const   )2459079314U,      (u32 const   )1970632053U,      (u32 const   )101058054U,      (u32 const   )2324335242U, 
        (u32 const   )2998055602U,      (u32 const   )3873892070U,      (u32 const   )235802126U,      (u32 const   )522133279U, 
        (u32 const   )1650614882U,      (u32 const   )3570717908U,      (u32 const   )2829625512U,      (u32 const   )2526451350U, 
        (u32 const   )4193909241U,      (u32 const   )3318072773U,      (u32 const   )623191333U,      (u32 const   )1499027801U, 
        (u32 const   )2223277188U,      (u32 const   )1920103026U,      (u32 const   )960051513U,      (u32 const   )1280068684U, 
        (u32 const   )1583242846U,      (u32 const   )2021161080U,      (u32 const   )943208504U,      (u32 const   )2358021260U, 
        (u32 const   )3520188881U,      (u32 const   )2779096485U,      (u32 const   )3806520034U,      (u32 const   )1633771873U, 
        (u32 const   )3014898611U,      (u32 const   )555819297U,      (u32 const   )2627509404U,      (u32 const   )505290270U, 
        (u32 const   )1128481603U,      (u32 const   )3351758791U,      (u32 const   )4244438268U,      (u32 const   )67372036U, 
        (u32 const   )1364283729U,      (u32 const   )2576980377U,      (u32 const   )1835887981U,      (u32 const   )218959117U, 
        (u32 const   )4210752250U,      (u32 const   )3755991007U,      (u32 const   )2122219134U,      (u32 const   )606348324U, 
        (u32 const   )993737531U,      (u32 const   )2880154539U,      (u32 const   )3469659854U,      (u32 const   )286331153U, 
        (u32 const   )2408550287U,      (u32 const   )1313754702U,      (u32 const   )3082270647U,      (u32 const   )3958107115U, 
        (u32 const   )1010580540U,      (u32 const   )2172748161U,      (u32 const   )2492765332U,      (u32 const   )4160223223U, 
        (u32 const   )3115956665U,      (u32 const   )320017171U,      (u32 const   )741092396U,      (u32 const   )3553874899U, 
        (u32 const   )3890735079U,      (u32 const   )1852730990U,      (u32 const   )3301229764U,      (u32 const   )50529027U, 
        (u32 const   )1448498774U,      (u32 const   )1145324612U,      (u32 const   )2139062143U,      (u32 const   )2846468521U, 
        (u32 const   )707406378U,      (u32 const   )3149642683U,      (u32 const   )3250700737U,      (u32 const   )1397969747U, 
        (u32 const   )3705461980U,      (u32 const   )185273099U,      (u32 const   )2644352413U,      (u32 const   )1819044972U, 
        (u32 const   )825307441U,      (u32 const   )1953789044U,      (u32 const   )4143380214U,      (u32 const   )1179010630U, 
        (u32 const   )2896997548U,      (u32 const   )2307492233U,      (u32 const   )336860180U,      (u32 const   )3789677025U, 
        (u32 const   )370546198U,      (u32 const   )976894522U,      (u32 const   )1768515945U,      (u32 const   )151587081U, 
        (u32 const   )1886417008U,      (u32 const   )3065427638U,      (u32 const   )3503345872U,      (u32 const   )3991793133U, 
        (u32 const   )3435973836U,      (u32 const   )1111638594U,      (u32 const   )2560137368U,      (u32 const   )2762253476U, 
        (u32 const   )673720360U,      (u32 const   )1549556828U,      (u32 const   )4177066232U,      (u32 const   )2256963206U};
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
static u32 const   rcon___2[10]  = 
#line 53 "/home/wheatley/newnew/temp/maradns-2.0.09/rng/rng-alg-fst.c"
  {      (u32 const   )16777216,      (u32 const   )33554432,      (u32 const   )67108864,      (u32 const   )134217728, 
        (u32 const   )268435456,      (u32 const   )536870912,      (u32 const   )1073741824,      (u32 const   )2147483648U, 
        (u32 const   )452984832,      (u32 const   )905969664};
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___4  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___4  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___4  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___4  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___4  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___4  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___4  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___4  =    (js_file *)0;
#line 49 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *dotq___2  =    (js_string *)0;
#line 50 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *numdotq___2  =    (js_string *)0;
#line 51 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static js_string *slashq___2  =    (js_string *)0;
#line 52 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseIpAcl.c"
static uint32_t masks___2[33]  = 
#line 52
  {      (uint32_t )0,      2147483648U,      3221225472U,      3758096384U, 
        4026531840U,      4160749568U,      4227858432U,      4261412864U, 
        4278190080U,      4286578688U,      4290772992U,      4292870144U, 
        4293918720U,      4294443008U,      4294705152U,      4294836224U, 
        4294901760U,      4294934528U,      4294950912U,      4294959104U, 
        4294963200U,      4294965248U,      4294966272U,      4294966784U, 
        4294967040U,      4294967168U,      4294967232U,      4294967264U, 
        4294967280U,      4294967288U,      4294967292U,      4294967294U, 
        4294967295U};
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *quotes___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *alphanumeric___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *numbers___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *equals___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *plusq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *hashq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *bslashq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *allq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *leftq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *rightq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *cleftq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *crightq___5  =    (js_string *)0;
#line 633 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *blankq___5  =    (js_string *)0;
#line 1055 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *line___5  =    (js_string *)0;
#line 1056 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *var___5  =    (js_string *)0;
#line 1057 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *key___5  =    (js_string *)0;
#line 1058 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *value___5  =    (js_string *)0;
#line 1059 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_string *tstr___5  =    (js_string *)0;
#line 1067 "/home/wheatley/newnew/temp/maradns-2.0.09/parse/ParseMaraRc.c"
static js_file *file___5  =    (js_file *)0;
