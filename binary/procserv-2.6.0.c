/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stddef.h"
typedef unsigned long size_t;
#line 40 "/usr/lib/gcc/x86_64-linux-gnu/4.8/include/stdarg.h"
typedef __builtin_va_list __gnuc_va_list;
#line 79 "/usr/include/stdio.h"
typedef __gnuc_va_list va_list;
#line 63 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct telnet_t;
#line 63 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
typedef struct telnet_t telnet_t;
#line 66
union telnet_event_t;
#line 66 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
typedef union telnet_event_t telnet_event_t;
#line 69
struct telnet_telopt_t;
#line 69 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
typedef struct telnet_telopt_t telnet_telopt_t;
#line 184
enum telnet_error_t {
    TELNET_EOK = 0,
    TELNET_EBADVAL = 1,
    TELNET_ENOMEM = 2,
    TELNET_EOVERFLOW = 3,
    TELNET_EPROTOCOL = 4,
    TELNET_ECOMPRESS = 5
} ;
#line 192 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
typedef enum telnet_error_t telnet_error_t;
#line 197
enum telnet_event_type_t {
    TELNET_EV_DATA = 0,
    TELNET_EV_SEND = 1,
    TELNET_EV_IAC = 2,
    TELNET_EV_WILL = 3,
    TELNET_EV_WONT = 4,
    TELNET_EV_DO = 5,
    TELNET_EV_DONT = 6,
    TELNET_EV_SUBNEGOTIATION = 7,
    TELNET_EV_COMPRESS = 8,
    TELNET_EV_ZMP = 9,
    TELNET_EV_TTYPE = 10,
    TELNET_EV_ENVIRON = 11,
    TELNET_EV_MSSP = 12,
    TELNET_EV_WARNING = 13,
    TELNET_EV_ERROR = 14
} ;
#line 219 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct telnet_environ_t {
   unsigned char type ;
   char *var ;
   char *value ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct data_t {
   enum telnet_event_type_t _type ;
   char const   *buffer ;
   size_t size ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct error_t {
   enum telnet_event_type_t _type ;
   char const   *file ;
   char const   *func ;
   char const   *msg ;
   int line ;
   telnet_error_t errcode ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct iac_t {
   enum telnet_event_type_t _type ;
   unsigned char cmd ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct negotiate_t {
   enum telnet_event_type_t _type ;
   unsigned char telopt ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct subnegotiate_t {
   enum telnet_event_type_t _type ;
   char const   *buffer ;
   size_t size ;
   unsigned char telopt ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct zmp_t {
   enum telnet_event_type_t _type ;
   char const   **argv ;
   size_t argc ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct ttype_t {
   enum telnet_event_type_t _type ;
   unsigned char cmd ;
   char const   *name ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct compress_t {
   enum telnet_event_type_t _type ;
   unsigned char state ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct environ_t {
   enum telnet_event_type_t _type ;
   struct telnet_environ_t  const  *values ;
   size_t size ;
   unsigned char cmd ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct mssp_t {
   enum telnet_event_type_t _type ;
   struct telnet_environ_t  const  *values ;
   size_t size ;
};
#line 228 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
union telnet_event_t {
   enum telnet_event_type_t type ;
   struct data_t data ;
   struct error_t error ;
   struct iac_t iac ;
   struct negotiate_t neg ;
   struct subnegotiate_t sub ;
   struct zmp_t zmp ;
   struct ttype_t ttype ;
   struct compress_t compress ;
   struct environ_t environ ;
   struct mssp_t mssp ;
};
#line 351 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
struct telnet_telopt_t {
   short telopt ;
   unsigned char us ;
   unsigned char him ;
};
#line 360
struct telnet_t;
#line 53 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
enum telnet_state_t {
    TELNET_STATE_DATA = 0,
    TELNET_STATE_IAC = 1,
    TELNET_STATE_WILL = 2,
    TELNET_STATE_WONT = 3,
    TELNET_STATE_DO = 4,
    TELNET_STATE_DONT = 5,
    TELNET_STATE_SB = 6,
    TELNET_STATE_SB_DATA = 7,
    TELNET_STATE_SB_DATA_IAC = 8
} ;
#line 67
struct telnet_rfc1143_t;
#line 67 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
struct telnet_t {
   void *ud ;
   telnet_telopt_t const   *telopts ;
   void (*eh)(telnet_t *telnet , telnet_event_t *event , void *user_data ) ;
   struct telnet_rfc1143_t *q ;
   char *buffer ;
   size_t buffer_size ;
   size_t buffer_pos ;
   enum telnet_state_t state ;
   unsigned char flags ;
   unsigned char sb_telopt ;
   unsigned char q_size ;
};
#line 97 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
struct telnet_rfc1143_t {
   unsigned char telopt ;
   unsigned char state ;
};
#line 97 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
typedef struct telnet_rfc1143_t telnet_rfc1143_t;
/* compiler builtin: 
   void __builtin_va_arg(__builtin_va_list  , unsigned long  , void * ) ;  */
/* compiler builtin: 
   void __builtin_va_start(__builtin_va_list  ) ;  */
/* compiler builtin: 
   void __builtin_va_end(__builtin_va_list  ) ;  */
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 468
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) calloc)(size_t __nmemb ,
                                                                               size_t __size )  __attribute__((__malloc__)) ;
#line 480
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__,
__leaf__)) realloc)(void *__ptr , size_t __size ) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 66
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memset)(void *__s ,
                                                                                               int __c ,
                                                                                               size_t __n ) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 413
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) strerror)(int __errnum ) ;
#line 390 "/usr/include/stdio.h"
extern  __attribute__((__nothrow__)) int ( /* format attribute */  vsnprintf)(char * __restrict  __s ,
                                                                              size_t __maxlen ,
                                                                              char const   * __restrict  __format ,
                                                                              __gnuc_va_list __arg ) ;
#line 50 "/usr/include/x86_64-linux-gnu/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 375 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.h"
telnet_t *telnet_init(telnet_telopt_t const   *telopts , void (*eh)(telnet_t *telnet ,
                                                                    telnet_event_t *event ,
                                                                    void *user_data ) ,
                      unsigned char flags , void *user_data ) ;
#line 387
void telnet_free(telnet_t *telnet ) ;
#line 401
void telnet_recv(telnet_t *telnet , char const   *buffer , size_t size ) ;
#line 410
void telnet_iac(telnet_t *telnet , unsigned char cmd ) ;
#line 423
void telnet_negotiate(telnet_t *telnet , unsigned char cmd , unsigned char telopt ) ;
#line 433
void telnet_send(telnet_t *telnet , char const   *buffer , size_t size ) ;
#line 446
void telnet_begin_sb(telnet_t *telnet , unsigned char telopt ) ;
#line 472
void telnet_subnegotiation(telnet_t *telnet , unsigned char telopt , char const   *buffer ,
                           size_t size ) ;
#line 487
void telnet_begin_compress2(telnet_t *telnet ) ;
#line 503
int ( /* format attribute */  telnet_printf)(telnet_t *telnet , char const   *fmt 
                                             , ...) ;
#line 511
int telnet_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) ;
#line 524
int ( /* format attribute */  telnet_raw_printf)(telnet_t *telnet , char const   *fmt 
                                                 , ...) ;
#line 532
int telnet_raw_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) ;
#line 547
void telnet_begin_newenviron(telnet_t *telnet , unsigned char cmd ) ;
#line 560
void telnet_newenviron_value(telnet_t *telnet , unsigned char type , char const   *string ) ;
#line 580
void telnet_ttype_send(telnet_t *telnet ) ;
#line 612
void telnet_ttype_is(telnet_t *telnet , char const   *ttype ) ;
#line 621
void telnet_send_zmp(telnet_t *telnet , size_t argc , char const   **argv ) ;
#line 631
void telnet_send_zmpv(telnet_t *telnet  , ...)  __attribute__((__sentinel__)) ;
#line 638
void telnet_send_vzmpv(telnet_t *telnet , va_list va ) ;
#line 646
void telnet_begin_zmp(telnet_t *telnet , char const   *cmd ) ;
#line 654
void telnet_zmp_arg(telnet_t *telnet , char const   *arg ) ;
#line 111 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static size_t const   _buffer_sizes[5]  = {      (size_t const   )0,      (size_t const   )512,      (size_t const   )2048,      (size_t const   )8192, 
        (size_t const   )16384};
#line 112 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static unsigned long const   _buffer_sizes_count  =    (size_t const   )(sizeof(_buffer_sizes) / sizeof(_buffer_sizes[0]));
#line 116 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static telnet_error_t _error(telnet_t *telnet , unsigned int line , char const   *func ,
                             telnet_error_t err , int fatal , char const   *fmt  , ...) 
{ 
  telnet_event_t ev ;
  char buffer[512] ;
  va_list va ;

  {
  {
#line 124
  __builtin_va_start(va, fmt);
#line 125
  vsnprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)fmt,
            va);
#line 126
  __builtin_va_end(va);
  }
#line 129
  if (fatal) {
#line 129
    ev.type = (enum telnet_event_type_t )14;
  } else {
#line 129
    ev.type = (enum telnet_event_type_t )13;
  }
  {
#line 130
  ev.error.file = "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c";
#line 131
  ev.error.func = func;
#line 132
  ev.error.line = (int )line;
#line 133
  ev.error.msg = (char const   *)(buffer);
#line 134
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 136
  return (err);
}
}
#line 183 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static void _send(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 
  telnet_event_t ev ;

  {
  {
#line 227
  ev.type = (enum telnet_event_type_t )1;
#line 228
  ev.data.buffer = buffer;
#line 229
  ev.data.size = size;
#line 230
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 231
  return;
}
}
#line 240 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
__inline static int _check_telopt(telnet_t *telnet , unsigned char telopt , int us ) 
{ 
  int i ;

  {
#line 245
  if ((unsigned long )telnet->telopts == (unsigned long )((telnet_telopt_t const   *)0)) {
#line 246
    return (0);
  }
#line 249
  i = 0;
  {
#line 249
  while (1) {
    while_continue: /* CIL Label */ ;
#line 249
    if (! ((int const   )(telnet->telopts + i)->telopt != -1)) {
#line 249
      goto while_break;
    }
#line 250
    if ((int const   )(telnet->telopts + i)->telopt == (int const   )telopt) {
#line 251
      if (us) {
#line 251
        if ((int const   )(telnet->telopts + i)->us == 251) {
#line 252
          return (1);
        } else {
#line 251
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 253
      if (! us) {
#line 253
        if ((int const   )(telnet->telopts + i)->him == 253) {
#line 254
          return (1);
        } else {
#line 256
          return (0);
        }
      } else {
#line 256
        return (0);
      }
    }
#line 249
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 261
  return (0);
}
}
#line 265 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
__inline static telnet_rfc1143_t _get_rfc1143(telnet_t *telnet , unsigned char telopt ) 
{ 
  telnet_rfc1143_t empty ;
  int i ;

  {
#line 271
  i = 0;
  {
#line 271
  while (1) {
    while_continue: /* CIL Label */ ;
#line 271
    if (! (i != (int )telnet->q_size)) {
#line 271
      goto while_break;
    }
#line 272
    if ((int )(telnet->q + i)->telopt == (int )telopt) {
#line 273
      return (*(telnet->q + i));
    }
#line 271
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 278
  empty.telopt = telopt;
#line 279
  empty.state = (unsigned char)0;
#line 280
  return (empty);
}
}
#line 284 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
__inline static void _set_rfc1143(telnet_t *telnet , unsigned char telopt , char us ,
                                  char him ) 
{ 
  telnet_rfc1143_t *qtmp ;
  int i ;
  int *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;

  {
#line 290
  i = 0;
  {
#line 290
  while (1) {
    while_continue: /* CIL Label */ ;
#line 290
    if (! (i != (int )telnet->q_size)) {
#line 290
      goto while_break;
    }
#line 291
    if ((int )(telnet->q + i)->telopt == (int )telopt) {
#line 292
      (telnet->q + i)->state = (unsigned char )((int )us | ((int )him << 4));
#line 293
      return;
    }
#line 290
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 303
  tmp___1 = realloc((void *)telnet->q, sizeof(telnet_rfc1143_t ) * (unsigned long )((int )telnet->q_size + 4));
#line 303
  qtmp = (telnet_rfc1143_t *)tmp___1;
  }
#line 303
  if ((unsigned long )qtmp == (unsigned long )((telnet_rfc1143_t *)0)) {
    {
#line 305
    tmp = __errno_location();
#line 305
    tmp___0 = strerror(*tmp);
#line 305
    _error(telnet, 305U, "_set_rfc1143", (telnet_error_t )2, 0, "realloc() failed: %s",
           tmp___0);
    }
#line 307
    return;
  }
  {
#line 309
  memset((void *)(qtmp + telnet->q_size), 0, sizeof(telnet_rfc1143_t ) * 4UL);
#line 310
  telnet->q = qtmp;
#line 311
  (telnet->q + telnet->q_size)->telopt = telopt;
#line 312
  (telnet->q + telnet->q_size)->state = (unsigned char )((int )us | ((int )him << 4));
#line 313
  telnet->q_size = (unsigned char )((int )telnet->q_size + 4);
  }
#line 314
  return;
}
}
#line 317 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
__inline static void _send_negotiate(telnet_t *telnet , unsigned char cmd , unsigned char telopt ) 
{ 
  unsigned char bytes[3] ;

  {
  {
#line 320
  bytes[0] = (unsigned char)255;
#line 321
  bytes[1] = cmd;
#line 322
  bytes[2] = telopt;
#line 323
  _send(telnet, (char const   *)(bytes), (size_t )3);
  }
#line 324
  return;
}
}
#line 327 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static void _negotiate(telnet_t *telnet , unsigned char telopt ) 
{ 
  telnet_event_t ev ;
  telnet_rfc1143_t q ;
  int tmp ;
  int tmp___0 ;

  {
#line 332
  if ((int )telnet->flags & 1) {
    {
#line 334
    if ((int )telnet->state == 2) {
#line 334
      goto case_2;
    }
#line 337
    if ((int )telnet->state == 3) {
#line 337
      goto case_3;
    }
#line 340
    if ((int )telnet->state == 4) {
#line 340
      goto case_4;
    }
#line 343
    if ((int )telnet->state == 5) {
#line 343
      goto case_5;
    }
#line 333
    goto switch_break;
    case_2: /* CIL Label */ 
    {
#line 335
    ev.type = (enum telnet_event_type_t )3;
#line 335
    ev.neg.telopt = telopt;
#line 335
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
#line 336
    goto switch_break;
    case_3: /* CIL Label */ 
    {
#line 338
    ev.type = (enum telnet_event_type_t )4;
#line 338
    ev.neg.telopt = telopt;
#line 338
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
#line 339
    goto switch_break;
    case_4: /* CIL Label */ 
    {
#line 341
    ev.type = (enum telnet_event_type_t )5;
#line 341
    ev.neg.telopt = telopt;
#line 341
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
#line 342
    goto switch_break;
    case_5: /* CIL Label */ 
    {
#line 344
    ev.type = (enum telnet_event_type_t )6;
#line 344
    ev.neg.telopt = telopt;
#line 344
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
#line 345
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 347
    return;
  }
  {
#line 351
  q = _get_rfc1143(telnet, telopt);
  }
  {
#line 356
  if ((int )telnet->state == 2) {
#line 356
    goto case_2___0;
  }
#line 391
  if ((int )telnet->state == 3) {
#line 391
    goto case_3___1;
  }
#line 414
  if ((int )telnet->state == 4) {
#line 414
    goto case_4___2;
  }
#line 449
  if ((int )telnet->state == 5) {
#line 449
    goto case_5___3;
  }
#line 354
  goto switch_break___0;
  case_2___0: /* CIL Label */ 
  {
#line 358
  if (((int )q.state & 240) >> 4 == 0) {
#line 358
    goto case_0;
  }
#line 366
  if (((int )q.state & 240) >> 4 == 2) {
#line 366
    goto case_2___1;
  }
#line 372
  if (((int )q.state & 240) >> 4 == 4) {
#line 372
    goto case_4___0;
  }
#line 378
  if (((int )q.state & 240) >> 4 == 3) {
#line 378
    goto case_3___0;
  }
#line 382
  if (((int )q.state & 240) >> 4 == 5) {
#line 382
    goto case_5___0;
  }
#line 357
  goto switch_break___1;
  case_0: /* CIL Label */ 
  {
#line 359
  tmp = _check_telopt(telnet, telopt, 0);
  }
#line 359
  if (tmp) {
    {
#line 360
    _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)1);
#line 361
    _send_negotiate(telnet, (unsigned char)253, telopt);
#line 362
    ev.type = (enum telnet_event_type_t )3;
#line 362
    ev.neg.telopt = telopt;
#line 362
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
  } else {
    {
#line 364
    _send_negotiate(telnet, (unsigned char)254, telopt);
    }
  }
#line 365
  goto switch_break___1;
  case_2___1: /* CIL Label */ 
  {
#line 367
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)0);
#line 368
  ev.type = (enum telnet_event_type_t )4;
#line 368
  ev.neg.telopt = telopt;
#line 368
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 369
  _error(telnet, 369U, "_negotiate", (telnet_error_t )4, 0, "DONT answered by WILL");
  }
#line 371
  goto switch_break___1;
  case_4___0: /* CIL Label */ 
  {
#line 373
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)1);
#line 374
  ev.type = (enum telnet_event_type_t )3;
#line 374
  ev.neg.telopt = telopt;
#line 374
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 375
  _error(telnet, 375U, "_negotiate", (telnet_error_t )4, 0, "DONT answered by WILL");
  }
#line 377
  goto switch_break___1;
  case_3___0: /* CIL Label */ 
  {
#line 379
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)1);
#line 380
  ev.type = (enum telnet_event_type_t )3;
#line 380
  ev.neg.telopt = telopt;
#line 380
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 381
  goto switch_break___1;
  case_5___0: /* CIL Label */ 
  {
#line 383
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)2);
#line 384
  _send_negotiate(telnet, (unsigned char)254, telopt);
#line 385
  ev.type = (enum telnet_event_type_t )3;
#line 385
  ev.neg.telopt = telopt;
#line 385
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 386
  goto switch_break___1;
  switch_break___1: /* CIL Label */ ;
  }
#line 388
  goto switch_break___0;
  case_3___1: /* CIL Label */ 
  {
#line 393
  if (((int )q.state & 240) >> 4 == 1) {
#line 393
    goto case_1;
  }
#line 398
  if (((int )q.state & 240) >> 4 == 2) {
#line 398
    goto case_2___2;
  }
#line 402
  if (((int )q.state & 240) >> 4 == 4) {
#line 402
    goto case_4___1;
  }
#line 407
  if (((int )q.state & 240) >> 4 == 5) {
#line 407
    goto case_5___1;
  }
#line 407
  if (((int )q.state & 240) >> 4 == 3) {
#line 407
    goto case_5___1;
  }
#line 392
  goto switch_break___2;
  case_1: /* CIL Label */ 
  {
#line 394
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)0);
#line 395
  _send_negotiate(telnet, (unsigned char)254, telopt);
#line 396
  ev.type = (enum telnet_event_type_t )4;
#line 396
  ev.neg.telopt = telopt;
#line 396
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 397
  goto switch_break___2;
  case_2___2: /* CIL Label */ 
  {
#line 399
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)0);
#line 400
  ev.type = (enum telnet_event_type_t )4;
#line 400
  ev.neg.telopt = telopt;
#line 400
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 401
  goto switch_break___2;
  case_4___1: /* CIL Label */ 
  {
#line 403
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)3);
#line 404
  ev.type = (enum telnet_event_type_t )5;
#line 404
  ev.neg.telopt = telopt;
#line 404
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 405
  goto switch_break___2;
  case_5___1: /* CIL Label */ 
  case_3___2: /* CIL Label */ 
  {
#line 408
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)0);
  }
#line 409
  goto switch_break___2;
  switch_break___2: /* CIL Label */ ;
  }
#line 411
  goto switch_break___0;
  case_4___2: /* CIL Label */ 
  {
#line 416
  if (((int )q.state & 15) == 0) {
#line 416
    goto case_0___0;
  }
#line 424
  if (((int )q.state & 15) == 2) {
#line 424
    goto case_2___3;
  }
#line 430
  if (((int )q.state & 15) == 4) {
#line 430
    goto case_4___3;
  }
#line 436
  if (((int )q.state & 15) == 3) {
#line 436
    goto case_3___3;
  }
#line 440
  if (((int )q.state & 15) == 5) {
#line 440
    goto case_5___2;
  }
#line 415
  goto switch_break___3;
  case_0___0: /* CIL Label */ 
  {
#line 417
  tmp___0 = _check_telopt(telnet, telopt, 1);
  }
#line 417
  if (tmp___0) {
    {
#line 418
    _set_rfc1143(telnet, telopt, (char)1, (char )(((int )q.state & 240) >> 4));
#line 419
    _send_negotiate(telnet, (unsigned char)251, telopt);
#line 420
    ev.type = (enum telnet_event_type_t )5;
#line 420
    ev.neg.telopt = telopt;
#line 420
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
  } else {
    {
#line 422
    _send_negotiate(telnet, (unsigned char)252, telopt);
    }
  }
#line 423
  goto switch_break___3;
  case_2___3: /* CIL Label */ 
  {
#line 425
  _set_rfc1143(telnet, telopt, (char)0, (char )(((int )q.state & 240) >> 4));
#line 426
  ev.type = (enum telnet_event_type_t )6;
#line 426
  ev.neg.telopt = telopt;
#line 426
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 427
  _error(telnet, 427U, "_negotiate", (telnet_error_t )4, 0, "WONT answered by DO");
  }
#line 429
  goto switch_break___3;
  case_4___3: /* CIL Label */ 
  {
#line 431
  _set_rfc1143(telnet, telopt, (char)1, (char )(((int )q.state & 240) >> 4));
#line 432
  ev.type = (enum telnet_event_type_t )5;
#line 432
  ev.neg.telopt = telopt;
#line 432
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 433
  _error(telnet, 433U, "_negotiate", (telnet_error_t )4, 0, "WONT answered by DO");
  }
#line 435
  goto switch_break___3;
  case_3___3: /* CIL Label */ 
  {
#line 437
  _set_rfc1143(telnet, telopt, (char)1, (char )(((int )q.state & 240) >> 4));
#line 438
  ev.type = (enum telnet_event_type_t )5;
#line 438
  ev.neg.telopt = telopt;
#line 438
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 439
  goto switch_break___3;
  case_5___2: /* CIL Label */ 
  {
#line 441
  _set_rfc1143(telnet, telopt, (char)2, (char )(((int )q.state & 240) >> 4));
#line 442
  _send_negotiate(telnet, (unsigned char)252, telopt);
#line 443
  ev.type = (enum telnet_event_type_t )5;
#line 443
  ev.neg.telopt = telopt;
#line 443
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 444
  goto switch_break___3;
  switch_break___3: /* CIL Label */ ;
  }
#line 446
  goto switch_break___0;
  case_5___3: /* CIL Label */ 
  {
#line 451
  if (((int )q.state & 15) == 1) {
#line 451
    goto case_1___0;
  }
#line 456
  if (((int )q.state & 15) == 2) {
#line 456
    goto case_2___4;
  }
#line 460
  if (((int )q.state & 15) == 4) {
#line 460
    goto case_4___4;
  }
#line 466
  if (((int )q.state & 15) == 5) {
#line 466
    goto case_5___4;
  }
#line 466
  if (((int )q.state & 15) == 3) {
#line 466
    goto case_5___4;
  }
#line 450
  goto switch_break___4;
  case_1___0: /* CIL Label */ 
  {
#line 452
  _set_rfc1143(telnet, telopt, (char)0, (char )(((int )q.state & 240) >> 4));
#line 453
  _send_negotiate(telnet, (unsigned char)252, telopt);
#line 454
  ev.type = (enum telnet_event_type_t )6;
#line 454
  ev.neg.telopt = telopt;
#line 454
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 455
  goto switch_break___4;
  case_2___4: /* CIL Label */ 
  {
#line 457
  _set_rfc1143(telnet, telopt, (char)0, (char )(((int )q.state & 240) >> 4));
#line 458
  ev.type = (enum telnet_event_type_t )4;
#line 458
  ev.neg.telopt = telopt;
#line 458
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 459
  goto switch_break___4;
  case_4___4: /* CIL Label */ 
  {
#line 461
  _set_rfc1143(telnet, telopt, (char)3, (char )(((int )q.state & 240) >> 4));
#line 462
  _send_negotiate(telnet, (unsigned char)251, telopt);
#line 463
  ev.type = (enum telnet_event_type_t )3;
#line 463
  ev.neg.telopt = telopt;
#line 463
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
#line 464
  goto switch_break___4;
  case_5___4: /* CIL Label */ 
  case_3___4: /* CIL Label */ 
  {
#line 467
  _set_rfc1143(telnet, telopt, (char)0, (char )(((int )q.state & 240) >> 4));
  }
#line 468
  goto switch_break___4;
  switch_break___4: /* CIL Label */ ;
  }
#line 470
  goto switch_break___0;
  switch_break___0: /* CIL Label */ ;
  }
#line 472
  return;
}
}
#line 486 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static int _environ_telnet(telnet_t *telnet , unsigned char type , char *buffer ,
                           size_t size ) 
{ 
  telnet_event_t ev ;
  struct telnet_environ_t *values ;
  char *c ;
  char *last ;
  char *out ;
  size_t index___0 ;
  size_t count ;
  int *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  char *tmp___4 ;
  char *tmp___5 ;
  char *tmp___6 ;
  char *tmp___7 ;
  char *tmp___8 ;

  {
#line 489
  values = (struct telnet_environ_t *)0;
#line 494
  if (size == 0UL) {
#line 495
    return (0);
  }
#line 499
  if ((unsigned int )*(buffer + 0) != 1U) {
#line 499
    if ((unsigned int )*(buffer + 0) != 0U) {
#line 499
      if ((unsigned int )*(buffer + 0) != 2U) {
        {
#line 502
        _error(telnet, 502U, "_environ_telnet", (telnet_error_t )4, 0, "telopt %d subneg has invalid command",
               (int )type);
        }
#line 504
        return (0);
      }
    }
  }
#line 508
  ev.environ.cmd = (unsigned char )*(buffer + 0);
#line 511
  if (size == 1UL) {
    {
#line 513
    ev.environ.values = (struct telnet_environ_t  const  *)0;
#line 514
    ev.environ.size = (size_t )0;
#line 517
    ev.type = (enum telnet_event_type_t )11;
#line 518
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
#line 520
    return (1);
  }
#line 524
  if ((unsigned int )*(buffer + 1) != 0U) {
#line 524
    if ((unsigned int )*(buffer + 1) != 3U) {
      {
#line 526
      _error(telnet, 526U, "_environ_telnet", (telnet_error_t )4, 0, "telopt %d subneg missing variable type",
             (int )type);
      }
#line 528
      return (0);
    }
  }
#line 532
  if ((unsigned int )*(buffer + (size - 1UL)) == 2U) {
    {
#line 533
    _error(telnet, 533U, "_environ_telnet", (telnet_error_t )4, 0, "telopt %d subneg ends with ESC",
           (int )type);
    }
#line 535
    return (0);
  }
#line 539
  count = (size_t )0;
#line 540
  c = buffer + 1;
  {
#line 540
  while (1) {
    while_continue: /* CIL Label */ ;
#line 540
    if (! ((unsigned long )c < (unsigned long )(buffer + size))) {
#line 540
      goto while_break;
    }
#line 541
    if ((int )*c == 0) {
#line 542
      count ++;
    } else
#line 541
    if ((int )*c == 3) {
#line 542
      count ++;
    } else
#line 543
    if ((int )*c == 2) {
#line 545
      c ++;
    }
#line 540
    c ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 550
  tmp___1 = calloc(count, sizeof(struct telnet_environ_t ));
#line 550
  values = (struct telnet_environ_t *)tmp___1;
  }
#line 550
  if ((unsigned long )values == (unsigned long )((struct telnet_environ_t *)0)) {
    {
#line 552
    tmp = __errno_location();
#line 552
    tmp___0 = strerror(*tmp);
#line 552
    _error(telnet, 552U, "_environ_telnet", (telnet_error_t )2, 0, "calloc() failed: %s",
           tmp___0);
    }
#line 554
    return (0);
  }
#line 558
  out = buffer;
#line 559
  c = buffer + 1;
#line 560
  index___0 = (size_t )0;
  {
#line 560
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 560
    if (! (index___0 != count)) {
#line 560
      goto while_break___0;
    }
#line 562
    tmp___2 = c;
#line 562
    c ++;
#line 562
    (values + index___0)->type = (unsigned char )*tmp___2;
#line 566
    last = out;
    {
#line 567
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 567
      if (! ((unsigned long )c < (unsigned long )(buffer + size))) {
#line 567
        goto while_break___1;
      }
#line 569
      if ((unsigned int )*c == 0U) {
#line 572
        goto while_break___1;
      } else
#line 569
      if ((unsigned int )*c == 1U) {
#line 572
        goto while_break___1;
      } else
#line 569
      if ((unsigned int )*c == 3U) {
#line 572
        goto while_break___1;
      }
#line 576
      if ((int )*c == 2) {
#line 577
        c ++;
      }
#line 580
      tmp___3 = out;
#line 580
      out ++;
#line 580
      tmp___4 = c;
#line 580
      c ++;
#line 580
      *tmp___3 = *tmp___4;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 582
    tmp___5 = out;
#line 582
    out ++;
#line 582
    *tmp___5 = (char )'\000';
#line 585
    (values + index___0)->var = last;
#line 586
    (values + index___0)->value = (char *)"";
#line 590
    if ((unsigned long )c < (unsigned long )(buffer + size)) {
#line 590
      if ((int )*c == 1) {
#line 591
        c ++;
#line 592
        last = out;
        {
#line 593
        while (1) {
          while_continue___2: /* CIL Label */ ;
#line 593
          if (! ((unsigned long )c < (unsigned long )(buffer + size))) {
#line 593
            goto while_break___2;
          }
#line 595
          if ((unsigned int )*c == 0U) {
#line 597
            goto while_break___2;
          } else
#line 595
          if ((unsigned int )*c == 3U) {
#line 597
            goto while_break___2;
          }
#line 601
          if ((int )*c == 2) {
#line 602
            c ++;
          }
#line 605
          tmp___6 = out;
#line 605
          out ++;
#line 605
          tmp___7 = c;
#line 605
          c ++;
#line 605
          *tmp___6 = *tmp___7;
        }
        while_break___2: /* CIL Label */ ;
        }
#line 607
        tmp___8 = out;
#line 607
        out ++;
#line 607
        *tmp___8 = (char )'\000';
#line 610
        (values + index___0)->value = last;
      }
    }
#line 560
    index___0 ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 615
  ev.environ.values = (struct telnet_environ_t  const  *)values;
#line 616
  ev.environ.size = count;
#line 619
  ev.type = (enum telnet_event_type_t )11;
#line 620
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 623
  free((void *)values);
  }
#line 624
  return (1);
}
}
#line 628 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static int _mssp_telnet(telnet_t *telnet , char *buffer , size_t size ) 
{ 
  telnet_event_t ev ;
  struct telnet_environ_t *values ;
  char *var ;
  char *c ;
  char *last ;
  char *out ;
  size_t i ;
  size_t count ;
  unsigned char next_type ;
  int *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  char *tmp___4 ;
  char *tmp___5 ;

  {
#line 631
  var = (char *)0;
#line 637
  if (size == 0UL) {
#line 638
    return (0);
  }
#line 642
  if ((unsigned int )*(buffer + 0) != 1U) {
    {
#line 643
    _error(telnet, 643U, "_mssp_telnet", (telnet_error_t )4, 0, "MSSP subnegotiation has invalid data");
    }
#line 645
    return (0);
  }
#line 649
  count = (size_t )0;
#line 649
  i = (size_t )0;
  {
#line 649
  while (1) {
    while_continue: /* CIL Label */ ;
#line 649
    if (! (i != size)) {
#line 649
      goto while_break;
    }
#line 650
    if ((unsigned int )*(buffer + i) == 2U) {
#line 651
      count ++;
    }
#line 649
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 656
  tmp___1 = calloc(count, sizeof(struct telnet_environ_t ));
#line 656
  values = (struct telnet_environ_t *)tmp___1;
  }
#line 656
  if ((unsigned long )values == (unsigned long )((struct telnet_environ_t *)0)) {
    {
#line 658
    tmp = __errno_location();
#line 658
    tmp___0 = strerror(*tmp);
#line 658
    _error(telnet, 658U, "_mssp_telnet", (telnet_error_t )2, 0, "calloc() failed: %s",
           tmp___0);
    }
#line 660
    return (0);
  }
#line 663
  ev.mssp.values = (struct telnet_environ_t  const  *)values;
#line 664
  ev.mssp.size = count;
#line 667
  last = buffer;
#line 667
  out = last;
#line 668
  next_type = (unsigned char )*(buffer + 0);
#line 669
  i = (size_t )0;
#line 669
  c = buffer + 1;
  {
#line 669
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 669
    if (! ((unsigned long )c < (unsigned long )(buffer + size))) {
#line 669
      goto while_break___0;
    }
    {
#line 671
    while (1) {
      while_continue___1: /* CIL Label */ ;
#line 671
      if ((unsigned long )c < (unsigned long )(buffer + size)) {
#line 671
        if ((unsigned int )*c != 1U) {
#line 671
          if (! ((unsigned int )*c != 2U)) {
#line 671
            goto while_break___1;
          }
        } else {
#line 671
          goto while_break___1;
        }
      } else {
#line 671
        goto while_break___1;
      }
#line 673
      tmp___2 = out;
#line 673
      out ++;
#line 673
      tmp___3 = c;
#line 673
      c ++;
#line 673
      *tmp___2 = *tmp___3;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 675
    tmp___4 = out;
#line 675
    out ++;
#line 675
    *tmp___4 = (char )'\000';
#line 678
    if ((int )next_type == 1) {
#line 679
      var = last;
    } else
#line 680
    if ((int )next_type == 2) {
#line 680
      if ((unsigned long )var != (unsigned long )((char *)0)) {
#line 681
        (values + i)->var = var;
#line 682
        (values + i)->value = last;
#line 683
        i ++;
      } else {
        {
#line 685
        _error(telnet, 685U, "_mssp_telnet", (telnet_error_t )4, 0, "invalid MSSP subnegotiation data");
#line 687
        free((void *)values);
        }
#line 688
        return (0);
      }
    } else {
      {
#line 685
      _error(telnet, 685U, "_mssp_telnet", (telnet_error_t )4, 0, "invalid MSSP subnegotiation data");
#line 687
      free((void *)values);
      }
#line 688
      return (0);
    }
#line 692
    last = out;
#line 693
    tmp___5 = c;
#line 693
    c ++;
#line 693
    next_type = (unsigned char )*tmp___5;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 697
  ev.type = (enum telnet_event_type_t )12;
#line 698
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 701
  free((void *)values);
  }
#line 703
  return (0);
}
}
#line 707 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static int _zmp_telnet(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 
  telnet_event_t ev ;
  char **argv ;
  char const   *c ;
  size_t i ;
  size_t argc ;
  size_t tmp ;
  int *tmp___0 ;
  char *tmp___1 ;
  void *tmp___2 ;
  size_t tmp___3 ;

  {
#line 714
  if (size == 0UL) {
    {
#line 715
    _error(telnet, 715U, "_zmp_telnet", (telnet_error_t )4, 0, "incomplete ZMP frame");
    }
#line 717
    return (0);
  } else
#line 714
  if ((int const   )*(buffer + (size - 1UL)) != 0) {
    {
#line 715
    _error(telnet, 715U, "_zmp_telnet", (telnet_error_t )4, 0, "incomplete ZMP frame");
    }
#line 717
    return (0);
  }
#line 721
  argc = (size_t )0;
#line 721
  c = buffer;
  {
#line 721
  while (1) {
    while_continue: /* CIL Label */ ;
#line 721
    if (! ((unsigned long )c != (unsigned long )(buffer + size))) {
#line 721
      goto while_break;
    }
    {
#line 722
    tmp = strlen(c);
#line 722
    c += tmp + 1UL;
#line 721
    argc ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 725
  tmp___2 = calloc(argc, sizeof(char *));
#line 725
  argv = (char **)tmp___2;
  }
#line 725
  if ((unsigned long )argv == (unsigned long )((char **)0)) {
    {
#line 726
    tmp___0 = __errno_location();
#line 726
    tmp___1 = strerror(*tmp___0);
#line 726
    _error(telnet, 726U, "_zmp_telnet", (telnet_error_t )2, 0, "calloc() failed: %s",
           tmp___1);
    }
#line 728
    return (0);
  }
#line 732
  i = (size_t )0;
#line 732
  c = buffer;
  {
#line 732
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 732
    if (! (i != argc)) {
#line 732
      goto while_break___0;
    }
    {
#line 733
    *(argv + i) = (char *)c;
#line 734
    tmp___3 = strlen(c);
#line 734
    c += tmp___3 + 1UL;
#line 732
    i ++;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 738
  ev.type = (enum telnet_event_type_t )9;
#line 739
  ev.zmp.argv = (char const   **)argv;
#line 740
  ev.zmp.argc = argc;
#line 741
  (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 744
  free((void *)argv);
  }
#line 745
  return (0);
}
}
#line 749 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static int _ttype_telnet(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 
  telnet_event_t ev ;
  char *name ;
  int *tmp ;
  char *tmp___0 ;
  void *tmp___1 ;

  {
#line 753
  if (size == 0UL) {
    {
#line 754
    _error(telnet, 754U, "_ttype_telnet", (telnet_error_t )4, 0, "incomplete TERMINAL-TYPE request");
    }
#line 756
    return (0);
  }
#line 760
  if ((int const   )*(buffer + 0) != 0) {
#line 760
    if ((int const   )*(buffer + 0) != 1) {
      {
#line 762
      _error(telnet, 762U, "_ttype_telnet", (telnet_error_t )4, 0, "TERMINAL-TYPE request has invalid type");
      }
#line 764
      return (0);
    }
  }
#line 768
  if ((int const   )*(buffer + 0) == 0) {
    {
#line 772
    tmp___1 = malloc(size - 1UL);
#line 772
    name = (char *)tmp___1;
    }
#line 772
    if ((unsigned long )name == (unsigned long )((char *)0)) {
      {
#line 773
      tmp = __errno_location();
#line 773
      tmp___0 = strerror(*tmp);
#line 773
      _error(telnet, 773U, "_ttype_telnet", (telnet_error_t )2, 0, "malloc() failed: %s",
             tmp___0);
      }
#line 775
      return (0);
    }
    {
#line 777
    memcpy((void */* __restrict  */)name, (void const   */* __restrict  */)(buffer + 1),
           size - 1UL);
#line 778
    *(name + (size - 1UL)) = (char )'\000';
#line 780
    ev.type = (enum telnet_event_type_t )10;
#line 781
    ev.ttype.cmd = (unsigned char)0;
#line 782
    ev.ttype.name = (char const   *)name;
#line 783
    (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 786
    free((void *)name);
    }
  } else {
    {
#line 788
    ev.type = (enum telnet_event_type_t )10;
#line 789
    ev.ttype.cmd = (unsigned char)1;
#line 790
    ev.ttype.name = (char const   *)0;
#line 791
    (*(telnet->eh))(telnet, & ev, telnet->ud);
    }
  }
#line 794
  return (0);
}
}
#line 800 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static int _subnegotiate(telnet_t *telnet ) 
{ 
  telnet_event_t ev ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
  {
#line 804
  ev.type = (enum telnet_event_type_t )7;
#line 805
  ev.sub.telopt = telnet->sb_telopt;
#line 806
  ev.sub.buffer = (char const   *)telnet->buffer;
#line 807
  ev.sub.size = telnet->buffer_pos;
#line 808
  (*(telnet->eh))(telnet, & ev, telnet->ud);
  }
  {
#line 830
  if ((int )telnet->sb_telopt == 93) {
#line 830
    goto case_93;
  }
#line 832
  if ((int )telnet->sb_telopt == 24) {
#line 832
    goto case_24;
  }
#line 835
  if ((int )telnet->sb_telopt == 39) {
#line 835
    goto case_39;
  }
#line 835
  if ((int )telnet->sb_telopt == 36) {
#line 835
    goto case_39;
  }
#line 838
  if ((int )telnet->sb_telopt == 70) {
#line 838
    goto case_70;
  }
#line 840
  goto switch_default;
  case_93: /* CIL Label */ 
  {
#line 831
  tmp = _zmp_telnet(telnet, (char const   *)telnet->buffer, telnet->buffer_pos);
  }
#line 831
  return (tmp);
  case_24: /* CIL Label */ 
  {
#line 833
  tmp___0 = _ttype_telnet(telnet, (char const   *)telnet->buffer, telnet->buffer_pos);
  }
#line 833
  return (tmp___0);
  case_39: /* CIL Label */ 
  case_36: /* CIL Label */ 
  {
#line 836
  tmp___1 = _environ_telnet(telnet, telnet->sb_telopt, telnet->buffer, telnet->buffer_pos);
  }
#line 836
  return (tmp___1);
  case_70: /* CIL Label */ 
  {
#line 839
  tmp___2 = _mssp_telnet(telnet, telnet->buffer, telnet->buffer_pos);
  }
#line 839
  return (tmp___2);
  switch_default: /* CIL Label */ 
#line 841
  return (0);
  switch_break: /* CIL Label */ ;
  }
}
}
#line 846 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
telnet_t *telnet_init(telnet_telopt_t const   *telopts , void (*eh)(telnet_t *telnet ,
                                                                    telnet_event_t *event ,
                                                                    void *user_data ) ,
                      unsigned char flags , void *user_data ) 
{ 
  struct telnet_t *telnet ;
  void *tmp ;

  {
  {
#line 849
  tmp = calloc((size_t )1, sizeof(telnet_t ));
#line 849
  telnet = (telnet_t *)tmp;
  }
#line 850
  if ((unsigned long )telnet == (unsigned long )((struct telnet_t *)0)) {
#line 851
    return ((telnet_t *)0);
  }
#line 854
  telnet->ud = user_data;
#line 855
  telnet->telopts = telopts;
#line 856
  telnet->eh = eh;
#line 857
  telnet->flags = flags;
#line 859
  return (telnet);
}
}
#line 863 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_free(telnet_t *telnet ) 
{ 


  {
#line 865
  if ((unsigned long )telnet->buffer != (unsigned long )((char *)0)) {
    {
#line 866
    free((void *)telnet->buffer);
#line 867
    telnet->buffer = (char *)0;
#line 868
    telnet->buffer_size = (size_t )0;
#line 869
    telnet->buffer_pos = (size_t )0;
    }
  }
#line 885
  if (telnet->q) {
    {
#line 886
    free((void *)telnet->q);
#line 887
    telnet->q = (struct telnet_rfc1143_t *)0;
#line 888
    telnet->q_size = (unsigned char)0;
    }
  }
  {
#line 892
  free((void *)telnet);
  }
#line 893
  return;
}
}
#line 896 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static telnet_error_t _buffer_byte(telnet_t *telnet , unsigned char byte ) 
{ 
  char *new_buffer ;
  size_t i ;
  void *tmp ;
  size_t tmp___0 ;

  {
#line 902
  if (telnet->buffer_pos == telnet->buffer_size) {
#line 904
    i = (size_t )0;
    {
#line 904
    while (1) {
      while_continue: /* CIL Label */ ;
#line 904
      if (! (i != (size_t )_buffer_sizes_count)) {
#line 904
        goto while_break;
      }
#line 905
      if (_buffer_sizes[i] == (size_t const   )telnet->buffer_size) {
#line 906
        goto while_break;
      }
#line 904
      i ++;
    }
    while_break: /* CIL Label */ ;
    }
#line 911
    if (i >= (size_t )(_buffer_sizes_count - 1UL)) {
      {
#line 912
      _error(telnet, 912U, "_buffer_byte", (telnet_error_t )3, 0, "subnegotiation buffer size limit reached");
      }
#line 914
      return ((telnet_error_t )3);
    }
    {
#line 918
    tmp = realloc((void *)telnet->buffer, (size_t )_buffer_sizes[i + 1UL]);
#line 918
    new_buffer = (char *)tmp;
    }
#line 919
    if ((unsigned long )new_buffer == (unsigned long )((char *)0)) {
      {
#line 920
      _error(telnet, 920U, "_buffer_byte", (telnet_error_t )2, 0, "realloc() failed");
      }
#line 922
      return ((telnet_error_t )2);
    }
#line 925
    telnet->buffer = new_buffer;
#line 926
    telnet->buffer_size = (size_t )_buffer_sizes[i + 1UL];
  }
#line 930
  tmp___0 = telnet->buffer_pos;
#line 930
  (telnet->buffer_pos) ++;
#line 930
  *(telnet->buffer + tmp___0) = (char )byte;
#line 931
  return ((telnet_error_t )0);
}
}
#line 934 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static void _process(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 
  telnet_event_t ev ;
  unsigned char byte ;
  size_t i ;
  size_t start ;
  telnet_error_t tmp ;
  int tmp___0 ;
  telnet_error_t tmp___1 ;
  int tmp___2 ;

  {
#line 938
  start = (size_t )0;
#line 938
  i = start;
  {
#line 938
  while (1) {
    while_continue: /* CIL Label */ ;
#line 938
    if (! (i != size)) {
#line 938
      goto while_break;
    }
#line 939
    byte = (unsigned char )*(buffer + i);
    {
#line 942
    if ((unsigned int )telnet->state == 0U) {
#line 942
      goto case_0;
    }
#line 957
    if ((unsigned int )telnet->state == 1U) {
#line 957
      goto case_1;
    }
#line 1005
    if ((unsigned int )telnet->state == 5U) {
#line 1005
      goto case_5;
    }
#line 1005
    if ((unsigned int )telnet->state == 4U) {
#line 1005
      goto case_5;
    }
#line 1005
    if ((unsigned int )telnet->state == 3U) {
#line 1005
      goto case_5;
    }
#line 1005
    if ((unsigned int )telnet->state == 2U) {
#line 1005
      goto case_5;
    }
#line 1012
    if ((unsigned int )telnet->state == 6U) {
#line 1012
      goto case_6;
    }
#line 1019
    if ((unsigned int )telnet->state == 7U) {
#line 1019
      goto case_7;
    }
#line 1031
    if ((unsigned int )telnet->state == 8U) {
#line 1031
      goto case_8;
    }
#line 940
    goto switch_break;
    case_0: /* CIL Label */ 
#line 945
    if ((int )byte == 255) {
#line 946
      if (i != start) {
        {
#line 947
        ev.type = (enum telnet_event_type_t )0;
#line 948
        ev.data.buffer = buffer + start;
#line 949
        ev.data.size = i - start;
#line 950
        (*(telnet->eh))(telnet, & ev, telnet->ud);
        }
      }
#line 952
      telnet->state = (enum telnet_state_t )1;
    }
#line 954
    goto switch_break;
    case_1: /* CIL Label */ 
    {
#line 960
    if ((int )byte == 250) {
#line 960
      goto case_250;
    }
#line 964
    if ((int )byte == 251) {
#line 964
      goto case_251;
    }
#line 967
    if ((int )byte == 252) {
#line 967
      goto case_252;
    }
#line 970
    if ((int )byte == 253) {
#line 970
      goto case_253;
    }
#line 973
    if ((int )byte == 254) {
#line 973
      goto case_254;
    }
#line 977
    if ((int )byte == 255) {
#line 977
      goto case_255;
    }
#line 989
    goto switch_default;
    case_250: /* CIL Label */ 
#line 961
    telnet->state = (enum telnet_state_t )6;
#line 962
    goto switch_break___0;
    case_251: /* CIL Label */ 
#line 965
    telnet->state = (enum telnet_state_t )2;
#line 966
    goto switch_break___0;
    case_252: /* CIL Label */ 
#line 968
    telnet->state = (enum telnet_state_t )3;
#line 969
    goto switch_break___0;
    case_253: /* CIL Label */ 
#line 971
    telnet->state = (enum telnet_state_t )4;
#line 972
    goto switch_break___0;
    case_254: /* CIL Label */ 
#line 974
    telnet->state = (enum telnet_state_t )5;
#line 975
    goto switch_break___0;
    case_255: /* CIL Label */ 
    {
#line 979
    ev.type = (enum telnet_event_type_t )0;
#line 980
    ev.data.buffer = (char const   *)((char *)(& byte));
#line 981
    ev.data.size = (size_t )1;
#line 982
    (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 985
    start = i + 1UL;
#line 986
    telnet->state = (enum telnet_state_t )0;
    }
#line 987
    goto switch_break___0;
    switch_default: /* CIL Label */ 
    {
#line 991
    ev.type = (enum telnet_event_type_t )2;
#line 992
    ev.iac.cmd = byte;
#line 993
    (*(telnet->eh))(telnet, & ev, telnet->ud);
#line 996
    start = i + 1UL;
#line 997
    telnet->state = (enum telnet_state_t )0;
    }
    switch_break___0: /* CIL Label */ ;
    }
#line 999
    goto switch_break;
    case_5: /* CIL Label */ 
    case_4: /* CIL Label */ 
    case_3: /* CIL Label */ 
    case_2: /* CIL Label */ 
    {
#line 1006
    _negotiate(telnet, byte);
#line 1007
    start = i + 1UL;
#line 1008
    telnet->state = (enum telnet_state_t )0;
    }
#line 1009
    goto switch_break;
    case_6: /* CIL Label */ 
#line 1013
    telnet->sb_telopt = byte;
#line 1014
    telnet->buffer_pos = (size_t )0;
#line 1015
    telnet->state = (enum telnet_state_t )7;
#line 1016
    goto switch_break;
    case_7: /* CIL Label */ 
#line 1021
    if ((int )byte == 255) {
#line 1022
      telnet->state = (enum telnet_state_t )8;
    } else {
      {
#line 1024
      tmp = _buffer_byte(telnet, byte);
      }
#line 1024
      if ((unsigned int )tmp != 0U) {
#line 1025
        start = i + 1UL;
#line 1026
        telnet->state = (enum telnet_state_t )0;
      }
    }
#line 1028
    goto switch_break;
    case_8: /* CIL Label */ 
    {
#line 1034
    if ((int )byte == 240) {
#line 1034
      goto case_240;
    }
#line 1052
    if ((int )byte == 255) {
#line 1052
      goto case_255___0;
    }
#line 1066
    goto switch_default___0;
    case_240: /* CIL Label */ 
    {
#line 1036
    start = i + 1UL;
#line 1037
    telnet->state = (enum telnet_state_t )0;
#line 1040
    tmp___0 = _subnegotiate(telnet);
    }
#line 1040
    if (tmp___0 != 0) {
      {
#line 1047
      telnet_recv(telnet, buffer + start, size - start);
      }
#line 1048
      return;
    }
#line 1050
    goto switch_break___1;
    case_255___0: /* CIL Label */ 
    {
#line 1054
    tmp___1 = _buffer_byte(telnet, (unsigned char)255);
    }
#line 1054
    if ((unsigned int )tmp___1 != 0U) {
#line 1056
      start = i + 1UL;
#line 1057
      telnet->state = (enum telnet_state_t )0;
    } else {
#line 1059
      telnet->state = (enum telnet_state_t )7;
    }
#line 1061
    goto switch_break___1;
    switch_default___0: /* CIL Label */ 
    {
#line 1067
    _error(telnet, 1067U, "_process", (telnet_error_t )4, 0, "unexpected byte after IAC inside SB: %d",
           (int )byte);
#line 1072
    start = i + 1UL;
#line 1073
    telnet->state = (enum telnet_state_t )1;
#line 1078
    tmp___2 = _subnegotiate(telnet);
    }
#line 1078
    if (tmp___2 != 0) {
      {
#line 1079
      telnet_recv(telnet, buffer + start, size - start);
      }
#line 1080
      return;
    } else {
      {
#line 1086
      _process(telnet, (char const   *)((char *)(& byte)), (size_t )1);
      }
    }
#line 1088
    goto switch_break___1;
    switch_break___1: /* CIL Label */ ;
    }
#line 1090
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 938
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1095
  if ((unsigned int )telnet->state == 0U) {
#line 1095
    if (i != start) {
      {
#line 1096
      ev.type = (enum telnet_event_type_t )0;
#line 1097
      ev.data.buffer = buffer + start;
#line 1098
      ev.data.size = i - start;
#line 1099
      (*(telnet->eh))(telnet, & ev, telnet->ud);
      }
    }
  }
#line 1101
  return;
}
}
#line 1104 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_recv(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 


  {
  {
#line 1158
  _process(telnet, buffer, size);
  }
#line 1159
  return;
}
}
#line 1162 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_iac(telnet_t *telnet , unsigned char cmd ) 
{ 
  unsigned char bytes[2] ;

  {
  {
#line 1164
  bytes[0] = (unsigned char)255;
#line 1165
  bytes[1] = cmd;
#line 1166
  _send(telnet, (char const   *)(bytes), (size_t )2);
  }
#line 1167
  return;
}
}
#line 1170 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_negotiate(telnet_t *telnet , unsigned char cmd , unsigned char telopt ) 
{ 
  telnet_rfc1143_t q ;
  unsigned char bytes[3] ;

  {
#line 1175
  if ((int )telnet->flags & 1) {
    {
#line 1177
    bytes[0] = (unsigned char)255;
#line 1178
    bytes[1] = cmd;
#line 1179
    bytes[2] = telopt;
#line 1180
    _send(telnet, (char const   *)(bytes), (size_t )3);
    }
#line 1181
    return;
  }
  {
#line 1185
  q = _get_rfc1143(telnet, telopt);
  }
  {
#line 1189
  if ((int )cmd == 251) {
#line 1189
    goto case_251;
  }
#line 1205
  if ((int )cmd == 252) {
#line 1205
    goto case_252;
  }
#line 1221
  if ((int )cmd == 253) {
#line 1221
    goto case_253;
  }
#line 1237
  if ((int )cmd == 254) {
#line 1237
    goto case_254;
  }
#line 1187
  goto switch_break;
  case_251: /* CIL Label */ 
  {
#line 1191
  if (((int )q.state & 15) == 0) {
#line 1191
    goto case_0;
  }
#line 1195
  if (((int )q.state & 15) == 2) {
#line 1195
    goto case_2;
  }
#line 1198
  if (((int )q.state & 15) == 5) {
#line 1198
    goto case_5;
  }
#line 1190
  goto switch_break___0;
  case_0: /* CIL Label */ 
  {
#line 1192
  _set_rfc1143(telnet, telopt, (char)3, (char )(((int )q.state & 240) >> 4));
#line 1193
  _send_negotiate(telnet, (unsigned char)251, telopt);
  }
#line 1194
  goto switch_break___0;
  case_2: /* CIL Label */ 
  {
#line 1196
  _set_rfc1143(telnet, telopt, (char)4, (char )(((int )q.state & 240) >> 4));
  }
#line 1197
  goto switch_break___0;
  case_5: /* CIL Label */ 
  {
#line 1199
  _set_rfc1143(telnet, telopt, (char)3, (char )(((int )q.state & 240) >> 4));
  }
#line 1200
  goto switch_break___0;
  switch_break___0: /* CIL Label */ ;
  }
#line 1202
  goto switch_break;
  case_252: /* CIL Label */ 
  {
#line 1207
  if (((int )q.state & 15) == 1) {
#line 1207
    goto case_1;
  }
#line 1211
  if (((int )q.state & 15) == 3) {
#line 1211
    goto case_3;
  }
#line 1214
  if (((int )q.state & 15) == 4) {
#line 1214
    goto case_4;
  }
#line 1206
  goto switch_break___1;
  case_1: /* CIL Label */ 
  {
#line 1208
  _set_rfc1143(telnet, telopt, (char)2, (char )(((int )q.state & 240) >> 4));
#line 1209
  _send_negotiate(telnet, (unsigned char)252, telopt);
  }
#line 1210
  goto switch_break___1;
  case_3: /* CIL Label */ 
  {
#line 1212
  _set_rfc1143(telnet, telopt, (char)5, (char )(((int )q.state & 240) >> 4));
  }
#line 1213
  goto switch_break___1;
  case_4: /* CIL Label */ 
  {
#line 1215
  _set_rfc1143(telnet, telopt, (char)2, (char )(((int )q.state & 240) >> 4));
  }
#line 1216
  goto switch_break___1;
  switch_break___1: /* CIL Label */ ;
  }
#line 1218
  goto switch_break;
  case_253: /* CIL Label */ 
  {
#line 1223
  if (((int )q.state & 240) >> 4 == 0) {
#line 1223
    goto case_0___0;
  }
#line 1227
  if (((int )q.state & 240) >> 4 == 2) {
#line 1227
    goto case_2___0;
  }
#line 1230
  if (((int )q.state & 240) >> 4 == 5) {
#line 1230
    goto case_5___0;
  }
#line 1222
  goto switch_break___2;
  case_0___0: /* CIL Label */ 
  {
#line 1224
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)3);
#line 1225
  _send_negotiate(telnet, (unsigned char)253, telopt);
  }
#line 1226
  goto switch_break___2;
  case_2___0: /* CIL Label */ 
  {
#line 1228
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)4);
  }
#line 1229
  goto switch_break___2;
  case_5___0: /* CIL Label */ 
  {
#line 1231
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)3);
  }
#line 1232
  goto switch_break___2;
  switch_break___2: /* CIL Label */ ;
  }
#line 1234
  goto switch_break;
  case_254: /* CIL Label */ 
  {
#line 1239
  if (((int )q.state & 240) >> 4 == 1) {
#line 1239
    goto case_1___0;
  }
#line 1243
  if (((int )q.state & 240) >> 4 == 3) {
#line 1243
    goto case_3___0;
  }
#line 1246
  if (((int )q.state & 240) >> 4 == 4) {
#line 1246
    goto case_4___0;
  }
#line 1238
  goto switch_break___3;
  case_1___0: /* CIL Label */ 
  {
#line 1240
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)2);
#line 1241
  _send_negotiate(telnet, (unsigned char)254, telopt);
  }
#line 1242
  goto switch_break___3;
  case_3___0: /* CIL Label */ 
  {
#line 1244
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)5);
  }
#line 1245
  goto switch_break___3;
  case_4___0: /* CIL Label */ 
  {
#line 1247
  _set_rfc1143(telnet, telopt, (char )((int )q.state & 15), (char)2);
  }
#line 1248
  goto switch_break___3;
  switch_break___3: /* CIL Label */ ;
  }
#line 1250
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1252
  return;
}
}
#line 1255 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_send(telnet_t *telnet , char const   *buffer , size_t size ) 
{ 
  size_t i ;
  size_t l ;

  {
#line 1259
  i = (size_t )0;
#line 1259
  l = i;
  {
#line 1259
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1259
    if (! (i != size)) {
#line 1259
      goto while_break;
    }
#line 1261
    if ((int const   )*(buffer + i) == -1) {
#line 1263
      if (i != l) {
        {
#line 1264
        _send(telnet, buffer + l, i - l);
        }
      }
      {
#line 1266
      l = i + 1UL;
#line 1269
      telnet_iac(telnet, (unsigned char)255);
      }
    }
#line 1259
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1274
  if (i != l) {
    {
#line 1275
    _send(telnet, buffer + l, i - l);
    }
  }
#line 1277
  return;
}
}
#line 1280 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_begin_sb(telnet_t *telnet , unsigned char telopt ) 
{ 
  unsigned char sb[3] ;

  {
  {
#line 1282
  sb[0] = (unsigned char)255;
#line 1283
  sb[1] = (unsigned char)250;
#line 1284
  sb[2] = telopt;
#line 1285
  _send(telnet, (char const   *)(sb), (size_t )3);
  }
#line 1286
  return;
}
}
#line 1290 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_subnegotiation(telnet_t *telnet , unsigned char telopt , char const   *buffer ,
                           size_t size ) 
{ 
  unsigned char bytes[5] ;

  {
  {
#line 1293
  bytes[0] = (unsigned char)255;
#line 1294
  bytes[1] = (unsigned char)250;
#line 1295
  bytes[2] = telopt;
#line 1296
  bytes[3] = (unsigned char)255;
#line 1297
  bytes[4] = (unsigned char)240;
#line 1299
  _send(telnet, (char const   *)(bytes), (size_t )3);
#line 1300
  telnet_send(telnet, buffer, size);
#line 1301
  _send(telnet, (char const   *)(bytes + 3), (size_t )2);
  }
#line 1320
  return;
}
}
#line 1322 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_begin_compress2(telnet_t *telnet ) 
{ 


  {
#line 1347
  return;
}
}
#line 1351
int telnet_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) ;
#line 1351 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static char const   CRLF[2]  = {      (char const   )'\r',      (char const   )'\n'};
#line 1352
int telnet_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) ;
#line 1352 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static char const   CRNUL[2]  = {      (char const   )'\r',      (char const   )'\000'};
#line 1350 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
int telnet_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) 
{ 
  char buffer[1024] ;
  char *output ;
  int rs ;
  int i ;
  int l ;
  void *tmp ;
  int *tmp___0 ;
  char *tmp___1 ;

  {
  {
#line 1354
  output = buffer;
#line 1358
  rs = vsnprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)fmt,
                 va);
  }
#line 1359
  if ((unsigned long )rs >= sizeof(buffer)) {
    {
#line 1360
    tmp = malloc((size_t )(rs + 1));
#line 1360
    output = (char *)tmp;
    }
#line 1361
    if ((unsigned long )output == (unsigned long )((char *)0)) {
      {
#line 1362
      tmp___0 = __errno_location();
#line 1362
      tmp___1 = strerror(*tmp___0);
#line 1362
      _error(telnet, 1362U, "telnet_vprintf", (telnet_error_t )2, 0, "malloc() failed: %s",
             tmp___1);
      }
#line 1364
      return (-1);
    }
    {
#line 1366
    rs = vsnprintf((char */* __restrict  */)output, (size_t )(rs + 1), (char const   */* __restrict  */)fmt,
                   va);
    }
  }
#line 1370
  i = 0;
#line 1370
  l = i;
  {
#line 1370
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1370
    if (! (i != rs)) {
#line 1370
      goto while_break;
    }
#line 1372
    if ((int )*(output + i) == -1) {
#line 1372
      goto _L;
    } else
#line 1372
    if ((int )*(output + i) == 13) {
#line 1372
      goto _L;
    } else
#line 1372
    if ((int )*(output + i) == 10) {
      _L: /* CIL Label */ 
#line 1375
      if (i != l) {
        {
#line 1376
        _send(telnet, (char const   *)(output + l), (size_t )(i - l));
        }
      }
#line 1377
      l = i + 1;
#line 1380
      if ((int )*(output + i) == -1) {
        {
#line 1381
        telnet_iac(telnet, (unsigned char)255);
        }
      } else
#line 1383
      if ((int )*(output + i) == 13) {
        {
#line 1384
        _send(telnet, CRNUL, (size_t )2);
        }
      } else
#line 1386
      if ((int )*(output + i) == 10) {
        {
#line 1387
        _send(telnet, CRLF, (size_t )2);
        }
      }
    }
#line 1370
    i ++;
  }
  while_break: /* CIL Label */ ;
  }
#line 1392
  if (i != l) {
    {
#line 1393
    _send(telnet, (char const   *)(output + l), (size_t )(i - l));
    }
  }
#line 1397
  if ((unsigned long )output != (unsigned long )(buffer)) {
    {
#line 1398
    free((void *)output);
    }
  }
#line 1401
  return (rs);
}
}
#line 1405 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
int ( /* format attribute */  telnet_printf)(telnet_t *telnet , char const   *fmt 
                                             , ...) 
{ 
  va_list va ;
  int rs ;

  {
  {
#line 1409
  __builtin_va_start(va, fmt);
#line 1410
  rs = telnet_vprintf(telnet, fmt, va);
#line 1411
  __builtin_va_end(va);
  }
#line 1413
  return (rs);
}
}
#line 1417 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
int telnet_raw_vprintf(telnet_t *telnet , char const   *fmt , va_list va ) 
{ 
  char buffer[1024] ;
  char *output ;
  int rs ;
  void *tmp ;
  int *tmp___0 ;
  char *tmp___1 ;

  {
  {
#line 1419
  output = buffer;
#line 1423
  rs = vsnprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)fmt,
                 va);
  }
#line 1424
  if ((unsigned long )rs >= sizeof(buffer)) {
    {
#line 1425
    tmp = malloc((size_t )(rs + 1));
#line 1425
    output = (char *)tmp;
    }
#line 1426
    if ((unsigned long )output == (unsigned long )((char *)0)) {
      {
#line 1427
      tmp___0 = __errno_location();
#line 1427
      tmp___1 = strerror(*tmp___0);
#line 1427
      _error(telnet, 1427U, "telnet_raw_vprintf", (telnet_error_t )2, 0, "malloc() failed: %s",
             tmp___1);
      }
#line 1429
      return (-1);
    }
    {
#line 1431
    rs = vsnprintf((char */* __restrict  */)output, (size_t )(rs + 1), (char const   */* __restrict  */)fmt,
                   va);
    }
  }
  {
#line 1435
  telnet_send(telnet, (char const   *)output, (size_t )rs);
  }
#line 1438
  if ((unsigned long )output != (unsigned long )(buffer)) {
    {
#line 1439
    free((void *)output);
    }
  }
#line 1442
  return (rs);
}
}
#line 1446 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
int ( /* format attribute */  telnet_raw_printf)(telnet_t *telnet , char const   *fmt 
                                                 , ...) 
{ 
  va_list va ;
  int rs ;

  {
  {
#line 1450
  __builtin_va_start(va, fmt);
#line 1451
  rs = telnet_raw_vprintf(telnet, fmt, va);
#line 1452
  __builtin_va_end(va);
  }
#line 1454
  return (rs);
}
}
#line 1458 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_begin_newenviron(telnet_t *telnet , unsigned char cmd ) 
{ 


  {
  {
#line 1459
  telnet_begin_sb(telnet, (unsigned char)39);
  }
#line 1460
  return;
}
}
#line 1463 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_newenviron_value(telnet_t *telnet , unsigned char type , char const   *string ) 
{ 
  size_t tmp ;

  {
  {
#line 1465
  telnet_send(telnet, (char const   *)((char *)(& type)), (size_t )1);
  }
#line 1467
  if ((unsigned long )string != (unsigned long )((char const   *)0)) {
    {
#line 1468
    tmp = strlen(string);
#line 1468
    telnet_send(telnet, string, tmp);
    }
  }
#line 1470
  return;
}
}
#line 1474
void telnet_ttype_send(telnet_t *telnet ) ;
#line 1474 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static unsigned char const   SEND[6]  = {      (unsigned char const   )255,      (unsigned char const   )250,      (unsigned char const   )24,      (unsigned char const   )1, 
        (unsigned char const   )255,      (unsigned char const   )240};
#line 1473 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_ttype_send(telnet_t *telnet ) 
{ 


  {
  {
#line 1476
  _send(telnet, (char const   *)(SEND), sizeof(SEND));
  }
#line 1477
  return;
}
}
#line 1481
void telnet_ttype_is(telnet_t *telnet , char const   *ttype ) ;
#line 1481 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
static unsigned char const   IS[4]  = {      (unsigned char const   )255,      (unsigned char const   )250,      (unsigned char const   )24,      (unsigned char const   )0};
#line 1480 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_ttype_is(telnet_t *telnet , char const   *ttype ) 
{ 
  size_t tmp ;

  {
  {
#line 1483
  _send(telnet, (char const   *)(IS), sizeof(IS));
#line 1484
  tmp = strlen(ttype);
#line 1484
  _send(telnet, ttype, tmp);
#line 1485
  telnet_iac(telnet, (unsigned char)240);
  }
#line 1486
  return;
}
}
#line 1489 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_send_zmp(telnet_t *telnet , size_t argc , char const   **argv ) 
{ 
  size_t i ;

  {
  {
#line 1493
  telnet_begin_zmp(telnet, *(argv + 0));
#line 1496
  i = (size_t )1;
  }
  {
#line 1496
  while (1) {
    while_continue: /* CIL Label */ ;
#line 1496
    if (! (i != argc)) {
#line 1496
      goto while_break;
    }
    {
#line 1497
    telnet_zmp_arg(telnet, *(argv + i));
#line 1496
    i ++;
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1500
  telnet_iac(telnet, (unsigned char)240);
  }
#line 1501
  return;
}
}
#line 1504 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_send_vzmpv(telnet_t *telnet , va_list va ) 
{ 
  char const   *arg ;
  char const   *tmp ;

  {
  {
#line 1508
  telnet_begin_sb(telnet, (unsigned char)93);
  }
  {
#line 1511
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 1511
    tmp = __builtin_va_arg(va, char const   *);
#line 1511
    arg = tmp;
    }
#line 1511
    if (! ((unsigned long )arg != (unsigned long )((char const   *)0))) {
#line 1511
      goto while_break;
    }
    {
#line 1512
    telnet_zmp_arg(telnet, arg);
    }
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 1515
  telnet_iac(telnet, (unsigned char)240);
  }
#line 1516
  return;
}
}
#line 1519
void telnet_send_zmpv(telnet_t *telnet  , ...)  __attribute__((__sentinel__)) ;
#line 1519 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_send_zmpv(telnet_t *telnet  , ...) 
{ 
  va_list va ;

  {
  {
#line 1522
  __builtin_va_start(va, telnet);
#line 1523
  telnet_send_vzmpv(telnet, va);
#line 1524
  __builtin_va_end(va);
  }
#line 1525
  return;
}
}
#line 1528 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_begin_zmp(telnet_t *telnet , char const   *cmd ) 
{ 


  {
  {
#line 1529
  telnet_begin_sb(telnet, (unsigned char)93);
#line 1530
  telnet_zmp_arg(telnet, cmd);
  }
#line 1531
  return;
}
}
#line 1534 "/home/wheatley/newnew/temp/procserv-2.6.0/libtelnet.c"
void telnet_zmp_arg(telnet_t *telnet , char const   *arg ) 
{ 
  size_t tmp ;

  {
  {
#line 1535
  tmp = strlen(arg);
#line 1535
  telnet_send(telnet, arg, tmp + 1UL);
  }
#line 1536
  return;
}
}
