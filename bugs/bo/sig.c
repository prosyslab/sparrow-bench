/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 212 "/usr/lib/gcc/x86_64-linux-gnu/4.6/include/stddef.h"
typedef unsigned long size_t;
#line 30 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned char __u_char;
#line 32 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __u_int;
#line 33 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __u_long;
#line 133 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __pid_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 33 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_char u_char;
#line 35 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_int u_int;
#line 36 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __u_long u_long;
#line 98 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef __pid_t pid_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 200 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned char u_int8_t;
#line 201 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned short u_int16_t;
#line 202 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned int u_int32_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 30 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 31 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 48 "/usr/include/arpa/nameser_compat.h"
struct __anonstruct_HEADER_49 {
   unsigned int id : 16 ;
   unsigned int rd : 1 ;
   unsigned int tc : 1 ;
   unsigned int aa : 1 ;
   unsigned int opcode : 4 ;
   unsigned int qr : 1 ;
   unsigned int rcode : 4 ;
   unsigned int cd : 1 ;
   unsigned int ad : 1 ;
   unsigned int unused : 1 ;
   unsigned int ra : 1 ;
   unsigned int qdcount : 16 ;
   unsigned int ancount : 16 ;
   unsigned int nscount : 16 ;
   unsigned int arcount : 16 ;
};
#line 48 "/usr/include/arpa/nameser_compat.h"
typedef struct __anonstruct_HEADER_49 HEADER;
#line 165 "ns_defs.h"
enum severity {
    ignore = 0,
    warn = 1,
    fail = 2,
    not_set = 3
} ;
#line 173 "ns_defs.h"
struct zoneinfo {
   char *z_origin ;
   time_t z_time ;
   time_t z_lastupdate ;
   u_int32_t z_refresh ;
   u_int32_t z_retry ;
   u_int32_t z_expire ;
   u_int32_t z_minimum ;
   u_int32_t z_serial ;
   char *z_source ;
   time_t z_ftime ;
   struct in_addr z_axfr_src ;
   struct in_addr z_xaddr ;
   struct in_addr z_addr[16] ;
   u_char z_addrcnt ;
   u_char z_type ;
   u_int32_t z_flags ;
   pid_t z_xferpid ;
   u_int z_options ;
   u_int z_optset ;
   int z_class ;
   int z_numxfrs ;
   enum severity z_checknames ;
   struct in_addr *z_also_notify ;
   int z_notify_count ;
   char *z_ixfr_base ;
   char *z_ixfr_tmp ;
   int z_maintain_ixfr_base ;
   int z_log_size_ixfr ;
   int z_max_log_size_ixfr ;
};
#line 303
enum transport {
    primary_trans = 0,
    secondary_trans = 1,
    response_trans = 2,
    update_trans = 3,
    num_trans = 4
} ;
#line 312
enum context {
    domain_ctx = 0,
    owner_ctx = 1,
    mailname_ctx = 2,
    hostname_ctx = 3
} ;
#line 362 "/usr/include/stdio.h"
extern int printf(char const   * __restrict  __format  , ...) ;
#line 46 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2), __leaf__)) memcpy)(void * __restrict  __dest ,
                                                                                                 void const   * __restrict  __src ,
                                                                                                 size_t __n ) ;
#line 129
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strcpy)(char * __restrict  __dest ,
                                                                                                 char const   * __restrict  __src ) ;
#line 399
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 413
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) strerror)(int __errnum ) ;
#line 50 "/usr/include/x86_64-linux-gnu/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 273 "/usr/include/resolv.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_init)(void) ;
#line 328
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) ;
#line 331
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) ;
#line 353
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) __p_secstodate)(u_long  ) ;
#line 355
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __dn_comp)(char const   * ,
                                                                                u_char * ,
                                                                                int  ,
                                                                                u_char ** ,
                                                                                u_char ** ) ;
#line 357
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __dn_expand)(u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  u_char const   * ,
                                                                                  char * ,
                                                                                  int  ) ;
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 69 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) __assert_fail)(char const   *__assertion ,
                                                                                                   char const   *__file ,
                                                                                                   unsigned int __line ,
                                                                                                   char const   *__function ) ;
#line 104 "sig-bad.c"
char const   *transport_strings[4]  = {      "primary",      "secondary",      "response",      (char const   *)((void *)0)};
#line 140
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) ;
#line 140 "sig-bad.c"
int ( __attribute__((__leaf__)) __res_dnok)(char const   *dn ) 
{ 
  int ch ;
  char const   *tmp ;

  {
  {
#line 144
  while (1) {
    while_continue: /* CIL Label */ ;
#line 144
    tmp = dn;
#line 144
    dn ++;
#line 144
    ch = (int )*tmp;
#line 144
    if (! (ch != 0)) {
#line 144
      goto while_break;
    }
#line 145
    if (ch > 32) {
#line 145
      if (! (ch < 127)) {
#line 146
        return (0);
      }
    } else {
#line 146
      return (0);
    }
  }
  while_break: /* CIL Label */ ;
  }
#line 147
  return (1);
}
}
#line 150
 __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) ;
#line 150 "sig-bad.c"
int ( __attribute__((__leaf__)) __res_hnok)(char const   *dn ) 
{ 
  int ppch ;
  int pch ;
  int ch ;
  char const   *tmp ;
  int nch ;
  char const   *tmp___0 ;

  {
#line 152
  ppch = '\000';
#line 152
  pch = 46;
#line 152
  tmp = dn;
#line 152
  dn ++;
#line 152
  ch = (int )*tmp;
  {
#line 154
  while (1) {
    while_continue: /* CIL Label */ ;
#line 154
    if (! (ch != 0)) {
#line 154
      goto while_break;
    }
#line 155
    tmp___0 = dn;
#line 155
    dn ++;
#line 155
    nch = (int )*tmp___0;
#line 157
    if (! (ch == 46)) {
#line 159
      if (pch == 46) {
#line 160
        if (ch >= 65) {
#line 160
          if (! (ch <= 90)) {
#line 160
            goto _L___0;
          }
        } else
        _L___0: /* CIL Label */ 
#line 160
        if (ch >= 97) {
#line 160
          if (! (ch <= 122)) {
#line 160
            goto _L;
          }
        } else
        _L: /* CIL Label */ 
#line 160
        if (ch >= 48) {
#line 160
          if (! (ch <= 57)) {
#line 161
            return (0);
          }
        } else {
#line 161
          return (0);
        }
      } else
#line 162
      if (nch == 46) {
#line 162
        goto _L___6;
      } else
#line 162
      if (nch == 0) {
        _L___6: /* CIL Label */ 
#line 163
        if (ch >= 65) {
#line 163
          if (! (ch <= 90)) {
#line 163
            goto _L___2;
          }
        } else
        _L___2: /* CIL Label */ 
#line 163
        if (ch >= 97) {
#line 163
          if (! (ch <= 122)) {
#line 163
            goto _L___1;
          }
        } else
        _L___1: /* CIL Label */ 
#line 163
        if (ch >= 48) {
#line 163
          if (! (ch <= 57)) {
#line 164
            return (0);
          }
        } else {
#line 164
          return (0);
        }
      } else
#line 166
      if (ch >= 65) {
#line 166
        if (! (ch <= 90)) {
#line 166
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 166
      if (ch >= 97) {
#line 166
        if (! (ch <= 122)) {
#line 166
          goto _L___4;
        }
      } else
      _L___4: /* CIL Label */ 
#line 166
      if (ch >= 48) {
#line 166
        if (! (ch <= 57)) {
#line 166
          goto _L___3;
        }
      } else
      _L___3: /* CIL Label */ 
#line 166
      if (! (ch == 45)) {
#line 167
        return (0);
      }
    }
#line 169
    ppch = pch;
#line 169
    pch = ch;
#line 169
    ch = nch;
  }
  while_break: /* CIL Label */ ;
  }
#line 171
  return (1);
}
}
#line 175 "sig-bad.c"
enum context ns_ownercontext(int type , enum transport transport ) 
{ 
  enum context context ;
  char *__cil_tmp4 ;

  {
#line 180
  context = (enum context )0;
  {
#line 185
  if (type == 15) {
#line 185
    goto case_15;
  }
#line 185
  if (type == 11) {
#line 185
    goto case_15;
  }
#line 185
  if (type == 1) {
#line 185
    goto case_15;
  }
#line 201
  if (type == 8) {
#line 201
    goto case_8;
  }
#line 201
  if (type == 7) {
#line 201
    goto case_8;
  }
#line 204
  goto switch_default___0;
  case_15: /* CIL Label */ 
  case_11: /* CIL Label */ 
  case_1: /* CIL Label */ 
  {
#line 189
  if ((unsigned int )transport == 1U) {
#line 189
    goto case_1___0;
  }
#line 189
  if ((unsigned int )transport == 0U) {
#line 189
    goto case_1___0;
  }
#line 189
  if ((unsigned int )transport == 3U) {
#line 189
    goto case_1___0;
  }
#line 192
  if ((unsigned int )transport == 2U) {
#line 192
    goto case_2;
  }
#line 195
  goto switch_default;
  case_1___0: /* CIL Label */ 
  case_0: /* CIL Label */ 
  case_3: /* CIL Label */ 
#line 190
  context = (enum context )1;
#line 191
  goto switch_break___0;
  case_2: /* CIL Label */ 
#line 193
  context = (enum context )3;
#line 194
  goto switch_break___0;
  switch_default: /* CIL Label */ 
  {
#line 196
  printf((char const   */* __restrict  */)"impossible condition in ns_ownercontext()");
  }
  switch_break___0: /* CIL Label */ ;
  }
#line 199
  goto switch_break;
  case_8: /* CIL Label */ 
  case_7: /* CIL Label */ 
#line 202
  context = (enum context )2;
#line 203
  goto switch_break;
  switch_default___0: /* CIL Label */ 
#line 206
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 208
  return (context);
}
}
#line 219 "sig-bad.c"
char *newstr(size_t len , int needpanic ) 
{ 
  u_char *buf ;
  u_char *bp ;
  void *tmp ;
  int *tmp___0 ;
  char *tmp___1 ;
  u_int16_t t_s ;
  u_char *t_cp ;
  u_char *tmp___2 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;

  {
#line 223
  if (! (len <= 65536UL)) {
    {
#line 223
    __assert_fail("len <= 65536", "sig-bad.c", 223U, "newstr");
    }
  }
  {
#line 225
  tmp = malloc((2UL + len) + 1UL);
#line 225
  buf = (u_char *)tmp;
  }
#line 226
  if ((unsigned long )buf == (unsigned long )((void *)0)) {
#line 227
    if (needpanic) {
      {
#line 228
      tmp___0 = __errno_location();
#line 228
      tmp___1 = strerror(*tmp___0);
#line 228
      printf((char const   */* __restrict  */)"savestr: malloc failed (%s)", tmp___1);
      }
    } else {
#line 230
      return ((char *)((void *)0));
    }
  }
#line 232
  bp = buf;
  {
#line 233
  while (1) {
    while_continue: /* CIL Label */ ;
#line 233
    t_s = (u_int16_t )len;
#line 233
    t_cp = bp;
#line 233
    tmp___2 = t_cp;
#line 233
    t_cp ++;
#line 233
    *tmp___2 = (u_char )((int )t_s >> 8);
#line 233
    *t_cp = (u_char )t_s;
#line 233
    bp += 2;
#line 233
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
#line 234
  return ((char *)bp);
}
}
#line 240 "sig-bad.c"
int ns_nameok(char const   *name , int class , struct zoneinfo *zp , enum transport transport ,
              enum context context , char const   *owner ) 
{ 
  enum severity severity ;
  int ok ;
  int tmp ;
  int tmp___0 ;
  char *__cil_tmp11 ;

  {
#line 247
  severity = (enum severity )3;
#line 248
  ok = 1;
#line 250
  if ((unsigned long )zp != (unsigned long )((void *)0)) {
#line 251
    severity = zp->z_checknames;
  }
#line 261
  if ((unsigned int )severity == 0U) {
#line 262
    return (1);
  }
  {
#line 264
  if ((unsigned int )context == 0U) {
#line 264
    goto case_0;
  }
#line 267
  if ((unsigned int )context == 3U) {
#line 267
    goto case_3;
  }
#line 270
  goto switch_default;
  case_0: /* CIL Label */ 
#line 265
  if (class != 1) {
#line 265
    tmp___0 = 1;
  } else {
    {
#line 265
    tmp = __res_dnok(name);
    }
#line 265
    if (tmp) {
#line 265
      tmp___0 = 1;
    } else {
#line 265
      tmp___0 = 0;
    }
  }
#line 265
  ok = tmp___0;
#line 266
  goto switch_break;
  case_3: /* CIL Label */ 
  {
#line 268
  ok = __res_hnok(name);
  }
#line 269
  goto switch_break;
  switch_default: /* CIL Label */ 
  {
#line 272
  printf((char const   */* __restrict  */)"unexpected context %d in ns_nameok", (int )context);
  }
#line 273
  return (0);
#line 276
  return (ok);
  switch_break: /* CIL Label */ ;
  }
#line 279
  return (ok);
}
}
#line 283 "sig-bad.c"
static int rrextract(u_char *msg , int msglen , u_char *rrp , u_char *dname , int namelen ) 
{ 
  u_char *eom ;
  u_char *cp ;
  u_char *cp1 ;
  u_char *rdatap ;
  u_int class ;
  u_int type ;
  u_int dlen ;
  int n ;
  int len ;
  u_int32_t ttl ;
  u_char data[4140] ;
  HEADER *hp ;
  u_char const   *t_cp ;
  u_char const   *t_cp___0 ;
  u_char const   *t_cp___1 ;
  u_char const   *t_cp___2 ;
  enum context tmp ;
  int tmp___0 ;
  u_long origTTL ;
  u_long exptime ;
  u_long signtime ;
  u_long timetilexp ;
  u_long now ;
  u_int8_t alg ;
  u_int temp ;
  u_char const   *t_cp___3 ;
  u_char const   *t_cp___4 ;
  u_char const   *t_cp___5 ;
  u_char const   *t_cp___6 ;
  u_char const   *t_cp___7 ;
  u_char const   *t_cp___8 ;
  time_t tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  size_t tmp___4 ;
  void *__cil_tmp41 ;
  char *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;

  {
  {
#line 288
  len = 0;
#line 291
  hp = (HEADER *)msg;
#line 293
  cp = rrp;
#line 294
  eom = msg + msglen;
#line 296
  printf((char const   */* __restrict  */)"Trying to do dn_expand..\n");
#line 297
  printf((char const   */* __restrict  */)"msg = %s, msglen = %d, rrp = %s, namelen = %d\n",
         (char *)msg, msglen, (char *)rrp, namelen);
#line 299
  n = __dn_expand((u_char const   *)msg, (u_char const   *)eom, (u_char const   *)cp,
                  (char *)dname, namelen);
  }
#line 299
  if (n < 0) {
    {
#line 300
    printf((char const   */* __restrict  */)"dn_expand returned %d\n", n);
#line 301
    hp->rcode = 1U;
    }
#line 302
    return (-1);
  }
  {
#line 305
  printf((char const   */* __restrict  */)"First dn_expand returned n = %d\n", n);
#line 307
  cp += n;
#line 308
  len += n;
#line 309
  len = (int )((unsigned long )len + sizeof(HEADER ));
  }
  {
#line 311
  while (1) {
    while_continue: /* CIL Label */ ;
#line 311
    if ((unsigned long )(cp + 10) > (unsigned long )eom) {
#line 311
      hp->rcode = 1U;
#line 311
      return (-1);
    }
#line 311
    goto while_break;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 312
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 312
    t_cp = (u_char const   *)cp;
#line 312
    type = (u_int )(((int )((u_int16_t )*(t_cp + 0)) << 8) | (int )((u_int16_t )*(t_cp + 1)));
#line 312
    cp += 2;
#line 312
    goto while_break___0;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 313
  cp += 2;
#line 314
  len += 2;
#line 315
  printf((char const   */* __restrict  */)"type = %d\n", type);
  }
  {
#line 316
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 316
    t_cp___0 = (u_char const   *)cp;
#line 316
    class = (u_int )(((int )((u_int16_t )*(t_cp___0 + 0)) << 8) | (int )((u_int16_t )*(t_cp___0 + 1)));
#line 316
    cp += 2;
#line 316
    goto while_break___1;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 317
  cp += 2;
#line 318
  len += 2;
#line 320
  if (class > (u_int )((1 << 8) - 1)) {
    {
#line 321
    printf((char const   */* __restrict  */)"bad class in rrextract");
#line 322
    hp->rcode = 1U;
    }
#line 323
    return (-1);
  }
  {
#line 325
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 325
    t_cp___1 = (u_char const   *)cp;
#line 325
    ttl = ((((u_int32_t )*(t_cp___1 + 0) << 24) | ((u_int32_t )*(t_cp___1 + 1) << 16)) | ((u_int32_t )*(t_cp___1 + 2) << 8)) | (u_int32_t )*(t_cp___1 + 3);
#line 325
    cp += 4;
#line 325
    goto while_break___2;
  }
  while_break___2: /* CIL Label */ ;
  }
  {
#line 326
  printf((char const   */* __restrict  */)"ttl = %d\n", ttl);
#line 327
  cp += 4;
#line 328
  len += 4;
  }
#line 330
  if (ttl > 2147483647U) {
    {
#line 331
    printf((char const   */* __restrict  */)"%s: converted TTL > %u to 0", dname,
           2147483647);
#line 334
    ttl = (u_int32_t )0;
    }
  }
  {
#line 336
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 336
    t_cp___2 = (u_char const   *)cp;
#line 336
    dlen = (u_int )(((int )((u_int16_t )*(t_cp___2 + 0)) << 8) | (int )((u_int16_t )*(t_cp___2 + 1)));
#line 336
    cp += 2;
#line 336
    goto while_break___3;
  }
  while_break___3: /* CIL Label */ ;
  }
  {
#line 337
  cp += 2;
#line 338
  len += 2;
#line 340
  printf((char const   */* __restrict  */)"dlen = %d\n", dlen);
  }
  {
#line 341
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 341
    if ((unsigned long )(cp + dlen) > (unsigned long )eom) {
#line 341
      hp->rcode = 1U;
#line 341
      return (-1);
    }
#line 341
    goto while_break___4;
  }
  while_break___4: /* CIL Label */ ;
  }
  {
#line 342
  printf((char const   */* __restrict  */)"bounds check succeeded\n");
#line 343
  rdatap = cp;
#line 345
  tmp = ns_ownercontext((int )type, (enum transport )2);
#line 345
  tmp___0 = ns_nameok((char const   *)((char *)dname), (int )class, (struct zoneinfo *)((void *)0),
                      (enum transport )2, tmp, (char const   *)((char *)dname));
  }
#line 345
  if (! tmp___0) {
#line 348
    hp->rcode = 5U;
#line 349
    return (-1);
  }
  {
#line 351
  printf((char const   */* __restrict  */)"rrextract: dname %s type %d class %d ttl %d\n",
         dname, type, class, ttl);
  }
  {
#line 371
  if (type == 1U) {
#line 371
    goto case_1;
  }
#line 380
  if (type == 35U) {
#line 380
    goto case_35;
  }
#line 391
  if (type == 33U) {
#line 391
    goto case_33;
  }
#line 391
  if (type == 21U) {
#line 391
    goto case_33;
  }
#line 391
  if (type == 18U) {
#line 391
    goto case_33;
  }
#line 391
  if (type == 15U) {
#line 391
    goto case_33;
  }
#line 395
  if (type == 26U) {
#line 395
    goto case_26;
  }
#line 399
  if (type == 24U) {
#line 399
    goto case_24;
  }
#line 571
  goto switch_default___0;
  case_1: /* CIL Label */ 
#line 372
  if (dlen != 4U) {
#line 373
    hp->rcode = 1U;
#line 374
    return (-1);
  }
#line 377
  goto switch_break;
  case_35: /* CIL Label */ 
  {
#line 381
  printf((char const   */* __restrict  */)"NOT HANDLING T_NAPTR RECORDS\n");
  }
#line 382
  goto switch_break;
  case_33: /* CIL Label */ 
  case_21: /* CIL Label */ 
  case_18: /* CIL Label */ 
  case_15: /* CIL Label */ 
  {
#line 392
  printf((char const   */* __restrict  */)"NOT HANDLING T_SRV RECORDS\n");
  }
#line 393
  goto switch_break;
  case_26: /* CIL Label */ 
  {
#line 396
  printf((char const   */* __restrict  */)"NOT HANDLING T_PX RECORDS\n");
  }
#line 397
  goto switch_break;
  case_24: /* CIL Label */ 
  {
#line 408
  while (1) {
    while_continue___5: /* CIL Label */ ;
#line 408
    if ((unsigned long )(cp + 16) > (unsigned long )eom) {
#line 408
      hp->rcode = 1U;
#line 408
      return (-1);
    }
#line 408
    goto while_break___5;
  }
  while_break___5: /* CIL Label */ ;
  }
#line 410
  cp1 = cp;
  {
#line 412
  while (1) {
    while_continue___6: /* CIL Label */ ;
#line 412
    t_cp___3 = (u_char const   *)cp1;
#line 412
    temp = (u_int )(((int )((u_int16_t )*(t_cp___3 + 0)) << 8) | (int )((u_int16_t )*(t_cp___3 + 1)));
#line 412
    cp1 += 2;
#line 412
    goto while_break___6;
  }
  while_break___6: /* CIL Label */ ;
  }
  {
#line 413
  printf((char const   */* __restrict  */)"covered type = %d\n", temp);
#line 414
  cp1 += 2;
#line 415
  len += 2;
  }
  {
#line 417
  while (1) {
    while_continue___7: /* CIL Label */ ;
#line 417
    t_cp___4 = (u_char const   *)cp1;
#line 417
    temp = (u_int )(((int )((u_int16_t )*(t_cp___4 + 0)) << 8) | (int )((u_int16_t )*(t_cp___4 + 1)));
#line 417
    cp1 += 2;
#line 417
    goto while_break___7;
  }
  while_break___7: /* CIL Label */ ;
  }
  {
#line 418
  printf((char const   */* __restrict  */)" alg label = %d\n", temp);
#line 419
  alg = (u_int8_t )(temp / 256U);
#line 420
  cp1 += 2;
#line 421
  len += 2;
#line 423
  printf((char const   */* __restrict  */)"alg = %d\n", (int )alg);
  }
  {
#line 425
  while (1) {
    while_continue___8: /* CIL Label */ ;
#line 425
    t_cp___5 = (u_char const   *)cp1;
#line 425
    origTTL = (u_long )(((((u_int32_t )*(t_cp___5 + 0) << 24) | ((u_int32_t )*(t_cp___5 + 1) << 16)) | ((u_int32_t )*(t_cp___5 + 2) << 8)) | (u_int32_t )*(t_cp___5 + 3));
#line 425
    cp1 += 4;
#line 425
    goto while_break___8;
  }
  while_break___8: /* CIL Label */ ;
  }
  {
#line 426
  cp1 += 4;
#line 427
  len += 4;
#line 429
  printf((char const   */* __restrict  */)"origttl = %d\n", (int )origTTL);
  }
  {
#line 430
  while (1) {
    while_continue___9: /* CIL Label */ ;
#line 430
    t_cp___6 = (u_char const   *)cp1;
#line 430
    exptime = (u_long )(((((u_int32_t )*(t_cp___6 + 0) << 24) | ((u_int32_t )*(t_cp___6 + 1) << 16)) | ((u_int32_t )*(t_cp___6 + 2) << 8)) | (u_int32_t )*(t_cp___6 + 3));
#line 430
    cp1 += 4;
#line 430
    goto while_break___9;
  }
  while_break___9: /* CIL Label */ ;
  }
  {
#line 431
  printf((char const   */* __restrict  */)"Exptime = %d\n", (int )exptime);
#line 432
  cp1 += 4;
#line 433
  len += 4;
  }
  {
#line 435
  while (1) {
    while_continue___10: /* CIL Label */ ;
#line 435
    t_cp___7 = (u_char const   *)cp1;
#line 435
    signtime = (u_long )(((((u_int32_t )*(t_cp___7 + 0) << 24) | ((u_int32_t )*(t_cp___7 + 1) << 16)) | ((u_int32_t )*(t_cp___7 + 2) << 8)) | (u_int32_t )*(t_cp___7 + 3));
#line 435
    cp1 += 4;
#line 435
    goto while_break___10;
  }
  while_break___10: /* CIL Label */ ;
  }
  {
#line 436
  printf((char const   */* __restrict  */)"Sign time = %d\n", (int )signtime);
#line 437
  cp1 += 4;
#line 438
  len += 4;
  }
  {
#line 440
  while (1) {
    while_continue___11: /* CIL Label */ ;
#line 440
    t_cp___8 = (u_char const   *)cp1;
#line 440
    temp = (u_int )(((int )((u_int16_t )*(t_cp___8 + 0)) << 8) | (int )((u_int16_t )*(t_cp___8 + 1)));
#line 440
    cp1 += 2;
#line 440
    goto while_break___11;
  }
  while_break___11: /* CIL Label */ ;
  }
  {
#line 441
  printf((char const   */* __restrict  */)"random footprint = %d\n", temp);
#line 442
  cp1 += 2;
#line 443
  len += 2;
#line 445
  tmp___1 = time((time_t *)((void *)0));
#line 445
  now = (u_long )tmp___1;
#line 447
  printf((char const   */* __restrict  */)"now = %d\n", (int )now);
  }
#line 449
  if ((u_long )ttl > origTTL) {
    {
#line 450
    printf((char const   */* __restrict  */)"shrinking SIG TTL");
#line 452
    ttl = (u_int32_t )origTTL;
    }
  }
#line 456
  if (signtime > now) {
    {
#line 457
    tmp___2 = __p_secstodate(signtime);
#line 457
    printf((char const   */* __restrict  */)"ignoring SIG: signature date %s is in the future",
           tmp___2);
    }
#line 458
    return ((int )((cp - rrp) + (long )dlen));
  }
#line 462
  if (exptime <= now) {
    {
#line 463
    tmp___3 = __p_secstodate(exptime);
#line 463
    printf((char const   */* __restrict  */)"ignoring SIG: expiration %s is in the past",
           tmp___3);
    }
#line 465
    return ((int )((cp - rrp) + (long )dlen));
  }
#line 469
  timetilexp = exptime - now;
#line 470
  if (timetilexp < (u_long )ttl) {
    {
#line 471
    printf((char const   */* __restrict  */)"shrinking expiring SIG TTL");
#line 473
    ttl = (u_int32_t )timetilexp;
    }
  }
#line 476
  cp = cp1 - 18;
#line 479
  cp1 = data;
  {
#line 483
  while (1) {
    while_continue___12: /* CIL Label */ ;
#line 483
    if ((unsigned long )(cp + 18) > (unsigned long )eom) {
#line 483
      hp->rcode = 1U;
#line 483
      return (-1);
    }
#line 483
    goto while_break___12;
  }
  while_break___12: /* CIL Label */ ;
  }
  {
#line 484
  memcpy((void */* __restrict  */)cp1, (void const   */* __restrict  */)cp, (size_t )18);
#line 486
  cp1 += 18;
#line 489
  printf((char const   */* __restrict  */)"sizeof data = %d\n", sizeof(data));
#line 490
  printf((char const   */* __restrict  */)"comp name = %s\n", (char *)cp + 18);
#line 492
  n = __dn_expand((u_char const   *)msg, (u_char const   *)eom, (u_char const   *)(cp + 18),
                  (char *)cp1, (int )(sizeof(data) - 18UL));
#line 496
  printf((char const   */* __restrict  */)"dn_expand returned:  %d, expanded name = %s\n",
         n, (char *)cp1);
  }
#line 498
  if (n < 0) {
    {
#line 499
    printf((char const   */* __restrict  */)"ERROR: n = %d < 0!\n", n);
#line 500
    printf((char const   */* __restrict  */)"EXITING RREXTRACT!\n");
#line 501
    hp->rcode = 1U;
    }
#line 502
    return (-1);
  }
  {
#line 504
  cp += n;
#line 505
  tmp___4 = strlen((char const   *)((char *)cp1));
#line 505
  cp1 += tmp___4 + 1UL;
#line 509
  n = (int )(dlen - (u_int )(18 + n));
#line 511
  printf((char const   */* __restrict  */)"dlen - NS_SIG_SIGNER - n = %d\n", n);
#line 526
  printf((char const   */* __restrict  */)"n=%d\n", n);
#line 527
  printf((char const   */* __restrict  */)"(sizeof data) - (cp1 - (u_char *)data) = %d\n",
         sizeof(data) - (unsigned long )(cp1 - data));
#line 528
  printf((char const   */* __restrict  */)"(n > (int) (sizeof data) - (cp1 - (u_char *)data)) = %d\n",
         (long )n > (long )((int )sizeof(data)) - (cp1 - data));
  }
#line 532
  if ((long )n > (long )((int )sizeof(data)) - (cp1 - data)) {
    {
#line 533
    printf((char const   */* __restrict  */)"NO ROOM\n");
#line 534
    hp->rcode = 1U;
    }
#line 535
    return (-1);
  }
  {
#line 539
  if ((int )alg == 1) {
#line 539
    goto case_1___0;
  }
#line 545
  if ((int )alg == 3) {
#line 545
    goto case_3;
  }
#line 550
  goto switch_default;
  case_1___0: /* CIL Label */ 
#line 541
  if (n < 64) {
#line 542
    hp->rcode = 1U;
  } else
#line 541
  if (n > 512) {
#line 542
    hp->rcode = 1U;
  }
#line 543
  goto switch_break___0;
  case_3: /* CIL Label */ 
#line 546
  if (n != 41) {
#line 547
    hp->rcode = 1U;
  }
#line 548
  goto switch_break___0;
  switch_default: /* CIL Label */ 
  {
#line 551
  printf((char const   */* __restrict  */)"DEFAULT ALG!\n");
  }
#line 552
  goto switch_break___0;
  switch_break___0: /* CIL Label */ ;
  }
#line 555
  if (hp->rcode == 1U) {
#line 556
    return (-1);
  }
  {
#line 558
  printf((char const   */* __restrict  */)"memcpying n=%u bytes \n", (unsigned int )n);
#line 561
  memcpy((void */* __restrict  */)cp1, (void const   */* __restrict  */)cp, (size_t )n);
#line 562
  cp += n;
#line 563
  cp1 += n;
#line 566
  n = (int )(cp1 - data);
#line 567
  cp1 = data;
  }
#line 568
  goto switch_break;
  switch_default___0: /* CIL Label */ 
  {
#line 572
  printf((char const   */* __restrict  */)"unknown type %d", type);
  }
#line 573
  return ((int )((cp - rrp) + (long )dlen));
  switch_break: /* CIL Label */ ;
  }
#line 576
  if ((unsigned long )cp > (unsigned long )eom) {
#line 577
    hp->rcode = 1U;
#line 578
    return (-1);
  }
#line 580
  if ((u_int )(cp - rdatap) != dlen) {
    {
#line 582
    printf((char const   */* __restrict  */)"encoded rdata length is %u, but actual length was %u",
           dlen, (u_int )(cp - rdatap));
#line 584
    hp->rcode = 1U;
    }
#line 586
    return (-1);
  }
#line 588
  if (n > 2070) {
    {
#line 589
    printf((char const   */* __restrict  */)"update type %d: %d bytes is too much data",
           type, n);
#line 592
    hp->rcode = 1U;
    }
#line 593
    return (-1);
  }
#line 599
  return ((int )(cp - rrp));
}
}
#line 607 "sig-bad.c"
int createSig(u_char *buf ) 
{ 
  u_char *p ;
  char *temp ;
  char *temp1 ;
  u_char *comp_dn ;
  u_char *comp_dn2 ;
  char exp_dn[200] ;
  char exp_dn2[200] ;
  u_char **dnptrs ;
  u_char **lastdnptr ;
  u_char **dnptrs2 ;
  int i ;
  int len ;
  int comp_size ;
  u_long now ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  size_t tmp___4 ;
  u_char *tmp___5 ;
  char *tmp___6 ;
  u_char **tmp___7 ;
  u_char **tmp___8 ;
  size_t tmp___9 ;
  u_char *tmp___10 ;
  u_char *tmp___11 ;
  u_int16_t t_s ;
  u_char *t_cp ;
  u_char *tmp___12 ;
  u_int16_t t_s___0 ;
  u_char *t_cp___0 ;
  u_char *tmp___13 ;
  u_int32_t t_l ;
  u_char *t_cp___1 ;
  u_char *tmp___14 ;
  u_char *tmp___15 ;
  u_char *tmp___16 ;
  u_int16_t t_s___1 ;
  u_char *t_cp___2 ;
  u_char *tmp___17 ;
  u_int16_t t_s___2 ;
  u_char *t_cp___3 ;
  u_char *tmp___18 ;
  u_int16_t t_s___3 ;
  u_char *t_cp___4 ;
  u_char *tmp___19 ;
  u_int32_t t_l___0 ;
  u_char *t_cp___5 ;
  u_char *tmp___20 ;
  u_char *tmp___21 ;
  u_char *tmp___22 ;
  time_t tmp___23 ;
  u_int32_t t_l___1 ;
  u_char *t_cp___6 ;
  u_char *tmp___24 ;
  u_char *tmp___25 ;
  u_char *tmp___26 ;
  u_int32_t t_l___2 ;
  u_char *t_cp___7 ;
  u_char *tmp___27 ;
  u_char *tmp___28 ;
  u_char *tmp___29 ;
  u_int16_t t_s___4 ;
  u_char *t_cp___8 ;
  u_char *tmp___30 ;
  u_char **tmp___31 ;
  u_char **tmp___32 ;
  size_t tmp___33 ;
  u_char *tmp___34 ;
  u_char *tmp___35 ;
  u_int32_t t_l___3 ;
  u_char *t_cp___9 ;
  u_char *tmp___36 ;
  u_char *tmp___37 ;
  u_char *tmp___38 ;
  void *__cil_tmp78 ;
  void *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;
  char *__cil_tmp83 ;
  char *__cil_tmp84 ;
  char *__cil_tmp85 ;
  char *__cil_tmp86 ;
  char *__cil_tmp87 ;
  char *__cil_tmp88 ;
  char *__cil_tmp89 ;
  char *__cil_tmp90 ;
  char *__cil_tmp91 ;

  {
  {
#line 613
  len = 0;
#line 617
  tmp = malloc(2UL * sizeof(unsigned char *));
#line 617
  dnptrs = (unsigned char **)tmp;
#line 618
  tmp___0 = malloc(2UL * sizeof(unsigned char *));
#line 618
  dnptrs2 = (unsigned char **)tmp___0;
#line 620
  tmp___1 = malloc(200UL * sizeof(unsigned char ));
#line 620
  comp_dn = (unsigned char *)tmp___1;
#line 621
  tmp___2 = malloc(200UL * sizeof(unsigned char ));
#line 621
  comp_dn2 = (unsigned char *)tmp___2;
#line 623
  tmp___3 = malloc(400UL * sizeof(char ));
#line 623
  temp1 = (char *)tmp___3;
#line 625
  temp = temp1;
#line 627
  p = buf;
#line 629
  strcpy((char */* __restrict  */)temp, (char const   */* __restrict  */)"HEADER JUNK:");
#line 631
  tmp___4 = strlen((char const   *)temp);
#line 631
  len = (int )((size_t )len + tmp___4);
  }
  {
#line 633
  while (1) {
    while_continue: /* CIL Label */ ;
#line 633
    if (! ((int )*temp != 0)) {
#line 633
      goto while_break;
    }
#line 634
    tmp___5 = p;
#line 634
    p ++;
#line 634
    tmp___6 = temp;
#line 634
    temp ++;
#line 634
    *tmp___5 = (u_char )*tmp___6;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 636
  strcpy((char */* __restrict  */)(exp_dn), (char const   */* __restrict  */)"lcs.mit.edu");
#line 638
  tmp___7 = dnptrs;
#line 638
  dnptrs ++;
#line 638
  *tmp___7 = (u_char *)(exp_dn);
#line 639
  tmp___8 = dnptrs;
#line 639
  dnptrs --;
#line 639
  *tmp___8 = (u_char *)((void *)0);
#line 641
  lastdnptr = (u_char **)((void *)0);
#line 643
  printf((char const   */* __restrict  */)"Calling dn_comp..\n");
#line 644
  comp_size = __dn_comp((char const   *)(exp_dn), comp_dn, 200, dnptrs, lastdnptr);
#line 645
  tmp___9 = strlen((char const   *)(exp_dn));
#line 645
  printf((char const   */* __restrict  */)"uncomp_size = %d\n", tmp___9);
#line 646
  printf((char const   */* __restrict  */)"comp_size = %d\n", comp_size);
#line 647
  printf((char const   */* __restrict  */)"exp_dn = %s, comp_dn = %s\n", exp_dn, (char *)comp_dn);
#line 649
  i = 0;
  }
  {
#line 649
  while (1) {
    while_continue___0: /* CIL Label */ ;
#line 649
    if (! (i < comp_size)) {
#line 649
      goto while_break___0;
    }
#line 650
    tmp___10 = p;
#line 650
    p ++;
#line 650
    tmp___11 = comp_dn;
#line 650
    comp_dn ++;
#line 650
    *tmp___10 = *tmp___11;
#line 649
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 652
  len += comp_size;
  {
#line 654
  while (1) {
    while_continue___1: /* CIL Label */ ;
#line 654
    t_s = (u_int16_t )24;
#line 654
    t_cp = p;
#line 654
    tmp___12 = t_cp;
#line 654
    t_cp ++;
#line 654
    *tmp___12 = (u_char )((int )t_s >> 8);
#line 654
    *t_cp = (u_char )t_s;
#line 654
    p += 2;
#line 654
    goto while_break___1;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 655
  p += 2;
  {
#line 657
  while (1) {
    while_continue___2: /* CIL Label */ ;
#line 657
    t_s___0 = (u_int16_t )1;
#line 657
    t_cp___0 = p;
#line 657
    tmp___13 = t_cp___0;
#line 657
    t_cp___0 ++;
#line 657
    *tmp___13 = (u_char )((int )t_s___0 >> 8);
#line 657
    *t_cp___0 = (u_char )t_s___0;
#line 657
    p += 2;
#line 657
    goto while_break___2;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 658
  p += 2;
  {
#line 660
  while (1) {
    while_continue___3: /* CIL Label */ ;
#line 660
    t_l = (u_int32_t )255;
#line 660
    t_cp___1 = p;
#line 660
    tmp___14 = t_cp___1;
#line 660
    t_cp___1 ++;
#line 660
    *tmp___14 = (u_char )(t_l >> 24);
#line 660
    tmp___15 = t_cp___1;
#line 660
    t_cp___1 ++;
#line 660
    *tmp___15 = (u_char )(t_l >> 16);
#line 660
    tmp___16 = t_cp___1;
#line 660
    t_cp___1 ++;
#line 660
    *tmp___16 = (u_char )(t_l >> 8);
#line 660
    *t_cp___1 = (u_char )t_l;
#line 660
    p += 4;
#line 660
    goto while_break___3;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 661
  p += 4;
  {
#line 663
  while (1) {
    while_continue___4: /* CIL Label */ ;
#line 663
    t_s___1 = (u_int16_t )30;
#line 663
    t_cp___2 = p;
#line 663
    tmp___17 = t_cp___2;
#line 663
    t_cp___2 ++;
#line 663
    *tmp___17 = (u_char )((int )t_s___1 >> 8);
#line 663
    *t_cp___2 = (u_char )t_s___1;
#line 663
    p += 2;
#line 663
    goto while_break___4;
  }
  while_break___4: /* CIL Label */ ;
  }
#line 666
  p += 2;
#line 668
  len += 10;
  {
#line 670
  while (1) {
    while_continue___5: /* CIL Label */ ;
#line 670
    t_s___2 = (u_int16_t )15;
#line 670
    t_cp___3 = p;
#line 670
    tmp___18 = t_cp___3;
#line 670
    t_cp___3 ++;
#line 670
    *tmp___18 = (u_char )((int )t_s___2 >> 8);
#line 670
    *t_cp___3 = (u_char )t_s___2;
#line 670
    p += 2;
#line 670
    goto while_break___5;
  }
  while_break___5: /* CIL Label */ ;
  }
#line 671
  p += 2;
  {
#line 673
  while (1) {
    while_continue___6: /* CIL Label */ ;
#line 673
    t_s___3 = (u_int16_t )512;
#line 673
    t_cp___4 = p;
#line 673
    tmp___19 = t_cp___4;
#line 673
    t_cp___4 ++;
#line 673
    *tmp___19 = (u_char )((int )t_s___3 >> 8);
#line 673
    *t_cp___4 = (u_char )t_s___3;
#line 673
    p += 2;
#line 673
    goto while_break___6;
  }
  while_break___6: /* CIL Label */ ;
  }
#line 674
  p += 2;
  {
#line 676
  while (1) {
    while_continue___7: /* CIL Label */ ;
#line 676
    t_l___0 = (u_int32_t )255;
#line 676
    t_cp___5 = p;
#line 676
    tmp___20 = t_cp___5;
#line 676
    t_cp___5 ++;
#line 676
    *tmp___20 = (u_char )(t_l___0 >> 24);
#line 676
    tmp___21 = t_cp___5;
#line 676
    t_cp___5 ++;
#line 676
    *tmp___21 = (u_char )(t_l___0 >> 16);
#line 676
    tmp___22 = t_cp___5;
#line 676
    t_cp___5 ++;
#line 676
    *tmp___22 = (u_char )(t_l___0 >> 8);
#line 676
    *t_cp___5 = (u_char )t_l___0;
#line 676
    p += 4;
#line 676
    goto while_break___7;
  }
  while_break___7: /* CIL Label */ ;
  }
  {
#line 677
  p += 4;
#line 679
  tmp___23 = time((time_t *)((void *)0));
#line 679
  now = (u_long )tmp___23;
#line 681
  printf((char const   */* __restrict  */)"Signing at = %d\n", now);
  }
  {
#line 682
  while (1) {
    while_continue___8: /* CIL Label */ ;
#line 682
    t_l___1 = (u_int32_t )(now + 20000UL);
#line 682
    t_cp___6 = p;
#line 682
    tmp___24 = t_cp___6;
#line 682
    t_cp___6 ++;
#line 682
    *tmp___24 = (u_char )(t_l___1 >> 24);
#line 682
    tmp___25 = t_cp___6;
#line 682
    t_cp___6 ++;
#line 682
    *tmp___25 = (u_char )(t_l___1 >> 16);
#line 682
    tmp___26 = t_cp___6;
#line 682
    t_cp___6 ++;
#line 682
    *tmp___26 = (u_char )(t_l___1 >> 8);
#line 682
    *t_cp___6 = (u_char )t_l___1;
#line 682
    p += 4;
#line 682
    goto while_break___8;
  }
  while_break___8: /* CIL Label */ ;
  }
#line 683
  p += 4;
  {
#line 684
  while (1) {
    while_continue___9: /* CIL Label */ ;
#line 684
    t_l___2 = (u_int32_t )now;
#line 684
    t_cp___7 = p;
#line 684
    tmp___27 = t_cp___7;
#line 684
    t_cp___7 ++;
#line 684
    *tmp___27 = (u_char )(t_l___2 >> 24);
#line 684
    tmp___28 = t_cp___7;
#line 684
    t_cp___7 ++;
#line 684
    *tmp___28 = (u_char )(t_l___2 >> 16);
#line 684
    tmp___29 = t_cp___7;
#line 684
    t_cp___7 ++;
#line 684
    *tmp___29 = (u_char )(t_l___2 >> 8);
#line 684
    *t_cp___7 = (u_char )t_l___2;
#line 684
    p += 4;
#line 684
    goto while_break___9;
  }
  while_break___9: /* CIL Label */ ;
  }
#line 685
  p += 4;
  {
#line 687
  while (1) {
    while_continue___10: /* CIL Label */ ;
#line 687
    t_s___4 = (u_int16_t )100;
#line 687
    t_cp___8 = p;
#line 687
    tmp___30 = t_cp___8;
#line 687
    t_cp___8 ++;
#line 687
    *tmp___30 = (u_char )((int )t_s___4 >> 8);
#line 687
    *t_cp___8 = (u_char )t_s___4;
#line 687
    p += 2;
#line 687
    goto while_break___10;
  }
  while_break___10: /* CIL Label */ ;
  }
  {
#line 688
  p += 2;
#line 690
  len += 18;
#line 692
  strcpy((char */* __restrict  */)(exp_dn2), (char const   */* __restrict  */)"sls.lcs.mit.edu");
#line 694
  tmp___31 = dnptrs2;
#line 694
  dnptrs2 ++;
#line 694
  *tmp___31 = (u_char *)(exp_dn2);
#line 695
  tmp___32 = dnptrs2;
#line 695
  dnptrs2 --;
#line 695
  *tmp___32 = (u_char *)((void *)0);
#line 696
  lastdnptr = (u_char **)((void *)0);
#line 698
  printf((char const   */* __restrict  */)"Calling dn_comp..\n");
#line 699
  comp_size = __dn_comp((char const   *)(exp_dn2), comp_dn2, 200, dnptrs2, lastdnptr);
#line 700
  tmp___33 = strlen((char const   *)(exp_dn2));
#line 700
  printf((char const   */* __restrict  */)"uncomp_size = %d\n", tmp___33);
#line 701
  printf((char const   */* __restrict  */)"comp_size = %d\n", comp_size);
#line 702
  printf((char const   */* __restrict  */)"exp_dn2 = %s, comp_dn2 = %s\n", exp_dn2,
         (char *)comp_dn2);
#line 704
  len += comp_size;
#line 706
  i = 0;
  }
  {
#line 706
  while (1) {
    while_continue___11: /* CIL Label */ ;
#line 706
    if (! (i < comp_size)) {
#line 706
      goto while_break___11;
    }
#line 707
    tmp___34 = p;
#line 707
    p ++;
#line 707
    tmp___35 = comp_dn2;
#line 707
    comp_dn2 ++;
#line 707
    *tmp___34 = *tmp___35;
#line 706
    i ++;
  }
  while_break___11: /* CIL Label */ ;
  }
#line 709
  i = 0;
  {
#line 709
  while (1) {
    while_continue___12: /* CIL Label */ ;
#line 709
    if (! (i < 11)) {
#line 709
      goto while_break___12;
    }
    {
#line 711
    while (1) {
      while_continue___13: /* CIL Label */ ;
#line 711
      t_l___3 = (u_int32_t )123;
#line 711
      t_cp___9 = p;
#line 711
      tmp___36 = t_cp___9;
#line 711
      t_cp___9 ++;
#line 711
      *tmp___36 = (u_char )(t_l___3 >> 24);
#line 711
      tmp___37 = t_cp___9;
#line 711
      t_cp___9 ++;
#line 711
      *tmp___37 = (u_char )(t_l___3 >> 16);
#line 711
      tmp___38 = t_cp___9;
#line 711
      t_cp___9 ++;
#line 711
      *tmp___38 = (u_char )(t_l___3 >> 8);
#line 711
      *t_cp___9 = (u_char )t_l___3;
#line 711
      p += 4;
#line 711
      goto while_break___13;
    }
    while_break___13: /* CIL Label */ ;
    }
#line 712
    p += 4;
#line 713
    len += 4;
#line 709
    i ++;
  }
  while_break___12: /* CIL Label */ ;
  }
#line 716
  return ((int )(p - buf));
}
}
#line 721 "sig-bad.c"
int main(void) 
{ 
  int msglen ;
  int ret ;
  u_char *dp ;
  u_char *name ;
  void *tmp ;
  u_char *msg ;
  void *tmp___0 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
  {
#line 725
  tmp = malloc(100UL * sizeof(u_char ));
#line 725
  name = (u_char *)tmp;
#line 726
  tmp___0 = malloc(1000UL * sizeof(u_char ));
#line 726
  msg = (u_char *)tmp___0;
#line 729
  msglen = createSig(msg);
#line 730
  printf((char const   */* __restrict  */)"msglen = %d\n", msglen);
#line 732
  dp = msg + sizeof(HEADER );
#line 734
  printf((char const   */* __restrict  */)"Calling rrextract!\n");
#line 736
  __res_init();
#line 737
  ret = rrextract(msg, msglen, dp, name, 100);
#line 739
  printf((char const   */* __restrict  */)"rrextract returned %d\n", ret);
  }
#line 741
  return (0);
}
}
